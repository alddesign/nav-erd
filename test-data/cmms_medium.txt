OBJECT Table 38 Purchase Header
{
  OBJECT-PROPERTIES
  {
    Date=07.09.17;
    Time=14:07:52;
    Modified=Yes;
    Version List=NAVW19.00.00.46290,NAVDACH9.00.00.46290,CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Buy-from Vendor Name;
    OnInsert=BEGIN
               IF NOT SkipInitialization THEN
                 InitInsert;

               IF GETFILTER("Buy-from Vendor No.") <> '' THEN
                 IF GETRANGEMIN("Buy-from Vendor No.") = GETRANGEMAX("Buy-from Vendor No.") THEN
                   VALIDATE("Buy-from Vendor No.",GETRANGEMIN("Buy-from Vendor No."));

               "Doc. No. Occurrence" := ArchiveManagement.GetNextOccurrenceNo(DATABASE::"Purchase Header","Document Type","No.");
             END;

    OnDelete=BEGIN
               IF NOT UserSetupMgt.CheckRespCenter(1,"Responsibility Center") THEN
                 ERROR(
                   Text023,
                   RespCenter.TABLECAPTION,UserSetupMgt.GetPurchasesFilter);

               PurchPost.DeleteHeader(
                 Rec,PurchRcptHeader,PurchInvHeader,PurchCrMemoHeader,
                 ReturnShptHeader,PurchInvHeaderPrepmt,PurchCrMemoHeaderPrepmt);
               CASE "Document Type" OF
                 "Document Type"::Quote:
                   BEGIN
                     PurchSetup.GET;
                     CASE PurchSetup."Archiving Purchase Quote" OF
                       PurchSetup."Archiving Purchase Quote"::Always:
                         ArchiveManagement.ArchPurchDocumentNoConfirm(Rec);
                       PurchSetup."Archiving Purchase Quote"::Question:
                         ArchiveManagement.ArchivePurchDocument(Rec);
                     END;
                   END;
                 "Document Type"::Order,"Document Type"::"Blanket Order","Document Type"::"Return Order":
                   BEGIN
                     PurchSetup.GET;
                     IF PurchSetup."Arch. Orders and Ret. Orders" OR PurchSetup."Archiving Blanket Purch. Order" THEN
                       ArchiveManagement.ArchPurchDocumentNoConfirm(Rec);
                   END;
               END;

               VALIDATE("Applies-to ID",'');
               VALIDATE("Incoming Document Entry No.",0);

               ApprovalsMgmt.DeleteApprovalEntry(DATABASE::"Purchase Header","Document Type","No.");
               PurchLine.LOCKTABLE;

               WhseRequest.SETRANGE("Source Type",DATABASE::"Purchase Line");
               WhseRequest.SETRANGE("Source Subtype","Document Type");
               WhseRequest.SETRANGE("Source No.","No.");
               WhseRequest.DELETEALL(TRUE);

               PurchLine.SETRANGE("Document Type","Document Type");
               PurchLine.SETRANGE("Document No.","No.");
               PurchLine.SETRANGE(Type,PurchLine.Type::"Charge (Item)");
               DeletePurchaseLines;
               PurchLine.SETRANGE(Type);
               DeletePurchaseLines;

               PurchCommentLine.SETRANGE("Document Type","Document Type");
               PurchCommentLine.SETRANGE("No.","No.");
               PurchCommentLine.DELETEALL;

               IF (PurchRcptHeader."No." <> '') OR
                  (PurchInvHeader."No." <> '') OR
                  (PurchCrMemoHeader."No." <> '') OR
                  (ReturnShptHeader."No." <> '') OR
                  (PurchInvHeaderPrepmt."No." <> '') OR
                  (PurchCrMemoHeaderPrepmt."No." <> '')
               THEN
                 MESSAGE(PostedDocsToPrintCreatedMsg);
             END;

    OnRename=BEGIN
               ERROR(Text003,TABLECAPTION);
             END;

    CaptionML=[ENU=Purchase Header;
               DEA=Einkaufskopf];
    LookupPageID=Page53;
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              DEA=Belegart];
                                                   OptionCaptionML=[ENU=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order;
                                                                    DEA=Anfrage,Bestellung,Rechnung,Gutschrift,Rahmenbestellung,Reklamation];
                                                   OptionString=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order }
    { 2   ;   ;Buy-from Vendor No. ;Code20        ;TableRelation=Vendor;
                                                   OnValidate=BEGIN
                                                                InitRecOnVendUpdate;
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Buy-from Vendor No." <> xRec."Buy-from Vendor No.") AND
                                                                   (xRec."Buy-from Vendor No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Buy-from Vendor No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    PurchLine.SETRANGE("Document Type","Document Type");
                                                                    PurchLine.SETRANGE("Document No.","No.");
                                                                    IF "Buy-from Vendor No." = '' THEN BEGIN
                                                                      IF NOT PurchLine.ISEMPTY THEN
                                                                        ERROR(
                                                                          Text005,
                                                                          FIELDCAPTION("Buy-from Vendor No."));
                                                                      INIT;
                                                                      PurchSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;
                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      PurchLine.SETFILTER("Quantity Received",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                                                                        PurchLine.SETRANGE("Buy-from Vendor No.",xRec."Buy-from Vendor No.");
                                                                        PurchLine.SETFILTER("Receipt No.",'<>%1','');
                                                                      END;
                                                                    IF PurchLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        PurchLine.TESTFIELD("Quantity Received",0)
                                                                      ELSE
                                                                        PurchLine.TESTFIELD("Receipt No.",'');

                                                                    PurchLine.SETRANGE("Receipt No.");
                                                                    PurchLine.SETRANGE("Quantity Received");
                                                                    PurchLine.SETRANGE("Buy-from Vendor No.");

                                                                    IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                      PurchLine.SETFILTER("Prepmt. Amt. Inv.",'<>0');
                                                                      IF PurchLine.FIND('-') THEN
                                                                        PurchLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      PurchLine.SETRANGE("Prepmt. Amt. Inv.");
                                                                    END;

                                                                    IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                      PurchLine.SETFILTER("Return Qty. Shipped",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                                                                        PurchLine.SETRANGE("Buy-from Vendor No.",xRec."Buy-from Vendor No.");
                                                                        PurchLine.SETFILTER("Return Shipment No.",'<>%1','');
                                                                      END;
                                                                    IF PurchLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                        PurchLine.TESTFIELD("Return Qty. Shipped",0)
                                                                      ELSE
                                                                        PurchLine.TESTFIELD("Return Shipment No.",'');

                                                                    PurchLine.RESET;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                GetVend("Buy-from Vendor No.");
                                                                Vend.CheckBlockedVendOnDocs(Vend,FALSE);
                                                                Vend.TESTFIELD("Gen. Bus. Posting Group");
                                                                "Buy-from Vendor Name" := Vend.Name;
                                                                "Buy-from Vendor Name 2" := Vend."Name 2";
                                                                "Buy-from Address" := Vend.Address;
                                                                "Buy-from Address 2" := Vend."Address 2";
                                                                "Buy-from City" := Vend.City;
                                                                "Buy-from Post Code" := Vend."Post Code";
                                                                "Buy-from County" := Vend.County;
                                                                "Buy-from Country/Region Code" := Vend."Country/Region Code";
                                                                IF NOT SkipBuyFromContact THEN
                                                                  "Buy-from Contact" := Vend.Contact;
                                                                "Gen. Bus. Posting Group" := Vend."Gen. Bus. Posting Group";
                                                                "VAT Bus. Posting Group" := Vend."VAT Bus. Posting Group";
                                                                "Tax Area Code" := Vend."Tax Area Code";
                                                                "Tax Liable" := Vend."Tax Liable";
                                                                "VAT Registration No." := Vend."VAT Registration No.";
                                                                "VAT Country/Region Code" := Vend."Country/Region Code";
                                                                "Registration No." := Vend."Registration No.";
                                                                VALIDATE("Lead Time Calculation",Vend."Lead Time Calculation");
                                                                "Responsibility Center" := UserSetupMgt.GetRespCenter(1,Vend."Responsibility Center");
                                                                VALIDATE("Sell-to Customer No.",'');
                                                                VALIDATE("Location Code",UserSetupMgt.GetLocation(1,Vend."Location Code","Responsibility Center"));

                                                                IF "Buy-from Vendor No." = xRec."Pay-to Vendor No." THEN
                                                                  IF ReceivedPurchLinesExist OR ReturnShipmentExist THEN BEGIN
                                                                    TESTFIELD("VAT Bus. Posting Group",xRec."VAT Bus. Posting Group");
                                                                    TESTFIELD("Gen. Bus. Posting Group",xRec."Gen. Bus. Posting Group");
                                                                  END;

                                                                "Buy-from IC Partner Code" := Vend."IC Partner Code";
                                                                "Send IC Document" := ("Buy-from IC Partner Code" <> '') AND ("IC Direction" = "IC Direction"::Outgoing);

                                                                IF Vend."Pay-to Vendor No." <> '' THEN
                                                                  VALIDATE("Pay-to Vendor No.",Vend."Pay-to Vendor No.")
                                                                ELSE BEGIN
                                                                  IF "Buy-from Vendor No." = "Pay-to Vendor No." THEN
                                                                    SkipPayToContact := TRUE;
                                                                  VALIDATE("Pay-to Vendor No.","Buy-from Vendor No.");
                                                                  SkipPayToContact := FALSE;
                                                                END;
                                                                "Order Address Code" := '';

                                                                VALIDATE("Order Address Code");

                                                                IF (xRec."Buy-from Vendor No." <> "Buy-from Vendor No.") OR
                                                                   (xRec."Currency Code" <> "Currency Code") OR
                                                                   (xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group") OR
                                                                   (xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group")
                                                                THEN
                                                                  RecreatePurchLines(FIELDCAPTION("Buy-from Vendor No."));

                                                                IF NOT SkipBuyFromContact THEN
                                                                  UpdateBuyFromCont("Buy-from Vendor No.");
                                                              END;

                                                   CaptionML=[ENU=Buy-from Vendor No.;
                                                              DEA=Eink. von Kred.-Nr.] }
    { 3   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  NoSeriesMgt.TestManual(GetNoSeriesCode);
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              DEA=Nr.] }
    { 4   ;   ;Pay-to Vendor No.   ;Code20        ;TableRelation=Vendor;
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF (xRec."Pay-to Vendor No." <> "Pay-to Vendor No.") AND
                                                                   (xRec."Pay-to Vendor No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Pay-to Vendor No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    PurchLine.SETRANGE("Document Type","Document Type");
                                                                    PurchLine.SETRANGE("Document No.","No.");

                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      PurchLine.SETFILTER("Quantity Received",'<>0');
                                                                    IF "Document Type" = "Document Type"::Invoice THEN
                                                                      PurchLine.SETFILTER("Receipt No.",'<>%1','');
                                                                    IF PurchLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        PurchLine.TESTFIELD("Quantity Received",0)
                                                                      ELSE
                                                                        PurchLine.TESTFIELD("Receipt No.",'');

                                                                    PurchLine.SETRANGE("Receipt No.");
                                                                    PurchLine.SETRANGE("Quantity Received");

                                                                    IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                      PurchLine.SETFILTER("Prepmt. Amt. Inv.",'<>0');
                                                                      IF PurchLine.FIND('-') THEN
                                                                        PurchLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      PurchLine.SETRANGE("Prepmt. Amt. Inv.");
                                                                    END;

                                                                    IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                      PurchLine.SETFILTER("Return Qty. Shipped",'<>0');
                                                                    IF "Document Type" = "Document Type"::"Credit Memo" THEN
                                                                      PurchLine.SETFILTER("Return Shipment No.",'<>%1','');
                                                                    IF PurchLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                        PurchLine.TESTFIELD("Return Qty. Shipped",0)
                                                                      ELSE
                                                                        PurchLine.TESTFIELD("Return Shipment No.",'');

                                                                    PurchLine.RESET;
                                                                  END ELSE
                                                                    "Pay-to Vendor No." := xRec."Pay-to Vendor No.";
                                                                END;

                                                                GetVend("Pay-to Vendor No.");
                                                                Vend.CheckBlockedVendOnDocs(Vend,FALSE);
                                                                Vend.TESTFIELD("Vendor Posting Group");

                                                                "Pay-to Name" := Vend.Name;
                                                                "Pay-to Name 2" := Vend."Name 2";
                                                                "Pay-to Address" := Vend.Address;
                                                                "Pay-to Address 2" := Vend."Address 2";
                                                                "Pay-to City" := Vend.City;
                                                                "Pay-to Post Code" := Vend."Post Code";
                                                                "Pay-to County" := Vend.County;
                                                                "Pay-to Country/Region Code" := Vend."Country/Region Code";
                                                                IF NOT SkipPayToContact THEN
                                                                  "Pay-to Contact" := Vend.Contact;
                                                                "Payment Terms Code" := Vend."Payment Terms Code";
                                                                "Prepmt. Payment Terms Code" := Vend."Payment Terms Code";

                                                                IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                                                                  "Payment Method Code" := '';
                                                                  IF PaymentTerms.GET("Payment Terms Code") THEN
                                                                    IF PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN
                                                                      "Payment Method Code" := Vend."Payment Method Code"
                                                                END ELSE
                                                                  "Payment Method Code" := Vend."Payment Method Code";

                                                                "Shipment Method Code" := Vend."Shipment Method Code";
                                                                "Vendor Posting Group" := Vend."Vendor Posting Group";
                                                                GLSetup.GET;
                                                                IF GLSetup."Bill-to/Sell-to VAT Calc." = GLSetup."Bill-to/Sell-to VAT Calc."::"Bill-to/Pay-to No." THEN BEGIN
                                                                  "VAT Bus. Posting Group" := Vend."VAT Bus. Posting Group";
                                                                  "VAT Country/Region Code" := Vend."Country/Region Code";
                                                                  "VAT Registration No." := Vend."VAT Registration No.";
                                                                  "Gen. Bus. Posting Group" := Vend."Gen. Bus. Posting Group";
                                                                END;
                                                                "Prices Including VAT" := Vend."Prices Including VAT";
                                                                "Currency Code" := Vend."Currency Code";
                                                                "Invoice Disc. Code" := Vend."Invoice Disc. Code";
                                                                "Language Code" := Vend."Language Code";
                                                                "Purchaser Code" := Vend."Purchaser Code";
                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");
                                                                VALIDATE("Payment Method Code");
                                                                VALIDATE("Currency Code");
                                                                VALIDATE("Creditor No.",Vend."Creditor No.");

                                                                IF "Document Type" = "Document Type"::Order THEN
                                                                  VALIDATE("Prepayment %",Vend."Prepayment %");

                                                                IF "Pay-to Vendor No." = xRec."Pay-to Vendor No." THEN BEGIN
                                                                  IF ReceivedPurchLinesExist THEN
                                                                    TESTFIELD("Currency Code",xRec."Currency Code");
                                                                END;

                                                                CreateDim(
                                                                  DATABASE::Vendor,"Pay-to Vendor No.",
                                                                  DATABASE::"Salesperson/Purchaser","Purchaser Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center");

                                                                IF (xRec."Buy-from Vendor No." = "Buy-from Vendor No.") AND
                                                                   (xRec."Pay-to Vendor No." <> "Pay-to Vendor No.")
                                                                THEN
                                                                  RecreatePurchLines(FIELDCAPTION("Pay-to Vendor No."));

                                                                IF NOT SkipPayToContact THEN
                                                                  UpdatePayToCont("Pay-to Vendor No.");

                                                                "Pay-to IC Partner Code" := Vend."IC Partner Code";
                                                              END;

                                                   CaptionML=[ENU=Pay-to Vendor No.;
                                                              DEA=Zahlung an Kred.-Nr.];
                                                   NotBlank=Yes }
    { 5   ;   ;Pay-to Name         ;Text50        ;CaptionML=[ENU=Pay-to Name;
                                                              DEA=Zahlung an Name] }
    { 6   ;   ;Pay-to Name 2       ;Text50        ;CaptionML=[ENU=Pay-to Name 2;
                                                              DEA=Zahlung an Name 2] }
    { 7   ;   ;Pay-to Address      ;Text50        ;CaptionML=[ENU=Pay-to Address;
                                                              DEA=Zahlung an Adresse] }
    { 8   ;   ;Pay-to Address 2    ;Text50        ;CaptionML=[ENU=Pay-to Address 2;
                                                              DEA=Zahlung an Adresse 2] }
    { 9   ;   ;Pay-to City         ;Text30        ;TableRelation=IF (Pay-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Pay-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Pay-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Pay-to City;
                                                              DEA=Zahlung an Ort] }
    { 10  ;   ;Pay-to Contact      ;Text50        ;CaptionML=[ENU=Pay-to Contact;
                                                              DEA=Zahlung an Kontakt] }
    { 11  ;   ;Your Reference      ;Text35        ;CaptionML=[ENU=Your Reference;
                                                              DEA=Ihre Referenz] }
    { 12  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Sell-to Customer No.));
                                                   OnValidate=BEGIN
                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN BEGIN
                                                                  PurchLine.SETRANGE("Document Type",PurchLine."Document Type"::Order);
                                                                  PurchLine.SETRANGE("Document No.","No.");
                                                                  PurchLine.SETFILTER("Sales Order Line No.",'<>0');
                                                                  IF NOT PurchLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Ship-to Code"));
                                                                END;

                                                                IF "Ship-to Code" <> '' THEN BEGIN
                                                                  ShipToAddr.GET("Sell-to Customer No.","Ship-to Code");
                                                                  "Ship-to Name" := ShipToAddr.Name;
                                                                  "Ship-to Name 2" := ShipToAddr."Name 2";
                                                                  "Ship-to Address" := ShipToAddr.Address;
                                                                  "Ship-to Address 2" := ShipToAddr."Address 2";
                                                                  "Ship-to City" := ShipToAddr.City;
                                                                  "Ship-to Post Code" := ShipToAddr."Post Code";
                                                                  "Ship-to County" := ShipToAddr.County;
                                                                  "Ship-to Country/Region Code" := ShipToAddr."Country/Region Code";
                                                                  "Ship-to Contact" := ShipToAddr.Contact;
                                                                  "Shipment Method Code" := ShipToAddr."Shipment Method Code";
                                                                  IF ShipToAddr."Location Code" <> '' THEN
                                                                    VALIDATE("Location Code",ShipToAddr."Location Code");
                                                                END ELSE BEGIN
                                                                  TESTFIELD("Sell-to Customer No.");
                                                                  Cust.GET("Sell-to Customer No.");
                                                                  "Ship-to Name" := Cust.Name;
                                                                  "Ship-to Name 2" := Cust."Name 2";
                                                                  "Ship-to Address" := Cust.Address;
                                                                  "Ship-to Address 2" := Cust."Address 2";
                                                                  "Ship-to City" := Cust.City;
                                                                  "Ship-to Post Code" := Cust."Post Code";
                                                                  "Ship-to County" := Cust.County;
                                                                  "Ship-to Country/Region Code" := Cust."Country/Region Code";
                                                                  "Ship-to Contact" := Cust.Contact;
                                                                  "Shipment Method Code" := Cust."Shipment Method Code";
                                                                  IF Cust."Location Code" <> '' THEN
                                                                    VALIDATE("Location Code",Cust."Location Code");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Ship-to Code;
                                                              DEA=Lief. an Code] }
    { 13  ;   ;Ship-to Name        ;Text50        ;CaptionML=[ENU=Ship-to Name;
                                                              DEA=Lief. an Name] }
    { 14  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[ENU=Ship-to Name 2;
                                                              DEA=Lief. an Name 2] }
    { 15  ;   ;Ship-to Address     ;Text50        ;CaptionML=[ENU=Ship-to Address;
                                                              DEA=Lief. an Adresse] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[ENU=Ship-to Address 2;
                                                              DEA=Lief. an Adresse 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to City;
                                                              DEA=Lief. an Ort] }
    { 18  ;   ;Ship-to Contact     ;Text50        ;CaptionML=[ENU=Ship-to Contact;
                                                              DEA=Lief. an Kontakt] }
    { 19  ;   ;Order Date          ;Date          ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) AND
                                                                   NOT ("Order Date" = xRec."Order Date")
                                                                THEN
                                                                  PriceMessageIfPurchLinesExist(FIELDCAPTION("Order Date"));
                                                              END;

                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Order Date;
                                                              DEA=Bestelldatum] }
    { 20  ;   ;Posting Date        ;Date          ;OnValidate=VAR
                                                                SkipJobCurrFactorUpdate@1000 : Boolean;
                                                              BEGIN
                                                                TestNoSeriesDate(
                                                                  "Posting No.","Posting No. Series",
                                                                  FIELDCAPTION("Posting No."),FIELDCAPTION("Posting No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepayment No.","Prepayment No. Series",
                                                                  FIELDCAPTION("Prepayment No."),FIELDCAPTION("Prepayment No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepmt. Cr. Memo No.","Prepmt. Cr. Memo No. Series",
                                                                  FIELDCAPTION("Prepmt. Cr. Memo No."),FIELDCAPTION("Prepmt. Cr. Memo No. Series"));

                                                                IF "Incoming Document Entry No." = 0 THEN
                                                                  VALIDATE("Document Date","Posting Date");

                                                                IF ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"]) AND
                                                                   NOT ("Posting Date" = xRec."Posting Date")
                                                                THEN
                                                                  PriceMessageIfPurchLinesExist(FIELDCAPTION("Posting Date"));

                                                                IF "Currency Code" <> '' THEN BEGIN
                                                                  UpdateCurrencyFactor;
                                                                  IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                    SkipJobCurrFactorUpdate := NOT ConfirmUpdateCurrencyFactor;
                                                                END;

                                                                IF "Posting Date" <> xRec."Posting Date" THEN
                                                                  IF DeferralHeadersExist THEN
                                                                    ConfirmUpdateDeferralDate;

                                                                IF PurchLinesExist THEN
                                                                  JobUpdatePurchLines(SkipJobCurrFactorUpdate);
                                                              END;

                                                   CaptionML=[ENU=Posting Date;
                                                              DEA=Buchungsdatum] }
    { 21  ;   ;Expected Receipt Date;Date         ;OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION("Expected Receipt Date"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Expected Receipt Date;
                                                              DEA=Erwartetes Wareneingangsdatum] }
    { 22  ;   ;Posting Description ;Text50        ;CaptionML=[ENU=Posting Description;
                                                              DEA=Buchungsbeschreibung] }
    { 23  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   OnValidate=BEGIN
                                                                IF ("Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Payment Terms Code");
                                                                  IF (("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]) AND
                                                                      NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos")
                                                                  THEN BEGIN
                                                                    VALIDATE("Due Date","Document Date");
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    IF NOT UpdateDocumentDate THEN
                                                                      VALIDATE("Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END;
                                                                END;
                                                                IF xRec."Payment Terms Code" = "Prepmt. Payment Terms Code" THEN
                                                                  VALIDATE("Prepmt. Payment Terms Code","Payment Terms Code");
                                                              END;

                                                   CaptionML=[ENU=Payment Terms Code;
                                                              DEA=Zlg.-Bedingungscode] }
    { 24  ;   ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              DEA=F„lligkeitsdatum] }
    { 25  ;   ;Payment Discount %  ;Decimal       ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Payment Discount %;
                                                              DEA=Skonto %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 26  ;   ;Pmt. Discount Date  ;Date          ;CaptionML=[ENU=Pmt. Discount Date;
                                                              DEA=Skontodatum] }
    { 27  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                              END;

                                                   CaptionML=[ENU=Shipment Method Code;
                                                              DEA=Lieferbedingungscode] }
    { 28  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Location Code" <> xRec."Location Code") AND
                                                                   (xRec."Buy-from Vendor No." = "Buy-from Vendor No.")
                                                                THEN
                                                                  MessageIfPurchLinesExist(FIELDCAPTION("Location Code"));

                                                                UpdateShipToAddress;

                                                                IF "Location Code" = '' THEN BEGIN
                                                                  IF InvtSetup.GET THEN
                                                                    "Inbound Whse. Handling Time" := InvtSetup."Inbound Whse. Handling Time";
                                                                END ELSE BEGIN
                                                                  IF Location.GET("Location Code") THEN;
                                                                  "Inbound Whse. Handling Time" := Location."Inbound Whse. Handling Time";
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              DEA=Lagerortcode] }
    { 29  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              DEA=Shortcutdimensionscode 1];
                                                   CaptionClass='1,2,1' }
    { 30  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              DEA=Shortcutdimensionscode 2];
                                                   CaptionClass='1,2,2' }
    { 31  ;   ;Vendor Posting Group;Code10        ;TableRelation="Vendor Posting Group";
                                                   CaptionML=[ENU=Vendor Posting Group;
                                                              DEA=Kreditorenbuchungsgruppe];
                                                   Editable=No }
    { 32  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date")]) OR ("Currency Code" <> xRec."Currency Code") THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                IF (CurrFieldNo <> FIELDNO("Currency Code")) AND ("Currency Code" = xRec."Currency Code") THEN
                                                                  UpdateCurrencyFactor
                                                                ELSE
                                                                  IF "Currency Code" <> xRec."Currency Code" THEN BEGIN
                                                                    UpdateCurrencyFactor;
                                                                    IF PurchLinesExist THEN
                                                                      IF CONFIRM(ChangeCurrencyQst,FALSE,FIELDCAPTION("Currency Code")) THEN BEGIN
                                                                        SetHideValidationDialog(TRUE);
                                                                        RecreatePurchLines(FIELDCAPTION("Currency Code"));
                                                                        SetHideValidationDialog(FALSE);
                                                                      END ELSE
                                                                        ERROR(Text018,FIELDCAPTION("Currency Code"));
                                                                  END ELSE
                                                                    IF "Currency Code" <> '' THEN BEGIN
                                                                      UpdateCurrencyFactor;
                                                                      IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                        ConfirmUpdateCurrencyFactor;
                                                                    END;
                                                              END;

                                                   CaptionML=[ENU=Currency Code;
                                                              DEA=W„hrungscode] }
    { 33  ;   ;Currency Factor     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Currency Factor"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Currency Factor;
                                                              DEA=W„hrungsfaktor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0;
                                                   Editable=No }
    { 35  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                PurchLine@1000 : Record 39;
                                                                Currency@1001 : Record 4;
                                                                RecalculatePrice@1002 : Boolean;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF "Prices Including VAT" <> xRec."Prices Including VAT" THEN BEGIN
                                                                  PurchLine.SETRANGE("Document Type","Document Type");
                                                                  PurchLine.SETRANGE("Document No.","No.");
                                                                  PurchLine.SETFILTER("Direct Unit Cost",'<>%1',0);
                                                                  PurchLine.SETFILTER("VAT %",'<>%1',0);
                                                                  IF PurchLine.FIND('-') THEN BEGIN
                                                                    RecalculatePrice :=
                                                                      CONFIRM(
                                                                        STRSUBSTNO(
                                                                          Text025 +
                                                                          Text027,
                                                                          FIELDCAPTION("Prices Including VAT"),PurchLine.FIELDCAPTION("Direct Unit Cost")),
                                                                        TRUE);
                                                                    PurchLine.SetPurchHeader(Rec);

                                                                    IF RecalculatePrice AND "Prices Including VAT" THEN
                                                                      PurchLine.MODIFYALL(Amount,0,TRUE);

                                                                    IF "Currency Code" = '' THEN
                                                                      Currency.InitRoundingPrecision
                                                                    ELSE
                                                                      Currency.GET("Currency Code");

                                                                    PurchLine.FINDSET;
                                                                    REPEAT
                                                                      PurchLine.TESTFIELD("Quantity Invoiced",0);
                                                                      PurchLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      IF NOT RecalculatePrice THEN BEGIN
                                                                        PurchLine."VAT Difference" := 0;
                                                                        PurchLine.UpdateAmounts;
                                                                      END ELSE
                                                                        IF "Prices Including VAT" THEN BEGIN
                                                                          PurchLine."Direct Unit Cost" :=
                                                                            ROUND(
                                                                              PurchLine."Direct Unit Cost" * (1 + PurchLine."VAT %" / 100),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF PurchLine.Quantity <> 0 THEN BEGIN
                                                                            PurchLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                PurchLine.Quantity * PurchLine."Direct Unit Cost" * PurchLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            PurchLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                PurchLine."Inv. Discount Amount" * (1 + PurchLine."VAT %" / 100),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END ELSE BEGIN
                                                                          PurchLine."Direct Unit Cost" :=
                                                                            ROUND(
                                                                              PurchLine."Direct Unit Cost" / (1 + PurchLine."VAT %" / 100),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF PurchLine.Quantity <> 0 THEN BEGIN
                                                                            PurchLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                PurchLine.Quantity * PurchLine."Direct Unit Cost" * PurchLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            PurchLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                PurchLine."Inv. Discount Amount" / (1 + PurchLine."VAT %" / 100),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END;
                                                                      PurchLine.MODIFY;
                                                                    UNTIL PurchLine.NEXT = 0;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prices Including VAT;
                                                              DEA=EK-Preise inkl. MwSt.] }
    { 37  ;   ;Invoice Disc. Code  ;Code20        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfPurchLinesExist(FIELDCAPTION("Invoice Disc. Code"));
                                                              END;

                                                   CaptionML=[ENU=Invoice Disc. Code;
                                                              DEA=Rechnungsrabattcode] }
    { 41  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=BEGIN
                                                                MessageIfPurchLinesExist(FIELDCAPTION("Language Code"));
                                                              END;

                                                   CaptionML=[ENU=Language Code;
                                                              DEA=Sprachcode] }
    { 43  ;   ;Purchaser Code      ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=VAR
                                                                ApprovalEntry@1001 : Record 454;
                                                              BEGIN
                                                                ApprovalEntry.SETRANGE("Table ID",DATABASE::"Purchase Header");
                                                                ApprovalEntry.SETRANGE("Document Type","Document Type");
                                                                ApprovalEntry.SETRANGE("Document No.","No.");
                                                                ApprovalEntry.SETFILTER(Status,'%1|%2',ApprovalEntry.Status::Created,ApprovalEntry.Status::Open);
                                                                IF NOT ApprovalEntry.ISEMPTY THEN
                                                                  ERROR(Text042,FIELDCAPTION("Purchaser Code"));

                                                                CreateDim(
                                                                  DATABASE::"Salesperson/Purchaser","Purchaser Code",
                                                                  DATABASE::Vendor,"Pay-to Vendor No.",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center");
                                                              END;

                                                   CaptionML=[ENU=Purchaser Code;
                                                              DEA=Eink„ufercode] }
    { 45  ;   ;Order Class         ;Code10        ;CaptionML=[ENU=Order Class;
                                                              DEA=Bestellgruppe] }
    { 46  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Purch. Comment Line" WHERE (Document Type=FIELD(Document Type),
                                                                                                  No.=FIELD(No.),
                                                                                                  Document Line No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung];
                                                   Editable=No }
    { 47  ;   ;No. Printed         ;Integer       ;CaptionML=[ENU=No. Printed;
                                                              DEA=Anzahl gedruckt];
                                                   Editable=No }
    { 51  ;   ;On Hold             ;Code3         ;CaptionML=[ENU=On Hold;
                                                              DEA=Abwarten] }
    { 52  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[ENU=Applies-to Doc. Type;
                                                              DEA=Ausgleich mit Belegart];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    DEA=" ,Zahlung,Rechnung,Gutschrift,Zinsrechnung,Mahnung,Erstattung"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 53  ;   ;Applies-to Doc. No. ;Code20        ;OnValidate=BEGIN
                                                                IF "Applies-to Doc. No." <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');

                                                                IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." <> '') AND
                                                                   ("Applies-to Doc. No." <> '')
                                                                THEN BEGIN
                                                                  SetAmountToApply("Applies-to Doc. No.","Buy-from Vendor No.");
                                                                  SetAmountToApply(xRec."Applies-to Doc. No.","Buy-from Vendor No.");
                                                                END ELSE
                                                                  IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." = '') THEN
                                                                    SetAmountToApply("Applies-to Doc. No.","Buy-from Vendor No.")
                                                                  ELSE
                                                                    IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND ("Applies-to Doc. No." = '') THEN
                                                                      SetAmountToApply(xRec."Applies-to Doc. No.","Buy-from Vendor No.");
                                                              END;

                                                   OnLookup=BEGIN
                                                              TESTFIELD("Bal. Account No.",'');
                                                              VendLedgEntry.SETCURRENTKEY("Vendor No.",Open,Positive,"Due Date");
                                                              VendLedgEntry.SETRANGE("Vendor No.","Pay-to Vendor No.");
                                                              VendLedgEntry.SETRANGE(Open,TRUE);
                                                              IF "Applies-to Doc. No." <> '' THEN BEGIN
                                                                VendLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                VendLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                                                IF VendLedgEntry.FINDFIRST THEN;
                                                                VendLedgEntry.SETRANGE("Document Type");
                                                                VendLedgEntry.SETRANGE("Document No.");
                                                              END ELSE
                                                                IF "Applies-to Doc. Type" <> 0 THEN BEGIN
                                                                  VendLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                  IF VendLedgEntry.FINDFIRST THEN;
                                                                  VendLedgEntry.SETRANGE("Document Type");
                                                                END ELSE
                                                                  IF Amount <> 0 THEN BEGIN
                                                                    VendLedgEntry.SETRANGE(Positive,Amount < 0);
                                                                    IF VendLedgEntry.FINDFIRST THEN;
                                                                    VendLedgEntry.SETRANGE(Positive);
                                                                  END;
                                                              ApplyVendEntries.SetPurch(Rec,VendLedgEntry,PurchHeader.FIELDNO("Applies-to Doc. No."));
                                                              ApplyVendEntries.SETTABLEVIEW(VendLedgEntry);
                                                              ApplyVendEntries.SETRECORD(VendLedgEntry);
                                                              ApplyVendEntries.LOOKUPMODE(TRUE);
                                                              IF ApplyVendEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ApplyVendEntries.GetVendLedgEntry(VendLedgEntry);
                                                                GenJnlApply.CheckAgainstApplnCurrency(
                                                                  "Currency Code",VendLedgEntry."Currency Code",GenJnILine."Account Type"::Vendor,TRUE);
                                                                "Applies-to Doc. Type" := VendLedgEntry."Document Type";
                                                                "Applies-to Doc. No." := VendLedgEntry."Document No.";
                                                              END;
                                                              CLEAR(ApplyVendEntries);
                                                            END;

                                                   CaptionML=[ENU=Applies-to Doc. No.;
                                                              DEA=Ausgleich mit Belegnr.] }
    { 55  ;   ;Bal. Account No.    ;Code20        ;TableRelation=IF (Bal. Account Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Bal. Account Type=CONST(Bank Account)) "Bank Account";
                                                   OnValidate=BEGIN
                                                                IF "Bal. Account No." <> '' THEN
                                                                  CASE "Bal. Account Type" OF
                                                                    "Bal. Account Type"::"G/L Account":
                                                                      BEGIN
                                                                        GLAcc.GET("Bal. Account No.");
                                                                        GLAcc.CheckGLAcc;
                                                                        GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                      END;
                                                                    "Bal. Account Type"::"Bank Account":
                                                                      BEGIN
                                                                        BankAcc.GET("Bal. Account No.");
                                                                        BankAcc.TESTFIELD(Blocked,FALSE);
                                                                        BankAcc.TESTFIELD("Currency Code","Currency Code");
                                                                      END;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Bal. Account No.;
                                                              DEA=Gegenkontonr.] }
    { 56  ;   ;Recalculate Invoice Disc.;Boolean  ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Purchase Line" WHERE (Document Type=FIELD(Document Type),
                                                                                            Document No.=FIELD(No.),
                                                                                            Recalculate Invoice Disc.=CONST(Yes)));
                                                   CaptionML=[ENU=Recalculate Invoice Disc.;
                                                              DEA=Rechnungsrabatt neu berechnen];
                                                   Editable=No }
    { 57  ;   ;Receive             ;Boolean       ;CaptionML=[ENU=Receive;
                                                              DEA=Wareneingang] }
    { 58  ;   ;Invoice             ;Boolean       ;CaptionML=[ENU=Invoice;
                                                              DEA=Rechnung] }
    { 59  ;   ;Print Posted Documents;Boolean     ;CaptionML=[ENU=Print Posted Documents;
                                                              DEA=Gebuchte Belege drucken] }
    { 60  ;   ;Amount              ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line".Amount WHERE (Document Type=FIELD(Document Type),
                                                                                                 Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount;
                                                              DEA=Betrag];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Amount Including VAT;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Amount Including VAT" WHERE (Document Type=FIELD(Document Type),
                                                                                                                 Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount Including VAT;
                                                              DEA=Betrag inkl. MwSt.];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 62  ;   ;Receiving No.       ;Code20        ;CaptionML=[ENU=Receiving No.;
                                                              DEA=Liefernr.] }
    { 63  ;   ;Posting No.         ;Code20        ;CaptionML=[ENU=Posting No.;
                                                              DEA=Buchungsnr.] }
    { 64  ;   ;Last Receiving No.  ;Code20        ;TableRelation="Purch. Rcpt. Header";
                                                   CaptionML=[ENU=Last Receiving No.;
                                                              DEA=Letzte Lieferscheinnr.];
                                                   Editable=No }
    { 65  ;   ;Last Posting No.    ;Code20        ;TableRelation="Purch. Inv. Header";
                                                   CaptionML=[ENU=Last Posting No.;
                                                              DEA=Letzte Buchungsnr.];
                                                   Editable=No }
    { 66  ;   ;Vendor Order No.    ;Code35        ;CaptionML=[ENU=Vendor Order No.;
                                                              DEA=Kred.-Bestellnr.] }
    { 67  ;   ;Vendor Shipment No. ;Code35        ;CaptionML=[ENU=Vendor Shipment No.;
                                                              DEA=Kred.-Lieferungsnr.] }
    { 68  ;   ;Vendor Invoice No.  ;Code35        ;CaptionML=[ENU=Vendor Invoice No.;
                                                              DEA=Kred.-Rechnungsnr.] }
    { 69  ;   ;Vendor Cr. Memo No. ;Code35        ;CaptionML=[ENU=Vendor Cr. Memo No.;
                                                              DEA=Kred.-Gutschriftsnr.] }
    { 70  ;   ;VAT Registration No.;Text20        ;CaptionML=[ENU=VAT Registration No.;
                                                              DEA=USt-IdNr.] }
    { 72  ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Sell-to Customer No." <> "Sell-to Customer No.")
                                                                THEN BEGIN
                                                                  PurchLine.SETRANGE("Document Type",PurchLine."Document Type"::Order);
                                                                  PurchLine.SETRANGE("Document No.","No.");
                                                                  PurchLine.SETFILTER("Sales Order Line No.",'<>0');
                                                                  IF NOT PurchLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Sell-to Customer No."));

                                                                  PurchLine.SETRANGE("Sales Order Line No.");
                                                                  PurchLine.SETFILTER("Special Order Sales Line No.",'<>0');
                                                                  IF NOT PurchLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Sell-to Customer No."));
                                                                END;

                                                                IF "Sell-to Customer No." = '' THEN
                                                                  VALIDATE("Location Code",UserSetupMgt.GetLocation(1,'',"Responsibility Center"))
                                                                ELSE
                                                                  VALIDATE("Ship-to Code",'');
                                                              END;

                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              DEA=Verk. an Deb.-Nr.] }
    { 73  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              DEA=Ursachencode] }
    { 74  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF (xRec."Buy-from Vendor No." = "Buy-from Vendor No.") AND
                                                                   (xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group")
                                                                THEN BEGIN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    "VAT Bus. Posting Group" := GenBusPostingGrp."Def. VAT Bus. Posting Group";
                                                                  RecreatePurchLines(FIELDCAPTION("Gen. Bus. Posting Group"));
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              DEA=Gesch„ftsbuchungsgruppe] }
    { 76  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION("Transaction Type"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Transaction Type;
                                                              DEA=Art des Gesch„ftes] }
    { 77  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION("Transport Method"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Transport Method;
                                                              DEA=Verkehrszweig] }
    { 78  ;   ;VAT Country/Region Code;Code10     ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=VAT Country/Region Code;
                                                              DEA=MwSt.-L„nder-/Regionscode] }
    { 79  ;   ;Buy-from Vendor Name;Text50        ;CaptionML=[ENU=Buy-from Vendor Name;
                                                              DEA=Eink. von Name] }
    { 80  ;   ;Buy-from Vendor Name 2;Text50      ;CaptionML=[ENU=Buy-from Vendor Name 2;
                                                              DEA=Eink. von Name 2] }
    { 81  ;   ;Buy-from Address    ;Text50        ;CaptionML=[ENU=Buy-from Address;
                                                              DEA=Eink. von Adresse] }
    { 82  ;   ;Buy-from Address 2  ;Text50        ;CaptionML=[ENU=Buy-from Address 2;
                                                              DEA=Eink. von Adresse 2] }
    { 83  ;   ;Buy-from City       ;Text30        ;TableRelation=IF (Buy-from Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Buy-from Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Buy-from Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Buy-from City","Buy-from Post Code","Buy-from County","Buy-from Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Buy-from City;
                                                              DEA=Eink. von Ort] }
    { 84  ;   ;Buy-from Contact    ;Text50        ;CaptionML=[ENU=Buy-from Contact;
                                                              DEA=Eink. von Kontakt] }
    { 85  ;   ;Pay-to Post Code    ;Code20        ;TableRelation=IF (Pay-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Pay-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Pay-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Pay-to Post Code;
                                                              DEA=Zahlung an PLZ-Code] }
    { 86  ;   ;Pay-to County       ;Text30        ;CaptionML=[ENU=Pay-to County;
                                                              DEA=Zahlung an Bundesregion] }
    { 87  ;   ;Pay-to Country/Region Code;Code10  ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Pay-to Country/Region Code;
                                                              DEA=Zahlung an L„nder-/Regionscode] }
    { 88  ;   ;Buy-from Post Code  ;Code20        ;TableRelation=IF (Buy-from Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Buy-from Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Buy-from Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Buy-from City","Buy-from Post Code","Buy-from County","Buy-from Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Buy-from Post Code;
                                                              DEA=Eink. von PLZ-Code] }
    { 89  ;   ;Buy-from County     ;Text30        ;CaptionML=[ENU=Buy-from County;
                                                              DEA=Eink. von Bundesregion] }
    { 90  ;   ;Buy-from Country/Region Code;Code10;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Buy-from Country/Region Code;
                                                              DEA=Eink. von L„nder-/Regionscode] }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to Post Code;
                                                              DEA=Lief. an PLZ-Code] }
    { 92  ;   ;Ship-to County      ;Text30        ;CaptionML=[ENU=Ship-to County;
                                                              DEA=Lief. an Bundesregion] }
    { 93  ;   ;Ship-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Ship-to Country/Region Code;
                                                              DEA=Lief. an L„nder-/Regionscode] }
    { 94  ;   ;Bal. Account Type   ;Option        ;CaptionML=[ENU=Bal. Account Type;
                                                              DEA=Gegenkontoart];
                                                   OptionCaptionML=[ENU=G/L Account,Bank Account;
                                                                    DEA=Sachkonto,Bankkonto];
                                                   OptionString=G/L Account,Bank Account }
    { 95  ;   ;Order Address Code  ;Code10        ;TableRelation="Order Address".Code WHERE (Vendor No.=FIELD(Buy-from Vendor No.));
                                                   OnValidate=BEGIN
                                                                IF "Order Address Code" <> '' THEN BEGIN
                                                                  OrderAddr.GET("Buy-from Vendor No.","Order Address Code");
                                                                  "Buy-from Vendor Name" := OrderAddr.Name;
                                                                  "Buy-from Vendor Name 2" := OrderAddr."Name 2";
                                                                  "Buy-from Address" := OrderAddr.Address;
                                                                  "Buy-from Address 2" := OrderAddr."Address 2";
                                                                  "Buy-from City" := OrderAddr.City;
                                                                  "Buy-from Contact" := OrderAddr.Contact;
                                                                  "Buy-from Post Code" := OrderAddr."Post Code";
                                                                  "Buy-from County" := OrderAddr.County;
                                                                  "Buy-from Country/Region Code" := OrderAddr."Country/Region Code";

                                                                  IF ("Document Type" = "Document Type"::"Return Order") OR
                                                                     ("Document Type" = "Document Type"::"Credit Memo")
                                                                  THEN BEGIN
                                                                    "Ship-to Name" := OrderAddr.Name;
                                                                    "Ship-to Name 2" := OrderAddr."Name 2";
                                                                    "Ship-to Address" := OrderAddr.Address;
                                                                    "Ship-to Address 2" := OrderAddr."Address 2";
                                                                    "Ship-to City" := OrderAddr.City;
                                                                    "Ship-to Post Code" := OrderAddr."Post Code";
                                                                    "Ship-to County" := OrderAddr.County;
                                                                    "Ship-to Country/Region Code" := OrderAddr."Country/Region Code";
                                                                    "Ship-to Contact" := OrderAddr.Contact;
                                                                  END
                                                                END ELSE BEGIN
                                                                  GetVend("Buy-from Vendor No.");
                                                                  "Buy-from Vendor Name" := Vend.Name;
                                                                  "Buy-from Vendor Name 2" := Vend."Name 2";
                                                                  "Buy-from Address" := Vend.Address;
                                                                  "Buy-from Address 2" := Vend."Address 2";
                                                                  "Buy-from City" := Vend.City;
                                                                  "Buy-from Contact" := Vend.Contact;
                                                                  "Buy-from Post Code" := Vend."Post Code";
                                                                  "Buy-from County" := Vend.County;
                                                                  "Buy-from Country/Region Code" := Vend."Country/Region Code";

                                                                  "Registration No." := Vend."Registration No.";

                                                                  IF ("Document Type" = "Document Type"::"Return Order") OR
                                                                     ("Document Type" = "Document Type"::"Credit Memo")
                                                                  THEN BEGIN
                                                                    "Ship-to Name" := Vend.Name;
                                                                    "Ship-to Name 2" := Vend."Name 2";
                                                                    "Ship-to Address" := Vend.Address;
                                                                    "Ship-to Address 2" := Vend."Address 2";
                                                                    "Ship-to City" := Vend.City;
                                                                    "Ship-to Post Code" := Vend."Post Code";
                                                                    "Ship-to County" := Vend.County;
                                                                    "Ship-to Country/Region Code" := Vend."Country/Region Code";
                                                                    "Ship-to Contact" := Vend.Contact;
                                                                    "Shipment Method Code" := Vend."Shipment Method Code";
                                                                    IF Vend."Location Code" <> '' THEN
                                                                      VALIDATE("Location Code",Vend."Location Code");
                                                                  END
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order Address Code;
                                                              DEA=Bestelladresscode] }
    { 97  ;   ;Entry Point         ;Code10        ;TableRelation="Entry/Exit Point";
                                                   OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION("Entry Point"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Entry Point;
                                                              DEA=Einstiegspunkt] }
    { 98  ;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              DEA=Storno] }
    { 99  ;   ;Document Date       ;Date          ;OnValidate=BEGIN
                                                                IF xRec."Document Date" <> "Document Date" THEN
                                                                  UpdateDocumentDate := TRUE;
                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");
                                                              END;

                                                   CaptionML=[ENU=Document Date;
                                                              DEA=Belegdatum] }
    { 101 ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION(Area),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Area;
                                                              DEA=Bestimmungsregion] }
    { 102 ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION("Transaction Specification"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Transaction Specification;
                                                              DEA=Verfahren] }
    { 104 ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   OnValidate=BEGIN
                                                                PaymentMethod.INIT;
                                                                IF "Payment Method Code" <> '' THEN
                                                                  PaymentMethod.GET("Payment Method Code");
                                                                "Bal. Account Type" := PaymentMethod."Bal. Account Type";
                                                                "Bal. Account No." := PaymentMethod."Bal. Account No.";
                                                                IF "Bal. Account No." <> '' THEN BEGIN
                                                                  TESTFIELD("Applies-to Doc. No.",'');
                                                                  TESTFIELD("Applies-to ID",'');
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Payment Method Code;
                                                              DEA=Zahlungsformcode] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              DEA=Nummernserie];
                                                   Editable=No }
    { 108 ;   ;Posting No. Series  ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Posting No. Series" <> '' THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  TestNoSeries;
                                                                  NoSeriesMgt.TestSeries(GetPostingNoSeriesCode,"Posting No. Series");
                                                                END;
                                                                TESTFIELD("Posting No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH PurchHeader DO BEGIN
                                                                PurchHeader := Rec;
                                                                PurchSetup.GET;
                                                                TestNoSeries;
                                                                IF NoSeriesMgt.LookupSeries(GetPostingNoSeriesCode,"Posting No. Series") THEN
                                                                  VALIDATE("Posting No. Series");
                                                                Rec := PurchHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Posting No. Series;
                                                              DEA=Buchungsnr.-Serie] }
    { 109 ;   ;Receiving No. Series;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Receiving No. Series" <> '' THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  PurchSetup.TESTFIELD("Posted Receipt Nos.");
                                                                  NoSeriesMgt.TestSeries(PurchSetup."Posted Receipt Nos.","Receiving No. Series");
                                                                END;
                                                                TESTFIELD("Receiving No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH PurchHeader DO BEGIN
                                                                PurchHeader := Rec;
                                                                PurchSetup.GET;
                                                                PurchSetup.TESTFIELD("Posted Receipt Nos.");
                                                                IF NoSeriesMgt.LookupSeries(PurchSetup."Posted Receipt Nos.","Receiving No. Series") THEN
                                                                  VALIDATE("Receiving No. Series");
                                                                Rec := PurchHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Receiving No. Series;
                                                              DEA=Lieferungsnr.-Serie] }
    { 114 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfPurchLinesExist(FIELDCAPTION("Tax Area Code"));
                                                              END;

                                                   CaptionML=[ENU=Tax Area Code;
                                                              DEA=Steuergebietscode] }
    { 115 ;   ;Tax Liable          ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfPurchLinesExist(FIELDCAPTION("Tax Liable"));
                                                              END;

                                                   CaptionML=[ENU=Tax Liable;
                                                              DEA=Steuerpflichtig] }
    { 116 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF (xRec."Buy-from Vendor No." = "Buy-from Vendor No.") AND
                                                                   (xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group")
                                                                THEN
                                                                  RecreatePurchLines(FIELDCAPTION("VAT Bus. Posting Group"));
                                                              END;

                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              DEA=MwSt.-Gesch„ftsbuchungsgruppe] }
    { 118 ;   ;Applies-to ID       ;Code50        ;OnValidate=VAR
                                                                TempVendLedgEntry@1000 : Record 25;
                                                              BEGIN
                                                                IF "Applies-to ID" <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');
                                                                IF ("Applies-to ID" <> xRec."Applies-to ID") AND (xRec."Applies-to ID" <> '') THEN BEGIN
                                                                  VendLedgEntry.SETCURRENTKEY("Vendor No.",Open);
                                                                  VendLedgEntry.SETRANGE("Vendor No.","Pay-to Vendor No.");
                                                                  VendLedgEntry.SETRANGE(Open,TRUE);
                                                                  VendLedgEntry.SETRANGE("Applies-to ID",xRec."Applies-to ID");
                                                                  IF VendLedgEntry.FINDFIRST THEN
                                                                    VendEntrySetApplID.SetApplId(VendLedgEntry,TempVendLedgEntry,'');
                                                                  VendLedgEntry.RESET;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Applies-to ID;
                                                              DEA=Ausgleichs-ID] }
    { 119 ;   ;VAT Base Discount % ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                IF "VAT Base Discount %" > GLSetup."VAT Tolerance %" THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed :=
                                                                      CONFIRM(
                                                                        Text007 +
                                                                        Text008,FALSE,
                                                                        FIELDCAPTION("VAT Base Discount %"),
                                                                        GLSetup.FIELDCAPTION("VAT Tolerance %"),
                                                                        GLSetup.TABLECAPTION);
                                                                  IF NOT Confirmed THEN
                                                                    "VAT Base Discount %" := xRec."VAT Base Discount %";
                                                                END;

                                                                IF ("VAT Base Discount %" = xRec."VAT Base Discount %") AND
                                                                   (CurrFieldNo <> 0)
                                                                THEN
                                                                  EXIT;

                                                                PurchLine.SETRANGE("Document Type","Document Type");
                                                                PurchLine.SETRANGE("Document No.","No.");
                                                                PurchLine.SETFILTER(Type,'<>%1',PurchLine.Type::" ");
                                                                PurchLine.SETFILTER(Quantity,'<>0');
                                                                PurchLine.LOCKTABLE;
                                                                IF PurchLine.FINDSET THEN BEGIN
                                                                  MODIFY;
                                                                  REPEAT
                                                                    PurchLine.UpdateAmounts;
                                                                    PurchLine.MODIFY;
                                                                  UNTIL PurchLine.NEXT = 0;
                                                                END;
                                                                PurchLine.RESET;
                                                              END;

                                                   CaptionML=[ENU=VAT Base Discount %;
                                                              DEA=MwSt.-Bemessungsgr. Skonto %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 120 ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionCaptionML=[ENU=Open,Released,Pending Approval,Pending Prepayment;
                                                                    DEA=Offen,Freigegeben,Genehmigung ausstehend,Vorauszahlung ausstehend];
                                                   OptionString=Open,Released,Pending Approval,Pending Prepayment;
                                                   Editable=No }
    { 121 ;   ;Invoice Discount Calculation;Option;CaptionML=[ENU=Invoice Discount Calculation;
                                                              DEA=Rechnungsrab.-Berechnung];
                                                   OptionCaptionML=[ENU=None,%,Amount;
                                                                    DEA=Kein,%,Betrag];
                                                   OptionString=None,%,Amount;
                                                   Editable=No }
    { 122 ;   ;Invoice Discount Value;Decimal     ;CaptionML=[ENU=Invoice Discount Value;
                                                              DEA=Rechnungsrab.-Wert];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 123 ;   ;Send IC Document    ;Boolean       ;OnValidate=BEGIN
                                                                IF "Send IC Document" THEN BEGIN
                                                                  TESTFIELD("Buy-from IC Partner Code");
                                                                  TESTFIELD("IC Direction","IC Direction"::Outgoing);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Send IC Document;
                                                              DEA=IC-Beleg senden] }
    { 124 ;   ;IC Status           ;Option        ;CaptionML=[ENU=IC Status;
                                                              DEA=IC-Status];
                                                   OptionCaptionML=[ENU=New,Pending,Sent;
                                                                    DEA=Neu,Offen,Gesendet];
                                                   OptionString=New,Pending,Sent }
    { 125 ;   ;Buy-from IC Partner Code;Code20    ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=Buy-from IC Partner Code;
                                                              DEA=Eink. von IC-Partnercode];
                                                   Editable=No }
    { 126 ;   ;Pay-to IC Partner Code;Code20      ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=Pay-to IC Partner Code;
                                                              DEA=Zahlung an IC-Partnercode];
                                                   Editable=No }
    { 129 ;   ;IC Direction        ;Option        ;OnValidate=BEGIN
                                                                IF "IC Direction" = "IC Direction"::Incoming THEN
                                                                  "Send IC Document" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=IC Direction;
                                                              DEA=IC-Richtung];
                                                   OptionCaptionML=[ENU=Outgoing,Incoming;
                                                                    DEA=Ausgehend,Eingehend];
                                                   OptionString=Outgoing,Incoming }
    { 130 ;   ;Prepayment No.      ;Code20        ;CaptionML=[ENU=Prepayment No.;
                                                              DEA=Vorauszahlungsnr.] }
    { 131 ;   ;Last Prepayment No. ;Code20        ;TableRelation="Purch. Inv. Header";
                                                   CaptionML=[ENU=Last Prepayment No.;
                                                              DEA=Letzte Vorauszahlungsnr.] }
    { 132 ;   ;Prepmt. Cr. Memo No.;Code20        ;CaptionML=[ENU=Prepmt. Cr. Memo No.;
                                                              DEA=Vorauszahlungs-Gutschriftnr.] }
    { 133 ;   ;Last Prepmt. Cr. Memo No.;Code20   ;TableRelation="Purch. Cr. Memo Hdr.";
                                                   CaptionML=[ENU=Last Prepmt. Cr. Memo No.;
                                                              DEA=Letzte Vorauszahlungs-Gutschriftnr.] }
    { 134 ;   ;Prepayment %        ;Decimal       ;OnValidate=BEGIN
                                                                IF xRec."Prepayment %" <> "Prepayment %" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Prepayment %"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Prepayment %;
                                                              DEA=Vorauszahlung %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 135 ;   ;Prepayment No. Series;Code10       ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepayment No. Series" <> '' THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  PurchSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series");
                                                                END;
                                                                TESTFIELD("Prepayment No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH PurchHeader DO BEGIN
                                                                PurchHeader := Rec;
                                                                PurchSetup.GET;
                                                                PurchSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series") THEN
                                                                  VALIDATE("Prepayment No. Series");
                                                                Rec := PurchHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Prepayment No. Series;
                                                              DEA=Vorauszahlung Nummernserie] }
    { 136 ;   ;Compress Prepayment ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Compress Prepayment;
                                                              DEA=Vorauszahlung komprimieren] }
    { 137 ;   ;Prepayment Due Date ;Date          ;CaptionML=[ENU=Prepayment Due Date;
                                                              DEA=F„lligkeitsdatum Vorauszahlung] }
    { 138 ;   ;Prepmt. Cr. Memo No. Series;Code10 ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepmt. Cr. Memo No. Series" <> '' THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  PurchSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series");
                                                                END;
                                                                TESTFIELD("Prepmt. Cr. Memo No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH PurchHeader DO BEGIN
                                                                PurchHeader := Rec;
                                                                PurchSetup.GET;
                                                                PurchSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series") THEN
                                                                  VALIDATE("Prepmt. Cr. Memo No. Series");
                                                                Rec := PurchHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Prepmt. Cr. Memo No. Series;
                                                              DEA=Vorauszahlungsgutschrift Nummernserie] }
    { 139 ;   ;Prepmt. Posting Description;Text50 ;CaptionML=[ENU=Prepmt. Posting Description;
                                                              DEA=Vorauszahlungs-Buchungsbeschreibung] }
    { 142 ;   ;Prepmt. Pmt. Discount Date;Date    ;CaptionML=[ENU=Prepmt. Pmt. Discount Date;
                                                              DEA=Skontodatum Vorauszahlung] }
    { 143 ;   ;Prepmt. Payment Terms Code;Code10  ;TableRelation="Payment Terms";
                                                   OnValidate=VAR
                                                                PaymentTerms@1000 : Record 3;
                                                              BEGIN
                                                                IF ("Prepmt. Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Prepmt. Payment Terms Code");
                                                                  IF (("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]) AND
                                                                      NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos")
                                                                  THEN BEGIN
                                                                    VALIDATE("Prepayment Due Date","Document Date");
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Prepayment Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Prepmt. Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    IF NOT UpdateDocumentDate THEN
                                                                      VALIDATE("Prepmt. Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Prepayment Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Payment Terms Code;
                                                              DEA=Zlg.-Bedingungscode Vorauszahlung] }
    { 144 ;   ;Prepmt. Payment Discount %;Decimal ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Payment Discount %;
                                                              DEA=Skonto % Vorauszahlung];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 151 ;   ;Quote No.           ;Code20        ;CaptionML=[ENU=Quote No.;
                                                              DEA=Angebotsnr.];
                                                   Editable=No }
    { 160 ;   ;Job Queue Status    ;Option        ;OnLookup=VAR
                                                              JobQueueEntry@1000 : Record 472;
                                                            BEGIN
                                                              IF "Job Queue Status" = "Job Queue Status"::" " THEN
                                                                EXIT;
                                                              JobQueueEntry.ShowStatusMsg("Job Queue Entry ID");
                                                            END;

                                                   CaptionML=[ENU=Job Queue Status;
                                                              DEA=Aufgabenwarteschlange - Status];
                                                   OptionCaptionML=[ENU=" ,Scheduled for Posting,Error,Posting";
                                                                    DEA=" ,Geplant fr Buchung,Fehler,Buchung"];
                                                   OptionString=[ ,Scheduled for Posting,Error,Posting];
                                                   Editable=No }
    { 161 ;   ;Job Queue Entry ID  ;GUID          ;CaptionML=[ENU=Job Queue Entry ID;
                                                              DEA=Aufgabenwarteschlange - Posten-ID];
                                                   Editable=No }
    { 165 ;   ;Incoming Document Entry No.;Integer;TableRelation="Incoming Document";
                                                   OnValidate=VAR
                                                                IncomingDocument@1000 : Record 130;
                                                              BEGIN
                                                                IF "Incoming Document Entry No." = xRec."Incoming Document Entry No." THEN
                                                                  EXIT;
                                                                IF "Incoming Document Entry No." = 0 THEN
                                                                  IncomingDocument.RemoveReferenceToWorkingDocument(xRec."Incoming Document Entry No.")
                                                                ELSE
                                                                  IncomingDocument.SetPurchDoc(Rec);
                                                              END;

                                                   CaptionML=[ENU=Incoming Document Entry No.;
                                                              DEA=Lfd. Nr. eingehender Beleg] }
    { 170 ;   ;Creditor No.        ;Code20        ;CaptionML=[ENU=Creditor No.;
                                                              DEA=Gl„ubiger-Identifikationsnummer];
                                                   Numeric=Yes }
    { 171 ;   ;Payment Reference   ;Code50        ;OnValidate=BEGIN
                                                                IF "Payment Reference" <> '' THEN
                                                                  TESTFIELD("Creditor No.");
                                                              END;

                                                   CaptionML=[ENU=Payment Reference;
                                                              DEA=Zahlungsreferenz];
                                                   Numeric=Yes }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDocDim;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              DEA=Dimensionssatz-ID];
                                                   Editable=No }
    { 1305;   ;Invoice Discount Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Inv. Discount Amount" WHERE (Document No.=FIELD(No.),
                                                                                                                 Document Type=FIELD(Document Type)));
                                                   CaptionML=[ENU=Invoice Discount Amount;
                                                              DEA=Rechnungsrab.-Betrag];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5043;   ;No. of Archived Versions;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Max("Purchase Header Archive"."Version No." WHERE (Document Type=FIELD(Document Type),
                                                                                                                  No.=FIELD(No.),
                                                                                                                  Doc. No. Occurrence=FIELD(Doc. No. Occurrence)));
                                                   CaptionML=[ENU=No. of Archived Versions;
                                                              DEA=Anz. archivierter Versionen];
                                                   Editable=No }
    { 5048;   ;Doc. No. Occurrence ;Integer       ;CaptionML=[ENU=Doc. No. Occurrence;
                                                              DEA=Belegnr.-H„ufigkeit] }
    { 5050;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   OnValidate=BEGIN
                                                                CreateDim(
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::Vendor,"Pay-to Vendor No.",
                                                                  DATABASE::"Salesperson/Purchaser","Purchaser Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center");
                                                              END;

                                                   CaptionML=[ENU=Campaign No.;
                                                              DEA=Kampagnennr.] }
    { 5052;   ;Buy-from Contact No.;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1000 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF ("Buy-from Contact No." <> xRec."Buy-from Contact No.") AND
                                                                   (xRec."Buy-from Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Buy-from Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    PurchLine.SETRANGE("Document Type","Document Type");
                                                                    PurchLine.SETRANGE("Document No.","No.");
                                                                    IF ("Buy-from Contact No." = '') AND ("Buy-from Vendor No." = '') THEN BEGIN
                                                                      IF NOT PurchLine.ISEMPTY THEN
                                                                        ERROR(
                                                                          Text005,
                                                                          FIELDCAPTION("Buy-from Contact No."));
                                                                      INIT;
                                                                      PurchSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Buy-from Vendor No." <> '') AND ("Buy-from Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Buy-from Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
                                                                  ContBusinessRelation.SETRANGE("No.","Buy-from Vendor No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    IF ContBusinessRelation."Contact No." <> Cont."Company No." THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Buy-from Vendor No.");
                                                                END;

                                                                UpdateBuyFromVend("Buy-from Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Buy-from Vendor No." <> '' THEN
                                                                IF Cont.GET("Buy-from Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
                                                                  ContBusinessRelation.SETRANGE("No.","Buy-from Vendor No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Buy-from Contact No." <> '' THEN
                                                                IF Cont.GET("Buy-from Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Buy-from Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Buy-from Contact No.;
                                                              DEA=Eink. von Kontaktnr.] }
    { 5053;   ;Pay-to Contact No.  ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1004 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF ("Pay-to Contact No." <> xRec."Pay-to Contact No.") AND
                                                                   (xRec."Pay-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Pay-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    PurchLine.SETRANGE("Document Type","Document Type");
                                                                    PurchLine.SETRANGE("Document No.","No.");
                                                                    IF ("Pay-to Contact No." = '') AND ("Pay-to Vendor No." = '') THEN BEGIN
                                                                      IF NOT PurchLine.ISEMPTY THEN
                                                                        ERROR(
                                                                          Text005,
                                                                          FIELDCAPTION("Pay-to Contact No."));
                                                                      INIT;
                                                                      PurchSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Pay-to Contact No." := xRec."Pay-to Contact No.";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Pay-to Vendor No." <> '') AND ("Pay-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Pay-to Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
                                                                  ContBusinessRelation.SETRANGE("No.","Pay-to Vendor No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    IF ContBusinessRelation."Contact No." <> Cont."Company No." THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Pay-to Vendor No.");
                                                                END;

                                                                UpdatePayToVend("Pay-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1000 : Record 5050;
                                                              ContBusinessRelation@1001 : Record 5054;
                                                            BEGIN
                                                              IF "Pay-to Vendor No." <> '' THEN
                                                                IF Cont.GET("Pay-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
                                                                  ContBusinessRelation.SETRANGE("No.","Pay-to Vendor No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Pay-to Contact No." <> '' THEN
                                                                IF Cont.GET("Pay-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Pay-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Pay-to Contact No.;
                                                              DEA=Zahlung an Kontaktnr.] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF NOT UserSetupMgt.CheckRespCenter(1,"Responsibility Center") THEN
                                                                  ERROR(
                                                                    Text028,
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetPurchasesFilter);

                                                                "Location Code" := UserSetupMgt.GetLocation(1,'',"Responsibility Center");
                                                                IF "Location Code" = '' THEN BEGIN
                                                                  IF InvtSetup.GET THEN
                                                                    "Inbound Whse. Handling Time" := InvtSetup."Inbound Whse. Handling Time";
                                                                END ELSE BEGIN
                                                                  IF Location.GET("Location Code") THEN;
                                                                  "Inbound Whse. Handling Time" := Location."Inbound Whse. Handling Time";
                                                                END;

                                                                UpdateShipToAddress;

                                                                CreateDim(
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::Vendor,"Pay-to Vendor No.",
                                                                  DATABASE::"Salesperson/Purchaser","Purchaser Code",
                                                                  DATABASE::Campaign,"Campaign No.");

                                                                IF xRec."Responsibility Center" <> "Responsibility Center" THEN BEGIN
                                                                  RecreatePurchLines(FIELDCAPTION("Responsibility Center"));
                                                                  "Assigned User ID" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Responsibility Center;
                                                              DEA=Zust„ndigkeitseinheitencode] }
    { 5752;   ;Completely Received ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Purchase Line"."Completely Received" WHERE (Document Type=FIELD(Document Type),
                                                                                                                Document No.=FIELD(No.),
                                                                                                                Type=FILTER(<>' '),
                                                                                                                Location Code=FIELD(Location Filter)));
                                                   CaptionML=[ENU=Completely Received;
                                                              DEA=Komplettlieferung (Eingang)];
                                                   Editable=No }
    { 5753;   ;Posting from Whse. Ref.;Integer    ;AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Posting from Whse. Ref.;
                                                              DEA=Buchung von Lagerref.-Nr.] }
    { 5754;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location;
                                                   CaptionML=[ENU=Location Filter;
                                                              DEA=Lagerortfilter] }
    { 5790;   ;Requested Receipt Date;Date        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Promised Receipt Date" <> 0D THEN
                                                                  ERROR(
                                                                    Text034,
                                                                    FIELDCAPTION("Requested Receipt Date"),
                                                                    FIELDCAPTION("Promised Receipt Date"));

                                                                IF "Requested Receipt Date" <> xRec."Requested Receipt Date" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Requested Receipt Date"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Requested Receipt Date;
                                                              DEA=Gewnschtes Wareneingangsdatum] }
    { 5791;   ;Promised Receipt Date;Date         ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Promised Receipt Date" <> xRec."Promised Receipt Date" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Promised Receipt Date"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Promised Receipt Date;
                                                              DEA=Zugesagtes Wareneingangsdatum] }
    { 5792;   ;Lead Time Calculation;DateFormula  ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Lead Time Calculation" <> xRec."Lead Time Calculation" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Lead Time Calculation"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Lead Time Calculation;
                                                              DEA=Beschaffungszeit] }
    { 5793;   ;Inbound Whse. Handling Time;DateFormula;
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Inbound Whse. Handling Time" <> xRec."Inbound Whse. Handling Time" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Inbound Whse. Handling Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Inbound Whse. Handling Time;
                                                              DEA=Eingeh. Lagerdurchlaufzeit] }
    { 5796;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              DEA=Datumsfilter] }
    { 5800;   ;Vendor Authorization No.;Code35    ;CaptionML=[ENU=Vendor Authorization No.;
                                                              DEA=Kreditorenbearbeitungsnr.] }
    { 5801;   ;Return Shipment No. ;Code20        ;CaptionML=[ENU=Return Shipment No.;
                                                              DEA=Rcklieferungsnr.] }
    { 5802;   ;Return Shipment No. Series;Code10  ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Return Shipment No. Series" <> '' THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  PurchSetup.TESTFIELD("Posted Return Shpt. Nos.");
                                                                  NoSeriesMgt.TestSeries(PurchSetup."Posted Return Shpt. Nos.","Return Shipment No. Series");
                                                                END;
                                                                TESTFIELD("Return Shipment No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH PurchHeader DO BEGIN
                                                                PurchHeader := Rec;
                                                                PurchSetup.GET;
                                                                PurchSetup.TESTFIELD("Posted Return Shpt. Nos.");
                                                                IF NoSeriesMgt.LookupSeries(PurchSetup."Posted Return Shpt. Nos.","Return Shipment No. Series") THEN
                                                                  VALIDATE("Return Shipment No. Series");
                                                                Rec := PurchHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Return Shipment No. Series;
                                                              DEA=Rcklieferungsnr.-Serie] }
    { 5803;   ;Ship                ;Boolean       ;CaptionML=[ENU=Ship;
                                                              DEA=Warenausgang] }
    { 5804;   ;Last Return Shipment No.;Code20    ;TableRelation="Return Shipment Header";
                                                   CaptionML=[ENU=Last Return Shipment No.;
                                                              DEA=Letzte Rcklieferungsnr.];
                                                   Editable=No }
    { 9000;   ;Assigned User ID    ;Code50        ;TableRelation="User Setup";
                                                   OnValidate=BEGIN
                                                                IF NOT UserSetupMgt.CheckRespCenter2(1,"Responsibility Center","Assigned User ID") THEN
                                                                  ERROR(
                                                                    Text049,"Assigned User ID",
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetPurchasesFilter2("Assigned User ID"));
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              DEA=Zugewiesene Benutzer-ID] }
    { 9001;   ;Pending Approvals   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Approval Entry" WHERE (Table ID=CONST(38),
                                                                                             Document Type=FIELD(Document Type),
                                                                                             Document No.=FIELD(No.),
                                                                                             Status=FILTER(Open|Created)));
                                                   CaptionML=[ENU=Pending Approvals;
                                                              DEA=Ausstehende Genehmigungen] }
    { 11000;  ;Registration No.    ;Text20        ;CaptionML=[ENU=Registration No.;
                                                              DEA=Steuernummer] }
    { 70000;  ;CM Is CMMS Purchase Order;Boolean  ;CaptionML=[ENU=Is CMMS Purchase Order;
                                                              DEA=Ist CMMS Bestellung] }
    { 70005;  ;CM Company          ;Text30        ;TableRelation=Company.Name;
                                                   OnValidate=VAR
                                                                CMGenMgt@1000000000 : Codeunit 70000;
                                                              BEGIN
                                                                //ENC
                                                                CMGenMgt.CMCompanyOnValidate(Rec);
                                                              END;

                                                   CaptionML=[ENU=Company;
                                                              DEA=Mandant] }
    { 70010;  ;CM Vendor No.       ;Code20        ;OnValidate=VAR
                                                                CMGenMgt@1000000000 : Codeunit 70000;
                                                              BEGIN
                                                                //ENC
                                                                CMGenMgt.CMVendorNoOnValidate(Rec);
                                                              END;

                                                   OnLookup=VAR
                                                              CMGenMgt@1000000000 : Codeunit 70000;
                                                            BEGIN
                                                              //ENC
                                                              CMGenMgt.CMVendorNoOnLookup(Rec);
                                                            END;

                                                   CaptionML=[ENU=Vender No.;
                                                              DEA=Kreditor Nr.] }
    { 90000;  ;IG Status Code      ;Code20        ;CaptionML=[ENU=Processing Status;
                                                              DEA=Bearbeitungsstatus];
                                                   Description=IG }
    { 90001;  ;IG Status Name      ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IG Status Sequence Header".Description WHERE (Type=CONST(status),
                                                                                                                     Code=FIELD(IG Status Code)));
                                                   CaptionML=[ENU=Processing Status;
                                                              DEA=Bearbeitungsstatus];
                                                   Description=FF;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Document Type,No.                       ;Clustered=Yes }
    {    ;No.,Document Type                        }
    {    ;Document Type,Buy-from Vendor No.        }
    {    ;Document Type,Pay-to Vendor No.          }
    {    ;Buy-from Vendor No.                      }
    {    ;Incoming Document Entry No.              }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text003@1003 : TextConst 'ENU=You cannot rename a %1.;DEA=Sie k”nnen einen %1 nicht umbenennen.';
      Text004@1004 : TextConst 'ENU=Do you want to change %1?;DEA=M”chten Sie %1 „ndern?';
      Text005@1005 : TextConst 'ENU=You cannot reset %1 because the document still has one or more lines.;DEA=Sie k”nnen %1 nicht zurcksetzen, da der Beleg eine oder mehrere Zeilen enth„lt.';
      Text006@1006 : TextConst 'ENU=You cannot change %1 because the order is associated with one or more sales orders.;DEA=Sie k”nnen %1 nicht „ndern, da die Bestellung zu einem oder mehreren Auftr„gen geh”rt.';
      Text007@1007 : TextConst 'ENU=%1 is greater than %2 in the %3 table.\;DEA=%1 ist gr”áer als %2 in der Tabelle %3.\';
      Text008@1008 : TextConst 'ENU=Confirm change?;DEA=Žnderung best„tigen?';
      Text009@1009 : TextConst 'ENU="Deleting this document will cause a gap in the number series for receipts. ";DEA="Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie der Lieferungen. "';
      Text010@1010 : TextConst 'ENU=An empty receipt %1 will be created to fill this gap in the number series.\\;DEA=Die leere Lieferung %1 wird erzeugt, um die Lcke in der Nummernserie auszufllen.\\';
      Text011@1011 : TextConst 'ENU=Do you want to continue?;DEA=M”chten Sie fortfahren?';
      Text012@1012 : TextConst 'ENU="Deleting this document will cause a gap in the number series for posted invoices. ";DEA="Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie der gebuchten Rechnungen. "';
      Text013@1013 : TextConst 'ENU=An empty posted invoice %1 will be created to fill this gap in the number series.\\;DEA=Die leere gebuchte Rechnung %1 wird erzeugt, um die Lcke in der Nummernserie auszufllen.\\';
      Text014@1014 : TextConst 'ENU="Deleting this document will cause a gap in the number series for posted credit memos. ";DEA="Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie fr gebuchte Gutschriften. "';
      Text015@1015 : TextConst 'ENU=An empty posted credit memo %1 will be created to fill this gap in the number series.\\;DEA=Die leere Gutschrift %1 wird erzeugt, um die Lcke in der Nummernserie auszufllen.\\';
      Text016@1016 : TextConst 'ENU=If you change %1, the existing purchase lines will be deleted and new purchase lines based on the new information in the header will be created.\\;DEA=Wenn Sie %1 „ndern, werden vorhandene Einkaufszeilen gel”scht und neue Einkaufszeilen basierend auf den neuen Informationen des Kopfes werden erstellt.\\';
      Text018@1017 : TextConst 'ENU=You must delete the existing purchase lines before you can change %1.;DEA=Sie mssen die vorhandenen Einkaufszeilen l”schen, bevor Sie das Feld %1 „ndern k”nnen.';
      Text019@1018 : TextConst 'ENU=You have changed %1 on the purchase header, but it has not been changed on the existing purchase lines.\;DEA=Sie haben das Feld %1 im Einkaufskopf ge„ndert, aber die dazugeh”rigen Einkaufszeilen wurden nicht ge„ndert.\';
      Text020@1019 : TextConst 'ENU=You must update the existing purchase lines manually.;DEA=Sie mssen die vorhandenen Einkaufszeilen manuell aktualisieren.';
      Text021@1020 : TextConst 'ENU=The change may affect the exchange rate used on the price calculation of the purchase lines.;DEA=Die Žnderung kann eventuell den Wechselkurs, der fr die Preiskalkulation der Einkaufszeilen verwendet wurde, beinflussen.';
      Text022@1021 : TextConst 'ENU=Do you want to update the exchange rate?;DEA=M”chten Sie den Wechselkurs „ndern?';
      Text023@1022 : TextConst 'ENU=You cannot delete this document. Your identification is set up to process from %1 %2 only.;DEA=Sie k”nnen diesen Beleg nicht l”schen. Ihre Benutzereinrichtung l„sst nur %1 %2 zu.';
      Text025@1024 : TextConst 'ENU="You have modified the %1 field. Note that the recalculation of VAT may cause penny differences, so you must check the amounts afterwards. ";DEA="Sie haben das Feld %1 ge„ndert. Beachten Sie, dass die Neuberechnung der MwSt. Differenzen im Dezimalbereich hervorrufen kann und Sie daher anschlieáend die Betr„ge berprfen mssen. "';
      Text027@1026 : TextConst 'ENU=Do you want to update the %2 field on the lines to reflect the new value of %1?;DEA=M”chten Sie das Feld %2 in den Zeilen aktualisieren, um den neuen Wert der %1 abzubilden?';
      Text028@1027 : TextConst 'ENU=Your identification is set up to process from %1 %2 only.;DEA=Ihre Benutzereinrichtung l„sst nur %1 %2 zu.';
      Text029@1028 : TextConst 'ENU="Deleting this document will cause a gap in the number series for return shipments. ";DEA="Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie fr Rcklieferungen. "';
      Text030@1029 : TextConst 'ENU=An empty return shipment %1 will be created to fill this gap in the number series.\\;DEA=Die leere Rcklieferung %1 wird erstellt, um die Lcke in der Nummernserie auszufllen.\\';
      Text032@1031 : TextConst 'ENU=You have modified %1.\\;DEA=Sie haben das Feld %1 ge„ndert.\\';
      Text033@1032 : TextConst 'ENU=Do you want to update the lines?;DEA=M”chten Sie die Zeilen aktualisieren?';
      PurchSetup@1033 : Record 312;
      GLSetup@1034 : Record 98;
      GLAcc@1035 : Record 15;
      PurchLine@1036 : Record 39;
      xPurchLine@1080 : Record 39;
      VendLedgEntry@1037 : Record 25;
      Vend@1038 : Record 23;
      PaymentTerms@1039 : Record 3;
      PaymentMethod@1040 : Record 289;
      CurrExchRate@1041 : Record 330;
      PurchHeader@1042 : Record 38;
      PurchCommentLine@1043 : Record 43;
      ShipToAddr@1044 : Record 222;
      Cust@1045 : Record 18;
      CompanyInfo@1046 : Record 79;
      PostCode@1047 : Record 225;
      OrderAddr@1048 : Record 224;
      BankAcc@1049 : Record 270;
      PurchRcptHeader@1050 : Record 120;
      PurchInvHeader@1051 : Record 122;
      PurchCrMemoHeader@1052 : Record 124;
      ReturnShptHeader@1053 : Record 6650;
      PurchInvHeaderPrepmt@1090 : Record 122;
      PurchCrMemoHeaderPrepmt@1089 : Record 124;
      GenBusPostingGrp@1054 : Record 250;
      GenJnILine@1055 : Record 81;
      RespCenter@1056 : Record 5714;
      Location@1057 : Record 14;
      WhseRequest@1058 : Record 5765;
      InvtSetup@1059 : Record 313;
      NoSeriesMgt@1060 : Codeunit 396;
      TransferExtendedText@1061 : Codeunit 378;
      GenJnlApply@1062 : Codeunit 225;
      PurchPost@1063 : Codeunit 90;
      VendEntrySetApplID@1064 : Codeunit 111;
      DimMgt@1065 : Codeunit 408;
      ApprovalsMgmt@1082 : Codeunit 1535;
      UserSetupMgt@1066 : Codeunit 5700;
      ArchiveManagement@1074 : Codeunit 5063;
      ApplyVendEntries@1068 : Page 233;
      CurrencyDate@1069 : Date;
      HideValidationDialog@1070 : Boolean;
      Confirmed@1071 : Boolean;
      Text034@1072 : TextConst 'ENU=You cannot change the %1 when the %2 has been filled in.;DEA=Sie k”nnen das %1 nicht „ndern, wenn das %2 ausgefllt wurde.';
      Text037@1076 : TextConst 'ENU=Contact %1 %2 is not related to vendor %3.;DEA=Kontakt %1 %2 ist nicht mit Kreditor %3 verknpft.';
      Text038@1075 : TextConst 'ENU=Contact %1 %2 is related to a different company than vendor %3.;DEA=Kontakt %1 %2 ist mit einem anderen Unternehmen als Kreditor %3 verknpft.';
      Text039@1077 : TextConst 'ENU=Contact %1 %2 is not related to a vendor.;DEA=Kontakt %1 %2 ist mit keinem Kreditor verknpft.';
      SkipBuyFromContact@1030 : Boolean;
      SkipPayToContact@1078 : Boolean;
      Text040@1079 : TextConst 'ENU="You can not change the %1 field because %2 %3 has %4 = %5 and the %6 has already been assigned %7 %8.";DEA=Sie k”nnen das Feld %1 nicht „ndern, da die %2 %3 als %4 %5 hat und dem Beleg der Art %6 bereits die %7 %8 zugewiesen wurde.';
      Text041@1182 : TextConst 'ENU=The purchase %1 %2 has item tracking. Do you want to delete it anyway?;DEA=Fr den Einkauf %1 %2 wurde Artikelverfolgung festgelegt. M”chten Sie ihn trotzdem l”schen?';
      Text042@1084 : TextConst 'ENU=You must cancel the approval process if you wish to change the %1.;DEA=Der Genehmigungsprozess muss abgebrochen werden, wenn Sie %1 „ndern m”chten.';
      Text045@1086 : TextConst 'ENU=Deleting this document will cause a gap in the number series for prepayment invoices. An empty prepayment invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?;DEA=Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie fr Vorauszahlungsrechnungen. Die leere Vorauszahlungsrechnung ''%1'' wird erstellt, um die Lcke in der Nummernserie zu schlieáen.\\Soll der Vorgang fortgesetzt werden?';
      Text046@1087 : TextConst 'ENU=Deleting this document will cause a gap in the number series for prepayment credit memos. An empty prepayment credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?;DEA=Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie fr Vorauszahlungsgutschriften. Die leere gebuchte Vorauszahlungsgutschrift ''%1'' wird erstellt, um die Lcke in der Nummernserie zu schlieáen.\\Soll der Vorgang fortgesetzt werden?';
      Text049@1092 : TextConst 'ENU=%1 is set up to process from %2 %3 only.;DEA=%1 ist nur fr die Verarbeitung von %2 %3 eingerichtet.';
      Text050@1067 : TextConst 'ENU=Reservations exist for this order. These reservations will be canceled if a date conflict is caused by this change.\\;DEA=Fr die Bestellung sind Reservierungen vorhanden. Die Reservierungen werden storniert, falls durch die Žnderung ein Datumskonflikt verursacht wird.\\';
      Text051@1025 : TextConst 'ENU=You may have changed a dimension.\\Do you want to update the lines?;DEA=Sie haben unter Umst„nden eine Dimension ge„ndert.\\M”chten Sie die Zeilen aktualisieren?';
      Text052@1091 : TextConst 'ENU=The %1 field on the purchase order %2 must be the same as on sales order %3.;DEA=Das Feld ''%1'' in der Einkaufsbestellung ''%2'' muss dem Feld im Verkaufsauftrag ''%3'' entsprechen.';
      NameAddressDetails@1093 : Text[512];
      DropShptNameAddressDetails@1094 : Text[512];
      SpecOrderNameAddressDetails@1121 : Text[512];
      UpdateDocumentDate@1120 : Boolean;
      Text053@1095 : TextConst 'ENU=There are unposted prepayment amounts on the document of type %1 with the number %2.;DEA=Fr den Beleg vom Typ ''%1'' mit der Nummer %2 sind ungebuchte Vorauszahlungsbetr„ge vorhanden.';
      Text054@1096 : TextConst 'ENU=There are unpaid prepayment invoices that are related to the document of type %1 with the number %2.;DEA=Fr den Beleg vom Typ %1 mit der Nummer %2 sind unbezahlte Vorauszahlungsrechnungen vorhanden.';
      DeferralLineQst@1155 : TextConst '@@@="%1=The posting date on the document.";ENU=You have changed the %1 on the purchase header, do you want to update the deferral schedules for the lines with this date?;DEA=Sie haben %1 auf dem Einkaufskopf ge„ndert. M”chten Sie die Abgrenzungspl„ne fr die Zeilen mit diesem Datum „ndern?';
      ChangeCurrencyQst@1073 : TextConst 'ENU=If you change %1, the existing purchase lines will be deleted and new purchase lines based on the new information in the header will be created. You may need to update the price information manually.\\Do you want to change %1?;DEA=Wenn Sie %1 „ndern, werden die vorhandenen Einkaufszeilen gel”scht und neue Einkaufszeilen auf der Grundlage der neuen Kopfinformationen erstellt. M”glicherweise mssen Sie die Preisinformationen manuell aktualisieren.\\M”chten Sie %1 „ndern?';
      PostedDocsToPrintCreatedMsg@1081 : TextConst 'ENU=One or more documents have been posted during deletion, which you can print from the related posted document.;DEA=Mindestens ein Beleg wurde w„hrend des L”schens gebucht, den Sie ber den dazugeh”renden gebuchten Beleg drucken k”nnen.';

    LOCAL PROCEDURE InitInsert@41();
    BEGIN
      IF "No." = '' THEN BEGIN
        TestNoSeries;
        NoSeriesMgt.InitSeries(GetNoSeriesCode,xRec."No. Series","Posting Date","No.","No. Series");
      END;

      InitRecord;
    END;

    LOCAL PROCEDURE SkipInitialization@42() : Boolean;
    BEGIN
      IF "No." = '' THEN
        EXIT(FALSE);

      IF "Buy-from Vendor No." = '' THEN
        EXIT(FALSE);

      IF xRec."Document Type" <> "Document Type" THEN
        EXIT(FALSE);

      IF GETFILTER("Buy-from Vendor No.") <> '' THEN
        IF GETRANGEMIN("Buy-from Vendor No.") = GETRANGEMAX("Buy-from Vendor No.") THEN
          IF "Buy-from Vendor No." = GETRANGEMIN("Buy-from Vendor No.") THEN
            EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE InitRecord@10();
    BEGIN
      PurchSetup.GET;

      CASE "Document Type" OF
        "Document Type"::Quote,"Document Type"::Order:
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",PurchSetup."Posted Invoice Nos.");
            NoSeriesMgt.SetDefaultSeries("Receiving No. Series",PurchSetup."Posted Receipt Nos.");
            IF "Document Type" = "Document Type"::Order THEN BEGIN
              NoSeriesMgt.SetDefaultSeries("Prepayment No. Series",PurchSetup."Posted Prepmt. Inv. Nos.");
              NoSeriesMgt.SetDefaultSeries("Prepmt. Cr. Memo No. Series",PurchSetup."Posted Prepmt. Cr. Memo Nos.");
            END;
          END;
        "Document Type"::Invoice:
          BEGIN
            IF ("No. Series" <> '') AND
               (PurchSetup."Invoice Nos." = PurchSetup."Posted Invoice Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",PurchSetup."Posted Invoice Nos.");
            IF PurchSetup."Receipt on Invoice" THEN
              NoSeriesMgt.SetDefaultSeries("Receiving No. Series",PurchSetup."Posted Receipt Nos.");
          END;
        "Document Type"::"Return Order":
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",PurchSetup."Posted Credit Memo Nos.");
            NoSeriesMgt.SetDefaultSeries("Return Shipment No. Series",PurchSetup."Posted Return Shpt. Nos.");
          END;
        "Document Type"::"Credit Memo":
          BEGIN
            IF ("No. Series" <> '') AND
               (PurchSetup."Credit Memo Nos." = PurchSetup."Posted Credit Memo Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",PurchSetup."Posted Credit Memo Nos.");
            IF PurchSetup."Return Shipment on Credit Memo" THEN
              NoSeriesMgt.SetDefaultSeries("Return Shipment No. Series",PurchSetup."Posted Return Shpt. Nos.");
          END;
      END;

      IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice,"Document Type"::"Return Order"] THEN
        "Order Date" := WORKDATE;

      IF "Document Type" = "Document Type"::Invoice THEN
        "Expected Receipt Date" := WORKDATE;

      IF NOT ("Document Type" IN ["Document Type"::"Blanket Order","Document Type"::Quote]) AND
         ("Posting Date" = 0D)
      THEN
        "Posting Date" := WORKDATE;

      IF PurchSetup."Default Posting Date" = PurchSetup."Default Posting Date"::"No Date" THEN
        "Posting Date" := 0D;

      "Document Date" := WORKDATE;

      VALIDATE("Sell-to Customer No.",'');

      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
        GLSetup.GET;
        Correction := GLSetup."Mark Cr. Memos as Corrections";
      END;

      "Posting Description" := FORMAT("Document Type") + ' ' + "No.";

      IF InvtSetup.GET THEN
        "Inbound Whse. Handling Time" := InvtSetup."Inbound Whse. Handling Time";

      "Responsibility Center" := UserSetupMgt.GetRespCenter(1,"Responsibility Center");
    END;

    LOCAL PROCEDURE InitNoSeries@52();
    BEGIN
      IF xRec."Receiving No." <> '' THEN BEGIN
        "Receiving No. Series" := xRec."Receiving No. Series";
        "Receiving No." := xRec."Receiving No.";
      END;
      IF xRec."Posting No." <> '' THEN BEGIN
        "Posting No. Series" := xRec."Posting No. Series";
        "Posting No." := xRec."Posting No.";
      END;
      IF xRec."Return Shipment No." <> '' THEN BEGIN
        "Return Shipment No. Series" := xRec."Return Shipment No. Series";
        "Return Shipment No." := xRec."Return Shipment No.";
      END;
      IF xRec."Prepayment No." <> '' THEN BEGIN
        "Prepayment No. Series" := xRec."Prepayment No. Series";
        "Prepayment No." := xRec."Prepayment No.";
      END;
      IF xRec."Prepmt. Cr. Memo No." <> '' THEN BEGIN
        "Prepmt. Cr. Memo No. Series" := xRec."Prepmt. Cr. Memo No. Series";
        "Prepmt. Cr. Memo No." := xRec."Prepmt. Cr. Memo No.";
      END;
    END;

    PROCEDURE AssistEdit@2(OldPurchHeader@1000 : Record 38) : Boolean;
    BEGIN
      PurchSetup.GET;
      TestNoSeries;
      IF NoSeriesMgt.SelectSeries(GetNoSeriesCode,OldPurchHeader."No. Series","No. Series") THEN BEGIN
        PurchSetup.GET;
        TestNoSeries;
        NoSeriesMgt.SetSeries("No.");
        EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE TestNoSeries@6() : Boolean;
    BEGIN
      PurchSetup.GET;
      CASE "Document Type" OF
        "Document Type"::Quote:
          PurchSetup.TESTFIELD("Quote Nos.");
        "Document Type"::Order:
          PurchSetup.TESTFIELD("Order Nos.");
        "Document Type"::Invoice:
          BEGIN
            PurchSetup.TESTFIELD("Invoice Nos.");
            PurchSetup.TESTFIELD("Posted Invoice Nos.");
          END;
        "Document Type"::"Return Order":
          PurchSetup.TESTFIELD("Return Order Nos.");
        "Document Type"::"Credit Memo":
          BEGIN
            PurchSetup.TESTFIELD("Credit Memo Nos.");
            PurchSetup.TESTFIELD("Posted Credit Memo Nos.");
          END;
        "Document Type"::"Blanket Order":
          PurchSetup.TESTFIELD("Blanket Order Nos.");
      END;
    END;

    LOCAL PROCEDURE GetNoSeriesCode@9() : Code[10];
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(PurchSetup."Quote Nos.");
        "Document Type"::Order:
          EXIT(PurchSetup."Order Nos.");
        "Document Type"::Invoice:
          EXIT(PurchSetup."Invoice Nos.");
        "Document Type"::"Return Order":
          EXIT(PurchSetup."Return Order Nos.");
        "Document Type"::"Credit Memo":
          EXIT(PurchSetup."Credit Memo Nos.");
        "Document Type"::"Blanket Order":
          EXIT(PurchSetup."Blanket Order Nos.");
      END;
    END;

    LOCAL PROCEDURE GetPostingNoSeriesCode@8() : Code[10];
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT(PurchSetup."Posted Credit Memo Nos.");
      EXIT(PurchSetup."Posted Invoice Nos.");
    END;

    LOCAL PROCEDURE GetPostingPrepaymentNoSeriesCode@37() : Code[10];
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT(PurchSetup."Posted Prepmt. Cr. Memo Nos.");
      EXIT(PurchSetup."Posted Prepmt. Inv. Nos.");
    END;

    LOCAL PROCEDURE TestNoSeriesDate@40(No@1000 : Code[20];NoSeriesCode@1001 : Code[10];NoCapt@1002 : Text[1024];NoSeriesCapt@1004 : Text[1024]);
    VAR
      NoSeries@1005 : Record 308;
    BEGIN
      IF (No <> '') AND (NoSeriesCode <> '') THEN BEGIN
        NoSeries.GET(NoSeriesCode);
        IF NoSeries."Date Order" THEN
          ERROR(
            Text040,
            FIELDCAPTION("Posting Date"),NoSeriesCapt,NoSeriesCode,
            NoSeries.FIELDCAPTION("Date Order"),NoSeries."Date Order","Document Type",
            NoCapt,No);
      END;
    END;

    PROCEDURE ConfirmDeletion@11() : Boolean;
    BEGIN
      PurchPost.TestDeleteHeader(
        Rec,PurchRcptHeader,PurchInvHeader,PurchCrMemoHeader,
        ReturnShptHeader,PurchInvHeaderPrepmt,PurchCrMemoHeaderPrepmt);
      IF PurchRcptHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text009 +
             Text010 +
             Text011,TRUE,
             PurchRcptHeader."No.")
        THEN
          EXIT;
      IF PurchInvHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text012 +
             Text013 +
             Text011,TRUE,
             PurchInvHeader."No.")
        THEN
          EXIT;
      IF PurchCrMemoHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text014 +
             Text015 +
             Text011,TRUE,
             PurchCrMemoHeader."No.")
        THEN
          EXIT;
      IF ReturnShptHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text029 +
             Text030 +
             Text011,TRUE,
             ReturnShptHeader."No.")
        THEN
          EXIT;
      IF "Prepayment No." <> '' THEN
        IF NOT CONFIRM(
             Text045,TRUE,
             PurchInvHeaderPrepmt."No.")
        THEN
          EXIT;
      IF "Prepmt. Cr. Memo No." <> '' THEN
        IF NOT CONFIRM(
             Text046,TRUE,
             PurchCrMemoHeaderPrepmt."No.")
        THEN
          EXIT;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetVend@1(VendNo@1000 : Code[20]);
    BEGIN
      IF VendNo <> Vend."No." THEN
        Vend.GET(VendNo);
    END;

    PROCEDURE PurchLinesExist@3() : Boolean;
    BEGIN
      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      EXIT(PurchLine.FINDFIRST);
    END;

    LOCAL PROCEDURE RecreatePurchLines@4(ChangedFieldName@1000 : Text[100]);
    VAR
      PurchLineTmp@1001 : TEMPORARY Record 39;
      ItemChargeAssgntPurch@1005 : Record 5805;
      TempItemChargeAssgntPurch@1004 : TEMPORARY Record 5805;
      TempInteger@1003 : TEMPORARY Record 2000000026;
      SalesHeader@1006 : Record 36;
      SalesLine@1007 : Record 37;
      CopyDocMgt@1008 : Codeunit 6620;
      ExtendedTextAdded@1002 : Boolean;
    BEGIN
      IF PurchLinesExist THEN BEGIN
        IF HideValidationDialog THEN
          Confirmed := TRUE
        ELSE
          Confirmed :=
            CONFIRM(
              Text016 +
              Text004,FALSE,ChangedFieldName);
        IF Confirmed THEN BEGIN
          PurchLine.LOCKTABLE;
          ItemChargeAssgntPurch.LOCKTABLE;
          MODIFY;

          PurchLine.RESET;
          PurchLine.SETRANGE("Document Type","Document Type");
          PurchLine.SETRANGE("Document No.","No.");
          IF PurchLine.FINDSET THEN BEGIN
            REPEAT
              PurchLine.TESTFIELD("Quantity Received",0);
              PurchLine.TESTFIELD("Quantity Invoiced",0);
              PurchLine.TESTFIELD("Return Qty. Shipped",0);
              PurchLine.CALCFIELDS("Reserved Qty. (Base)");
              PurchLine.TESTFIELD("Reserved Qty. (Base)",0);
              PurchLine.TESTFIELD("Receipt No.",'');
              PurchLine.TESTFIELD("Return Shipment No.",'');
              PurchLine.TESTFIELD("Blanket Order No.",'');
              IF PurchLine."Drop Shipment" OR PurchLine."Special Order" THEN BEGIN
                CASE TRUE OF
                  PurchLine."Drop Shipment":
                    SalesHeader.GET(SalesHeader."Document Type"::Order,PurchLine."Sales Order No.");
                  PurchLine."Special Order":
                    SalesHeader.GET(SalesHeader."Document Type"::Order,PurchLine."Special Order Sales No.");
                END;
                TESTFIELD("Sell-to Customer No.",SalesHeader."Sell-to Customer No.");
                TESTFIELD("Ship-to Code",SalesHeader."Ship-to Code");
              END;

              PurchLine.TESTFIELD("Prepmt. Amt. Inv.",0);
              PurchLineTmp := PurchLine;
              IF PurchLine.Nonstock THEN BEGIN
                PurchLine.Nonstock := FALSE;
                PurchLine.MODIFY;
              END;
              PurchLineTmp.INSERT;
            UNTIL PurchLine.NEXT = 0;

            ItemChargeAssgntPurch.SETRANGE("Document Type","Document Type");
            ItemChargeAssgntPurch.SETRANGE("Document No.","No.");
            IF ItemChargeAssgntPurch.FINDSET THEN BEGIN
              REPEAT
                TempItemChargeAssgntPurch.INIT;
                TempItemChargeAssgntPurch := ItemChargeAssgntPurch;
                TempItemChargeAssgntPurch.INSERT;
              UNTIL ItemChargeAssgntPurch.NEXT = 0;
              ItemChargeAssgntPurch.DELETEALL;
            END;

            PurchLine.DELETEALL(TRUE);

            PurchLine.INIT;
            PurchLine."Line No." := 0;
            PurchLineTmp.FINDSET;
            ExtendedTextAdded := FALSE;
            REPEAT
              IF PurchLineTmp."Attached to Line No." = 0 THEN BEGIN
                PurchLine.INIT;
                PurchLine."Line No." := PurchLine."Line No." + 10000;
                PurchLine.VALIDATE(Type,PurchLineTmp.Type);
                IF PurchLineTmp."No." = '' THEN BEGIN
                  PurchLine.VALIDATE(Description,PurchLineTmp.Description);
                  PurchLine.VALIDATE("Description 2",PurchLineTmp."Description 2");
                END ELSE BEGIN
                  PurchLine.VALIDATE("No.",PurchLineTmp."No.");
                  IF PurchLine.Type <> PurchLine.Type::" " THEN
                    CASE TRUE OF
                      PurchLineTmp."Drop Shipment":
                        BEGIN
                          SalesLine.GET(SalesLine."Document Type"::Order,
                            PurchLineTmp."Sales Order No.",
                            PurchLineTmp."Sales Order Line No.");
                          CopyDocMgt.TransfldsFromSalesToPurchLine(SalesLine,PurchLine);
                          PurchLine."Drop Shipment" := PurchLineTmp."Drop Shipment";
                          PurchLine."Purchasing Code" := SalesLine."Purchasing Code";
                          PurchLine."Sales Order No." := PurchLineTmp."Sales Order No.";
                          PurchLine."Sales Order Line No." := PurchLineTmp."Sales Order Line No.";
                          EVALUATE(PurchLine."Inbound Whse. Handling Time",'<0D>');
                          PurchLine.VALIDATE("Inbound Whse. Handling Time");

                          SalesLine.VALIDATE("Unit Cost (LCY)",PurchLine."Unit Cost (LCY)");
                          SalesLine."Purchase Order No." := PurchLine."Document No.";
                          SalesLine."Purch. Order Line No." := PurchLine."Line No.";
                          SalesLine.MODIFY;
                        END;
                      PurchLineTmp."Special Order":
                        BEGIN
                          SalesLine.GET(SalesLine."Document Type"::Order,
                            PurchLineTmp."Special Order Sales No.",
                            PurchLineTmp."Special Order Sales Line No.");
                          CopyDocMgt.TransfldsFromSalesToPurchLine(SalesLine,PurchLine);
                          PurchLine."Special Order" := PurchLineTmp."Special Order";
                          PurchLine."Purchasing Code" := SalesLine."Purchasing Code";
                          PurchLine."Special Order Sales No." := PurchLineTmp."Special Order Sales No.";
                          PurchLine."Special Order Sales Line No." := PurchLineTmp."Special Order Sales Line No.";

                          SalesLine.VALIDATE("Unit Cost (LCY)",PurchLine."Unit Cost (LCY)");
                          SalesLine."Special Order Purchase No." := PurchLine."Document No.";
                          SalesLine."Special Order Purch. Line No." := PurchLine."Line No.";
                          SalesLine.MODIFY;
                        END;
                      ELSE BEGIN
                        PurchLine.VALIDATE("Unit of Measure Code",PurchLineTmp."Unit of Measure Code");
                        PurchLine.VALIDATE("Variant Code",PurchLineTmp."Variant Code");
                        PurchLine."Prod. Order No." := PurchLineTmp."Prod. Order No.";
                        IF PurchLine."Prod. Order No." <> '' THEN BEGIN
                          PurchLine.Description := PurchLineTmp.Description;
                          PurchLine.VALIDATE("VAT Prod. Posting Group",PurchLineTmp."VAT Prod. Posting Group");
                          PurchLine.VALIDATE("Gen. Prod. Posting Group",PurchLineTmp."Gen. Prod. Posting Group");
                          PurchLine.VALIDATE("Expected Receipt Date",PurchLineTmp."Expected Receipt Date");
                          PurchLine.VALIDATE("Requested Receipt Date",PurchLineTmp."Requested Receipt Date");
                          PurchLine.VALIDATE("Qty. per Unit of Measure",PurchLineTmp."Qty. per Unit of Measure");
                        END;
                        IF (PurchLineTmp."Job No." <> '') AND (PurchLineTmp."Job Task No." <> '') THEN BEGIN
                          PurchLine.VALIDATE("Job No.",PurchLineTmp."Job No.");
                          PurchLine.VALIDATE("Job Task No.",PurchLineTmp."Job Task No.");
                          PurchLine."Job Line Type" := PurchLineTmp."Job Line Type";
                        END;
                        IF PurchLineTmp.Quantity <> 0 THEN
                          PurchLine.VALIDATE(Quantity,PurchLineTmp.Quantity);
                        IF ("Currency Code" = xRec."Currency Code") AND (PurchLine."Direct Unit Cost" = 0) THEN
                          PurchLine.VALIDATE("Direct Unit Cost",PurchLineTmp."Direct Unit Cost");
                        PurchLine."Routing No." := PurchLineTmp."Routing No.";
                        PurchLine."Routing Reference No." := PurchLineTmp."Routing Reference No.";
                        PurchLine."Operation No." := PurchLineTmp."Operation No.";
                        PurchLine."Work Center No." := PurchLineTmp."Work Center No.";
                        PurchLine."Prod. Order Line No." := PurchLineTmp."Prod. Order Line No.";
                        PurchLine."Overhead Rate" := PurchLineTmp."Overhead Rate";
                      END;
                    END;
                END;

                PurchLine.INSERT;
                ExtendedTextAdded := FALSE;

                IF PurchLine.Type = PurchLine.Type::Item THEN BEGIN
                  ClearItemAssgntPurchFilter(TempItemChargeAssgntPurch);
                  TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. Type",PurchLineTmp."Document Type");
                  TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. No.",PurchLineTmp."Document No.");
                  TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. Line No.",PurchLineTmp."Line No.");
                  IF TempItemChargeAssgntPurch.FINDSET THEN
                    REPEAT
                      IF NOT TempItemChargeAssgntPurch.MARK THEN BEGIN
                        TempItemChargeAssgntPurch."Applies-to Doc. Line No." := PurchLine."Line No.";
                        TempItemChargeAssgntPurch.Description := PurchLine.Description;
                        TempItemChargeAssgntPurch.MODIFY;
                        TempItemChargeAssgntPurch.MARK(TRUE);
                      END;
                    UNTIL TempItemChargeAssgntPurch.NEXT = 0;
                END;
                IF PurchLine.Type = PurchLine.Type::"Charge (Item)" THEN BEGIN
                  TempInteger.INIT;
                  TempInteger.Number := PurchLine."Line No.";
                  TempInteger.INSERT;
                END;
              END ELSE
                IF NOT ExtendedTextAdded THEN BEGIN
                  TransferExtendedText.PurchCheckIfAnyExtText(PurchLine,TRUE);
                  TransferExtendedText.InsertPurchExtText(PurchLine);
                  PurchLine.FINDLAST;
                  ExtendedTextAdded := TRUE;
                END;
            UNTIL PurchLineTmp.NEXT = 0;

            ClearItemAssgntPurchFilter(TempItemChargeAssgntPurch);
            PurchLineTmp.SETRANGE(Type,PurchLine.Type::"Charge (Item)");
            IF PurchLineTmp.FINDSET THEN
              REPEAT
                TempItemChargeAssgntPurch.SETRANGE("Document Line No.",PurchLineTmp."Line No.");
                IF TempItemChargeAssgntPurch.FINDSET THEN BEGIN
                  REPEAT
                    TempInteger.FINDFIRST;
                    ItemChargeAssgntPurch.INIT;
                    ItemChargeAssgntPurch := TempItemChargeAssgntPurch;
                    ItemChargeAssgntPurch."Document Line No." := TempInteger.Number;
                    ItemChargeAssgntPurch.VALIDATE("Unit Cost",0);
                    ItemChargeAssgntPurch.INSERT;
                  UNTIL TempItemChargeAssgntPurch.NEXT = 0;
                  TempInteger.DELETE;
                END;
              UNTIL PurchLineTmp.NEXT = 0;

            PurchLineTmp.SETRANGE(Type);
            PurchLineTmp.DELETEALL;
            ClearItemAssgntPurchFilter(TempItemChargeAssgntPurch);
            TempItemChargeAssgntPurch.DELETEALL;
          END;
        END ELSE
          ERROR(
            Text018,ChangedFieldName);
      END;
    END;

    LOCAL PROCEDURE MessageIfPurchLinesExist@5(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF PurchLinesExist AND NOT HideValidationDialog THEN
        MESSAGE(
          Text019 +
          Text020,
          ChangedFieldName);
    END;

    LOCAL PROCEDURE PriceMessageIfPurchLinesExist@7(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF PurchLinesExist AND NOT HideValidationDialog THEN
        MESSAGE(
          Text019 +
          Text021,ChangedFieldName);
    END;

    LOCAL PROCEDURE UpdateCurrencyFactor@12();
    BEGIN
      IF "Currency Code" <> '' THEN BEGIN
        IF "Posting Date" <> 0D THEN
          CurrencyDate := "Posting Date"
        ELSE
          CurrencyDate := WORKDATE;

        "Currency Factor" := CurrExchRate.ExchangeRate(CurrencyDate,"Currency Code");
      END ELSE
        "Currency Factor" := 0;
    END;

    LOCAL PROCEDURE ConfirmUpdateCurrencyFactor@13() : Boolean;
    BEGIN
      IF HideValidationDialog THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(Text022,FALSE);
      IF Confirmed THEN
        VALIDATE("Currency Factor")
      ELSE
        "Currency Factor" := xRec."Currency Factor";
      EXIT(Confirmed);
    END;

    PROCEDURE SetHideValidationDialog@14(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    LOCAL PROCEDURE UpdatePurchLines@15(ChangedFieldName@1000 : Text[100];AskQuestion@1001 : Boolean);
    VAR
      PurchLineReserve@1003 : Codeunit 99000834;
      Question@1002 : Text[250];
    BEGIN
      IF NOT PurchLinesExist THEN
        EXIT;

      IF AskQuestion THEN BEGIN
        Question := STRSUBSTNO(
            Text032 +
            Text033,ChangedFieldName);
        IF GUIALLOWED THEN
          IF DIALOG.CONFIRM(Question,TRUE) THEN
            CASE ChangedFieldName OF
              FIELDCAPTION("Expected Receipt Date"),
              FIELDCAPTION("Requested Receipt Date"),
              FIELDCAPTION("Promised Receipt Date"),
              FIELDCAPTION("Lead Time Calculation"),
              FIELDCAPTION("Inbound Whse. Handling Time"):
                ConfirmResvDateConflict;
            END
          ELSE
            EXIT;
      END;

      PurchLine.LOCKTABLE;
      MODIFY;

      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      IF PurchLine.FINDSET THEN
        REPEAT
          xPurchLine := PurchLine;
          CASE ChangedFieldName OF
            FIELDCAPTION("Expected Receipt Date"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Expected Receipt Date","Expected Receipt Date");
            FIELDCAPTION("Currency Factor"):
              IF PurchLine.Type <> PurchLine.Type::" " THEN
                PurchLine.VALIDATE("Direct Unit Cost");
            FIELDCAPTION("Transaction Type"):
              PurchLine.VALIDATE("Transaction Type","Transaction Type");
            FIELDCAPTION("Transport Method"):
              PurchLine.VALIDATE("Transport Method","Transport Method");
            FIELDCAPTION("Entry Point"):
              PurchLine.VALIDATE("Entry Point","Entry Point");
            FIELDCAPTION(Area):
              PurchLine.VALIDATE(Area,Area);
            FIELDCAPTION("Transaction Specification"):
              PurchLine.VALIDATE("Transaction Specification","Transaction Specification");
            FIELDCAPTION("Requested Receipt Date"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Requested Receipt Date","Requested Receipt Date");
            FIELDCAPTION("Prepayment %"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Prepayment %","Prepayment %");
            FIELDCAPTION("Promised Receipt Date"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Promised Receipt Date","Promised Receipt Date");
            FIELDCAPTION("Lead Time Calculation"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Lead Time Calculation","Lead Time Calculation");
            FIELDCAPTION("Inbound Whse. Handling Time"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Inbound Whse. Handling Time","Inbound Whse. Handling Time");
            PurchLine.FIELDCAPTION("Deferral Code"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Deferral Code");
          END;
          PurchLine.MODIFY(TRUE);
          PurchLineReserve.VerifyChange(PurchLine,xPurchLine);
        UNTIL PurchLine.NEXT = 0;
    END;

    LOCAL PROCEDURE ConfirmResvDateConflict@31();
    VAR
      ResvEngMgt@1000 : Codeunit 99000831;
    BEGIN
      IF ResvEngMgt.ResvExistsForPurchHeader(Rec) THEN
        IF NOT CONFIRM(Text050 + Text011,FALSE) THEN
          ERROR('');
    END;

    PROCEDURE CreateDim@16(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1004 : Integer;No3@1005 : Code[20];Type4@1006 : Integer;No4@1007 : Code[20]);
    VAR
      SourceCodeSetup@1010 : Record 242;
      TableID@1011 : ARRAY [10] OF Integer;
      No@1012 : ARRAY [10] OF Code[20];
      OldDimSetID@1008 : Integer;
    BEGIN
      SourceCodeSetup.GET;
      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      TableID[3] := Type3;
      No[3] := No3;
      TableID[4] := Type4;
      No[4] := No4;
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(TableID,No,SourceCodeSetup.Purchases,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",0,0);

      IF (OldDimSetID <> "Dimension Set ID") AND PurchLinesExist THEN BEGIN
        MODIFY;
        UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@19(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1005 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
      IF "No." <> '' THEN
        MODIFY;

      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF PurchLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE ReceivedPurchLinesExist@20() : Boolean;
    BEGIN
      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      PurchLine.SETFILTER("Quantity Received",'<>0');
      EXIT(PurchLine.FINDFIRST);
    END;

    LOCAL PROCEDURE ReturnShipmentExist@5800() : Boolean;
    BEGIN
      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      PurchLine.SETFILTER("Return Qty. Shipped",'<>0');
      EXIT(PurchLine.FINDFIRST);
    END;

    LOCAL PROCEDURE UpdateShipToAddress@21();
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT;

      IF ("Location Code" <> '') AND
         Location.GET("Location Code") AND
         ("Sell-to Customer No." = '')
      THEN BEGIN
        "Ship-to Name" := Location.Name;
        "Ship-to Name 2" := Location."Name 2";
        "Ship-to Address" := Location.Address;
        "Ship-to Address 2" := Location."Address 2";
        "Ship-to City" := Location.City;
        "Ship-to Post Code" := Location."Post Code";
        "Ship-to County" := Location.County;
        "Ship-to Country/Region Code" := Location."Country/Region Code";
        "Ship-to Contact" := Location.Contact;
      END;

      IF ("Location Code" = '') AND
         ("Sell-to Customer No." = '')
      THEN BEGIN
        CompanyInfo.GET;
        "Ship-to Code" := '';
        "Ship-to Name" := CompanyInfo."Ship-to Name";
        "Ship-to Name 2" := CompanyInfo."Ship-to Name 2";
        "Ship-to Address" := CompanyInfo."Ship-to Address";
        "Ship-to Address 2" := CompanyInfo."Ship-to Address 2";
        "Ship-to City" := CompanyInfo."Ship-to City";
        "Ship-to Post Code" := CompanyInfo."Ship-to Post Code";
        "Ship-to County" := CompanyInfo."Ship-to County";
        "Ship-to Country/Region Code" := CompanyInfo."Ship-to Country/Region Code";
        "Ship-to Contact" := CompanyInfo."Ship-to Contact";
      END;
    END;

    LOCAL PROCEDURE DeletePurchaseLines@17();
    BEGIN
      IF PurchLine.FINDSET THEN BEGIN
        HandleItemTrackingDeletion;
        REPEAT
          PurchLine.SuspendStatusCheck(TRUE);
          PurchLine.DELETE(TRUE);
        UNTIL PurchLine.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE HandleItemTrackingDeletion@36();
    VAR
      ReservEntry@1000 : Record 337;
      ReservEntry2@1001 : Record 337;
    BEGIN
      WITH ReservEntry DO BEGIN
        RESET;
        SETCURRENTKEY(
          "Source ID","Source Ref. No.","Source Type","Source Subtype",
          "Source Batch Name","Source Prod. Order Line","Reservation Status");
        SETRANGE("Source Type",DATABASE::"Purchase Line");
        SETRANGE("Source Subtype","Document Type");
        SETRANGE("Source ID","No.");
        SETRANGE("Source Batch Name",'');
        SETRANGE("Source Prod. Order Line",0);
        SETFILTER("Item Tracking",'> %1',"Item Tracking"::None);
        IF ISEMPTY THEN
          EXIT;

        IF HideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE
          Confirmed := CONFIRM(Text041,FALSE,LOWERCASE(FORMAT("Document Type")),"No.");

        IF NOT Confirmed THEN
          ERROR('');

        IF FINDSET THEN
          REPEAT
            ReservEntry2 := ReservEntry;
            ReservEntry2.ClearItemTrackingFields;
            ReservEntry2.MODIFY;
          UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ClearItemAssgntPurchFilter@22(VAR TempItemChargeAssgntPurch@1000 : Record 5805);
    BEGIN
      TempItemChargeAssgntPurch.SETRANGE("Document Line No.");
      TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. Type");
      TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. No.");
      TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. Line No.");
    END;

    LOCAL PROCEDURE UpdateBuyFromCont@24(VendorNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Vend@1004 : Record 23;
    BEGIN
      IF Vend.GET(VendorNo) THEN BEGIN
        IF Vend."Primary Contact No." <> '' THEN
          "Buy-from Contact No." := Vend."Primary Contact No."
        ELSE BEGIN
          ContBusRel.RESET;
          ContBusRel.SETCURRENTKEY("Link to Table","No.");
          ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
          ContBusRel.SETRANGE("No.","Buy-from Vendor No.");
          IF ContBusRel.FINDFIRST THEN
            "Buy-from Contact No." := ContBusRel."Contact No."
          ELSE
            "Buy-from Contact No." := '';
        END;
        "Buy-from Contact" := Vend.Contact;
      END;
    END;

    LOCAL PROCEDURE UpdatePayToCont@27(VendorNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Vend@1001 : Record 23;
    BEGIN
      IF Vend.GET(VendorNo) THEN BEGIN
        IF Vend."Primary Contact No." <> '' THEN
          "Pay-to Contact No." := Vend."Primary Contact No."
        ELSE BEGIN
          ContBusRel.RESET;
          ContBusRel.SETCURRENTKEY("Link to Table","No.");
          ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
          ContBusRel.SETRANGE("No.","Pay-to Vendor No.");
          IF ContBusRel.FINDFIRST THEN
            "Pay-to Contact No." := ContBusRel."Contact No."
          ELSE
            "Pay-to Contact No." := '';
        END;
        "Pay-to Contact" := Vend.Contact;
      END;
    END;

    LOCAL PROCEDURE UpdateBuyFromVend@25(ContactNo@1002 : Code[20]);
    VAR
      ContBusinessRelation@1007 : Record 5054;
      Vend@1006 : Record 23;
      Cont@1005 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Buy-from Contact No." := Cont."No.";
        IF Cont.Type = Cont.Type::Person THEN
          "Buy-from Contact" := Cont.Name
        ELSE
          IF Vend.GET("Buy-from Vendor No.") THEN
            "Buy-from Contact" := Vend.Contact
          ELSE
            "Buy-from Contact" := ''
      END ELSE BEGIN
        "Buy-from Contact" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF ("Buy-from Vendor No." <> '') AND
           ("Buy-from Vendor No." <> ContBusinessRelation."No.")
        THEN
          ERROR(Text037,Cont."No.",Cont.Name,"Buy-from Vendor No.");
        IF "Buy-from Vendor No." = '' THEN BEGIN
          SkipBuyFromContact := TRUE;
          VALIDATE("Buy-from Vendor No.",ContBusinessRelation."No.");
          SkipBuyFromContact := FALSE;
        END;
      END ELSE
        ERROR(Text039,Cont."No.",Cont.Name);

      IF ("Buy-from Vendor No." = "Pay-to Vendor No.") OR
         ("Pay-to Vendor No." = '')
      THEN
        VALIDATE("Pay-to Contact No.","Buy-from Contact No.");
    END;

    LOCAL PROCEDURE UpdatePayToVend@26(ContactNo@1000 : Code[20]);
    VAR
      ContBusinessRelation@1005 : Record 5054;
      Vend@1004 : Record 23;
      Cont@1003 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Pay-to Contact No." := Cont."No.";
        IF Cont.Type = Cont.Type::Person THEN
          "Pay-to Contact" := Cont.Name
        ELSE
          IF Vend.GET("Pay-to Vendor No.") THEN
            "Pay-to Contact" := Vend.Contact
          ELSE
            "Pay-to Contact" := '';
      END ELSE BEGIN
        "Pay-to Contact" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF "Pay-to Vendor No." = '' THEN BEGIN
          SkipPayToContact := TRUE;
          VALIDATE("Pay-to Vendor No.",ContBusinessRelation."No.");
          SkipPayToContact := FALSE;
        END ELSE
          IF "Pay-to Vendor No." <> ContBusinessRelation."No." THEN
            ERROR(Text037,Cont."No.",Cont.Name,"Pay-to Vendor No.");
      END ELSE
        ERROR(Text039,Cont."No.",Cont.Name);
    END;

    PROCEDURE CreateInvtPutAwayPick@29();
    VAR
      WhseRequest@1000 : Record 5765;
    BEGIN
      TESTFIELD(Status,Status::Released);

      WhseRequest.RESET;
      WhseRequest.SETCURRENTKEY("Source Document","Source No.");
      CASE "Document Type" OF
        "Document Type"::Order:
          WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Purchase Order");
        "Document Type"::"Return Order":
          WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Purchase Return Order");
      END;
      WhseRequest.SETRANGE("Source No.","No.");
      REPORT.RUNMODAL(REPORT::"Create Invt Put-away/Pick/Mvmt",TRUE,FALSE,WhseRequest);
    END;

    PROCEDURE ShowDocDim@32();
    VAR
      OldDimSetID@1000 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2',"Document Type","No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");

      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF PurchLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE UpdateAllLineDim@34(NewParentDimSetID@1000 : Integer;OldParentDimSetID@1001 : Integer);
    VAR
      NewDimSetID@1002 : Integer;
      ReceivedShippedItemLineDimChangeConfirmed@1003 : Boolean;
    BEGIN
      // Update all lines with changed dimensions.

      IF NewParentDimSetID = OldParentDimSetID THEN
        EXIT;
      IF NOT CONFIRM(Text051) THEN
        EXIT;

      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      PurchLine.LOCKTABLE;
      IF PurchLine.FIND('-') THEN
        REPEAT
          NewDimSetID := DimMgt.GetDeltaDimSetID(PurchLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          IF PurchLine."Dimension Set ID" <> NewDimSetID THEN BEGIN
            PurchLine."Dimension Set ID" := NewDimSetID;

            IF NOT HideValidationDialog AND GUIALLOWED THEN
              VerifyReceivedShippedItemLineDimChange(ReceivedShippedItemLineDimChangeConfirmed);

            DimMgt.UpdateGlobalDimFromDimSetID(
              PurchLine."Dimension Set ID",PurchLine."Shortcut Dimension 1 Code",PurchLine."Shortcut Dimension 2 Code");
            PurchLine.MODIFY;
          END;
        UNTIL PurchLine.NEXT = 0;
    END;

    LOCAL PROCEDURE VerifyReceivedShippedItemLineDimChange@71(VAR ReceivedShippedItemLineDimChangeConfirmed@1000 : Boolean);
    BEGIN
      IF PurchLine.IsReceivedShippedItemDimChanged THEN
        IF NOT ReceivedShippedItemLineDimChangeConfirmed THEN
          ReceivedShippedItemLineDimChangeConfirmed := PurchLine.ConfirmReceivedShippedItemDimChange;
    END;

    PROCEDURE SetAmountToApply@18(AppliesToDocNo@1000 : Code[20];VendorNo@1001 : Code[20]);
    VAR
      VendLedgEntry@1002 : Record 25;
    BEGIN
      VendLedgEntry.SETCURRENTKEY("Document No.");
      VendLedgEntry.SETRANGE("Document No.",AppliesToDocNo);
      VendLedgEntry.SETRANGE("Vendor No.",VendorNo);
      VendLedgEntry.SETRANGE(Open,TRUE);
      IF VendLedgEntry.FINDFIRST THEN BEGIN
        IF VendLedgEntry."Amount to Apply" = 0 THEN  BEGIN
          VendLedgEntry.CALCFIELDS("Remaining Amount");
          VendLedgEntry."Amount to Apply" := VendLedgEntry."Remaining Amount";
        END ELSE
          VendLedgEntry."Amount to Apply" := 0;
        VendLedgEntry."Accepted Payment Tolerance" := 0;
        VendLedgEntry."Accepted Pmt. Disc. Tolerance" := FALSE;
        CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",VendLedgEntry);
      END;
    END;

    PROCEDURE SetShipToForSpecOrder@23();
    BEGIN
      IF Location.GET("Location Code") THEN BEGIN
        "Ship-to Code" := '';
        "Ship-to Name" := Location.Name;
        "Ship-to Name 2" := Location."Name 2";
        "Ship-to Address" := Location.Address;
        "Ship-to Address 2" := Location."Address 2";
        "Ship-to City" := Location.City;
        "Ship-to Post Code" := Location."Post Code";
        "Ship-to County" := Location.County;
        "Ship-to Country/Region Code" := Location."Country/Region Code";
        "Ship-to Contact" := Location.Contact;
        "Location Code" := Location.Code;
      END ELSE BEGIN
        CompanyInfo.GET;
        "Ship-to Code" := '';
        "Ship-to Name" := CompanyInfo."Ship-to Name";
        "Ship-to Name 2" := CompanyInfo."Ship-to Name 2";
        "Ship-to Address" := CompanyInfo."Ship-to Address";
        "Ship-to Address 2" := CompanyInfo."Ship-to Address 2";
        "Ship-to City" := CompanyInfo."Ship-to City";
        "Ship-to Post Code" := CompanyInfo."Ship-to Post Code";
        "Ship-to County" := CompanyInfo."Ship-to County";
        "Ship-to Country/Region Code" := CompanyInfo."Ship-to Country/Region Code";
        "Ship-to Contact" := CompanyInfo."Ship-to Contact";
        "Location Code" := '';
      END;
    END;

    LOCAL PROCEDURE JobUpdatePurchLines@28(SkipJobCurrFactorUpdate@1000 : Boolean);
    BEGIN
      WITH PurchLine DO BEGIN
        SETFILTER("Job No.",'<>%1','');
        SETFILTER("Job Task No.",'<>%1','');
        LOCKTABLE;
        IF FINDSET(TRUE,FALSE) THEN BEGIN
          SetPurchHeader(Rec);
          REPEAT
            IF NOT SkipJobCurrFactorUpdate THEN
              JobSetCurrencyFactor;
            CreateTempJobJnlLine(FALSE);
            UpdateJobPrices;
            MODIFY;
          UNTIL NEXT = 0;
        END;
      END
    END;

    PROCEDURE GetPstdDocLinesToRevere@47();
    VAR
      PurchPostedDocLines@1002 : Page 5855;
    BEGIN
      GetVend("Buy-from Vendor No.");
      PurchPostedDocLines.SetToPurchHeader(Rec);
      PurchPostedDocLines.SETRECORD(Vend);
      PurchPostedDocLines.LOOKUPMODE := TRUE;
      IF PurchPostedDocLines.RUNMODAL = ACTION::LookupOK THEN
        PurchPostedDocLines.CopyLineToDoc;

      CLEAR(PurchPostedDocLines);
    END;

    PROCEDURE SetSecurityFilterOnRespCenter@43();
    BEGIN
      IF UserSetupMgt.GetPurchasesFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETRANGE("Responsibility Center",UserSetupMgt.GetPurchasesFilter);
        FILTERGROUP(0);
      END;

      SETRANGE("Date Filter",0D,WORKDATE - 1);
    END;

    PROCEDURE CalcInvDiscForHeader@45();
    VAR
      PurchaseInvDisc@1000 : Codeunit 70;
    BEGIN
      PurchSetup.GET;
      IF PurchSetup."Calc. Inv. Discount" THEN
        PurchaseInvDisc.CalculateIncDiscForHeader(Rec);
    END;

    PROCEDURE AddShipToAddress@46(SalesHeader@1000 : Record 36;ShowError@1001 : Boolean);
    VAR
      PurchLine2@1002 : Record 39;
    BEGIN
      IF ShowError THEN BEGIN
        PurchLine2.RESET;
        PurchLine2.SETRANGE("Document Type","Document Type"::Order);
        PurchLine2.SETRANGE("Document No.","No.");
        IF NOT PurchLine2.ISEMPTY THEN BEGIN
          IF "Ship-to Name" <> SalesHeader."Ship-to Name" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Name"),"No.",SalesHeader."No.");
          IF "Ship-to Name 2" <> SalesHeader."Ship-to Name 2" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Name 2"),"No.",SalesHeader."No.");
          IF "Ship-to Address" <> SalesHeader."Ship-to Address" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Address"),"No.",SalesHeader."No.");
          IF "Ship-to Address 2" <> SalesHeader."Ship-to Address 2" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Address 2"),"No.",SalesHeader."No.");
          IF "Ship-to Post Code" <> SalesHeader."Ship-to Post Code" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Post Code"),"No.",SalesHeader."No.");
          IF "Ship-to City" <> SalesHeader."Ship-to City" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to City"),"No.",SalesHeader."No.");
          IF "Ship-to Contact" <> SalesHeader."Ship-to Contact" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Contact"),"No.",SalesHeader."No.");
        END ELSE BEGIN
          // no purchase line exists
          "Ship-to Name" := SalesHeader."Ship-to Name";
          "Ship-to Name 2" := SalesHeader."Ship-to Name 2";
          "Ship-to Address" := SalesHeader."Ship-to Address";
          "Ship-to Address 2" := SalesHeader."Ship-to Address 2";
          "Ship-to Post Code" := SalesHeader."Ship-to Post Code";
          "Ship-to City" := SalesHeader."Ship-to City";
          "Ship-to Contact" := SalesHeader."Ship-to Contact";
        END;
      END;
    END;

    PROCEDURE DropShptOrderExists@48(SalesHeader@1000 : Record 36) : Boolean;
    VAR
      SalesLine2@1001 : Record 37;
    BEGIN
      // returns TRUE if sales is either Drop Shipment of Special Order
      SalesLine2.RESET;
      SalesLine2.SETRANGE("Document Type",SalesLine2."Document Type"::Order);
      SalesLine2.SETRANGE("Document No.",SalesHeader."No.");
      SalesLine2.SETRANGE("Drop Shipment",TRUE);
      EXIT(NOT SalesLine2.ISEMPTY);
    END;

    PROCEDURE SpecialOrderExists@81(SalesHeader@1000 : Record 36) : Boolean;
    VAR
      SalesLine3@1001 : Record 37;
    BEGIN
      SalesLine3.RESET;
      SalesLine3.SETRANGE("Document Type",SalesLine3."Document Type"::Order);
      SalesLine3.SETRANGE("Document No.",SalesHeader."No.");
      SalesLine3.SETRANGE("Special Order",TRUE);
      EXIT(NOT SalesLine3.ISEMPTY);
    END;

    PROCEDURE QtyToReceiveIsZero@30() : Boolean;
    BEGIN
      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      PurchLine.SETFILTER("Qty. to Receive",'<>0');
      EXIT(PurchLine.ISEMPTY);
    END;

    LOCAL PROCEDURE IsApprovedForPosting@50() : Boolean;
    VAR
      PrepaymentMgt@1000 : Codeunit 441;
    BEGIN
      IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN BEGIN
        IF PrepaymentMgt.TestPurchasePrepayment(Rec) THEN
          ERROR(STRSUBSTNO(Text053,"Document Type","No."));
        IF PrepaymentMgt.TestPurchasePayment(Rec) THEN
          IF NOT CONFIRM(STRSUBSTNO(Text054,"Document Type","No."),TRUE) THEN
            EXIT(FALSE);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE IsApprovedForPostingBatch@51() : Boolean;
    VAR
      PrepaymentMgt@1000 : Codeunit 441;
    BEGIN
      IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN BEGIN
        IF PrepaymentMgt.TestPurchasePrepayment(Rec) THEN
          EXIT(FALSE);
        IF PrepaymentMgt.TestPurchasePayment(Rec) THEN
          EXIT(FALSE);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE SendToPosting@57(PostingCodeunitID@1000 : Integer);
    BEGIN
      IF NOT IsApprovedForPosting THEN
        EXIT;
      CODEUNIT.RUN(PostingCodeunitID,Rec);
    END;

    PROCEDURE CancelBackgroundPosting@33();
    VAR
      PurchasePostViaJobQueue@1000 : Codeunit 98;
    BEGIN
      PurchasePostViaJobQueue.CancelQueueEntry(Rec);
    END;

    PROCEDURE CheckDropShptAddressDetails@79(SalesHeader@1000 : Record 36) : Boolean;
    BEGIN
      NameAddressDetails := DropShptNameAddressDetails;
      DropShptNameAddressDetails :=
        SalesHeader."Ship-to Name" + SalesHeader."Ship-to Name 2" +
        SalesHeader."Ship-to Address" + SalesHeader."Ship-to Address 2" +
        SalesHeader."Ship-to Post Code" + SalesHeader."Ship-to City" +
        SalesHeader."Ship-to Contact";
      IF NameAddressDetails = '' THEN
        NameAddressDetails := DropShptNameAddressDetails;
      EXIT(NameAddressDetails = DropShptNameAddressDetails);
    END;

    PROCEDURE AddSpecialOrderToAddress@80(SalesHeader@1000 : Record 36;ShowError@1001 : Boolean);
    VAR
      PurchLine3@1003 : Record 39;
      LocationCode@1004 : Record 14;
    BEGIN
      IF ShowError THEN BEGIN
        PurchLine3.RESET;
        PurchLine3.SETRANGE("Document Type","Document Type"::Order);
        PurchLine3.SETRANGE("Document No.","No.");
        IF NOT PurchLine3.ISEMPTY THEN BEGIN
          LocationCode.GET("Location Code");
          IF "Ship-to Name" <> LocationCode.Name THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Name"),"No.",SalesHeader."No.");
          IF "Ship-to Name 2" <> LocationCode."Name 2" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Name 2"),"No.",SalesHeader."No.");
          IF "Ship-to Address" <> LocationCode.Address THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Address"),"No.",SalesHeader."No.");
          IF "Ship-to Address 2" <> LocationCode."Address 2" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Address 2"),"No.",SalesHeader."No.");
          IF "Ship-to Post Code" <> LocationCode."Post Code" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Post Code"),"No.",SalesHeader."No.");
          IF "Ship-to City" <> LocationCode.City THEN
            ERROR(Text052,FIELDCAPTION("Ship-to City"),"No.",SalesHeader."No.");
          IF "Ship-to Contact" <> LocationCode.Contact THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Contact"),"No.",SalesHeader."No.");
        END ELSE
          SetShipToForSpecOrder;
      END;
    END;

    PROCEDURE CheckSpecOrderAddressDetails@82(SalesHeader@1000 : Record 36) : Boolean;
    VAR
      LocationCode@1001 : Record 14;
    BEGIN
      NameAddressDetails := SpecOrderNameAddressDetails;
      IF LocationCode.GET(SalesHeader."Location Code") THEN
        SpecOrderNameAddressDetails :=
          LocationCode.Name + LocationCode."Name 2" +
          LocationCode.Address + LocationCode."Address 2" +
          LocationCode."Post Code" + LocationCode.City +
          LocationCode.Contact
      ELSE BEGIN
        CompanyInfo.GET;
        SpecOrderNameAddressDetails :=
          CompanyInfo."Ship-to Name" + CompanyInfo."Ship-to Name 2" +
          CompanyInfo."Ship-to Address" + CompanyInfo."Ship-to Address 2" +
          CompanyInfo."Ship-to Post Code" + CompanyInfo."Ship-to City" +
          CompanyInfo."Ship-to Contact";
      END;
      IF NameAddressDetails = '' THEN
        NameAddressDetails := SpecOrderNameAddressDetails;
      EXIT(NameAddressDetails = SpecOrderNameAddressDetails);
    END;

    LOCAL PROCEDURE InitRecOnVendUpdate@39();
    BEGIN
      IF NOT SkipInitialization THEN
        InitInsert;
    END;

    PROCEDURE InvoicedLineExists@56() : Boolean;
    VAR
      PurchLine@1000 : Record 39;
    BEGIN
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      PurchLine.SETFILTER(Type,'<>%1',PurchLine.Type::" ");
      PurchLine.SETFILTER("Quantity Invoiced",'<>%1',0);
      EXIT(NOT PurchLine.ISEMPTY);
    END;

    PROCEDURE CreateDimSetForPrepmtAccDefaultDim@44();
    VAR
      PurchaseLine@1001 : Record 39;
      TempPurchaseLine@1002 : TEMPORARY Record 39;
    BEGIN
      PurchaseLine.SETRANGE("Document Type","Document Type");
      PurchaseLine.SETRANGE("Document No.","No.");
      PurchaseLine.SETFILTER("Prepmt. Amt. Inv.",'<>%1',0);
      IF PurchaseLine.FINDSET THEN
        REPEAT
          CollectParamsInBufferForCreateDimSet(TempPurchaseLine,PurchaseLine);
        UNTIL PurchaseLine.NEXT = 0;
      TempPurchaseLine.RESET;
      TempPurchaseLine.MARKEDONLY(FALSE);
      IF TempPurchaseLine.FINDSET THEN
        REPEAT
          PurchaseLine.CreateDim(DATABASE::"G/L Account",TempPurchaseLine."No.",
            DATABASE::Job,TempPurchaseLine."Job No.",
            DATABASE::"Responsibility Center",TempPurchaseLine."Responsibility Center",
            DATABASE::"Work Center",TempPurchaseLine."Work Center No.");
        UNTIL TempPurchaseLine.NEXT = 0;
    END;

    LOCAL PROCEDURE CollectParamsInBufferForCreateDimSet@49(VAR TempPurchaseLine@1000 : TEMPORARY Record 39;PurchaseLine@1001 : Record 39);
    VAR
      GenPostingSetup@1002 : Record 252;
      DefaultDimension@1003 : Record 352;
    BEGIN
      TempPurchaseLine.SETRANGE("Gen. Bus. Posting Group",PurchaseLine."Gen. Bus. Posting Group");
      TempPurchaseLine.SETRANGE("Gen. Prod. Posting Group",PurchaseLine."Gen. Prod. Posting Group");
      IF NOT TempPurchaseLine.FINDFIRST THEN BEGIN
        GenPostingSetup.GET(PurchaseLine."Gen. Bus. Posting Group",PurchaseLine."Gen. Prod. Posting Group");
        GenPostingSetup.TESTFIELD("Purch. Prepayments Account");
        DefaultDimension.SETRANGE("Table ID",DATABASE::"G/L Account");
        DefaultDimension.SETRANGE("No.",GenPostingSetup."Purch. Prepayments Account");
        InsertTempPurchaseLineInBuffer(TempPurchaseLine,PurchaseLine,
          GenPostingSetup."Purch. Prepayments Account",DefaultDimension.ISEMPTY);
      END ELSE
        IF NOT TempPurchaseLine.MARK THEN BEGIN
          TempPurchaseLine.SETRANGE("Job No.",PurchaseLine."Job No.");
          TempPurchaseLine.SETRANGE("Responsibility Center",PurchaseLine."Responsibility Center");
          TempPurchaseLine.SETRANGE("Work Center No.",PurchaseLine."Work Center No.");
          IF TempPurchaseLine.ISEMPTY THEN
            InsertTempPurchaseLineInBuffer(TempPurchaseLine,PurchaseLine,TempPurchaseLine."No.",FALSE)
        END;
    END;

    LOCAL PROCEDURE InsertTempPurchaseLineInBuffer@35(VAR TempPurchaseLine@1000 : TEMPORARY Record 39;PurchaseLine@1001 : Record 39;AccountNo@1002 : Code[20];DefaultDimenstionsNotExist@1003 : Boolean);
    BEGIN
      TempPurchaseLine.INIT;
      TempPurchaseLine."Line No." := PurchaseLine."Line No.";
      TempPurchaseLine."No." := AccountNo;
      TempPurchaseLine."Job No." := PurchaseLine."Job No.";
      TempPurchaseLine."Responsibility Center" := PurchaseLine."Responsibility Center";
      TempPurchaseLine."Work Center No." := PurchaseLine."Work Center No.";
      TempPurchaseLine."Gen. Bus. Posting Group" := PurchaseLine."Gen. Bus. Posting Group";
      TempPurchaseLine."Gen. Prod. Posting Group" := PurchaseLine."Gen. Prod. Posting Group";
      TempPurchaseLine.MARK := DefaultDimenstionsNotExist;
      TempPurchaseLine.INSERT;
    END;

    PROCEDURE OpenPurchaseOrderStatistics@60();
    BEGIN
      CalcInvDiscForHeader;
      CreateDimSetForPrepmtAccDefaultDim;
      COMMIT;
      PAGE.RUNMODAL(PAGE::"Purchase Order Statistics",Rec);
    END;

    PROCEDURE GetCardpageID@58() : Integer;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(PAGE::"Purchase Quote");
        "Document Type"::Order:
          EXIT(PAGE::"Purchase Order");
        "Document Type"::Invoice:
          EXIT(PAGE::"Purchase Invoice");
        "Document Type"::"Credit Memo":
          EXIT(PAGE::"Purchase Credit Memo");
        "Document Type"::"Blanket Order":
          EXIT(PAGE::"Blanket Purchase Order");
        "Document Type"::"Return Order":
          EXIT(PAGE::"Purchase Return Order");
      END;
    END;

    [Integration(TRUE)]
    PROCEDURE OnCheckPurchasePostRestrictions@54();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnCheckPurchaseReleaseRestrictions@55();
    BEGIN
    END;

    PROCEDURE SetStatus@53(NewStatus@1000 : Option);
    BEGIN
      Status := NewStatus;
      MODIFY;
    END;

    PROCEDURE TriggerOnAfterPostPurchaseDoc@116(VAR GenJnlPostLine@1001 : Codeunit 12;PurchRcpHdrNo@1002 : Code[20];RetShptHdrNo@1003 : Code[20];PurchInvHdrNo@1004 : Code[20];PurchCrMemoHdrNo@1005 : Code[20]);
    VAR
      PurchPost@1000 : Codeunit 90;
    BEGIN
      PurchPost.OnAfterPostPurchaseDoc(Rec,GenJnlPostLine,PurchRcpHdrNo,RetShptHdrNo,PurchInvHdrNo,PurchCrMemoHdrNo);
    END;

    PROCEDURE DeferralHeadersExist@38() : Boolean;
    VAR
      DeferralHeader@1000 : Record 1701;
      DeferralUtilities@1001 : Codeunit 1720;
    BEGIN
      DeferralHeader.SETRANGE("Deferral Doc. Type",DeferralUtilities.GetPurchDeferralDocType);
      DeferralHeader.SETRANGE("Gen. Jnl. Template Name",'');
      DeferralHeader.SETRANGE("Gen. Jnl. Batch Name",'');
      DeferralHeader.SETRANGE("Document Type","Document Type");
      DeferralHeader.SETRANGE("Document No.","No.");
      EXIT(NOT DeferralHeader.ISEMPTY);
    END;

    LOCAL PROCEDURE ConfirmUpdateDeferralDate@85();
    BEGIN
      IF HideValidationDialog THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(DeferralLineQst,FALSE,FIELDCAPTION("Posting Date"));
      IF Confirmed THEN
        UpdatePurchLines(PurchLine.FIELDCAPTION("Deferral Code"),FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Table 91 User Setup
{
  OBJECT-PROPERTIES
  {
    Date=30.04.18;
    Time=18:36:25;
    Modified=Yes;
    Version List=NAVW19.00.00.44974,CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               CMGenMgt.UserSetupOnInsert(Rec); //CM
             END;

    OnDelete=VAR
               NotificationSetup@1000 : Record 1512;
             BEGIN
               NotificationSetup.SETRANGE("User ID","User ID");
               NotificationSetup.DELETEALL(TRUE);
             END;

    OnRename=BEGIN
               CMGenMgt.UserSetupOnRename(Rec,xRec); //CM
             END;

    CaptionML=[ENU=User Setup;
               DEA=Benutzer Einrichtung];
    LookupPageID=Page119;
    DrillDownPageID=Page119;
  }
  FIELDS
  {
    { 1   ;   ;User ID             ;Code50        ;TableRelation=User."User Name";
                                                   OnValidate=VAR
                                                                UserMgt@1000 : Codeunit 418;
                                                              BEGIN
                                                                UserMgt.ValidateUserID("User ID");
                                                              END;

                                                   OnLookup=VAR
                                                              UserMgt@1000 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("User ID");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=User ID;
                                                              DEA=Benutzer-ID];
                                                   NotBlank=Yes }
    { 2   ;   ;Allow Posting From  ;Date          ;CaptionML=[ENU=Allow Posting From;
                                                              DEA=Buchungen zugel. ab] }
    { 3   ;   ;Allow Posting To    ;Date          ;CaptionML=[ENU=Allow Posting To;
                                                              DEA=Buchungen zugel. bis] }
    { 4   ;   ;Register Time       ;Boolean       ;CaptionML=[ENU=Register Time;
                                                              DEA=Protokollzeit] }
    { 10  ;   ;Salespers./Purch. Code;Code10      ;TableRelation=Salesperson/Purchaser.Code;
                                                   OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Salespers./Purch. Code" <> '' THEN BEGIN
                                                                  UserSetup.SETCURRENTKEY("Salespers./Purch. Code");
                                                                  UserSetup.SETRANGE("Salespers./Purch. Code","Salespers./Purch. Code");
                                                                  IF UserSetup.FINDFIRST THEN
                                                                    ERROR(Text001,"Salespers./Purch. Code",UserSetup."User ID");
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Salespers./Purch. Code;
                                                              DEA=Verk.-/Eink„ufercode] }
    { 11  ;   ;Approver ID         ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                IF "Approver ID" = "User ID" THEN
                                                                  FIELDERROR("Approver ID");
                                                              END;

                                                   OnLookup=VAR
                                                              UserSetup@1000 : Record 91;
                                                            BEGIN
                                                              UserSetup.SETFILTER("User ID",'<>%1',"User ID");
                                                              IF PAGE.RUNMODAL(PAGE::"Approval User Setup",UserSetup) = ACTION::LookupOK THEN
                                                                VALIDATE("Approver ID",UserSetup."User ID");
                                                            END;

                                                   CaptionML=[ENU=Approver ID;
                                                              DEA=Genehmiger-ID] }
    { 12  ;   ;Sales Amount Approval Limit;Integer;OnValidate=BEGIN
                                                                IF "Unlimited Sales Approval" AND ("Sales Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Sales Amount Approval Limit"),FIELDCAPTION("Unlimited Sales Approval"));
                                                                IF "Sales Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Sales Amount Approval Limit;
                                                              DEA=Grenzbetrag fr Verkauf];
                                                   BlankZero=Yes }
    { 13  ;   ;Purchase Amount Approval Limit;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Unlimited Purchase Approval" AND ("Purchase Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Purchase Amount Approval Limit"),FIELDCAPTION("Unlimited Purchase Approval"));
                                                                IF "Purchase Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Purchase Amount Approval Limit;
                                                              DEA=Grenzbetrag fr Einkauf];
                                                   BlankZero=Yes }
    { 14  ;   ;Unlimited Sales Approval;Boolean   ;OnValidate=BEGIN
                                                                IF "Unlimited Sales Approval" THEN
                                                                  "Sales Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Sales Approval;
                                                              DEA=Unbegrenzte Verkaufsgenehmigung] }
    { 15  ;   ;Unlimited Purchase Approval;Boolean;OnValidate=BEGIN
                                                                IF "Unlimited Purchase Approval" THEN
                                                                  "Purchase Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Purchase Approval;
                                                              DEA=Unbegrenzte Einkaufsgenehmigung] }
    { 16  ;   ;Substitute          ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                IF Substitute = "User ID" THEN
                                                                  FIELDERROR(Substitute);
                                                              END;

                                                   OnLookup=VAR
                                                              UserSetup@1000 : Record 91;
                                                            BEGIN
                                                              UserSetup.SETFILTER("User ID",'<>%1',"User ID");
                                                              IF PAGE.RUNMODAL(PAGE::"Approval User Setup",UserSetup) = ACTION::LookupOK THEN
                                                                VALIDATE(Substitute,UserSetup."User ID");
                                                            END;

                                                   CaptionML=[ENU=Substitute;
                                                              DEA=Stellvertreter] }
    { 17  ;   ;E-Mail              ;Text100       ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail;
                                                              DEA=E-Mail] }
    { 19  ;   ;Request Amount Approval Limit;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Unlimited Request Approval" AND ("Request Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Request Amount Approval Limit"),FIELDCAPTION("Unlimited Request Approval"));
                                                                IF "Request Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Request Amount Approval Limit;
                                                              DEA=Grenzbetrag fr Anfrageanforderung];
                                                   BlankZero=Yes }
    { 20  ;   ;Unlimited Request Approval;Boolean ;OnValidate=BEGIN
                                                                IF "Unlimited Request Approval" THEN
                                                                  "Request Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Request Approval;
                                                              DEA=Unbegrenzte Anfragegenehmigung] }
    { 21  ;   ;Approval Administrator;Boolean     ;OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Approval Administrator" THEN BEGIN
                                                                  UserSetup.SETRANGE("Approval Administrator",TRUE);
                                                                  IF NOT UserSetup.ISEMPTY THEN
                                                                    FIELDERROR("Approval Administrator");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Approval Administrator;
                                                              DEA=Genehmigungsadministrator] }
    { 950 ;   ;Time Sheet Admin.   ;Boolean       ;CaptionML=[ENU=Time Sheet Admin.;
                                                              DEA=Arbeitszeittabellenadministrator] }
    { 5600;   ;Allow FA Posting From;Date         ;CaptionML=[ENU=Allow FA Posting From;
                                                              DEA=Anlagenbuchungen zugel. ab] }
    { 5601;   ;Allow FA Posting To ;Date          ;CaptionML=[ENU=Allow FA Posting To;
                                                              DEA=Anlagenbuchungen zugel. bis] }
    { 5700;   ;Sales Resp. Ctr. Filter;Code10     ;TableRelation="Responsibility Center".Code;
                                                   CaptionML=[ENU=Sales Resp. Ctr. Filter;
                                                              DEA=Verk.-Zust„ndigk.-Einh. Filter] }
    { 5701;   ;Purchase Resp. Ctr. Filter;Code10  ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Purchase Resp. Ctr. Filter;
                                                              DEA=Eink.-Zust„ndigk.-Einh. Filter] }
    { 5900;   ;Service Resp. Ctr. Filter;Code10   ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Service Resp. Ctr. Filter;
                                                              DEA=Serv.-Zust„ndigk.-Einh. Filter] }
    { 50008;  ;IG PO Resp. Ctr. Filter;Text80     ;TableRelation="Responsibility Center";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=CMMS Purch. Order Resp. Ctr. Filter;
                                                              DEA=CMMS Bestellungen -Zust„ndigk.-Einh. Filter];
                                                   Description=CMMS }
    { 50009;  ;IG Asset Resp. Ctr. Filter;Text80  ;TableRelation="Responsibility Center";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Asset Resp. Ctr. Filter;
                                                              DEA=Anlagen.-Zust„ndigk.-Einh. Filter];
                                                   Description=CMMS }
    { 50010;  ;IG Project Resp. Ctr. Filter;Text80;TableRelation="Responsibility Center";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Project Resp. Ctr. Filter;
                                                              DEA=Projekt-Zust„ndigk.-Einh. Filter];
                                                   Description=CMMS }
    { 50050;  ;IG Paraph           ;Code5         ;CaptionML=[ENU=Paraph;
                                                              DEA=Paraphe];
                                                   Description=CMMS }
    { 50110;  ;IG Phone No.        ;Text50        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              DEA=Telefonnr.];
                                                   Description=CMMS }
    { 50120;  ;IG Fax No.          ;Text50        ;CaptionML=[ENU=Fax No.;
                                                              DEA=Faxnr.];
                                                   Description=CMMS }
    { 50200;  ;IG Function Code    ;Code20        ;OnValidate=VAR
                                                                IGCodeData@1000000000 : Record 70006;
                                                              BEGIN
                                                                // ++ IG_001_20150921_DU
                                                                IF "IG Function Code" <> '' THEN
                                                                IGCodeData.ValidateCodeData(
                                                                  DATABASE::"User Setup",
                                                                  FIELDNO("IG Function Code"),
                                                                  0,
                                                                  "IG Function Code");
                                                                // ++ IG_001_20150921_DU
                                                              END;

                                                   OnLookup=VAR
                                                              IGCodeData@1160000 : Record 70006;
                                                            BEGIN
                                                              // ++ IG_001_20150921_DU
                                                              IGCodeData.LookupCodeData(
                                                                DATABASE::"User Setup",
                                                                FIELDNO("IG Function Code"),
                                                                0,
                                                                "IG Function Code")
                                                              // ++ IG_001_20150921_DU
                                                            END;

                                                   CaptionML=[ENU=Function Code;
                                                              DEA=Funktionscode];
                                                   Description=CMMS }
    { 50310;  ;IG Resource No.     ;Code20        ;TableRelation=Resource.No.;
                                                   CaptionML=[ENU=Resource No.;
                                                              DEA=Ressourcennr.];
                                                   Description=CMMS }
    { 51000;  ;IG Asset Administrator;Boolean     ;OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Approval Administrator" THEN BEGIN
                                                                  UserSetup.SETRANGE("Approval Administrator",TRUE);
                                                                  IF NOT UserSetup.ISEMPTY THEN
                                                                    FIELDERROR("Approval Administrator");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Asset Administrator;
                                                              DEA=Anlagenadministrator];
                                                   Description=CMMS }
    { 51010;  ;IG Project Administrator;Boolean   ;OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Approval Administrator" THEN BEGIN
                                                                  UserSetup.SETRANGE("Approval Administrator",TRUE);
                                                                  IF NOT UserSetup.ISEMPTY THEN
                                                                    FIELDERROR("Approval Administrator");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Project Administrator;
                                                              DEA=Projektadministrator];
                                                   Description=CMMS }
    { 51020;  ;IG Workorder Administrator;Boolean ;CaptionML=[ENU=Work Order Administrator;
                                                              DEA=Arbeitsautrag Administrator];
                                                   Description=CMMS }
    { 52000;  ;CM Salesperson Code ;Code20        ;TableRelation=Salesperson/Purchaser.Code;
                                                   CaptionML=[ENU=Salesperson Code;
                                                              DEA=Verk„ufer Code];
                                                   Description=CMMS }
    { 52010;  ;CM Name             ;Text80        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(User ID)));
                                                   CaptionML=[ENU=Name;
                                                              DEA=Name];
                                                   Description=CMMS FF;
                                                   Editable=No }
    { 52020;  ;CM Timetrack. Revers. Allowed;Boolean;
                                                   CaptionML=[ENU=Timetracking Reversal Allowed;
                                                              DEA=Zeiterfassung Storno erlaubt] }
    { 52030;  ;CM Substitution Admin;Boolean      ;CaptionML=[ENU=Substitution Admin;
                                                              DEA=Vertreter Administrator] }
    { 52040;  ;CM User Admin       ;Boolean       ;CaptionML=[ENU=User Admin;
                                                              DEA=Benutzer Administrator] }
    { 52050;  ;CM Timetrack. Mandatory;Boolean    ;CaptionML=[ENU=Timetracking Mandatory;
                                                              DEA=Zeiterfassung Pflicht] }
    { 52060;  ;CM Change Oper. Status Allowed;Boolean;
                                                   CaptionML=[ENU=Change Operational Status Allowed;
                                                              DEA=Operational Status warten erlaubt] }
    { 52070;  ;CM Discard Workorders Allowed;Boolean;
                                                   CaptionML=ENU=Discard Workorders Allowed }
    { 53000;  ;CM Notifications    ;Boolean       ;CaptionML=ENU=Notifications }
    { 53100;  ;CM Connector        ;Option        ;CaptionML=ENU=Connector;
                                                   OptionString=[ ,Email,Skype] }
    { 53110;  ;CM Connector Id     ;Text80        ;CaptionML=ENU=Connector Id (Optional) }
    { 53200;  ;CM Notification 1   ;Boolean       ;CaptionML=ENU=New Workorder assigned to me;
                                                   Description=New Workorder assigned to me }
    { 53201;  ;CM Notification 2   ;Boolean       ;CaptionML=ENU=Workorder assigned to me;
                                                   Description=Workorder assigned to me }
    { 53202;  ;CM Notification 3   ;Boolean       ;CaptionML=ENU=My Workorder status changed;
                                                   Description=My Workorder - status changed }
    { 53203;  ;CM Notification 4   ;Boolean       ;CaptionML=ENU=My Workorder - new Task;
                                                   Description=My Workorder - new Task }
    { 53204;  ;CM Notification 5   ;Boolean       ;CaptionML=ENU=Task assigend to me;
                                                   Description=Task assigend to me }
    { 53205;  ;CM Notification 6   ;Boolean       ;CaptionML=ENU=My Task - status changed;
                                                   Description=My Task - status changed }
    { 75000;  ;CM Time Tracking Qty.;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(CM Date Filter),
                                                                                                            CM User ID=FIELD(User ID)));
                                                   Editable=No }
    { 80000;  ;CM No. of WOs (Due Date);Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Assigned User ID=FIELD(User ID),
                                                                                        CM Due Date=FIELD(CM Date Filter),
                                                                                        CM Status=FIELD(CM Status Filter)));
                                                   Editable=No }
    { 85000;  ;CM No. of To-dos  (Due Date);Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Assigned User ID=FIELD(User ID),
                                                                                  Date=FIELD(CM Date Filter),
                                                                                  CM Status=FIELD(CM Status Filter)));
                                                   Editable=No }
    { 90000;  ;CM Date Filter      ;Date          ;FieldClass=FlowFilter;
                                                   Editable=No }
    { 90010;  ;CM Status Filter    ;Option        ;FieldClass=FlowFilter;
                                                   OptionString=0,1,2,3,4,5,6,7,8,9,10 }
  }
  KEYS
  {
    {    ;User ID                                 ;Clustered=Yes }
    {    ;Salespers./Purch. Code                   }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;User ID,CM Name                          }
  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=The %1 Salesperson/Purchaser code is already assigned to another User ID %2.;DEA=Der Verk„ufer-/Eink„ufercode ''%1'' ist bereits einer anderen Benutzer-ID ''%2'' zugewiesen.';
      Text003@1002 : TextConst 'ENU="You cannot have both a %1 and %2. ";DEA="%1 und %2 k”nnen nicht zugleich vorhanden sein. "';
      Text005@1004 : TextConst 'ENU=You cannot have approval limits less than zero.;DEA=Die Genehmigungsgrenzwerte k”nnen nicht kleiner als Null sein.';
      CMGenMgt@1000000000 : Codeunit 70000;

    BEGIN
    END.
  }
}

OBJECT Table 370 Excel Buffer
{
  OBJECT-PROPERTIES
  {
    Date=07.09.17;
    Time=15:10:23;
    Modified=Yes;
    Version List=NAVW19.00,ENC,CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Excel Buffer;
               DEA=Excelpuffer];
  }
  FIELDS
  {
    { 1   ;   ;Row No.             ;Integer       ;OnValidate=BEGIN
                                                                xlRowID := '';
                                                                IF "Row No." <> 0 THEN
                                                                  xlRowID := FORMAT("Row No.");
                                                              END;

                                                   CaptionML=[ENU=Row No.;
                                                              DEA=Zeilennr.] }
    { 2   ;   ;xlRowID             ;Text10        ;CaptionML=[ENU=xlRowID;
                                                              DEA=XlZeileID] }
    { 3   ;   ;Column No.          ;Integer       ;OnValidate=VAR
                                                                x@1000 : Integer;
                                                                i@1001 : Integer;
                                                                y@1003 : Integer;
                                                                c@1002 : Char;
                                                                t@1102601000 : Text[30];
                                                              BEGIN
                                                                xlColID := '';
                                                                x := "Column No.";
                                                                WHILE x > 26 DO BEGIN
                                                                  y := x MOD 26;
                                                                  IF y = 0 THEN
                                                                    y := 26;
                                                                  c := 64 + y;
                                                                  i := i + 1;
                                                                  t[i] := c;
                                                                  x := (x - y) DIV 26;
                                                                END;
                                                                IF x > 0 THEN BEGIN
                                                                  c := 64 + x;
                                                                  i := i + 1;
                                                                  t[i] := c;
                                                                END;
                                                                FOR x := 1 TO i DO
                                                                  xlColID[x] := t[1 + i - x];
                                                              END;

                                                   CaptionML=[ENU=Column No.;
                                                              DEA=Spaltennr.] }
    { 4   ;   ;xlColID             ;Text10        ;CaptionML=[ENU=xlColID;
                                                              DEA=XlSpalteID] }
    { 5   ;   ;Cell Value as Text  ;Text250       ;CaptionML=[ENU=Cell Value as Text;
                                                              DEA=Zellenwert als Text] }
    { 6   ;   ;Comment             ;Text250       ;CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung] }
    { 7   ;   ;Formula             ;Text250       ;CaptionML=[ENU=Formula;
                                                              DEA=Formel] }
    { 8   ;   ;Bold                ;Boolean       ;CaptionML=[ENU=Bold;
                                                              DEA=Fett] }
    { 9   ;   ;Italic              ;Boolean       ;CaptionML=[ENU=Italic;
                                                              DEA=Kursiv] }
    { 10  ;   ;Underline           ;Boolean       ;CaptionML=[ENU=Underline;
                                                              DEA=Unterstrichen] }
    { 11  ;   ;NumberFormat        ;Text30        ;CaptionML=[ENU=NumberFormat;
                                                              DEA=Nummernformat] }
    { 12  ;   ;Formula2            ;Text250       ;CaptionML=[ENU=Formula2;
                                                              DEA=Formel 2] }
    { 13  ;   ;Formula3            ;Text250       ;CaptionML=[ENU=Formula3;
                                                              DEA=Formel 3] }
    { 14  ;   ;Formula4            ;Text250       ;CaptionML=[ENU=Formula4;
                                                              DEA=Formel 4] }
    { 15  ;   ;Cell Type           ;Option        ;CaptionML=[ENU=Cell Type;
                                                              DEA=Zellentyp];
                                                   OptionCaptionML=[ENU=Number,Text,Date,Time;
                                                                    DEA=Nummer,Text,Datum,Uhrzeit];
                                                   OptionString=Number,Text,Date,Time }
    { 16  ;   ;Double Underline    ;Boolean       ;CaptionML=[ENU=Double Underline;
                                                              DEA=Doppelt unterstrichen] }
    { 50000;  ;BlobValue           ;BLOB           }
  }
  KEYS
  {
    {    ;Row No.,Column No.                      ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst '@@@="{Locked=""Excel""}";ENU=Excel not found.;DEA=Excel wurde nicht gefunden.';
      Text001@1001 : TextConst 'ENU=You must enter a file name.;DEA=Sie mssen einen Dateinamen angeben.';
      Text002@1002 : TextConst '@@@="{Locked=""Excel""}";ENU=You must enter an Excel worksheet name.;DEA=Sie mssen einen Exceltabellennamen angeben.';
      Text003@1003 : TextConst 'ENU=The file %1 does not exist.;DEA=Die Datei %1 ist nicht vorhanden.';
      Text004@1004 : TextConst '@@@="{Locked=""Excel""}";ENU=The Excel worksheet %1 does not exist.;DEA=Die Exceltabelle %1 ist nicht vorhanden.';
      Text005@1005 : TextConst '@@@="{Locked=""Excel""}";ENU=Creating Excel worksheet...\\;DEA=Excel-Arbeitsbl. erstellen...\\';
      Text006@1006 : TextConst 'ENU=%1%3%4%3Page %2;DEA=%1%3%4%3Seite %2';
      Text007@1007 : TextConst '@@@="{Locked=""Excel""}";ENU=Reading Excel worksheet...\\;DEA=Excel-Arbeitsbl. lesen...\\';
      Text013@1013 : TextConst 'ENU=&B;DEA=&B';
      Text014@1014 : TextConst 'ENU=&D;DEA=&D';
      Text015@1015 : TextConst 'ENU=&P;DEA=&P';
      Text016@1016 : TextConst 'ENU=A1;DEA=A1';
      Text017@1017 : TextConst 'ENU=SUMIF;DEA=SUMIF';
      Text018@1018 : TextConst 'ENU=#N/A;DEA=#N/A';
      Text019@1019 : TextConst '@@@={Locked} Used to define an Excel range name. You must refer to Excel rules to change this term.;ENU=GLAcc;DEA=GLAcc';
      Text020@1020 : TextConst '@@@={Locked} Used to define an Excel range name. You must refer to Excel rules to change this term.;ENU=Period;DEA=Period';
      Text021@1021 : TextConst 'ENU=Budget;DEA=Budget';
      InfoExcelBuf@1036 : TEMPORARY Record 370;
      FileManagement@1045 : Codeunit 419;
      XlWrkBkWriter@1022 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorkbookWriter";
      XlWrkBkReader@1023 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorkbookReader";
      XlWrkShtWriter@1024 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorksheetWriter";
      XlWrkShtReader@1043 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorksheetReader";
      XlApp@1044 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.ApplicationClass" RUNONCLIENT;
      XlWrkBk@1051 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook" RUNONCLIENT;
      XlWrkSht@1009 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Worksheet" RUNONCLIENT;
      XlHelper@1052 : DotNet "'Microsoft.Dynamics.Nav.Integration.Office, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Integration.Office.Excel.ExcelHelper" RUNONCLIENT;
      ActiveSheetName@1049 : Text[250];
      RangeStartXlRow@1034 : Text[30];
      RangeStartXlCol@1033 : Text[30];
      RangeEndXlRow@1032 : Text[30];
      RangeEndXlCol@1031 : Text[30];
      FileNameServer@1046 : Text;
      FriendlyName@1025 : Text;
      CurrentRow@1029 : Integer;
      CurrentCol@1030 : Integer;
      UseInfoSheet@1035 : Boolean;
      Text022@1041 : TextConst '@@@={Locked} Used to define an Excel range name. You must refer to Excel rules to change this term.;ENU=CostAcc;DEA=CostAcc';
      Text023@1037 : TextConst 'ENU=Information;DEA=Informationen';
      Text034@1039 : TextConst '@@@="{Split=r''\|\*\..{1,4}\|?''}{Locked=""Excel""}";ENU=Excel Files (*.xls*)|*.xls*|All Files (*.*)|*.*;DEA=Excel-Dateien (*.xls*)|*.xls*|Alle Dateien (*.*)|*.*';
      Text035@1040 : TextConst 'ENU=The operation was canceled.;DEA=Der Vorgang wurde abgebrochen.';
      Text036@1042 : TextConst '@@@="{Locked=""Excel""}";ENU=The Excel workbook does not exist.;DEA=Die Excel-Tabelle ist nicht vorhanden.';
      Text037@1047 : TextConst '@@@="{Locked=""Excel""}";ENU=Could not create the Excel workbook.;DEA=Die Excel-Tabelle konnte nicht erstellt werden.';
      Text038@1048 : TextConst 'ENU=Global variable %1 is not included for test.;DEA=Die globale Variable ''%1'' ist nicht fr den Test enthalten.';
      Text039@1050 : TextConst 'ENU=Cell type has not been set.;DEA=Die Zellenart wurde nicht definiert.';
      Text040@1008 : TextConst '@@@="{Locked=""Excel""}";ENU=Export Excel File;DEA=Excel-Datei exportieren';
      SavingDocumentMsg@1010 : TextConst 'ENU=Saving the following document: %1.;DEA=Das folgende Dokument wird gespeichert: %1.';
      ExcelFileExtensionTok@1012 : TextConst '@@@={Locked};ENU=.xlsx;DEA=.xlsx';
      IGUseFill@1000000001 : Boolean;
      IGFill@1000000002 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.Fill";

    PROCEDURE CreateBook@1(FileName@1001 : Text;SheetName@1000 : Text[250]);
    BEGIN
      IF SheetName = '' THEN
        ERROR(Text002);

      IF FileName = '' THEN
        FileNameServer := FileManagement.ServerTempFileName('xlsx')
      ELSE BEGIN
        IF EXISTS(FileName) THEN
          ERASE(FileName);
        FileNameServer := FileName;
      END;

      XlWrkBkWriter := XlWrkBkWriter.Create(FileNameServer);
      IF ISNULL(XlWrkBkWriter) THEN
        ERROR(Text037);

      XlWrkShtWriter := XlWrkBkWriter.FirstWorksheet;
      IF SheetName <> '' THEN BEGIN
        XlWrkShtWriter.Name := SheetName;
        ActiveSheetName := SheetName;
      END
    END;

    PROCEDURE OpenBook@2(FileName@1000 : Text;SheetName@1001 : Text[250]);
    BEGIN
      IF FileName = '' THEN
        ERROR(Text001);

      IF SheetName = '' THEN
        ERROR(Text002);

      XlWrkBkReader := XlWrkBkReader.Open(FileName);
      IF XlWrkBkReader.HasWorksheet(SheetName) THEN BEGIN
        XlWrkShtReader := XlWrkBkReader.GetWorksheetByName(SheetName);
      END ELSE BEGIN
        QuitExcel;
        ERROR(Text004,SheetName);
      END;
    END;

    PROCEDURE UpdateBook@5(FileName@1000 : Text;SheetName@1001 : Text[250]);
    BEGIN
      IF FileName = '' THEN
        ERROR(Text001);

      IF SheetName = '' THEN
        ERROR(Text002);

      FileNameServer := FileName;
      XlWrkBkWriter := XlWrkBkWriter.Open(FileNameServer);
      IF XlWrkBkWriter.HasWorksheet(SheetName) THEN BEGIN
        XlWrkShtWriter := XlWrkBkWriter.GetWorksheetByName(SheetName);
        ActiveSheetName := SheetName;
      END ELSE BEGIN
        QuitExcel;
        ERROR(Text004,SheetName);
      END;
    END;

    PROCEDURE CloseBook@30();
    BEGIN
      IF NOT ISNULL(XlWrkBkWriter) THEN BEGIN
        XlWrkBkWriter.ClearFormulaCalculations;
        XlWrkBkWriter.ValidateDocument;
        XlWrkBkWriter.Close;
        CLEAR(XlWrkShtWriter);
        CLEAR(XlWrkBkWriter);
      END;

      IF NOT ISNULL(XlWrkBkReader) THEN BEGIN
        CLEAR(XlWrkShtReader);
        CLEAR(XlWrkBkReader);
      END;
    END;

    PROCEDURE WriteSheet@37(ReportHeader@1001 : Text;CompanyName2@1002 : Text;UserID2@1003 : Text);
    VAR
      ExcelBufferDialogMgt@1009 : Codeunit 5370;
      OrientationValues@1000 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.OrientationValues";
      CRLF@1008 : Char;
      RecNo@1010 : Integer;
      InfoRecNo@1012 : Integer;
      TotalRecNo@1011 : Integer;
      LastUpdate@1004 : DateTime;
    BEGIN
      LastUpdate := CURRENTDATETIME;
      ExcelBufferDialogMgt.Open(Text005);

      CRLF := 10;
      RecNo := 1;
      TotalRecNo := COUNT + InfoExcelBuf.COUNT;
      RecNo := 0;

      XlWrkShtWriter.AddPageSetup(OrientationValues.Landscape);

      // commit is required because of the result boolean check of ExcelBufferDialogMgt.RUN
      COMMIT;

      IF FINDSET THEN
        REPEAT
          RecNo := RecNo + 1;
          IF NOT UpdateProgressDialog(ExcelBufferDialogMgt,LastUpdate,RecNo,TotalRecNo) THEN BEGIN
            QuitExcel;
            ERROR(Text035)
          END;
          IF Formula = '' THEN
            WriteCellValue(Rec)
          ELSE
            WriteCellFormula(Rec)
        UNTIL NEXT = 0;

      IF ReportHeader <> '' THEN
        XlWrkShtWriter.AddHeader(
          TRUE,
          STRSUBSTNO('%1%2%1%3%4',GetExcelReference(1),ReportHeader,CRLF,CompanyName2));

      XlWrkShtWriter.AddHeader(
        FALSE,
        STRSUBSTNO(Text006,GetExcelReference(2),GetExcelReference(3),CRLF,UserID2));

      IF UseInfoSheet THEN
        IF InfoExcelBuf.FINDSET THEN BEGIN
          XlWrkShtWriter := XlWrkBkWriter.AddWorksheet(Text023);
          REPEAT
            InfoRecNo := InfoRecNo + 1;
            IF NOT UpdateProgressDialog(ExcelBufferDialogMgt,LastUpdate,RecNo + InfoRecNo,TotalRecNo) THEN BEGIN
              QuitExcel;
              ERROR(Text035)
            END;
            IF InfoExcelBuf.Formula = '' THEN
              WriteCellValue(InfoExcelBuf)
            ELSE
              WriteCellFormula(InfoExcelBuf)
          UNTIL InfoExcelBuf.NEXT = 0;
        END;

      ExcelBufferDialogMgt.Close;
    END;

    LOCAL PROCEDURE WriteCellValue@28(ExcelBuffer@1000 : Record 370);
    VAR
      Decorator@1001 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.CellDecorator";
    BEGIN
      WITH ExcelBuffer DO BEGIN
        GetCellDecorator(Bold,Italic,Underline,"Double Underline",Decorator);

        //++IG
        IF (IGUseFill) AND (NOT ISNULL(IGFill))THEN
          Decorator.Fill := IGFill;
        //--IG
        CASE "Cell Type" OF
          "Cell Type"::Number:
            XlWrkShtWriter.SetCellValueNumber("Row No.",xlColID,"Cell Value as Text",NumberFormat,Decorator);
          "Cell Type"::Text:
            XlWrkShtWriter.SetCellValueText("Row No.",xlColID,"Cell Value as Text", Decorator);
          "Cell Type"::Date:
            XlWrkShtWriter.SetCellValueDate("Row No.",xlColID,"Cell Value as Text",NumberFormat,Decorator);
          "Cell Type"::Time:
            XlWrkShtWriter.SetCellValueTime("Row No.",xlColID,"Cell Value as Text",NumberFormat,Decorator);
          ELSE
            ERROR(Text039)
        END;
      END;
    END;

    LOCAL PROCEDURE WriteCellFormula@38(ExcelBuffer@1000 : Record 370);
    VAR
      Decorator@1001 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.CellDecorator";
    BEGIN
      WITH ExcelBuffer DO BEGIN
        GetCellDecorator(Bold,Italic,Underline,"Double Underline",Decorator);

        XlWrkShtWriter.SetCellFormula("Row No.",xlColID,GetFormula,NumberFormat,Decorator);
      END;
    END;

    LOCAL PROCEDURE GetCellDecorator@33(IsBold@1000 : Boolean;IsItalic@1001 : Boolean;IsUnderlined@1002 : Boolean;IsDoubleUnderlined@1004 : Boolean;VAR Decorator@1003 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.CellDecorator");
    BEGIN
      IF IsBold AND IsItalic THEN BEGIN
        IF IsDoubleUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultBoldItalicDoubleUnderlinedCellDecorator;
          EXIT;
        END;
        IF IsUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultBoldItalicUnderlinedCellDecorator;
          EXIT;
        END;
      END;

      IF IsBold AND IsItalic THEN BEGIN
        Decorator := XlWrkShtWriter.DefaultBoldItalicCellDecorator;
        EXIT;
      END;

      IF IsBold THEN BEGIN
        IF IsDoubleUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultBoldDoubleUnderlinedCellDecorator;
          EXIT;
        END;
        IF IsUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultBoldUnderlinedCellDecorator;
          EXIT;
        END;
      END;

      IF IsBold THEN BEGIN
        Decorator := XlWrkShtWriter.DefaultBoldCellDecorator;
        EXIT;
      END;

      IF IsItalic THEN BEGIN
        IF IsDoubleUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultItalicDoubleUnderlinedCellDecorator;
          EXIT;
        END;
        IF IsUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultItalicUnderlinedCellDecorator;
          EXIT;
        END;
      END;

      IF IsItalic THEN BEGIN
        Decorator := XlWrkShtWriter.DefaultItalicCellDecorator;
        EXIT;
      END;

      IF IsDoubleUnderlined THEN
        Decorator := XlWrkShtWriter.DefaultDoubleUnderlinedCellDecorator
      ELSE BEGIN
        IF IsUnderlined THEN
          Decorator := XlWrkShtWriter.DefaultUnderlinedCellDecorator
        ELSE
          Decorator := XlWrkShtWriter.DefaultCellDecorator;
      END;
    END;

    PROCEDURE CreateRangeName@9(RangeName@1000 : Text[30];FromColumnNo@1001 : Integer;FromRowNo@1002 : Integer);
    VAR
      TempExcelBuf@1005 : TEMPORARY Record 370;
      ToxlRowID@1004 : Text[10];
    BEGIN
      SETCURRENTKEY("Row No.","Column No.");
      IF FIND('+') THEN
        ToxlRowID := xlRowID;
      TempExcelBuf.VALIDATE("Row No.",FromRowNo);
      TempExcelBuf.VALIDATE("Column No.",FromColumnNo);

      XlWrkShtWriter.AddRange(
        RangeName,
        GetExcelReference(4) + TempExcelBuf.xlColID + GetExcelReference(4) + TempExcelBuf.xlRowID +
        ':' +
        GetExcelReference(4) + TempExcelBuf.xlColID + GetExcelReference(4) + ToxlRowID);
    END;

    PROCEDURE GiveUserControl@3();
    BEGIN
      IF NOT ISNULL(XlApp) THEN BEGIN
        XlApp.Visible := TRUE;
        XlApp.UserControl := TRUE;
        CLEAR(XlApp);
      END;
    END;

    PROCEDURE ReadSheet@4();
    VAR
      ExcelBufferDialogMgt@1003 : Codeunit 5370;
      CellData@1002 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.CellData";
      Enumerator@1001 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.IEnumerator";
      i@1000 : Integer;
      RowCount@1009 : Integer;
      LastUpdate@1004 : DateTime;
    BEGIN
      LastUpdate := CURRENTDATETIME;
      ExcelBufferDialogMgt.Open(Text007);
      DELETEALL;

      Enumerator := XlWrkShtReader.GetEnumerator;
      RowCount := XlWrkShtReader.RowCount;
      WHILE Enumerator.MoveNext DO BEGIN
        CellData := Enumerator.Current;
        IF CellData.HasValue THEN BEGIN
          VALIDATE("Row No.",CellData.RowNumber);
          VALIDATE("Column No.",CellData.ColumnNumber);
          ParseCellValue(CellData.Value,CellData.Format);
          INSERT;
        END;

        i := i + 1;
        COMMIT;
        IF NOT UpdateProgressDialog(ExcelBufferDialogMgt,LastUpdate,i,RowCount) THEN BEGIN
          QuitExcel;
          ERROR(Text035)
        END;
      END;

      QuitExcel;
      ExcelBufferDialogMgt.Close;
    END;

    LOCAL PROCEDURE ParseCellValue@40(Value@1000 : Text;FormatString@1001 : Text);
    VAR
      Decimal@1004 : Decimal;
    BEGIN
      // The format contains only en-US number separators, this is an OpenXML standard requirement
      // The algorithm sieves the data based on formatting as follows (the steps must run in this order)
      // 1. FormatString = '@' -> Text
      // 2. FormatString.Contains(':') -> Time
      // 3. FormatString.ContainsOneOf('y', 'm', 'd') && FormatString.DoesNotContain('Red') -> Date
      // 4. anything else -> Decimal

      NumberFormat := COPYSTR(FormatString,1,30);

      IF FormatString = '@' THEN BEGIN
        "Cell Type" := "Cell Type"::Text;
        //++ENC
        IF STRLEN(Value) > 250 THEN BEGIN
          CMSetBlob(Value);
          "Cell Value as Text" := '';
        END
        ELSE BEGIN
          "Cell Value as Text" := Value;
          CMSetBlob('');
        END;
        //--ENC
        EXIT;
      END;

      EVALUATE(Decimal,Value);

      IF STRPOS(FormatString,':') <> 0 THEN BEGIN
        // Excel Time is stored in OADate format
        "Cell Type" := "Cell Type"::Time;
        "Cell Value as Text" := FORMAT(DT2TIME(ConvertDateTimeDecimalToDateTime(Decimal)));
        EXIT;
      END;

      IF ((STRPOS(FormatString,'y') <> 0) OR
          (STRPOS(FormatString,'m') <> 0) OR
          (STRPOS(FormatString,'d') <> 0)) AND
         (STRPOS(FormatString,'Red') = 0)
      THEN BEGIN
        "Cell Type" := "Cell Type"::Date;
        "Cell Value as Text" := FORMAT(DT2DATE(ConvertDateTimeDecimalToDateTime(Decimal)));
        EXIT;
      END;

      "Cell Type" := "Cell Type"::Number;
      "Cell Value as Text" := FORMAT(ROUND(Decimal,0.000001),0,1);
    END;

    PROCEDURE SelectSheetsName@6(FileName@1000 : Text) : Text[250];
    VAR
      TempNameValueBuffer@1009 : TEMPORARY Record 823;
      SheetNames@1008 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.ArrayList";
      SheetName@1002 : Text[250];
      SelectedSheetName@1007 : Text[250];
      i@1001 : Integer;
    BEGIN
      IF FileName = '' THEN
        ERROR(Text001);

      XlWrkBkReader := XlWrkBkReader.Open(FileName);

      SelectedSheetName := '';
      SheetNames := SheetNames.ArrayList(XlWrkBkReader.SheetNames);
      IF NOT ISNULL(SheetNames) THEN BEGIN
        FOR i := 0 TO SheetNames.Count - 1 DO BEGIN
          SheetName := SheetNames.Item(i);
          IF SheetName <> '' THEN BEGIN
            TempNameValueBuffer.INIT;
            TempNameValueBuffer.ID := i;
            TempNameValueBuffer.Name := FORMAT(i + 1);
            TempNameValueBuffer.Value := SheetName;
            TempNameValueBuffer.INSERT;
          END;
        END;
        IF NOT TempNameValueBuffer.ISEMPTY THEN
          IF TempNameValueBuffer.COUNT = 1 THEN
            SelectedSheetName := TempNameValueBuffer.Value
          ELSE BEGIN
            TempNameValueBuffer.FINDFIRST;
            IF PAGE.RUNMODAL(PAGE::"Name/Value Lookup",TempNameValueBuffer) = ACTION::LookupOK THEN
              SelectedSheetName := TempNameValueBuffer.Value;
          END;
      END;

      QuitExcel;
      EXIT(SelectedSheetName);
    END;

    PROCEDURE GetExcelReference@10(Which@1000 : Integer) : Text[250];
    BEGIN
      CASE Which OF
        1:
          EXIT(Text013);
        // DO NOT TRANSLATE: &B is the Excel code to turn bold printing on or off for customized Header/Footer.
        2:
          EXIT(Text014);
        // DO NOT TRANSLATE: &D is the Excel code to print the current date in customized Header/Footer.
        3:
          EXIT(Text015);
        // DO NOT TRANSLATE: &P is the Excel code to print the page number in customized Header/Footer.
        4:
          EXIT('$');
        // DO NOT TRANSLATE: $ is the Excel code for absolute reference to cells.
        5:
          EXIT(Text016);
        // DO NOT TRANSLATE: A1 is the Excel reference of the first cell.
        6:
          EXIT(Text017);
        // DO NOT TRANSLATE: SUMIF is the name of the Excel function used to summarize values according to some conditions.
        7:
          EXIT(Text018);
        // DO NOT TRANSLATE: The #N/A Excel error value occurs when a value is not available to a function or formula.
        8:
          EXIT(Text019);
        // DO NOT TRANSLATE: GLAcc is used to define an Excel range name. You must refer to Excel rules to change this term.
        9:
          EXIT(Text020);
        // DO NOT TRANSLATE: Period is used to define an Excel range name. You must refer to Excel rules to change this term.
        10:
          EXIT(Text021);
        // DO NOT TRANSLATE: Budget is used to define an Excel worksheet name. You must refer to Excel rules to change this term.
        11:
          EXIT(Text022);
        // DO NOT TRANSLATE: CostAcc is used to define an Excel range name. You must refer to Excel rules to change this term.
      END;
    END;

    PROCEDURE ExportBudgetFilterToFormula@11(VAR ExcelBuf@1000 : Record 370) : Boolean;
    VAR
      ExcelBufFormula@1001 : TEMPORARY Record 370;
      FirstRow@1002 : Integer;
      LastRow@1003 : Integer;
      HasFormulaError@1005 : Boolean;
      ThisCellHasFormulaError@1006 : Boolean;
      ExcelBufFormula2@1004 : TEMPORARY Record 370;
    BEGIN
      ExcelBuf.SETFILTER(Formula,'<>%1','');
      IF ExcelBuf.FINDSET THEN
        REPEAT
          ExcelBufFormula := ExcelBuf;
          ExcelBufFormula.INSERT;
        UNTIL ExcelBuf.NEXT = 0;
      ExcelBuf.RESET;

      WITH ExcelBufFormula DO
        IF FINDSET THEN
          REPEAT
            ThisCellHasFormulaError := FALSE;
            ExcelBuf.SETRANGE("Column No.",1);
            ExcelBuf.SETFILTER("Row No.",'<>%1',"Row No.");
            ExcelBuf.SETFILTER("Cell Value as Text",Formula);
            ExcelBufFormula2 := ExcelBufFormula;
            IF ExcelBuf.FINDSET THEN
              REPEAT
                IF NOT GET(ExcelBuf."Row No.","Column No.") THEN
                  ExcelBuf.MARK(TRUE);
              UNTIL ExcelBuf.NEXT = 0;
            ExcelBufFormula := ExcelBufFormula2;
            ClearFormula;
            ExcelBuf.SETRANGE("Cell Value as Text");
            ExcelBuf.SETRANGE("Row No.");
            IF ExcelBuf.FINDSET THEN
              REPEAT
                IF ExcelBuf.MARK THEN BEGIN
                  LastRow := ExcelBuf."Row No.";
                  IF FirstRow = 0 THEN
                    FirstRow := LastRow;
                END ELSE
                  IF FirstRow <> 0 THEN BEGIN
                    IF FirstRow = LastRow THEN
                      ThisCellHasFormulaError := AddToFormula(xlColID + FORMAT(FirstRow))
                    ELSE
                      ThisCellHasFormulaError :=
                        AddToFormula('SUM(' + xlColID + FORMAT(FirstRow) + ':' + xlColID + FORMAT(LastRow) + ')');
                    FirstRow := 0;
                    IF ThisCellHasFormulaError THEN
                      SetFormula(ExcelBuf.GetExcelReference(7));
                  END;
              UNTIL ThisCellHasFormulaError OR (ExcelBuf.NEXT = 0);

            IF NOT ThisCellHasFormulaError AND (FirstRow <> 0) THEN BEGIN
              IF FirstRow = LastRow THEN
                ThisCellHasFormulaError := AddToFormula(xlColID + FORMAT(FirstRow))
              ELSE
                ThisCellHasFormulaError :=
                  AddToFormula('SUM(' + xlColID + FORMAT(FirstRow) + ':' + xlColID + FORMAT(LastRow) + ')');
              FirstRow := 0;
              IF ThisCellHasFormulaError THEN
                SetFormula(ExcelBuf.GetExcelReference(7));
            END;

            ExcelBuf.RESET;
            ExcelBuf.GET("Row No.","Column No.");
            ExcelBuf.SetFormula(GetFormula);
            ExcelBuf.MODIFY;
            HasFormulaError := HasFormulaError OR ThisCellHasFormulaError;
          UNTIL NEXT = 0;

      EXIT(HasFormulaError);
    END;

    PROCEDURE AddToFormula@12(Text@1001 : Text[30]) : Boolean;
    VAR
      Overflow@1002 : Boolean;
      LongFormula@1000 : Text[1000];
    BEGIN
      LongFormula := GetFormula;
      IF LongFormula = '' THEN
        LongFormula := '=';
      IF LongFormula <> '=' THEN
        IF STRLEN(LongFormula) + 1 > MAXSTRLEN(LongFormula) THEN
          Overflow := TRUE
        ELSE
          LongFormula := LongFormula + '+';
      IF STRLEN(LongFormula) + STRLEN(Text) > MAXSTRLEN(LongFormula) THEN
        Overflow := TRUE
      ELSE
        SetFormula(LongFormula + Text);
      EXIT(Overflow);
    END;

    PROCEDURE GetFormula@13() : Text[1000];
    BEGIN
      EXIT(Formula + Formula2 + Formula3 + Formula4);
    END;

    PROCEDURE SetFormula@22(LongFormula@1000 : Text[1000]);
    BEGIN
      ClearFormula;
      IF LongFormula = '' THEN
        EXIT;

      Formula := COPYSTR(LongFormula,1,MAXSTRLEN(Formula));
      IF STRLEN(LongFormula) > MAXSTRLEN(Formula) THEN
        Formula2 := COPYSTR(LongFormula,MAXSTRLEN(Formula) + 1,MAXSTRLEN(Formula2));
      IF STRLEN(LongFormula) > MAXSTRLEN(Formula) + MAXSTRLEN(Formula2) THEN
        Formula3 := COPYSTR(LongFormula,MAXSTRLEN(Formula) + MAXSTRLEN(Formula2) + 1,MAXSTRLEN(Formula3));
      IF STRLEN(LongFormula) > MAXSTRLEN(Formula) + MAXSTRLEN(Formula2) + MAXSTRLEN(Formula3) THEN
        Formula4 := COPYSTR(LongFormula,MAXSTRLEN(Formula) + MAXSTRLEN(Formula2) + MAXSTRLEN(Formula3) + 1,MAXSTRLEN(Formula4));
    END;

    PROCEDURE ClearFormula@18();
    BEGIN
      Formula := '';
      Formula2 := '';
      Formula3 := '';
      Formula4 := '';
    END;

    PROCEDURE NewRow@14();
    BEGIN
      CurrentRow := CurrentRow + 1;
      CurrentCol := 0;
    END;

    PROCEDURE AddColumn@16(Value@1000 : Variant;IsFormula@1001 : Boolean;CommentText@1002 : Text[1000];IsBold@1003 : Boolean;IsItalics@1004 : Boolean;IsUnderline@1005 : Boolean;NumFormat@1006 : Text[30];CellType@1007 : Option);
    BEGIN
      IF CurrentRow < 1 THEN
        NewRow;

      CurrentCol := CurrentCol + 1;
      INIT;
      VALIDATE("Row No.",CurrentRow);
      VALIDATE("Column No.",CurrentCol);
      IF IsFormula THEN
        SetFormula(FORMAT(Value))
      ELSE
        "Cell Value as Text" := FORMAT(Value);
      Comment := CommentText;
      Bold := IsBold;
      Italic := IsItalics;
      Underline := IsUnderline;
      NumberFormat := NumFormat;
      "Cell Type" := CellType;
      INSERT;
    END;

    PROCEDURE StartRange@19();
    VAR
      TempExcelBuf@1000 : TEMPORARY Record 370;
    BEGIN
      TempExcelBuf.VALIDATE("Row No.",CurrentRow);
      TempExcelBuf.VALIDATE("Column No.",CurrentCol);

      RangeStartXlRow := TempExcelBuf.xlRowID;
      RangeStartXlCol := TempExcelBuf.xlColID;
    END;

    PROCEDURE EndRange@23();
    VAR
      TempExcelBuf@1000 : TEMPORARY Record 370;
    BEGIN
      TempExcelBuf.VALIDATE("Row No.",CurrentRow);
      TempExcelBuf.VALIDATE("Column No.",CurrentCol);

      RangeEndXlRow := TempExcelBuf.xlRowID;
      RangeEndXlCol := TempExcelBuf.xlColID;
    END;

    PROCEDURE CreateRange@45(RangeName@1000 : Text[250]);
    BEGIN
      XlWrkShtWriter.AddRange(
        RangeName,
        GetExcelReference(4) + RangeStartXlCol + GetExcelReference(4) + RangeStartXlRow +
        ':' +
        GetExcelReference(4) + RangeEndXlCol + GetExcelReference(4) + RangeEndXlRow);
    END;

    PROCEDURE AutoFit@20(RangeName@1000 : Text[50]);
    BEGIN
      IF NOT ISNULL(XlWrkBk) THEN
        XlHelper.AutoFitRangeColumns(XlWrkBk,ActiveSheetName,RangeName);
    END;

    PROCEDURE BorderAround@39(RangeName@1000 : Text[50]);
    BEGIN
      IF NOT ISNULL(XlWrkBk) THEN
        XlHelper.BorderAroundRange(XlWrkBk,ActiveSheetName,RangeName,1);
    END;

    PROCEDURE ClearNewRow@26();
    BEGIN
      CurrentRow := 0;
      CurrentCol := 0;
    END;

    PROCEDURE SetUseInfoSheet@25();
    BEGIN
      UseInfoSheet := TRUE;
    END;

    PROCEDURE AddInfoColumn@24(Value@1006 : Variant;IsFormula@1005 : Boolean;CommentText@1004 : Text[1000];IsBold@1003 : Boolean;IsItalics@1002 : Boolean;IsUnderline@1001 : Boolean;NumFormat@1000 : Text[30];CellType@1007 : Option);
    BEGIN
      IF CurrentRow < 1 THEN
        NewRow;

      CurrentCol := CurrentCol + 1;
      INIT;
      InfoExcelBuf.VALIDATE("Row No.",CurrentRow);
      InfoExcelBuf.VALIDATE("Column No.",CurrentCol);
      IF IsFormula THEN
        InfoExcelBuf.SetFormula(FORMAT(Value))
      ELSE
        InfoExcelBuf."Cell Value as Text" := FORMAT(Value);
      InfoExcelBuf.Bold := IsBold;
      InfoExcelBuf.Italic := IsItalics;
      InfoExcelBuf.Underline := IsUnderline;
      InfoExcelBuf.NumberFormat := NumFormat;
      InfoExcelBuf."Cell Type" := CellType;
      InfoExcelBuf.INSERT;
    END;

    PROCEDURE UTgetGlobalValue@35(globalVariable@1001 : Text[30];VAR value@1000 : Variant);
    BEGIN
      CASE globalVariable OF
        'CurrentRow':
          value := CurrentRow;
        'CurrentCol':
          value := CurrentCol;
        'RangeStartXlRow':
          value := RangeStartXlRow;
        'RangeStartXlCol':
          value := RangeStartXlCol;
        'RangeEndXlRow':
          value := RangeEndXlRow;
        'RangeEndXlCol':
          value := RangeEndXlCol;
        'XlWrkSht':
          value := XlWrkShtWriter;
        'ExcelFile':
          value := FileNameServer;
        ELSE
          ERROR(Text038,globalVariable);
      END;
    END;

    PROCEDURE SetCurrent@27(NewCurrentRow@1000 : Integer;NewCurrentCol@1001 : Integer);
    BEGIN
      CurrentRow := NewCurrentRow;
      CurrentCol := NewCurrentCol;
    END;

    PROCEDURE CreateValidationRule@17(Range@1000 : Code[20]);
    BEGIN
      XlWrkShtWriter.AddRangeDataValidation(
        Range,
        GetExcelReference(4) + RangeStartXlCol + GetExcelReference(4) + RangeStartXlRow +
        ':' +
        GetExcelReference(4) + RangeEndXlCol + GetExcelReference(4) + RangeEndXlRow);
    END;

    PROCEDURE QuitExcel@29();
    BEGIN
      // Close and clear the OpenXml book
      CloseBook;

      // Clear the worksheet automation
      IF NOT ISNULL(XlWrkSht) THEN
        CLEAR(XlWrkSht);

      // Clear the workbook automation
      IF NOT ISNULL(XlWrkBk) THEN
        CLEAR(XlWrkBk);

      // Clear and quit the Excel application automation
      IF NOT ISNULL(XlApp) THEN BEGIN
        XlHelper.CallQuit(XlApp);
        CLEAR(XlApp);
      END;
    END;

    PROCEDURE OpenExcel@31();
    VAR
      FileNameClient@1000 : Text;
    BEGIN
      IF OpenUsingDocumentService('') THEN
        EXIT;

      IF NOT PreOpenExcel THEN
        EXIT;

      // rename the Temporary filename into a more UI friendly name in a new subdirectory
      FileNameClient := FileManagement.DownloadTempFile(FileNameServer);
      FileNameClient := FileManagement.MoveAndRenameClientFile(FileNameClient,GetFriendlyFilename,FORMAT(CREATEGUID));

      XlWrkBk := XlHelper.CallOpen(XlApp,FileNameClient);

      PostOpenExcel;
    END;

    PROCEDURE DownloadAndOpenExcel@34();
    VAR
      ClientFilename@1000 : Text;
    BEGIN
      ClientFilename := GetFriendlyFilename;

      IF FileManagement.CanRunDotNetOnClient THEN BEGIN
        ClientFilename := FileManagement.SaveFileDialog('Save file','',Text034);
        IF ClientFilename = '' THEN
          EXIT;
        IF FileManagement.GetExtension(ClientFilename) = '' THEN
          ClientFilename += ExcelFileExtensionTok;
      END;

      OverwriteAndOpenExistingExcel(ClientFilename);
    END;

    PROCEDURE OverwriteAndOpenExistingExcel@15(FileName@1000 : Text);
    BEGIN
      IF FileName = '' THEN
        ERROR(Text001);

      IF OpenUsingDocumentService(FileName) THEN
        EXIT;

      IF NOT PreOpenExcel THEN
        EXIT;

      FileManagement.DownloadToFile(FileNameServer,FileName);
      XlWrkBk := XlHelper.CallOpen(XlApp,FileName);

      PostOpenExcel;
    END;

    LOCAL PROCEDURE OpenUsingDocumentService@21(FileName@1000 : Text) : Boolean;
    VAR
      DocumentServiceMgt@1005 : Codeunit 9510;
      FileMgt@1004 : Codeunit 419;
      PathHelper@1003 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path";
      DialogWindow@1002 : Dialog;
      DocumentUrl@1001 : Text;
    BEGIN
      IF NOT EXISTS(FileNameServer) THEN
        ERROR(Text003,FileNameServer);

      // if document service is configured we save the generated document to SharePoint and open it from there.
      IF DocumentServiceMgt.IsConfigured THEN BEGIN
        IF FileName = '' THEN
          FileName := 'Book.' + PathHelper.ChangeExtension(PathHelper.GetRandomFileName,'xlsx')
        ELSE BEGIN
          // if file is not applicable for the service it can not be opened using the document service.
          IF NOT DocumentServiceMgt.IsServiceUri(FileName) THEN
            EXIT(FALSE);

          FileName := FileMgt.GetFileName(FileName);
        END;

        DialogWindow.OPEN(STRSUBSTNO(SavingDocumentMsg,FileName));
        DocumentUrl := DocumentServiceMgt.SaveFile(FileNameServer,FileName,TRUE);
        DocumentServiceMgt.OpenDocument(DocumentUrl);
        DialogWindow.CLOSE;
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE PreOpenExcel@7() : Boolean;
    BEGIN
      IF NOT EXISTS(FileNameServer) THEN
        ERROR(Text003,FileNameServer);

      // Download file, if none RTC it should return a filename, and use client automation instead.
      IF NOT FileManagement.CanRunDotNetOnClient THEN BEGIN
        IF NOT FileManagement.DownloadHandler(FileNameServer,Text040,'',Text034,GetFriendlyFilename) THEN
          ERROR(Text001);
        EXIT(FALSE);
      END;

      XlApp := XlApp.ApplicationClass;
      IF ISNULL(XlApp) THEN
        ERROR(Text000);

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE PostOpenExcel@8();
    BEGIN
      XlWrkBk := XlApp.ActiveWorkbook;

      IF ISNULL(XlWrkBk) THEN
        ERROR(Text036);

      // autofit all columns on all worksheets
      XlHelper.AutoFitColumnsInAllWorksheets(XlWrkBk);

      // activate the previous saved sheet name in the workbook
      XlHelper.ActivateSheet(XlWrkBk,ActiveSheetName);
    END;

    PROCEDURE CreateBookAndOpenExcel@32(FileName@1004 : Text;SheetName@1000 : Text[250];ReportHeader@1003 : Text;CompanyName2@1002 : Text;UserID2@1001 : Text);
    BEGIN
      CreateBook(FileName,SheetName);
      WriteSheet(ReportHeader,CompanyName2,UserID2);
      CloseBook;
      OpenExcel;
      GiveUserControl;
    END;

    LOCAL PROCEDURE UpdateProgressDialog@36(VAR ExcelBufferDialogManagement@1000 : Codeunit 5370;VAR LastUpdate@1001 : DateTime;CurrentCount@1002 : Integer;TotalCount@1004 : Integer) : Boolean;
    VAR
      CurrentTime@1003 : DateTime;
    BEGIN
      // Refresh at 100%, and every second in between 0% to 100%
      // Duration is measured in miliseconds -> 1 sec = 1000 ms
      CurrentTime := CURRENTDATETIME;
      IF (CurrentCount = TotalCount) OR (CurrentTime - LastUpdate >= 1000) THEN BEGIN
        LastUpdate := CurrentTime;
        ExcelBufferDialogManagement.SetProgress(ROUND(CurrentCount / TotalCount * 10000,1));
        IF NOT ExcelBufferDialogManagement.RUN THEN
          EXIT(FALSE);
      END;

      EXIT(TRUE)
    END;

    LOCAL PROCEDURE GetFriendlyFilename@46() : Text;
    BEGIN
      IF FriendlyName = '' THEN
        EXIT('Book1' + ExcelFileExtensionTok);

      EXIT(FileManagement.StripNotsupportChrInFileName(FriendlyName) + ExcelFileExtensionTok);
    END;

    PROCEDURE SetFriendlyFilename@41(Name@1000 : Text);
    BEGIN
      FriendlyName := Name;
    END;

    PROCEDURE ConvertDateTimeDecimalToDateTime@43(DateTimeAsOADate@1000 : Decimal) : DateTime;
    VAR
      DotNetDateTime@1003 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime";
      DotNetDateTimeWithKind@1002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime";
      DotNetDateTimeKind@1001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTimeKind";
    BEGIN
      DotNetDateTime := DotNetDateTime.FromOADate(DateTimeAsOADate);
      DotNetDateTimeWithKind := DotNetDateTime.DateTime(DotNetDateTime.Ticks,DotNetDateTimeKind.Local);
      EXIT(DotNetDateTimeWithKind);
    END;

    PROCEDURE ENCCreateWorksheet@1000000000(SheetName@1000 : Text[250]);
    BEGIN
      //++ hier
      IF SheetName = '' THEN
        ERROR(Text002);

      IF SheetName <> '' THEN BEGIN
        XlWrkBkWriter.AddWorksheet(SheetName);
        //XlWrkShtWriter.Name := SheetName;
        //ActiveSheetName := SheetName;
      END
      //-- hier
      {
        IF InfoExcelBuf.FINDSET THEN BEGIN
          XlWrkShtWriter := XlWrkBkWriter.AddWorksheet(Text023);
          REPEAT
            InfoRecNo := InfoRecNo + 1;
            IF NOT UpdateProgressDialog(ExcelBufferDialogMgt,LastUpdate,RecNo + InfoRecNo,TotalRecNo) THEN BEGIN
              QuitExcel;
              ERROR(Text035)
            END;
            IF InfoExcelBuf.Formula = '' THEN
              WriteCellValue(InfoExcelBuf)
            ELSE
              WriteCellFormula(InfoExcelBuf)
          UNTIL InfoExcelBuf.NEXT = 0;
        END;


      }
    END;

    PROCEDURE ENCUpdateBook@1000000001(SheetName@1001 : Text[250]);
    BEGIN
      IF SheetName = '' THEN
        ERROR(Text002);

      IF XlWrkBkWriter.HasWorksheet(SheetName) THEN BEGIN
        XlWrkShtWriter := XlWrkBkWriter.GetWorksheetByName(SheetName);
        ActiveSheetName := SheetName;
      END ELSE BEGIN
        QuitExcel;
        ERROR(Text004,SheetName);
      END;
    END;

    PROCEDURE CMSetBlob@1000000004(value@1000000000 : Text);
    VAR
      OutStr@1000000001 : OutStream;
    BEGIN
      CLEAR(BlobValue);
      Rec.BlobValue.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(value);
      IF NOT Rec.MODIFY(FALSE) THEN
        ;
    END;

    PROCEDURE CMGetBlob@1000000003() : Text;
    VAR
      InStr@1000000000 : InStream;
      CMGMgt@1000000001 : Codeunit 70000;
    BEGIN
      CALCFIELDS(BlobValue);
      Rec.BlobValue.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      EXIT(CMGMgt.Instream2Text(InStr));
    END;

    PROCEDURE CMGetValue@1000000005() : Text;
    BEGIN
      IF Rec."Cell Value as Text" <> '' THEN
        EXIT(Rec."Cell Value as Text");

      CALCFIELDS(BlobValue);
      IF BlobValue.HASVALUE() THEN
        EXIT(CMGetBlob())
      ELSE
        EXIT('');
    END;

    PROCEDURE IGSetCurrentSheetName@1000000002(Name@1000000000 : Text[30]);
    BEGIN
      XlWrkShtWriter.Name(Name);
      ActiveSheetName := Name;
    END;

    PROCEDURE IGSetBackgroundColor@1000000007(HexColor@1000000012 : Code[6]);
    VAR
      IGBorder@1000000000 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.Border";
      IGBorderBottom@1000000009 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.BottomBorder";
      IGBorderStyleValues@1000000010 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.BorderStyleValues";
      IGLocFill@1000000007 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.Fill";
      IGPatFill@1000000006 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.PatternFill";
      IGBgColor@1000000005 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.ForegroundColor";
      IGPatternTypeEnum@1000000004 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.EnumValue`1";
      IGOpenXMLAttr@1000000003 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.OpenXmlAttribute";
      IGColor@1000000002 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.Color";
      XlWrkShtWriter@1000000011 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorksheetWriter";
    BEGIN
      IF HexColor = '' THEN BEGIN
        IGUseFill := FALSE;
        EXIT;
      END;

      //Background Color:
      IGLocFill := IGLocFill.Fill();
      IGPatFill := IGPatFill.PatternFill();
      IGBgColor := IGBgColor.ForegroundColor();
      IGOpenXMLAttr := IGOpenXMLAttr.OpenXmlAttribute('rgb','', 'FF'+HexColor);
      IGBgColor.SetAttribute(IGOpenXMLAttr);
      IGOpenXMLAttr := IGOpenXMLAttr.OpenXmlAttribute('patternType','','solid');
      IGPatFill.SetAttribute(IGOpenXMLAttr);
      IGPatFill.ForegroundColor(IGBgColor);
      IGLocFill.PatternFill(IGPatFill);


      IGUseFill := TRUE;
      IGFill := IGLocFill;
    END;

    BEGIN
    {
      ENC 20160324  Added Functions ENCUpdateBook(),ENCCreateWorksheet()
      CM  20161010  Added Field BlobValue
                    Changed Function ParseCellValue()
                    Added Functions: CMGetBlob(), CMGetValue, CMSetBlob()
    }
    END.
  }
}

OBJECT Table 952 Time Sheet Detail
{
  OBJECT-PROPERTIES
  {
    Date=20.02.18;
    Time=16:14:07;
    Modified=Yes;
    Version List=NAVW17.00,CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF NOT "CM Is CMMS Timesheet" THEN //CM
                 TimeSheetMgt.CheckAccPeriod(Date);
             END;

    OnModify=BEGIN
               IF NOT "CM Is CMMS Timesheet" THEN //CM
                 TimeSheetMgt.CheckAccPeriod(Date);
             END;

    CaptionML=[ENU=Time Sheet Detail;
               DEA=Arbeitszeittabellendetails];
  }
  FIELDS
  {
    { 1   ;   ;Time Sheet No.      ;Code20        ;TableRelation="Time Sheet Header";
                                                   CaptionML=[ENU=Time Sheet No.;
                                                              DEA=Arbeitszeittabelle - Nr.];
                                                   Description=CM }
    { 2   ;   ;Time Sheet Line No. ;Integer       ;CaptionML=[ENU=Time Sheet Line No.;
                                                              DEA=Arbeitszeittabelle - Zeilennr.];
                                                   Description=CM }
    { 3   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              DEA=Datum] }
    { 4   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              DEA=Art];
                                                   OptionCaptionML=[ENU=" ,Resource,Job,Service,Absence,Assembly Order";
                                                                    DEA=" ,Ressource,Projekt,Service,Abwesenheit,Montageauftrag"];
                                                   OptionString=[ ,Resource,Job,Service,Absence,Assembly Order] }
    { 5   ;   ;Resource No.        ;Code20        ;TableRelation=Resource;
                                                   CaptionML=[ENU=Resource No.;
                                                              DEA=Ressourcennr.] }
    { 6   ;   ;Job No.             ;Code20        ;TableRelation=Job;
                                                   CaptionML=[ENU=Job No.;
                                                              DEA=Projektnr.] }
    { 7   ;   ;Job Task No.        ;Code20        ;TableRelation="Job Task"."Job Task No." WHERE (Job No.=FIELD(Job No.));
                                                   CaptionML=[ENU=Job Task No.;
                                                              DEA=Projektaufgabennr.] }
    { 9   ;   ;Cause of Absence Code;Code10       ;TableRelation="Cause of Absence";
                                                   CaptionML=[ENU=Cause of Absence Code;
                                                              DEA=Code Abwesenheitsgrund] }
    { 13  ;   ;Service Order No.   ;Code20        ;TableRelation=IF (Posted=CONST(No)) "Service Header".No. WHERE (Document Type=CONST(Order));
                                                   CaptionML=[ENU=Service Order No.;
                                                              DEA=Serviceauftragsnr.] }
    { 14  ;   ;Service Order Line No.;Integer     ;CaptionML=[ENU=Service Order Line No.;
                                                              DEA=Serviceauftragszeilennr.] }
    { 15  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              DEA=Menge];
                                                   Editable=No }
    { 16  ;   ;Posted Quantity     ;Decimal       ;CaptionML=[ENU=Posted Quantity;
                                                              DEA=Gebuchte Menge] }
    { 18  ;   ;Assembly Order No.  ;Code20        ;TableRelation=IF (Posted=CONST(No)) "Assembly Header".No. WHERE (Document Type=CONST(Order));
                                                   CaptionML=[ENU=Assembly Order No.;
                                                              DEA=Montageauftragsnr.] }
    { 19  ;   ;Assembly Order Line No.;Integer    ;CaptionML=[ENU=Assembly Order Line No.;
                                                              DEA=Montageauftragszeilennr.] }
    { 20  ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionCaptionML=[ENU=Open,Submitted,Rejected,Approved;
                                                                    DEA=Offen,šbermittelt,Abgelehnt,Genehmigt];
                                                   OptionString=Open,Submitted,Rejected,Approved }
    { 23  ;   ;Posted              ;Boolean       ;CaptionML=[ENU=Posted;
                                                              DEA=Gebucht];
                                                   Description=CM }
    { 50000;  ;CM Is CMMS Timesheet;Boolean       ;CaptionML=[ENU=Is CMMS Timesheet;
                                                              DEA=Ist CMMS Zeitsheet] }
    { 50010;  ;CM Entry Date       ;Date          ;CaptionML=[ENU=Entry Date;
                                                              DEA=Eintrag Datum];
                                                   NotBlank=Yes }
    { 50015;  ;CM Posted Datetime  ;DateTime       }
    { 50090;  ;CM Main Asset No.   ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Asset),
                                                                                          Asset Type=CONST(Main Asset));
                                                   CaptionML=[ENU=Main Asset No.;
                                                              DEA=Hauptanlagennr.] }
    { 50100;  ;CM Asset No.        ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Asset),
                                                                                          Asset Type=FILTER(Asset|Sub Asset));
                                                   CaptionML=[ENU=Asset No.;
                                                              DEA=Anlagennr.] }
    { 50110;  ;CM Project No.      ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Project));
                                                   CaptionML=[ENU=Project No.;
                                                              DEA=Projektnr.] }
    { 50200;  ;CM Workorder No.    ;Code20        ;TableRelation=Opportunity.No. WHERE (CM Is Workorder=CONST(Yes));
                                                   CaptionML=[ENU=Workorder No.;
                                                              DEA=Arbeitsauftragnr.] }
    { 50300;  ;CM Task No.         ;Code20        ;TableRelation=To-do.No. WHERE (CM Type=CONST(Task));
                                                   CaptionML=[ENU=Task No.;
                                                              DEA=Aufgabennr.] }
    { 50400;  ;CM User ID          ;Code50        ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=User ID;
                                                              DEA=Benutzer ID] }
    { 50500;  ;CM Assigned User ID ;Code50        ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=Assigned User ID;
                                                              DEA=Zugewiesener Benztzer ID] }
    { 50510;  ;CM Posted By User ID;Code50        ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=Posted By User ID;
                                                              DEA=Gebucht von Benutzer ID] }
    { 50600;  ;CM Description      ;Text250       ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 50610;  ;CM UoM Code         ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Unit of Measure;
                                                              DEA=Einheit] }
    { 50620;  ;CM Quantity         ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              DEA=Menge];
                                                   DecimalPlaces=2:2;
                                                   BlankZero=Yes }
    { 50700;  ;CM Dimension Value 1;Code20        ;TableRelation="Dimension Value".Code WHERE (Dimension Code=FIELD(CM Dimension Code 1));
                                                   CaptionClass=CMTTMgt.GetDimCaption(1) }
    { 50710;  ;CM Dimension Value 2;Code20        ;TableRelation="Dimension Value".Code WHERE (Dimension Code=FIELD(CM Dimension Code 2));
                                                   CaptionClass=CMTTMgt.GetDimCaption(2) }
    { 50720;  ;CM Dimension Value 3;Code20        ;TableRelation="Dimension Value".Code WHERE (Dimension Code=FIELD(CM Dimension Code 3));
                                                   CaptionClass=CMTTMgt.GetDimCaption(3) }
    { 50730;  ;CM Dimension Value 4;Code20        ;TableRelation="Dimension Value".Code WHERE (Dimension Code=FIELD(CM Dimension Code 4));
                                                   CaptionClass=CMTTMgt.GetDimCaption(4) }
    { 50800;  ;CM Dimension Code 1 ;Code20        ;TableRelation=Dimension.Code }
    { 50810;  ;CM Dimension Code 2 ;Code20        ;TableRelation=Dimension.Code }
    { 50820;  ;CM Dimension Code 3 ;Code20        ;TableRelation=Dimension.Code }
    { 50830;  ;CM Dimension Code 4 ;Code20        ;TableRelation=Dimension.Code }
    { 50890;  ;CM Dimension Set ID ;Integer       ;TableRelation="Dimension Set Entry"."Dimension Set ID" }
    { 50900;  ;CM Clienttype       ;Text30        ;CaptionML=[ENU=Clienttype;
                                                              DEA=Clientart] }
    { 60000;  ;CM Reverse Line No. ;Integer       ;TableRelation="Time Sheet Detail"."Time Sheet Line No." WHERE (CM Is CMMS Timesheet=CONST(Yes));
                                                   CaptionML=[ENU=Reverse Line No.;
                                                              DEA=Storno Zeilennr.] }
    { 70000;  ;CM Empty 1          ;Text1          }
    { 70010;  ;CM Empty 2          ;Text1          }
    { 70020;  ;CM Empty 3          ;Text1          }
    { 70030;  ;CM Empty 4          ;Text1          }
    { 70040;  ;CM Text 1           ;Text250        }
    { 70050;  ;CM Text 2           ;Text250        }
  }
  KEYS
  {
    {    ;Time Sheet No.,Time Sheet Line No.,Date ;Clustered=Yes }
    {    ;Type,Job No.,Job Task No.,Status,Posted ;SumIndexFields=Quantity }
    {    ;CM Is CMMS Timesheet,Time Sheet No.,Time Sheet Line No. }
    {    ;CM Is CMMS Timesheet,CM User ID,CM Entry Date }
    {    ;CM Is CMMS Timesheet,CM Reverse Line No. }
    {    ;CM Is CMMS Timesheet,CM Workorder No.    }
    {    ;CM Is CMMS Timesheet,CM Task No.         }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;CM Entry Date,CM Description,CM Quantity,CM Text 1,CM Dimension Value 3,CM Text 2 }
  }
  CODE
  {
    VAR
      TimeSheetMgt@1001 : Codeunit 950;
      CMTTMgt@1000000000 : Codeunit 70040;

    PROCEDURE CopyFromTimeSheetLine@2(TimeSheetLine@1000 : Record 951);
    BEGIN
      "Time Sheet No." := TimeSheetLine."Time Sheet No.";
      "Time Sheet Line No." := TimeSheetLine."Line No.";
      Type := TimeSheetLine.Type;
      "Job No." := TimeSheetLine."Job No.";
      "Job Task No." := TimeSheetLine."Job Task No.";
      "Cause of Absence Code" := TimeSheetLine."Cause of Absence Code";
      "Service Order No." := TimeSheetLine."Service Order No.";
      "Service Order Line No." := TimeSheetLine."Service Order Line No.";
      "Assembly Order No." := TimeSheetLine."Assembly Order No.";
      "Assembly Order Line No." := TimeSheetLine."Assembly Order Line No.";
      Status := TimeSheetLine.Status;
    END;

    PROCEDURE GetMaxQtyToPost@3() : Decimal;
    BEGIN
      EXIT(Quantity - "Posted Quantity");
    END;

    BEGIN
    {
      ENC 20160923  Added CM* Fields
                    Added Global VAR CMTTMgt
                    Added Code in OnInsert(), OnDelete(), OnModify()
                    Added Key "CM Is CMMS Timesheet,Time Sheet No.,Time Sheet Line No."
                    Added Key "CM Is CMMS Timesheet,CM Posted By User ID,CM Date"
                    Added Field Group "Brick"
    }
    END.
  }
}

OBJECT Table 1511 Notification Entry
{
  OBJECT-PROPERTIES
  {
    Date=04.05.18;
    Time=12:30:50;
    Modified=Yes;
    Version List=NAVW19.00,CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               "Created Date-Time" := ROUNDDATETIME(CURRENTDATETIME,60000);
               "Created By" := USERID;
             END;

    CaptionML=[ENU=Notification Entry;
               DEA=Benachrichtigung];
  }
  FIELDS
  {
    { 1   ;   ;ID                  ;Integer       ;AutoIncrement=Yes;
                                                   CaptionML=[ENU=ID;
                                                              DEA=ID] }
    { 3   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              DEA=Art];
                                                   OptionCaptionML=[ENU=New Record,Approval,Overdue;
                                                                    DEA=Neuer Datensatz,Genehmigung,šberf„llig];
                                                   OptionString=New Record,Approval,Overdue }
    { 4   ;   ;Recipient User ID   ;Code50        ;CaptionML=[ENU=Recipient User ID;
                                                              DEA=Benutzer-ID des Empf„ngers] }
    { 5   ;   ;Triggered By Record ;RecordID      ;CaptionML=[ENU=Triggered By Record;
                                                              DEA=Ausgel”st von Datensatz];
                                                   Description=CM }
    { 6   ;   ;Link Target Page    ;Integer       ;TableRelation="Page Metadata".ID;
                                                   CaptionML=[ENU=Link Target Page;
                                                              DEA=Link zur Zielseite] }
    { 7   ;   ;Custom Link         ;Text250       ;ExtendedDatatype=URL;
                                                   CaptionML=[ENU=Custom Link;
                                                              DEA=Benutzerdefinierter Link] }
    { 8   ;   ;Error Message       ;Text250       ;CaptionML=[ENU=Error Message;
                                                              DEA=Fehlermeldung];
                                                   Editable=No }
    { 9   ;   ;Created Date-Time   ;DateTime      ;CaptionML=[ENU=Created Date-Time;
                                                              DEA=Datum/Uhrzeit der Erstellung];
                                                   Description=CM;
                                                   Editable=No }
    { 10  ;   ;Created By          ;Code50        ;TableRelation=User."User Name";
                                                   CaptionML=[ENU=Created By;
                                                              DEA=Erstellt von];
                                                   Description=CM;
                                                   Editable=No }
    { 50000;  ;CM Type             ;Option        ;OptionString=[ ,New Workorder assigned to me,Workorder assigned to me,My Workorder - status changed,My Workorder - new Task,Task assigend to me,My Task - status changed] }
    { 50010;  ;CM Type Text        ;Text30         }
    { 50100;  ;CM To Connector     ;Option        ;OptionString=[ ,Email,Skype] }
    { 50110;  ;CM To Connector Text;Text30         }
    { 50120;  ;CM To UserID        ;Code50         }
    { 50130;  ;CM To Connector ID  ;Text80         }
    { 60000;  ;CM Key Data 1       ;Text20         }
    { 60010;  ;CM Key Data 2       ;Text20         }
    { 60020;  ;CM Key Data 3       ;Text20         }
    { 61000;  ;CM Data Short 1     ;Text20         }
    { 61001;  ;CM Data Short 2     ;Text20         }
    { 61002;  ;CM Data Short 3     ;Text20         }
    { 61003;  ;CM Data Short 4     ;Text20         }
    { 61004;  ;CM Data Short 5     ;Text20         }
    { 61005;  ;CM Data Short 6     ;Text20         }
    { 61006;  ;CM Data Short 7     ;Text20         }
    { 62000;  ;CM Data Medium 1    ;Text80         }
    { 62001;  ;CM Data Medium 2    ;Text80         }
    { 62002;  ;CM Data Medium 3    ;Text80         }
    { 62003;  ;CM Data Medium 4    ;Text80         }
    { 62004;  ;CM Data Medium 5    ;Text80         }
    { 62005;  ;CM Data Medium 6    ;Text80         }
    { 62006;  ;CM Data Medium 7    ;Text80         }
    { 62007;  ;CM Data Medium 8    ;Text80         }
    { 62008;  ;CM Data Medium 9    ;Text80         }
    { 62009;  ;CM Data Medium 10   ;Text80         }
    { 63000;  ;CM Data Long 1      ;Text250        }
    { 63001;  ;CM Data Long 2      ;Text250        }
    { 63002;  ;CM Data Long 3      ;Text250        }
    { 70000;  ;CM NAV Link 1       ;Text250        }
    { 70001;  ;CM NAV Link 2       ;Text250        }
    { 80000;  ;CM Subject 1        ;Text250        }
    { 80001;  ;CM Subject 2        ;Text250        }
  }
  KEYS
  {
    {    ;ID                                      ;Clustered=Yes }
    {    ;Created Date-Time                        }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      DataTypeManagement@1000 : Codeunit 701;

    PROCEDURE CreateNew@1(NewType@1003 : 'New Record,Approval,Overdue';NewUserID@1002 : Code[50];NewRecord@1000 : Variant;NewLinkTargetPage@1004 : Integer;NewCustomLink@1005 : Text[250]);
    VAR
      NewRecRef@1001 : RecordRef;
    BEGIN
      IF NOT DataTypeManagement.GetRecordRef(NewRecord,NewRecRef) THEN
        EXIT;
      CLEAR(Rec);
      Type := NewType;
      "Recipient User ID" := NewUserID;
      "Triggered By Record" := NewRecRef.RECORDID;
      "Link Target Page" := NewLinkTargetPage;
      "Custom Link" := NewCustomLink;

      INSERT(TRUE);
    END;

    BEGIN
    END.
  }
}

OBJECT Table 5050 Contact
{
  OBJECT-PROPERTIES
  {
    Date=10.03.17;
    Time=10:54:08;
    Modified=Yes;
    Version List=NAVW19.00.00.46621,CMMS;
  }
  PROPERTIES
  {
    Permissions=TableData 36=rm,
                TableData 5065=r,
                TableData 5093=rm;
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               RMSetup.GET;

               IF "No." = '' THEN BEGIN
                 RMSetup.TESTFIELD("Contact Nos.");
                 NoSeriesMgt.InitSeries(RMSetup."Contact Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;

               IF NOT SkipDefaults THEN BEGIN
                 IF "Salesperson Code" = '' THEN
                   "Salesperson Code" := RMSetup."Default Salesperson Code";
                 IF "Territory Code" = '' THEN
                   "Territory Code" := RMSetup."Default Territory Code";
                 IF "Country/Region Code" = '' THEN
                   "Country/Region Code" := RMSetup."Default Country/Region Code";
                 IF "Language Code" = '' THEN
                   "Language Code" := RMSetup."Default Language Code";
                 IF "Correspondence Type" = "Correspondence Type"::" " THEN
                   "Correspondence Type" := RMSetup."Default Correspondence Type";
                 IF "Salutation Code" = '' THEN
                   IF Type = Type::Company THEN
                     "Salutation Code" := RMSetup."Def. Company Salutation Code"
                   ELSE
                     "Salutation Code" := RMSetup."Default Person Salutation Code";
               END;

               TypeChange;

               "Last Date Modified" := TODAY;
               "Last Time Modified" := TIME;
             END;

    OnModify=BEGIN
               OnModify(xRec);
             END;

    OnDelete=VAR
               Todo@1000 : Record 5080;
               SegLine@1001 : Record 5077;
               ContIndustGrp@1002 : Record 5058;
               ContactWebSource@1003 : Record 5060;
               ContJobResp@1004 : Record 5067;
               ContMailingGrp@1005 : Record 5056;
               ContProfileAnswer@1006 : Record 5089;
               RMCommentLine@1007 : Record 5061;
               ContAltAddr@1008 : Record 5051;
               ContAltAddrDateRange@1009 : Record 5052;
               InteractLogEntry@1010 : Record 5065;
               Opp@1011 : Record 5092;
               DOPaymentCreditCard@1017 : Record 827;
               CampaignTargetGrMgt@1016 : Codeunit 7030;
               VATRegistrationLogMgt@1012 : Codeunit 249;
             BEGIN
               DOPaymentCreditCard.DeleteByContact(Rec);

               Todo.SETCURRENTKEY("Contact Company No.","Contact No.",Closed,Date);
               Todo.SETRANGE("Contact Company No.","Company No.");
               Todo.SETRANGE("Contact No.","No.");
               Todo.SETRANGE(Closed,FALSE);
               IF Todo.FIND('-') THEN
                 ERROR(Text000,TABLECAPTION,"No.");

               SegLine.SETCURRENTKEY("Contact No.");
               SegLine.SETRANGE("Contact No.","No.");
               IF SegLine.FINDFIRST THEN
                 ERROR(Text001,TABLECAPTION,"No.");

               Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
               Opp.SETRANGE("Contact Company No.","Company No.");
               Opp.SETRANGE("Contact No.","No.");
               Opp.SETRANGE(Status,Opp.Status::"Not Started",Opp.Status::"In Progress");
               IF Opp.FIND('-') THEN
                 ERROR(Text002,TABLECAPTION,"No.");

               CASE Type OF
                 Type::Company:
                   BEGIN
                     ContBusRel.SETRANGE("Contact No.","No.");
                     ContBusRel.DELETEALL;
                     ContIndustGrp.SETRANGE("Contact No.","No.");
                     ContIndustGrp.DELETEALL;
                     ContactWebSource.SETRANGE("Contact No.","No.");
                     ContactWebSource.DELETEALL;
                     DuplMgt.RemoveContIndex(Rec,FALSE);
                     InteractLogEntry.SETCURRENTKEY("Contact Company No.");
                     InteractLogEntry.SETRANGE("Contact Company No.","No.");
                     IF InteractLogEntry.FIND('-') THEN
                       REPEAT
                         CampaignTargetGrMgt.DeleteContfromTargetGr(InteractLogEntry);
                         CLEAR(InteractLogEntry."Contact Company No.");
                         CLEAR(InteractLogEntry."Contact No.");
                         InteractLogEntry.MODIFY;
                       UNTIL InteractLogEntry.NEXT = 0;

                     Cont.RESET;
                     Cont.SETCURRENTKEY("Company No.");
                     Cont.SETRANGE("Company No.","No.");
                     Cont.SETRANGE(Type,Type::Person);
                     IF Cont.FIND('-') THEN
                       REPEAT
                         Cont.DELETE(TRUE);
                       UNTIL Cont.NEXT = 0;

                     Opp.RESET;
                     Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                     Opp.SETRANGE("Contact Company No.","Company No.");
                     Opp.SETRANGE("Contact No.","No.");
                     IF Opp.FIND('-') THEN
                       REPEAT
                         CLEAR(Opp."Contact No.");
                         CLEAR(Opp."Contact Company No.");
                         Opp.MODIFY;
                       UNTIL Opp.NEXT = 0;

                     Todo.RESET;
                     Todo.SETCURRENTKEY("Contact Company No.");
                     Todo.SETRANGE("Contact Company No.","Company No.");
                     IF Todo.FIND('-') THEN
                       REPEAT
                         CLEAR(Todo."Contact No.");
                         CLEAR(Todo."Contact Company No.");
                         Todo.MODIFY;
                       UNTIL Todo.NEXT = 0;
                   END;
                 Type::Person:
                   BEGIN
                     ContJobResp.SETRANGE("Contact No.","No.");
                     ContJobResp.DELETEALL;

                     InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                     InteractLogEntry.SETRANGE("Contact Company No.","Company No.");
                     InteractLogEntry.SETRANGE("Contact No.","No.");
                     InteractLogEntry.MODIFYALL("Contact No.","Company No.");

                     Opp.RESET;
                     Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                     Opp.SETRANGE("Contact Company No.","Company No.");
                     Opp.SETRANGE("Contact No.","No.");
                     Opp.MODIFYALL("Contact No.","Company No.");

                     Todo.RESET;
                     Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
                     Todo.SETRANGE("Contact Company No.","Company No.");
                     Todo.SETRANGE("Contact No.","No.");
                     Todo.MODIFYALL("Contact No.","Company No.");
                   END;
               END;

               ContMailingGrp.SETRANGE("Contact No.","No.");
               ContMailingGrp.DELETEALL;

               ContProfileAnswer.SETRANGE("Contact No.","No.");
               ContProfileAnswer.DELETEALL;

               RMCommentLine.SETRANGE("Table Name",RMCommentLine."Table Name"::Contact);
               RMCommentLine.SETRANGE("No.","No.");
               RMCommentLine.SETRANGE("Sub No.",0);
               RMCommentLine.DELETEALL;

               ContAltAddr.SETRANGE("Contact No.","No.");
               ContAltAddr.DELETEALL;

               ContAltAddrDateRange.SETRANGE("Contact No.","No.");
               ContAltAddrDateRange.DELETEALL;

               VATRegistrationLogMgt.DeleteContactLog(Rec);
             END;

    OnRename=BEGIN
               VALIDATE("Lookup Contact No.");
             END;

    CaptionML=[ENU=Contact;
               DEA=Kontakt];
    LookupPageID=Page5052;
    DrillDownPageID=Page5052;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  RMSetup.GET;
                                                                  NoSeriesMgt.TestManual(RMSetup."Contact Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   AltSearchField=Search Name;
                                                   CaptionML=[ENU=No.;
                                                              DEA=Nr.] }
    { 2   ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                NameBreakdown;
                                                                ProcessNameChange;
                                                              END;

                                                   CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 3   ;   ;Search Name         ;Code50        ;CaptionML=[ENU=Search Name;
                                                              DEA=Suchbegriff] }
    { 4   ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              DEA=Name 2] }
    { 5   ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              DEA=Adresse] }
    { 6   ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              DEA=Adresse 2] }
    { 7   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              DEA=Ort] }
    { 9   ;   ;Phone No.           ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              DEA=Telefonnr.] }
    { 10  ;   ;Telex No.           ;Text20        ;CaptionML=[ENU=Telex No.;
                                                              DEA=Telexnr.] }
    { 15  ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=[ENU=Territory Code;
                                                              DEA=Gebietscode] }
    { 22  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              DEA=W„hrungscode] }
    { 24  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[ENU=Language Code;
                                                              DEA=Sprachcode] }
    { 29  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Salesperson Code;
                                                              DEA=Verk„ufercode] }
    { 35  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              DEA=L„nder-/Regionscode] }
    { 38  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Rlshp. Mgt. Comment Line" WHERE (Table Name=CONST(Contact),
                                                                                                       No.=FIELD(No.),
                                                                                                       Sub No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung];
                                                   Editable=No }
    { 54  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              DEA=Korrigiert am];
                                                   Editable=No }
    { 84  ;   ;Fax No.             ;Text30        ;CaptionML=[ENU=Fax No.;
                                                              DEA=Faxnr.] }
    { 85  ;   ;Telex Answer Back   ;Text20        ;CaptionML=[ENU=Telex Answer Back;
                                                              DEA=Telex Namengeber] }
    { 86  ;   ;VAT Registration No.;Text20        ;OnValidate=VAR
                                                                VATRegNoFormat@1000 : Record 381;
                                                                VATRegistrationLogMgt@1001 : Codeunit 249;
                                                              BEGIN
                                                                IF VATRegNoFormat.Test("VAT Registration No.","Country/Region Code","No.",DATABASE::Contact) THEN
                                                                  IF "VAT Registration No." <> xRec."VAT Registration No." THEN
                                                                    VATRegistrationLogMgt.LogContact(Rec);
                                                              END;

                                                   CaptionML=[ENU=VAT Registration No.;
                                                              DEA=USt-IdNr.] }
    { 89  ;   ;Picture             ;BLOB          ;CaptionML=[ENU=Picture;
                                                              DEA=Bild];
                                                   SubType=Bitmap }
    { 91  ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              DEA=PLZ-Code] }
    { 92  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              DEA=Bundesregion] }
    { 102 ;   ;E-Mail              ;Text80        ;OnValidate=BEGIN
                                                                IF ("Search E-Mail" = UPPERCASE(xRec."E-Mail")) OR ("Search E-Mail" = '') THEN
                                                                  "Search E-Mail" := "E-Mail";
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail;
                                                              DEA=E-Mail] }
    { 103 ;   ;Home Page           ;Text80        ;ExtendedDatatype=URL;
                                                   CaptionML=[ENU=Home Page;
                                                              DEA=Homepage] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              DEA=Nummernserie] }
    { 5050;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                IF (CurrFieldNo <> 0) AND ("No." <> '') THEN BEGIN
                                                                  TypeChange;
                                                                  MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              DEA=Art];
                                                   OptionCaptionML=[ENU=Company,Person;
                                                                    DEA=Unternehmen,Person];
                                                   OptionString=Company,Person }
    { 5051;   ;Company No.         ;Code20        ;TableRelation=Contact WHERE (Type=CONST(Company));
                                                   OnValidate=VAR
                                                                Opp@1000 : Record 5092;
                                                                OppEntry@1001 : Record 5093;
                                                                Todo@1002 : Record 5080;
                                                                InteractLogEntry@1003 : Record 5065;
                                                                SegLine@1005 : Record 5077;
                                                                SalesHeader@1004 : Record 36;
                                                                OriginalEmail@1006 : Text[80];
                                                              BEGIN
                                                                IF "Company No." = xRec."Company No." THEN
                                                                  EXIT;

                                                                OriginalEmail := "E-Mail";

                                                                TESTFIELD(Type,Type::Person);

                                                                SegLine.SETCURRENTKEY("Contact No.");
                                                                SegLine.SETRANGE("Contact No.","No.");
                                                                IF SegLine.FINDFIRST THEN
                                                                  ERROR(Text012,FIELDCAPTION("Company No."));

                                                                IF Cont.GET("Company No.") THEN
                                                                  InheritCompanyToPersonData(Cont,xRec."Company No." = '')
                                                                ELSE
                                                                  CLEAR("Company Name");

                                                                IF Cont.GET("No.") THEN BEGIN
                                                                  IF xRec."Company No." <> '' THEN BEGIN
                                                                    Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Opp.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    Opp.SETRANGE("Contact No.","No.");
                                                                    Opp.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    OppEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    OppEntry.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    OppEntry.SETRANGE("Contact No.","No.");
                                                                    OppEntry.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Todo.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    Todo.SETRANGE("Contact No.","No.");
                                                                    Todo.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    InteractLogEntry.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    InteractLogEntry.SETRANGE("Contact No.","No.");
                                                                    InteractLogEntry.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    ContBusRel.RESET;
                                                                    ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                                    ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
                                                                    ContBusRel.SETRANGE("Contact No.",xRec."Company No.");
                                                                    SalesHeader.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
                                                                    SalesHeader.SETRANGE("Sell-to Contact No.","No.");
                                                                    IF ContBusRel.FINDFIRST THEN
                                                                      SalesHeader.SETRANGE("Sell-to Customer No.",ContBusRel."No.")
                                                                    ELSE
                                                                      SalesHeader.SETRANGE("Sell-to Customer No.",'');
                                                                    IF SalesHeader.FIND('-') THEN
                                                                      REPEAT
                                                                        SalesHeader."Sell-to Contact No." := xRec."Company No.";
                                                                        IF SalesHeader."Sell-to Contact No." = SalesHeader."Bill-to Contact No." THEN
                                                                          SalesHeader."Bill-to Contact No." := xRec."Company No.";
                                                                        SalesHeader.MODIFY;
                                                                      UNTIL SalesHeader.NEXT = 0;
                                                                    SalesHeader.RESET;
                                                                    SalesHeader.SETCURRENTKEY("Bill-to Contact No.");
                                                                    SalesHeader.SETRANGE("Bill-to Contact No.","No.");
                                                                    SalesHeader.MODIFYALL("Bill-to Contact No.",xRec."Company No.");
                                                                  END ELSE BEGIN
                                                                    Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Opp.SETRANGE("Contact Company No.",'');
                                                                    Opp.SETRANGE("Contact No.","No.");
                                                                    Opp.MODIFYALL("Contact Company No.","Company No.");
                                                                    OppEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    OppEntry.SETRANGE("Contact Company No.",'');
                                                                    OppEntry.SETRANGE("Contact No.","No.");
                                                                    OppEntry.MODIFYALL("Contact Company No.","Company No.");
                                                                    Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Todo.SETRANGE("Contact Company No.",'');
                                                                    Todo.SETRANGE("Contact No.","No.");
                                                                    Todo.MODIFYALL("Contact Company No.","Company No.");
                                                                    InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    InteractLogEntry.SETRANGE("Contact Company No.",'');
                                                                    InteractLogEntry.SETRANGE("Contact No.","No.");
                                                                    InteractLogEntry.MODIFYALL("Contact Company No.","Company No.");
                                                                  END;
                                                                  IF OriginalEmail <> '' THEN
                                                                    "E-Mail" := OriginalEmail;
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Company No.;
                                                              DEA=Unternehmensnr.] }
    { 5052;   ;Company Name        ;Text50        ;CaptionML=[ENU=Company Name;
                                                              DEA=Unternehmensname];
                                                   Editable=No }
    { 5053;   ;Lookup Contact No.  ;Code20        ;TableRelation=Contact;
                                                   OnValidate=BEGIN
                                                                IF Type = Type::Company THEN
                                                                  "Lookup Contact No." := ''
                                                                ELSE
                                                                  "Lookup Contact No." := "No.";
                                                              END;

                                                   CaptionML=[ENU=Lookup Contact No.;
                                                              DEA=Look-up Kontaktnr.];
                                                   Editable=No }
    { 5054;   ;First Name          ;Text30        ;OnValidate=BEGIN
                                                                Name := CalculatedName;
                                                                ProcessNameChange;
                                                              END;

                                                   CaptionML=[ENU=First Name;
                                                              DEA=Vorname] }
    { 5055;   ;Middle Name         ;Text30        ;OnValidate=BEGIN
                                                                Name := CalculatedName;
                                                                ProcessNameChange;
                                                              END;

                                                   CaptionML=[ENU=Middle Name;
                                                              DEA=Vorname 2] }
    { 5056;   ;Surname             ;Text30        ;OnValidate=BEGIN
                                                                Name := CalculatedName;
                                                                ProcessNameChange;
                                                              END;

                                                   CaptionML=[ENU=Surname;
                                                              DEA=Nachname] }
    { 5058;   ;Job Title           ;Text30        ;CaptionML=[ENU=Job Title;
                                                              DEA=Titel] }
    { 5059;   ;Initials            ;Text30        ;CaptionML=[ENU=Initials;
                                                              DEA=Initialen] }
    { 5060;   ;Extension No.       ;Text30        ;CaptionML=[ENU=Extension No.;
                                                              DEA=Durchwahl] }
    { 5061;   ;Mobile Phone No.    ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Mobile Phone No.;
                                                              DEA=Mobiltelefonnr.] }
    { 5062;   ;Pager               ;Text30        ;CaptionML=[ENU=Pager;
                                                              DEA=Pager] }
    { 5063;   ;Organizational Level Code;Code10   ;TableRelation="Organizational Level";
                                                   CaptionML=[ENU=Organizational Level Code;
                                                              DEA=Positionscode] }
    { 5064;   ;Exclude from Segment;Boolean       ;CaptionML=[ENU=Exclude from Segment;
                                                              DEA=Nicht segmentieren] }
    { 5065;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              DEA=Datumsfilter] }
    { 5066;   ;Next To-do Date     ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Min(To-do.Date WHERE (Contact Company No.=FIELD(Company No.),
                                                                                     Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                     Closed=CONST(No),
                                                                                     System To-do Type=CONST(Contact Attendee)));
                                                   CaptionML=[ENU=Next To-do Date;
                                                              DEA=N„chste Aufgabe am];
                                                   Editable=No }
    { 5067;   ;Last Date Attempted ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Max("Interaction Log Entry".Date WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                       Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                       Initiated By=CONST(Us),
                                                                                                       Postponed=CONST(No)));
                                                   CaptionML=[ENU=Last Date Attempted;
                                                              DEA=Letzte Kontaktaufnahme am];
                                                   Editable=No }
    { 5068;   ;Date of Last Interaction;Date      ;FieldClass=FlowField;
                                                   CalcFormula=Max("Interaction Log Entry".Date WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                       Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                       Attempt Failed=CONST(No),
                                                                                                       Postponed=CONST(No)));
                                                   CaptionML=[ENU=Date of Last Interaction;
                                                              DEA=Letzte Aktivit„t am];
                                                   Editable=No }
    { 5069;   ;No. of Job Responsibilities;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Job Responsibility" WHERE (Contact No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Job Responsibilities;
                                                              DEA=Anzahl Verantwortlichkeiten];
                                                   Editable=No }
    { 5070;   ;No. of Industry Groups;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Industry Group" WHERE (Contact No.=FIELD(Company No.)));
                                                   CaptionML=[ENU=No. of Industry Groups;
                                                              DEA=Anzahl Branchen];
                                                   Editable=No }
    { 5071;   ;No. of Business Relations;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Business Relation" WHERE (Contact No.=FIELD(Company No.)));
                                                   CaptionML=[ENU=No. of Business Relations;
                                                              DEA=Anzahl Gesch„ftsbeziehungen];
                                                   Editable=No }
    { 5072;   ;No. of Mailing Groups;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Mailing Group" WHERE (Contact No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Mailing Groups;
                                                              DEA=Anzahl Verteiler];
                                                   Editable=No }
    { 5073;   ;External ID         ;Code20        ;CaptionML=[ENU=External ID;
                                                              DEA=Externe ID] }
    { 5074;   ;No. of Interactions ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (Contact Company No.=FIELD(FILTER(Company No.)),
                                                                                                    Canceled=CONST(No),
                                                                                                    Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                    Date=FIELD(Date Filter),
                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=No. of Interactions;
                                                              DEA=Anzahl Aktivit„ten];
                                                   Editable=No }
    { 5076;   ;Cost (LCY)          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Cost (LCY)" WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                               Canceled=CONST(No),
                                                                                                               Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                               Date=FIELD(Date Filter),
                                                                                                               Postponed=CONST(No)));
                                                   CaptionML=[ENU=Cost (LCY);
                                                              DEA=Einstandsbetrag (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5077;   ;Duration (Min.)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Duration (Min.)" WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                                    Canceled=CONST(No),
                                                                                                                    Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                                    Date=FIELD(Date Filter),
                                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=Duration (Min.);
                                                              DEA=Dauer (Min.)];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 5078;   ;No. of Opportunities;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Opportunity Entry" WHERE (Active=CONST(Yes),
                                                                                                Contact Company No.=FIELD(Company No.),
                                                                                                Estimated Close Date=FIELD(Date Filter),
                                                                                                Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                Action Taken=FIELD(Action Taken Filter)));
                                                   CaptionML=[ENU=No. of Opportunities;
                                                              DEA=Anzahl Verkaufschancen];
                                                   Editable=No }
    { 5079;   ;Estimated Value (LCY);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Estimated Value (LCY)" WHERE (Active=CONST(Yes),
                                                                                                                      Contact Company No.=FIELD(Company No.),
                                                                                                                      Estimated Close Date=FIELD(Date Filter),
                                                                                                                      Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                                      Action Taken=FIELD(Action Taken Filter)));
                                                   CaptionML=[ENU=Estimated Value (LCY);
                                                              DEA=Erwarteter Wert (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5080;   ;Calcd. Current Value (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Calcd. Current Value (LCY)" WHERE (Active=CONST(Yes),
                                                                                                                           Contact Company No.=FIELD(Company No.),
                                                                                                                           Estimated Close Date=FIELD(Date Filter),
                                                                                                                           Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                                           Action Taken=FIELD(Action Taken Filter)));
                                                   CaptionML=[ENU=Calcd. Current Value (LCY);
                                                              DEA=Berech. aktueller Wert (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5082;   ;Opportunity Entry Exists;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Opportunity Entry" WHERE (Active=CONST(Yes),
                                                                                                Contact Company No.=FIELD(Company No.),
                                                                                                Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                Sales Cycle Code=FIELD(Sales Cycle Filter),
                                                                                                Sales Cycle Stage=FIELD(Sales Cycle Stage Filter),
                                                                                                Salesperson Code=FIELD(Salesperson Filter),
                                                                                                Campaign No.=FIELD(Campaign Filter),
                                                                                                Action Taken=FIELD(Action Taken Filter),
                                                                                                Estimated Value (LCY)=FIELD(Estimated Value Filter),
                                                                                                Calcd. Current Value (LCY)=FIELD(Calcd. Current Value Filter),
                                                                                                Completed %=FIELD(Completed % Filter),
                                                                                                Chances of Success %=FIELD(Chances of Success % Filter),
                                                                                                Probability %=FIELD(Probability % Filter),
                                                                                                Estimated Close Date=FIELD(Date Filter),
                                                                                                Close Opportunity Code=FIELD(Close Opportunity Filter)));
                                                   CaptionML=[ENU=Opportunity Entry Exists;
                                                              DEA=Verkaufschancenposten vorh.];
                                                   Editable=No }
    { 5083;   ;To-do Entry Exists  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (Contact Company No.=FIELD(Company No.),
                                                                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                  Team Code=FIELD(Team Filter),
                                                                                  Salesperson Code=FIELD(Salesperson Filter),
                                                                                  Campaign No.=FIELD(Campaign Filter),
                                                                                  Date=FIELD(Date Filter),
                                                                                  Status=FIELD(To-do Status Filter),
                                                                                  Priority=FIELD(Priority Filter),
                                                                                  Closed=FIELD(To-do Closed Filter)));
                                                   CaptionML=[ENU=To-do Entry Exists;
                                                              DEA=Aufgabenposten vorhanden];
                                                   Editable=No }
    { 5084;   ;Salesperson Filter  ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Salesperson Filter;
                                                              DEA=Verk„uferfilter] }
    { 5085;   ;Campaign Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Campaign;
                                                   CaptionML=[ENU=Campaign Filter;
                                                              DEA=Kampagnenfilter] }
    { 5087;   ;Action Taken Filter ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Action Taken Filter;
                                                              DEA=Kriterienaktionsfilter];
                                                   OptionCaptionML=[ENU=" ,Next,Previous,Updated,Jumped,Won,Lost";
                                                                    DEA=" ,N„chster Schritt,Vorheriger Schritt,Aktualisiert,šbersprungen,Gewonnen,Verloren"];
                                                   OptionString=[ ,Next,Previous,Updated,Jumped,Won,Lost] }
    { 5088;   ;Sales Cycle Filter  ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Sales Cycle";
                                                   CaptionML=[ENU=Sales Cycle Filter;
                                                              DEA=Verkaufsprozessfilter] }
    { 5089;   ;Sales Cycle Stage Filter;Integer   ;FieldClass=FlowFilter;
                                                   TableRelation="Sales Cycle Stage".Stage WHERE (Sales Cycle Code=FIELD(Sales Cycle Filter));
                                                   CaptionML=[ENU=Sales Cycle Stage Filter;
                                                              DEA=Verkaufsprozess-Stufenfilter] }
    { 5090;   ;Probability % Filter;Decimal       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Probability % Filter;
                                                              DEA=Wahrscheinlichkeit % Filter];
                                                   DecimalPlaces=1:1;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 5091;   ;Completed % Filter  ;Decimal       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Completed % Filter;
                                                              DEA=Abgeschlossen % Filter];
                                                   DecimalPlaces=1:1;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 5092;   ;Estimated Value Filter;Decimal     ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Estimated Value Filter;
                                                              DEA=Erwarteter Wert Filter];
                                                   AutoFormatType=1 }
    { 5093;   ;Calcd. Current Value Filter;Decimal;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Calcd. Current Value Filter;
                                                              DEA=Berech. aktueller Wert Filter];
                                                   AutoFormatType=1 }
    { 5094;   ;Chances of Success % Filter;Decimal;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Chances of Success % Filter;
                                                              DEA=Erfolgschancen % Filter];
                                                   DecimalPlaces=0:0;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 5095;   ;To-do Status Filter ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=To-do Status Filter;
                                                              DEA=Aufgabenstatusfilter];
                                                   OptionCaptionML=[ENU=Not Started,In Progress,Completed,Waiting,Postponed;
                                                                    DEA=Nicht begonnen,In Bearbeitung,Erledigt,Warten,Zurckgestellt];
                                                   OptionString=Not Started,In Progress,Completed,Waiting,Postponed }
    { 5096;   ;To-do Closed Filter ;Boolean       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=To-do Closed Filter;
                                                              DEA=Abgeschlossene Aufgaben Filter] }
    { 5097;   ;Priority Filter     ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Priority Filter;
                                                              DEA=Priorit„tenfilter];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High }
    { 5098;   ;Team Filter         ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Team;
                                                   CaptionML=[ENU=Team Filter;
                                                              DEA=Teamfilter] }
    { 5099;   ;Close Opportunity Filter;Code10    ;FieldClass=FlowFilter;
                                                   TableRelation="Close Opportunity Code";
                                                   CaptionML=[ENU=Close Opportunity Filter;
                                                              DEA=Verkaufschancenabschlussfilter] }
    { 5100;   ;Correspondence Type ;Option        ;CaptionML=[ENU=Correspondence Type;
                                                              DEA=Korrespondenzart];
                                                   OptionCaptionML=[ENU=" ,Hard Copy,E-Mail,Fax";
                                                                    DEA=" ,Brief,E-Mail,Fax"];
                                                   OptionString=[ ,Hard Copy,E-Mail,Fax] }
    { 5101;   ;Salutation Code     ;Code10        ;TableRelation=Salutation;
                                                   CaptionML=[ENU=Salutation Code;
                                                              DEA=Anredecode] }
    { 5102;   ;Search E-Mail       ;Code80        ;CaptionML=[ENU=Search E-Mail;
                                                              DEA=E-Mail-Suchbegriff] }
    { 5104;   ;Last Time Modified  ;Time          ;CaptionML=[ENU=Last Time Modified;
                                                              DEA=Korrigiert um] }
    { 5105;   ;E-Mail 2            ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail 2;
                                                              DEA=E-Mail 2] }
    { 50000;  ;CMMS Is CMMS Contact;Boolean        }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Company Name,Company No.,Type,Name       }
    {    ;Company No.                              }
    {    ;Territory Code                           }
    {    ;Salesperson Code                         }
    {    ;VAT Registration No.                     }
    {    ;Search E-Mail                            }
    {    ;Name                                     }
    {    ;City                                     }
    {    ;Post Code                                }
    {    ;Phone No.                                }
    {    ;CMMS Is CMMS Contact,No.                 }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name,Type,City,Post Code,Phone No.   }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot delete the %2 record of the %1 because there are one or more to-dos open.;DEA=Sie k”nnen %1 %2 nicht l”schen, da es eine oder mehrere offene Aufgaben gibt.';
      Text001@1001 : TextConst 'ENU=You cannot delete the %2 record of the %1 because the contact is assigned one or more unlogged segments.;DEA=Sie k”nnen %1 %2 nicht l”schen, da der Kontakt einem oder mehreren unprotokollierten Segmenten zugeordnet ist.';
      Text002@1002 : TextConst 'ENU=You cannot delete the %2 record of the %1 because one or more opportunities are in not started or progress.;DEA=Sie k”nnen %1 %2 nicht l”schen, da es eine oder mehrere Verkaufschancen gibt, die in Bearbeitung sind oder noch nicht begonnen wurden.';
      Text003@1003 : TextConst 'ENU=%1 cannot be changed because one or more interaction log entries are linked to the contact.;DEA=%1 kann nicht ge„ndert werden, da mindestens ein Aktivit„tenprotokollposten mit dem Kontakt verknpft ist.';
      Text005@1005 : TextConst 'ENU=%1 cannot be changed because one or more to-dos are linked to the contact.;DEA=%1 kann nicht ge„ndert werden, da mindestens eine Aufgabe mit dem Kontakt verknpft ist.';
      Text006@1006 : TextConst 'ENU=%1 cannot be changed because one or more opportunities are linked to the contact.;DEA=%1 kann nicht ge„ndert werden, da mindestens eine Verkaufschance mit dem Kontakt verknpft ist.';
      Text007@1007 : TextConst 'ENU=%1 cannot be changed because there are one or more related people linked to the contact.;DEA=%1 kann nicht ge„ndert werden, da es eine oder mehrere Personen gibt, die mit dem Kontakt verknpft sind.';
      Text009@1009 : TextConst 'ENU=The %2 record of the %1 has been created.;DEA=%1 %2 wurde erstellt.';
      Text010@1010 : TextConst 'ENU=The %2 record of the %1 is not linked with any other table.;DEA=%1 %2 ist nicht mit einer anderen Tabelle verknpft.';
      RMSetup@1012 : Record 5079;
      Cont@1013 : Record 5050;
      ContBusRel@1014 : Record 5054;
      PostCode@1011 : Record 225;
      DuplMgt@1015 : Codeunit 5060;
      NoSeriesMgt@1016 : Codeunit 396;
      UpdateCustVendBank@1017 : Codeunit 5055;
      CampaignMgt@1050 : Codeunit 7030;
      ContChanged@1018 : Boolean;
      SkipDefaults@1019 : Boolean;
      Text012@1020 : TextConst 'ENU=You cannot change %1 because one or more unlogged segments are assigned to the contact.;DEA=Sie k”nnen %1 nicht „ndern, da diesem Kontakt mindestens ein unprotokolliertes Segment zugeordnet ist.';
      Text019@1022 : TextConst 'ENU=The %2 record of the %1 already has the %3 with %4 %5.;DEA=%1 %2 hat bereits die %3 mit %4 %5.';
      Text020@1021 : TextConst 'ENU=Do you want to create a contact %1 %2 as a customer using a customer template?;DEA=M”chten Sie aus dem Kontakt %1 %2 einen Debitor unter Verwendung einer Debitorenvorlage erstellen?';
      Text021@1023 : TextConst 'ENU=You have to set up formal and informal salutation formulas in %1  language for the %2 contact.;DEA=Sie mssen formelle und informelle Anredeformeln in der Sprache %1 fr den Kontakt %2 einrichten.';
      HideValidationDialog@1032 : Boolean;
      Text022@1034 : TextConst 'ENU=The creation of the customer has been aborted.;DEA=Die Erstellung des Debitors wurde abgebrochen.';
      Text029@1045 : TextConst 'ENU=The total length of first name, middle name and surname is %1 character(s)longer than the maximum length allowed for the Name field.;DEA=Die Gesamtl„nge von Vorname, zweitem Vornamen und Nachnamen ist %1 Zeichen l„nger als die zul„ssige Maximall„nge fr das Namensfeld.';
      Text032@1048 : TextConst 'ENU=The length of %1 is %2 character(s)longer than the maximum length allowed for the %1 field.;DEA=Die L„nge von %1 ist um %2 Zeichen l„nger als die maximal zul„ssige L„nge des %1-Felds.';
      Text033@1008 : TextConst 'ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.;DEA=Bevor Sie Online Map verwenden k”nnen, mssen Sie die Felder des Fensters ''Online Map-Einrichtung'' ausfllen.\Informationen hierzu finden Sie in der Hilfe zum Einrichten von Online Map.';

    PROCEDURE OnModify@4(xRec@1005 : Record 5050);
    VAR
      OldCont@1001 : Record 5050;
    BEGIN
      "Last Date Modified" := TODAY;
      "Last Time Modified" := TIME;

      IF Type = Type::Company THEN BEGIN
        IF (Name <> xRec.Name) OR
           ("Search Name" <> xRec."Search Name") OR
           ("Name 2" <> xRec."Name 2") OR
           (Address <> xRec.Address) OR
           ("Address 2" <> xRec."Address 2") OR
           (City <> xRec.City) OR
           ("Phone No." <> xRec."Phone No.") OR
           ("Telex No." <> xRec."Telex No.") OR
           ("Territory Code" <> xRec."Territory Code") OR
           ("Currency Code" <> xRec."Currency Code") OR
           ("Language Code" <> xRec."Language Code") OR
           ("Salesperson Code" <> xRec."Salesperson Code") OR
           ("Country/Region Code" <> xRec."Country/Region Code") OR
           ("Fax No." <> xRec."Fax No.") OR
           ("Telex Answer Back" <> xRec."Telex Answer Back") OR
           ("VAT Registration No." <> xRec."VAT Registration No.") OR
           ("Post Code" <> xRec."Post Code") OR
           (County <> xRec.County) OR
           ("E-Mail" <> xRec."E-Mail") OR
           ("Home Page" <> xRec."Home Page")
        THEN
          UpdateCustVendBank.RUN(Rec);

        RMSetup.GET;
        Cont.RESET;
        Cont.SETCURRENTKEY("Company No.");
        Cont.SETRANGE("Company No.","No.");
        Cont.SETRANGE(Type,Type::Person);
        IF Cont.FIND('-') THEN
          REPEAT
            ContChanged := FALSE;
            OldCont := Cont;
            IF Name <> xRec.Name THEN BEGIN
              Cont."Company Name" := Name;
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Salesperson Code" AND
               (xRec."Salesperson Code" <> "Salesperson Code") AND
               (xRec."Salesperson Code" = Cont."Salesperson Code")
            THEN BEGIN
              Cont."Salesperson Code" := "Salesperson Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Territory Code" AND
               (xRec."Territory Code" <> "Territory Code") AND
               (xRec."Territory Code" = Cont."Territory Code")
            THEN BEGIN
              Cont."Territory Code" := "Territory Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Country/Region Code" AND
               (xRec."Country/Region Code" <> "Country/Region Code") AND
               (xRec."Country/Region Code" = Cont."Country/Region Code")
            THEN BEGIN
              Cont."Country/Region Code" := "Country/Region Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Language Code" AND
               (xRec."Language Code" <> "Language Code") AND
               (xRec."Language Code" = Cont."Language Code")
            THEN BEGIN
              Cont."Language Code" := "Language Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Address Details" THEN
              IF xRec.IdenticalAddress(Cont) THEN BEGIN
                IF xRec.Address <> Address THEN BEGIN
                  Cont.Address := Address;
                  ContChanged := TRUE;
                END;
                IF xRec."Address 2" <> "Address 2" THEN BEGIN
                  Cont."Address 2" := "Address 2";
                  ContChanged := TRUE;
                END;
                IF xRec."Post Code" <> "Post Code" THEN BEGIN
                  Cont."Post Code" := "Post Code";
                  ContChanged := TRUE;
                END;
                IF xRec.City <> City THEN BEGIN
                  Cont.City := City;
                  ContChanged := TRUE;
                END;
                IF xRec.County <> County THEN BEGIN
                  Cont.County := County;
                  ContChanged := TRUE;
                END;
              END;
            IF RMSetup."Inherit Communication Details" THEN BEGIN
              IF (xRec."Phone No." <> "Phone No.") AND (xRec."Phone No." = Cont."Phone No.") THEN BEGIN
                Cont."Phone No." := "Phone No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Telex No." <> "Telex No.") AND (xRec."Telex No." = Cont."Telex No.") THEN BEGIN
                Cont."Telex No." := "Telex No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Fax No." <> "Fax No.") AND (xRec."Fax No." = Cont."Fax No.") THEN BEGIN
                Cont."Fax No." := "Fax No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Telex Answer Back" <> "Telex Answer Back") AND (xRec."Telex Answer Back" = Cont."Telex Answer Back") THEN BEGIN
                Cont."Telex Answer Back" := "Telex Answer Back";
                ContChanged := TRUE;
              END;
              IF (xRec."E-Mail" <> "E-Mail") AND (xRec."E-Mail" = Cont."E-Mail") THEN BEGIN
                Cont.VALIDATE("E-Mail","E-Mail");
                ContChanged := TRUE;
              END;
              IF (xRec."Home Page" <> "Home Page") AND (xRec."Home Page" = Cont."Home Page") THEN BEGIN
                Cont."Home Page" := "Home Page";
                ContChanged := TRUE;
              END;
              IF (xRec."Extension No." <> "Extension No.") AND (xRec."Extension No." = Cont."Extension No.") THEN BEGIN
                Cont."Extension No." := "Extension No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Mobile Phone No." <> "Mobile Phone No.") AND (xRec."Mobile Phone No." = Cont."Mobile Phone No.") THEN BEGIN
                Cont."Mobile Phone No." := "Mobile Phone No.";
                ContChanged := TRUE;
              END;
              IF (xRec.Pager <> Pager) AND (xRec.Pager = Cont.Pager) THEN BEGIN
                Cont.Pager := Pager;
                ContChanged := TRUE;
              END;
            END;
            IF ContChanged THEN BEGIN
              Cont.OnModify(OldCont);
              Cont.MODIFY;
            END;
          UNTIL Cont.NEXT = 0;

        IF (Name <> xRec.Name) OR
           ("Name 2" <> xRec."Name 2") OR
           (Address <> xRec.Address) OR
           ("Address 2" <> xRec."Address 2") OR
           (City <> xRec.City) OR
           ("Post Code" <> xRec."Post Code") OR
           ("VAT Registration No." <> xRec."VAT Registration No.") OR
           ("Phone No." <> xRec."Phone No.")
        THEN
          CheckDupl;
      END;
    END;

    PROCEDURE TypeChange@1();
    VAR
      InteractLogEntry@1000 : Record 5065;
      Opp@1001 : Record 5092;
      Todo@1002 : Record 5080;
      CampaignTargetGrMgt@1003 : Codeunit 7030;
    BEGIN
      RMSetup.GET;

      InteractLogEntry.LOCKTABLE;
      Todo.LOCKTABLE;
      Opp.LOCKTABLE;
      Cont.LOCKTABLE;
      InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
      InteractLogEntry.SETRANGE("Contact Company No.","Company No.");
      InteractLogEntry.SETRANGE("Contact No.","No.");
      IF InteractLogEntry.FINDFIRST THEN
        ERROR(Text003,FIELDCAPTION(Type));
      Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
      Todo.SETRANGE("Contact Company No.","Company No.");
      Todo.SETRANGE("Contact No.","No.");
      IF Todo.FINDFIRST THEN
        ERROR(Text005,FIELDCAPTION(Type));
      Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
      Opp.SETRANGE("Contact Company No.","Company No.");
      Opp.SETRANGE("Contact No.","No.");
      IF Opp.FINDFIRST THEN
        ERROR(Text006,FIELDCAPTION(Type));

      CASE Type OF
        Type::Company:
          BEGIN
            IF Type <> xRec.Type THEN BEGIN
              TESTFIELD("Organizational Level Code",'');
              TESTFIELD("No. of Job Responsibilities",0);
            END;
            "First Name" := '';
            "Middle Name" := '';
            Surname := '';
            "Job Title" := '';
            "Company No." := "No.";
            "Company Name" := Name;
            "Salutation Code" := RMSetup."Def. Company Salutation Code";
          END;
        Type::Person:
          BEGIN
            CampaignTargetGrMgt.DeleteContfromTargetGr(InteractLogEntry);
            Cont.RESET;
            Cont.SETCURRENTKEY("Company No.");
            Cont.SETRANGE("Company No.","No.");
            Cont.SETRANGE(Type,Type::Person);
            IF Cont.FIND('-') THEN
              ERROR(Text007,FIELDCAPTION(Type));
            IF Type <> xRec.Type THEN BEGIN
              TESTFIELD("No. of Business Relations",0);
              TESTFIELD("No. of Industry Groups",0);
              TESTFIELD("Currency Code",'');
              TESTFIELD("VAT Registration No.",'');
            END;
            IF "Company No." = "No." THEN BEGIN
              "Company No." := '';
              "Company Name" := '';
              "Salutation Code" := RMSetup."Default Person Salutation Code";
              NameBreakdown;
            END;
          END;
      END;
      VALIDATE("Lookup Contact No.");

      IF Cont.GET("No.") THEN BEGIN
        IF Type = Type::Company THEN
          CheckDupl
        ELSE
          DuplMgt.RemoveContIndex(Rec,FALSE);
      END;
    END;

    PROCEDURE AssistEdit@2(OldCont@1000 : Record 5050) : Boolean;
    BEGIN
      WITH Cont DO BEGIN
        Cont := Rec;
        RMSetup.GET;
        RMSetup.TESTFIELD("Contact Nos.");
        IF NoSeriesMgt.SelectSeries(RMSetup."Contact Nos.",OldCont."No. Series","No. Series") THEN BEGIN
          RMSetup.GET;
          RMSetup.TESTFIELD("Contact Nos.");
          NoSeriesMgt.SetSeries("No.");
          Rec := Cont;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE CreateCustomer@3(CustomerTemplate@1006 : Code[10]);
    VAR
      Cust@1000 : Record 18;
      ContComp@1001 : Record 5050;
      CustTemplate@1003 : Record 5105;
      DefaultDim@1005 : Record 352;
      DefaultDim2@1004 : Record 352;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Customers");

      ContBusRel.RESET;
      ContBusRel.SETRANGE("Contact No.","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      IF ContBusRel.FINDFIRST THEN
        ERROR(
          Text019,
          TABLECAPTION,"No.",ContBusRel.TABLECAPTION,ContBusRel."Link to Table",ContBusRel."No.");

      IF CustomerTemplate <> '' THEN
        CustTemplate.GET(CustomerTemplate);

      CLEAR(Cust);
      Cust.SetInsertFromContact(TRUE);
      Cust.INSERT(TRUE);
      Cust.SetInsertFromContact(FALSE);

      IF Type = Type::Company THEN
        ContComp := Rec
      ELSE
        ContComp.GET("Company No.");

      ContBusRel."Contact No." := ContComp."No.";
      ContBusRel."Business Relation Code" := RMSetup."Bus. Rel. Code for Customers";
      ContBusRel."Link to Table" := ContBusRel."Link to Table"::Customer;
      ContBusRel."No." := Cust."No.";
      ContBusRel.INSERT(TRUE);

      UpdateCustVendBank.UpdateCustomer(ContComp,ContBusRel);

      Cust.GET(ContBusRel."No.");
      Cust.VALIDATE(Name,"Company Name");
      Cust.MODIFY;

      IF CustTemplate.Code <> '' THEN BEGIN
        Cust."Territory Code" := CustTemplate."Territory Code";
        Cust."Currency Code" := CustTemplate."Currency Code";
        Cust."Country/Region Code" := CustTemplate."Country/Region Code";
        Cust."Customer Posting Group" := CustTemplate."Customer Posting Group";
        Cust."Customer Price Group" := CustTemplate."Customer Price Group";
        IF CustTemplate."Invoice Disc. Code" <> '' THEN
          Cust."Invoice Disc. Code" := CustTemplate."Invoice Disc. Code";
        Cust."Customer Disc. Group" := CustTemplate."Customer Disc. Group";
        Cust."Allow Line Disc." := CustTemplate."Allow Line Disc.";
        Cust."Gen. Bus. Posting Group" := CustTemplate."Gen. Bus. Posting Group";
        Cust."VAT Bus. Posting Group" := CustTemplate."VAT Bus. Posting Group";
        Cust."Payment Terms Code" := CustTemplate."Payment Terms Code";
        Cust."Payment Method Code" := CustTemplate."Payment Method Code";
        Cust."Shipment Method Code" := CustTemplate."Shipment Method Code";
        Cust.MODIFY;

        DefaultDim.SETRANGE("Table ID",DATABASE::"Customer Template");
        DefaultDim.SETRANGE("No.",CustTemplate.Code);
        IF DefaultDim.FIND('-') THEN
          REPEAT
            CLEAR(DefaultDim2);
            DefaultDim2.INIT;
            DefaultDim2.VALIDATE("Table ID",DATABASE::Customer);
            DefaultDim2."No." := Cust."No.";
            DefaultDim2.VALIDATE("Dimension Code",DefaultDim."Dimension Code");
            DefaultDim2.VALIDATE("Dimension Value Code",DefaultDim."Dimension Value Code");
            DefaultDim2."Value Posting" := DefaultDim."Value Posting";
            DefaultDim2.INSERT(TRUE);
          UNTIL DefaultDim.NEXT = 0;
      END;

      UpdateQuotes(Cust);
      CampaignMgt.ConverttoCustomer(Rec,Cust);
      MESSAGE(Text009,Cust.TABLECAPTION,Cust."No.");
    END;

    PROCEDURE CreateVendor@7();
    VAR
      Vend@1000 : Record 23;
      ContComp@1001 : Record 5050;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Vendors");

      CLEAR(Vend);
      Vend.SetInsertFromContact(TRUE);
      Vend.INSERT(TRUE);
      Vend.SetInsertFromContact(FALSE);

      IF Type = Type::Company THEN
        ContComp := Rec
      ELSE
        ContComp.GET("Company No.");

      ContBusRel."Contact No." := ContComp."No.";
      ContBusRel."Business Relation Code" := RMSetup."Bus. Rel. Code for Vendors";
      ContBusRel."Link to Table" := ContBusRel."Link to Table"::Vendor;
      ContBusRel."No." := Vend."No.";
      ContBusRel.INSERT(TRUE);

      UpdateCustVendBank.UpdateVendor(ContComp,ContBusRel);

      MESSAGE(Text009,Vend.TABLECAPTION,Vend."No.");
    END;

    PROCEDURE CreateBankAccount@8();
    VAR
      BankAcc@1000 : Record 270;
      ContComp@1001 : Record 5050;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Bank Accs.");

      CLEAR(BankAcc);
      BankAcc.SetInsertFromContact(TRUE);
      BankAcc.INSERT(TRUE);
      BankAcc.SetInsertFromContact(FALSE);

      IF Type = Type::Company THEN
        ContComp := Rec
      ELSE
        ContComp.GET("Company No.");

      ContBusRel."Contact No." := ContComp."No.";
      ContBusRel."Business Relation Code" := RMSetup."Bus. Rel. Code for Bank Accs.";
      ContBusRel."Link to Table" := ContBusRel."Link to Table"::"Bank Account";
      ContBusRel."No." := BankAcc."No.";
      ContBusRel.INSERT(TRUE);

      UpdateCustVendBank.UpdateBankAccount(ContComp,ContBusRel);

      MESSAGE(Text009,BankAcc.TABLECAPTION,BankAcc."No.");
    END;

    PROCEDURE CreateCustomerLink@5();
    VAR
      Cust@1001 : Record 18;
      ContBusRel@1000 : Record 5054;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Customers");
      CreateLink(
        PAGE::"Customer Link",
        RMSetup."Bus. Rel. Code for Customers",
        ContBusRel."Link to Table"::Customer);

      ContBusRel.SETCURRENTKEY("Link to Table","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      ContBusRel.SETRANGE("Contact No.","Company No.");
      IF ContBusRel.FINDFIRST THEN
        IF Cust.GET(ContBusRel."No.") THEN
          UpdateQuotes(Cust);
    END;

    PROCEDURE CreateVendorLink@6();
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Vendors");
      CreateLink(
        PAGE::"Vendor Link",
        RMSetup."Bus. Rel. Code for Vendors",
        ContBusRel."Link to Table"::Vendor);
    END;

    PROCEDURE CreateBankAccountLink@9();
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Bank Accs.");
      CreateLink(
        PAGE::"Bank Account Link",
        RMSetup."Bus. Rel. Code for Bank Accs.",
        ContBusRel."Link to Table"::"Bank Account");
    END;

    LOCAL PROCEDURE CreateLink@11(CreateForm@1000 : Integer;BusRelCode@1001 : Code[10];Table@1002 : 'Customer,Vendor,Bank Account');
    VAR
      TempContBusRel@1003 : TEMPORARY Record 5054;
    BEGIN
      TempContBusRel."Contact No." := "Company No.";
      TempContBusRel."Business Relation Code" := BusRelCode;
      TempContBusRel."Link to Table" := Table;
      TempContBusRel.INSERT;
      IF PAGE.RUNMODAL(CreateForm,TempContBusRel) = ACTION::LookupOK THEN; // enforce look up mode dialog
      TempContBusRel.DELETEALL;
    END;

    PROCEDURE CreateInteraction@10();
    VAR
      SegmentLine@1000 : TEMPORARY Record 5077;
    BEGIN
      SegmentLine.CreateInteractionFromContact(Rec);
    END;

    PROCEDURE ShowCustVendBank@12();
    VAR
      ContBusRel@1000 : Record 5054;
      FormSelected@1001 : Boolean;
      Cust@1002 : Record 18;
      Vend@1003 : Record 23;
      BankAcc@1004 : Record 270;
    BEGIN
      FormSelected := TRUE;

      ContBusRel.RESET;
      ContBusRel.SETRANGE("Contact No.","Company No.");
      ContBusRel.SETFILTER("No.",'<>''''');

      CASE ContBusRel.COUNT OF
        0:
          ERROR(Text010,TABLECAPTION,"No.");
        1:
          ContBusRel.FINDFIRST;
        ELSE
          FormSelected := PAGE.RUNMODAL(PAGE::"Contact Business Relations",ContBusRel) = ACTION::LookupOK;
      END;

      IF FormSelected THEN
        CASE ContBusRel."Link to Table" OF
          ContBusRel."Link to Table"::Customer:
            BEGIN
              Cust.GET(ContBusRel."No.");
              PAGE.RUN(PAGE::"Customer Card",Cust);
            END;
          ContBusRel."Link to Table"::Vendor:
            BEGIN
              Vend.GET(ContBusRel."No.");
              PAGE.RUN(PAGE::"Vendor Card",Vend);
            END;
          ContBusRel."Link to Table"::"Bank Account":
            BEGIN
              BankAcc.GET(ContBusRel."No.");
              PAGE.RUN(PAGE::"Bank Account Card",BankAcc);
            END;
        END;
    END;

    LOCAL PROCEDURE NameBreakdown@13();
    VAR
      NamePart@1000 : ARRAY [30] OF Text[250];
      TempName@1001 : Text[250];
      FirstName250@1004 : Text[250];
      i@1002 : Integer;
      NoOfParts@1003 : Integer;
    BEGIN
      IF Type = Type::Company THEN
        EXIT;

      TempName := Name;
      WHILE STRPOS(TempName,' ') > 0 DO BEGIN
        IF STRPOS(TempName,' ') > 1 THEN BEGIN
          i := i + 1;
          NamePart[i] := COPYSTR(TempName,1,STRPOS(TempName,' ') - 1);
        END;
        TempName := COPYSTR(TempName,STRPOS(TempName,' ') + 1);
      END;
      i := i + 1;
      NamePart[i] := TempName;
      NoOfParts := i;

      "First Name" := '';
      "Middle Name" := '';
      Surname := '';
      FOR i := 1 TO NoOfParts DO
        IF (i = NoOfParts) AND (NoOfParts > 1) THEN BEGIN
          IF STRLEN(NamePart[i]) > MAXSTRLEN(Surname) THEN
            ERROR(Text032,FIELDCAPTION(Surname),STRLEN(NamePart[i]) - MAXSTRLEN(Surname));
          Surname := NamePart[i]
        END ELSE
          IF (i = NoOfParts - 1) AND (NoOfParts > 2) THEN BEGIN
            IF STRLEN(NamePart[i]) > MAXSTRLEN("Middle Name") THEN
              ERROR(Text032,FIELDCAPTION("Middle Name"),STRLEN(NamePart[i]) - MAXSTRLEN("Middle Name"));
            "Middle Name" := NamePart[i]
          END ELSE BEGIN
            FirstName250 := DELCHR("First Name" + ' ' + NamePart[i],'<',' ');
            IF STRLEN(FirstName250) > MAXSTRLEN("First Name") THEN
              ERROR(Text032,FIELDCAPTION("First Name"),STRLEN(FirstName250) - MAXSTRLEN("First Name"));
            "First Name" := FirstName250;
          END;
    END;

    PROCEDURE SetSkipDefault@15(Defaults@1000 : Boolean);
    BEGIN
      SkipDefaults := NOT Defaults;
    END;

    PROCEDURE IdenticalAddress@16(VAR Cont@1000 : Record 5050) : Boolean;
    BEGIN
      EXIT(
        (Address = Cont.Address) AND
        ("Address 2" = Cont."Address 2") AND
        ("Post Code" = Cont."Post Code") AND
        (City = Cont.City))
    END;

    PROCEDURE ActiveAltAddress@17(ActiveDate@1000 : Date) : Code[10];
    VAR
      ContAltAddrDateRange@1001 : Record 5052;
    BEGIN
      ContAltAddrDateRange.SETCURRENTKEY("Contact No.","Starting Date");
      ContAltAddrDateRange.SETRANGE("Contact No.","No.");
      ContAltAddrDateRange.SETRANGE("Starting Date",0D,ActiveDate);
      ContAltAddrDateRange.SETFILTER("Ending Date",'>=%1|%2',ActiveDate,0D);
      IF ContAltAddrDateRange.FINDLAST THEN
        EXIT(ContAltAddrDateRange."Contact Alt. Address Code");

      EXIT('');
    END;

    LOCAL PROCEDURE CalculatedName@14() NewName@1000 : Text[50];
    VAR
      NewName92@1001 : Text[92];
    BEGIN
      IF "First Name" <> '' THEN
        NewName92 := "First Name";
      IF "Middle Name" <> '' THEN
        NewName92 := NewName92 + ' ' + "Middle Name";
      IF Surname <> '' THEN
        NewName92 := NewName92 + ' ' + Surname;

      NewName92 := DELCHR(NewName92,'<',' ');

      IF STRLEN(NewName92) > MAXSTRLEN(Name) THEN
        ERROR(Text029,STRLEN(NewName92) - MAXSTRLEN(Name));

      NewName := COPYSTR(NewName92,1,STRLEN(NewName92));
    END;

    LOCAL PROCEDURE UpdateSearchName@22();
    BEGIN
      IF ("Search Name" = UPPERCASE(xRec.Name)) OR ("Search Name" = '') THEN
        "Search Name" := Name;
    END;

    LOCAL PROCEDURE CheckDupl@21();
    BEGIN
      IF RMSetup."Maintain Dupl. Search Strings" THEN
        DuplMgt.MakeContIndex(Rec);
      IF GUIALLOWED THEN
        IF DuplMgt.DuplicateExist(Rec) THEN BEGIN
          MODIFY;
          COMMIT;
          DuplMgt.LaunchDuplicateForm(Rec);
        END;
    END;

    PROCEDURE FindCustomerTemplate@23() FindCustTemplate@1001 : Code[10];
    VAR
      CustTemplate@1003 : Record 5105;
      ContCompany@1002 : Record 5050;
    BEGIN
      CustTemplate.RESET;
      CustTemplate.SETRANGE("Territory Code","Territory Code");
      CustTemplate.SETRANGE("Country/Region Code","Country/Region Code");
      IF ContCompany.GET("Company No.") THEN
        CustTemplate.SETRANGE("Currency Code",ContCompany."Currency Code");

      IF CustTemplate.COUNT = 1 THEN BEGIN
        CustTemplate.FINDFIRST;
        EXIT(CustTemplate.Code);
      END;
    END;

    PROCEDURE ChooseCustomerTemplate@27() ChooseCustTemplate@1001 : Code[10];
    VAR
      CustTemplate@1000 : Record 5105;
    BEGIN
      ContBusRel.RESET;
      ContBusRel.SETRANGE("Contact No.","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      IF ContBusRel.FINDFIRST THEN
        ERROR(
          Text019,
          TABLECAPTION,"No.",ContBusRel.TABLECAPTION,ContBusRel."Link to Table",ContBusRel."No.");

      IF CONFIRM(Text020,TRUE,"No.",Name) THEN BEGIN
        IF PAGE.RUNMODAL(0,CustTemplate) = ACTION::LookupOK THEN
          EXIT(CustTemplate.Code);

        ERROR(Text022);
      END;
    END;

    LOCAL PROCEDURE UpdateQuotes@29(Customer@1000 : Record 18);
    VAR
      SalesHeader@1003 : Record 36;
      Cont@1004 : Record 5050;
      SalesLine@1001 : Record 37;
    BEGIN
      Cont.SETCURRENTKEY("Company No.");
      Cont.SETRANGE("Company No.","Company No.");

      IF Cont.FIND('-') THEN
        REPEAT
          SalesHeader.RESET;
          SalesHeader.SETCURRENTKEY("Document Type","Sell-to Contact No.");
          SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Quote);
          SalesHeader.SETRANGE("Sell-to Contact No.",Cont."No.");
          IF SalesHeader.FIND('-') THEN
            REPEAT
              SalesHeader."Sell-to Customer No." := Customer."No.";
              SalesHeader."Sell-to Customer Template Code" := '';
              SalesHeader.MODIFY;
              SalesLine.SETRANGE("Document Type",SalesHeader."Document Type");
              SalesLine.SETRANGE("Document No.",SalesHeader."No.");
              IF SalesLine.FINDFIRST THEN
                SalesLine.MODIFYALL("Sell-to Customer No.",SalesHeader."Sell-to Customer No.");
            UNTIL SalesHeader.NEXT = 0;

          SalesHeader.RESET;
          SalesHeader.SETCURRENTKEY("Bill-to Contact No.");
          SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Quote);
          SalesHeader.SETRANGE("Bill-to Contact No.",Cont."No.");
          IF SalesHeader.FIND('-') THEN
            REPEAT
              SalesHeader."Bill-to Customer No." := Customer."No.";
              SalesHeader."Bill-to Customer Template Code" := '';
              SalesHeader."Salesperson Code" := Customer."Salesperson Code";
              SalesHeader.MODIFY;
              SalesLine.SETRANGE("Document Type",SalesHeader."Document Type");
              SalesLine.SETRANGE("Document No.",SalesHeader."No.");
              IF SalesLine.FINDFIRST THEN
                SalesLine.MODIFYALL("Bill-to Customer No.",SalesHeader."Bill-to Customer No.");
            UNTIL SalesHeader.NEXT = 0;
        UNTIL Cont.NEXT = 0;
    END;

    PROCEDURE GetSalutation@18(SalutationType@1001 : 'Formal,Informal';LanguageCode@1000 : Code[10]) : Text[260];
    VAR
      SalutationFormula@1005 : Record 5069;
      NamePart@1004 : ARRAY [5] OF Text[50];
      SubStr@1003 : Text[30];
      i@1002 : Integer;
    BEGIN
      IF NOT SalutationFormula.GET("Salutation Code",LanguageCode,SalutationType) THEN
        ERROR(Text021,LanguageCode,"No.");
      SalutationFormula.TESTFIELD(Salutation);

      CASE SalutationFormula."Name 1" OF
        SalutationFormula."Name 1"::"Job Title":
          NamePart[1] := "Job Title";
        SalutationFormula."Name 1"::"First Name":
          NamePart[1] := "First Name";
        SalutationFormula."Name 1"::"Middle Name":
          NamePart[1] := "Middle Name";
        SalutationFormula."Name 1"::Surname:
          NamePart[1] := Surname;
        SalutationFormula."Name 1"::Initials:
          NamePart[1] := Initials;
        SalutationFormula."Name 1"::"Company Name":
          NamePart[1] := "Company Name";
      END;

      CASE SalutationFormula."Name 2" OF
        SalutationFormula."Name 2"::"Job Title":
          NamePart[2] := "Job Title";
        SalutationFormula."Name 2"::"First Name":
          NamePart[2] := "First Name";
        SalutationFormula."Name 2"::"Middle Name":
          NamePart[2] := "Middle Name";
        SalutationFormula."Name 2"::Surname:
          NamePart[2] := Surname;
        SalutationFormula."Name 2"::Initials:
          NamePart[2] := Initials;
        SalutationFormula."Name 2"::"Company Name":
          NamePart[2] := "Company Name";
      END;

      CASE SalutationFormula."Name 3" OF
        SalutationFormula."Name 3"::"Job Title":
          NamePart[3] := "Job Title";
        SalutationFormula."Name 3"::"First Name":
          NamePart[3] := "First Name";
        SalutationFormula."Name 3"::"Middle Name":
          NamePart[3] := "Middle Name";
        SalutationFormula."Name 3"::Surname:
          NamePart[3] := Surname;
        SalutationFormula."Name 3"::Initials:
          NamePart[3] := Initials;
        SalutationFormula."Name 3"::"Company Name":
          NamePart[3] := "Company Name";
      END;

      CASE SalutationFormula."Name 4" OF
        SalutationFormula."Name 4"::"Job Title":
          NamePart[4] := "Job Title";
        SalutationFormula."Name 4"::"First Name":
          NamePart[4] := "First Name";
        SalutationFormula."Name 4"::"Middle Name":
          NamePart[4] := "Middle Name";
        SalutationFormula."Name 4"::Surname:
          NamePart[4] := Surname;
        SalutationFormula."Name 4"::Initials:
          NamePart[4] := Initials;
        SalutationFormula."Name 4"::"Company Name":
          NamePart[4] := "Company Name";
      END;

      CASE SalutationFormula."Name 5" OF
        SalutationFormula."Name 5"::"Job Title":
          NamePart[5] := "Job Title";
        SalutationFormula."Name 5"::"First Name":
          NamePart[5] := "First Name";
        SalutationFormula."Name 5"::"Middle Name":
          NamePart[5] := "Middle Name";
        SalutationFormula."Name 5"::Surname:
          NamePart[5] := Surname;
        SalutationFormula."Name 5"::Initials:
          NamePart[5] := Initials;
        SalutationFormula."Name 5"::"Company Name":
          NamePart[5] := "Company Name";
      END;

      FOR i := 1 TO 5 DO
        IF NamePart[i] = '' THEN BEGIN
          SubStr := '%' + FORMAT(i) + ' ';
          IF STRPOS(SalutationFormula.Salutation,SubStr) > 0 THEN
            SalutationFormula.Salutation :=
              DELSTR(SalutationFormula.Salutation,STRPOS(SalutationFormula.Salutation,SubStr),3);
        END;

      EXIT(STRSUBSTNO(SalutationFormula.Salutation,NamePart[1],NamePart[2],NamePart[3],NamePart[4],NamePart[5]))
    END;

    PROCEDURE InheritCompanyToPersonData@24(Cont@1000 : Record 5050;KeepPersonalData@1001 : Boolean);
    BEGIN
      "Company Name" := Cont.Name;

      RMSetup.GET;
      IF RMSetup."Inherit Salesperson Code" THEN
        "Salesperson Code" := Cont."Salesperson Code";
      IF RMSetup."Inherit Territory Code" THEN
        "Territory Code" := Cont."Territory Code";
      IF RMSetup."Inherit Country/Region Code" THEN
        "Country/Region Code" := Cont."Country/Region Code";
      IF RMSetup."Inherit Language Code" THEN
        "Language Code" := Cont."Language Code";
      IF RMSetup."Inherit Address Details" AND
         ((NOT KeepPersonalData) OR
          (Cont.Address + Cont."Address 2" + Cont.County + Cont."Post Code" + Cont.City <> ''))
      THEN BEGIN
        Address := Cont.Address;
        "Address 2" := Cont."Address 2";
        "Post Code" := Cont."Post Code";
        City := Cont.City;
        County := Cont.County;
      END;
      IF RMSetup."Inherit Communication Details" THEN BEGIN
        IF (Cont."Phone No." <> '') OR NOT KeepPersonalData THEN
          "Phone No." := Cont."Phone No.";
        IF (Cont."Telex No." <> '') OR NOT KeepPersonalData THEN
          "Telex No." := Cont."Telex No.";
        IF (Cont."Fax No." <> '') OR NOT KeepPersonalData THEN
          "Fax No." := Cont."Fax No.";
        IF (Cont."Telex Answer Back" <> '') OR NOT KeepPersonalData THEN
          "Telex Answer Back" := Cont."Telex Answer Back";
        IF (Cont."E-Mail" <> '') OR NOT KeepPersonalData THEN
          VALIDATE("E-Mail",Cont."E-Mail");
        IF (Cont."Home Page" <> '') OR NOT KeepPersonalData THEN
          "Home Page" := Cont."Home Page";
        IF (Cont."Extension No." <> '') OR NOT KeepPersonalData THEN
          "Extension No." := Cont."Extension No.";
        IF (Cont."Mobile Phone No." <> '') OR NOT KeepPersonalData THEN
          "Mobile Phone No." := Cont."Mobile Phone No.";
        IF (Cont.Pager <> '') OR NOT KeepPersonalData THEN
          Pager := Cont.Pager;
        IF (Cont."Correspondence Type" <> "Correspondence Type"::" ") OR NOT KeepPersonalData THEN
          "Correspondence Type" := Cont."Correspondence Type";
      END;
      CALCFIELDS("No. of Industry Groups","No. of Business Relations");
    END;

    PROCEDURE SetHideValidationDialog@26(NewHideValidationDialog@1000 : Boolean) : Boolean;
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    PROCEDURE DisplayMap@36();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FINDFIRST THEN
        MapMgt.MakeSelection(DATABASE::Contact,GETPOSITION)
      ELSE
        MESSAGE(Text033);
    END;

    LOCAL PROCEDURE ProcessNameChange@37();
    VAR
      ContBusRel@1000 : Record 5054;
      Cust@1001 : Record 18;
      Vend@1002 : Record 23;
    BEGIN
      UpdateSearchName;

      IF Type = Type::Company THEN
        "Company Name" := Name;

      IF Type = Type::Person THEN BEGIN
        ContBusRel.RESET;
        ContBusRel.SETCURRENTKEY("Link to Table","Contact No.");
        ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
        ContBusRel.SETRANGE("Contact No.","Company No.");
        IF ContBusRel.FINDFIRST THEN
          IF Cust.GET(ContBusRel."No.") THEN
            IF Cust."Primary Contact No." = "No." THEN BEGIN
              Cust.Contact := Name;
              Cust.MODIFY;
            END;

        ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
        IF ContBusRel.FINDFIRST THEN
          IF Vend.GET(ContBusRel."No.") THEN
            IF Vend."Primary Contact No." = "No." THEN BEGIN
              Vend.Contact := Name;
              Vend.MODIFY;
            END;
      END;
    END;

    BEGIN
    {
      CMMS
        20170310  Added Field "CMMS Is CMMS Contact"
                  Added Key "CMMS Is CMMS Contact,No."
    }
    END.
  }
}

OBJECT Table 5064 Interaction Template
{
  OBJECT-PROPERTIES
  {
    Date=09.11.16;
    Time=14:07:35;
    Modified=Yes;
    Version List=NAVW17.00,CMMS;
  }
  PROPERTIES
  {
    OnDelete=VAR
               InteractTmplLanguage@1000 : Record 5103;
             BEGIN
               InteractTmplLanguage.SETRANGE("Interaction Template Code",Code);
               InteractTmplLanguage.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Interaction Template;
               DEA=Aktivit„tenvorlage];
    LookupPageID=Page5075;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              DEA=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Interaction Group Code;Code10      ;TableRelation="Interaction Group";
                                                   CaptionML=[ENU=Interaction Group Code;
                                                              DEA=Aktivit„tengruppencode];
                                                   NotBlank=Yes }
    { 3   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 4   ;   ;Unit Cost (LCY)     ;Decimal       ;CaptionML=[ENU=Unit Cost (LCY);
                                                              DEA=Einstandspreis (MW)];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 5   ;   ;Unit Duration (Min.);Decimal       ;CaptionML=[ENU=Unit Duration (Min.);
                                                              DEA=Vorgabedauer (Min.)];
                                                   DecimalPlaces=0:0;
                                                   MinValue=0 }
    { 6   ;   ;Information Flow    ;Option        ;CaptionML=[ENU=Information Flow;
                                                              DEA=Informationsfluss];
                                                   OptionCaptionML=[ENU=" ,Outbound,Inbound";
                                                                    DEA=" ,Ausgehend,Eingehend"];
                                                   OptionString=[ ,Outbound,Inbound] }
    { 7   ;   ;Initiated By        ;Option        ;CaptionML=[ENU=Initiated By;
                                                              DEA=Veranlasst durch];
                                                   OptionCaptionML=[ENU=" ,Us,Them";
                                                                    DEA=" ,Uns,Kontakt"];
                                                   OptionString=[ ,Us,Them] }
    { 8   ;   ;Attachment No.      ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Interaction Tmpl. Language"."Attachment No." WHERE (Interaction Template Code=FIELD(Code),
                                                                                                                           Language Code=FIELD("Language Code (Default)")));
                                                   CaptionML=[ENU=Attachment No.;
                                                              DEA=Dateianhangsnr.];
                                                   Editable=No }
    { 9   ;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   CaptionML=[ENU=Campaign No.;
                                                              DEA=Kampagnennr.] }
    { 10  ;   ;Campaign Target     ;Boolean       ;CaptionML=[ENU=Campaign Target;
                                                              DEA=Kampagnenziel] }
    { 11  ;   ;Campaign Response   ;Boolean       ;CaptionML=[ENU=Campaign Response;
                                                              DEA=Kampagnenreaktion] }
    { 12  ;   ;Correspondence Type (Default);Option;
                                                   OnValidate=VAR
                                                                Attachment@1001 : Record 5062;
                                                                ErrorText@1000 : Text[80];
                                                              BEGIN
                                                                IF NOT Attachment.GET("Attachment No.") THEN
                                                                  EXIT;

                                                                ErrorText := Attachment.CheckCorrespondenceType("Correspondence Type (Default)");
                                                                IF ErrorText <> '' THEN
                                                                  ERROR(
                                                                    STRSUBSTNO('%1%2',
                                                                      STRSUBSTNO(Text003,
                                                                        FIELDCAPTION("Correspondence Type (Default)"),
                                                                        "Correspondence Type (Default)",
                                                                        TABLECAPTION,
                                                                        Code),
                                                                      ErrorText));
                                                              END;

                                                   CaptionML=[ENU=Correspondence Type (Default);
                                                              DEA=Korrespondenzart (Standard)];
                                                   OptionCaptionML=[ENU=" ,Hard Copy,E-Mail,Fax";
                                                                    DEA=" ,Brief,E-Mail,Fax"];
                                                   OptionString=[ ,Hard Copy,E-Mail,Fax] }
    { 13  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              DEA=Datumsfilter] }
    { 14  ;   ;No. of Interactions ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (Interaction Template Code=FIELD(Code),
                                                                                                    Canceled=CONST(No),
                                                                                                    Date=FIELD(Date Filter),
                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=No. of Interactions;
                                                              DEA=Anzahl Aktivit„ten];
                                                   Editable=No }
    { 15  ;   ;Cost (LCY)          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Cost (LCY)" WHERE (Interaction Template Code=FIELD(Code),
                                                                                                               Canceled=CONST(No),
                                                                                                               Date=FIELD(Date Filter),
                                                                                                               Postponed=CONST(No)));
                                                   CaptionML=[ENU=Cost (LCY);
                                                              DEA=Einstandsbetrag (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 16  ;   ;Duration (Min.)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Duration (Min.)" WHERE (Interaction Template Code=FIELD(Code),
                                                                                                                    Canceled=CONST(No),
                                                                                                                    Date=FIELD(Date Filter),
                                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=Duration (Min.);
                                                              DEA=Dauer (Min.)];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 17  ;   ;Language Code (Default);Code10     ;TableRelation=Language;
                                                   OnValidate=VAR
                                                                InteractTmplLanguage@1000 : Record 5103;
                                                              BEGIN
                                                                IF NOT InteractTmplLanguage.GET(Code,"Language Code (Default)") THEN BEGIN
                                                                  IF CONFIRM(Text004,TRUE,InteractTmplLanguage.TABLECAPTION,"Language Code (Default)") THEN BEGIN
                                                                    InteractTmplLanguage.INIT;
                                                                    InteractTmplLanguage."Interaction Template Code" := Code;
                                                                    InteractTmplLanguage."Language Code" := "Language Code (Default)";
                                                                    InteractTmplLanguage.Description := Description;
                                                                    InteractTmplLanguage.INSERT;
                                                                  END ELSE
                                                                    ERROR('');
                                                                END;
                                                                CALCFIELDS("Attachment No.");
                                                              END;

                                                   OnLookup=VAR
                                                              InteractTmplLanguage@1000 : Record 5103;
                                                            BEGIN
                                                              InteractTmplLanguage.SETRANGE("Interaction Template Code",Code);
                                                              IF PAGE.RUNMODAL(0,InteractTmplLanguage) = ACTION::LookupOK THEN
                                                                "Language Code (Default)" := InteractTmplLanguage."Language Code";
                                                            END;

                                                   CaptionML=[ENU=Language Code (Default);
                                                              DEA=Sprachcode (Standard)] }
    { 18  ;   ;Wizard Action       ;Option        ;CaptionML=[ENU=Wizard Action;
                                                              DEA=Aktion des Assistenten];
                                                   OptionCaptionML=[ENU=" ,Open,Import,,,,,Information";
                                                                    DEA=" ,Dateianhang ”ffnen,Dateianhang importieren,,,,,Information"];
                                                   OptionString=[ ,Open,Import,,,,,Information];
                                                   Description=IG }
    { 19  ;   ;Ignore Contact Corres. Type;Boolean;CaptionML=[ENU=Ignore Contact Corres. Type;
                                                              DEA=Kontakt Korrespond.-Art ignor.] }
    { 50000;  ;IG Information Type ;Option        ;CaptionML=[ENU=Information Type;
                                                              DEA=Information Typ];
                                                   OptionCaptionML=[ENU=" ,Comment,Comment (long),,,,,,,,Replacement,Installation";
                                                                    DEA=" ,Kommentar,Kommentar (lang),,,,,,,,Austausch,Installation"];
                                                   OptionString=[ ,Comment,Comment (long),,,,,,,,Replacement,Installation];
                                                   Description=IG }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Interaction Group Code                   }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Code,Description,Information Flow        }
  }
  CODE
  {
    VAR
      Text003@1003 : TextConst 'ENU="%1 = %2 can not be specified for %3 %4.\";DEA="Die %1 = %2 kann fr %3 %4 nicht angegeben werden.\"';
      Text004@1004 : TextConst 'ENU=Do you want to create %1 %2?;DEA=M”chten Sie die %1 %2 erstellen?';

    BEGIN
    END.
  }
}

OBJECT Table 5065 Interaction Log Entry
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=13:14:15;
    Modified=Yes;
    Version List=NAVW19.00,NAVDACH9.00,CMMS;
  }
  PROPERTIES
  {
    OnDelete=VAR
               InteractionCommentLine@1000 : Record 5123;
               CampaignMgt@1001 : Codeunit 7030;
             BEGIN
               InteractionCommentLine.SETRANGE("Entry No.","Entry No.");
               InteractionCommentLine.DELETEALL;

               CampaignMgt.DeleteContfromTargetGr(Rec);
             END;

    CaptionML=[ENU=Interaction Log Entry;
               DEA=Aktivit„tenprotokollposten];
    LookupPageID=Page5076;
    DrillDownPageID=Page5076;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              DEA=Lfd. Nr.];
                                                   Description=CM }
    { 2   ;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   CaptionML=[ENU=Contact No.;
                                                              DEA=Kontaktnr.] }
    { 3   ;   ;Contact Company No. ;Code20        ;TableRelation=Contact WHERE (Type=CONST(Company));
                                                   CaptionML=[ENU=Contact Company No.;
                                                              DEA=Kontakt Unternehmensnr.] }
    { 4   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              DEA=Datum];
                                                   Description=CM }
    { 5   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung];
                                                   Description=CM }
    { 6   ;   ;Information Flow    ;Option        ;CaptionML=[ENU=Information Flow;
                                                              DEA=Informationsfluss];
                                                   OptionCaptionML=[ENU=" ,Outbound,Inbound";
                                                                    DEA=" ,Ausgehend,Eingehend"];
                                                   OptionString=[ ,Outbound,Inbound] }
    { 7   ;   ;Initiated By        ;Option        ;CaptionML=[ENU=Initiated By;
                                                              DEA=Veranlasst durch];
                                                   OptionCaptionML=[ENU=" ,Us,Them";
                                                                    DEA=" ,Uns,Kontakt"];
                                                   OptionString=[ ,Us,Them] }
    { 8   ;   ;Attachment No.      ;Integer       ;TableRelation=Attachment;
                                                   CaptionML=[ENU=Attachment No.;
                                                              DEA=Dateianhangsnr.] }
    { 9   ;   ;Cost (LCY)          ;Decimal       ;CaptionML=[ENU=Cost (LCY);
                                                              DEA=Einstandsbetrag (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 10  ;   ;Duration (Min.)     ;Decimal       ;CaptionML=[ENU=Duration (Min.);
                                                              DEA=Dauer (Min.)];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 11  ;   ;User ID             ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=VAR
                                                              UserMgt@1000 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("User ID");
                                                            END;

                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=User ID;
                                                              DEA=Benutzer-ID];
                                                   Description=CM }
    { 12  ;   ;Interaction Group Code;Code10      ;TableRelation="Interaction Group";
                                                   CaptionML=[ENU=Interaction Group Code;
                                                              DEA=Aktivit„tengruppencode] }
    { 13  ;   ;Interaction Template Code;Code10   ;TableRelation="Interaction Template";
                                                   CaptionML=[ENU=Interaction Template Code;
                                                              DEA=Aktivit„tenvorlagencode] }
    { 14  ;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   CaptionML=[ENU=Campaign No.;
                                                              DEA=Kampagnennr.] }
    { 15  ;   ;Campaign Entry No.  ;Integer       ;TableRelation="Campaign Entry" WHERE (Campaign No.=FIELD(Campaign No.));
                                                   CaptionML=[ENU=Campaign Entry No.;
                                                              DEA=Kampagnenposten Lfd. Nr.] }
    { 16  ;   ;Campaign Response   ;Boolean       ;CaptionML=[ENU=Campaign Response;
                                                              DEA=Kampagnenreaktion] }
    { 17  ;   ;Campaign Target     ;Boolean       ;CaptionML=[ENU=Campaign Target;
                                                              DEA=Kampagnenziel] }
    { 18  ;   ;Segment No.         ;Code20        ;CaptionML=[ENU=Segment No.;
                                                              DEA=Segmentnr.] }
    { 19  ;   ;Evaluation          ;Option        ;CaptionML=[ENU=Evaluation;
                                                              DEA=Bewertung];
                                                   OptionCaptionML=[ENU=" ,Very Positive,Positive,Neutral,Negative,Very Negative";
                                                                    DEA=" ,Sehr positiv,Positiv,Neutral,Negativ,Sehr negativ"];
                                                   OptionString=[ ,Very Positive,Positive,Neutral,Negative,Very Negative];
                                                   Editable=No }
    { 20  ;   ;Time of Interaction ;Time          ;CaptionML=[ENU=Time of Interaction;
                                                              DEA=Uhrzeit];
                                                   Description=CM }
    { 21  ;   ;Attempt Failed      ;Boolean       ;CaptionML=[ENU=Attempt Failed;
                                                              DEA=Nicht erreicht] }
    { 23  ;   ;To-do No.           ;Code20        ;TableRelation=To-do;
                                                   CaptionML=[ENU=To-do No.;
                                                              DEA=Aufgabennr.];
                                                   Description=CM }
    { 24  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Salesperson Code;
                                                              DEA=Verk„ufercode] }
    { 25  ;   ;Delivery Status     ;Option        ;CaptionML=[ENU=Delivery Status;
                                                              DEA=šbermittlungsstatus];
                                                   OptionCaptionML=[ENU=" ,In Progress,Error";
                                                                    DEA=" ,In Bearbeitung,Fehler"];
                                                   OptionString=[ ,In Progress,Error] }
    { 26  ;   ;Canceled            ;Boolean       ;CaptionML=[ENU=Canceled;
                                                              DEA=Storniert];
                                                   Description=CM }
    { 27  ;   ;Correspondence Type ;Option        ;CaptionML=[ENU=Correspondence Type;
                                                              DEA=Korrespondenzart];
                                                   OptionCaptionML=[ENU=" ,Hard Copy,E-Mail,Fax";
                                                                    DEA=" ,Brief,E-Mail,Fax"];
                                                   OptionString=[ ,Hard Copy,E-Mail,Fax] }
    { 28  ;   ;Contact Alt. Address Code;Code10   ;TableRelation="Contact Alt. Address".Code WHERE (Contact No.=FIELD(Contact No.));
                                                   CaptionML=[ENU=Contact Alt. Address Code;
                                                              DEA=Alt. Kontaktadresscode] }
    { 29  ;   ;Logged Segment Entry No.;Integer   ;TableRelation="Logged Segment";
                                                   CaptionML=[ENU=Logged Segment Entry No.;
                                                              DEA=Protok. Segmentposten Lfd. Nr.] }
    { 30  ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              DEA=Belegart];
                                                   OptionCaptionML=[ENU=" ,Sales Qte.,Sales Blnkt. Ord,Sales Ord. Cnfrmn.,Sales Inv.,Sales Shpt. Note,Sales Cr. Memo,Sales Stmnt.,Sales Rmdr.,Serv. Ord. Create,Serv. Ord. Post,Purch.Qte.,Purch. Blnkt. Ord.,Purch. Ord.,Purch. Inv.,Purch. Rcpt.,Purch. Cr. Memo,Cover Sheet,Sales Return Order,Sales Finance Charge Memo,Sales Return Receipt,Purch. Return Shipment,Purch. Return Ord. Cnfrmn.,Service Contract,Service Contract Quote,Service Quote";
                                                                    DEA=" ,Angebot,Rahmenauftrag,Auftragsbest.,VK-Rech.,VK-Liefersch.,VK-Gutschr.,Kontoausz.,Mahnung,Serv.-Auftr. erst.,Serv.-Auftr. buchen,Anfrage,Rahmenbestellung,Bestellung,EK-Rech.,EK-Liefersch.,EK-Gutschr.,Deckblatt,Verkaufsreklamation,Zinsrechnung,Rcksendung,Rcklieferung,Eink.-Reklamationsbest„tigung,Servicevertrag,Servicevertragsangebot,Serviceangebot"];
                                                   OptionString=[ ,Sales Qte.,Sales Blnkt. Ord,Sales Ord. Cnfrmn.,Sales Inv.,Sales Shpt. Note,Sales Cr. Memo,Sales Stmnt.,Sales Rmdr.,Serv. Ord. Create,Serv. Ord. Post,Purch.Qte.,Purch. Blnkt. Ord.,Purch. Ord.,Purch. Inv.,Purch. Rcpt.,Purch. Cr. Memo,Cover Sheet,Sales Return Order,Sales Finance Charge Memo,Sales Return Receipt,Purch. Return Shipment,Purch. Return Ord. Cnfrmn.,Service Contract,Service Contract Quote,Service Quote] }
    { 31  ;   ;Document No.        ;Code20        ;TestTableRelation=No;
                                                   CaptionML=[ENU=Document No.;
                                                              DEA=Belegnr.] }
    { 32  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              DEA=Versionsnr.] }
    { 33  ;   ;Doc. No. Occurrence ;Integer       ;CaptionML=[ENU=Doc. No. Occurrence;
                                                              DEA=Belegnr.-H„ufigkeit] }
    { 34  ;   ;Contact Via         ;Text80        ;CaptionML=[ENU=Contact Via;
                                                              DEA=Nummer/Adresse] }
    { 35  ;   ;Send Word Docs. as Attmt.;Boolean  ;CaptionML=[ENU=Send Word Docs. as Attmt.;
                                                              DEA=Word-Dokumente als Anh. senden] }
    { 36  ;   ;Interaction Language Code;Code10   ;TableRelation=Language;
                                                   CaptionML=[ENU=Interaction Language Code;
                                                              DEA=Aktivit„tensprachcode] }
    { 37  ;   ;E-Mail Logged       ;Boolean       ;CaptionML=[ENU=E-Mail Logged;
                                                              DEA=E-Mail protokolliert] }
    { 38  ;   ;Subject             ;Text50        ;CaptionML=[ENU=Subject;
                                                              DEA=Betreff] }
    { 39  ;   ;Contact Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact No.)));
                                                   CaptionML=[ENU=Contact Name;
                                                              DEA=Kontaktname];
                                                   Editable=No }
    { 40  ;   ;Contact Company Name;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact Company No.),
                                                                                          Type=CONST(Company)));
                                                   CaptionML=[ENU=Contact Company Name;
                                                              DEA=Kontakt Unternehmensname];
                                                   Editable=No }
    { 43  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Inter. Log Entry Comment Line" WHERE (Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung];
                                                   Editable=No }
    { 44  ;   ;Opportunity No.     ;Code20        ;TableRelation=Opportunity;
                                                   CaptionML=[ENU=Opportunity No.;
                                                              DEA=Verkaufschancennr.];
                                                   Description=CM }
    { 45  ;   ;Postponed           ;Boolean       ;CaptionML=[ENU=Postponed;
                                                              DEA=Zurckgestellt] }
    { 50000;  ;CM Is CMMS Log Entry;Boolean       ;CaptionML=[ENU=Ist CMMS Log Entry;
                                                              DEA=Ist CMMS Log Eintrag] }
    { 50100;  ;CM Source           ;Option        ;CaptionML=[ENU=Source;
                                                              DEA=Herkunft];
                                                   OptionCaptionML=[ENU=Asset/Project,Workorder,Task,Contract,Checklist;
                                                                    DEA=Anlage/Projekt,Arbeitsauftrag,Aufgabe,Vertrag,Checkliste];
                                                   OptionString=Asset/Project,Workorder,Task,Contract,Checklist }
    { 50110;  ;CM Source No.       ;Code20        ;CaptionML=[ENU=Source No.;
                                                              DEA=Herkunftsnr.] }
    { 50200;  ;CM Log Type         ;Option        ;CaptionML=[ENU=Log Type;
                                                              DEA=Log Typ];
                                                   OptionString=Read,Created,Modified,Deleted,Comment,Status Change,Picture,Attachment,Assigned User Changed,Contract Assigned,Contract Detached }
    { 51190;  ;CM Objecttype       ;Option        ;CaptionML=[ENU=Objecttype;
                                                              DEA=Objecttyp];
                                                   OptionString=Asset,Project }
    { 51200;  ;CM Object No.       ;Code20        ;CaptionML=[ENU=Asset No.;
                                                              DEA=Anlage Nr.] }
    { 51300;  ;CM Comment          ;Text250       ;CaptionML=[ENU=Comment;
                                                              DEA=Kommentar] }
    { 51400;  ;CM Internal         ;Boolean       ;CaptionML=[ENU=Internal;
                                                              DEA=Intern] }
    { 51420;  ;CM Issue            ;Option        ;CaptionML=[ENU=Issue;
                                                              DEA=Grund];
                                                   OptionString=[ ,Maintenance,Fault rectification,Communication Issue,Temporary Issue,Inform] }
    { 51430;  ;CM Production Effect;Option        ;CaptionML=[ENU=Production Effect;
                                                              DEA=Auswirkung auf Produktion];
                                                   OptionString=[ ,No impact,Minor impact,Production impact] }
    { 51500;  ;CM Created Datetime ;DateTime      ;CaptionML=[ENU=Datetime;
                                                              DEA=Datum Uhrzeit] }
    { 52000;  ;CM Status Change Standard Text;Option;
                                                   CaptionML=ENU=Status Change Standard Text;
                                                   OptionString=[ ,False alarm,Alarm condition disappeared,Technician has been informed,Work started,Technician is on site,Technician is on the way,Operational work has been finished,Work Order needs to be invoiced,Plant back in production,Alarm solved,Communication issue,Internet connection problem,On-Site Check has been scheduled] }
    { 52010;  ;CM Deleted          ;Boolean       ;CaptionML=[ENU=Deleted;
                                                              DEA=Gel”scht] }
    { 52020;  ;CM Deleted By User ID;Code50       ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=Deleted by User ID;
                                                              DEA=Gel”scht von User ID] }
    { 52030;  ;CM Deleted Date     ;Date          ;CaptionML=[ENU=Deleted Date;
                                                              DEA=Gel”scht Datum] }
    { 52031;  ;CM Deleted Time     ;Time          ;CaptionML=[ENU=Deleted Time;
                                                              DEA=Gel”scht Uhrzeit] }
    { 52040;  ;CM Comment Copied f. Entry No.;Integer;
                                                   TableRelation="Interaction Log Entry"."Entry No.";
                                                   CaptionML=[ENU=Comment Copied f. Entry No.;
                                                              DEA=Kommentar kopiert v. Eintrag Nr.] }
    { 53000;  ;CM No Data          ;Boolean        }
    { 53010;  ;CM Identifier       ;Text64         }
    { 53020;  ;CM Health And Safety Document;Boolean;
                                                   CaptionML=[ENU=Health And Safety Document;
                                                              DEA=Health And Safety Document] }
    { 54000;  ;CM Related Entry No.;Integer       ;TableRelation="Interaction Log Entry"."Entry No.";
                                                   CaptionML=[ENU=Related Entry No.;
                                                              DEA=Verbundene Lfd. Nr.] }
    { 55000;  ;CM User Name        ;Text80        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(User ID)));
                                                   CaptionML=[ENU=User Name;
                                                              DEA=Benutzername];
                                                   Description=FF;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Contact Company No.,Contact No.,Date,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.);
                                                   MaintainSIFTIndex=No }
    {    ;Interaction Group Code,Date              }
    {    ;Interaction Group Code,Canceled,Date,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Interaction Template Code,Date           }
    {    ;Interaction Template Code,Canceled,Date,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Canceled,Campaign No.,Campaign Entry No.,Date,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Campaign No.,Campaign Entry No.,Date,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Salesperson Code,Date,Postponed         ;SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Canceled,Salesperson Code,Date,Postponed;SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Logged Segment Entry No.,Postponed       }
    {    ;Attachment No.                           }
    {    ;To-do No.,Date                           }
    {    ;Contact No.,Correspondence Type,E-Mail Logged,Subject,Postponed }
    {    ;Campaign No.,Campaign Target             }
    {    ;Campaign No.,Contact Company No.,Campaign Target,Postponed }
    {    ;Opportunity No.,Date                     }
    {    ;CM Is CMMS Log Entry,CM Source,CM Source No. }
    {    ;CM Is CMMS Log Entry,CM Source,CM Source No.,CM Log Type }
    {    ;CM Is CMMS Log Entry,CM Objecttype,CM Object No. }
    {    ;CM Is CMMS Log Entry,Opportunity No.     }
    {    ;CM Is CMMS Log Entry,To-do No.           }
    {    ;CM Is CMMS Log Entry,CM No Data,CM Log Type,CM Identifier }
    {    ;CM Is CMMS Log Entry,Opportunity No.,CM Log Type,CM Deleted,CM Internal,CM Created Datetime,CM Source }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Entry No.,Description,Contact No.,Date   }
    { 2   ;Brick               ;CM Created Datetime,Description,CM Log Type,CM Comment,CM Source,User ID }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=%1 %2 is marked %3.\;DEA=%1 %2 ist als %3 gekennzeichnet.\';
      Text001@1001 : TextConst 'ENU=Do you wish to remove the checkmark?;DEA=M”chten Sie das Kennzeichen Storniert entfernen?';
      Text002@1002 : TextConst 'ENU=Do you wish to mark %1 %2 as %3?;DEA=M”chten Sie den %1 %2 als %3 kennzeichnen?';
      Text003@1003 : TextConst 'ENU=It is not possible to view sales statements after they have been printed.;DEA=Es ist nicht m”glich Kontoauszge einzusehen, nachdem sie gedruckt wurden.';
      Text004@1004 : TextConst 'ENU=It is not possible to show cover sheets after they have been printed.;DEA=Es ist nicht m”glich Deckbl„tter einzusehen, nachdem sie gedruckt wurden.';
      Text005@1005 : TextConst 'ENU=Do you wish to remove the checkmark from the selected %1 lines?;DEA=M”chten Sie die Markierung von den gew„hlten %1 entfernen?';
      Text006@1006 : TextConst 'ENU=Do you wish to mark the selected %1 lines as %2?;DEA=M”chten Sie die ausgew„hlten %1 als %2 kennzeichnen?';
      Text009@1007 : TextConst 'ENU=Do you want to remove Attachment?;DEA=M”chten Sie den Anhang entfernen?';
      Text010@1008 : TextConst 'ENU=Do you want to remove unique Attachments for the selected lines?;DEA=M”chten Sie die eindeutigen Anh„nge fr die gew„hlten Zeilen entfernen?';
      Text011@1009 : TextConst 'ENU=Very Positive,Positive,Neutral,Negative,Very Negative;DEA=Sehr positiv,Positiv,Neutral,Negativ,Sehr negativ';

    PROCEDURE CreateInteraction@10();
    VAR
      SegLine@1000 : TEMPORARY Record 5077;
    BEGIN
      SegLine.CreateInteractionFromIntLogEnt(Rec);
    END;

    PROCEDURE CreateTodo@8();
    VAR
      TempTodo@1000 : TEMPORARY Record 5080;
    BEGIN
      TempTodo.CreateToDoFromInteractLogEntry(Rec)
    END;

    PROCEDURE OpenAttachment@5();
    VAR
      Attachment@1000 : Record 5062;
      SegLine@1001 : Record 5077;
    BEGIN
      IF "Attachment No." = 0 THEN
        EXIT;
      Attachment.GET("Attachment No.");

      IF Attachment."Storage Type" <> Attachment."Storage Type"::"Exchange Storage" THEN BEGIN
        SegLine."Contact No." := "Contact No.";
        SegLine."Salesperson Code" := "Salesperson Code";
        SegLine."Contact Alt. Address Code" := "Contact Alt. Address Code";
        SegLine.Date := Date;
        SegLine."Campaign No." := "Campaign No.";
        SegLine."Segment No." := "Segment No.";
        SegLine."Line No." := "Entry No.";
        SegLine.Description := Description;
        SegLine.Subject := Subject;
        SegLine."Language Code" := "Interaction Language Code";
        Attachment.ShowAttachment(SegLine,FORMAT("Entry No.") + ' ' + Description,FALSE);
      END ELSE
        Attachment.DisplayInOutlook;
    END;

    PROCEDURE ToggleCanceledCheckmark@7();
    VAR
      ErrorTxt@1004 : Text[80];
      MasterCanceledCheckmark@1001 : Boolean;
      RemoveUniqueAttachment@1000 : Boolean;
    BEGIN
      IF FIND('-') THEN BEGIN
        IF ConfirmToggleCanceledCheckmark(COUNT,ErrorTxt) THEN BEGIN
          MasterCanceledCheckmark := NOT Canceled;
          IF FindUniqueAttachment AND MasterCanceledCheckmark THEN
            RemoveUniqueAttachment := CONFIRM(ErrorTxt,FALSE);
          SETCURRENTKEY("Entry No.");
          IF FIND('-') THEN
            REPEAT
              SetCanceledCheckmark(MasterCanceledCheckmark,RemoveUniqueAttachment);
            UNTIL NEXT = 0
        END;
      END
    END;

    PROCEDURE SetCanceledCheckmark@2(CanceledCheckmark@1003 : Boolean;RemoveUniqueAttachment@1004 : Boolean);
    VAR
      CampaignEntry@1000 : Record 5072;
      LoggedSeg@1001 : Record 5075;
      Attachment@1002 : Record 5062;
    BEGIN
      IF Canceled AND NOT CanceledCheckmark THEN BEGIN
        IF "Logged Segment Entry No." <> 0 THEN BEGIN
          LoggedSeg.GET("Logged Segment Entry No.");
          LoggedSeg.TESTFIELD(Canceled,FALSE);
        END;
        IF "Campaign Entry No." <> 0 THEN BEGIN
          CampaignEntry.GET("Campaign Entry No.");
          CampaignEntry.TESTFIELD(Canceled,FALSE);
        END;
      END;

      IF NOT Canceled AND CanceledCheckmark THEN
        IF UniqueAttachment AND RemoveUniqueAttachment THEN BEGIN
          Attachment.GET("Attachment No.");
          IF Attachment.RemoveAttachment(FALSE) THEN
            "Attachment No." := 0;
        END;

      Canceled := CanceledCheckmark;
      MODIFY;
    END;

    LOCAL PROCEDURE ConfirmToggleCanceledCheckmark@3(NumberOfSelectedLines@1000 : Integer;VAR ErrorTxt@1001 : Text[80]) : Boolean;
    BEGIN
      IF NumberOfSelectedLines = 1 THEN BEGIN
        ErrorTxt := Text009;
        IF Canceled THEN
          EXIT(CONFIRM(
              Text000 +
              Text001,TRUE,TABLECAPTION,"Entry No.",FIELDCAPTION(Canceled)));

        EXIT(CONFIRM(
            Text002,TRUE,TABLECAPTION,"Entry No.",FIELDCAPTION(Canceled)));
      END;
      ErrorTxt := Text010;
      IF Canceled THEN
        EXIT(CONFIRM(
            Text005,TRUE,TABLECAPTION));

      EXIT(CONFIRM(
          Text006,TRUE,TABLECAPTION,FIELDCAPTION(Canceled)));
    END;

    PROCEDURE UniqueAttachment@4() IsUnique@1000 : Boolean;
    VAR
      InteractLogEntry@1001 : Record 5065;
    BEGIN
      IF "Attachment No." <> 0 THEN BEGIN
        InteractLogEntry.SETCURRENTKEY("Attachment No.");
        InteractLogEntry.SETRANGE("Attachment No.","Attachment No.");
        InteractLogEntry.SETFILTER("Entry No.",'<>%1',"Entry No.");
        IsUnique := NOT InteractLogEntry.FINDFIRST;
      END;
    END;

    LOCAL PROCEDURE FindUniqueAttachment@6() IsUnique@1000 : Boolean;
    BEGIN
      IF FIND('-') THEN
        REPEAT
          IsUnique := UniqueAttachment;
        UNTIL (NEXT = 0) OR IsUnique
    END;

    PROCEDURE ShowDocument@1();
    VAR
      SalesHeader@1000 : Record 36;
      SalesHeaderArchive@1011 : Record 5107;
      SalesInvHeader@1001 : Record 112;
      SalesShptHeader@1002 : Record 110;
      SalesCrMemoHeader@1003 : Record 114;
      IssuedReminderHeader@1004 : Record 297;
      PurchHeader@1005 : Record 38;
      PurchHeaderArchive@1012 : Record 5109;
      PurchInvHeader@1006 : Record 122;
      PurchRcptHeader@1007 : Record 120;
      PurchCrMemoHeader@1008 : Record 124;
      ServHeader@1009 : Record 5900;
      ReturnRcptHeader@1013 : Record 6660;
      IssuedFinChargeMemoHeader@1015 : Record 304;
      ReturnReceiptHeader@1014 : Record 6660;
      ReturnShipmentHeader@1016 : Record 6650;
      ServiceContractHeader@1017 : Record 5965;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Sales Qte.":
          IF "Version No." <> 0 THEN BEGIN
            SalesHeaderArchive.GET(
              SalesHeaderArchive."Document Type"::Quote,"Document No.",
              "Doc. No. Occurrence","Version No.");
            SalesHeaderArchive.SETRANGE("Document Type",SalesHeaderArchive."Document Type"::Quote);
            SalesHeaderArchive.SETRANGE("No.","Document No.");
            SalesHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
            PAGE.RUN(PAGE::"Sales Quote Archive",SalesHeaderArchive);
          END ELSE BEGIN
            SalesHeader.GET(SalesHeader."Document Type"::Quote,"Document No.");
            PAGE.RUN(PAGE::"Sales Quote",SalesHeader);
          END;
        "Document Type"::"Sales Blnkt. Ord":
          BEGIN
            IF "Version No." <> 0 THEN BEGIN
              SalesHeaderArchive.GET(SalesHeaderArchive."Document Type"::"Blanket Order","Document No.",
                "Doc. No. Occurrence","Version No.");
              SalesHeaderArchive.SETRANGE("Document Type",SalesHeaderArchive."Document Type"::"Blanket Order");
              SalesHeaderArchive.SETRANGE("No.","Document No.");
              SalesHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
              PAGE.RUN(PAGE::"Blanket Sales Order Archive",SalesHeaderArchive);
            END ELSE BEGIN
              SalesHeader.GET(SalesHeader."Document Type"::"Blanket Order","Document No.");
              PAGE.RUN(PAGE::"Blanket Sales Order",SalesHeader);
            END;
          END;
        "Document Type"::"Sales Ord. Cnfrmn.":
          IF "Version No." <> 0 THEN BEGIN
            SalesHeaderArchive.GET(
              SalesHeaderArchive."Document Type"::Order,"Document No.",
              "Doc. No. Occurrence","Version No.");
            SalesHeaderArchive.SETRANGE("Document Type",SalesHeaderArchive."Document Type"::Order);
            SalesHeaderArchive.SETRANGE("No.","Document No.");
            SalesHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
            PAGE.RUN(PAGE::"Sales Order Archive",SalesHeaderArchive);
          END ELSE BEGIN
            SalesHeader.GET(SalesHeader."Document Type"::Order,"Document No.");
            PAGE.RUN(PAGE::"Sales Order",SalesHeader);
          END;
        "Document Type"::"Sales Inv.":
          BEGIN
            SalesInvHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Sales Invoice",SalesInvHeader);
          END;
        "Document Type"::"Sales Shpt. Note":
          BEGIN
            SalesShptHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Sales Shipment",SalesShptHeader);
          END;
        "Document Type"::"Sales Cr. Memo":
          BEGIN
            SalesCrMemoHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Sales Credit Memo",SalesCrMemoHeader);
          END;
        "Document Type"::"Sales Stmnt.":
          ERROR(Text003);
        "Document Type"::"Sales Rmdr.":
          BEGIN
            IssuedReminderHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Issued Reminder",IssuedReminderHeader);
          END;
        "Document Type"::"Serv. Ord. Create":
          BEGIN
            ServHeader.GET(ServHeader."Document Type"::Order,"Document No.");
            PAGE.RUN(PAGE::"Service Order",ServHeader)
          END;
        "Document Type"::"Purch.Qte.":
          IF "Version No." <> 0 THEN BEGIN
            PurchHeaderArchive.GET(
              PurchHeaderArchive."Document Type"::Quote,"Document No.",
              "Doc. No. Occurrence","Version No.");
            PurchHeaderArchive.SETRANGE("Document Type",PurchHeaderArchive."Document Type"::Quote);
            PurchHeaderArchive.SETRANGE("No.","Document No.");
            PurchHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
            PAGE.RUN(PAGE::"Purchase Quote Archive",PurchHeaderArchive);
          END ELSE BEGIN
            PurchHeader.GET(PurchHeader."Document Type"::Quote,"Document No.");
            PAGE.RUN(PAGE::"Purchase Quote",PurchHeader);
          END;
        "Document Type"::"Purch. Blnkt. Ord.":
          BEGIN
            IF "Version No." <> 0 THEN BEGIN
              PurchHeaderArchive.GET(
                PurchHeaderArchive."Document Type"::"Blanket Order","Document No.",
                "Doc. No. Occurrence","Version No.");
              PurchHeaderArchive.SETRANGE("Document Type",PurchHeaderArchive."Document Type"::"Blanket Order");
              PurchHeaderArchive.SETRANGE("No.","Document No.");
              PurchHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
              PAGE.RUN(PAGE::"Blanket Purchase Order Archive",PurchHeaderArchive);
            END ELSE BEGIN
              PurchHeader.GET(PurchHeader."Document Type"::"Blanket Order","Document No.");
              PAGE.RUN(PAGE::"Blanket Purchase Order",PurchHeader);
            END;
          END;
        "Document Type"::"Purch. Ord.":
          IF "Version No." <> 0 THEN BEGIN
            PurchHeaderArchive.GET(
              PurchHeaderArchive."Document Type"::Order,"Document No.",
              "Doc. No. Occurrence","Version No.");
            PurchHeaderArchive.SETRANGE("Document Type",PurchHeaderArchive."Document Type"::Order);
            PurchHeaderArchive.SETRANGE("No.","Document No.");
            PurchHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
            PAGE.RUN(PAGE::"Purchase Order Archive",PurchHeaderArchive);
          END ELSE BEGIN
            PurchHeader.GET(PurchHeader."Document Type"::Order,"Document No.");
            PAGE.RUN(PAGE::"Purchase Order",PurchHeader);
          END;
        "Document Type"::"Purch. Inv.":
          BEGIN
            PurchInvHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Purchase Invoice",PurchInvHeader);
          END;
        "Document Type"::"Purch. Rcpt.":
          BEGIN
            PurchRcptHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Purchase Receipt",PurchRcptHeader);
          END;
        "Document Type"::"Purch. Cr. Memo":
          BEGIN
            PurchCrMemoHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Purchase Credit Memo",PurchCrMemoHeader);
          END;
        "Document Type"::"Cover Sheet":
          ERROR(Text004);
        "Document Type"::"Sales Return Order":
          IF SalesHeader.GET(SalesHeader."Document Type"::"Return Order","Document No.") THEN
            PAGE.RUN(PAGE::"Sales Return Order",SalesHeader)
          ELSE BEGIN
            ReturnRcptHeader.SETRANGE("Return Order No.","Document No.");
            PAGE.RUN(PAGE::"Posted Return Receipt",ReturnRcptHeader);
          END;
        "Document Type"::"Sales Finance Charge Memo":
          BEGIN
            IssuedFinChargeMemoHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Issued Finance Charge Memo",IssuedFinChargeMemoHeader);
          END;
        "Document Type"::"Sales Return Receipt":
          BEGIN
            ReturnReceiptHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Return Receipt",ReturnReceiptHeader);
          END;
        "Document Type"::"Purch. Return Shipment":
          BEGIN
            ReturnShipmentHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Return Shipment",ReturnShipmentHeader);
          END;
        "Document Type"::"Purch. Return Ord. Cnfrmn.":
          IF PurchHeader.GET(PurchHeader."Document Type"::"Return Order","Document No.") THEN
            PAGE.RUN(PAGE::"Purchase Return Order",PurchHeader)
          ELSE BEGIN
            ReturnShipmentHeader.SETRANGE("Return Order No.","Document No.");
            PAGE.RUN(PAGE::"Posted Return Shipment",ReturnShipmentHeader);
          END;
        "Document Type"::"Service Contract":
          BEGIN
            ServiceContractHeader.GET(ServiceContractHeader."Contract Type"::Contract,"Document No.");
            PAGE.RUN(PAGE::"Service Contract",ServiceContractHeader);
          END;
        "Document Type"::"Service Contract Quote":
          BEGIN
            ServiceContractHeader.GET(ServiceContractHeader."Contract Type"::Quote,"Document No.");
            PAGE.RUN(PAGE::"Service Contract Quote",ServiceContractHeader);
          END;
        "Document Type"::"Service Quote":
          BEGIN
            ServHeader.GET(ServHeader."Document Type"::Quote,"Document No.");
            PAGE.RUN(PAGE::"Service Quote",ServHeader);
          END;
      END;
    END;

    PROCEDURE EvaluateInteraction@9();
    VAR
      Selected@1000 : Integer;
    BEGIN
      IF FIND('-') THEN BEGIN
        Selected := DIALOG.STRMENU(Text011);
        IF Selected <> 0 THEN
          REPEAT
            Evaluation := Selected;
            MODIFY;
          UNTIL NEXT = 0
      END;
    END;

    PROCEDURE ResumeInteraction@11();
    VAR
      SegLine@1000 : TEMPORARY Record 5077;
      Cont@1006 : Record 5050;
      Salesperson@1005 : Record 13;
      Campaign@1004 : Record 5071;
      Todo@1003 : Record 5080;
      Opportunity@1002 : Record 5092;
      SegManagement@1001 : Codeunit 5051;
    BEGIN
      SegLine.DELETEALL;
      SegLine.INIT;
      SegManagement.CopyFieldsFromInteractLogEntry(SegLine,Rec);
      SegLine.VALIDATE(Date,WORKDATE);

      IF Todo.GET(GETFILTER("To-do No.")) THEN
        SegLine.SETRANGE("To-do No.",Todo."No.");
      IF Cont.GET(GETFILTER("Contact Company No.")) THEN
        SegLine.SETRANGE("Contact Company No.",Cont."No.");
      IF Cont.GET(GETFILTER("Contact No.")) THEN
        SegLine.SETRANGE("Contact No.",Cont."No.");
      IF Salesperson.GET(GETFILTER("Salesperson Code")) THEN
        SegLine.SETRANGE("Salesperson Code",Salesperson.Code);
      IF Campaign.GET(GETFILTER("Campaign No.")) THEN
        SegLine.SETRANGE("Campaign No.",Campaign."No.");
      IF Opportunity.GET(GETFILTER("Opportunity No.")) THEN
        SegLine.SETRANGE("Opportunity No.",Opportunity."No.");

      SegLine.StartWizard;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 5080 To-do
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=17:40:14;
    Modified=Yes;
    Version List=NAVW19.00,CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Description;
    OnInsert=BEGIN
               CMTaskMgt.OnInsert(Rec); //CM

               IF "No." = '' THEN BEGIN
                 RMSetup.GET;
                 RMSetup.TESTFIELD("To-do Nos.");
                 NoSeriesMgt.InitSeries(RMSetup."To-do Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
               IF (("System To-do Type" = "System To-do Type"::Organizer) AND
                   ("Team Code" = '')) OR
                  ("System To-do Type" = "System To-do Type"::Team)
               THEN
                 "Organizer To-do No." := "No.";
               "Last Date Modified" := TODAY;
               "Last Time Modified" := TIME;
             END;

    OnModify=BEGIN
               CMTaskMgt.OnModify(Rec,xRec); //CM

               IF "No." <> '' THEN BEGIN
                 "Last Date Modified" := TODAY;
                 "Last Time Modified" := TIME;

                 UpdateAttendeeTodos("No.");
               END;
             END;

    OnDelete=VAR
               Attendee@1001 : Record 5199;
               Todo@1000 : Record 5080;
               TodoInteractionLanguage@1002 : Record 5196;
             BEGIN
               CMTaskMgt.OnDelete(Rec); //CM

               RMCommentLine.SETRANGE("Table Name",RMCommentLine."Table Name"::"To-do");
               RMCommentLine.SETRANGE("No.","No.");
               RMCommentLine.DELETEALL;
               Todo.SETRANGE("Organizer To-do No.","No.");
               Todo.SETFILTER("No.",'<>%1',"No.");
               IF Todo.FINDFIRST THEN
                 Todo.DELETEALL;

               Attendee.SETRANGE("To-do No.","No.");
               Attendee.DELETEALL;

               TodoInteractionLanguage.SETRANGE("To-do No.","No.");
               TodoInteractionLanguage.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=To-do;
               DEA=Aufgabe];
    LookupPageID=Page5096;
    DrillDownPageID=Page5096;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  RMSetup.GET;
                                                                  NoSeriesMgt.TestManual(RMSetup."To-do Nos.");
                                                                  "No. Series" := '';
                                                                  IF ("System To-do Type" = "System To-do Type"::Organizer) OR
                                                                     ("System To-do Type" = "System To-do Type"::Team)
                                                                  THEN
                                                                    UpdateAttendeeTodos(xRec."No.");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              DEA=Nr.];
                                                   Description=CM }
    { 2   ;   ;Team Code           ;Code10        ;TableRelation=Team;
                                                   OnValidate=BEGIN
                                                                IF ("Team Code" <> xRec."Team Code") AND
                                                                   ("No." <> '') AND
                                                                   IsCalledFromForm
                                                                THEN BEGIN
                                                                  IF ("Team Code" = '') AND ("Salesperson Code" = '') THEN
                                                                    ERROR(Text035,FIELDCAPTION("Salesperson Code"),FIELDCAPTION("Team Code"));
                                                                  IF xRec."Team Code" <> '' THEN BEGIN
                                                                    IF Closed THEN BEGIN
                                                                      IF CONFIRM(STRSUBSTNO(Text039,"No.",xRec."Team Code","Team Code")) THEN BEGIN
                                                                        ChangeTeam;
                                                                        GET("No.");
                                                                        VALIDATE(Closed,FALSE);
                                                                      END ELSE
                                                                        "Team Code" := xRec."Team Code"
                                                                    END ELSE BEGIN
                                                                      IF CONFIRM(STRSUBSTNO(Text030,xRec."Team Code","Team Code")) THEN
                                                                        ChangeTeam
                                                                      ELSE
                                                                        "Team Code" := xRec."Team Code"
                                                                    END
                                                                  END ELSE BEGIN
                                                                    IF Closed THEN BEGIN
                                                                      IF CONFIRM(STRSUBSTNO(Text042,"No.","Team Code")) THEN BEGIN
                                                                        ReassignSalespersonTodoToTeam;
                                                                        GET("No.");
                                                                        VALIDATE(Closed,FALSE);
                                                                      END ELSE
                                                                        "Team Code" := ''
                                                                    END ELSE
                                                                      ReassignSalespersonTodoToTeam;
                                                                  END
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Team Code;
                                                              DEA=Teamcode] }
    { 3   ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                IF (xRec."Salesperson Code" <> "Salesperson Code") AND
                                                                   ("No." <> '') AND
                                                                   IsCalledFromForm
                                                                THEN BEGIN
                                                                  IF ("Team Code" = '') AND ("Salesperson Code" = '') THEN
                                                                    ERROR(Text035,FIELDCAPTION("Salesperson Code"),FIELDCAPTION("Team Code"));
                                                                  IF (Type = Type::Meeting) AND ("Team Code" = '') THEN
                                                                    ERROR(Text009,FIELDCAPTION("Salesperson Code"));

                                                                  IF "Team Code" <> '' THEN BEGIN
                                                                    IF Type = Type::Meeting THEN
                                                                      IF Closed THEN
                                                                        IF CONFIRM(STRSUBSTNO(Text040,"No.","Salesperson Code")) THEN BEGIN
                                                                          ReassignTeamTodoToSalesperson;
                                                                          GET("No.");
                                                                          VALIDATE(Closed,FALSE);
                                                                        END ELSE
                                                                          "Salesperson Code" := xRec."Salesperson Code"
                                                                      ELSE
                                                                        IF CONFIRM(STRSUBSTNO(Text033,"No.","Salesperson Code")) THEN
                                                                          ReassignTeamTodoToSalesperson
                                                                        ELSE
                                                                          "Salesperson Code" := xRec."Salesperson Code"
                                                                    ELSE
                                                                      IF Closed THEN
                                                                        IF CONFIRM(STRSUBSTNO(Text041,"No.","Salesperson Code")) THEN BEGIN
                                                                          ReassignTeamTodoToSalesperson;
                                                                          GET("No.");
                                                                          VALIDATE(Closed,FALSE);
                                                                        END ELSE
                                                                          "Salesperson Code" := xRec."Salesperson Code"
                                                                      ELSE
                                                                        IF CONFIRM(STRSUBSTNO(Text032,"No.","Salesperson Code")) THEN
                                                                          ReassignTeamTodoToSalesperson
                                                                        ELSE
                                                                          "Salesperson Code" := xRec."Salesperson Code"
                                                                  END
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Salesperson Code;
                                                              DEA=Verk„ufercode] }
    { 4   ;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   CaptionML=[ENU=Campaign No.;
                                                              DEA=Kampagnennr.] }
    { 5   ;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                AttendeeTemp@1000 : TEMPORARY Record 5199;
                                                              BEGIN
                                                                IF Cont.GET("Contact No.") THEN
                                                                  "Contact Company No." := Cont."Company No."
                                                                ELSE
                                                                  CLEAR("Contact Company No.");

                                                                IF ("No." <> '') AND
                                                                   ("No." = "Organizer To-do No.") AND
                                                                   ("Contact No." <> xRec."Contact No.") AND
                                                                   (Type <> Type::Meeting)
                                                                THEN
                                                                  CASE TRUE OF
                                                                    (xRec."Contact No." = '') AND ("Contact No." <> ''):
                                                                      BEGIN
                                                                        AttendeeTemp.CreateAttendee(
                                                                          AttendeeTemp,
                                                                          "No.",10000,AttendeeTemp."Attendance Type"::Required,
                                                                          AttendeeTemp."Attendee Type"::Contact,
                                                                          "Contact No.",FALSE);
                                                                        CreateSubTodo(AttendeeTemp,Rec);
                                                                      END;
                                                                    (xRec."Contact No." <> '') AND ("Contact No." = ''):
                                                                      BEGIN
                                                                        AttendeeTemp.CreateAttendee(
                                                                          AttendeeTemp,
                                                                          "No.",10000,AttendeeTemp."Attendance Type"::Required,
                                                                          AttendeeTemp."Attendee Type"::Contact,
                                                                          xRec."Contact No.",FALSE);
                                                                        DeleteAttendeeTodo(AttendeeTemp);
                                                                      END;
                                                                    xRec."Contact No." <> "Contact No.":
                                                                      BEGIN
                                                                        AttendeeTemp.CreateAttendee(
                                                                          AttendeeTemp,
                                                                          "No.",10000,AttendeeTemp."Attendance Type"::Required,
                                                                          AttendeeTemp."Attendee Type"::Contact,
                                                                          xRec."Contact No.",FALSE);
                                                                        DeleteAttendeeTodo(AttendeeTemp);
                                                                        AttendeeTemp.CreateAttendee(
                                                                          AttendeeTemp,
                                                                          "No.",20000,AttendeeTemp."Attendance Type"::Required,
                                                                          AttendeeTemp."Attendee Type"::Contact,
                                                                          "Contact No.",FALSE);
                                                                        CreateSubTodo(AttendeeTemp,Rec);
                                                                      END;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Contact No.;
                                                              DEA=Kontaktnr.] }
    { 6   ;   ;Opportunity No.     ;Code20        ;TableRelation=Opportunity;
                                                   OnValidate=VAR
                                                                OppEntry@1001 : Record 5093;
                                                              BEGIN
                                                                OppEntry.RESET;
                                                                OppEntry.SETCURRENTKEY(Active,"Opportunity No.");
                                                                OppEntry.SETRANGE(Active,TRUE);
                                                                OppEntry.SETRANGE("Opportunity No.","Opportunity No.");
                                                                IF OppEntry.FINDFIRST THEN
                                                                  "Opportunity Entry No." := OppEntry."Entry No."
                                                                ELSE
                                                                  "Opportunity Entry No." := 0;
                                                              END;

                                                   CaptionML=[ENU=Opportunity No.;
                                                              DEA=Verkaufschancennr.] }
    { 7   ;   ;Segment No.         ;Code20        ;TableRelation="Segment Header";
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Segment No.;
                                                              DEA=Segmentnr.] }
    { 8   ;   ;Type                ;Option        ;OnValidate=VAR
                                                                OldEndDate@1000 : Date;
                                                              BEGIN
                                                                IF "No." <> '' THEN BEGIN
                                                                  IF ((xRec.Type = Type::Meeting) AND (Type <> Type::Meeting)) OR
                                                                     ((xRec.Type <> Type::Meeting) AND (Type = Type::Meeting))
                                                                  THEN
                                                                    ERROR(Text012);
                                                                END ELSE BEGIN
                                                                  IF CurrFieldNo = 0 THEN
                                                                    EXIT;

                                                                  IF xRec.Type <> Type::Meeting THEN
                                                                    TempEndDateTime := CREATEDATETIME(xRec.Date,xRec."Start Time") - OneDayDuration + xRec.Duration
                                                                  ELSE
                                                                    TempEndDateTime := CREATEDATETIME(xRec.Date,xRec."Start Time") + xRec.Duration;

                                                                  OldEndDate := DT2DATE(TempEndDateTime);

                                                                  IF (xRec.Type = Type::Meeting) AND (Type <> Type::Meeting) THEN BEGIN
                                                                    "Start Time" := 0T;
                                                                    "All Day Event" := FALSE;
                                                                    SetDuration(OldEndDate,0T);
                                                                  END;

                                                                  IF (xRec.Type <> Type::Meeting) AND (Type = Type::Meeting) THEN BEGIN
                                                                    "Start Time" := 0T;
                                                                    IF OldEndDate = Date THEN BEGIN
                                                                      SetDuration(OldEndDate,DT2TIME(CREATEDATETIME(OldEndDate,0T) + 30 * 60 * 1000));
                                                                    END ELSE
                                                                      SetDuration(OldEndDate,0T);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              DEA=Art];
                                                   OptionCaptionML=[ENU=" ,Meeting,Phone Call";
                                                                    DEA=" ,Besprechung,Telefonat"];
                                                   OptionString=[ ,Meeting,Phone Call] }
    { 9   ;   ;Date                ;Date          ;OnValidate=BEGIN
                                                                IF (Date < 01011900D) OR (Date > 31122999D) THEN
                                                                  ERROR(Text006,01011900D,31122999D);

                                                                IF Date <> xRec.Date THEN
                                                                  GetEndDateTime;
                                                              END;

                                                   CaptionML=[ENU=Date;
                                                              DEA=Datum];
                                                   NotBlank=Yes }
    { 10  ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                IF Status = Status::Completed THEN
                                                                  VALIDATE(Closed,TRUE)
                                                                ELSE
                                                                  VALIDATE(Closed,FALSE);
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionCaptionML=[ENU=Not Started,In Progress,Completed,Waiting,Postponed;
                                                                    DEA=Nicht begonnen,In Bearbeitung,Erledigt,Warten,Zurckgestellt];
                                                   OptionString=Not Started,In Progress,Completed,Waiting,Postponed;
                                                   Description=CM }
    { 11  ;   ;Priority            ;Option        ;InitValue=Normal;
                                                   CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High;
                                                   Description=CM }
    { 12  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung];
                                                   Description=CM }
    { 13  ;   ;Closed              ;Boolean       ;OnValidate=BEGIN
                                                                IF Closed THEN BEGIN
                                                                  "Date Closed" := TODAY;
                                                                  Status := Status::Completed;
                                                                  IF NOT Canceled THEN BEGIN
                                                                    IF ("Team Code" <> '') AND
                                                                       ("Completed By" = '')
                                                                    THEN
                                                                      ERROR(STRSUBSTNO(Text029,FIELDCAPTION("Completed By")));
                                                                    IF CurrFieldNo <> 0 THEN
                                                                      IF CONFIRM(Text004,TRUE) THEN
                                                                        CreateInteraction
                                                                  END;
                                                                  IF Recurring THEN
                                                                    CreateRecurringTodo;
                                                                END ELSE BEGIN
                                                                  Canceled := FALSE;
                                                                  "Date Closed" := 0D;
                                                                  IF Status = Status::Completed THEN
                                                                    Status := Status::"In Progress";
                                                                  IF "Completed By" <> '' THEN
                                                                    "Completed By" := ''
                                                                END;
                                                                IF CurrFieldNo <> 0 THEN
                                                                  MODIFY(TRUE);
                                                              END;

                                                   CaptionML=[ENU=Closed;
                                                              DEA=Abgeschlossen] }
    { 14  ;   ;Date Closed         ;Date          ;CaptionML=[ENU=Date Closed;
                                                              DEA=Abgeschlossen am];
                                                   Editable=No }
    { 15  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              DEA=Nummernserie];
                                                   Editable=No }
    { 16  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Rlshp. Mgt. Comment Line" WHERE (Table Name=CONST(To-do),
                                                                                                       No.=FIELD(Organizer To-do No.),
                                                                                                       Sub No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung];
                                                   Editable=No }
    { 17  ;   ;Canceled            ;Boolean       ;OnValidate=BEGIN
                                                                IF Canceled AND NOT Closed THEN
                                                                  VALIDATE(Closed,TRUE);
                                                                IF (NOT Canceled) AND Closed THEN
                                                                  VALIDATE(Closed,FALSE);
                                                              END;

                                                   CaptionML=[ENU=Canceled;
                                                              DEA=Storniert] }
    { 18  ;   ;Contact Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact No.)));
                                                   CaptionML=[ENU=Contact Name;
                                                              DEA=Kontaktname];
                                                   Editable=No }
    { 19  ;   ;Team Name           ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Team.Name WHERE (Code=FIELD(Team Code)));
                                                   CaptionML=[ENU=Team Name;
                                                              DEA=Teamname];
                                                   NotBlank=No;
                                                   Editable=No }
    { 20  ;   ;Salesperson Name    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Salesperson Code)));
                                                   CaptionML=[ENU=Salesperson Name;
                                                              DEA=Verk„ufername];
                                                   Editable=No }
    { 21  ;   ;Campaign Description;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Campaign.Description WHERE (No.=FIELD(Campaign No.)));
                                                   CaptionML=[ENU=Campaign Description;
                                                              DEA=Kampagnenbeschreibung];
                                                   Editable=No }
    { 22  ;   ;Contact Company No. ;Code20        ;TableRelation=Contact WHERE (Type=CONST(Company));
                                                   CaptionML=[ENU=Contact Company No.;
                                                              DEA=Kontakt Unternehmensnr.] }
    { 23  ;   ;Contact Company Name;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact Company No.)));
                                                   CaptionML=[ENU=Contact Company Name;
                                                              DEA=Kontakt Unternehmensname];
                                                   Editable=No }
    { 24  ;   ;Recurring           ;Boolean       ;CaptionML=[ENU=Recurring;
                                                              DEA=Wiederkehrend];
                                                   Description=CM }
    { 25  ;   ;Recurring Date Interval;DateFormula;OnValidate=BEGIN
                                                                IF Recurring THEN
                                                                  TESTFIELD("Recurring Date Interval");
                                                              END;

                                                   CaptionML=[ENU=Recurring Date Interval;
                                                              DEA=Wiederholungsrate] }
    { 26  ;   ;Calc. Due Date From ;Option        ;OnValidate=BEGIN
                                                                IF Recurring THEN
                                                                  TESTFIELD("Calc. Due Date From");
                                                              END;

                                                   CaptionML=[ENU=Calc. Due Date From;
                                                              DEA=F„lligkeitsdatum berechnen von];
                                                   OptionCaptionML=[ENU=" ,Due Date,Closing Date";
                                                                    DEA=" ,F„lligkeitsdatum,Abschlussdatum"];
                                                   OptionString=[ ,Due Date,Closing Date] }
    { 27  ;   ;Opportunity Description;Text50     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Opportunity.Description WHERE (No.=FIELD(Opportunity No.)));
                                                   CaptionML=[ENU=Opportunity Description;
                                                              DEA=Verkaufschancenbeschreibung];
                                                   Editable=No }
    { 28  ;   ;Start Time          ;Time          ;OnValidate=BEGIN
                                                                IF "Start Time" <> xRec."Start Time" THEN
                                                                  GetEndDateTime;
                                                              END;

                                                   CaptionML=[ENU=Start Time;
                                                              DEA=Startzeit] }
    { 29  ;   ;Duration            ;Duration      ;OnValidate=BEGIN
                                                                IF Duration < 0 THEN
                                                                  ERROR(Text005);

                                                                IF Duration < (60 * 1000) THEN
                                                                  ERROR(Text007);

                                                                IF Duration > (CREATEDATETIME(TODAY + 3650,0T) - CREATEDATETIME(TODAY,0T)) THEN
                                                                  ERROR(Text008);

                                                                IF Duration <> xRec.Duration THEN
                                                                  GetEndDateTime;
                                                              END;

                                                   CaptionML=[ENU=Duration;
                                                              DEA=Dauer];
                                                   Description=CM }
    { 31  ;   ;Opportunity Entry No.;Integer      ;TableRelation="Opportunity Entry";
                                                   CaptionML=[ENU=Opportunity Entry No.;
                                                              DEA=Verkaufschancenposten Lfd. Nr.] }
    { 32  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              DEA=Korrigiert am] }
    { 33  ;   ;Last Time Modified  ;Time          ;CaptionML=[ENU=Last Time Modified;
                                                              DEA=Korrigiert um] }
    { 34  ;   ;All Day Event       ;Boolean       ;OnValidate=BEGIN
                                                                IF "All Day Event" THEN BEGIN
                                                                  "Start Time" := 0T;
                                                                  TempStartDateTime := CREATEDATETIME(Date,"Start Time");
                                                                  TempEndDateTime := TempStartDateTime + Duration;
                                                                  IF DT2DATE(TempEndDateTime) = Date THEN
                                                                    Duration := 1440 * 1000 * 60
                                                                  ELSE
                                                                    Duration := ROUNDDATETIME(TempEndDateTime + 1,1440 * 1000 * 60,'>') - TempStartDateTime;
                                                                END ELSE
                                                                  Duration := Duration - 1440 * 1000 * 60;
                                                              END;

                                                   CaptionML=[ENU=All Day Event;
                                                              DEA=Ganzt„giges Ereignis] }
    { 35  ;   ;Location            ;Text50        ;CaptionML=[ENU=Location;
                                                              DEA=Ort] }
    { 36  ;   ;Organizer To-do No. ;Code20        ;TableRelation=To-do;
                                                   CaptionML=[ENU=Organizer To-do No.;
                                                              DEA=Organisatoraufgabennr.] }
    { 37  ;   ;Interaction Template Code;Code10   ;TableRelation="Interaction Template";
                                                   OnValidate=VAR
                                                                TodoInteractionLanguage@1000 : Record 5196;
                                                                Attachment@1001 : Record 5062;
                                                              BEGIN
                                                                IF "No." <> '' THEN
                                                                  UpdateInteractionTemplate(
                                                                    Rec,TodoInteractionLanguage,Attachment,"Interaction Template Code",FALSE);
                                                              END;

                                                   CaptionML=[ENU=Interaction Template Code;
                                                              DEA=Aktivit„tenvorlagencode];
                                                   Description=CM }
    { 38  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=VAR
                                                                TodoInteractionLanguage@1000 : Record 5196;
                                                              BEGIN
                                                                IF CurrFieldNo <> 0 THEN
                                                                  MODIFY;

                                                                IF "Language Code" = xRec."Language Code" THEN
                                                                  EXIT;

                                                                IF NOT TodoInteractionLanguage.GET("No.","Language Code") THEN BEGIN
                                                                  IF "No." = '' THEN
                                                                    EXIT;
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    IF CONFIRM(Text010,TRUE,TodoInteractionLanguage.TABLECAPTION,"Language Code") THEN BEGIN
                                                                      TodoInteractionLanguage.INIT;
                                                                      TodoInteractionLanguage."To-do No." := "No.";
                                                                      TodoInteractionLanguage."Language Code" := "Language Code";
                                                                      TodoInteractionLanguage.Description := FORMAT("Interaction Template Code") + ' ' + FORMAT("Language Code");
                                                                      TodoInteractionLanguage.INSERT(TRUE);
                                                                      "Attachment No." := 0;
                                                                      MODIFY;
                                                                    END ELSE
                                                                      ERROR('');
                                                                END ELSE
                                                                  "Attachment No." := TodoInteractionLanguage."Attachment No.";
                                                              END;

                                                   OnLookup=VAR
                                                              TodoInteractionLanguage@1000 : Record 5196;
                                                            BEGIN
                                                              MODIFY;
                                                              COMMIT;

                                                              TodoInteractionLanguage.SETRANGE("To-do No.","Organizer To-do No.");
                                                              IF TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN;
                                                              IF PAGE.RUNMODAL(0,TodoInteractionLanguage) = ACTION::LookupOK THEN BEGIN
                                                                IF ("System To-do Type" = "System To-do Type"::Organizer) OR
                                                                   ("System To-do Type" = "System To-do Type"::Team)
                                                                THEN
                                                                  IF NOT TodoInteractionLanguage.ISEMPTY THEN BEGIN
                                                                    "Language Code" := TodoInteractionLanguage."Language Code";
                                                                    "Attachment No." := TodoInteractionLanguage."Attachment No.";
                                                                  END ELSE BEGIN
                                                                    "Language Code" := '';
                                                                    "Attachment No." := 0;
                                                                  END;
                                                              END ELSE
                                                                IF NOT TodoInteractionLanguage.ISEMPTY THEN BEGIN
                                                                  IF "Language Code" = TodoInteractionLanguage."Language Code" THEN
                                                                    "Attachment No." := TodoInteractionLanguage."Attachment No.";
                                                                END ELSE BEGIN
                                                                  "Language Code" := '';
                                                                  "Attachment No." := 0;
                                                                END;
                                                            END;

                                                   CaptionML=[ENU=Language Code;
                                                              DEA=Sprachcode] }
    { 39  ;   ;Attachment No.      ;Integer       ;CaptionML=[ENU=Attachment No.;
                                                              DEA=Dateianhangsnr.] }
    { 40  ;   ;Subject             ;Text50        ;OnValidate=BEGIN
                                                                IF CurrFieldNo <> 0 THEN
                                                                  MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Subject;
                                                              DEA=Betreff] }
    { 41  ;   ;Unit Cost (LCY)     ;Decimal       ;OnValidate=BEGIN
                                                                IF CurrFieldNo <> 0 THEN
                                                                  MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Unit Cost (LCY);
                                                              DEA=Einstandspreis (MW)];
                                                   DecimalPlaces=2:2 }
    { 42  ;   ;Unit Duration (Min.);Decimal       ;OnValidate=BEGIN
                                                                IF CurrFieldNo <> 0 THEN
                                                                  MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Unit Duration (Min.);
                                                              DEA=Vorgabedauer (Min.)];
                                                   DecimalPlaces=0:2 }
    { 43  ;   ;No. of Attendees    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Attendee WHERE (To-do No.=FIELD(Organizer To-do No.)));
                                                   CaptionML=[ENU=No. of Attendees;
                                                              DEA=Anzahl Teilnehmer];
                                                   Editable=No }
    { 44  ;   ;Attendees Accepted No.;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count(Attendee WHERE (To-do No.=FIELD(Organizer To-do No.),
                                                                                     Invitation Response Type=CONST(Accepted)));
                                                   CaptionML=[ENU=Attendees Accepted No.;
                                                              DEA=Anzahl Teilnehmerzusagen];
                                                   Editable=No }
    { 45  ;   ;System To-do Type   ;Option        ;CaptionML=[ENU=System To-do Type;
                                                              DEA=Systemaufgabenart];
                                                   OptionCaptionML=[ENU=Organizer,Salesperson Attendee,Contact Attendee,Team;
                                                                    DEA=Organisator,Teilnehmer Verk„ufer,Teilnehmer Kontakt,Team];
                                                   OptionString=Organizer,Salesperson Attendee,Contact Attendee,Team }
    { 46  ;   ;Completed By        ;Code10        ;TableRelation=Salesperson/Purchaser.Code;
                                                   OnValidate=BEGIN
                                                                IF (xRec."Completed By" = '') AND
                                                                   ("Completed By" <> '')
                                                                THEN
                                                                  IF CONFIRM(Text034) THEN
                                                                    VALIDATE(Closed,TRUE)
                                                                  ELSE
                                                                    "Completed By" := '';
                                                              END;

                                                   CaptionML=[ENU=Completed By;
                                                              DEA=Abgeschlossen von] }
    { 47  ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                IF "Ending Date" <> xRec."Ending Date" THEN
                                                                  SetDuration("Ending Date","Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              DEA=Enddatum] }
    { 48  ;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                IF "Ending Time" <> xRec."Ending Time" THEN
                                                                  SetDuration("Ending Date","Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Time;
                                                              DEA=Endzeit] }
    { 9501;   ;Wizard Step         ;Option        ;CaptionML=[ENU=Wizard Step;
                                                              DEA=Assistentenschritt];
                                                   OptionCaptionML=[ENU=" ,1,2,3,4,5,6";
                                                                    DEA=" ,1,2,3,4,5,6"];
                                                   OptionString=[ ,1,2,3,4,5,6];
                                                   Editable=No }
    { 9504;   ;Team To-do          ;Boolean       ;CaptionML=[ENU=Team To-do;
                                                              DEA=Teamaufgabe] }
    { 9505;   ;Send on finish      ;Boolean       ;CaptionML=[ENU=Send on finish;
                                                              DEA=Nach Abschluss senden] }
    { 9506;   ;Segment Description ;Text50        ;CaptionML=[ENU=Segment Description;
                                                              DEA=Segmentbeschreibung] }
    { 9507;   ;Team Meeting Organizer;Code20      ;CaptionML=[ENU=Team Meeting Organizer;
                                                              DEA=Organisator der Teambesprechung] }
    { 9508;   ;Activity Code       ;Code10        ;TableRelation=Activity.Code;
                                                   CaptionML=[ENU=Activity Code;
                                                              DEA=Aktionscode] }
    { 9509;   ;Wizard Contact Name ;Text50        ;CaptionML=[ENU=Wizard Contact Name;
                                                              DEA=Assistent fr Kontaktname] }
    { 9510;   ;Wizard Campaign Description;Text50 ;CaptionML=[ENU=Wizard Campaign Description;
                                                              DEA=Assistent fr Kampagnenbeschreibung] }
    { 9511;   ;Wizard Opportunity Description;Text50;
                                                   CaptionML=[ENU=Wizard Opportunity Description;
                                                              DEA=Assistent fr Verkaufschancenbeschreibung] }
    { 50000;  ;CM Type             ;Option        ;CaptionML=[ENU=CMMS Type;
                                                              DEA=CMMS Typ];
                                                   OptionString=[ ,Task,Request] }
    { 50001;  ;CM Extended Description;Text250    ;CaptionML=[ENU=Extended Description;
                                                              DEA=Erweiterte Beschreibung] }
    { 50010;  ;CM Source           ;Option        ;CaptionML=[ENU=Source;
                                                              DEA=Herkunft];
                                                   OptionString=Standard,Interface,Recuring,Request }
    { 50020;  ;CM Source No.       ;Integer       ;CaptionML=[ENU=Source Nr.;
                                                              DEA=Herkunftnr.] }
    { 50030;  ;CM Created Datetime ;DateTime       }
    { 50090;  ;CM Subtype          ;Option        ;CaptionML=[ENU=Subtype;
                                                              DEA=Subtyp];
                                                   OptionString=[ ,Checklist,Team] }
    { 50100;  ;CM Request Type     ;Option        ;CaptionML=[ENU=Request Type;
                                                              DEA=Anfragetyp];
                                                   OptionString=New Project,Start Plant Onboarding,Fault rectification,Sales and Marketing,After Sales and Customer Request,Contracts and Legal,Internal Project,Organisatory Task,Request to IT,Finance and Accounting,Human Resources,Quality Health and Safety,Improvement suggestion,CMMS Support request }
    { 50110;  ;CM Transf. to Workorder No.;Code20 ;TableRelation=Opportunity.No. WHERE (CM Is Workorder=CONST(Yes));
                                                   CaptionML=[ENU=Transfered to Workorder No.;
                                                              DEA=Transferiert zu Arbeitsauftragnr.] }
    { 50120;  ;CM Transf. to Task No.;Code20      ;TableRelation=To-do.No. WHERE (CM Type=CONST(Task));
                                                   CaptionML=[ENU=Transfered to Task No.;
                                                              DEA=Transferiert zu Aufgabennr.] }
    { 50210;  ;CM Maintask No.     ;Code20        ;CaptionML=[ENU=Maintask No.;
                                                              DEA=Hauptaufgabe Nr.];
                                                   Description=Applies to Checklist }
    { 50220;  ;CM Maintask Status  ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(To-do."CM Status" WHERE (No.=FIELD(CM Maintask No.)));
                                                   OptionString=Open,Done Positive,Done Negative,Closed;
                                                   Description=FF;
                                                   Editable=No }
    { 50300;  ;CM Status           ;Option        ;CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionString=Open,Done Positive,Done Negative,Closed }
    { 50301;  ;CM Checklist Status (Helper);Option;OptionString=---,Yes,No,Not Applicable }
    { 50310;  ;CM Automatically Closed;Boolean    ;CaptionML=[ENU=Automatically Closed;
                                                              DEA=Automatisch Geschlossen] }
    { 50400;  ;CM Scheduled Date   ;Date          ;CaptionML=[ENU=Scheduled Date;
                                                              DEA=Geplantes Datum] }
    { 50410;  ;CM Scheduled Time   ;Time          ;CaptionML=[ENU=Scheduled Time;
                                                              DEA=Geplante Zeit] }
    { 50430;  ;CM Due Date         ;Date          ;CaptionML=[ENU=Due Date;
                                                              DEA=F„llig Am] }
    { 50500;  ;CM Duration (Planned);Duration     ;CaptionML=[ENU=Duration (Planned);
                                                              DEA=Dauer (Geplant)] }
    { 50700;  ;CM Assigned User ID ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                CMTaskMgt.ChangeAssignedUserID(Rec, Rec."CM Assigned User ID", xRec."CM Assigned User ID", FALSE);
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              DEA=Zugewiesener Benutzer ID] }
    { 50705;  ;CM Assigned User Name;Text80       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(CM Assigned User ID)));
                                                   CaptionML=[ENU=Assigned User Name;
                                                              DEA=Zugwiesener Benutzername];
                                                   Description=FF;
                                                   Editable=No }
    { 50710;  ;CM Created By User ID;Code50       ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=Created By User ID;
                                                              DEA=Erstellt von Benutzer ID] }
    { 50715;  ;CM Created By User Name;Text50     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(CM Created By User ID)));
                                                   CaptionML=[ENU=Created By User Name;
                                                              DEA=Erstellt von Benutzer Name];
                                                   Description=FF;
                                                   Editable=No }
    { 50800;  ;CM Comment Text     ;Text250       ;CaptionML=[ENU=Comment Text;
                                                              DEA=Kommentar Text] }
    { 50890;  ;CM Objecttype       ;Option        ;CaptionML=[ENU=Objecttype;
                                                              DEA=Objeckttyp];
                                                   OptionString=Asset,Project }
    { 50900;  ;CM Object No.       ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=FIELD(CM Objecttype));
                                                   CaptionML=[ENU=Asset/Project No.;
                                                              DEA=Anlagen/Projectnr.] }
    { 50901;  ;CM Object Name      ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object".Name WHERE (Objecttype=FIELD(CM Objecttype),
                                                                                                No.=FIELD(CM Object No.)));
                                                   CaptionML=[ENU=Object Name;
                                                              DEA=Objektname];
                                                   Description=FF;
                                                   Editable=No }
    { 50905;  ;CM From Task No.    ;Code20        ;TableRelation=To-do.No. WHERE (CM Type=CONST(Task));
                                                   CaptionML=[ENU=From Task No.;
                                                              DEA=Von Aufgabe Nr.];
                                                   Description=Applies to Requests only }
    { 50910;  ;CM Workorder Description;Text50    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Opportunity.Description WHERE (No.=FIELD(Opportunity No.)));
                                                   CaptionML=[ENU=Workorder Description;
                                                              DEA=Arbeitsauftrag Beschreibung];
                                                   Description=FF;
                                                   Editable=No }
    { 50920;  ;CM Workoder Status  ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Opportunity."CM Status" WHERE (No.=FIELD(Opportunity No.)));
                                                   CaptionML=[ENU=Workorder Status;
                                                              DEA=Arbeitsauftrag Status];
                                                   OptionString=New,Open,In Process,Completed,Done,Discarded;
                                                   Description=FF;
                                                   Editable=No }
    { 50990;  ;CM Has Checklist    ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (CM Maintask No.=FIELD(No.),
                                                                                  CM Type=CONST(Task),
                                                                                  CM Subtype=CONST(Checklist)));
                                                   Description=FF }
    { 50991;  ;CM Has Team         ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (CM Maintask No.=FIELD(No.),
                                                                                  CM Type=CONST(Task),
                                                                                  CM Subtype=CONST(Team)));
                                                   Description=FF }
    { 50992;  ;CM User In Team     ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (CM Type=CONST(Task),
                                                                                  CM Subtype=CONST(Team),
                                                                                  CM Maintask No.=FIELD(No.),
                                                                                  CM Assigned User ID=FIELD(CM User In Team Filter)));
                                                   Description=FF;
                                                   Editable=No }
    { 50993;  ;CM User In Team Filter;Code50      ;FieldClass=FlowFilter;
                                                   Description=FFilter;
                                                   Editable=No }
    { 51000;  ;CM Interaction Template Code;Code10;TableRelation="Interaction Template".Code }
    { 51010;  ;CM Wizard Action    ;Option        ;CaptionML=[ENU=Wizard Action;
                                                              DEA=Aktion des Assistenten];
                                                   OptionCaptionML=[ENU=" ,Open,Import,,,,,Information";
                                                                    DEA=" ,Dateianhang ”ffnen,Dateianhang importieren,,,,,Information"];
                                                   OptionString=[ ,Open,Import,,,,,Information] }
    { 51020;  ;CM Information Type ;Option        ;CaptionML=[ENU=Information Type;
                                                              DEA=Information Typ];
                                                   OptionCaptionML=[ENU=" ,Comment,Comment (long),,,,,,,,Replacement,Installation";
                                                                    DEA=" ,Kommentar,Kommentar (lang),,,,,,,,Austausch,Installation"];
                                                   OptionString=[ ,Comment,Comment (long),,,,,,,,Replacement,Installation] }
    { 51030;  ;CM Interaction Group Code;Code10   ;TableRelation="Interaction Group";
                                                   CaptionML=[ENU=Interaction Group Code;
                                                              DEA=Aktivit„tengruppencode];
                                                   NotBlank=Yes }
    { 60000;  ;CM Creation Type    ;Option        ;CaptionML=[ENU=Creation Type;
                                                              DEA=Art der Erstellung];
                                                   OptionCaptionML=[ENU=Manual,Workorder Type,Request;
                                                                    DEA=Manuell,Arbeitsauftrag Typ,Anfrage];
                                                   OptionString=Manual,Workorder Type,Request }
    { 60100;  ;CM Internal         ;Boolean       ;CaptionML=[ENU=Internal;
                                                              DEA=Intern] }
    { 70000;  ;CM Is Temporary     ;Boolean       ;CaptionML=[ENU=Is Temporary;
                                                              DEA=Ist Tempor„r] }
    { 70010;  ;CM Selected         ;Boolean       ;CaptionML=[ENU=Selected;
                                                              DEA=Ausgew„hlt] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Contact Company No.,Date,Contact No.,Closed }
    {    ;Contact Company No.,Contact No.,Closed,Date }
    {    ;Salesperson Code,Date,Closed             }
    {    ;Team Code,Date,Closed                    }
    {    ;Campaign No.,Date                        }
    {    ;Segment No.,Date                         }
    {    ;Opportunity No.,Date,Closed              }
    {    ;Organizer To-do No.,System To-do Type    }
    {    ;Opportunity No.,CM Type,CM Assigned User ID,CM Status }
    {    ;CM Type,CM Maintask No.,CM Assigned User ID,CM Status }
    {    ;CM Type,CM Objecttype,CM Object No.      }
    {    ;CM Type,CM Objecttype,CM Object No.,CM Source,CM Source No.,Date }
    {    ;CM Type,Opportunity No.,No.              }
    {    ;CM Type,CM Subtype,Opportunity No.,No.   }
    {    ;CM Type,Opportunity No.,CM Subtype,CM Status,No. }
    {    ;CM Type,CM Subtype,CM Maintask No.,No.   }
    {    ;CM Type,CM Subtype,CM Status,CM Due Date,Priority }
    {    ;CM Type,CM Subtype,CM Status,Priority,CM Due Date }
    {    ;CM Type,CM Subtype,CM Status,CM Due Date,CM Assigned User ID }
    {    ;CM Type,CM Subtype,CM Status,CM Due Date,CM Objecttype,CM Object No. }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Description,Status                   }
    { 2   ;Brick               ;CM Assigned User ID,Description,CM Status,Priority,CM Request Type }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=%1 must be specified.;DEA=%1 muss angegeben werden.';
      Text001@1001 : TextConst 'ENU=%1 No. %2 has been created from recurring %3 %4.;DEA=%1 Nr. %2 wurde ausgehend von der wiederkehrenden %3 %4 erstellt.';
      Text002@1002 : TextConst 'ENU=Do you want to create a to-do for all contacts in the %1 segment;DEA=M”chten Sie eine Aufgabe fr alle Kontakte in Segment %1 erstellen?';
      Text003@1003 : TextConst 'ENU=Do you want to assign an activity to all contacts in the %1 segment;DEA=M”chten Sie allen Kontakten in Segment %1 eine Aktion zuordnen?';
      RMSetup@1004 : Record 5079;
      Cont@1005 : Record 5050;
      RMCommentLine@1006 : Record 5061;
      Salesperson@1021 : Record 13;
      Activity@1069 : Record 5081;
      Campaign@1059 : Record 5071;
      Team@1050 : Record 5083;
      Opp@1041 : Record 5092;
      SegHeader@1040 : Record 5076;
      AttendeeTemp@1039 : TEMPORARY Record 5199;
      SalesPurchPerson@1038 : Record 13;
      TodoInteractionLanguage@1037 : TEMPORARY Record 5196;
      AttachmentTemp@1026 : TEMPORARY Record 5062;
      RMCommentLineTmp@1024 : TEMPORARY Record 5061;
      NoSeriesMgt@1007 : Codeunit 396;
      Text004@1008 : TextConst 'ENU=Do you want to register an interaction log entry?;DEA=M”chten Sie einen Aktivit„tenprotokollposten erfassen?';
      TempEndDateTime@1012 : DateTime;
      Text005@1013 : TextConst 'ENU=Information that you have entered in this field will cause the duration to be negative which is not allowed. Please modify the ending date/time value.;DEA=Die von Ihnen in dieses Feld eingegebenen Daten resultieren in einer negativen Dauer, was unzul„ssig ist. Žndern Sie den Wert von Enddatum und/oder Endzeit.';
      TempStartDateTime@1014 : DateTime;
      Text006@1015 : TextConst 'ENU=The valid range of dates is from %1 to %2. Please enter a date within this range.;DEA=Der gltige Datumsbereich reicht vom %1 bis zum %2. Bitte geben Sie ein Datum ein, das innerhalb dieses Zeitraums liegt.';
      Text007@1016 : TextConst 'ENU=Information that you have entered in this field will cause the duration to be less than 1 minute, which is not allowed. Please modify the ending date/time value.;DEA=Die von Ihnen in dieses Feld eingegebenen Daten resultieren in einer Dauer von weniger als einer Minute, was unzul„ssig ist. Žndern Sie den Wert von Enddatum und/oder Endzeit.';
      Text008@1017 : TextConst 'ENU=Information that you have entered in this field will cause the duration to be more than 10 years, which is not allowed. Please modify the ending date/time value.;DEA=Die von Ihnen in dieses Feld eingegebenen Daten resultieren in einer Dauer von mehr als zehn Jahren, was unzul„ssig ist. Žndern Sie den Wert von Enddatum und/oder Endzeit.';
      Text009@1022 : TextConst 'ENU=You cannot change the %1 for this to-do, because this salesperson is the meeting organizer.;DEA=Sie k”nnen den %1 fr diese Aufgabe nicht „ndern, da dieser Verk„ufer der Organisator der Besprechung ist.';
      Text010@1023 : TextConst 'ENU=Do you want to create a new %2 value in %1 for this to-do?;DEA=M”chten Sie einen neuen %2-Wert in %1 fr diese Aufgabe erstellen?';
      Text012@1025 : TextConst 'ENU=You cannot change a to-do type from Blank or Phone Call to Meeting and vice versa. You can only change a to-do type from Blank to Phone Call or from Phone Call to Blank.;DEA=Sie k”nnen die Aufgabenart nicht von "leer" oder Telefonat in Besprechung „ndern oder umgekehrt. Es ist nur m”glich, die Aufgabeart von "leer" in Telefonat oder von Telefonat in "leer" zu „ndern.';
      Text015@1029 : TextConst 'ENU=Dear %1,;DEA=Sehr geehrte(r) %1,';
      Text016@1030 : TextConst '@@@="%1 = To-Do Date,%2 = To-Do StartTime,%3=To-Do location";ENU=You are cordially invited to attend the meeting, which will take place on %1, %2 at %3.;DEA=Sie sind herzlich zu unserer Besprechung eingeladen. Datum: %1, Uhrzeit: %2, Ort: %3.';
      Text017@1028 : TextConst 'ENU=Yours sincerely,;DEA=Mit freundlichen Gráen';
      Text018@1031 : TextConst 'ENU=The %1 check box is not selected.;DEA=Das Kontrollk„stchen %1 wurde nicht aktiviert.';
      Text019@1032 : TextConst 'ENU=Send invitations to all Attendees with selected %1 check boxes.;DEA=Einladungen an alle Teilnehmer mit aktiviertem Kontrollk„stchen %1 senden.';
      Text020@1033 : TextConst 'ENU=Send invitations to Attendees who have not been sent invitations yet.;DEA=Einladungen an alle Teilnehmer ohne bereits erhaltene Einladung senden.';
      Text021@1034 : TextConst 'ENU=Do not send invitations.;DEA=Keine Einladungen senden.';
      Text022@1035 : TextConst 'ENU=Invitations have already been sent to Attendees with selected %1 check boxes. Do you want to resend the invitations?;DEA=Teilnehmer, fr die das Kontrollk„stchen %1 aktiviert wurde, haben bereits Einladungen erhalten. M”chten Sie die Einladungen erneut senden?';
      Text023@1036 : TextConst 'ENU=Outlook failed to send an invitation to %1.;DEA=Outlook konnte keine Einladung an %1 senden.';
      Text029@1042 : TextConst 'ENU=The %1 field must be filled in for to-dos assigned to a team.;DEA=Das Feld %1 muss fr Aufgaben ausgefllt werden, die einem Team zugewiesen sind.';
      Text030@1043 : TextConst 'ENU=The to-dos of the %1 team members who do not belong to the %2 team will be deleted. Do you want to continue?;DEA=Die Aufgaben der %1 Teammitglieder, die nicht dem %2 Team angeh”ren, werden gel”scht. Soll der Vorgang fortgesetzt werden?';
      Text032@1045 : TextConst 'ENU=To-do no. %1 will be reassigned to %2 and the corresponding salesperson to-dos for team members will be deleted. Do you want to continue?;DEA=Aufgabennr. %1 wird %2 neu zugewiesen, und die entsprechenden Verk„uferaufgaben fr Teammitglieder werden gel”scht. Soll der Vorgang fortgesetzt werden?';
      Text033@1046 : TextConst 'ENU=To-do no. %1 will be reassigned to %2. Do you want to continue?;DEA=Aufgabennr. %1 wird %2 neu zugewiesen. Soll der Vorgang fortgesetzt werden?';
      Text034@1047 : TextConst 'ENU=Do you want to close the to-do?;DEA=Soll die Aufgabe geschlossen werden?';
      Text035@1027 : TextConst 'ENU=You must fill in either the %1 field or the %2 field.;DEA=Sie mssen entweder in Feld %1 oder in Feld %2 einen Wert eingeben.';
      Text036@1049 : TextConst 'ENU=Creating to-dos...\;DEA=Aufgaben werden erstellt...\';
      Text037@1048 : TextConst 'ENU=To-do No. #1##############\;DEA=Aufgabenr. #1##############\';
      Text038@1044 : TextConst 'ENU=Status    @2@@@@@@@@@@@@@@;DEA=Status     @2@@@@@@@@@@@@@@';
      Text039@1051 : TextConst 'ENU=To-do no. %1 is closed and will be reopened. The to-dos of the %2 team members who do not belong to the %3 team will be deleted. Do you want to continue?;DEA=Aufgabennr. %1 ist abgeschlossen und wird erneut ge”ffnet. Die Aufgaben der %2 Teammitglieder, die nicht dem Team %3 angeh”ren, werden gel”scht. Soll der Vorgang fortgesetzt werden?';
      Text040@1052 : TextConst 'ENU=To-do no. %1 is closed and will be reopened. It will be reassigned to %2, and the corresponding salesperson to-dos for team members will be deleted. Do you want to continue?;DEA=Aufgabennr. %1 ist abgeschlossen und wird erneut ge”ffnet. Die Aufgabe wird %2 erneut zugewiesen, und die entsprechenden Verk„uferaufgaben fr Teammitglieder werden gel”scht. Soll der Vorgang fortgesetzt werden?';
      Text041@1053 : TextConst 'ENU=To-do no. %1 is closed. It will be reopened and reassigned to %2. Do you want to continue?;DEA=Aufgabennr. %1 ist abgeschlossen. Sie wird erneut ge”ffnet und %2 neu zugewiesen. Soll der Vorgang fortgesetzt werden?';
      Text042@1054 : TextConst 'ENU=To-do no. %1 is closed. Do you want to reopen it and assign to the %2 team?;DEA=Aufgabennr. %1 ist abgeschlossen. Soll sie neu ge”ffnet und Team %2 zugewiesen werden?';
      SalespersonFilter@1058 : Code[10];
      ContactFilter@1057 : Code[20];
      Text043@1068 : TextConst 'ENU=You must fill in the %1 field.;DEA=Sie mssen das Feld %1 ausfllen.';
      Text047@1072 : TextConst 'ENU=You cannot use the wizard to create an attachment. You can create an attachment in the Interaction Template window.;DEA=Sie k”nnen den Assistenten nicht fr die Erstellung eines Dateianhangs verwenden. Einen Dateianhang k”nnen Sie im Fenster Aktivit„tenvorlage erstellen.';
      Text051@1077 : TextConst 'ENU=Activity Code;DEA=Aktionscode';
      Text053@1076 : TextConst 'ENU=You must specify %1 or %2.;DEA=Sie mssen %1 oder %2 angeben.';
      Text056@1073 : TextConst 'ENU=Activity %1 contains to-dos of type Meeting. You must fill in the Meeting Organizer field.;DEA=Aktion %1 enth„lt Aufgaben des Typs "Besprechung". Sie mssen einen Organisator fr die Besprechung eingeben.';
      Text065@1083 : TextConst 'ENU=You must specify the to-do organizer.;DEA=Geben Sie den Organisator an.';
      Text067@1019 : TextConst 'ENU=The %1 must contain an attachment if you want to send an invitation to an %2 of the contact type.;DEA=Wenn Sie eine Einladung an ''%2'' vom Typ ''Kontakt'' senden m”chten, muss ''%1'' einen Dateianhang enthalten.';
      Text068@1080 : TextConst 'ENU=You cannot select the Send invitation(s) on Finish check box, because none of the %1 check boxes are selected.;DEA=Sie k”nnen das Feld ''Einladung(en) versenden, wenn auf Beenden geklickt wird'' nicht aktivieren, da keines der Felder fr %1 ausgew„hlt wurde.';
      RunFormCode@1020 : Boolean;
      CMTaskMgt@1000000000 : Codeunit 70031;

    PROCEDURE CreateToDoFromToDo@1(VAR ToDo@1000 : Record 5080);
    VAR
      Cont@1001 : Record 5050;
      SalesPurchPerson@1002 : Record 13;
      Team@1003 : Record 5083;
      Campaign@1004 : Record 5071;
      Opp@1005 : Record 5092;
      SegHeader@1006 : Record 5076;
    BEGIN
      DELETEALL;
      INIT;
      IF ToDo.GETFILTER("Contact Company No.") <> '' THEN
        IF Cont.GET(ToDo.GETRANGEMIN("Contact Company No.")) THEN BEGIN
          VALIDATE("Contact No.",Cont."No.");
          "Salesperson Code" := Cont."Salesperson Code";
          SETRANGE("Contact Company No.","Contact No.");
        END;
      IF Cont.GET(ToDo.GETFILTER("Contact No.")) THEN BEGIN
        VALIDATE("Contact No.",Cont."No.");
        "Salesperson Code" := Cont."Salesperson Code";
        SETRANGE("Contact No.","Contact No.");
      END;
      IF SalesPurchPerson.GET(ToDo.GETFILTER("Salesperson Code")) THEN BEGIN
        "Salesperson Code" := SalesPurchPerson.Code;
        SETRANGE("Salesperson Code","Salesperson Code");
      END;
      IF Team.GET(ToDo.GETFILTER("Team Code")) THEN BEGIN
        VALIDATE("Team Code",Team.Code);
        SETRANGE("Team Code","Team Code");
      END;
      IF Campaign.GET(ToDo.GETFILTER("Campaign No.")) THEN BEGIN
        "Campaign No." := Campaign."No.";
        "Salesperson Code" := Campaign."Salesperson Code";
        SETRANGE("Campaign No.","Campaign No.");
      END;
      IF Opp.GET(ToDo.GETFILTER("Opportunity No.")) THEN BEGIN
        VALIDATE("Opportunity No.",Opp."No.");
        "Contact No." := Opp."Contact No.";
        "Contact Company No." := Opp."Contact Company No.";
        "Campaign No." := Opp."Campaign No.";
        "Salesperson Code" := Opp."Salesperson Code";
        SETRANGE("Opportunity No.","Opportunity No.");
      END;
      IF SegHeader.GET(ToDo.GETFILTER("Segment No.")) THEN BEGIN
        "Segment No." := SegHeader."No.";
        "Campaign No." := SegHeader."Campaign No.";
        "Salesperson Code" := SegHeader."Salesperson Code";
        SETRANGE("Segment No.","Segment No.");
      END;

      StartWizard;
    END;

    PROCEDURE CreateToDoFromSalesHeader@50(SalesHeader@1000 : Record 36);
    BEGIN
      DELETEALL;
      INIT;
      VALIDATE("Contact No.",SalesHeader."Sell-to Contact No.");
      SETRANGE("Contact No.",SalesHeader."Sell-to Contact No.");
      IF SalesHeader."Salesperson Code" <> '' THEN BEGIN
        "Salesperson Code" := SalesHeader."Salesperson Code";
        SETRANGE("Salesperson Code","Salesperson Code");
      END;
      IF SalesHeader."Campaign No." <> '' THEN BEGIN
        "Campaign No." := SalesHeader."Campaign No.";
        SETRANGE("Campaign No.","Campaign No.");
      END;

      StartWizard;
    END;

    PROCEDURE CreateToDoFromInteractLogEntry@51(InteractionLogEntry@1000 : Record 5065);
    BEGIN
      INIT;
      VALIDATE("Contact No.",InteractionLogEntry."Contact No.");
      "Salesperson Code" := InteractionLogEntry."Salesperson Code";
      "Campaign No." := InteractionLogEntry."Campaign No.";

      StartWizard;
    END;

    LOCAL PROCEDURE CreateInteraction@10();
    VAR
      SegLine@1000 : TEMPORARY Record 5077;
    BEGIN
      SegLine.CreateInteractionFromToDo(Rec);
    END;

    LOCAL PROCEDURE CreateRecurringTodo@4();
    VAR
      RMCommentLine@1000 : Record 5061;
      ToDo2@1002 : Record 5080;
      TodoInteractLanguage@1003 : Record 5196;
      Attachment@1004 : Record 5062;
      Attendee@1005 : Record 5199;
      AttendeeTemp@1007 : TEMPORARY Record 5199;
      RMCommentLine3@1006 : Record 5061;
    BEGIN
      TESTFIELD("Recurring Date Interval");
      IF "Calc. Due Date From" = "Calc. Due Date From"::" " THEN
        ERROR(
          STRSUBSTNO(Text000,FIELDCAPTION("Calc. Due Date From")));

      ToDo2 := Rec;
      WITH ToDo2 DO BEGIN
        Status := 0;
        Closed := FALSE;
        Canceled := FALSE;
        "Date Closed" := 0D;
        "Completed By" := '';
        CASE "Calc. Due Date From" OF
          "Calc. Due Date From"::"Due Date":
            Date := CALCDATE("Recurring Date Interval",Date);
          "Calc. Due Date From"::"Closing Date":
            Date := CALCDATE("Recurring Date Interval",TODAY);
        END;
        GetEndDateTime;

        WITH RMCommentLine3 DO BEGIN
          RESET;
          SETRANGE("Table Name",RMCommentLine."Table Name"::"To-do");
          SETRANGE("No.","No.");
          SETRANGE("Sub No.",0);
        END;

        TodoInteractLanguage.SETRANGE("To-do No.","No.");

        IF Type = Type::Meeting THEN BEGIN
          Attendee.SETRANGE("To-do No.","No.");
          GET(InsertTodoAndRelatedData(
              ToDo2,TodoInteractLanguage,Attachment,Attendee,RMCommentLine3));
        END ELSE BEGIN
          CreateAttendeesFromTodo(AttendeeTemp,ToDo2,'');
          GET(InsertTodoAndRelatedData(
              ToDo2,TodoInteractLanguage,Attachment,AttendeeTemp,RMCommentLine3));
        END;
      END;

      MESSAGE(
        STRSUBSTNO(Text001,
          TABLECAPTION,ToDo2."Organizer To-do No.",TABLECAPTION,"No."));
    END;

    PROCEDURE InsertTodo@2(Todo2@1000 : Record 5080;VAR RMCommentLineTmp@1004 : Record 5061;VAR AttendeeTemp@1005 : Record 5199;VAR TodoInteractLanguageTemp@1007 : Record 5196;VAR AttachmentTemp@1008 : Record 5062;ActivityCode@1001 : Code[10];Deliver@1010 : Boolean);
    VAR
      SegHeader@1002 : Record 5076;
      SegLine@1003 : Record 5077;
      ConfirmText@1006 : Text[250];
    BEGIN
      IF SegHeader.GET(GETFILTER("Segment No.")) THEN BEGIN
        SegLine.SETRANGE("Segment No.",SegHeader."No.");
        SegLine.SETFILTER("Contact No.",'<>%1','');
        IF SegLine.FINDFIRST THEN BEGIN
          IF ActivityCode = '' THEN
            ConfirmText := Text002
          ELSE
            ConfirmText := Text003;
          IF CONFIRM(ConfirmText,TRUE,SegHeader."No.") THEN BEGIN
            IF ActivityCode = '' THEN BEGIN
              Todo2.GET(InsertTodoAndRelatedData(
                  Todo2,TodoInteractLanguageTemp,
                  AttachmentTemp,AttendeeTemp,RMCommentLineTmp));
              IF (Todo2.Type = Type::Meeting) AND Deliver THEN
                SendMAPIInvitations(Todo2,TRUE);
            END ELSE
              InsertActivityTodo(Todo2,ActivityCode,AttendeeTemp);
          END;
        END;
      END ELSE BEGIN
        IF ActivityCode = '' THEN BEGIN
          Todo2.GET(InsertTodoAndRelatedData(
              Todo2,TodoInteractLanguageTemp,
              AttachmentTemp,AttendeeTemp,RMCommentLineTmp));
          IF (Todo2.Type = Type::Meeting) AND Deliver THEN
            SendMAPIInvitations(Todo2,TRUE);
        END ELSE
          InsertActivityTodo(Todo2,ActivityCode,AttendeeTemp);
      END;

      IF (Todo2.Type = Todo2.Type::Meeting) AND
         Todo2.GET(Todo2."Organizer To-do No.")
      THEN
        Todo2.ArrangeOrganizerAttendee
    END;

    LOCAL PROCEDURE InsertTodoAndRelatedData@14(Todo2@1000 : Record 5080;VAR TodoInteractLanguage@1001 : Record 5196;VAR Attachment@1002 : Record 5062;VAR Attendee@1003 : Record 5199;VAR RMCommentLine@1004 : Record 5061) TodoNo : Code[20];
    VAR
      TodoInteractLanguage2@1005 : Record 5196;
      AttendeeTemp@1006 : TEMPORARY Record 5199;
      Todo@1007 : Record 5080;
      TeamSalesperson@1008 : Record 5084;
      Attendee2@1010 : Record 5199;
      SalespersonCode@1009 : Code[10];
      Window@1013 : Dialog;
      AttendeeCounter@1017 : Integer;
      TotalAttendees@1018 : Integer;
      CommentLineInserted@1019 : Boolean;
    BEGIN
      IF Todo2."Team Code" = '' THEN
        Todo2."System To-do Type" := "System To-do Type"::Organizer
      ELSE
        Todo2."System To-do Type" := "System To-do Type"::Team;
      IF Todo2.Type = Type::Meeting THEN BEGIN
        SalespersonCode := Todo2."Salesperson Code";
        CLEAR(Todo2."No.");
        IF Todo2."System To-do Type" = Todo2."System To-do Type"::Team THEN
          Todo2."Salesperson Code" := '';
        Todo2.INSERT(TRUE);

        CreateTodoInteractLanguages(TodoInteractLanguage,Attachment,Todo2."No.");
        IF TodoInteractLanguage2.GET(Todo2."No.",Todo2."Language Code") THEN BEGIN
          Todo2."Attachment No." := TodoInteractLanguage2."Attachment No.";
          Todo2.MODIFY;
        END;

        IF "Team Code" <> '' THEN BEGIN
          Attendee.SETCURRENTKEY("To-do No.","Attendance Type");
          Attendee.SETRANGE("Attendance Type",Attendee."Attendance Type"::"To-do Organizer");
          IF Attendee.FIND('-') THEN BEGIN
            CreateSubTodo(Attendee,Todo2);
            Attendee2.INIT;
            Attendee2 := Attendee;
            Attendee2."To-do No." := Todo2."No.";
            Attendee2.INSERT;
          END;
          Attendee.SETFILTER("Attendance Type",'<>%1',Attendee."Attendance Type"::"To-do Organizer")
        END;
        IF Attendee.FIND('-') THEN
          REPEAT
            CreateSubTodo(Attendee,Todo2);
            Attendee2.INIT;
            Attendee2 := Attendee;
            Attendee2."To-do No." := Todo2."No.";
            Attendee2.INSERT
          UNTIL Attendee.NEXT = 0;

        Todo2.GetMeetingOrganizerTodo(Todo);
        TodoNo := Todo."No."
      END ELSE
        IF Todo2."Segment No." = '' THEN BEGIN
          CLEAR(Todo2."No.");

          Todo2.INSERT(TRUE);
          TodoNo := Todo2."No.";
          IF Todo2."System To-do Type" = "System To-do Type"::Team THEN BEGIN
            TeamSalesperson.SETRANGE("Team Code",Todo2."Team Code");
            IF TeamSalesperson.FIND('-') THEN
              REPEAT
                AttendeeTemp.CreateAttendee(
                  AttendeeTemp,
                  Todo2."No.",10000,
                  AttendeeTemp."Attendance Type"::"To-do Organizer",
                  AttendeeTemp."Attendee Type"::Salesperson,
                  TeamSalesperson."Salesperson Code",
                  TRUE);
                CreateSubTodo(AttendeeTemp,Todo2);
                AttendeeTemp.DELETEALL
              UNTIL TeamSalesperson.NEXT = 0
          END;
          IF Attendee.FIND('-') THEN
            REPEAT
              CreateSubTodo(Attendee,Todo2);
            UNTIL Attendee.NEXT = 0;
        END ELSE
          IF Attendee.FIND('-') THEN BEGIN
            Window.OPEN(Text036 + Text037 + Text038);
            TotalAttendees := Attendee.COUNT;
            REPEAT
              IF Todo2."System To-do Type" = "System To-do Type"::Team THEN BEGIN
                Todo.INIT;
                Todo := Todo2;
                CLEAR(Todo."No.");
                FillSalesPersonContact(Todo,Attendee);
                Todo.INSERT(TRUE);
                TodoNo := Todo."No.";
                AttendeeTemp.INIT;
                AttendeeTemp := Attendee;
                AttendeeTemp.INSERT;
                CreateSubTodo(AttendeeTemp,Todo);
                AttendeeTemp.DELETEALL;
                TeamSalesperson.SETRANGE("Team Code",Todo."Team Code");
                IF TeamSalesperson.FIND('-') THEN
                  REPEAT
                    AttendeeTemp.CreateAttendee(
                      AttendeeTemp,
                      "No.",10000,
                      AttendeeTemp."Attendance Type"::"To-do Organizer",
                      AttendeeTemp."Attendee Type"::Salesperson,
                      TeamSalesperson."Salesperson Code",
                      TRUE);
                    CreateSubTodo(AttendeeTemp,Todo);
                    AttendeeTemp.DELETEALL
                  UNTIL TeamSalesperson.NEXT = 0
              END ELSE BEGIN
                Todo.INIT;
                Todo := Todo2;
                CLEAR(Todo."No.");
                Todo."System To-do Type" := "System To-do Type"::Organizer;
                FillSalesPersonContact(Todo,Attendee);
                Todo.INSERT(TRUE);
                TodoNo := Todo."No.";

                AttendeeTemp.INIT;
                AttendeeTemp := Attendee;
                AttendeeTemp.INSERT;
                CreateSubTodo(AttendeeTemp,Todo);
              END;
              AttendeeCounter := AttendeeCounter + 1;
              CreateCommentLines(RMCommentLine,TodoNo);
              Window.UPDATE(1,Todo."Organizer To-do No.");
              Window.UPDATE(2,ROUND(AttendeeCounter / TotalAttendees * 10000,1));
              COMMIT
            UNTIL Attendee.NEXT = 0;
            Window.CLOSE;
            CommentLineInserted := TRUE;
          END;
      IF NOT CommentLineInserted THEN
        CreateCommentLines(RMCommentLine,Todo2."No.");
    END;

    PROCEDURE CreateSubTodo@15(VAR Attendee@1001 : Record 5199;Todo@1000 : Record 5080) TodoNo : Code[20];
    VAR
      Todo2@1002 : Record 5080;
    BEGIN
      Todo2.INIT;
      Todo2.TRANSFERFIELDS(Todo,FALSE);

      IF Attendee."Attendance Type" <> Attendee."Attendance Type"::"To-do Organizer" THEN BEGIN
        IF Attendee."Attendee Type" = Attendee."Attendee Type"::Salesperson THEN BEGIN
          Todo2.VALIDATE("Salesperson Code",Attendee."Attendee No.");
          Todo2."Organizer To-do No." := Todo."No.";
          Todo2."System To-do Type" := "System To-do Type"::"Salesperson Attendee";
        END ELSE BEGIN
          Todo2.VALIDATE("Salesperson Code",Todo."Salesperson Code");
          Todo2.VALIDATE("Team Code",Todo."Team Code");
          Todo2.VALIDATE("Contact No.",Attendee."Attendee No.");
          Todo2."Organizer To-do No." := Todo."No.";
          Todo2."System To-do Type" := "System To-do Type"::"Contact Attendee";
        END;
        Todo2.INSERT(TRUE)
      END ELSE
        IF Todo."Team Code" <> '' THEN BEGIN
          Todo2."System To-do Type" := Todo2."System To-do Type"::Organizer;
          Todo2.VALIDATE("Salesperson Code",Attendee."Attendee No.");

          Todo2.INSERT(TRUE);
        END;
      EXIT(Todo2."No.")
    END;

    PROCEDURE DeleteAttendeeTodo@20(Attendee@1000 : Record 5199);
    VAR
      Todo@1001 : Record 5080;
    BEGIN
      IF FindAttendeeTodo(Todo,Attendee) THEN
        Todo.DELETE;
    END;

    PROCEDURE FindAttendeeTodo@25(VAR Todo@1000 : Record 5080;Attendee@1001 : Record 5199) : Boolean;
    BEGIN
      Todo.RESET;
      Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
      Todo.SETRANGE("Organizer To-do No.",Attendee."To-do No.");
      IF Attendee."Attendee Type" = Attendee."Attendee Type"::Contact THEN BEGIN
        Todo.SETRANGE("System To-do Type",Todo."System To-do Type"::"Contact Attendee");
        Todo.SETRANGE("Contact No.",Attendee."Attendee No.")
      END ELSE BEGIN
        Todo.SETRANGE("System To-do Type",Todo."System To-do Type"::"Salesperson Attendee");
        Todo.SETRANGE("Salesperson Code",Attendee."Attendee No.");
      END;
      EXIT(Todo.FIND('-'));
    END;

    LOCAL PROCEDURE CreateAttendeesFromTodo@19(VAR Attendee@1000 : Record 5199;Todo@1001 : Record 5080;TeamMeetingOrganizer@1008 : Code[10]);
    VAR
      Cont@1002 : Record 5050;
      Salesperson@1003 : Record 13;
      SegHeader@1004 : Record 5076;
      SegLine@1005 : Record 5077;
      Opp@1006 : Record 5092;
      AttendeeLineNo@1007 : Integer;
    BEGIN
      IF Todo."Segment No." = '' THEN BEGIN
        IF Todo.Type = Type::Meeting THEN
          IF Todo."Team Code" = '' THEN BEGIN
            IF Salesperson.GET(Todo."Salesperson Code") THEN
              Attendee.CreateAttendee(
                Attendee,
                Todo."No.",10000,Attendee."Attendance Type"::"To-do Organizer",
                Attendee."Attendee Type"::Salesperson,
                Salesperson.Code,TRUE)
          END ELSE
            Todo.CreateAttendeesFromTeam(
              Attendee,
              TeamMeetingOrganizer);

        IF Attendee.FIND('+') THEN
          AttendeeLineNo := Attendee."Line No." + 10000
        ELSE
          AttendeeLineNo := 10000;

        IF Cont.GET(Todo."Contact No.") THEN
          Attendee.CreateAttendee(
            Attendee,
            Todo."No.",AttendeeLineNo,Attendee."Attendance Type"::Required,
            Attendee."Attendee Type"::Contact,
            Cont."No.",Cont."E-Mail" <> '');
      END ELSE BEGIN
        IF Todo."Team Code" = '' THEN BEGIN
          IF Salesperson.GET(Todo."Salesperson Code") THEN
            Attendee.CreateAttendee(
              Attendee,
              Todo."No.",10000,Attendee."Attendance Type"::"To-do Organizer",
              Attendee."Attendee Type"::Salesperson,
              Salesperson.Code,TRUE);
        END ELSE
          Todo.CreateAttendeesFromTeam(Attendee,TransformFromCode20ToCode10(Todo."Team Meeting Organizer"));

        IF Attendee.FIND('+') THEN
          AttendeeLineNo := Attendee."Line No." + 10000
        ELSE
          AttendeeLineNo := 10000;

        IF Opp.GET(Todo."Opportunity No.") THEN
          Attendee.CreateAttendee(
            Attendee,
            Todo."No.",AttendeeLineNo,Attendee."Attendance Type"::Required,
            Attendee."Attendee Type"::Contact,
            Opp."Contact No.",
            (Cont.GET(Opp."Contact No.") AND
             (Cont."E-Mail" <> '')))
        ELSE
          IF SegHeader.GET(Todo."Segment No.") THEN BEGIN
            SegLine.SETRANGE("Segment No.",Todo."Segment No.");
            SegLine.SETFILTER("Contact No.",'=%1',Todo."Contact No.");
            IF SegLine.FIND('-') THEN
              REPEAT
                Attendee.CreateAttendee(
                  Attendee,
                  Todo."No.",AttendeeLineNo,Attendee."Attendance Type"::Required,
                  Attendee."Attendee Type"::Contact,
                  SegLine."Contact No.",
                  (Cont.GET(SegLine."Contact No.") AND
                   (Cont."E-Mail" <> '')));
                AttendeeLineNo := AttendeeLineNo + 10000;
              UNTIL SegLine.NEXT = 0;
          END;
      END;
    END;

    LOCAL PROCEDURE CreateTodoInteractLanguages@17(VAR TodoInteractLanguage@1000 : Record 5196;VAR Attachment@1001 : Record 5062;TodoNo@1002 : Code[20]);
    VAR
      TodoInteractLanguage2@1003 : Record 5196;
      Attachment2@1004 : Record 5062;
      MarketingSetup@1006 : Record 5079;
      AttachmentManagement@1005 : Codeunit 5052;
      FileName@1007 : Text;
    BEGIN
      IF TodoInteractLanguage.FIND('-') THEN
        REPEAT
          TodoInteractLanguage2.INIT;
          TodoInteractLanguage2."To-do No." := TodoNo;
          TodoInteractLanguage2."Language Code" := TodoInteractLanguage."Language Code";
          TodoInteractLanguage2.Description := TodoInteractLanguage.Description;
          IF TodoInteractLanguage."Attachment No." <> 0 THEN BEGIN
            Attachment.GET(TodoInteractLanguage."Attachment No.");
            Attachment2.GET(AttachmentManagement.InsertAttachment(0));
            Attachment2.TRANSFERFIELDS(Attachment,FALSE);
            Attachment.CALCFIELDS(Attachment);
            Attachment2.Attachment := Attachment.Attachment;
            Attachment2.WizSaveAttachment;
            Attachment2.MODIFY(TRUE);
            MarketingSetup.GET;
            IF MarketingSetup."Attachment Storage Type" = MarketingSetup."Attachment Storage Type"::"Disk File" THEN
              IF Attachment2."No." <> 0 THEN BEGIN
                FileName := Attachment2.ConstDiskFileName;
                IF FileName <> '' THEN
                  Attachment.ExportAttachmentToServerFile(FileName);
              END;
            TodoInteractLanguage2."Attachment No." := Attachment2."No.";
          END ELSE
            TodoInteractLanguage2."Attachment No." := 0;
          TodoInteractLanguage2.INSERT;
        UNTIL TodoInteractLanguage.NEXT = 0;
    END;

    PROCEDURE AssignActivityFromToDo@9(VAR ToDo@1007 : Record 5080);
    VAR
      Cont@1001 : Record 5050;
      SalesPurchPerson@1002 : Record 13;
      Team@1003 : Record 5083;
      Campaign@1004 : Record 5071;
      SegHeader@1005 : Record 5076;
      Opp@1006 : Record 5092;
    BEGIN
      INIT;

      IF Cont.GET(ToDo.GETFILTER("Contact Company No.")) THEN BEGIN
        VALIDATE("Contact No.",Cont."No.");
        "Salesperson Code" := Cont."Salesperson Code";
        SETRANGE("Contact Company No.","Contact No.");
      END;

      IF Cont.GET(ToDo.GETFILTER("Contact No.")) THEN BEGIN
        VALIDATE("Contact No.",Cont."No.");
        "Salesperson Code" := Cont."Salesperson Code";
        SETRANGE("Contact No.","Contact No.");
      END;

      IF SegHeader.GET(ToDo.GETFILTER("Segment No.")) THEN BEGIN
        VALIDATE("Segment No.",SegHeader."No.");
        "Campaign No." := SegHeader."Campaign No.";
        "Salesperson Code" := SegHeader."Salesperson Code";
        SETRANGE("Segment No.","Segment No.");
      END;

      IF SalesPurchPerson.GET(ToDo.GETFILTER("Salesperson Code")) THEN BEGIN
        "Salesperson Code" := SalesPurchPerson.Code;
        SETRANGE("Salesperson Code","Salesperson Code");
      END;

      IF Team.GET(ToDo.GETFILTER("Team Code")) THEN BEGIN
        "Team Code" := Team.Code;
        SETRANGE("Team Code","Team Code");
      END;

      IF Campaign.GET(ToDo.GETFILTER("Campaign No.")) THEN BEGIN
        "Campaign No." := Campaign."No.";
        "Salesperson Code" := Campaign."Salesperson Code";
        SETRANGE("Campaign No.","Campaign No.");
      END;

      IF Opp.GET(ToDo.GETFILTER("Opportunity No.")) THEN BEGIN
        VALIDATE("Opportunity No.",Opp."No.");
        "Contact No." := Opp."Contact No.";
        "Contact Company No." := Opp."Contact Company No.";
        "Campaign No." := Opp."Campaign No.";
        "Salesperson Code" := Opp."Salesperson Code";
        SETRANGE("Opportunity No.","Opportunity No.");
      END;

      StartWizard2;
    END;

    LOCAL PROCEDURE InsertActivityTodo@3(Todo2@1000 : Record 5080;ActivityCode@1001 : Code[10];VAR Attendee@1004 : Record 5199);
    VAR
      ActivityStep@1002 : Record 5082;
      TodoDate@1003 : Date;
    BEGIN
      TodoDate := Todo2.Date;
      ActivityStep.SETRANGE("Activity Code",ActivityCode);
      IF ActivityStep.FIND('-') THEN BEGIN
        REPEAT
          InsertActivityStepTodo(Todo2,ActivityStep,TodoDate,Attendee);
        UNTIL ActivityStep.NEXT = 0;
      END ELSE
        InsertActivityStepTodo(Todo2,ActivityStep,TodoDate,Attendee);
    END;

    LOCAL PROCEDURE InsertActivityStepTodo@22(Todo2@1010 : Record 5080;ActivityStep@1009 : Record 5082;TodoDate@1012 : Date;VAR Attendee2@1015 : Record 5199) TodoNo : Code[20];
    VAR
      TodoTemp@1011 : TEMPORARY Record 5080;
      InteractionTemplateSetup@1008 : Record 5122;
      InteractionTemplate@1007 : Record 5064;
      TodoInteractionLanguage@1006 : TEMPORARY Record 5196;
      Attachment@1005 : TEMPORARY Record 5062;
      AttendeeTemp@1004 : TEMPORARY Record 5199;
      RMCommentLine@1003 : TEMPORARY Record 5061;
    BEGIN
      TodoTemp.INIT;
      TodoTemp := Todo2;
      TodoTemp.INSERT;
      IF NOT ActivityStep.ISEMPTY THEN BEGIN
        TodoTemp.Type := ActivityStep.Type;
        TodoTemp.Priority := ActivityStep.Priority;
        TodoTemp.Description := ActivityStep.Description;
        TodoTemp.Date := CALCDATE(ActivityStep."Date Formula",TodoDate);
      END;

      IF TodoTemp.Type = Type::Meeting THEN BEGIN
        IF NOT Attendee2.ISEMPTY THEN BEGIN
          Attendee2.SETRANGE("Attendance Type",Attendee2."Attendance Type"::"To-do Organizer");
          Attendee2.FIND('-')
        END;
        AttendeeTemp.DELETEALL;
        TodoTemp.VALIDATE("All Day Event",TRUE);

        InteractionTemplateSetup.GET;
        IF (InteractionTemplateSetup."Meeting Invitation" <> '') AND
           InteractionTemplate.GET(InteractionTemplateSetup."Meeting Invitation")
        THEN
          UpdateInteractionTemplate(
            TodoTemp,TodoInteractionLanguage,Attachment,InteractionTemplate.Code,TRUE);

        CreateAttendeesFromTodo(AttendeeTemp,TodoTemp,Attendee2."Attendee No.");

        TodoTemp.VALIDATE("Contact No.",'');

        TodoNo := InsertTodoAndRelatedData(
            TodoTemp,TodoInteractionLanguage,
            Attachment,AttendeeTemp,RMCommentLine);
      END ELSE BEGIN
        AttendeeTemp.DELETEALL;
        CreateAttendeesFromTodo(AttendeeTemp,TodoTemp,'');

        InsertTodoAndRelatedData(
          TodoTemp,TodoInteractionLanguage,
          Attachment,AttendeeTemp,RMCommentLine);
      END;
      TodoTemp.DELETE;
    END;

    PROCEDURE CancelOpenTodos@6(OpportunityNo@1000 : Code[20]);
    VAR
      OldTodo@1001 : Record 5080;
      OldTodo2@1002 : Record 5080;
    BEGIN
      IF OpportunityNo = '' THEN
        EXIT;

      OldTodo.RESET;
      OldTodo.SETCURRENTKEY("Opportunity No.");
      OldTodo.SETRANGE("Opportunity No.",OpportunityNo);
      OldTodo.SETRANGE(Closed,FALSE);
      OldTodo.SETRANGE(Canceled,FALSE);

      IF OldTodo.FIND('-') THEN
        REPEAT
          OldTodo2.GET(OldTodo."No.");
          OldTodo2.Recurring := FALSE;
          OldTodo2.VALIDATE(Canceled,TRUE);
          OldTodo2.MODIFY;
        UNTIL OldTodo.NEXT = 0;
    END;

    LOCAL PROCEDURE CreateCommentLines@7(VAR RMCommentLineTmp@1001 : Record 5061;TodoNo@1000 : Code[20]);
    BEGIN
      IF RMCommentLineTmp.FIND('-') THEN
        REPEAT
          RMCommentLine.INIT;
          RMCommentLine := RMCommentLineTmp;
          RMCommentLine."No." := TodoNo;
          RMCommentLine.INSERT;
        UNTIL RMCommentLineTmp.NEXT = 0;
    END;

    PROCEDURE SetDuration@16(EndingDate@1000 : Date;EndingTime@1001 : Time);
    BEGIN
      IF (EndingDate < 01011900D) OR (EndingDate > 31122999D) THEN
        ERROR(Text006,01011900D,31122999D);
      IF NOT "All Day Event" AND (Type = Type::Meeting) THEN
        Duration := CREATEDATETIME(EndingDate,EndingTime) - CREATEDATETIME(Date,"Start Time")
      ELSE
        Duration := CREATEDATETIME(EndingDate + 1,0T) - CREATEDATETIME(Date,0T);

      VALIDATE(Duration);
    END;

    PROCEDURE GetEndDateTime@18();
    BEGIN
      IF (Type <> Type::Meeting) OR "All Day Event" THEN BEGIN
        IF "Start Time" <> 0T THEN
          TempEndDateTime := CREATEDATETIME(Date - 1,"Start Time") + Duration
        ELSE
          TempEndDateTime := CREATEDATETIME(Date,0T) + Duration;
      END ELSE
        TempEndDateTime := CREATEDATETIME(Date,"Start Time") + Duration;

      "Ending Date" := DT2DATE(TempEndDateTime);
      "Ending Time" := DT2TIME(TempEndDateTime);
    END;

    LOCAL PROCEDURE UpdateAttendeeTodos@12(OldTodoNo@1003 : Code[20]);
    VAR
      Todo2@1001 : Record 5080;
      TodoBuffer@1002 : TEMPORARY Record 5080;
    BEGIN
      Todo2.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
      Todo2.SETRANGE("Organizer To-do No.",OldTodoNo);
      IF "Team Code" = '' THEN
        Todo2.SETFILTER(
          "System To-do Type",
          '%1|%2',
          Todo2."System To-do Type"::"Salesperson Attendee",
          Todo2."System To-do Type"::"Contact Attendee")
      ELSE
        Todo2.SETFILTER("System To-do Type",'<>%1',Todo2."System To-do Type"::Team);
      IF Todo2.FIND('-') THEN
        REPEAT
          TodoBuffer.INIT;
          TodoBuffer.TRANSFERFIELDS(Todo2,FALSE);
          TodoBuffer.INSERT;
          Todo2.TRANSFERFIELDS(Rec,FALSE);
          Todo2."System To-do Type" := TodoBuffer."System To-do Type";
          IF Todo2."System To-do Type" = Todo2."System To-do Type"::"Contact Attendee" THEN
            Todo2.VALIDATE("Contact No.",TodoBuffer."Contact No.")
          ELSE
            Todo2."Salesperson Code" := TodoBuffer."Salesperson Code";
          IF Todo2."No." <> OldTodoNo THEN
            Todo2.MODIFY(TRUE);
          TodoBuffer.DELETE;
        UNTIL Todo2.NEXT = 0
    END;

    LOCAL PROCEDURE UpdateInteractionTemplate@13(VAR Todo@1004 : Record 5080;VAR TodoInteractionLanguage@1007 : Record 5196;VAR Attachment@1001 : Record 5062;InteractTmplCode@1006 : Code[10];AttachmentTemporary@1005 : Boolean);
    VAR
      InteractTmpl@1002 : Record 5064;
      InteractTemplLanguage@1008 : Record 5103;
      Attachment2@1003 : Record 5062;
      AttachmentManagement@1000 : Codeunit 5052;
    BEGIN
      Todo.MODIFY;
      TodoInteractionLanguage.SETRANGE("To-do No.",Todo."No.");

      IF AttachmentTemporary THEN
        TodoInteractionLanguage.DELETEALL
      ELSE
        TodoInteractionLanguage.DELETEALL(TRUE);

      Todo."Interaction Template Code" := InteractTmplCode;

      IF InteractTmpl.GET(Todo."Interaction Template Code") THEN BEGIN
        Todo."Language Code" := InteractTmpl."Language Code (Default)";
        Todo.Subject := InteractTmpl.Description;
        Todo."Unit Cost (LCY)" := InteractTmpl."Unit Cost (LCY)";
        Todo."Unit Duration (Min.)" := InteractTmpl."Unit Duration (Min.)";
        IF Todo."Campaign No." = '' THEN
          Todo."Campaign No." := InteractTmpl."Campaign No.";

        IF AttachmentTemporary THEN
          Attachment.DELETEALL;

        InteractTemplLanguage.RESET;
        InteractTemplLanguage.SETRANGE("Interaction Template Code",Todo."Interaction Template Code");
        IF InteractTemplLanguage.FIND('-') THEN
          REPEAT
            TodoInteractionLanguage.INIT;
            TodoInteractionLanguage."To-do No." := Todo."No.";
            TodoInteractionLanguage."Language Code" := InteractTemplLanguage."Language Code";
            TodoInteractionLanguage.Description := InteractTemplLanguage.Description;
            IF Attachment2.GET(InteractTemplLanguage."Attachment No.") THEN BEGIN
              IF AttachmentTemporary THEN BEGIN
                Attachment.INIT;
                IF Attachment2."Storage Type" = Attachment2."Storage Type"::Embedded THEN
                  Attachment2.CALCFIELDS(Attachment);
                Attachment.TRANSFERFIELDS(Attachment2);
                Attachment.INSERT;
                TodoInteractionLanguage."Attachment No." := Attachment."No.";
              END ELSE
                TodoInteractionLanguage."Attachment No." :=
                  AttachmentManagement.InsertAttachment(InteractTemplLanguage."Attachment No.");
            END;
            TodoInteractionLanguage.INSERT;
          UNTIL InteractTemplLanguage.NEXT = 0
        ELSE
          Todo."Attachment No." := 0;
      END ELSE BEGIN
        Todo."Language Code" := '';
        Todo.Subject := '';
        Todo."Unit Cost (LCY)" := 0;
        Todo."Unit Duration (Min.)" := 0;
        Todo."Attachment No." := 0;
      END;

      IF TodoInteractionLanguage.GET(Todo."No.",Todo."Language Code") THEN
        Todo."Attachment No." := TodoInteractionLanguage."Attachment No.";

      Todo.MODIFY;
    END;

    PROCEDURE SendMAPIInvitations@21(Todo@1000 : Record 5080;FromWizard@1019 : Boolean);
    VAR
      Attendee@1001 : Record 5199;
      Todo2@1002 : Record 5080;
      Salesperson@1004 : Record 13;
      Salesperson2@1013 : Record 13;
      Mail@1012 : Codeunit 397;
      Body@1015 : Text[260];
      NoToSend@1014 : Integer;
      NoNotSent@1016 : Integer;
      Selected@1018 : Integer;
      Options@1017 : Text[1024];
    BEGIN
      IF Todo."System To-do Type" <> Todo."System To-do Type"::Organizer THEN
        Todo.GetMeetingOrganizerTodo(Todo);
      IF Todo."Attachment No." = 0 THEN BEGIN
        Attendee.SETRANGE("To-do No.",Todo."Organizer To-do No.");
        Attendee.SETRANGE("Send Invitation",TRUE);
        Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Contact);
        IF Attendee.FIND('-') THEN BEGIN
          Attendee.SETCURRENTKEY("To-do No.","Attendance Type");
          Attendee.SETRANGE("Send Invitation");
          Attendee.SETRANGE("Attendee Type");
          Attendee.SETRANGE("Attendance Type",Attendee."Attendance Type"::"To-do Organizer");
          IF Attendee.FIND('-') THEN
            ERROR(Text067,Todo.TABLECAPTION,Attendee.TABLECAPTION)
        END;
        Attendee.RESET;
      END;

      Attendee.SETRANGE("To-do No.",Todo."Organizer To-do No.");
      Attendee.SETFILTER("Attendance Type",'<>%1',Attendee."Attendance Type"::"To-do Organizer");
      Attendee.SETRANGE("Send Invitation",TRUE);

      IF NOT FromWizard THEN BEGIN
        NoToSend := Attendee.COUNT;
        Attendee.SETRANGE("Invitation Sent",FALSE);
        NoNotSent := Attendee.COUNT;
        IF NoToSend = 0 THEN
          ERROR(Text018,Attendee.FIELDCAPTION("Send Invitation"));
        IF (NoToSend > NoNotSent) AND (NoNotSent <> 0) THEN BEGIN
          Options :=
            STRSUBSTNO(
              Text019,Attendee.FIELDCAPTION("Send Invitation")) + ',' +
            STRSUBSTNO(
              Text020,Attendee.FIELDCAPTION("Send Invitation")) + ',' +
            Text021;
          Selected := STRMENU(Options,1);
          IF Selected IN [0,3] THEN
            ERROR('');
        END;
        IF NoNotSent = 0 THEN BEGIN
          IF NOT CONFIRM(
               STRSUBSTNO(
                 Text022,Attendee.FIELDCAPTION("Send Invitation")),FALSE)
          THEN
            ERROR('');
        END;
        IF NoToSend = NoNotSent THEN BEGIN
          IF NOT CONFIRM(STRSUBSTNO(Text019,Attendee.FIELDCAPTION("Send Invitation")),FALSE) THEN
            ERROR('');
        END;

        Attendee.RESET;
        Attendee.SETRANGE("To-do No.",Todo."Organizer To-do No.");
        Attendee.SETRANGE("Send Invitation",TRUE);
        IF Selected = 2 THEN
          Attendee.SETRANGE("Invitation Sent",FALSE);
      END;

      IF Attendee.FIND('-') THEN
        REPEAT
          IF FindAttendeeTodo(Todo2,Attendee) THEN
            IF Attendee."Attendee Type" = Attendee."Attendee Type"::Salesperson
            THEN BEGIN
              IF Salesperson2.GET(Todo2."Salesperson Code") AND
                 Salesperson.GET(Todo."Salesperson Code")
              THEN BEGIN
                Body :=
                  STRSUBSTNO(Text015,Salesperson2.Name) + '<br/><br/>' +
                  STRSUBSTNO(Text016,FORMAT(Todo.Date),FORMAT(Todo."Start Time"),FORMAT(Todo.Location)) + '<br/><br/>' +
                  Text017 + '<br/>' +
                  Salesperson.Name + '<br/>' +
                  FORMAT(TODAY) + ' ' + FORMAT(TIME);
                IF Mail.NewMessage(
                     Salesperson2."E-Mail",'','',Todo2.Description,
                     Body,'',FALSE)
                THEN BEGIN
                  Attendee."Invitation Sent" := TRUE;
                  Attendee.MODIFY;
                END ELSE
                  MESSAGE(Text023,Attendee."Attendee Name");
              END;
            END ELSE BEGIN
              LogTodoInteraction(Todo,Todo2,TRUE);

              Attendee."Invitation Sent" := TRUE;
              Attendee.MODIFY;
            END;
        UNTIL Attendee.NEXT = 0;
    END;

    PROCEDURE CreateAttachment@23(PageNotEditable@1000 : Boolean);
    VAR
      TodoInteractionLanguage@1001 : Record 5196;
    BEGIN
      IF "Interaction Template Code" = '' THEN
        EXIT;
      IF NOT TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN BEGIN
        TodoInteractionLanguage.INIT;
        TodoInteractionLanguage."To-do No." := "Organizer To-do No.";
        TodoInteractionLanguage."Language Code" := "Language Code";
        TodoInteractionLanguage.INSERT(TRUE);
      END;
      IF TodoInteractionLanguage.CreateAttachment(PageNotEditable) THEN BEGIN
        "Attachment No." := TodoInteractionLanguage."Attachment No.";
        MODIFY(TRUE);
      END;
    END;

    PROCEDURE OpenAttachment@24(PageNotEditable@1000 : Boolean);
    VAR
      TodoInteractionLanguage@1001 : Record 5196;
    BEGIN
      IF "Interaction Template Code" = '' THEN
        EXIT;
      IF TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN
        IF TodoInteractionLanguage."Attachment No." <> 0 THEN
          TodoInteractionLanguage.OpenAttachment(PageNotEditable);
      MODIFY(TRUE);
    END;

    PROCEDURE ImportAttachment@26();
    VAR
      TodoInteractionLanguage@1000 : Record 5196;
    BEGIN
      IF "Interaction Template Code" = '' THEN
        EXIT;

      IF NOT TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN BEGIN
        TodoInteractionLanguage.INIT;
        TodoInteractionLanguage."To-do No." := "Organizer To-do No.";
        TodoInteractionLanguage."Language Code" := "Language Code";
        TodoInteractionLanguage.INSERT(TRUE);
      END;
      TodoInteractionLanguage.ImportAttachment;
      "Attachment No." := TodoInteractionLanguage."Attachment No.";
      MODIFY(TRUE);
    END;

    PROCEDURE ExportAttachment@27();
    VAR
      TodoInteractionLanguage@1000 : Record 5196;
    BEGIN
      IF "Interaction Template Code" = '' THEN
        EXIT;

      IF TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN
        IF TodoInteractionLanguage."Attachment No." <> 0 THEN
          TodoInteractionLanguage.ExportAttachment;
    END;

    PROCEDURE RemoveAttachment@28(Prompt@1000 : Boolean);
    VAR
      TodoInteractionLanguage@1001 : Record 5196;
    BEGIN
      IF "Interaction Template Code" = '' THEN
        EXIT;

      IF TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN
        IF TodoInteractionLanguage."Attachment No." <> 0 THEN
          IF TodoInteractionLanguage.RemoveAttachment(Prompt) THEN BEGIN
            "Attachment No." := 0;
            MODIFY(TRUE);
          END;
      MODIFY(TRUE);
    END;

    LOCAL PROCEDURE LogTodoInteraction@30(VAR Todo@1006 : Record 5080;VAR Todo2@1000 : Record 5080;Deliver@1010 : Boolean);
    VAR
      SegLine@1001 : TEMPORARY Record 5077;
      Cont@1002 : Record 5050;
      Salesperson@1003 : Record 13;
      Campaign@1004 : Record 5071;
      Attachment@1007 : Record 5062;
      AttachmentTemp@1008 : TEMPORARY Record 5062;
      InterLogEntryCommentLineTmp@1009 : TEMPORARY Record 5123;
      SegManagement@1005 : Codeunit 5051;
    BEGIN
      IF Attachment.GET(Todo."Attachment No.") THEN BEGIN
        AttachmentTemp.DELETEALL;
        AttachmentTemp.INIT;
        AttachmentTemp.WizEmbeddAttachment(Attachment);
        AttachmentTemp.INSERT;
      END;

      SegLine.DELETEALL;
      SegLine.INIT;
      SegLine."To-do No." := Todo."Organizer To-do No.";
      SegLine.SETRANGE("To-do No.",SegLine."To-do No.");
      IF Cont.GET(Todo2."Contact No.") THEN
        SegLine.VALIDATE("Contact No.",Todo2."Contact No.");
      IF Salesperson.GET(Todo."Salesperson Code") THEN
        SegLine."Salesperson Code" := Salesperson.Code;
      IF Campaign.GET(Todo."Campaign No.") THEN
        SegLine."Campaign No." := Campaign."No.";
      SegLine."Interaction Template Code" := Todo."Interaction Template Code";
      SegLine."Attachment No." := Todo."Attachment No.";
      SegLine."Language Code" := Todo."Language Code";
      SegLine.Subject := Todo.Description;
      SegLine.Description := Todo.Description;
      SegLine."Correspondence Type" := SegLine."Correspondence Type"::"E-Mail";
      SegLine."Cost (LCY)" := Todo."Unit Cost (LCY)";
      SegLine."Duration (Min.)" := Todo."Unit Duration (Min.)";
      SegLine."Opportunity No." := Todo."Opportunity No.";
      SegLine.VALIDATE(Date,WORKDATE);

      SegLine.INSERT;
      SegManagement.LogInteraction(SegLine,AttachmentTemp,InterLogEntryCommentLineTmp,Deliver,FALSE);
    END;

    PROCEDURE CreateAttendeesFromTeam@33(VAR Attendee@1002 : Record 5199;TeamMeetingOrganizer@1000 : Code[10]);
    VAR
      TeamSalesperson@1003 : Record 5084;
      AttendeeLineNo@1004 : Integer;
    BEGIN
      IF TeamMeetingOrganizer = '' THEN
        EXIT;
      Attendee.CreateAttendee(
        Attendee,
        "No.",10000,Attendee."Attendance Type"::"To-do Organizer",
        Attendee."Attendee Type"::Salesperson,
        TeamMeetingOrganizer,
        TRUE);

      TeamSalesperson.SETRANGE("Team Code","Team Code");
      IF TeamSalesperson.FIND('-') THEN BEGIN
        AttendeeLineNo := 20000;
        REPEAT
          IF TeamSalesperson."Salesperson Code" <> TeamMeetingOrganizer THEN
            Attendee.CreateAttendee(
              Attendee,
              "No.",AttendeeLineNo,Attendee."Attendance Type"::Required,
              Attendee."Attendee Type"::Salesperson,
              TeamSalesperson."Salesperson Code",
              FALSE);
          AttendeeLineNo := AttendeeLineNo + 10000;
        UNTIL TeamSalesperson.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ChangeTeam@37();
    VAR
      Todo@1000 : Record 5080;
      TeamSalesperson@1001 : Record 5084;
      TeamSalespersonOld@1004 : Record 5084;
      AttendeeTemp@1002 : TEMPORARY Record 5199;
      Attendee@1003 : Record 5199;
      Salesperson@1007 : Record 13;
      AttendeeLineNo@1005 : Integer;
      SendInvitation@1006 : Boolean;
      TeamCode@1009 : Code[10];
    BEGIN
      MODIFY;
      TeamSalespersonOld.SETRANGE("Team Code",xRec."Team Code");
      TeamSalesperson.SETRANGE("Team Code","Team Code");
      IF TeamSalesperson.FIND('-') THEN
        REPEAT
          TeamSalesperson.MARK(TRUE)
        UNTIL TeamSalesperson.NEXT = 0;

      IF Type = Type::Meeting THEN BEGIN
        Attendee.SETCURRENTKEY("To-do No.","Attendee Type","Attendee No.");
        Attendee.SETRANGE("To-do No.","Organizer To-do No.");
        Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Salesperson);
        IF Attendee.FIND('-') THEN
          REPEAT
            TeamSalesperson.SETRANGE("Salesperson Code",Attendee."Attendee No.");
            IF TeamSalesperson.FIND('-') THEN
              TeamSalesperson.MARK(FALSE)
            ELSE
              IF Attendee."Attendance Type" <> Attendee."Attendance Type"::"To-do Organizer" THEN BEGIN
                TeamSalespersonOld.SETRANGE("Salesperson Code",Attendee."Attendee No.");
                IF TeamSalespersonOld.FINDFIRST THEN BEGIN
                  Attendee.MARK(TRUE);
                  DeleteAttendeeTodo(Attendee)
                END
              END
          UNTIL Attendee.NEXT = 0;
        Attendee.MARKEDONLY(TRUE);
        Attendee.DELETEALL
      END ELSE BEGIN
        Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
        Todo.SETRANGE("Organizer To-do No.","Organizer To-do No.");
        Todo.SETFILTER("System To-do Type",'%1|%2',
          Todo."System To-do Type"::Organizer,
          Todo."System To-do Type"::"Salesperson Attendee");
        IF Todo.FIND('-') THEN
          REPEAT
            TeamSalesperson.SETRANGE("Salesperson Code",Todo."Salesperson Code");
            IF TeamSalesperson.FIND('-') THEN
              TeamSalesperson.MARK(FALSE)
            ELSE
              Todo.DELETE(TRUE)
          UNTIL Todo.NEXT = 0
      END;

      TeamCode := "Team Code";
      GET("No.");
      "Team Code" := TeamCode;

      TeamSalesperson.MARKEDONLY(TRUE);
      TeamSalesperson.SETRANGE("Salesperson Code");
      IF TeamSalesperson.FIND('-') THEN BEGIN
        IF Type = Type::Meeting THEN
          REPEAT
            Attendee.RESET;
            Attendee.SETRANGE("To-do No.","Organizer To-do No.");
            IF Attendee.FIND('+') THEN
              AttendeeLineNo := Attendee."Line No." + 10000
            ELSE
              AttendeeLineNo := 10000;
            IF Salesperson.GET(TeamSalesperson."Salesperson Code") THEN
              IF Salesperson."E-Mail" <> '' THEN
                SendInvitation := TRUE
              ELSE
                SendInvitation := FALSE;
            Attendee.CreateAttendee(
              Attendee,
              "Organizer To-do No.",AttendeeLineNo,
              Attendee."Attendance Type"::Required,
              Attendee."Attendee Type"::Salesperson,
              TeamSalesperson."Salesperson Code",SendInvitation);
            CreateSubTodo(Attendee,Rec)
          UNTIL TeamSalesperson.NEXT = 0
        ELSE
          REPEAT
            AttendeeTemp.CreateAttendee(
              AttendeeTemp,
              "No.",10000,
              AttendeeTemp."Attendance Type"::"To-do Organizer",
              AttendeeTemp."Attendee Type"::Salesperson,
              TeamSalesperson."Salesperson Code",
              TRUE);
            CreateSubTodo(AttendeeTemp,Rec);
            AttendeeTemp.DELETEALL
          UNTIL TeamSalesperson.NEXT = 0
      END;
      MODIFY(TRUE)
    END;

    LOCAL PROCEDURE ReassignTeamTodoToSalesperson@38();
    VAR
      Todo@1000 : Record 5080;
      Attendee@1001 : Record 5199;
      AttendeeLineNo@1002 : Integer;
      SalespersonCode@1005 : Code[10];
    BEGIN
      MODIFY;
      IF Type = Type::Meeting THEN BEGIN
        Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
        Todo.SETRANGE("Organizer To-do No.","No.");
        Todo.SETRANGE("Salesperson Code","Salesperson Code");
        IF Todo.FINDFIRST THEN BEGIN
          Attendee.SETCURRENTKEY("To-do No.","Attendee Type","Attendee No.");
          Attendee.SETRANGE("To-do No.","No.");
          Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Salesperson);
          Attendee.SETRANGE("Attendee No.","Salesperson Code");
          IF Attendee.FINDFIRST THEN
            IF Attendee."Attendance Type" = Attendee."Attendance Type"::"To-do Organizer" THEN BEGIN
              Attendee.DELETE;
              Todo.DELETE;
            END ELSE
              Attendee.DELETE(TRUE)
        END;

        SalespersonCode := "Salesperson Code";
        GET("No.");
        "Salesperson Code" := SalespersonCode;

        Todo.SETRANGE("Salesperson Code");
        Todo.SETRANGE("System To-do Type","System To-do Type"::Organizer);
        IF Todo.FINDFIRST THEN BEGIN
          Attendee.RESET;
          Attendee.SETCURRENTKEY("To-do No.","Attendee Type","Attendee No.");
          Attendee.SETRANGE("To-do No.","No.");
          Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Salesperson);
          Attendee.SETRANGE("Attendee No.",Todo."Salesperson Code");
          IF Attendee.FINDFIRST THEN BEGIN
            Attendee."Attendance Type" := Attendee."Attendance Type"::Required;
            Attendee.MODIFY
          END;
          Todo."System To-do Type" := Todo."System To-do Type"::"Salesperson Attendee";
          Todo.MODIFY(TRUE)
        END;

        Attendee.RESET;
        Attendee.SETRANGE("To-do No.","No.");
        IF Attendee.FINDLAST THEN
          AttendeeLineNo := Attendee."Line No." + 10000
        ELSE
          AttendeeLineNo := 10000;
        Attendee.CreateAttendee(
          Attendee,"No.",AttendeeLineNo,
          Attendee."Attendance Type"::"To-do Organizer",
          Attendee."Attendee Type"::Salesperson,
          "Salesperson Code",TRUE);
        ArrangeOrganizerAttendee;
      END ELSE BEGIN
        Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
        Todo.SETRANGE("Organizer To-do No.","No.");
        Todo.SETRANGE("System To-do Type","System To-do Type"::Organizer);
        IF Todo.FINDFIRST THEN
          Todo.DELETEALL(TRUE);

        IF "Contact No." <> '' THEN BEGIN
          Todo.SETRANGE("System To-do Type","System To-do Type"::"Contact Attendee");
          IF Todo.FINDFIRST THEN BEGIN
            Todo."Salesperson Code" := "Salesperson Code";
            Todo.MODIFY(TRUE)
          END
        END
      END;

      "System To-do Type" := "System To-do Type"::Organizer;
      "Team Code" := '';
      MODIFY(TRUE);
    END;

    LOCAL PROCEDURE ReassignSalespersonTodoToTeam@36();
    VAR
      TeamSalesperson@1000 : Record 5084;
      Attendee@1001 : Record 5199;
      AttendeeTemp@1002 : TEMPORARY Record 5199;
      Todo@1003 : Record 5080;
      AttendeeLineNo@1004 : Integer;
      SendInvitation@1005 : Boolean;
      SalespersonCode@1006 : Code[10];
      TodoNo@1007 : Code[20];
    BEGIN
      MODIFY;
      SalespersonCode := "Salesperson Code";
      "Salesperson Code" := '';
      "System To-do Type" := "System To-do Type"::Team;
      MODIFY;

      Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
      Todo.SETRANGE("Organizer To-do No.","No.");

      IF Type = Type::Meeting THEN BEGIN
        Attendee.SETRANGE("To-do No.","No.");
        Attendee.SETRANGE("Attendance Type",Attendee."Attendance Type"::"To-do Organizer");
        IF Attendee.FINDFIRST THEN BEGIN
          Attendee."Attendance Type" := Attendee."Attendance Type"::Required;
          TodoNo := CreateSubTodo(Attendee,Rec);
          Attendee."Attendance Type" := Attendee."Attendance Type"::"To-do Organizer";
          Attendee.MODIFY;
          IF Todo.GET(TodoNo) THEN BEGIN
            Todo."System To-do Type" := Todo."System To-do Type"::Organizer;
            Todo.MODIFY;
          END
        END;

        Todo.SETFILTER("System To-do Type",'<>%1',Todo."System To-do Type"::"Contact Attendee");
        TeamSalesperson.SETRANGE("Team Code","Team Code");
        IF TeamSalesperson.FIND('-') THEN
          REPEAT
            Todo.SETRANGE("Salesperson Code",TeamSalesperson."Salesperson Code");
            IF Todo.FINDFIRST THEN BEGIN
              IF (Todo."System To-do Type" = Todo."System To-do Type"::Organizer) AND
                 (Todo."Salesperson Code" <> SalespersonCode)
              THEN BEGIN
                Todo."System To-do Type" := Todo."System To-do Type"::"Salesperson Attendee";
                MODIFY(TRUE)
              END
            END ELSE BEGIN
              Attendee.RESET;
              Attendee.SETRANGE("To-do No.","No.");
              IF Attendee.FINDLAST THEN
                AttendeeLineNo := Attendee."Line No." + 10000
              ELSE
                AttendeeLineNo := 10000;
              IF Salesperson.GET(TeamSalesperson."Salesperson Code") THEN
                IF Salesperson."E-Mail" <> '' THEN
                  SendInvitation := TRUE
                ELSE
                  SendInvitation := FALSE;
              Attendee.CreateAttendee(
                Attendee,"No.",AttendeeLineNo,
                Attendee."Attendance Type"::Required,
                Attendee."Attendee Type"::Salesperson,
                TeamSalesperson."Salesperson Code",
                SendInvitation);
              CreateSubTodo(Attendee,Rec)
            END
          UNTIL TeamSalesperson.NEXT = 0
      END ELSE BEGIN
        TeamSalesperson.SETRANGE("Team Code","Team Code");
        IF TeamSalesperson.FIND('-') THEN
          REPEAT
            AttendeeTemp.CreateAttendee(
              AttendeeTemp,
              "No.",10000,
              AttendeeTemp."Attendance Type"::"To-do Organizer",
              AttendeeTemp."Attendee Type"::Salesperson,
              TeamSalesperson."Salesperson Code",
              TRUE);
            CreateSubTodo(AttendeeTemp,Rec);
            AttendeeTemp.DELETEALL
          UNTIL TeamSalesperson.NEXT = 0;
      END;

      MODIFY(TRUE)
    END;

    PROCEDURE GetMeetingOrganizerTodo@39(VAR Todo@1000 : Record 5080);
    BEGIN
      IF Type = Type::Meeting THEN
        IF "Team Code" <> '' THEN BEGIN
          Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
          Todo.SETRANGE("Organizer To-do No.","Organizer To-do No.");
          Todo.SETRANGE("System To-do Type","System To-do Type"::Organizer);
          Todo.FIND('-')
        END ELSE
          Todo.GET("Organizer To-do No.")
    END;

    PROCEDURE ArrangeOrganizerAttendee@40();
    VAR
      Attendee@1000 : Record 5199;
      FirstLineNo@1001 : Integer;
      LastLineNo@1002 : Integer;
      OrganizerLineNo@1003 : Integer;
    BEGIN
      Attendee.SETRANGE("To-do No.","No.");
      IF NOT Attendee.FINDFIRST THEN
        EXIT;
      FirstLineNo := Attendee."Line No.";
      Attendee.FINDLAST;
      LastLineNo := Attendee."Line No.";

      Attendee.SETCURRENTKEY("To-do No.","Attendance Type");
      Attendee.SETRANGE("Attendance Type",Attendee."Attendance Type"::"To-do Organizer");
      Attendee.FINDFIRST;
      OrganizerLineNo := Attendee."Line No.";

      IF FirstLineNo <> OrganizerLineNo THEN BEGIN
        Attendee.RENAME("No.",LastLineNo + 1);
        Attendee.GET("No.",FirstLineNo);
        Attendee.RENAME("No.",OrganizerLineNo);
        Attendee.GET("No.",LastLineNo + 1);
        Attendee.RENAME("No.",FirstLineNo)
      END
    END;

    LOCAL PROCEDURE StartWizard@48();
    BEGIN
      "Wizard Step" := "Wizard Step"::"1";

      "Wizard Contact Name" := GetContactName;
      IF Campaign.GET("Campaign No.") THEN
        "Wizard Campaign Description" := Campaign.Description;
      IF Opp.GET("Opportunity No.") THEN
        "Wizard Opportunity Description" := Opp.Description;
      IF SegHeader.GET(GETFILTER("Segment No.")) THEN
        "Segment Description" := SegHeader.Description;
      IF Team.GET(GETFILTER("Team Code")) THEN
        "Team To-do" := TRUE;

      Duration := 1440 * 1000 * 60;
      Date := TODAY;
      GetEndDateTime;

      INSERT;
      PAGE.RUNMODAL(PAGE::"Create To-do",Rec);
    END;

    PROCEDURE PerformNextWizardStatus@43();
    BEGIN
      CASE "Wizard Step" OF
        "Wizard Step"::"1":
          BEGIN
            {
            IF Type <> xRec.Type THEN
              IF Type = Type::Meeting THEN BEGIN
                AssignDefaultAttendeeInfo;
                LoadTempAttachment;
              END ELSE
                ClearDefaultAttendeeInfo;
            }
            IF (Type = Type::Meeting) AND
               (NOT "Team To-do" OR
                (GETFILTER("Team Code") <> ''))
            THEN
              "Wizard Step" := "Wizard Step"::"3"
            ELSE
              "Wizard Step" := "Wizard Step"::"2";
          END;
        "Wizard Step"::"2":
          IF Type <> Type::Meeting THEN
            "Wizard Step" := "Wizard Step"::"4"
          ELSE
            "Wizard Step" := "Wizard Step"::"3";
        ELSE
          "Wizard Step" := "Wizard Step" + 1;
      END;

      IF "Wizard Step" = "Wizard Step"::"3" THEN
        IF NOT "Team To-do" THEN
          IF "Salesperson Code" = '' THEN BEGIN
            IF Cont.GET("Contact No.") THEN
              VALIDATE("Salesperson Code",Cont."Salesperson Code")
            ELSE
              IF Cont.GET("Contact Company No.") THEN
                VALIDATE("Salesperson Code",Cont."Salesperson Code");
            IF Campaign.GET(GETFILTER("Campaign No.")) THEN
              VALIDATE("Salesperson Code",Campaign."Salesperson Code");
            IF Opp.GET(GETFILTER("Opportunity No.")) THEN
              VALIDATE("Salesperson Code",Opp."Salesperson Code");
            IF SegHeader.GET(GETFILTER("Segment No.")) THEN
              VALIDATE("Salesperson Code",SegHeader."Salesperson Code");
            MODIFY;
          END;
    END;

    PROCEDURE PerformPrevWizardStatus@52();
    BEGIN
      CASE "Wizard Step" OF
        "Wizard Step"::"3":
          BEGIN
            IF (Type = Type::Meeting) AND
               (NOT "Team To-do" OR
                (GETFILTER("Team Code") <> ''))
            THEN
              "Wizard Step" := "Wizard Step"::"1"
            ELSE
              "Wizard Step" := "Wizard Step"::"2";
          END;
        "Wizard Step"::"4":
          IF Type <> Type::Meeting THEN
            "Wizard Step" := "Wizard Step"::"2"
          ELSE
            "Wizard Step" := "Wizard Step"::"3";
        ELSE
          "Wizard Step" := "Wizard Step" - 1;
      END;
    END;

    PROCEDURE CheckStatus@42() : Boolean;
    BEGIN
      CASE "Wizard Step" OF
        "Wizard Step"::"1":
          BEGIN
            IF Date = 0D THEN
              ErrorMessage(FIELDCAPTION(Date));
            IF Description = '' THEN
              ErrorMessage(FIELDCAPTION(Description));
            IF (Type = Type::Meeting) AND (NOT "All Day Event") THEN BEGIN
              IF "Start Time" = 0T THEN
                ErrorMessage(FIELDCAPTION("Start Time"));
              IF Duration = 0 THEN
                ErrorMessage(FIELDCAPTION(Duration));
            END;
          END;
        "Wizard Step"::"2":
          BEGIN
            IF "Team To-do" AND ("Team Code" = '') THEN
              ErrorMessage(FIELDCAPTION("Team Code"));
            IF NOT "Team To-do" AND ("Salesperson Code" = '') THEN
              ErrorMessage(FIELDCAPTION("Salesperson Code"));
          END;
        "Wizard Step"::"3":
          BEGIN
            IF ("Interaction Template Code" = '') AND "Send on finish" THEN
              ErrorMessage(FIELDCAPTION("Interaction Template Code"));

            AttendeeTemp.RESET;
            // CurrForm.AttendeeSubform.PAGE.GetAttendee(AttendeeTemp);
            AttendeeTemp.SETRANGE("Attendance Type",AttendeeTemp."Attendance Type"::"To-do Organizer");
            IF AttendeeTemp.ISEMPTY THEN BEGIN
              AttendeeTemp.RESET;
              ERROR(Text065);
            END;

            IF AttendeeTemp.FIND('-') THEN
              SalesPurchPerson.GET(AttendeeTemp."Attendee No.");
            AttendeeTemp.RESET;
            // CurrForm.AttendeeSubform.PAGE.GetAttendee(AttendeeTemp);
            IF ("Attachment No." = 0) AND "Send on finish" THEN BEGIN
              AttendeeTemp.SETRANGE("Send Invitation",TRUE);
              AttendeeTemp.SETRANGE("Attendee Type",AttendeeTemp."Attendee Type"::Contact);
              IF NOT AttendeeTemp.ISEMPTY THEN BEGIN
                AttendeeTemp.RESET;
                ERROR(Text067,TABLECAPTION,AttendeeTemp.TABLECAPTION);
              END;
              AttendeeTemp.RESET;
            END;
            AttendeeTemp.RESET;
            // CurrForm.AttendeeSubform.PAGE.GetAttendee(AttendeeTemp);
            IF "Send on finish" THEN BEGIN
              AttendeeTemp.SETRANGE("Send Invitation",TRUE);
              IF AttendeeTemp.ISEMPTY THEN BEGIN
                AttendeeTemp.RESET;
                ERROR(Text068,AttendeeTemp.FIELDCAPTION("Send Invitation"));
              END;
              AttendeeTemp.RESET;
            END;
          END;
        "Wizard Step"::"4":
          BEGIN
            IF (Location = '') AND "Send on finish" THEN
              ErrorMessage(FIELDCAPTION(Location));
          END;
      END;
    END;

    PROCEDURE FinishWizard@41() : Boolean;
    VAR
      SegLine@1000 : Record 5077;
      SendOnFinish@1001 : Boolean;
    BEGIN
      IF Recurring THEN BEGIN
        TESTFIELD("Recurring Date Interval");
        TESTFIELD("Calc. Due Date From");
      END;
      IF Type = Type::Meeting THEN BEGIN
        IF NOT "Team To-do" THEN BEGIN
          AttendeeTemp.SETRANGE("Attendance Type",AttendeeTemp."Attendance Type"::"To-do Organizer");
          AttendeeTemp.FIND('-');
          VALIDATE("Salesperson Code",AttendeeTemp."Attendee No.");
          AttendeeTemp.RESET;
        END;
        VALIDATE("Contact No.",'');
      END ELSE BEGIN
        IF Cont.GET("Contact No.") THEN
          AttendeeTemp.CreateAttendee(
            AttendeeTemp,
            "No.",10000,AttendeeTemp."Attendance Type"::Required,
            AttendeeTemp."Attendee Type"::Contact,
            Cont."No.",Cont."E-Mail" <> '');
        IF SegHeader.GET("Segment No.") THEN BEGIN
          SegLine.SETRANGE("Segment No.","Segment No.");
          SegLine.SETFILTER("Contact No.",'<>%1','');
          IF SegLine.FIND('-') THEN
            REPEAT
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",SegLine."Line No.",AttendeeTemp."Attendance Type"::Required,
                AttendeeTemp."Attendee Type"::Contact,
                SegLine."Contact No.",
                (Cont.GET(SegLine."Contact No.") AND
                 (Cont."E-Mail" <> '')));
            UNTIL SegLine.NEXT = 0;
        END;
      END;

      SendOnFinish := "Send on finish";
      "Wizard Step" := "Wizard Step"::" ";
      "Team To-do" := FALSE;
      "Send on finish" := FALSE;
      "Segment Description" := '';
      "Team Meeting Organizer" := '';
      "Activity Code" := '';
      "Wizard Contact Name" := '';
      "Wizard Campaign Description" := '';
      "Wizard Opportunity Description" := '';
      MODIFY;
      InsertTodo(Rec,RMCommentLineTmp,AttendeeTemp,TodoInteractionLanguage,AttachmentTemp,'',SendOnFinish);
      DELETE;
    END;

    LOCAL PROCEDURE GetContactName@65() : Text[50];
    BEGIN
      IF Cont.GET("Contact No.") THEN
        EXIT(Cont.Name);
      IF Cont.GET("Contact Company No.") THEN
        EXIT(Cont.Name);
    END;

    LOCAL PROCEDURE ErrorMessage@47(FieldName@1000 : Text[1024]);
    BEGIN
      ERROR(Text043,FieldName);
    END;

    PROCEDURE AssignDefaultAttendeeInfo@46();
    VAR
      InteractionTemplate@1002 : Record 5064;
      InteractionTemplateSetup@1001 : Record 5122;
      SegLine@1003 : Record 5077;
      TeamSalesperson@1004 : Record 5084;
      AttendeeLineNo@1005 : Integer;
    BEGIN
      IF AttendeeTemp.FIND('+') THEN
        AttendeeLineNo := AttendeeTemp."Line No." + 10000
      ELSE
        AttendeeLineNo := 10000;
      CASE TRUE OF
        (GETFILTER("Contact No.") <> '') AND (GETFILTER("Salesperson Code") <> ''):
          BEGIN
            IF SalesPurchPerson.GET(GETFILTER("Salesperson Code")) THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::"To-do Organizer",
                AttendeeTemp."Attendee Type"::Salesperson,
                SalesPurchPerson.Code,TRUE);
              AttendeeLineNo := AttendeeLineNo + 10000;
              SalespersonFilter := SalesPurchPerson.Code;
            END;
            IF Cont.GET(GETFILTER("Contact No.")) THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::Required,
                AttendeeTemp."Attendee Type"::Contact,
                Cont."No.",
                Cont."E-Mail" <> '');
              AttendeeLineNo := AttendeeLineNo + 10000;
              ContactFilter := Cont."No.";
            END;
          END;
        (GETFILTER("Contact No.") <> '') AND (GETFILTER("Campaign No.") <> ''):
          BEGIN
            IF Campaign.GET(GETFILTER("Campaign No.")) THEN
              IF SalesPurchPerson.GET(Campaign."Salesperson Code") THEN BEGIN
                AttendeeTemp.CreateAttendee(
                  AttendeeTemp,
                  "No.",AttendeeLineNo,
                  AttendeeTemp."Attendance Type"::"To-do Organizer",
                  AttendeeTemp."Attendee Type"::Salesperson,
                  SalesPurchPerson.Code,TRUE);
                AttendeeLineNo := AttendeeLineNo + 10000
              END;
            IF Cont.GET(GETFILTER("Contact No.")) THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::Required,
                AttendeeTemp."Attendee Type"::Contact,
                Cont."No.",Cont."E-Mail" <> '');
              AttendeeLineNo := AttendeeLineNo + 10000;
              ContactFilter := Cont."No.";
            END;
          END
        ELSE BEGIN
          IF Cont.GET(GETFILTER("Contact No.")) THEN BEGIN
            IF Cont."Salesperson Code" <> '' THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::"To-do Organizer",
                AttendeeTemp."Attendee Type"::Salesperson,
                Cont."Salesperson Code",TRUE);
              AttendeeLineNo := AttendeeLineNo + 10000
            END;
            AttendeeTemp.CreateAttendee(
              AttendeeTemp,
              "No.",AttendeeLineNo,
              AttendeeTemp."Attendance Type"::Required,
              AttendeeTemp."Attendee Type"::Contact,
              Cont."No.",Cont."E-Mail" <> '');
            AttendeeLineNo := AttendeeLineNo + 10000;
            ContactFilter := Cont."No.";
          END ELSE
            IF Cont.GET(GETFILTER("Contact Company No.")) THEN BEGIN
              IF Cont."Salesperson Code" <> '' THEN BEGIN
                AttendeeTemp.CreateAttendee(
                  AttendeeTemp,
                  "No.",AttendeeLineNo,
                  AttendeeTemp."Attendance Type"::"To-do Organizer",
                  AttendeeTemp."Attendee Type"::Salesperson,
                  Cont."Salesperson Code",TRUE);
                AttendeeLineNo := AttendeeLineNo + 10000
              END;
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::Required,
                AttendeeTemp."Attendee Type"::Contact,
                Cont."No.",Cont."E-Mail" <> '');
              AttendeeLineNo := AttendeeLineNo + 10000;
              ContactFilter := Cont."No.";
            END;

          IF SalesPurchPerson.GET(GETFILTER("Salesperson Code")) THEN BEGIN
            AttendeeTemp.CreateAttendee(
              AttendeeTemp,
              "No.",AttendeeLineNo,
              AttendeeTemp."Attendance Type"::"To-do Organizer",
              AttendeeTemp."Attendee Type"::Salesperson,
              SalesPurchPerson.Code,TRUE);
            AttendeeLineNo := AttendeeLineNo + 10000;
            SalespersonFilter := SalesPurchPerson.Code;
          END;

          IF Campaign.GET(GETFILTER("Campaign No.")) THEN
            IF SalesPurchPerson.GET(Campaign."Salesperson Code") THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::"To-do Organizer",
                AttendeeTemp."Attendee Type"::Salesperson,
                SalesPurchPerson.Code,TRUE);
              AttendeeLineNo := AttendeeLineNo + 10000
            END;

          IF Opp.GET(GETFILTER("Opportunity No.")) THEN BEGIN
            IF SalesPurchPerson.GET(Opp."Salesperson Code") THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::"To-do Organizer",
                AttendeeTemp."Attendee Type"::Salesperson,
                SalesPurchPerson.Code,TRUE);
              AttendeeLineNo := AttendeeLineNo + 10000
            END;
            IF Cont.GET(Opp."Contact No.") THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::Required,
                AttendeeTemp."Attendee Type"::Contact,
                Cont."No.",Cont."E-Mail" <> '');
              AttendeeLineNo := AttendeeLineNo + 10000
            END;
          END;
        END;
      END;

      IF SegHeader.GET(GETFILTER("Segment No.")) THEN BEGIN
        IF SalesPurchPerson.GET(SegHeader."Salesperson Code") THEN BEGIN
          AttendeeTemp.CreateAttendee(
            AttendeeTemp,
            "No.",AttendeeLineNo,
            AttendeeTemp."Attendance Type"::"To-do Organizer",
            AttendeeTemp."Attendee Type"::Salesperson,
            SalesPurchPerson.Code,TRUE);
          AttendeeLineNo := AttendeeLineNo + 10000
        END;
        SegLine.SETRANGE("Segment No.","Segment No.");
        SegLine.SETFILTER("Contact No.",'<>%1','');
        IF SegLine.FIND('-') THEN
          REPEAT
            AttendeeTemp.CreateAttendee(
              AttendeeTemp,
              "No.",AttendeeLineNo,
              AttendeeTemp."Attendance Type"::Required,
              AttendeeTemp."Attendee Type"::Contact,
              SegLine."Contact No.",
              (Cont.GET(SegLine."Contact No.") AND
               (Cont."E-Mail" <> '')));
            AttendeeLineNo := AttendeeLineNo + 10000
          UNTIL SegLine.NEXT = 0;
      END;
      IF Team.GET("Team Code") THEN BEGIN
        TeamSalesperson.SETRANGE("Team Code",Team.Code);
        IF TeamSalesperson.FIND('-') THEN
          REPEAT
            AttendeeTemp.SETRANGE("Attendee Type",AttendeeTemp."Attendee Type"::Salesperson);
            AttendeeTemp.SETRANGE("Attendee No.",TeamSalesperson."Salesperson Code");
            IF NOT AttendeeTemp.FIND('-') THEN
              IF SalesPurchPerson.GET(TeamSalesperson."Salesperson Code") THEN BEGIN
                AttendeeTemp.RESET;
                AttendeeTemp.CreateAttendee(
                  AttendeeTemp,
                  "No.",AttendeeLineNo,
                  AttendeeTemp."Attendance Type"::Required,
                  AttendeeTemp."Attendee Type"::Salesperson,
                  TeamSalesperson."Salesperson Code",
                  SalesPurchPerson."E-Mail" <> '');
                AttendeeLineNo := AttendeeLineNo + 10000
              END;
            AttendeeTemp.RESET;
          UNTIL TeamSalesperson.NEXT = 0;
      END;

      InteractionTemplateSetup.GET;
      IF (InteractionTemplateSetup."Meeting Invitation" <> '') AND
         InteractionTemplate.GET(InteractionTemplateSetup."Meeting Invitation")
      THEN
        UpdateInteractionTemplate(
          Rec,TodoInteractionLanguage,AttachmentTemp,InteractionTemplate.Code,TRUE);
    END;

    PROCEDURE ValidateInteractionTemplCode@66();
    BEGIN
      UpdateInteractionTemplate(
        Rec,TodoInteractionLanguage,AttachmentTemp,"Interaction Template Code",TRUE);
      LoadTempAttachment;
    END;

    PROCEDURE AssistEditAttachment@58();
    BEGIN
      IF AttachmentTemp.GET("Attachment No.") THEN BEGIN
        AttachmentTemp.OpenAttachment("Interaction Template Code" + ' ' + Description,TRUE,"Language Code");
        AttachmentTemp.MODIFY;
      END ELSE
        ERROR(Text047);
    END;

    PROCEDURE ValidateLanguageCode@67();
    BEGIN
      IF "Language Code" = xRec."Language Code" THEN
        EXIT;

      IF NOT TodoInteractionLanguage.GET("No.","Language Code") THEN BEGIN
        IF "No." = '' THEN
          ERROR(Text009,TodoInteractionLanguage.TABLECAPTION);
      END ELSE
        "Attachment No." := TodoInteractionLanguage."Attachment No.";
    END;

    PROCEDURE LookupLanguageCode@68();
    BEGIN
      TodoInteractionLanguage.SETFILTER("To-do No.",'');
      IF TodoInteractionLanguage.GET('',"Language Code") THEN
        IF PAGE.RUNMODAL(0,TodoInteractionLanguage) = ACTION::LookupOK THEN BEGIN
          "Language Code" := TodoInteractionLanguage."Language Code";
          "Attachment No." := TodoInteractionLanguage."Attachment No.";
        END;
    END;

    LOCAL PROCEDURE UpdInteractionTemplate@57();
    BEGIN
      UpdateInteractionTemplate(
        Rec,TodoInteractionLanguage,AttachmentTemp,"Interaction Template Code",TRUE);
    END;

    PROCEDURE LoadTempAttachment@45();
    VAR
      Attachment@1000 : Record 5062;
      AttachmentTemp2@1001 : TEMPORARY Record 5062;
    BEGIN
      IF AttachmentTemp.FIND('-') THEN
        REPEAT
          AttachmentTemp2 := AttachmentTemp;
          AttachmentTemp2.INSERT;
        UNTIL AttachmentTemp.NEXT = 0;

      IF AttachmentTemp2.FIND('-') THEN
        REPEAT
          Attachment.GET(AttachmentTemp2."No.");
          Attachment.CALCFIELDS(Attachment);
          AttachmentTemp.GET(AttachmentTemp2."No.");
          AttachmentTemp.WizEmbeddAttachment(Attachment);
          AttachmentTemp."No." := AttachmentTemp2."No.";
          AttachmentTemp.MODIFY;
        UNTIL AttachmentTemp2.NEXT = 0;
    END;

    PROCEDURE ClearDefaultAttendeeInfo@44();
    BEGIN
      AttendeeTemp.DELETEALL;
      // CurrForm.AttendeeSubform.PAGE.SetAttendee(AttendeeTemp);
      // CurrForm.AttendeeSubform.PAGE.UpdateForm;
      AttachmentTemp.DELETEALL;
      TodoInteractionLanguage.DELETEALL;
      "Interaction Template Code" := '';
      "Language Code" := '';
      "Attachment No." := 0;
      Subject := '';
      "Unit Cost (LCY)" := 0;
      "Unit Duration (Min.)" := 0;
      MODIFY;
    END;

    PROCEDURE GetAttendee@59(VAR Attendee@1000 : Record 5199);
    BEGIN
      Attendee.DELETEALL;
      IF AttendeeTemp.FIND('-') THEN
        REPEAT
          Attendee := AttendeeTemp;
          Attendee.INSERT;
        UNTIL AttendeeTemp.NEXT = 0;
    END;

    PROCEDURE SetAttendee@49(VAR Attendee@1000 : Record 5199);
    BEGIN
      AttendeeTemp.DELETEALL;

      IF Attendee.FINDSET THEN
        REPEAT
          AttendeeTemp := Attendee;
          AttendeeTemp.INSERT;
        UNTIL Attendee.NEXT = 0;
    END;

    LOCAL PROCEDURE HasComment@55() : Boolean;
    BEGIN
      EXIT(NOT RMCommentLineTmp.ISEMPTY)
    END;

    LOCAL PROCEDURE ShowComment@56();
    BEGIN
      RMCommentLineTmp.SETRANGE("Table Name",RMCommentLineTmp."Table Name"::"To-do");
      RMCommentLineTmp.SETRANGE("No.","No.");
      RMCommentLineTmp.SETRANGE("Sub No.",0);
      PAGE.RUNMODAL(PAGE::"Rlshp. Mgt. Comment Sheet",RMCommentLineTmp);
    END;

    LOCAL PROCEDURE GetComments@64(VAR RMCommentLine@1001 : Record 5061);
    BEGIN
      RMCommentLine.DELETEALL;
      IF RMCommentLineTmp.FIND('-') THEN
        REPEAT
          RMCommentLine := RMCommentLineTmp;
          RMCommentLine.INSERT;
        UNTIL RMCommentLineTmp.NEXT = 0;
    END;

    PROCEDURE SetComments@53(VAR RMCommentLine@1001 : Record 5061);
    BEGIN
      RMCommentLineTmp.DELETEALL;

      IF RMCommentLine.FINDSET THEN
        REPEAT
          RMCommentLineTmp := RMCommentLine;
          RMCommentLineTmp.INSERT;
        UNTIL RMCommentLine.NEXT = 0;
    END;

    LOCAL PROCEDURE StartWizard2@63();
    BEGIN
      "Wizard Contact Name" := GetContactName;
      IF Cont.GET(GETFILTER("Contact No.")) THEN
        "Wizard Contact Name" := Cont.Name
      ELSE
        IF Cont.GET(GETFILTER("Contact Company No.")) THEN
          "Wizard Contact Name" := Cont.Name;

      IF Campaign.GET(GETFILTER("Campaign No.")) THEN
        "Wizard Campaign Description" := Campaign.Description;

      IF SegHeader.GET(GETFILTER("Segment No.")) THEN
        "Segment Description" := SegHeader.Description;

      "Wizard Step" := "Wizard Step"::"1";
      Duration := 1440 * 1000 * 60;

      INSERT;

      PAGE.RUNMODAL(PAGE::"Assign Activity",Rec);
    END;

    PROCEDURE PerformNextWizardStatus2@62();
    BEGIN
      "Wizard Step" := "Wizard Step" + 1;
    END;

    PROCEDURE PerformPrevWizardStatus2@61();
    BEGIN
      "Wizard Step" := "Wizard Step" - 1;
    END;

    PROCEDURE CheckStatus2@60() : Boolean;
    BEGIN
      CASE "Wizard Step" OF
        "Wizard Step"::"1":
          BEGIN
            IF "Activity Code" = '' THEN
              ErrorMessage(Text051);
            IF Date = 0D THEN
              ErrorMessage(FIELDCAPTION(Date));
            IF ("Team Code" = '') AND ("Salesperson Code" = '') THEN
              ERROR(Text053,FIELDCAPTION("Salesperson Code"),FIELDCAPTION("Team Code"));
            IF ("Team Code" <> '') AND
               Activity.IncludesMeeting("Activity Code") AND
               ("Team Meeting Organizer" = '')
            THEN
              ERROR(Text056,"Activity Code",Type::Meeting);
          END;
      END;
    END;

    PROCEDURE FinishWizard2@54() : Boolean;
    VAR
      RMCommentLine@1003 : TEMPORARY Record 5061;
      AttendeeTemp@1002 : TEMPORARY Record 5199;
      TodoInteractionLanguageTemp@1001 : TEMPORARY Record 5196;
      AttachmentTemp@1000 : TEMPORARY Record 5062;
    BEGIN
      AttendeeTemp.DELETEALL;
      IF "Team Meeting Organizer" <> '' THEN
        AttendeeTemp.CreateAttendee(
          AttendeeTemp,
          "No.",10000,AttendeeTemp."Attendance Type"::"To-do Organizer",
          AttendeeTemp."Attendee Type"::Salesperson,
          "Team Meeting Organizer",
          TRUE)
      ELSE
        IF "Salesperson Code" <> '' THEN
          AttendeeTemp.CreateAttendee(
            AttendeeTemp,
            "No.",10000,AttendeeTemp."Attendance Type"::"To-do Organizer",
            AttendeeTemp."Attendee Type"::Salesperson,
            "Salesperson Code",
            TRUE);
      InsertTodo(
        Rec,RMCommentLine,AttendeeTemp,
        TodoInteractionLanguageTemp,AttachmentTemp,"Activity Code",FALSE);
      DELETE;
    END;

    LOCAL PROCEDURE ValidateSalesPerson@71();
    BEGIN
      IF SalesPurchPerson.GET("Salesperson Code") THEN BEGIN
        "Team Meeting Organizer" := '';
        "Team Code" := ''
      END
    END;

    LOCAL PROCEDURE TransformFromCode20ToCode10@5(Code20Input@1000 : Code[20]) : Code[10];
    BEGIN
      IF STRLEN(Code20Input) > 10 THEN
        EXIT('');
      EXIT(COPYSTR(Code20Input,1,10));
    END;

    LOCAL PROCEDURE FillSalesPersonContact@8(VAR ToDoParameter@1000 : Record 5080;AttendeeParameter@1001 : Record 5199);
    BEGIN
      CASE AttendeeParameter."Attendee Type" OF
        AttendeeParameter."Attendee Type"::Contact:
          ToDoParameter.VALIDATE("Contact No.",AttendeeParameter."Attendee No.");
        AttendeeParameter."Attendee Type"::Salesperson:
          ToDoParameter.VALIDATE("Salesperson Code",TransformFromCode20ToCode10(AttendeeParameter."Attendee No."));
      END;
    END;

    PROCEDURE SetRunFromForm@11();
    BEGIN
      RunFormCode := TRUE;
    END;

    LOCAL PROCEDURE IsCalledFromForm@29() : Boolean;
    BEGIN
      EXIT((CurrFieldNo <> 0) OR RunFormCode);
    END;

    LOCAL PROCEDURE OneDayDuration@31() : Integer;
    BEGIN
      EXIT(86400000); // 24 * 60 * 60 * 1000 = 86,400,000 ms in 24 hours
    END;

    BEGIN
    {
      CM  20160706  Added CM* Fields
                    Added Code in OnInsert(), OnModify() and OnDelete() Trigger
                    Added Key "CM Is Task","CM Maintask No.","CM Assigned User ID","CM Status"
                    Added Key "Opportunity No.","CM Is Task","CM Assigned User ID","CM Status"
                    Added Key "CM Type,CM Objecttype,CM Object No."
    }
    END.
  }
}

OBJECT Table 5081 Activity
{
  OBJECT-PROPERTIES
  {
    Date=29.01.18;
    Time=09:59:48;
    Modified=Yes;
    Version List=NAVW17.00,CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=Code,Description;
    OnDelete=VAR
               ActivityStep@1000 : Record 5082;
             BEGIN
               ActivityStep.SETRANGE("Activity Code",Code);
               ActivityStep.DELETEALL;
             END;

    CaptionML=[ENU=Activity;
               DEA=Aktion];
    LookupPageID=Page5103;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              DEA=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 50200;  ;CM Priority         ;Option        ;CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High }
    { 50300;  ;CM Extended Description;Text250    ;CaptionML=[ENU=Extended Description;
                                                              DEA=Erweiterte Beschreibung] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE IncludesMeeting@1(ActivityCode@1000 : Code[10]) : Boolean;
    VAR
      ActivityStep@1001 : Record 5082;
    BEGIN
      WITH ActivityStep DO BEGIN
        SETCURRENTKEY("Activity Code",Type);
        SETRANGE("Activity Code",ActivityCode);
        SETRANGE(Type,Type::Meeting);
        EXIT(FINDFIRST);
      END;
    END;

    BEGIN
    {
      CM  20161020  Added CM* Fields
    }
    END.
  }
}

OBJECT Table 5082 Activity Step
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=14:56:01;
    Modified=Yes;
    Version List=NAVW16.00,CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               CMTaskMgt.WoTypeTaskOnInsert(Rec); //CM
             END;

    OnModify=BEGIN
               CMTaskMgt.WoTypeTaskOnModify(Rec,xRec); //CM
             END;

    OnDelete=BEGIN
               CMTaskMgt.WoTypeTaskOnDelete(Rec); //CM
             END;

    OnRename=BEGIN
               CMTaskMgt.WoTypeTaskOnRename(Rec, xRec); //CM
             END;

    CaptionML=[ENU=Activity Step;
               DEA=Aktionsschritt];
  }
  FIELDS
  {
    { 1   ;   ;Activity Code       ;Code10        ;TableRelation=Activity;
                                                   CaptionML=[ENU=Activity Code;
                                                              DEA=Aktionscode];
                                                   NotBlank=Yes }
    { 2   ;   ;Step No.            ;Integer       ;CaptionML=[ENU=Step No.;
                                                              DEA=Schrittnr.] }
    { 3   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              DEA=Art];
                                                   OptionCaptionML=[ENU=" ,Meeting,Phone Call";
                                                                    DEA=" ,Besprechung,Telefonat"];
                                                   OptionString=[ ,Meeting,Phone Call] }
    { 4   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 5   ;   ;Priority            ;Option        ;CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High }
    { 6   ;   ;Date Formula        ;DateFormula   ;CaptionML=[ENU=Date Formula;
                                                              DEA=Datumsformel] }
    { 50090;  ;CM Subtype          ;Option        ;CaptionML=[ENU=Subtype;
                                                              DEA=Subtyp];
                                                   OptionString=[ ,Checklist,Team] }
    { 50100;  ;CM Extended Description;Text250    ;CaptionML=[ENU=Extended Description;
                                                              DEA=Erweiterte Beschreibung] }
    { 50210;  ;CM Maintask Step No.;Integer       ;CaptionML=[ENU=Maintask Step No.;
                                                              DEA=Hauptaufg. Schrittnr.] }
    { 50300;  ;CM Planned Duration ;Duration      ;CaptionML=[ENU=Planned Duration;
                                                              DEA=Geplante Dauer] }
    { 50700;  ;CM Assigned User ID ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                CMTaskMgt.ValidateWoTypeTeam(Rec);
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              DEA=Zugewiesener Benutzer ID] }
    { 50705;  ;CM Assigned User Name;Text50       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(CM Assigned User ID)));
                                                   CaptionML=[ENU=Assigned User Name;
                                                              DEA=Zugwiesener Benutzername];
                                                   Description=FF;
                                                   Editable=No }
    { 51000;  ;CM Interaction Template Code;Code10;TableRelation="Interaction Template".Code;
                                                   CaptionML=[ENU=Interaction Template Code;
                                                              DEA=Aktivit„tenvorlage Code] }
    { 51010;  ;CM Wizard Action    ;Option        ;CaptionML=[ENU=Wizard Action;
                                                              DEA=Aktion des Assistenten];
                                                   OptionCaptionML=[ENU=" ,Open,Import,,,,,Information";
                                                                    DEA=" ,Dateianhang ”ffnen,Dateianhang importieren,,,,,Information"];
                                                   OptionString=[ ,Open,Import,,,,,Information];
                                                   Description=CM }
    { 51020;  ;CM Information Type ;Option        ;CaptionML=[ENU=Information Type;
                                                              DEA=Information Typ];
                                                   OptionCaptionML=[ENU=" ,Comment,Comment (long),,,,,,,,Replacement,Installation";
                                                                    DEA=" ,Kommentar,Kommentar (lang),,,,,,,,Austausch,Installation"];
                                                   OptionString=[ ,Comment,Comment (long),,,,,,,,Replacement,Installation];
                                                   Description=CM }
    { 51030;  ;CM Interaction Group Code;Code10   ;TableRelation="Interaction Group";
                                                   CaptionML=[ENU=Interaction Group Code;
                                                              DEA=Aktivit„tengruppencode];
                                                   NotBlank=Yes;
                                                   Description=CM }
  }
  KEYS
  {
    {    ;Activity Code,Step No.                  ;Clustered=Yes }
    {    ;Activity Code,Type                       }
    {    ;CM Maintask Step No.                     }
    {    ;Activity Code,CM Subtype                 }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      CMTaskMgt@1000000000 : Codeunit 70031;

    BEGIN
    {
      CM  20161020  Added CM* Fields
                    Added Key "CM Is CMMS WO Typ Task"
                    Added Key "CM Is CMMS WO Typ Task","CM Is Subtask"
                    Added Code in OnInsert(), OnModify(), OnDelete()
                    Added Key "Activity Code,CM Subtype"
    }
    END.
  }
}

OBJECT Table 5092 Opportunity
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=13:14:28;
    Modified=Yes;
    Version List=NAVW19.00.00.45834,CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Description;
    OnInsert=BEGIN
               CMWoMgt.OnInsert(Rec); //CM

               IF "No." = '' THEN BEGIN
                 RMSetup.GET;
                 RMSetup.TESTFIELD("Opportunity Nos.");
                 NoSeriesMgt.InitSeries(RMSetup."Opportunity Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
             END;

    OnModify=BEGIN
               CMWoMgt.OnModify(Rec,xRec); //CM
             END;

    OnDelete=VAR
               OppEntry@1000 : Record 5093;
             BEGIN
               CMWoMgt.OnDelete(Rec); //CM

               IF Status = Status::"In Progress" THEN
                 ERROR(Text000);

               RMCommentLine.SETRANGE("Table Name",RMCommentLine."Table Name"::Opportunity);
               RMCommentLine.SETRANGE("No.","No.");
               RMCommentLine.DELETEALL;

               OppEntry.SETCURRENTKEY("Opportunity No.");
               OppEntry.SETRANGE("Opportunity No.","No.");
               OppEntry.DELETEALL;
             END;

    CaptionML=[ENU=Opportunity;
               DEA=Verkaufschance];
    LookupPageID=Page5123;
    DrillDownPageID=Page5123;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  RMSetup.GET;
                                                                  NoSeriesMgt.TestManual(RMSetup."Opportunity Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              DEA=Nr.] }
    { 2   ;   ;Description         ;Text50        ;OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_Description(Rec,xRec);//CM
                                                              END;

                                                   CaptionML=[ENU=Description;
                                                              DEA=Beschreibung];
                                                   Description=CM }
    { 3   ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=VAR
                                                                Todo@1000 : Record 5080;
                                                                Todo2@1004 : Record 5080;
                                                                OppEntry@1001 : Record 5093;
                                                                Attendee@1005 : Record 5199;
                                                                Window@1009 : Dialog;
                                                                TotalRecordsNumber@1003 : Integer;
                                                                Counter@1002 : Integer;
                                                                StartTime@1007 : Time;
                                                                EndTime@1008 : Time;
                                                              BEGIN
                                                                IF ("Salesperson Code" <> xRec."Salesperson Code") AND
                                                                   (xRec."Salesperson Code" <> '') AND
                                                                   ("No." <> '')
                                                                THEN BEGIN
                                                                  TESTFIELD("Salesperson Code");
                                                                  Todo.RESET;
                                                                  Todo.SETCURRENTKEY("Opportunity No.",Date,Closed);
                                                                  Todo.SETRANGE("Opportunity No.","No.");
                                                                  Todo.SETRANGE(Closed,FALSE);
                                                                  Todo.SETRANGE("Salesperson Code",xRec."Salesperson Code");
                                                                  TotalRecordsNumber := Todo.COUNT;
                                                                  Counter := 0;
                                                                  IF Todo.FIND('-') THEN
                                                                    IF CONFIRM(Text008,FALSE,FIELDCAPTION("Salesperson Code")) THEN BEGIN
                                                                      Window.OPEN(Text012 + Text013);
                                                                      Window.UPDATE(2,Text014);
                                                                      StartTime := TIME;
                                                                      REPEAT
                                                                        Counter := Counter + 1;
                                                                        Window.UPDATE(1,ROUND(Counter / TotalRecordsNumber * 10000,1));
                                                                        IF Todo.Type = Todo.Type::Meeting THEN BEGIN
                                                                          Todo.GetMeetingOrganizerTodo(Todo2);
                                                                          IF Todo."Salesperson Code" <> Todo2."Salesperson Code" THEN BEGIN
                                                                            Todo.VALIDATE("Salesperson Code","Salesperson Code");
                                                                            Todo.MODIFY;
                                                                          END;
                                                                          Attendee.RESET;
                                                                          Attendee.SETRANGE("To-do No.",Todo2."No.");
                                                                          Attendee.SETRANGE("Attendee No.",xRec."Salesperson Code");
                                                                          Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Salesperson);
                                                                          Attendee.SETRANGE("Attendance Type",Attendee."Attendance Type"::Required,Attendee."Attendance Type"::Optional);
                                                                          IF Attendee.FINDFIRST THEN BEGIN
                                                                            Attendee.VALIDATE("Attendee No.","Salesperson Code");
                                                                            Attendee.MODIFY(TRUE);
                                                                          END;
                                                                        END
                                                                        ELSE BEGIN
                                                                          Todo.VALIDATE("Salesperson Code","Salesperson Code");
                                                                          Todo.MODIFY(TRUE);
                                                                        END;
                                                                      UNTIL Todo.NEXT = 0;
                                                                      EndTime := TIME;
                                                                      Window.CLOSE;
                                                                    END;

                                                                  OppEntry.RESET;
                                                                  OppEntry.SETCURRENTKEY(Active,"Opportunity No.");
                                                                  OppEntry.SETRANGE(Active,TRUE);
                                                                  OppEntry.SETRANGE("Opportunity No.","No.");
                                                                  IF OppEntry.FIND('-') THEN
                                                                    REPEAT
                                                                      OppEntry."Salesperson Code" := "Salesperson Code";
                                                                      OppEntry.MODIFY;
                                                                    UNTIL OppEntry.NEXT = 0;

                                                                  MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Salesperson Code;
                                                              DEA=Verk„ufercode] }
    { 4   ;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   OnValidate=VAR
                                                                Todo@1001 : Record 5080;
                                                                OppEntry@1000 : Record 5093;
                                                              BEGIN
                                                                IF ("Campaign No." <> xRec."Campaign No.") AND
                                                                   ("No." <> '')
                                                                THEN BEGIN
                                                                  Todo.RESET;
                                                                  Todo.SETCURRENTKEY("Opportunity No.",Date,Closed);
                                                                  Todo.SETRANGE("Opportunity No.","No.");
                                                                  Todo.SETRANGE(Closed,FALSE);
                                                                  Todo.SETRANGE("Campaign No.",xRec."Campaign No.");
                                                                  IF Todo.FIND('-') THEN
                                                                    IF CONFIRM(Text008,FALSE,FIELDCAPTION("Campaign No.")) THEN
                                                                      REPEAT
                                                                        Todo."Campaign No." := "Campaign No.";
                                                                        Todo.MODIFY;
                                                                      UNTIL Todo.NEXT = 0;

                                                                  OppEntry.RESET;
                                                                  OppEntry.SETCURRENTKEY(Active,"Opportunity No.");
                                                                  OppEntry.SETRANGE(Active,TRUE);
                                                                  OppEntry.SETRANGE("Opportunity No.","No.");
                                                                  IF OppEntry.FIND('-') THEN
                                                                    REPEAT
                                                                      OppEntry."Campaign No." := "Campaign No.";
                                                                      OppEntry.MODIFY;
                                                                    UNTIL OppEntry.NEXT = 0;

                                                                  MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Campaign No.;
                                                              DEA=Kampagnennr.] }
    { 5   ;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1000 : Record 5050;
                                                                Todo@1002 : Record 5080;
                                                                Todo2@1005 : Record 5080;
                                                                OppEntry@1001 : Record 5093;
                                                                SalesHeader@1003 : Record 36;
                                                                Attendee@1004 : Record 5199;
                                                                Window@1007 : Dialog;
                                                                TotalRecordsNumber@1011 : Integer;
                                                                Counter@1012 : Integer;
                                                                StartTime@1008 : Time;
                                                                EndTime@1009 : Time;
                                                              BEGIN
                                                                TESTFIELD("Contact No.");
                                                                Cont.GET("Contact No.");

                                                                IF ("Contact No." <> xRec."Contact No.") AND
                                                                   (xRec."Contact No." <> '') AND
                                                                   ("No." <> '')
                                                                THEN BEGIN
                                                                  CALCFIELDS("Contact Name");
                                                                  IF ("Contact Company No." <> Cont."Company No.") AND
                                                                     (Status <> Status::"Not Started")
                                                                  THEN
                                                                    ERROR(Text009,Cont."No.",Cont.Name);

                                                                  IF ("Sales Document No." <> '') AND ("Sales Document Type" = "Sales Document Type"::Quote) THEN BEGIN
                                                                    SalesHeader.GET(SalesHeader."Document Type"::Quote,"Sales Document No.");
                                                                    IF SalesHeader."Sell-to Contact No." <> "Contact No." THEN BEGIN
                                                                      MODIFY;
                                                                      SalesHeader.SetHideValidationDialog(TRUE);
                                                                      SalesHeader.VALIDATE("Sell-to Contact No.","Contact No.");
                                                                      SalesHeader.MODIFY
                                                                    END
                                                                  END;
                                                                  Todo.RESET;
                                                                  Todo.SETCURRENTKEY("Opportunity No.",Date,Closed);
                                                                  Todo.SETRANGE("Opportunity No.","No.");
                                                                  Todo.SETRANGE(Closed,FALSE);
                                                                  Todo.SETRANGE("Contact No.",xRec."Contact No.");
                                                                  TotalRecordsNumber := Todo.COUNT;
                                                                  Counter := 0;
                                                                  IF Todo.FIND('-') THEN
                                                                    IF CONFIRM(Text008,FALSE,FIELDCAPTION("Contact No.")) THEN BEGIN
                                                                      Window.OPEN(Text012 + Text013);
                                                                      Window.UPDATE(2,Text014);
                                                                      StartTime := TIME;
                                                                      REPEAT
                                                                        Counter := Counter + 1;
                                                                        Window.UPDATE(1,ROUND(Counter / TotalRecordsNumber * 10000,1));
                                                                        IF Todo.Type = Todo.Type::Meeting THEN BEGIN
                                                                          Todo.GetMeetingOrganizerTodo(Todo2);
                                                                          Todo.VALIDATE("Contact No.","Contact No.");
                                                                          Todo.MODIFY;
                                                                          Attendee.RESET;
                                                                          Attendee.SETRANGE("To-do No.",Todo2."No.");
                                                                          Attendee.SETRANGE("Attendee No.",xRec."Contact No.");
                                                                          Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Contact);
                                                                          IF Attendee.FINDFIRST THEN BEGIN
                                                                            Attendee.VALIDATE("Attendee No.","Contact No.");
                                                                            Attendee.MODIFY(TRUE);
                                                                          END;
                                                                        END ELSE BEGIN
                                                                          Todo.VALIDATE("Contact No.","Contact No.");
                                                                          Todo.MODIFY(TRUE);
                                                                        END;
                                                                      UNTIL Todo.NEXT = 0;
                                                                      EndTime := TIME;
                                                                      Window.CLOSE;
                                                                    END;

                                                                  OppEntry.RESET;
                                                                  OppEntry.SETCURRENTKEY(Active,"Opportunity No.");
                                                                  OppEntry.SETRANGE(Active,TRUE);
                                                                  OppEntry.SETRANGE("Opportunity No.","No.");
                                                                  IF OppEntry.FIND('-') THEN
                                                                    REPEAT
                                                                      OppEntry.VALIDATE("Contact No.","Contact No.");
                                                                      OppEntry.MODIFY;
                                                                    UNTIL OppEntry.NEXT = 0;

                                                                  MODIFY;
                                                                END;

                                                                "Contact Company No." := Cont."Company No.";
                                                                CALCFIELDS("Contact Name","Contact Company Name");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1000 : Record 5050;
                                                            BEGIN
                                                              IF Cont.GET("Contact No.") THEN BEGIN
                                                                IF Status <> Status::"Not Started" THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.");
                                                                IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                  xRec."Contact No." := "Contact No.";
                                                                  VALIDATE("Contact No.",Cont."No.");
                                                                END;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Contact No.;
                                                              DEA=Kontaktnr.] }
    { 6   ;   ;Contact Company No. ;Code20        ;TableRelation=Contact WHERE (Type=CONST(Company));
                                                   CaptionML=[ENU=Contact Company No.;
                                                              DEA=Kontakt Unternehmensnr.] }
    { 7   ;   ;Sales Cycle Code    ;Code10        ;TableRelation="Sales Cycle";
                                                   OnValidate=VAR
                                                                SalesCycle@1000 : Record 5090;
                                                              BEGIN
                                                                SalesCycle.GET("Sales Cycle Code");
                                                                SalesCycle.TESTFIELD(Blocked,FALSE);
                                                              END;

                                                   CaptionML=[ENU=Sales Cycle Code;
                                                              DEA=Verkaufsprozesscode] }
    { 8   ;   ;Sales Document No.  ;Code20        ;TableRelation=IF (Sales Document Type=CONST(Quote)) "Sales Header".No. WHERE (Document Type=CONST(Quote),
                                                                                                                                 Sell-to Contact No.=FIELD(Contact No.))
                                                                                                                                 ELSE IF (Sales Document Type=CONST(Order)) "Sales Header".No. WHERE (Document Type=CONST(Order),
                                                                                                                                                                                                      Sell-to Contact No.=FIELD(Contact No.))
                                                                                                                                                                                                      ELSE IF (Sales Document Type=CONST(Posted Invoice)) "Sales Invoice Header".No. WHERE (Sell-to Contact No.=FIELD(Contact No.));
                                                   OnValidate=VAR
                                                                Opp@1000 : Record 5092;
                                                                SalesHeader@1001 : Record 36;
                                                              BEGIN
                                                                IF "Sales Document No." = '' THEN BEGIN
                                                                  "Sales Document Type" := "Sales Document Type"::" ";
                                                                  IF xRec."Sales Document Type" = "Sales Document Type"::Quote THEN
                                                                    IF SalesHeader.GET(SalesHeader."Document Type"::Quote,xRec."Sales Document No.") THEN BEGIN
                                                                      SalesHeader."Opportunity No." := '';
                                                                      SalesHeader.MODIFY
                                                                    END
                                                                END ELSE
                                                                  IF "Sales Document No." <> xRec."Sales Document No." THEN BEGIN
                                                                    Opp.RESET;
                                                                    Opp.SETCURRENTKEY("Sales Document Type","Sales Document No.");
                                                                    Opp.SETRANGE("Sales Document Type","Sales Document Type");
                                                                    Opp.SETRANGE("Sales Document No.","Sales Document No.");
                                                                    IF Opp.FINDFIRST THEN
                                                                      IF Opp."No." <> "No." THEN
                                                                        ERROR(Text006,Opp."Sales Document Type",Opp."Sales Document No.",Opp."No.");

                                                                    IF xRec."Sales Document Type" = "Sales Document Type"::Quote THEN
                                                                      IF SalesHeader.GET(SalesHeader."Document Type"::Quote,xRec."Sales Document No.") THEN BEGIN
                                                                        SalesHeader."Opportunity No." := '';
                                                                        SalesHeader.MODIFY
                                                                      END;
                                                                    IF "Sales Document Type" = "Sales Document Type"::Quote THEN
                                                                      IF SalesHeader.GET(SalesHeader."Document Type"::Quote,"Sales Document No.") THEN BEGIN
                                                                        SalesHeader."Opportunity No." := "No.";
                                                                        SalesHeader.MODIFY
                                                                      END
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Sales Document No.;
                                                              DEA=Verkaufsbelegnr.] }
    { 9   ;   ;Creation Date       ;Date          ;CaptionML=[ENU=Creation Date;
                                                              DEA=Errichtungsdatum] }
    { 10  ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionCaptionML=[ENU=Not Started,In Progress,Won,Lost;
                                                                    DEA=Nicht begonnen,In Bearbeitung,Gewonnen,Verloren];
                                                   OptionString=Not Started,In Progress,Won,Lost;
                                                   Editable=No }
    { 11  ;   ;Priority            ;Option        ;InitValue=Normal;
                                                   OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_Priority(Rec,xRec);//CM
                                                              END;

                                                   CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High }
    { 12  ;   ;Closed              ;Boolean       ;CaptionML=[ENU=Closed;
                                                              DEA=Abgeschlossen];
                                                   Editable=No }
    { 13  ;   ;Date Closed         ;Date          ;CaptionML=[ENU=Date Closed;
                                                              DEA=Abgeschlossen am];
                                                   Editable=No }
    { 15  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              DEA=Nummernserie];
                                                   Editable=No }
    { 16  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Rlshp. Mgt. Comment Line" WHERE (Table Name=CONST(Opportunity),
                                                                                                       No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung];
                                                   Editable=No }
    { 17  ;   ;Current Sales Cycle Stage;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Opportunity Entry"."Sales Cycle Stage" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                     Active=CONST(Yes)));
                                                   CaptionML=[ENU=Current Sales Cycle Stage;
                                                              DEA=Aktuelle Verkaufsprozess-Stufe];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 18  ;   ;Estimated Value (LCY);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Estimated Value (LCY)" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                      Active=CONST(Yes)));
                                                   CaptionML=[ENU=Estimated Value (LCY);
                                                              DEA=Erwarteter Wert (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 19  ;   ;Probability %       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Opportunity Entry"."Probability %" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                 Active=CONST(Yes)));
                                                   CaptionML=[ENU=Probability %;
                                                              DEA=Wahrscheinlichkeit %];
                                                   DecimalPlaces=1:1;
                                                   Editable=No }
    { 20  ;   ;Calcd. Current Value (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Calcd. Current Value (LCY)" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                           Active=CONST(Yes)));
                                                   CaptionML=[ENU=Calcd. Current Value (LCY);
                                                              DEA=Berech. aktueller Wert (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 21  ;   ;Chances of Success %;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Opportunity Entry"."Chances of Success %" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                        Active=CONST(Yes)));
                                                   CaptionML=[ENU=Chances of Success %;
                                                              DEA=Erfolgschancen %];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 22  ;   ;Completed %         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Opportunity Entry"."Completed %" WHERE (Opportunity No.=FIELD(No.),
                                                                                                               Active=CONST(Yes)));
                                                   CaptionML=[ENU=Completed %;
                                                              DEA=Abgeschlossen %];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 23  ;   ;Contact Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact No.)));
                                                   CaptionML=[ENU=Contact Name;
                                                              DEA=Kontaktname];
                                                   Editable=No }
    { 24  ;   ;Contact Company Name;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact Company No.)));
                                                   CaptionML=[ENU=Contact Company Name;
                                                              DEA=Kontakt Unternehmensname];
                                                   Editable=No }
    { 25  ;   ;Salesperson Name    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Salesperson Code)));
                                                   CaptionML=[ENU=Salesperson Name;
                                                              DEA=Verk„ufername];
                                                   Editable=No }
    { 26  ;   ;Campaign Description;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Campaign.Description WHERE (No.=FIELD(Campaign No.)));
                                                   CaptionML=[ENU=Campaign Description;
                                                              DEA=Kampagnenbeschreibung];
                                                   Editable=No }
    { 27  ;   ;Segment No.         ;Code20        ;TableRelation="Segment Header";
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Segment No.;
                                                              DEA=Segmentnr.] }
    { 28  ;   ;Estimated Closing Date;Date        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Opportunity Entry"."Estimated Close Date" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                        Active=CONST(Yes)));
                                                   CaptionML=[ENU=Estimated Closing Date;
                                                              DEA=Erwartetes Abschlussdatum];
                                                   Editable=No }
    { 29  ;   ;Sales Document Type ;Option        ;OnValidate=BEGIN
                                                                IF "Sales Document Type" = xRec."Sales Document Type" THEN
                                                                  EXIT;
                                                                IF "Sales Document Type" = "Sales Document Type"::" " THEN
                                                                  VALIDATE("Sales Document No.",'');
                                                              END;

                                                   CaptionML=[ENU=Sales Document Type;
                                                              DEA=Verkaufsbelegart];
                                                   OptionCaptionML=[ENU=" ,Quote,Order,Posted Invoice";
                                                                    DEA=" ,Angebot,Auftrag,Gebuchte Rechnung"];
                                                   OptionString=[ ,Quote,Order,Posted Invoice] }
    { 30  ;   ;No. of Interactions ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (Opportunity No.=FIELD(FILTER(No.)),
                                                                                                    Canceled=CONST(No),
                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=No. of Interactions;
                                                              DEA=Anzahl Aktivit„ten];
                                                   Editable=No }
    { 9501;   ;Wizard Step         ;Option        ;CaptionML=[ENU=Wizard Step;
                                                              DEA=Assistentenschritt];
                                                   OptionCaptionML=[ENU=" ,1,2,3,4,5,6";
                                                                    DEA=" ,1,2,3,4,5,6"];
                                                   OptionString=[ ,1,2,3,4,5,6];
                                                   Editable=No }
    { 9502;   ;Activate First Stage;Boolean       ;CaptionML=[ENU=Activate First Stage;
                                                              DEA=Erste Stufe aktivieren] }
    { 9503;   ;Segment Description ;Text50        ;CaptionML=[ENU=Segment Description;
                                                              DEA=Segmentbeschreibung] }
    { 9504;   ;Wizard Estimated Value (LCY);Decimal;
                                                   CaptionML=[ENU=Wizard Estimated Value (LCY);
                                                              DEA=Assistent fr erwarteten Wert (MW)];
                                                   AutoFormatType=1 }
    { 9505;   ;Wizard Chances of Success %;Decimal;CaptionML=[ENU=Wizard Chances of Success %;
                                                              DEA=Assistent fr Erfolgschancen %];
                                                   DecimalPlaces=0:0 }
    { 9506;   ;Wizard Estimated Closing Date;Date ;CaptionML=[ENU=Wizard Estimated Closing Date;
                                                              DEA=Assistent fr erwartetes Abschlussdatum] }
    { 9507;   ;Wizard Contact Name ;Text50        ;CaptionML=[ENU=Wizard Contact Name;
                                                              DEA=Assistent fr Kontaktname] }
    { 9508;   ;Wizard Campaign Description;Text50 ;CaptionML=[ENU=Wizard Campaign Description;
                                                              DEA=Assistent fr Kampagnenbeschreibung] }
    { 50000;  ;CM Is Workorder     ;Boolean       ;CaptionML=[ENU=Is Workorder;
                                                              DEA=Ist Arbeitsauftrag] }
    { 50010;  ;CM Source           ;Option        ;CaptionML=[ENU=Source;
                                                              DEA=Herkunft];
                                                   OptionString=Standard,Alarm,Recuring,Request,Manual Alarm }
    { 50020;  ;CM Source Description;Text50       ;CaptionML=[ENU=Source Description;
                                                              DEA=Herkunftsbeschreibung] }
    { 50090;  ;CM Objecttype       ;Option        ;OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_CMObjectType(Rec, xRec);
                                                              END;

                                                   CaptionML=[ENU=Objecttype;
                                                              DEA=Objeckttyp];
                                                   OptionString=Asset,Project }
    { 50100;  ;CM Object No.       ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=FIELD(CM Objecttype));
                                                   OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_CMObjectNo(Rec, xRec);
                                                              END;

                                                   CaptionML=[ENU=Object No.;
                                                              DEA=Objektnr.] }
    { 50110;  ;CM Object Name      ;Text50        ;CaptionML=[ENU=Object Name;
                                                              DEA=Objektname];
                                                   Editable=No }
    { 50111;  ;CM Object Name 2    ;Text100       ;CaptionML=[ENU=Object Name 2;
                                                              DEA=Objektname 2];
                                                   Editable=No }
    { 50200;  ;CM Work Order Type Code;Code10     ;TableRelation=Activity.Code;
                                                   OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_CMWorkorderTypeCode(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Workorder Type Code;
                                                              DEA=Arbeitsauftrag Typ Code] }
    { 50210;  ;CM Work Order Type Descr.;Text50   ;CaptionML=[ENU=Workorder Type Description;
                                                              DEA=Arbeitsauftrag Typ Beschreibung] }
    { 50300;  ;CM Status           ;Option        ;OnValidate=BEGIN
                                                                //New = Newly created,
                                                                //Open = Assigned to User and ready to be done
                                                                //In Process = Some Tasks are Completed, some are open
                                                                //Completed = All Tasks are Done, but Approval from Plant Manager needed
                                                                //Done = All Tasks are Done, Plant Manager Approved
                                                                //Closed = Closed by Plant Manager
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionString=New,Open,In Process,Completed,Done,Discarded }
    { 50400;  ;CM Due Date         ;Date          ;OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_DueDates(Rec, xRec);
                                                              END;

                                                   CaptionML=[ENU=Due Date;
                                                              DEA=F„lligkeitsdatum] }
    { 50410;  ;CM Scheduled Due Date;Date         ;OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_DueDates(Rec, xRec);
                                                              END;

                                                   CaptionML=[ENU=Scheduled Due Date (Planned);
                                                              DEA=Geplantes F„lligkeitsdatum] }
    { 50700;  ;CM Assigned User ID ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_CMAssignedUserID(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              DEA=Zugewiesener Benutzer ID] }
    { 50705;  ;CM Assigned User Name;Text80       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(CM Assigned User ID)));
                                                   CaptionML=[ENU=Assigned User Name;
                                                              DEA=Zugwiesener Benutzername];
                                                   Description=FF;
                                                   Editable=No }
    { 50810;  ;CM Created By User ID;Code50       ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=Created By User ID;
                                                              DEA=Erstell von Benutzer ID];
                                                   Editable=No }
    { 50840;  ;CM Created Datetime ;DateTime       }
    { 60200;  ;CM Done Pos. Tasks  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Task),
                                                                                  Opportunity No.=FIELD(No.),
                                                                                  CM Status=CONST(Done Positive),
                                                                                  CM Maintask No.=CONST()));
                                                   CaptionML=[ENU=Positive Done Tasks;
                                                              DEA=Positiv Erledig. Aufgaben] }
    { 60300;  ;CM Done Neg. Tasks  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Task),
                                                                                  Opportunity No.=FIELD(No.),
                                                                                  CM Status=CONST(Done Negative),
                                                                                  CM Maintask No.=CONST()));
                                                   CaptionML=[ENU=Negative Done Tasks;
                                                              DEA=Negativ Erledig. Aufgaben] }
    { 60400;  ;CM Billing Info     ;Option        ;CaptionML=ENU=Billing Info;
                                                   OptionString=[ ,Billable,Included in contract,Internal costs] }
    { 60410;  ;CM Internal         ;Boolean       ;CaptionML=[ENU=Internal;
                                                              DEA=Intern] }
    { 60420;  ;CM Status Change Standard Text;Option;
                                                   CaptionML=ENU=Status Change Standard Text;
                                                   OptionString=[ ,False alarm,Alarm condition disappeared,Technician has been informed,Work started,Technician is on site,Technician is on the way,Operational work has been finished,Work Order needs to be invoiced,Plant back in production,Alarm solved,Communication issue,Internet connection problem,On-Site Check has been scheduled];
                                                   Editable=No }
    { 60500;  ;CM Open Tasks       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Task),
                                                                                  Opportunity No.=FIELD(No.),
                                                                                  CM Status=CONST(Open),
                                                                                  CM Subtype=CONST(" ")));
                                                   CaptionML=[ENU=Open Tasks;
                                                              DEA=Offene Tasks];
                                                   Description=FF;
                                                   Editable=No }
    { 60510;  ;CM Finished Tasks   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Task),
                                                                                  Opportunity No.=FIELD(No.),
                                                                                  CM Status=FILTER(<>Open),
                                                                                  CM Subtype=CONST(" ")));
                                                   CaptionML=[ENU=Finished Tasks;
                                                              DEA=Erledigte Tasks];
                                                   Description=FF;
                                                   Editable=No }
    { 60521;  ;CM All Tasks Finished;Boolean      ;FieldClass=FlowField;
                                                   CalcFormula=-Exist(To-do WHERE (CM Type=CONST(Task),
                                                                                   Opportunity No.=FIELD(No.),
                                                                                   CM Status=CONST(Open),
                                                                                   CM Subtype=CONST(" ")));
                                                   CaptionML=[ENU=All Tasks Finished;
                                                              DEA=Alle Tasks Erledigt];
                                                   Description=FF;
                                                   Editable=No }
    { 60530;  ;CM Subcontractor No.;Code20        ;TableRelation=Contact.No.;
                                                   CaptionML=[ENU=Subcontractor No.;
                                                              DEA=Sublieferant Nr.] }
    { 60540;  ;CM Email Notification;Boolean      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object"."Email Notification" WHERE (Objecttype=FIELD(CM Objecttype),
                                                                                                                No.=FIELD(CM Object No.)));
                                                   CaptionML=ENU=Email Notification;
                                                   Description=FF;
                                                   Editable=No }
    { 61000;  ;CM GPM Ticket Id    ;Integer       ;CaptionML=[ENU=Ticket ID;
                                                              DEA=Ticket ID] }
    { 61001;  ;CM GPM Ticket Name  ;Text150       ;CaptionML=ENU=Ticket Name }
    { 61010;  ;CM GPM Grouping     ;Option        ;CaptionML=[ENU=Grouping;
                                                              DEA=Grouping];
                                                   OptionString=[ ,Communications,Production,Warnings,Manuals,Scheduled] }
    { 61020;  ;CM GPM Activated DateTime;DateTime ;CaptionML=[ENU=Activated DateTime;
                                                              DEA=Activated DateTime] }
    { 61021;  ;CM GPM Activated Date;Date         ;CaptionML=[ENU=Activated Date;
                                                              DEA=Activated Date] }
    { 61022;  ;CM GPM Activated Time;Time         ;CaptionML=[ENU=Activated Time;
                                                              DEA=Activated Time] }
    { 61030;  ;CM GPM Deactivated DateTime;DateTime;
                                                   CaptionML=[ENU=Deactivated DateTime;
                                                              DEA=Deactivated DateTime] }
    { 61031;  ;CM GPM Deactivated Date;Date       ;CaptionML=[ENU=Deactivated Date;
                                                              DEA=Deactivated Date] }
    { 61032;  ;CM GPM Deactivated Time;Time       ;CaptionML=[ENU=Deactivated Time;
                                                              DEA=Deactivated Time] }
    { 61033;  ;CM GPM Reference Element ID;Integer;CaptionML=ENU=Reference Element ID }
    { 61034;  ;CM GPM Reference Element Name;Text250;
                                                   CaptionML=ENU=Reference Element Name }
    { 61040;  ;CM GPM Prority      ;Integer       ;CaptionML=[ENU=Priority;
                                                              DEA=Priority] }
    { 61050;  ;CM GPM State        ;Option        ;CaptionML=[ENU=PV+ Alarm State;
                                                              DEA=PV+ Alarm State];
                                                   OptionString=[ ,Activated,Assigned,Deactivated,Deactivated and Assigned] }
    { 61060;  ;CM GPM Alert Type   ;Option        ;CaptionML=[ENU=Alert Type;
                                                              DEA=Alert Type];
                                                   OptionString=[ ,Usual Alert,Alert with Ticket] }
    { 61070;  ;CM GPM Activation Description;BLOB ;CaptionML=[ENU=Activation Description;
                                                              DEA=Activation Description] }
    { 61080;  ;CM GPM Deactivation Descr.;BLOB    ;CaptionML=[ENU=Deactivation Description;
                                                              DEA=Deactivation Description] }
    { 61090;  ;CM GPM Activation Details;BLOB     ;CaptionML=[ENU=Activation Details;
                                                              DEA=Activation Details] }
    { 61100;  ;CM GPM Deactivation Details;BLOB   ;CaptionML=[ENU=Deactivation Details;
                                                              DEA=Deactivation Details] }
    { 61101;  ;CM GPM Plant ID     ;Integer       ;CaptionML=ENU=GPM Plant ID }
    { 61110;  ;CM GPM Affects Availibility;Boolean;CaptionML=[ENU=Affects Availibility;
                                                              DEA=Affects Availibility] }
    { 61120;  ;CM GPM Calculate Loss;Boolean      ;CaptionML=[ENU=Calculate Loss;
                                                              DEA=Calculate Loss] }
    { 61130;  ;CM GPM Problem Description;BLOB    ;CaptionML=[ENU=Problem Description;
                                                              DEA=Problem Description] }
    { 61140;  ;CM GPM Company      ;Text50        ;CaptionML=[ENU=Company;
                                                              DEA=Company] }
    { 61150;  ;CM GPM Ticket Duration;Integer     ;CaptionML=[ENU=Ticket Durations;
                                                              DEA=Ticket Durations] }
    { 61160;  ;CM GPM Actions Performed;BLOB      ;CaptionML=[ENU=Actions Performed;
                                                              DEA=Actions Performed] }
    { 61170;  ;CM GPM Maintenance Type;Option     ;CaptionML=[ENU=Maintenance Type;
                                                              DEA=Maintenance Type];
                                                   OptionString=[ ,Undefined Maintenance,NotSpecified Maintenance,Corrective Maintenance,Preventive Maintenance,Deductive Maintenance] }
    { 61180;  ;CM GPM Notified DateTime;DateTime  ;CaptionML=[ENU=Notified DateTime;
                                                              DEA=Notified DateTime] }
    { 61181;  ;CM GPM Notified Date;Date          ;CaptionML=[ENU=Notified Date;
                                                              DEA=Notified Date] }
    { 61182;  ;CM GPM Notified Time;Time          ;CaptionML=[ENU=Notified Time;
                                                              DEA=Notified Time] }
    { 62000;  ;CM GPM No. of Updates;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS GPM Ticket Archive" WHERE (ticket_id=FIELD(CM GPM Ticket Id),
                                                                                                      Workorder No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. Of Updates;
                                                              DEA=No. Of Updates];
                                                   Description=FF;
                                                   Editable=No }
    { 70000;  ;CM Is Temporary     ;Boolean       ;CaptionML=[ENU=Is Temporary;
                                                              DEA=Ist Tempor„r] }
    { 90000;  ;CM Show Workorder   ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (Opportunity No.=FIELD(No.),
                                                                                  CM Assigned User ID=FIELD(CM User ID Filter),
                                                                                  CM Status=CONST(Open),
                                                                                  CM Type=CONST(Task),
                                                                                  CM Subtype=FILTER(' '|Team)));
                                                   CaptionML=ENU=CM Show Workorder;
                                                   Description=FF;
                                                   Editable=No }
    { 90100;  ;CM User ID Filter   ;Text250       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=User ID Filter;
                                                              DEA=Benutzer-ID-Filter] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Contact Company No.,Contact No.,Closed   }
    {    ;Salesperson Code,Closed                  }
    {    ;Campaign No.,Closed                      }
    {    ;Segment No.,Closed                       }
    {    ;Sales Document Type,Sales Document No.   }
    {    ;CM Is Workorder,CM Object No.            }
    {    ;CM Is Workorder,CM Objecttype,CM Object No.,CM Source,CM Source Description,Creation Date }
    {    ;CM Is Workorder,CM Status,CM Source      }
    {    ;CM Is Workorder,CM Source                }
    {    ;CM Is Workorder,CM Assigned User ID      }
    {    ;CM Is Workorder,Priority,CM Objecttype,CM Object No. }
    {    ;CM Is Workorder,CM Objecttype,CM Object No.,Priority }
    {    ;CM Is Workorder,CM Objecttype,CM Object No.,No. }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Description,Creation Date,Status     }
    { 2   ;Brick               ;No.,Description,CM Status,CM Object Name,Priority,CM GPM Activated Date }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot delete this opportunity while it is active.;DEA=Sie k”nnen diese Verkaufschance nicht l”schen, solange sie in Bearbeitung ist.';
      Text001@1001 : TextConst 'ENU=You cannot create opportunities on an empty segment.;DEA=Sie k”nnen keine Verkaufschancen fr ein leeres Segment erstellen.';
      Text002@1002 : TextConst 'ENU=Do you want to create an opportunity for all contacts in the %1 segment?;DEA=M”chten Sie eine Verkaufschance fr alle Kontakte im Segment %1 erstellen?';
      Text003@1009 : TextConst 'ENU=There is no sales quote that is assigned to this opportunity.;DEA=Dieser Verkaufschance ist kein Verkaufsangebot zugeordnet.';
      Text004@1003 : TextConst 'ENU=Sales quote %1 does not exist.;DEA=Das Verkaufsangebot ''%1'' ist nicht vorhanden.';
      Text005@1005 : TextConst 'ENU=You cannot assign a sales quote to the %2 record of the %1 while the %2 record of the %1 has no contact company assigned.;DEA=Sie k”nnen dem Datensatz %2 kein Angebot von %1 zuweisen, solange dem Datensatz %2 von %1 kein Kontaktunternehmen zugewiesen ist.';
      RMSetup@1011 : Record 5079;
      Opp@1012 : Record 5092;
      RMCommentLine@1013 : Record 5061;
      SegHeader@1018 : Record 5076;
      OppEntry@1020 : Record 5093;
      RMCommentLineTmp@1022 : TEMPORARY Record 5061;
      NoSeriesMgt@1014 : Codeunit 396;
      Text006@1004 : TextConst 'ENU=Sales %1 %2 is already assigned to opportunity %3.;DEA=Verkauf %1 %2 wurde bereits der Verkaufschance %3 zugewiesen.';
      Text008@1007 : TextConst 'ENU=Do you want to change %1 on the related open to-dos with the same %1?;DEA=M”chten Sie den %1 in den zugeh”rigen offenen Aufgaben mit derselben/demselben %1 „ndern?';
      Text009@1008 : TextConst 'ENU=Contact %1 %2 is related to another company.;DEA=Kontakt %1 %2 ist mit einem anderen Unternehmen verknpft.';
      Text011@1010 : TextConst 'ENU=A sales quote has already been assigned to this opportunity.;DEA=Dieser Verkaufschance wurde bereits ein Verkaufsangebot zugewiesen.';
      Text012@1017 : TextConst 'ENU=Current process @1@@@@@@@@@@@@@@@\;DEA=Aktueller Prozess @1@@@@@@@@@@@@@@@\';
      Text013@1016 : TextConst 'ENU=Current status  #2###############;DEA=Aktueller Status  #2###############';
      Text014@1015 : TextConst 'ENU=Updating To-dos;DEA=Aufgaben werden aktualisiert';
      Text022@1026 : TextConst 'ENU=You must fill in the %1 field.;DEA=Sie mssen das Feld %1 ausfllen.';
      Text023@1025 : TextConst 'ENU=You must fill in the contact that is involved in the opportunity.;DEA=Sie mssen den Kontakt, auf den sich diese Verkaufschance bezieht, ausfllen.';
      Text024@1024 : TextConst 'ENU=%1 must be greater than 0.;DEA=%1 muss gr”áer als 0 sein.';
      Text025@1023 : TextConst 'ENU=The Estimated closing date has to be later than this change;DEA=Das erwartete Abschlussdatum muss nach dem Datum dieser Žnderung liegen';
      NoCustomerErr@1006 : TextConst '@@@=%1 - Contact No;ENU=There is no customer related to contact %1, which is specified in the opportunity.;DEA=Dem Kontakt %1, der in der Verkaufschance angegeben ist, ist kein Debitor zugeordnet.';
      CMWoMgt@1000000000 : Codeunit 70030;

    PROCEDURE CreateOppFromOpp@1(VAR Opp@1007 : Record 5092);
    VAR
      Cont@1001 : Record 5050;
      SalesPurchPerson@1002 : Record 13;
      Campaign@1003 : Record 5071;
      SegHeader@1004 : Record 5076;
      SegLine@1005 : Record 5077;
      SalesCycle@1006 : Record 5090;
    BEGIN
      DELETEALL;
      INIT;
      "Creation Date" := WORKDATE;
      RMSetup.GET;
      IF RMSetup."Default Sales Cycle Code" <> '' THEN
        IF SalesCycle.GET(RMSetup."Default Sales Cycle Code") THEN
          IF NOT SalesCycle.Blocked THEN
            "Sales Cycle Code" := RMSetup."Default Sales Cycle Code";
      IF Cont.GET(Opp.GETFILTER("Contact Company No.")) THEN BEGIN
        VALIDATE("Contact No.",Cont."No.");
        "Salesperson Code" := Cont."Salesperson Code";
        SETRANGE("Contact Company No.","Contact No.");
      END;
      IF Cont.GET(Opp.GETFILTER("Contact No.")) THEN BEGIN
        VALIDATE("Contact No.",Cont."No.");
        "Salesperson Code" := Cont."Salesperson Code";
        SETRANGE("Contact No.","Contact No.");
      END;
      IF SalesPurchPerson.GET(Opp.GETFILTER("Salesperson Code")) THEN BEGIN
        "Salesperson Code" := SalesPurchPerson.Code;
        SETRANGE("Salesperson Code","Salesperson Code");
      END;
      IF Campaign.GET(Opp.GETFILTER("Campaign No.")) THEN BEGIN
        "Campaign No." := Campaign."No.";
        "Salesperson Code" := Campaign."Salesperson Code";
        SETRANGE("Campaign No.","Campaign No.");
      END;
      IF SegHeader.GET(Opp.GETFILTER("Segment No.")) THEN BEGIN
        SegLine.SETRANGE("Segment No.",SegHeader."No.");
        IF SegLine.COUNT = 0 THEN
          ERROR(Text001);
        "Segment No." := SegHeader."No.";
        "Campaign No." := SegHeader."Campaign No.";
        "Salesperson Code" := SegHeader."Salesperson Code";
        SETRANGE("Segment No.","Segment No.");
      END;

      StartWizard;
    END;

    LOCAL PROCEDURE InsertOpportunity@3(VAR Opp2@1000 : Record 5092;OppEntry2@1004 : Record 5093;VAR RMCommentLineTmp@1007 : Record 5061;ActivateFirstStage@1006 : Boolean);
    VAR
      SegHeader@1001 : Record 5076;
      SegLine@1002 : Record 5077;
      SalesCycleStage@1003 : Record 5091;
      OppEntry@1005 : Record 5093;
    BEGIN
      Opp := Opp2;

      IF ActivateFirstStage THEN BEGIN
        SalesCycleStage.RESET;
        SalesCycleStage.SETRANGE("Sales Cycle Code",Opp."Sales Cycle Code");
        IF SalesCycleStage.FINDFIRST THEN
          OppEntry2."Sales Cycle Stage" := SalesCycleStage.Stage;
      END;

      IF SegHeader.GET(GETFILTER("Segment No.")) THEN BEGIN
        SegLine.SETRANGE("Segment No.",SegHeader."No.");
        SegLine.SETFILTER("Contact No.",'<>%1','');
        IF SegLine.FIND('-') THEN BEGIN
          IF CONFIRM(Text002,TRUE,SegHeader."No.") THEN
            REPEAT
              Opp."Contact No." := SegLine."Contact No.";
              Opp."Contact Company No." := SegLine."Contact Company No.";
              CLEAR(Opp."No.");
              Opp.INSERT(TRUE);
              CreateCommentLines(RMCommentLineTmp,Opp."No.");
              IF ActivateFirstStage THEN BEGIN
                OppEntry.INIT;
                OppEntry := OppEntry2;
                OppEntry.InitOpportunityEntry(Opp);
                OppEntry.InsertEntry(OppEntry,FALSE,TRUE);
                OppEntry.UpdateEstimates;
              END;
            UNTIL SegLine.NEXT = 0;
        END;
      END ELSE BEGIN
        Opp.INSERT(TRUE);
        CreateCommentLines(RMCommentLineTmp,Opp."No.");
        IF ActivateFirstStage THEN BEGIN
          OppEntry.INIT;
          OppEntry := OppEntry2;
          OppEntry.InitOpportunityEntry(Opp);
          OppEntry.InsertEntry(OppEntry,FALSE,TRUE);
          OppEntry.UpdateEstimates;
        END;
      END;
    END;

    PROCEDURE UpdateOpportunity@4();
    VAR
      TempOppEntry@1000 : TEMPORARY Record 5093;
    BEGIN
      IF "No." <> '' THEN
        TempOppEntry.UpdateOppFromOpp(Rec);
    END;

    PROCEDURE CloseOpportunity@5();
    VAR
      TempOppEntry@1000 : TEMPORARY Record 5093;
    BEGIN
      IF "No." <> '' THEN
        TempOppEntry.CloseOppFromOpp(Rec);
    END;

    PROCEDURE AssignQuote@6();
    VAR
      Cont@1001 : Record 5050;
      ContactBusinessRelation@1002 : Record 5054;
      SalesHeader@1000 : Record 36;
    BEGIN
      Cont.GET("Contact No.");

      IF (Cont.Type = Cont.Type::Person) AND (Cont."Company No." = '') THEN
        ERROR(
          Text005,
          Cont.TABLECAPTION,Cont."No.");

      ContactBusinessRelation.SETRANGE("Contact No.","Contact No.");
      ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
      IF ContactBusinessRelation.ISEMPTY THEN
        ERROR(NoCustomerErr,"Contact No.");

      TESTFIELD(Status,Status::"In Progress");

      IF NOT SalesHeader.GET(SalesHeader."Document Type"::Quote,"Sales Document No.") THEN BEGIN
        SalesHeader.SETRANGE("Sell-to Contact No.",Cont."No.");
        SalesHeader.INIT;
        SalesHeader."Document Type" := SalesHeader."Document Type"::Quote;
        SalesHeader.INSERT(TRUE);
        SalesHeader.VALIDATE("Salesperson Code","Salesperson Code");
        SalesHeader.VALIDATE("Campaign No.","Campaign No.");
        SalesHeader."Opportunity No." := "No.";
        SalesHeader."Order Date" := GetEstimatedClosingDate;
        SalesHeader."Shipment Date" := SalesHeader."Order Date";
        SalesHeader.MODIFY;
        "Sales Document Type" := "Sales Document Type"::Quote;
        "Sales Document No." := SalesHeader."No.";
        MODIFY;
      END ELSE
        ERROR(Text011);
      PAGE.RUN(PAGE::"Sales Quote",SalesHeader);
    END;

    LOCAL PROCEDURE GetEstimatedClosingDate@8() : Date;
    VAR
      OppEntry@1000 : Record 5093;
    BEGIN
      OppEntry.SETCURRENTKEY(Active,"Opportunity No.");
      OppEntry.SETRANGE(Active,TRUE);
      OppEntry.SETRANGE("Opportunity No.","No.");
      IF OppEntry.FINDFIRST THEN
        EXIT(OppEntry."Estimated Close Date");
    END;

    PROCEDURE ShowQuote@2();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      IF SalesHeader.GET(SalesHeader."Document Type"::Quote,"Sales Document No.") THEN
        PAGE.RUNMODAL(PAGE::"Sales Quote",SalesHeader);
    END;

    LOCAL PROCEDURE CreateCommentLines@7(VAR RMCommentLineTmp@1001 : Record 5061;OppNo@1000 : Code[20]);
    BEGIN
      IF RMCommentLineTmp.FIND('-') THEN
        REPEAT
          RMCommentLine.INIT;
          RMCommentLine := RMCommentLineTmp;
          RMCommentLine."No." := OppNo;
          RMCommentLine.INSERT;
        UNTIL RMCommentLineTmp.NEXT = 0;
    END;

    LOCAL PROCEDURE StartWizard@11();
    VAR
      Cont@1000 : Record 5050;
      Campaign@1001 : Record 5071;
      SegHeader@1002 : Record 5076;
    BEGIN
      "Wizard Step" := "Wizard Step"::"1";

      IF Cont.GET(GETFILTER("Contact No.")) THEN
        "Wizard Contact Name" := Cont.Name
      ELSE
        IF Cont.GET(GETFILTER("Contact Company No.")) THEN
          "Wizard Contact Name" := Cont.Name;

      IF Campaign.GET(GETFILTER("Campaign No.")) THEN
        "Wizard Campaign Description" := Campaign.Description;
      IF SegHeader.GET(GETFILTER("Segment No.")) THEN
        "Segment Description" := SegHeader.Description;

      INSERT;
      PAGE.RUNMODAL(PAGE::"Create Opportunity",Rec);
    END;

    PROCEDURE PerformNextWizardStatus@9();
    VAR
      Cont@1001 : Record 5050;
    BEGIN
      "Wizard Step" := "Wizard Step" + 1;

      IF "Wizard Step" = "Wizard Step"::"2" THEN BEGIN
        CLEAR(Cont);
        IF Cont.GET(GETFILTER("Contact No.")) THEN
          "Contact Name" := Cont.Name
        ELSE
          IF Cont.GET(GETFILTER("Contact Company No.")) THEN
            "Contact Name" := Cont.Name;
      END;
    END;

    PROCEDURE PerformPrevWizardStatus@12();
    BEGIN
      "Wizard Step" := "Wizard Step" - 1;
    END;

    PROCEDURE CheckStatus@16();
    BEGIN
      CASE "Wizard Step" OF
        "Wizard Step"::"1":
          BEGIN
            IF "Creation Date" = 0D THEN
              ErrorMessage(FIELDCAPTION("Creation Date"));
            IF Description = '' THEN
              ErrorMessage(FIELDCAPTION(Description));
          END;
        "Wizard Step"::"2":
          BEGIN
            IF NOT SegHeader.GET(GETFILTER("Segment No.")) THEN
              IF "Contact No." = '' THEN
                ERROR(Text023);
            IF "Salesperson Code" = '' THEN
              ErrorMessage(FIELDCAPTION("Salesperson Code"));
            IF "Sales Cycle Code" = '' THEN
              ErrorMessage(FIELDCAPTION("Sales Cycle Code"));
          END;
        "Wizard Step"::"4":
          IF "Activate First Stage" THEN BEGIN
            IF "Wizard Estimated Value (LCY)" <= 0 THEN
              ERROR(Text024,FIELDCAPTION("Wizard Estimated Value (LCY)"));
            IF "Wizard Chances of Success %" <= 0 THEN
              ERROR(Text024,FIELDCAPTION("Wizard Chances of Success %"));
            IF "Wizard Estimated Closing Date" = 0D THEN
              ErrorMessage(FIELDCAPTION("Wizard Estimated Closing Date"));
            IF "Wizard Estimated Closing Date" < OppEntry."Date of Change" THEN
              ERROR(Text025);
          END;
      END;
    END;

    PROCEDURE FinishWizard@18() : Boolean;
    VAR
      ActivateFirstStage@1000 : Boolean;
    BEGIN
      "Wizard Step" := Opp."Wizard Step"::" ";
      ActivateFirstStage := "Activate First Stage";
      "Activate First Stage" := FALSE;
      OppEntry."Chances of Success %" := "Wizard Chances of Success %";
      OppEntry."Estimated Close Date" := "Wizard Estimated Closing Date";
      OppEntry."Estimated Value (LCY)" := "Wizard Estimated Value (LCY)";

      "Wizard Chances of Success %" := 0;
      "Wizard Estimated Closing Date" := 0D;
      "Wizard Estimated Value (LCY)" := 0;
      "Segment Description" := '';
      "Wizard Contact Name" := '';
      "Wizard Campaign Description" := '';

      InsertOpportunity(Rec,OppEntry,RMCommentLineTmp,ActivateFirstStage);
      DELETE;
    END;

    LOCAL PROCEDURE ErrorMessage@10(FieldName@1000 : Text[1024]);
    BEGIN
      ERROR(Text022,FieldName);
    END;

    LOCAL PROCEDURE ShowComments@13();
    BEGIN
      RMCommentLineTmp.SETRANGE("Table Name",RMCommentLineTmp."Table Name"::Opportunity);
      RMCommentLineTmp.SETRANGE("No.","No.");
      RMCommentLineTmp.SETRANGE("Sub No.",0);
      PAGE.RUNMODAL(PAGE::"Rlshp. Mgt. Comment Sheet",RMCommentLineTmp);
    END;

    LOCAL PROCEDURE CommentsExist@14() : Boolean;
    BEGIN
      EXIT(NOT RMCommentLineTmp.ISEMPTY)
    END;

    LOCAL PROCEDURE GetComments@64(VAR RMCommentLine@1001 : Record 5061);
    BEGIN
      RMCommentLine.DELETEALL;
      IF RMCommentLineTmp.FIND('-') THEN
        REPEAT
          RMCommentLine := RMCommentLineTmp;
          RMCommentLine.INSERT;
        UNTIL RMCommentLineTmp.NEXT = 0;
    END;

    PROCEDURE SetComments@53(VAR RMCommentLine@1001 : Record 5061);
    BEGIN
      RMCommentLineTmp.DELETEALL;

      IF RMCommentLine.FINDSET THEN
        REPEAT
          RMCommentLineTmp := RMCommentLine;
          RMCommentLineTmp.INSERT;
        UNTIL RMCommentLine.NEXT = 0;
    END;

    PROCEDURE ShowSalesQuoteWithCheck@15();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      IF ("Sales Document Type" <> "Sales Document Type"::Quote) OR
         ("Sales Document No." = '')
      THEN
        ERROR(Text003);

      IF NOT SalesHeader.GET(SalesHeader."Document Type"::Quote,"Sales Document No.") THEN
        ERROR(Text004,"Sales Document No.");
      PAGE.RUN(PAGE::"Sales Quote",SalesHeader);
    END;

    BEGIN
    END.
  }
}

OBJECT Table 5714 Responsibility Center
{
  OBJECT-PROPERTIES
  {
    Date=30.09.16;
    Time=13:41:10;
    Modified=Yes;
    Version List=NAVW19.00,CMMS;
  }
  PROPERTIES
  {
    OnDelete=BEGIN
               DimMgt.DeleteDefaultDim(DATABASE::"Responsibility Center",Code);
             END;

    CaptionML=[ENU=Responsibility Center;
               DEA=Zust„ndigkeitseinheitencode];
    LookupPageID=Page5715;
    DrillDownPageID=Page5715;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              DEA=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Name                ;Text50        ;CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 3   ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              DEA=Adresse] }
    { 4   ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              DEA=Adresse 2] }
    { 5   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              DEA=Ort] }
    { 6   ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              DEA=PLZ-Code] }
    { 7   ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              DEA=L„nder-/Regionscode] }
    { 8   ;   ;Phone No.           ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              DEA=Telefonnr.] }
    { 9   ;   ;Fax No.             ;Text30        ;CaptionML=[ENU=Fax No.;
                                                              DEA=Faxnr.] }
    { 10  ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              DEA=Name 2] }
    { 11  ;   ;Contact             ;Text50        ;CaptionML=[ENU=Contact;
                                                              DEA=Kontakt] }
    { 12  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              DEA=Globaler Dimensionscode 1];
                                                   CaptionClass='1,1,1' }
    { 13  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              DEA=Globaler Dimensionscode 2];
                                                   CaptionClass='1,1,2' }
    { 14  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[ENU=Location Code;
                                                              DEA=Lagerortcode] }
    { 15  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              DEA=Bundesregion] }
    { 102 ;   ;E-Mail              ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail;
                                                              DEA=E-Mail] }
    { 103 ;   ;Home Page           ;Text90        ;ExtendedDatatype=URL;
                                                   CaptionML=[ENU=Home Page;
                                                              DEA=Homepage] }
    { 5900;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              DEA=Datumsfilter] }
    { 5901;   ;Contract Gain/Loss Amount;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Contract Gain/Loss Entry".Amount WHERE (Responsibility Center=FIELD(Code),
                                                                                                            Change Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Contract Gain/Loss Amount;
                                                              DEA=Gewinn-/Verlustbetrag (Vertr.)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 50000;  ;Company Name        ;Text30        ;TableRelation=Company.Name;
                                                   CaptionML=[ENU=Company Name;
                                                              DEA=Mandantenname] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;Code,Name,Location Code                  }
  }
  CODE
  {
    VAR
      PostCode@1000 : Record 225;
      DimMgt@1001 : Codeunit 408;

    LOCAL PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::"Responsibility Center",Code,FieldNumber,ShortcutDimCode);
      MODIFY;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 50002 ENC Report Buffer
{
  OBJECT-PROPERTIES
  {
    Date=12.03.18;
    Time=15:30:30;
    Modified=Yes;
    Version List=ENC,SHFT,CMMS;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer        }
    { 10  ;   ;Dim1                ;Code20         }
    { 20  ;   ;Dim2                ;Code20         }
    { 50  ;   ;DimSetID1           ;Integer        }
    { 60  ;   ;DimSetID2           ;Integer        }
    { 100 ;   ;DocNo1              ;Code20         }
    { 110 ;   ;DocNo2              ;Code20         }
    { 150 ;   ;PostingDate1        ;Date           }
    { 151 ;   ;PostingDate2        ;Date           }
    { 200 ;   ;SourceNo1           ;Code50         }
    { 210 ;   ;SourceNo2           ;Code50         }
    { 300 ;   ;ProductNo1          ;Code20         }
    { 310 ;   ;ProductNo2          ;Code20         }
    { 400 ;   ;UoM1                ;Code20         }
    { 500 ;   ;Qty1                ;Decimal        }
    { 510 ;   ;Qty2                ;Decimal        }
    { 520 ;   ;Qty3                ;Decimal        }
    { 530 ;   ;Qty4                ;Decimal        }
    { 700 ;   ;Amount1             ;Decimal        }
    { 710 ;   ;Amount2             ;Decimal        }
    { 720 ;   ;Amount3             ;Decimal        }
    { 730 ;   ;Amount4             ;Decimal        }
    { 740 ;   ;Amount5             ;Decimal        }
    { 750 ;   ;Amount6             ;Decimal        }
    { 800 ;   ;CurFactor1          ;Decimal        }
    { 810 ;   ;CurFactor2          ;Decimal        }
    { 900 ;   ;Weight1             ;Decimal        }
    { 910 ;   ;Weight2             ;Decimal        }
    { 920 ;   ;Weight3             ;Decimal        }
    { 1000;   ;UserID1             ;Code50         }
    { 1100;   ;Type1               ;Option        ;OptionString=0,1,2,3,4,5,6,7,8,9 }
    { 1110;   ;Type2               ;Option        ;OptionString=0,1,2,3,4,5,6,7,8,9 }
    { 1200;   ;TypeText1           ;Text250        }
    { 1210;   ;TypeText2           ;Text250        }
    { 1300;   ;CountryCode1        ;Code10         }
    { 5000;   ;Text1               ;Text250        }
    { 5010;   ;Text2               ;Text250        }
    { 5020;   ;Text3               ;Text250        }
    { 5030;   ;Text4               ;Text250        }
    { 6000;   ;Year1               ;Integer        }
    { 6100;   ;Quarter1            ;Integer        }
    { 6200;   ;Month1              ;Integer        }
    { 7000;   ;PostingGrp1         ;Code20         }
    { 7010;   ;PostingGrp2         ;Code20         }
    { 7020;   ;PostingGrp3         ;Code20         }
    { 7021;   ;PostingGrp4         ;Code20         }
    { 8000;   ;EntryNo1            ;Integer        }
    { 8010;   ;EntryNo2            ;Integer        }
    { 8020;   ;EntryNo3            ;Integer        }
    { 9000;   ;OK1                 ;Boolean        }
    { 9010;   ;OK2                 ;Boolean        }
    { 9020;   ;OK3                 ;Boolean        }
    { 10000;  ;FromTime            ;Time           }
    { 10010;  ;ToTime              ;Time           }
    { 10020;  ;FromTime2           ;Time           }
    { 10030;  ;ToTime2             ;Time           }
    { 10040;  ;FromTime3           ;Time           }
    { 10050;  ;ToTime3             ;Time           }
    { 10060;  ;FromTime4           ;Time           }
    { 10070;  ;ToTime4             ;Time           }
    { 11000;  ;LineNo1             ;Integer        }
    { 11010;  ;LineNo2             ;Integer        }
    { 11020;  ;LineNo3             ;Integer        }
    { 11030;  ;LineNo4             ;Integer        }
    { 12000;  ;Int1                ;Integer        }
    { 12010;  ;Int2                ;Integer        }
    { 12020;  ;Int3                ;Integer        }
    { 12030;  ;Int4                ;Integer        }
    { 12040;  ;Int5                ;Integer        }
    { 12050;  ;Int6                ;Integer        }
    { 12060;  ;Int7                ;Integer        }
    { 13000;  ;blob1               ;BLOB           }
    { 13010;  ;blob2               ;BLOB           }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Dim2,SourceNo1                           }
    {    ;ProductNo1,SourceNo2                     }
    {    ;SourceNo1,TypeText1,ProductNo1           }
    {    ;Month1,SourceNo1                         }
    {    ;SourceNo1,Text3                          }
    {    ;DimSetID1,DimSetID2                      }
    {    ;SourceNo1,SourceNo2,PostingDate1         }
    {    ;SourceNo1,SourceNo2,PostingDate1,EntryNo1 }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 50004 CMMS GPM Ticket
{
  OBJECT-PROPERTIES
  {
    Date=07.06.17;
    Time=15:35:50;
    Modified=Yes;
    Version List=CMMS,GPM;
  }
  PROPERTIES
  {
    OnInsert=VAR
               GPMTicketArchive@1000000000 : Record 50005;
             BEGIN
               {
                 This table should be used only as Temporary Table for the Webservice!
               }
             END;

  }
  FIELDS
  {
    { 100 ;   ;id                  ;Integer       ;AutoIncrement=Yes }
    { 200 ;   ;ticket_id           ;Integer        }
    { 210 ;   ;deleted             ;Boolean        }
    { 300 ;   ;name                ;Text150        }
    { 400 ;   ;grouping            ;Integer        }
    { 500 ;   ;activated_time      ;DateTime       }
    { 600 ;   ;deactivated_time    ;DateTime       }
    { 700 ;   ;reference_plant_id  ;Integer        }
    { 800 ;   ;reference_element_id;Integer        }
    { 810 ;   ;reference_element_name;Text250      }
    { 900 ;   ;priority            ;Integer        }
    { 1000;   ;reference_alerm_id  ;Integer        }
    { 1100;   ;state               ;Integer        }
    { 1200;   ;alert_type          ;Integer        }
    { 1300;   ;operator_name       ;Text50         }
    { 1400;   ;activation_description_BLOB;BLOB    }
    { 1500;   ;deactivation_description_BLOB;BLOB  }
    { 1600;   ;activation_details_BLOB;BLOB        }
    { 1700;   ;deactivation_details_BLOB;BLOB      }
    { 1800;   ;affects_availibility;Boolean        }
    { 1900;   ;calculate_loss      ;Boolean        }
    { 2000;   ;repercussion_id     ;Integer        }
    { 2100;   ;affected_element_id ;Integer        }
    { 2200;   ;reason_id           ;Integer        }
    { 2300;   ;problem_description_BLOB;BLOB       }
    { 2400;   ;company             ;Text50         }
    { 2500;   ;time_t              ;Integer        }
    { 2600;   ;actions_performed_BLOB;BLOB         }
    { 2700;   ;maintenance_type_id ;Integer        }
    { 2800;   ;reference_element_type_id;Integer   }
    { 2900;   ;notified_time       ;DateTime       }
    { 3000;   ;estimated_activation_time;DateTime  }
    { 3100;   ;operator_id         ;Integer        }
  }
  KEYS
  {
    {    ;id                                      ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetBlobValues@1000000002(VAR activation_description@1000000005 : Text;VAR deactivation_description@1000000004 : Text;VAR activation_details@1000000003 : Text;VAR deactivation_details@1000000002 : Text;VAR problem_description@1000000001 : Text;VAR actions_performed@1000000000 : Text);
    VAR
      InStr@1000000006 : InStream;
      CMGenMgt@1000000007 : Codeunit 70000;
    BEGIN
      Rec.CALCFIELDS(activation_description_BLOB);
      Rec.CALCFIELDS(deactivation_description_BLOB);
      Rec.CALCFIELDS(activation_details_BLOB);
      Rec.CALCFIELDS(deactivation_details_BLOB);
      Rec.CALCFIELDS(problem_description_BLOB);
      Rec.CALCFIELDS(actions_performed_BLOB);

      Rec.activation_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      activation_description := CMGenMgt.Instream2Text(InStr);

      Rec.deactivation_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      deactivation_description := CMGenMgt.Instream2Text(InStr);

      Rec.activation_details_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      activation_details := CMGenMgt.Instream2Text(InStr);

      Rec.deactivation_details_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      deactivation_details := CMGenMgt.Instream2Text(InStr);

      Rec.problem_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      problem_description := CMGenMgt.Instream2Text(InStr);

      Rec.actions_performed_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      actions_performed := CMGenMgt.Instream2Text(InStr);
    END;

    PROCEDURE SetBlobValues@1000000000(activation_description@1000000005 : Text;deactivation_description@1000000004 : Text;activation_details@1000000003 : Text;deactivation_details@1000000002 : Text;problem_description@1000000001 : Text;actions_performed@1000000000 : Text);
    VAR
      OutStr@1000000006 : OutStream;
    BEGIN
      CLEAR(Rec.activation_description_BLOB);
      CLEAR(Rec.deactivation_description_BLOB);
      CLEAR(Rec.activation_details_BLOB);
      CLEAR(Rec.deactivation_details_BLOB);
      CLEAR(Rec.problem_description_BLOB);
      CLEAR(Rec.actions_performed_BLOB);

      Rec.activation_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(activation_description);

      Rec.deactivation_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(deactivation_description);

      Rec.activation_details_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(activation_details);

      Rec.deactivation_details_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(deactivation_details);

      Rec.problem_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(problem_description);

      Rec.actions_performed_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(actions_performed);

      //IF NOT Rec.MODIFY(FALSE) THEN
        //;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 50005 CMMS GPM Ticket Archive
{
  OBJECT-PROPERTIES
  {
    Date=02.01.18;
    Time=16:34:16;
    Modified=Yes;
    Version List=CMMS,GPM;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               "Creation Date" := TODAY;
               "Creation Time" := TIME;

               CMIfMgt.ProcessRecord(Rec, FALSE);
             END;

    CaptionML=ENU=CMMS GPM Ticket Archive;
    LookupPageID=Page70002;
    DrillDownPageID=Page70002;
  }
  FIELDS
  {
    { 100 ;   ;id                  ;Integer       ;AutoIncrement=Yes }
    { 200 ;   ;ticket_id           ;Integer        }
    { 210 ;   ;deleted             ;Boolean        }
    { 300 ;   ;name                ;Text150        }
    { 400 ;   ;grouping            ;Integer        }
    { 500 ;   ;activated_time      ;DateTime       }
    { 501 ;   ;activated_time_DATE ;Date           }
    { 502 ;   ;activated_time_TIME ;Time           }
    { 600 ;   ;deactivated_time    ;DateTime       }
    { 601 ;   ;deactivated_time_DATE;Date          }
    { 602 ;   ;deactivated_time_TIME;Time          }
    { 700 ;   ;reference_plant_id  ;Integer        }
    { 800 ;   ;reference_element_id;Integer        }
    { 810 ;   ;reference_element_name;Text250      }
    { 900 ;   ;priority            ;Integer        }
    { 1000;   ;reference_alerm_id  ;Integer        }
    { 1100;   ;state               ;Integer        }
    { 1200;   ;alert_type          ;Integer        }
    { 1300;   ;operator_name       ;Text50         }
    { 1400;   ;activation_description_BLOB;BLOB    }
    { 1500;   ;deactivation_description_BLOB;BLOB  }
    { 1600;   ;activation_details_BLOB;BLOB        }
    { 1700;   ;deactivation_details_BLOB;BLOB      }
    { 1800;   ;affects_availibility;Boolean        }
    { 1900;   ;calculate_loss      ;Boolean        }
    { 2000;   ;repercussion_id     ;Integer        }
    { 2100;   ;affected_element_id ;Integer        }
    { 2200;   ;reason_id           ;Integer        }
    { 2300;   ;problem_description_BLOB;BLOB       }
    { 2400;   ;company             ;Text50         }
    { 2500;   ;time_t              ;Integer        }
    { 2600;   ;actions_performed_BLOB;BLOB         }
    { 2700;   ;maintenance_type_id ;Integer        }
    { 2800;   ;reference_element_type_id;Integer   }
    { 2900;   ;notified_time       ;DateTime       }
    { 2901;   ;notified_time_DATE  ;Date           }
    { 2902;   ;notified_time_TIME  ;Time           }
    { 3000;   ;estimated_activation_time;DateTime  }
    { 3100;   ;operator_id         ;Integer        }
    { 20000;  ;ARCHIVE             ;Code1         ;Description=20000.. Are Archive Information }
    { 20001;  ;Creation Date       ;Date           }
    { 20002;  ;Creation Time       ;Time           }
    { 20003;  ;Processed           ;Boolean        }
    { 20004;  ;Processed Date      ;Date           }
    { 20005;  ;Processed Time      ;Time           }
    { 20010;  ;Is Error            ;Boolean        }
    { 20020;  ;Error Text          ;Text80         }
    { 20050;  ;Creation Datetime   ;DateTime       }
    { 20060;  ;Processed Datetime  ;DateTime       }
    { 21000;  ;Workorder No.       ;Code20        ;TableRelation=Opportunity.No. WHERE (CM Is Workorder=CONST(Yes));
                                                   OnLookup=VAR
                                                              CMWoMgt@1000000000 : Codeunit 70030;
                                                              Workorder@1000000001 : Record 5092;
                                                            BEGIN
                                                            END;
                                                             }
    { 21010;  ;Workorder Updated   ;Boolean        }
  }
  KEYS
  {
    {    ;id                                      ;Clustered=Yes }
    {    ;ticket_id,Workorder No.,id               }
    {    ;Workorder No.,id                         }
    {    ;state                                    }
    {    ;activated_time_DATE                      }
    {    ;Is Error                                 }
    {    ;Creation Date                            }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      CMIfMgt@1000000000 : Codeunit 70026;

    PROCEDURE GetBlobValues@1000000002(VAR activation_description@1000000005 : Text;VAR deactivation_description@1000000004 : Text;VAR activation_details@1000000003 : Text;VAR deactivation_details@1000000002 : Text;VAR problem_description@1000000001 : Text;VAR actions_performed@1000000000 : Text);
    VAR
      InStr@1000000006 : InStream;
      CMGenMgt@1000000007 : Codeunit 70000;
    BEGIN
      Rec.CALCFIELDS(activation_description_BLOB);
      Rec.CALCFIELDS(deactivation_description_BLOB);
      Rec.CALCFIELDS(activation_details_BLOB);
      Rec.CALCFIELDS(deactivation_details_BLOB);
      Rec.CALCFIELDS(problem_description_BLOB);
      Rec.CALCFIELDS(actions_performed_BLOB);

      Rec.activation_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      activation_description := CMGenMgt.Instream2Text(InStr);

      Rec.deactivation_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      deactivation_description := CMGenMgt.Instream2Text(InStr);

      Rec.activation_details_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      activation_details := CMGenMgt.Instream2Text(InStr);

      Rec.deactivation_details_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      deactivation_details := CMGenMgt.Instream2Text(InStr);

      Rec.problem_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      problem_description := CMGenMgt.Instream2Text(InStr);

      Rec.actions_performed_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      actions_performed := CMGenMgt.Instream2Text(InStr);
    END;

    PROCEDURE SetBlobValues@1000000001(activation_description@1000000005 : Text;deactivation_description@1000000004 : Text;activation_details@1000000003 : Text;deactivation_details@1000000002 : Text;problem_description@1000000001 : Text;actions_performed@1000000000 : Text);
    VAR
      OutStr@1000000006 : OutStream;
    BEGIN
      CLEAR(Rec.activation_description_BLOB);
      CLEAR(Rec.deactivation_description_BLOB);
      CLEAR(Rec.activation_details_BLOB);
      CLEAR(Rec.deactivation_details_BLOB);
      CLEAR(Rec.problem_description_BLOB);
      CLEAR(Rec.actions_performed_BLOB);

      Rec.activation_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(activation_description);

      Rec.deactivation_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(deactivation_description);

      Rec.activation_details_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(activation_details);

      Rec.deactivation_details_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(deactivation_details);

      Rec.problem_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(problem_description);

      Rec.actions_performed_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(actions_performed);

      //IF NOT Rec.MODIFY(FALSE) THEN
        //;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70000 CMMS General Setup
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=09:27:15;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=ENU=CMMS General Setup;
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              DEA=Prim„rschlssel] }
    { 1000;   ;NO. SERIES          ;Boolean       ;CaptionML=[ENU=NO. SERIES;
                                                              DEA=NUMMERNSERIE] }
    { 1100;   ;Asset Nos. Code     ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Anlage Nrs. Code;
                                                              DEA=Anlage Nrs. Code] }
    { 1110;   ;Project Nos. Code   ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Project Nrs. Code;
                                                              DEA=Projekt Nrs. Code] }
    { 1200;   ;Workorder Nos. Code ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Workorder Nos. Code;
                                                              DEA=Arbeitsauftrag Nrs. Code] }
    { 1300;   ;Task Nos. Code      ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Task Nos. Code;
                                                              DEA=Aufgabe Nrs. Code] }
    { 1310;   ;Checklist Nos. Code ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Checklist Nos. Code;
                                                              DEA=Checklist Nrs. Code] }
    { 1320;   ;Team Nos. Code      ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Team Nos. Code;
                                                              DEA=Team Nrs. Code] }
    { 1400;   ;Contract Nos. Code  ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Contract Nos. Code;
                                                              DEA=Vertrag Nrs. Code] }
    { 2000;   ;PHOTOS              ;Boolean        }
    { 2010;   ;Photo Quality %     ;Integer       ;InitValue=80;
                                                   CaptionML=[ENU=Photo Quality %;
                                                              DEA=Foto Qualit„t %];
                                                   MinValue=1;
                                                   MaxValue=100 }
    { 3000;   ;MAPSETUP            ;Boolean        }
    { 3010;   ;Map Setup (Coordinates);Code10     ;TableRelation="Online Map Parameter Setup".Code;
                                                   CaptionML=[ENU=Map Setup (Coordinates);
                                                              DEA=Karteneinrichtung (Koordinaten)] }
    { 3020;   ;Map Setup (Address) ;Code10        ;TableRelation="Online Map Parameter Setup".Code;
                                                   CaptionML=[ENU=Map Setup (Coordinaten);
                                                              DEA=Karteneinrichtung (Adresse)] }
    { 4000;   ;TIMETRACKING        ;Boolean        }
    { 4010;   ;Max. Posting per Day;Decimal       ;CaptionML=[ENU=Max. Posting per Day;
                                                              DEA=Max. Verbuchung pro Tag] }
    { 4020;   ;Rounding Precision  ;Decimal       ;CaptionML=[ENU=Rounding Precision;
                                                              DEA=Rundungspr„zision] }
    { 4030;   ;Default UoM Code    ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Default UoM Code;
                                                              DEA=Standard Einheitencode] }
    { 4040;   ;Posting Allowed to (Past);DateFormula;
                                                   CaptionML=[ENU=Time Posting Allowed To (Past);
                                                              DEA=Zeiterfassung Erlaubt (Vergang.)] }
    { 4050;   ;Posting Allowed to (Future);DateFormula;
                                                   CaptionML=[ENU=Time Posting Allowed To (Future);
                                                              DEA=Zeiterfassung Erlaubt (Zufkunft)] }
    { 4060;   ;Posting Descr. Min. Length;Integer ;CaptionML=[ENU=Posting Descr. Min. Length;
                                                              DEA=Buchungsbeschr. Min. L„nge];
                                                   MinValue=0;
                                                   MaxValue=50 }
    { 4100;   ;Dimension 1         ;Code20        ;TableRelation=Dimension.Code }
    { 4110;   ;Dimension 2         ;Code20        ;TableRelation=Dimension.Code }
    { 4120;   ;Dimension 3         ;Code20        ;TableRelation=Dimension.Code }
    { 4130;   ;Dimension 4         ;Code20        ;TableRelation=Dimension.Code }
    { 5000;   ;YIELD STUDY         ;Boolean        }
    { 5010;   ;Yield Type 1 (Starts with);Code20  ;OnValidate=VAR
                                                                CodeData@1000000000 : Record 70006;
                                                                CMAddData@1000000001 : Record 70021;
                                                              BEGIN
                                                                //CodeData.ValidateCodeData(CMAddData.RECORDID.TABLENO, CMAddData.FIELDNO(Key3),CMAddData.Type::YieldStudy, Rec."Yield Type 1");
                                                              END;

                                                   OnLookup=VAR
                                                              CodeData@1000000000 : Record 70006;
                                                              CMAddData@1000000001 : Record 70021;
                                                              Value@1000000002 : Code[20];
                                                            BEGIN
                                                              CodeData.LookupCodeData(CMAddData.RECORDID.TABLENO, CMAddData.FIELDNO(Key3),CMAddData.Type::YieldStudy, Rec."Yield Type 1 (Starts with)");
                                                            END;
                                                             }
    { 5020;   ;Yield Unit 1        ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Yield Unit 1;
                                                              DEA=Ertrag Einheit 1] }
    { 5030;   ;Yield Type 2 (Starts with);Code20  ;OnValidate=VAR
                                                                CodeData@1000000000 : Record 70006;
                                                                CMAddData@1000000001 : Record 70021;
                                                              BEGIN
                                                                //CodeData.ValidateCodeData(CMAddData.RECORDID.TABLENO, CMAddData.FIELDNO(Key3),CMAddData.Type::YieldStudy, Rec."Yield Type 2");
                                                              END;

                                                   OnLookup=VAR
                                                              CodeData@1000000000 : Record 70006;
                                                              CMAddData@1000000001 : Record 70021;
                                                              Value@1000000002 : Code[20];
                                                            BEGIN
                                                              CodeData.LookupCodeData(CMAddData.RECORDID.TABLENO, CMAddData.FIELDNO(Key3),CMAddData.Type::YieldStudy, Rec."Yield Type 2 (Starts with)");
                                                            END;
                                                             }
    { 5040;   ;Yield Unit 2        ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Yield Unit 2;
                                                              DEA=Ertrag Einheit 2] }
    { 5300;   ;Degradation Allow. (Starts w.);Code20;
                                                   OnLookup=VAR
                                                              CodeData@1000000001 : Record 70006;
                                                              CMAddData@1000000000 : Record 70021;
                                                              Value@1000000002 : Code[20];
                                                            BEGIN
                                                              CodeData.LookupCodeData(CMAddData.RECORDID.TABLENO, CMAddData.FIELDNO(Key3),CMAddData.Type::YieldStudy, Rec."Degradation Allow. (Starts w.)");
                                                            END;
                                                             }
    { 6000;   ;Dimensions          ;Boolean        }
    { 6010;   ;Asset Dimension Code;Code20        ;TableRelation=Dimension.Code;
                                                   CaptionML=[ENU=Asset Dimension;
                                                              DEA=Anlagendimension] }
    { 6020;   ;Project Dimension Code;Code20      ;TableRelation=Dimension.Code;
                                                   CaptionML=[ENU=Project Dimension;
                                                              DEA=Projektdimension] }
    { 10000;  ;MISC                ;Boolean        }
    { 10010;  ;Default Interact. Tpl. Code;Code20 ;TableRelation="Interaction Template".Code;
                                                   CaptionML=[ENU=Default Interaction Template Code;
                                                              DEA=Standard Aktivit„tenvorlagencode] }
    { 10020;  ;Recurring Workorder Name;Text50    ;CaptionML=[ENU=Recurring Workorder Name;
                                                              DEA=Wiederkehrender Arbeitsauftragname] }
    { 10030;  ;System Contact      ;Code20        ;TableRelation=Contact.No.;
                                                   CaptionML=[ENU=System Contact (Log);
                                                              DEA=System Kontakt (Log)] }
    { 10040;  ;System Salesperson  ;Code20        ;TableRelation=Salesperson/Purchaser.Code;
                                                   CaptionML=[ENU=System Salesperson (Log);
                                                              DEA=System Verk„ufer (Log)] }
    { 10050;  ;System User ID      ;Code50        ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=System User ID;
                                                              DEA=System Benutzer ID] }
    { 10100;  ;Subcontractor Bus. Rel. Code;Code20;TableRelation="Business Relation".Code;
                                                   CaptionML=[ENU=Subcontractor Bus. Rel. Code;
                                                              DEA=Sublieferant Gesch. Bez. Code] }
    { 10110;  ;Min. Comment Len. (Wo. Status);Integer;
                                                   CaptionML=ENU=Min. Comment Len. (Wo. Status);
                                                   MinValue=0;
                                                   MaxValue=250 }
    { 10200;  ;Allow CMMS Purch. Orders;Boolean   ;CaptionML=[ENU=Allow CMMS Purch. Orders;
                                                              DEA=Erlaube CMMS Bestellungen] }
    { 10210;  ;CMMS PO Default Vendor;Code20      ;TableRelation=Vendor.No.;
                                                   CaptionML=ENU=CMMS Bestellung Default Kreditor }
    { 10220;  ;CMMS PO Status Sequence;Code20     ;TableRelation="IG Status Sequence Header".Code WHERE (Type=CONST(sequence));
                                                   CaptionML=[ENU=CMMS Purch. Order Status Sequence;
                                                              DEA=CMMS Bestellung Statusablauf] }
    { 10230;  ;CMMS PO Initial Status;Code20      ;TableRelation="IG Status Sequence Header".Code WHERE (Type=CONST(status));
                                                   CaptionML=[ENU=CMMS Purch. Order Initial Status;
                                                              DEA=CMMS Bestellung Initialstatus] }
    { 10240;  ;CMMS PO Released Status;Code20     ;CaptionML=[ENU=CMMS Purch. Order Released Status;
                                                              DEA=CMMS Bestellung Freigabestatus] }
    { 12000;  ;EXCEL EXPORT        ;Boolean        }
    { 12010;  ;Excel Export Template 1 Path;Text250;
                                                   OnLookup=BEGIN
                                                              VALIDATE("Excel Export Template 1 Path", FileMgt.OpenFileDialog(Text001,'','Excel Workbook (*.xls, *.xlsx)|*.xls;*.xlsx'));
                                                            END;

                                                   CaptionML=[ENU=Template 1 Path;
                                                              DEA=Vorlage 1 Pfad] }
    { 12020;  ;Excel Export Template 2 Path;Text250;
                                                   OnLookup=BEGIN
                                                              VALIDATE("Excel Export Template 2 Path", FileMgt.OpenFileDialog(Text001,'','Excel Workbook (*.xls, *.xlsx)|*.xls;*.xlsx'));
                                                            END;

                                                   CaptionML=[ENU=Template 2 Path;
                                                              DEA=Vorlage 2 Pfad] }
    { 12030;  ;Excel Export Template 3 Path;Text250;
                                                   OnLookup=BEGIN
                                                              VALIDATE("Excel Export Template 3 Path", FileMgt.OpenFileDialog(Text001,'','Excel Workbook (*.xls, *.xlsx)|*.xls;*.xlsx'));
                                                            END;

                                                   CaptionML=[ENU=Template 3 Path;
                                                              DEA=Vorlage 3 Pfad] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      FileMgt@1000000000 : Codeunit 419;
      Text001@1000000001 : TextConst 'ENU=Open file...;DEA=Datei ”ffnen...';

    BEGIN
    END.
  }
}

OBJECT Table 70006 CMMS Code Data
{
  OBJECT-PROPERTIES
  {
    Date=19.05.17;
    Time=07:56:48;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    LookupPageID=Page70004;
  }
  FIELDS
  {
    { 1   ;   ;TableID             ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table));
                                                   OnLookup=VAR
                                                              Object@1000000001 : Record 2000000001;
                                                              Objects@1000000000 : Page 358;
                                                            BEGIN
                                                              Object.SETRANGE(Object.Type,Object.Type::Table);
                                                              Objects.SETTABLEVIEW(Object);
                                                              Objects.LOOKUPMODE := TRUE;
                                                              IF Objects.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                Objects.GETRECORD(Object);
                                                                VALIDATE(TableID, Object.ID);
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=TableID;
                                                              DEA=TableID];
                                                   NotBlank=Yes }
    { 2   ;   ;Table Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(AllObjWithCaption."Object Name" WHERE (Object Type=CONST(Table),
                                                                                                             Object ID=FIELD(TableID)));
                                                   CaptionML=[ENU=Table Name;
                                                              DEA=Tabellenname];
                                                   Editable=No }
    { 3   ;   ;Table Caption       ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(AllObjWithCaption."Object Caption" WHERE (Object Type=CONST(Table),
                                                                                                                Object ID=FIELD(TableID))) }
    { 5   ;   ;FieldID             ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(TableID));
                                                   OnLookup=VAR
                                                              Field@1160001 : Record 2000000041;
                                                              Fields@1000000000 : Page 6218;
                                                            BEGIN
                                                              IF TableID = 0 THEN EXIT;
                                                              Field.SETRANGE(TableNo,TableID);
                                                              Fields.SETTABLEVIEW(Field);
                                                              Fields.LOOKUPMODE := TRUE;
                                                              IF Fields.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                Fields.GETRECORD(Field);
                                                                VALIDATE(FieldID, Field."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=FieldID;
                                                              DEA=Feld-ID] }
    { 6   ;   ;Field Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(TableID),
                                                                                             No.=FIELD(FieldID)));
                                                   CaptionML=[ENU=Field Name;
                                                              DEA=Feldname] }
    { 7   ;   ;Field Caption       ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field."Field Caption" WHERE (TableNo=FIELD(TableID),
                                                                                                   No.=FIELD(FieldID)));
                                                   CaptionML=[ENU=Field Caption;
                                                              DEA=Feldcaption] }
    { 10  ;   ;Type                ;Integer       ;CaptionML=[ENU=Type;
                                                              DEA=Art] }
    { 20  ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              DEA=Code];
                                                   NotBlank=Yes }
    { 30  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung];
                                                   NotBlank=Yes }
    { 100 ;   ;Description Long    ;Text250       ;CaptionML=[ENU=Description Long;
                                                              DEA=Langbeschreibung] }
  }
  KEYS
  {
    {    ;TableID,FieldID,Type,Code               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Code,Description                         }
  }
  CODE
  {
    VAR
      Text000@1000000000 : TextConst 'ENU=Code %1 does not exist.;DEA=Code %1 existiert nicht.';

    PROCEDURE ValidateCodeData@1160001(STableID@1160002 : Integer;SFieldID@1160001 : Integer;SType@1000000000 : Integer;SCode@1160000 : Code[20]);
    VAR
      CodeDataRec@1160003 : Record 70006;
    BEGIN
      CodeDataRec.SETRANGE(TableID,STableID);
      CodeDataRec.SETRANGE(FieldID,SFieldID);
      CodeDataRec.SETRANGE(Type,SType);
      CodeDataRec.SETRANGE(Code,SCode);

      IF NOT CodeDataRec.FINDFIRST THEN ERROR(
        Text000, SCode);
    END;

    PROCEDURE LookupCodeData@1160002(STableID@1160002 : Integer;SFieldID@1160004 : Integer;SType@1000000001 : Integer;VAR SCode@1160005 : Code[20]);
    VAR
      CodeDataRec@1160000 : Record 70006;
      Table@1160003 : Record 2000000028;
      CodeDataList@1000000000 : Page 70004;
    BEGIN
      Table.SETRANGE("Table No.",STableID);
      IF NOT Table.FINDFIRST THEN EXIT;

      CodeDataRec.FILTERGROUP(2);
      CodeDataRec.SETRANGE(TableID,STableID);
      CodeDataRec.SETRANGE(FieldID,SFieldID);
      CodeDataRec.SETRANGE(Type,SType);
      CodeDataRec.FILTERGROUP(0);

      CodeDataList.SETTABLEVIEW(CodeDataRec);
      CodeDataList.LOOKUPMODE := TRUE;

      IF CodeDataList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        CodeDataList.GETRECORD(CodeDataRec);
        SCode := CodeDataRec.Code;
        //exit(true);
      END;
    END;

    PROCEDURE GetCodeData@1160000(STableID@1160003 : Integer;SFieldID@1160002 : Integer;SCode@1160001 : Code[20];SCode2@1160000 : Code[20];SLanguageCode@1160004 : Code[20]) ReturnValue : Text[50];
    VAR
      CodeDataRec@1160005 : Record 70006;
    BEGIN
      CodeDataRec.SETRANGE(TableID,STableID);
      CodeDataRec.SETRANGE(FieldID,SFieldID);
      CodeDataRec.SETRANGE(Code,SCode);
      IF NOT CodeDataRec.FINDFIRST THEN CodeDataRec.INIT;

      ReturnValue := CodeDataRec.Description;
      {
      IF SLanguageCode <> '' THEN
        IF MDTranslation.GetTranslation(DATABASE::"IG Code Data",CodeDataRec.FIELDNO(Description),SCode,SCode2,SLanguageCode) <> '' THEN
          ReturnValue := MDTranslation.GetTranslation(DATABASE::"IG Code Data",CodeDataRec.FIELDNO(Description),SCode,SCode2,SLanguageCode);
      }
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70007 CMMS Report Buffer
{
  OBJECT-PROPERTIES
  {
    Date=19.06.17;
    Time=13:26:56;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer        }
    { 1000;   ;AssetNo1            ;Code20         }
    { 1010;   ;ProjectNo1          ;Code20         }
    { 1020;   ;ContractNo1         ;Code20         }
    { 1030;   ;ContactNo1          ;Code20         }
    { 1040;   ;CustomerNo1         ;Code20         }
    { 1050;   ;UserID1             ;Code50         }
    { 2000;   ;BusRelCode1         ;Code20         }
    { 3000;   ;TypeText1           ;Text80         }
    { 3001;   ;TypeInt1            ;Integer        }
    { 3010;   ;TypeText2           ;Text80         }
    { 3011;   ;TypeInt2            ;Integer        }
    { 3020;   ;TypeText3           ;Text80         }
    { 3021;   ;TypeInt3            ;Integer        }
    { 3030;   ;TypeText4           ;Text80         }
    { 3040;   ;TypeText5           ;Text80         }
    { 3050;   ;TypeText6           ;Text80         }
    { 3060;   ;TypeText7           ;Text80         }
    { 3070;   ;TypeText8           ;Text80         }
    { 4000;   ;Name1               ;Text250        }
    { 4010;   ;Name2               ;Text250        }
    { 4020;   ;Name3               ;Text250        }
    { 4030;   ;Name4               ;Text250        }
    { 5000;   ;LineNo1             ;Integer        }
    { 10000;  ;Amount1             ;Decimal        }
    { 10010;  ;Amount2             ;Decimal        }
    { 10020;  ;Amount3             ;Decimal        }
    { 10030;  ;Amount4             ;Decimal        }
    { 10040;  ;Amount5             ;Decimal        }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70009 CMMS Department
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=11:07:27;
    Modified=Yes;
    Version List=CMMS,DPT;
  }
  PROPERTIES
  {
    OnDelete=VAR
               DepartmentTeam@1000000000 : Record 70010;
             BEGIN
               DepartmentTeam.RESET;
               DepartmentTeam.SETRANGE(Type, DepartmentTeam.Type::Department);
               DepartmentTeam.SETRANGE(Code, xRec.Code);
               DepartmentTeam.DELETEALL(TRUE);

               DepartmentTeam.RESET;
               DepartmentTeam.SETCURRENTKEY("Belongs To Department Code");
               DepartmentTeam.SETRANGE("Belongs To Department Code", xRec.Code);
               DepartmentTeam.DELETEALL(TRUE);
             END;

    OnRename=VAR
               DepartmentTeam@1000000000 : Record 70010;
             BEGIN
               DepartmentTeam.RESET;
               DepartmentTeam.SETRANGE(Type, DepartmentTeam.Type::Department);
               DepartmentTeam.SETRANGE(Code, xRec.Code);
               WHILE(DepartmentTeam.FINDFIRST()) DO BEGIN
                 DepartmentTeam.RENAME(DepartmentTeam.Type, Rec.Code);
               END;

               DepartmentTeam.RESET;
               DepartmentTeam.SETCURRENTKEY("Belongs To Department Code");
               DepartmentTeam.SETRANGE("Belongs To Department Code", xRec.Code);
               DepartmentTeam.MODIFYALL("Belongs To Department Code", Rec.Code, TRUE);
             END;

    CaptionML=[ENU=Department;
               DEA=Abteilung];
  }
  FIELDS
  {
    { 100 ;   ;Code                ;Code20        ;CaptionML=[ENU=Code;
                                                              DEA=Code] }
    { 200 ;   ;Name                ;Text50        ;CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 300 ;   ;Company             ;Text30        ;TableRelation=Company.Name;
                                                   CaptionML=[ENU=Company;
                                                              DEA=Mandant] }
    { 1000;   ;In Scheduling Tool  ;Boolean       ;CaptionML=ENU=In Scheduling Tool }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70010 CMMS Department Team
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=11:36:34;
    Modified=Yes;
    Version List=CMMS,DPT;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Department Team;
               DEA=Abteilung Team];
  }
  FIELDS
  {
    { 100 ;   ;Type                ;Option        ;OptionCaptionML=[ENU=User,Department;
                                                                    DEA=Benutzer,Abteilung];
                                                   OptionString=User,Department }
    { 200 ;   ;Code                ;Code50        ;TableRelation=IF (Type=CONST(Department)) "CMMS Department".Code }
    { 201 ;   ;User Name           ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(Code)));
                                                   CaptionML=[ENU=User Name;
                                                              DEA=Benutzername];
                                                   Description=FF;
                                                   Editable=No }
    { 202 ;   ;Department Name     ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Department".Name WHERE (Code=FIELD(Code)));
                                                   CaptionML=[ENU=Department Name;
                                                              DEA=Abteilungsname];
                                                   Description=FF;
                                                   Editable=No }
    { 203 ;   ;Department Comany   ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Department".Company WHERE (Code=FIELD(Code)));
                                                   CaptionML=[ENU=Department Company;
                                                              DEA=Abteilung Mandant];
                                                   Description=FF;
                                                   Editable=No }
    { 300 ;   ;Belongs To Department Code;Code20  ;TableRelation="CMMS Department".Code }
    { 301 ;   ;Belongs To Department Comany;Text30;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Department".Company WHERE (Code=FIELD(Belongs To Department Code)));
                                                   CaptionML=[ENU=Belongs To Department Company;
                                                              DEA=Geh”rt zu Abteilung Mandant];
                                                   Description=FF;
                                                   Editable=No }
    { 1000;   ;User Role           ;Option        ;OnValidate=BEGIN
                                                                TESTFIELD(Type, Type::User)
                                                              END;

                                                   CaptionML=[ENU=User Role;
                                                              DEA=Benutzerrolle];
                                                   OptionCaptionML=[ENU=" ,Leader";
                                                                    DEA=" ,Vorgesetzter"];
                                                   OptionString=[ ,Leader] }
    { 1010;   ;Dept. in Scheduling Tool;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Department"."In Scheduling Tool" WHERE (Code=FIELD(Belongs To Department Code)));
                                                   CaptionML=ENU=In Scheduling Tool;
                                                   Description=FF;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Type,Code,Belongs To Department Code    ;Clustered=Yes }
    {    ;User Role                                }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Invalid User "%1".;DEA=Ungltiger Benutzer "%1".';

    PROCEDURE LookupUserID@1000000003();
    VAR
      User@1000000000 : Record 2000000120;
      UserList@1000000001 : Page 9800;
    BEGIN
      IF Type <> Type::User THEN
        EXIT;

      UserList.LOOKUPMODE(TRUE);
      IF UserList.RUNMODAL <> ACTION::LookupOK THEN
        EXIT;

      UserList.GETRECORD(User);
      Code := User."User Name";
    END;

    PROCEDURE ValidateUserID@1000000004();
    VAR
      User@1000000000 : Record 2000000120;
    BEGIN
      IF Type <> Type::User THEN
        EXIT;

      User.RESET;
      User.SETCURRENTKEY("User Name");
      User.SETRANGE("User Name", Rec.Code);
      IF NOT User.FINDFIRST() THEN
        ERROR(STRSUBSTNO(Text001, Rec.Code));
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70011 CMMS Management Cue
{
  OBJECT-PROPERTIES
  {
    Date=09.05.17;
    Time=11:30:06;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10         }
    { 100 ;   ;Assets              ;Integer       ;AccessByPermission=TableData 70020=R;
                                                   CaptionML=[ENU=Assets;
                                                              DEA=Anlagen];
                                                   Editable=No }
    { 101 ;   ;Main Assets         ;Integer       ;AccessByPermission=TableData 70020=R;
                                                   CaptionML=[ENU=Main Assets;
                                                              DEA=Hauptanlagen];
                                                   Editable=No }
    { 120 ;   ;Projects            ;Integer       ;AccessByPermission=TableData 70020=R;
                                                   CaptionML=[ENU=Projects;
                                                              DEA=Projekte];
                                                   Editable=No }
    { 140 ;   ;Contracts           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Contract");
                                                   AccessByPermission=TableData 70050=R;
                                                   CaptionML=[ENU=Contracts;
                                                              DEA=Vertr„ge];
                                                   Description=FF;
                                                   Editable=No }
    { 1000;   ;-- TIME RECORDS --  ;Boolean        }
    { 1500;   ;Time Records (Today);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Today Date Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=Time Records (Today);
                                                              DEA=Gebuchte Stunden (Heute)] }
    { 1510;   ;My Time Records (Today);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Today Date Filter),
                                                                                                            CM User ID=FIELD(User ID Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=My Time Records (Today);
                                                              DEA=Meine Gebuchte Stunden (Heute)] }
    { 1520;   ;Time Records (Week) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Week Date Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=Time Records (Week);
                                                              DEA=Gebuchte Stunden (Woche)] }
    { 1530;   ;My Time Records (Week);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Week Date Filter),
                                                                                                            CM User ID=FIELD(User ID Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=My Time Records (Week);
                                                              DEA=Meine Gebuchte Stunden (Woche)] }
    { 1531;   ;My Time Records (Month);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Month Date Filter),
                                                                                                            CM User ID=FIELD(User ID Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=My Time Records (Month);
                                                              DEA=Meine Gebuchte Stunden (Monat)] }
    { 1540;   ;Time Records        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=Time Records;
                                                              DEA=Gebuchte Stunden] }
    { 1550;   ;My Time Records     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM User ID=FIELD(User ID Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=My Time Records;
                                                              DEA=Meine Gebuchte Stunden] }
    { 1600;   ;-- WORK ORDERS --   ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes)));
                                                   AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=Work Orders;
                                                              DEA=Arbeitsauftr„ge];
                                                   Editable=No }
    { 1610;   ;My Work Orders      ;Integer       ;AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Work Orders;
                                                              DEA=Meine Arbeitsauftr„ge];
                                                   Editable=No }
    { 1611;   ;My Planned Work. (Due);Integer     ;AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Planned Work Orders;
                                                              DEA=Meine Geplanten Arbeitsauft.];
                                                   Editable=No }
    { 1612;   ;My Planned Work. (Overdue);Integer ;AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Overdue Work Orders;
                                                              DEA=Meine šberf„lligen Arbeitsauft.];
                                                   Editable=No }
    { 1620;   ;My Sub. Work Orders ;Integer       ;AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Work Orders;
                                                              DEA=Meine Arbeitsauftr„ge];
                                                   Editable=No }
    { 1621;   ;My Planned Sub. WO (Due);Integer   ;AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Planned Work Orders;
                                                              DEA=Meine Geplanten Arbeitsauft.];
                                                   Editable=No }
    { 1622;   ;My Planned Sub. WO (Overdue);Integer;
                                                   AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Overdue Work Orders;
                                                              DEA=Meine šberf„lligen Arbeitsauft.];
                                                   Editable=No }
    { 1800;   ;New Work Orders (Resp.);Integer    ;CaptionML=[ENU=New Work Orders;
                                                              DEA=Neue Arbeitsauftr„ge];
                                                   Editable=No }
    { 1801;   ;New Alarm Work Orders (Resp.);Integer;
                                                   CaptionML=[ENU=New Alarm Work Orders;
                                                              DEA=Neue Alarm Arbeitsauftr„ge];
                                                   Editable=No }
    { 1810;   ;Open Work Orders (Resp.);Integer   ;CaptionML=[ENU=Open Work Orders;
                                                              DEA=Offene Arbeitsauftr„ge];
                                                   Editable=No }
    { 1820;   ;Work Orders In Process (Resp.);Integer;
                                                   CaptionML=[ENU=Work Orders In Process;
                                                              DEA=Arbeitsauftr„ge in Bearbeitung];
                                                   Editable=No }
    { 1830;   ;Completed Work Orders (Resp.);Integer;
                                                   CaptionML=[ENU=Completed Work Orders;
                                                              DEA=Fertiggestellte Arbeitsauftr„ge];
                                                   Editable=No }
    { 3000;   ;-- REQUESTS --      ;Boolean        }
    { 3001;   ;Requests            ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Request),
                                                                                  CM Status=CONST(Open)));
                                                   AccessByPermission=TableData 5080=R;
                                                   CaptionML=[ENU=Requests;
                                                              DEA=Anfragen];
                                                   Editable=No }
    { 3010;   ;My Requests         ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Request),
                                                                                  CM Assigned User ID=FIELD(User ID Filter),
                                                                                  CM Status=CONST(Open)));
                                                   AccessByPermission=TableData 5080=R;
                                                   CaptionML=[ENU=My Requests;
                                                              DEA=Meine Anfragen];
                                                   Editable=No }
    { 3020;   ;Postboned Requests  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Request),
                                                                                  CM Scheduled Date=FIELD(Undue Date Filter),
                                                                                  CM Status=CONST(Open)));
                                                   AccessByPermission=TableData 5080=R;
                                                   CaptionML=[ENU=Postboned Requests;
                                                              DEA=Zurckgestellte Anfragen];
                                                   Editable=No }
    { 4000;   ;--ALARMS--          ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS General Setup");
                                                   CaptionML=[ENU=My New Alarms;
                                                              DEA=Meine Neuen Alarme];
                                                   Editable=No }
    { 4100;   ;New Alarms          ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Source=FILTER(Alarm|Manual Alarm),
                                                                                        CM Status=CONST(New)));
                                                   CaptionML=[ENU=New Alarms;
                                                              DEA=Neue Alarme];
                                                   Description=FF;
                                                   Editable=No }
    { 4105;   ;Open Alarms         ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Source=FILTER(Alarm|Manual Alarm),
                                                                                        CM Status=CONST(Open)));
                                                   CaptionML=[ENU=Open Alarms;
                                                              DEA=Offene Alarme];
                                                   Description=FF;
                                                   Editable=No }
    { 4110;   ;Alarms In Process   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Source=FILTER(Alarm|Manual Alarm),
                                                                                        CM Status=CONST(In Process)));
                                                   CaptionML=[ENU=Alarms In Process;
                                                              DEA=Alarme In Bearbeitung];
                                                   Description=FF;
                                                   Editable=No }
    { 4120;   ;Completed Alarms    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Source=FILTER(Alarm|Manual Alarm),
                                                                                        CM Status=CONST(Completed)));
                                                   CaptionML=[ENU=Completed Alarms;
                                                              DEA=Fertiggestellte Alarme];
                                                   Description=FF;
                                                   Editable=No }
    { 9999;   ;-- FILTERS --       ;Boolean        }
    { 10000;  ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              DEA=Datumsfilter];
                                                   Editable=No }
    { 10010;  ;Due Date Filter     ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Due Date Filter;
                                                              DEA=F„lligkeitsdatumsfilter];
                                                   Editable=No }
    { 10011;  ;Due Date Filter (Planned);Date     ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Due Date Filter (Planned);
                                                              DEA=F„lligkeitsdatumsfilter (Geplant)];
                                                   Editable=No }
    { 10012;  ;Overdue Date Filter (Planned);Date ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Overdue Date Filter (Planned);
                                                              DEA=šberf„lligkeitsdatumsfilter (Geplant)];
                                                   Editable=No }
    { 10020;  ;Overdue Date Filter ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Overdue Date Filter;
                                                              DEA=šberf„lligkeits-Datumsfilter] }
    { 10025;  ;Undue Date Filter   ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Undue Date Filter;
                                                              DEA=Nichtf„lligkeits-Datumsfilter] }
    { 10030;  ;Today Date Filter   ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Today Date Filter;
                                                              DEA=Heute Datumsfilter] }
    { 10040;  ;Week Date Filter    ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=This Week Date Filter;
                                                              DEA=Diese Woche Datumsfilter] }
    { 10050;  ;Month Date Filter   ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=This Moth Filter;
                                                              DEA=Dieses Monat Filter] }
    { 10100;  ;User ID Filter      ;Code50        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=User ID Filter;
                                                              DEA=Benutzer-ID-Filter] }
    { 10200;  ;Resp. Center Filter Asset;Code10   ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Resp. Center Filter Asset;
                                                              DEA=Zust„ndigkeitseinheitenfilter Anlagen];
                                                   Editable=No }
    { 10210;  ;Resp. Center Filter Project;Code10 ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Resp. Center Filter Project;
                                                              DEA=Zust„ndigkeitseinheitenfilter Projekt];
                                                   Editable=No }
    { 20010;  ;RC Allow New Workorder;Boolean      }
    { 20020;  ;RC Allow New Request;Boolean        }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE SetRespCenterFilter@1();
    VAR
      CMUserAccMgt@1000 : Codeunit 70010;
    BEGIN
      {Asset}
      IF CMUserAccMgt.GetAssetRespFilter() <> '' THEN BEGIN
        FILTERGROUP(2);
        SETFILTER("Resp. Center Filter Asset", CMUserAccMgt.GetAssetRespFilter());
        FILTERGROUP(0);
      END;

      {Project}
      IF CMUserAccMgt.GetProjectRespFilter() <> '' THEN BEGIN
        FILTERGROUP(2);
        SETFILTER("Resp. Center Filter Project", CMUserAccMgt.GetProjectRespFilter());
        FILTERGROUP(0);
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70020 CMMS Object
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=16:28:30;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Operational Status;
    OnInsert=BEGIN
               IF "CM Is Temporary" THEN
                 EXIT;

               CMGenMgt.GetNo(Rec);
               CMAssetMgt.CreateUpdateContact(Rec);
               CMAssetMgt.CreateUpdateDimension(Rec);

               CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::Created, Rec."No.", STRSUBSTNO(Text001, Rec."No."));
             END;

    OnModify=BEGIN
               IF "CM Is Temporary" THEN
                 EXIT;

               IF (Rec.Name <> xRec.Name) AND (Rec."No." <> '') THEN BEGIN
                 CMAssetMgt.CreateUpdateContact(Rec);
                 CMAssetMgt.CreateUpdateDimension(Rec);
               END;
             END;

    OnDelete=BEGIN
               IF "CM Is Temporary" THEN
                 EXIT;

               CMGenMgt.DeleteWoAndTaskByAsset(Rec,TRUE);
               CMGenMgt.DeleteAssetAddData(Rec);
             END;

    CaptionML=ENU=CMMS Object;
    LookupPageID=Page70021;
    DrillDownPageID=Page70021;
  }
  FIELDS
  {
    { 10  ;   ;_GENERAL            ;Boolean        }
    { 90  ;   ;Objecttype          ;Option        ;CaptionML=[ENU=Objecttype;
                                                              DEA=Objekttyp];
                                                   OptionString=Asset,Project }
    { 100 ;   ;No.                 ;Code20        ;CaptionML=[ENU=No.;
                                                              DEA=Nr.] }
    { 200 ;   ;Name                ;Text50        ;CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 210 ;   ;Name 2              ;Text100       ;CaptionML=ENU=Alternative Name;
                                                   Description=EXT }
    { 220 ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              DEA=Adresse];
                                                   Description=EXT }
    { 230 ;   ;Extended Address    ;Text50        ;CaptionML=[ENU=Extended Address 2;
                                                              DEA=Erweiterte Adresse];
                                                   Description=EXT }
    { 240 ;   ;City                ;Text50        ;OnValidate=VAR
                                                                DummyCounty@1000000000 : Text[30];
                                                              BEGIN
                                                              END;

                                                   CaptionML=ENU=City }
    { 250 ;   ;Post Code           ;Text20        ;TableRelation=IF (Country Code=FILTER(>'')) "Post Code".Code WHERE (Country/Region Code=FIELD(Country Code))
                                                                 ELSE IF (Country Code=CONST()) "Post Code".Code;
                                                   OnValidate=VAR
                                                                DummyCounty@1000000000 : Text[30];
                                                              BEGIN
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=ENU=ZIP Code }
    { 260 ;   ;Country Code        ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=ENU=Country Code }
    { 261 ;   ;Coordinates Latitude;Decimal       ;CaptionML=ENU=Coordinates Latitude;
                                                   DecimalPlaces=0:6 }
    { 262 ;   ;Coordinates Longitude;Decimal      ;CaptionML=ENU=Coordinates Longitude;
                                                   DecimalPlaces=0:6 }
    { 263 ;   ;Country/Region Name ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Country/Region.Name WHERE (Code=FIELD(Country Code)));
                                                   CaptionML=ENU=Country Name;
                                                   Description=FF }
    { 265 ;   ;Company Name        ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data"."Accounting Entity" WHERE (Type=CONST(Contract),
                                                                                                                        Key1=FIELD(No.),
                                                                                                                        Main Contract=CONST(Yes)));
                                                   TableRelation=Company.Name;
                                                   CaptionML=ENU=Company Name;
                                                   Description=FF;
                                                   Editable=No }
    { 266 ;   ;Contact No.         ;Code20        ;TableRelation=Contact.No. WHERE (Type=CONST(Company));
                                                   CaptionML=ENU=Contact No.;
                                                   Editable=No }
    { 270 ;   ;Portfolio           ;Text50        ;CaptionML=ENU=Portfolio }
    { 271 ;   ;Capacity DC kWp     ;Decimal       ;CaptionML=ENU=Capacity [DC kWp];
                                                   MinValue=0;
                                                   Description=[[kWp]]] }
    { 279 ;   ;_ADDITONAL          ;Boolean        }
    { 490 ;   ;Country Specific ID ;Text250       ;CaptionML=ENU=Country Specific ID;
                                                   Description=#delete }
    { 500 ;   ;Other General Information;Text250  ;Description=#delete? }
    { 999 ;   ;_INTERNAL           ;Boolean        }
    { 1600;   ;Operational Status  ;Option        ;OnValidate=BEGIN
                                                                CMUserAccMgt.ChangeOperationalStatusAllowed(TRUE);
                                                              END;

                                                   CaptionML=[ENU=Operational Status;
                                                              DEA=Status];
                                                   OptionCaptionML=[DEU=Neu,Freigegeben,Inaktiv;
                                                                    ENU=New,Released,Inactive];
                                                   OptionString=New,Released,Inactive }
    { 1610;   ;Commercial Status   ;Option        ;OnValidate=BEGIN
                                                                CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::Modified, Rec.FIELDNAME("Commercial Status"), STRSUBSTNO(Text002, FORMAT(xRec."Commercial Status"), FORMAT(Rec."Commercial Status")));
                                                              END;

                                                   CaptionML=ENU=Commercial Status;
                                                   OptionString=Not Ready For Invoicing,Ready For Invoicing }
    { 1620;   ;Inactive at Date    ;Date          ;CaptionML=[ENU=Inactive at Date;
                                                              DEA=Inaktiv ab Datum] }
    { 2000;   ;Main Asset No.      ;Code20        ;CaptionML=[ENU=Main Asset No.;
                                                              DEA=Hauptanlagennr.];
                                                   Editable=No }
    { 2100;   ;Asset Type          ;Option        ;CaptionML=[ENU=Asset Type;
                                                              DEA=Asset Type];
                                                   OptionCaptionML=[ENU=Asset,Main Asset,Sub Asset;
                                                                    DEA=Anlage,Hauptanlage,Unteranlage];
                                                   OptionString=Asset,Main Asset,Sub Asset;
                                                   Editable=No }
    { 2110;   ;Is Project of Asset ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("CMMS Additional Data" WHERE (Objecttype=CONST(Asset),
                                                                                                   Type=CONST(Project),
                                                                                                   Key1=FIELD(Asset No. Filter),
                                                                                                   Key2=FIELD(No.)));
                                                   CaptionML=[ENU=Is Project of Asset;
                                                              DEA=Ist Projekt von Anlage];
                                                   Description=FF;
                                                   Editable=No }
    { 2120;   ;Asset No. Filter    ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Asset));
                                                   CaptionML=[ENU=Asset No. Filter;
                                                              DEA=Anlagennr. Filter];
                                                   Description=FF;
                                                   Editable=No }
    { 2200;   ;Dimension Set ID    ;Integer       ;CaptionML=[ENU=Dimension Set ID;
                                                              DEA=Dimensionssatz ID] }
    { 20000;  ;New Workorders      ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(New)));
                                                   CaptionML=[ENU=New Workorders;
                                                              DEA=Neue Arbeitsauftr„ge];
                                                   Editable=No }
    { 20100;  ;Open Workorders     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(Open)));
                                                   CaptionML=[ENU=Open Workorders;
                                                              DEA=Offene Arbeitsauftr„ge];
                                                   Editable=No }
    { 20200;  ;In Proc. Workorders ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(In Process)));
                                                   CaptionML=[ENU=In Proc. Workorders;
                                                              DEA=In Bearb. - Arbeitsauftr„ge];
                                                   Editable=No }
    { 20300;  ;Completed Workorders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(Completed)));
                                                   CaptionML=[ENU=Completed Workorders;
                                                              DEA=Fertiggestellte Arbeitsauftr„ge];
                                                   Editable=No }
    { 20400;  ;Done Workorders     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(Done)));
                                                   CaptionML=[ENU=Done Workorders;
                                                              DEA=Erledigte Arbeitsauftr„ge];
                                                   Description=FF;
                                                   Editable=No }
    { 20500;  ;Discarded Workorders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(Discarded)));
                                                   CaptionML=[ENU=Discraded Workorders;
                                                              DEA=Geschlossene Arbeitsauftr„ge];
                                                   Description=FF;
                                                   Editable=No }
    { 20600;  ;Users               ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(User),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Users;
                                                              DEA=Benutzer];
                                                   Description=FF;
                                                   Editable=No }
    { 20610;  ;Customers           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Customer),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Customers;
                                                              DEA=Debitoren];
                                                   Description=FF;
                                                   Editable=No }
    { 20620;  ;Activities          ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (CM Is CMMS Log Entry=CONST(Yes),
                                                                                                    CM Object No.=FIELD(No.)));
                                                   CaptionML=[ENU=Activities;
                                                              DEA=Aktivit„ten];
                                                   Description=FF;
                                                   Editable=No }
    { 20630;  ;Subassets           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(SubAsset),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Subassets;
                                                              DEA=Unteranlagen];
                                                   Description=FF;
                                                   Editable=No }
    { 20640;  ;Projects            ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Project),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Projects;
                                                              DEA=Projekte];
                                                   Description=FF;
                                                   Editable=No }
    { 20650;  ;Contracts           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Contract),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Contracts;
                                                              DEA=Vetr„ge];
                                                   Description=FF;
                                                   Editable=No }
    { 20660;  ;Relations           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Relation),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Relations;
                                                              DEA=Verbindungen];
                                                   Description=FF;
                                                   Editable=No }
    { 20670;  ;Assets              ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Project),
                                                                                                   Key2=FIELD(No.)));
                                                   CaptionML=[ENU=Assets;
                                                              DEA=Anlagen];
                                                   Description=FF;
                                                   Editable=No }
    { 25999;  ;_TECHNICAL          ;Boolean        }
    { 26500;  ;Inverter Type       ;Option        ;OptionString=[ ,Central,Decentral,Other] }
    { 26600;  ;Mounting            ;Option        ;CaptionML=ENU=Mounted;
                                                   OptionString=[ ,Ground,Roof,Other] }
    { 26610;  ;Surroundings        ;Text50        ;CaptionML=ENU=Surroundings }
    { 26710;  ;Commissioning Date  ;Date          ;CaptionML=ENU=Commissioning Date }
    { 26720;  ;PAC Date            ;Date          ;CaptionML=ENU=PAC Date }
    { 26730;  ;FAC Date            ;Date          ;CaptionML=ENU=FAC Date }
    { 26740;  ;Additional Technical Info;Text250  ;CaptionML=ENU=Additional Technical Info }
    { 26750;  ;Azimut              ;Decimal       ;CaptionML=[ENU=Azimut;
                                                              DEA=Azimut];
                                                   Description=#delete }
    { 26760;  ;Tilt                ;Decimal       ;CaptionML=[ENU=Tilt;
                                                              DEA=Tilt];
                                                   Description=#delete }
    { 29999;  ;_REPORTING          ;Boolean        }
    { 30010;  ;Export PPA Price    ;Decimal       ;DecimalPlaces=2:4 }
    { 30011;  ;Export PPA Currency ;Code10        ;TableRelation=Currency.Code;
                                                   Description=NEW }
    { 30050;  ;Irradiation Yield Study;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("CMMS Additional Data"."Yield Total" WHERE (Objecttype=CONST(Asset),
                                                                                                               Type=CONST(YieldStudy),
                                                                                                               Key1=FIELD(No.),
                                                                                                               Key3=FILTER(IRRAD*),
                                                                                                               Valid Source=CONST(Yes)));
                                                   CaptionML=ENU=Irradiation Yield Study [kWh/mý/Year];
                                                   Description=FF;
                                                   Editable=No }
    { 30060;  ;Anticipated Annual Yield;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("CMMS Additional Data"."Yield Total" WHERE (Objecttype=CONST(Asset),
                                                                                                               Type=CONST(YieldStudy),
                                                                                                               Key1=FIELD(No.),
                                                                                                               Key3=FILTER(PROD*),
                                                                                                               Valid Source=CONST(Yes)));
                                                   CaptionML=ENU=Anticipated Annual Yield [kWh];
                                                   Description=FF;
                                                   Editable=No }
    { 30110;  ;Subsidy Tariff Details;Decimal     ;DecimalPlaces=2:4 }
    { 30111;  ;Subsidy Tariff Currency;Code10     ;TableRelation=Currency.Code;
                                                   Description=NEW }
    { 30200;  ;Email Notification  ;Boolean       ;CaptionML=[ENU=Email Notification;
                                                              DEA=Email Benachrichtigung] }
    { 39999;  ;_OPERATIONAL        ;Boolean        }
    { 41000;  ;Available in PV Plus;Boolean        }
    { 41010;  ;Available in EEM    ;Boolean        }
    { 41020;  ;EEM Identification  ;Text250       ;Description=#datatype change }
    { 41030;  ;Direct Marketer Interface;Boolean  ;CaptionML=ENU=Direct Marketer Interface }
    { 41100;  ;External Portal Available;Boolean  ;CaptionML=ENU=External Portal Available }
    { 41110;  ;Monitoring Type of Internet;Option ;OptionString=[ ,GSM,Microwave Link,Other];
                                                   Description=#delete }
    { 41120;  ;Monitoring Internet Details;Text150;Description=#delete }
    { 41130;  ;Security Internet Details;Text150  ;Description=#delete }
    { 41200;  ;On Site Maintanance ;Option        ;CaptionML=[ENU=On Site Maintanance;
                                                              DEA=Vor Ort Wartung];
                                                   OptionString=[ ,Internal,Subcontractor,Internal and Subcontractor,Not relevant] }
    { 41210;  ;Security Center Handling;Boolean   ;CaptionML=ENU=Security Center Handling;
                                                   Description=#wording }
    { 41220;  ;Site Entry Specifics;Text250        }
    { 41230;  ;Health and Safety Requirements;Text250 }
    { 49999;  ;_PROJECT            ;Boolean        }
    { 50000;  ;Project Order No.   ;Code20        ;CaptionML=[ENU=Order No.;
                                                              DEA=Auftragsnr.] }
    { 50010;  ;Project Quote No    ;Code20        ;CaptionML=[ENU=Quote No.;
                                                              DEA=Angebotsnr.] }
    { 50020;  ;Project Start Date  ;Date          ;CaptionML=[ENU=Start Date;
                                                              DEA=Startdatum] }
    { 50030;  ;Project End Date    ;Date          ;CaptionML=[ENU=End Date;
                                                              DEA=Enddatum] }
    { 50031;  ;Project Due date    ;Date          ;CaptionML=ENU=Due Date }
    { 50040;  ;Project Trigger     ;Option        ;CaptionML=[ENU=Trigger;
                                                              DEA=Ausl”ser];
                                                   OptionString=[ ,Internal,Technical Enhancement,Customer Request,,,,,,,,,Other] }
    { 50050;  ;Project Goals       ;Text80        ;CaptionML=[ENU=Goals;
                                                              DEA=Ziele] }
    { 50060;  ;Project Summary     ;Text80        ;CaptionML=[ENU=Summary;
                                                              DEA=Zusammenfassung] }
    { 50070;  ;Project Documentation;Text80       ;CaptionML=[ENU=Documentation;
                                                              DEA=Dokumentation] }
    { 50200;  ;Project Prority     ;Option        ;CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionString=Low,Medium,High }
    { 50210;  ;Project Status      ;Option        ;OptionString=Conception,Detail planning,Under Construction,Comissioned,Closed }
    { 50220;  ;First Project Manager;Code50       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data".Key2 WHERE (Type=CONST(User),
                                                                                                         Objecttype=CONST(Project),
                                                                                                         Key1=FIELD(No.),
                                                                                                         Project Manager=CONST(Yes)));
                                                   CaptionML=ENU=First Project Manager;
                                                   Description=FF;
                                                   Editable=No }
    { 50221;  ;First Related Customer;Code20      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data".Key3 WHERE (Type=CONST(Customer),
                                                                                                         Objecttype=CONST(Project),
                                                                                                         Key1=FIELD(No.)));
                                                   CaptionML=ENU=First Related Customer;
                                                   Description=FF;
                                                   Editable=No }
    { 50222;  ;First Related Customer Name;Text50 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data"."Customer Name" WHERE (Type=CONST(Customer),
                                                                                                                    Objecttype=CONST(Project),
                                                                                                                    Key1=FIELD(No.)));
                                                   CaptionML=ENU=First Related Customer;
                                                   Description=FF;
                                                   Editable=No }
    { 50223;  ;First Related Asset ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data".Key1 WHERE (Type=CONST(Project),
                                                                                                         Objecttype=CONST(Asset),
                                                                                                         Key2=FIELD(No.)));
                                                   CaptionML=ENU=First Related Asset;
                                                   Description=FF;
                                                   Editable=No }
    { 50230;  ;Project Company Name;Text30        ;TableRelation=Company.Name;
                                                   CaptionML=ENU=Project Company Name }
    { 50299;  ;_EXTENDED           ;Boolean        }
    { 50300;  ;Weekend Working Procedure;Text250   }
    { 50330;  ;Customer Demand Level;Option       ;CaptionML=ENU=Customer Demand Level;
                                                   OptionString=[ ,not relevant,minor,below average,average,demanding,high demanding];
                                                   Description=#deleted (Migration zu Vertag) }
    { 50340;  ;Monitoring Access Details;Text250  ;CaptionML=ENU=Monitoring Access Details;
                                                   Description=#delete }
    { 59999;  ;_OTHER              ;Boolean        }
    { 60000;  ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Responsibility Center;
                                                              DEA=Zust„ndigkeitseinheitencode] }
    { 70000;  ;CM Is Temporary     ;Boolean       ;CaptionML=[ENU=Is Temporary;
                                                              DEA=Ist Tempor„r] }
    { 70001;  ;Empty 1             ;Boolean       ;Description=Dont ask }
    { 70002;  ;Empty 2             ;Boolean        }
    { 70003;  ;Empty 3             ;Boolean        }
    { 70004;  ;Empty 4             ;Boolean        }
    { 80000;  ;_MANAGEMENTREPORTING;Boolean        }
    { 80010;  ;Customer No. Filter ;Code20        ;FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80020;  ;Customer Name Filter;Text50        ;FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80030;  ;Customer Company Chain Filter;Text50;
                                                   FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80110;  ;Contract No. Filter ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="CMMS Contract";
                                                   Description=Filter }
    { 80210;  ;User ID (Role) Filter;Code50       ;FieldClass=FlowFilter;
                                                   TableRelation="User Setup";
                                                   Description=Filter }
    { 80310;  ;Project No. Filter  ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Project));
                                                   Description=Filter }
    { 80320;  ;Project Name Filter ;Text50        ;FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80420;  ;Asset Name Filter   ;Text50        ;FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80430;  ;Asset Type Filter   ;Text50        ;FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80510;  ;Contact No. Filter  ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Contact WHERE (CMMS Is CMMS Contact=CONST(Yes));
                                                   Description=Filter }
    { 80520;  ;Business Relation Filter;Text50    ;FieldClass=FlowFilter;
                                                   TableRelation="Business Relation";
                                                   Description=Filter }
    { 81000;  ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   Editable=No }
    { 89000;  ;No. of WOs (Due Date);Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Objecttype=FIELD(Objecttype),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Due Date=FIELD(Date Filter)));
                                                   Editable=No }
    { 89100;  ;No. of To-dos  (Due Date);Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Objecttype=FIELD(Objecttype),
                                                                                  CM Object No.=FIELD(No.),
                                                                                  Date=FIELD(Date Filter)));
                                                   Editable=No }
    { 89500;  ;Asset Time Tracking Qty.;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Date Filter),
                                                                                                            CM Asset No.=FIELD(No.)));
                                                   Editable=No }
    { 89600;  ;Project Time Tracking Qty.;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Date Filter),
                                                                                                            CM Project No.=FIELD(No.)));
                                                   Editable=No }
    { 90000;  ;ShowAsset           ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("CMMS Additional Data" WHERE (Type=CONST(User),
                                                                                                   Key1=FIELD(No.),
                                                                                                   Key2=FIELD(User ID Filter))) }
    { 90010;  ;ShowAsset2          ;Boolean        }
    { 90100;  ;User ID Filter      ;Code50        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=User ID Filter;
                                                              DEA=Benutzer-ID-Filter] }
    { 90200;  ;Block Dim.          ;Boolean        }
  }
  KEYS
  {
    {    ;Objecttype,No.                          ;Clustered=Yes }
    {    ;Country Code,Objecttype,No.              }
    {    ;Objecttype,Main Asset No.                }
    {    ;Objecttype,Main Asset No.,Asset Type     }
    {    ;Objecttype,Asset Type                    }
    {    ;Objecttype,Responsibility Center         }
    {    ;No.,Name                                 }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name,Field300,Country Code,Operational Status,Main Asset No. }
    { 2   ;Brick               ;No.,Name,Operational Status,Name 2,Empty 1,Country Code }
  }
  CODE
  {
    VAR
      PostCode@1000000000 : Record 225;
      CMUserAccMgt@1000000007 : Codeunit 70010;
      CMAssetMgt@1000000004 : Codeunit 70020;
      CMGenMgt@1000000002 : Codeunit 70000;
      LogEntry@1000000003 : Record 5065;
      Text001@1000000005 : TextConst 'ENU=Asset / Project "%1" created.';
      Text002@1000000006 : TextConst 'ENU=From "%1" to "%2"';

    BEGIN
    END.
  }
}

OBJECT Table 70021 CMMS Additional Data
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=16:24:33;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               CheckAssetInactive();

               ValidateSubAsset();
               ValidateProject();
               ValidateContract();
               ValidateToDo();
               SetNewAsset();
               ValidateCustomerNo();
               ValidateUserSubstitution();
               ValidateNotificationCopy();
               ValidateFieldsetRow();
               ValidateReportFieldsetSetup();
             END;

    OnModify=BEGIN
               CheckAssetInactive();
               UpdateYieldSum();
             END;

    OnDelete=BEGIN
               CheckAssetInactive();
               ClearOldAsset(Rec);
               DeleteToDo();
               DeleteRecurChecklist();
               DeleteFieldsetRows();

               IF Rec.Type = Rec.Type::Contract THEN
                 CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::"Contract Detached", (Rec.Key2 + ' | '  + FORMAT(Rec."Contract Start Date")), STRSUBSTNO(Text013, Rec.Key2, Rec.Key1, FORMAT(Rec."Contract Start Date")));
             END;

    OnRename=BEGIN
               CheckAssetInactive();

               IF Rec.Type = Rec.Type::Contract THEN
                 CMGenMgt.CreateLogEntry(xRec,LogEntry."CM Log Type"::"Contract Detached", (xRec.Key2 + ' | '  + FORMAT(xRec."Contract Start Date")), STRSUBSTNO(Text013, xRec.Key2, xRec.Key1, FORMAT(xRec."Contract Start Date")));

               ValidateContract();
               ValidateSubAsset();
               ValidateProject();
               ValidateUserSubstitution();
               ClearOldAsset(xRec);
               SetNewAsset();
               RenameFieldsetRows();
             END;

    CaptionML=ENU=CMMS Additional Data;
  }
  FIELDS
  {
    { 90  ;   ;Objecttype          ;Option        ;OptionString=Asset,Project,Contract,User,Tool,Contact,Workorder,Task }
    { 100 ;   ;Type                ;Option        ;OptionString=SubAsset,Customer,Contract,User,Project,YieldStudy,Tool,Skill,Relation,ContractPackage,RecurringToDo,GpmOperatorMapping,GpmPlantMapping,Substitue,Manufacturer,Model,Fieldset,FieldsetRow,ReportFieldsetSetup,NotificationCopy }
    { 110 ;   ;Key1                ;Code20        ;TableRelation=IF (Type=CONST(SubAsset),
                                                                     Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Asset))
                                                                     ELSE IF (Type=CONST(Customer),
                                                                              Objecttype=CONST(Asset)) "CMMS Object".No.
                                                                              ELSE IF (Type=CONST(User),
                                                                                       Objecttype=CONST(Asset)) "CMMS Object".No.
                                                                                       ELSE IF (Type=CONST(Project),
                                                                                                Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Asset))
                                                                                                ELSE IF (Type=CONST(Contract),
                                                                                                         Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Asset))
                                                                                                         ELSE IF (Type=CONST(YieldStudy),
                                                                                                                  Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Asset))
                                                                                                                  ELSE IF (Type=CONST(Relation),
                                                                                                                           Objecttype=CONST(Asset)) "CMMS Object".No.
                                                                                                                           ELSE IF (Type=CONST(Relation),
                                                                                                                                    Objecttype=CONST(Contract)) "CMMS Contract".No.
                                                                                                                                    ELSE IF (Type=CONST(ContractPackage),
                                                                                                                                             Objecttype=CONST(Contract)) "CMMS Contract".No.
                                                                                                                                             ELSE IF (Type=CONST(Substitue),
                                                                                                                                                      Objecttype=CONST(User)) "User Setup"."User ID"
                                                                                                                                                      ELSE IF (Type=CONST(FieldsetRow),
                                                                                                                                                               Objecttype=CONST(Asset)) "CMMS Additional Data".Key1 WHERE (Objecttype=CONST(Asset),
                                                                                                                                                                                                                           Type=CONST(Fieldset));
                                                   Description=Dont write code in OnLookup() trigger! }
    { 120 ;   ;Key2                ;Code50        ;TableRelation=IF (Type=CONST(User),
                                                                     Objecttype=CONST(Asset)) "User Setup"
                                                                     ELSE IF (Type=CONST(User),
                                                                              Objecttype=CONST(Project)) "User Setup"
                                                                              ELSE IF (Type=CONST(Project),
                                                                                       Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Project))
                                                                                       ELSE IF (Type=CONST(Contract),
                                                                                                Objecttype=CONST(Asset)) "CMMS Contract".No. WHERE (Template=CONST(No))
                                                                                                ELSE IF (Type=CONST(Relation)) Contact
                                                                                                ELSE IF (Type=CONST(SubAsset),
                                                                                                         Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Asset))
                                                                                                         ELSE IF (Type=CONST(ContractPackage),
                                                                                                                  Objecttype=CONST(Contract)) "CMMS Code Data".Code WHERE (TableID=CONST(70021),
                                                                                                                                                                           FieldID=CONST(120),
                                                                                                                                                                           Type=CONST(0))
                                                                                                                                                                           ELSE IF (Type=CONST(Substitue),
                                                                                                                                                                                    Objecttype=CONST(User)) "User Setup"."User ID"
                                                                                                                                                                                    ELSE IF (Type=CONST(Model)) "CMMS Additional Data".Key2 WHERE (Type=CONST(Manufacturer),
                                                                                                                                                                                                                                                   Line No.=FIELD(Line No.));
                                                   Description=Dont write code in OnLookup() trigger! }
    { 130 ;   ;Key3                ;Code50        ;OnValidate=BEGIN
                                                                ValidateCustomerNo();
                                                                ValidateYieldType();
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupCustomerNo();
                                                              LookupCustomerNoReportFieldsetSetup();
                                                              LookupYieldType();
                                                            END;
                                                             }
    { 140 ;   ;Line No.            ;Integer        }
    { 10000;  ;XXX SUB ASSET XXX   ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### SUB ASSET
                                                                Key1 = Main Asset No.
                                                                Key2 = Sub Asset No.
                                                                }
                                                              END;
                                                               }
    { 10010;  ;Asset Name          ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object".Name WHERE (No.=FIELD(Key2)));
                                                   CaptionML=[ENU=Asset Name;
                                                              DEA=Anlagenname];
                                                   Description=FF;
                                                   Editable=No }
    { 20000;  ;XXX CUSTOMER XXX    ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### CUSTOMER
                                                                Key1 = Asset No.
                                                                Key3 = Customer No.
                                                                }
                                                              END;
                                                               }
    { 20010;  ;Customer Name       ;Text50        ;OnValidate=VAR
                                                                Customer@1000000000 : Record 18;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Customer Name;
                                                              DEA=Debitorname];
                                                   Editable=No }
    { 20030;  ;Contact Person No.  ;Code20        ;TableRelation=Contact.No. WHERE (Type=CONST(Person));
                                                   CaptionML=[ENU=Contact Person No.;
                                                              DEA=Kontaktperson Nr.] }
    { 20040;  ;Customer No. Invalid;Boolean       ;CaptionML=[ENU=Customer No. Invalid;
                                                              DEA=Debitornr. Ungltig] }
    { 20050;  ;Customer Company Chain;Code20      ;Editable=No }
    { 20100;  ;Share               ;Integer       ;CaptionML=[ENU=Share;
                                                              DEA=Anteil];
                                                   MinValue=0 }
    { 30000;  ;XXX CONTRACT XXX    ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### CONTRACT
                                                                Key1 = Asset No.
                                                                Key2 = Contract Code.
                                                                Key3 = Contract Start Date (As String "2018-03-22")
                                                                }
                                                              END;
                                                               }
    { 30010;  ;Contract Name       ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Contract".Name WHERE (No.=FIELD(Key2),
                                                                                                  Template=CONST(No)));
                                                   CaptionML=[ENU=Contract Name;
                                                              DEA=Vertragsname];
                                                   Description=FF;
                                                   Editable=No }
    { 30011;  ;Asset NameX         ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object".Name WHERE (Objecttype=CONST(Asset),
                                                                                                No.=FIELD(Key1)));
                                                   CaptionML=ENU=Asset Name;
                                                   Description=FF;
                                                   Editable=No }
    { 30020;  ;Main Contract       ;Boolean       ;OnValidate=BEGIN
                                                                ValidateMainContract();
                                                              END;
                                                               }
    { 30100;  ;Contract Type       ;Code20        ;OnValidate=VAR
                                                                CMMSCodeData@1000000000 : Record 70006;
                                                              BEGIN
                                                                CMMSCodeData.ValidateCodeData(Rec.RECORDID.TABLENO, Rec.FIELDNO("Contract Type"), 0, Rec."Contract Type");
                                                              END;

                                                   OnLookup=VAR
                                                              CMMSCodeData@1000000000 : Record 70006;
                                                            BEGIN
                                                              CMMSCodeData.LookupCodeData(Rec.RECORDID.TABLENO, Rec.FIELDNO("Contract Type"), 0, Rec."Contract Type");
                                                            END;

                                                   CaptionML=[ENU=Type;
                                                              DEA=Art] }
    { 30110;  ;Contract Start Date ;Date          ;OnValidate=BEGIN
                                                                UpdateContractStartDate();

                                                                IF (Rec."Contract Start Date" <> 0D) AND (Rec."Start Date Invoicing" = 0D) THEN
                                                                    Rec."Start Date Invoicing" := Rec."Contract Start Date";

                                                                IF (Rec."Contract Start Date" <> 0D) AND
                                                                   (Rec."Contract End Date" <> 0D) AND
                                                                   (Rec."Contract Start Date" >= "Contract End Date") THEN
                                                                  ERROR(Text018, Rec.FIELDCAPTION("Contract Start Date"), Rec.FIELDCAPTION("Contract End Date"));
                                                              END;

                                                   CaptionML=[ENU=Start Date;
                                                              DEA=Startdatum] }
    { 30120;  ;Contract End Date   ;Date          ;OnValidate=BEGIN
                                                                IF (Rec."Contract End Date" <> 0D) AND (Rec."End Date Invoicing" = 0D) THEN
                                                                    Rec."End Date Invoicing" := Rec."Contract End Date";

                                                                IF (Rec."Contract Start Date" <> 0D) AND
                                                                   (Rec."Contract End Date" <> 0D) AND
                                                                   (Rec."Contract Start Date" >= "Contract End Date") THEN
                                                                  ERROR(Text018, Rec.FIELDCAPTION("Contract Start Date"), Rec.FIELDCAPTION("Contract End Date"));
                                                              END;

                                                   CaptionML=[ENU=End Date;
                                                              DEA=Enddatum] }
    { 30130;  ;Start Date Invoicing;Date          ;CaptionML=[ENU=Start Date Invoicing;
                                                              DEA=Startdatum Verrechnung] }
    { 30140;  ;End Date Invoicing  ;Date          ;CaptionML=[ENU=Enddate Invoicing;
                                                              DEA=Enddatum Verrechnung] }
    { 30150;  ;Invoicing Period    ;Option        ;CaptionML=[ENU=Invoicing Period;
                                                              DEA=Verrechnungsperiode];
                                                   OptionString=Month,Quarter,Half Year,Year }
    { 30160;  ;Invoicing Type      ;Option        ;CaptionML=[ENU=Invoicing Type;
                                                              DEA=Verrechnungsart];
                                                   OptionString=Pre,Post }
    { 30170;  ;Monthly Amount      ;Decimal       ;CaptionML=[ENU=Monthly Amount;
                                                              DEA=Monatlicher Betrag] }
    { 30180;  ;Currency Code       ;Code10        ;TableRelation=Currency.Code;
                                                   CaptionML=[ENU=Currency Code;
                                                              DEA=W„hrungscode] }
    { 30190;  ;Accounting Entity   ;Text30        ;TableRelation=Company.Name;
                                                   CaptionML=ENU=Accounting Entity }
    { 40000;  ;XXX USER XXX        ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### USER
                                                                Key1 = Asset No.
                                                                Key2 = User ID
                                                                }
                                                              END;
                                                               }
    { 40020;  ;Reporting Responsible;Boolean      ;CaptionML=[ENU=Reporting Responsible;
                                                              DEA=Verantwortlich Reporting] }
    { 40030;  ;Invoice Responsible ;Boolean       ;CaptionML=[ENU=Invoice Responsible;
                                                              DEA=Verantwortlich Rechnungsstellung] }
    { 40040;  ;Accounting Responsible;Boolean     ;CaptionML=[ENU=Accounting Responsible;
                                                              DEA=Verantwortlich Buchhaltung] }
    { 40050;  ;Plant Manager       ;Boolean       ;CaptionML=[ENU=Plant Manager;
                                                              DEA=Plant Manager] }
    { 40051;  ;Project Manager     ;Boolean       ;CaptionML=[ENU=Project Manager;
                                                              DEA=Projekt Manager] }
    { 40060;  ;Field Service       ;Boolean       ;CaptionML=[ENU=Field Service;
                                                              DEA=Field Service] }
    { 40070;  ;Customer            ;Boolean       ;CaptionML=[ENU=Customer;
                                                              DEA=Kunde] }
    { 40080;  ;Remote Monitoring Responsible;Boolean;
                                                   CaptionML=ENU=Remote Monitoring Responsible }
    { 40090;  ;Responsible OM supervisor;Boolean  ;CaptionML=ENU=Responsible O&M supervisor }
    { 45000;  ;XXX PROJECT XXX     ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### USER
                                                                Key1 = Asset No.
                                                                Key2 = Project No.
                                                                }
                                                              END;
                                                               }
    { 45010;  ;Asset NameXX        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object".Name WHERE (Objecttype=CONST(Asset),
                                                                                                No.=FIELD(Key1)));
                                                   OnLookup=BEGIN
                                                              ;
                                                            END;

                                                   CaptionML=ENU=Asset Name;
                                                   Description=FF;
                                                   Editable=No }
    { 45020;  ;Project NameXX      ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object".Name WHERE (Objecttype=CONST(Project),
                                                                                                No.=FIELD(Key2)));
                                                   OnLookup=BEGIN
                                                              ;
                                                            END;

                                                   CaptionML=ENU=Project Name;
                                                   Description=FF;
                                                   Editable=No }
    { 50000;  ;XXX ASSET PROJECT XXX;Boolean      ;OnValidate=BEGIN
                                                                {
                                                                ### ASSET PROJECT
                                                                Key1 = Asset No. (ASSET)
                                                                Key2 = Project No. (PROJECT)
                                                                }
                                                              END;
                                                               }
    { 60000;  ;XXX YIELD STUDY XXX ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### YIELD STUDY
                                                                Key1 = Asset No. (ASSET)
                                                                Key2 = Source
                                                                Key3 = Yield Type (Code Data link)
                                                                }
                                                              END;
                                                               }
    { 60030;  ;Yield Source Description;Text50     }
    { 60040;  ;Valid Source        ;Boolean       ;OnValidate=BEGIN
                                                                ValidateValidYield();
                                                              END;
                                                               }
    { 60041;  ;Degradation         ;Decimal       ;CaptionML=ENU=Degradation [%];
                                                   DecimalPlaces=2:2;
                                                   MinValue=0;
                                                   MaxValue=2 }
    { 60042;  ;Unit of Measure     ;Code10        ;TableRelation="Unit of Measure".Code }
    { 60043;  ;Degradation Start Date;Date         }
    { 60050;  ;January             ;Decimal        }
    { 60060;  ;February            ;Decimal        }
    { 60070;  ;March               ;Decimal        }
    { 60080;  ;April               ;Decimal        }
    { 60090;  ;May                 ;Decimal        }
    { 60100;  ;June                ;Decimal        }
    { 60110;  ;July                ;Decimal        }
    { 60120;  ;August              ;Decimal        }
    { 60130;  ;September           ;Decimal        }
    { 60140;  ;October             ;Decimal        }
    { 60150;  ;November            ;Decimal        }
    { 60160;  ;December            ;Decimal        }
    { 60200;  ;Yield Total         ;Decimal       ;Editable=No }
    { 60300;  ;Is Yield Type 1     ;Boolean        }
    { 60301;  ;Is Yield Type 2     ;Boolean        }
    { 70000;  ;CM Is Temporary     ;Boolean       ;CaptionML=[ENU=Is Temporary;
                                                              DEA=Ist Tempor„r] }
    { 90000;  ;XXX RELATION XXX    ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### RELATION
                                                                Key1 = Object No.
                                                                Key3 = Contact No.
                                                                }
                                                              END;
                                                               }
    { 90010;  ;Business Relation Code;Code20      ;TableRelation="Business Relation".Code;
                                                   OnValidate=BEGIN
                                                                ValidateBusinessRelation();
                                                              END;
                                                               }
    { 90011;  ;Relation Group Code ;Code20        ;TableRelation="CMMS Code Data".Code WHERE (TableID=CONST(70021),
                                                                                              FieldID=CONST(90011),
                                                                                              Type=CONST(0));
                                                   OnValidate=BEGIN
                                                                ValidateBusinessGroup();
                                                              END;
                                                               }
    { 90020;  ;Business Relation Description;Text50 }
    { 90021;  ;Relation Group Description;Text50   }
    { 90030;  ;Contact Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Key2)));
                                                   CaptionML=[ENU=Contact Name;
                                                              DEA=Kontaktname];
                                                   Editable=No }
    { 90040;  ;Contact Phone No.   ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact."Phone No." WHERE (No.=FIELD(Key2)));
                                                   CaptionML=[ENU=Contact Phone No.;
                                                              DEA=Kontakt Telefonnr.];
                                                   Editable=No }
    { 90050;  ;Contact E-Mail      ;Text80        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.E-Mail WHERE (No.=FIELD(Key2)));
                                                   CaptionML=[ENU=Contact E-Mail;
                                                              DEA=Kontakt E-Mail];
                                                   Editable=No }
    { 91000;  ;XXX CONTRACT PACKAGE XXX;Boolean   ;OnValidate=BEGIN
                                                                {
                                                                ### CONTRACT PACKAGE
                                                                Key1 = Contract No.
                                                                Key2 = Packackage Code
                                                                }
                                                              END;
                                                               }
    { 91020;  ;Package Description ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Code Data".Description WHERE (TableID=CONST(70021),
                                                                                                          FieldID=CONST(120),
                                                                                                          Type=CONST(0)));
                                                   Editable=No }
    { 91030;  ;Additional Package Info;Text250     }
    { 100000; ;XXX RECURRING TASK XXX;Boolean     ;OnValidate=BEGIN
                                                                {
                                                                ### RECURRING TASK
                                                                Key1 = Object No.
                                                                Line No = Line No.
                                                                }
                                                              END;
                                                               }
    { 100090; ;Inactive            ;Boolean       ;CaptionML=[ENU=Inactive;
                                                              DEA=Inaktiv] }
    { 100100; ;Start Date          ;Date          ;CaptionML=[ENU=Start Date;
                                                              DEA=Startdatum] }
    { 100105; ;Start Time          ;Time          ;CaptionML=[ENU=Starting Time;
                                                              DEA=Startzeit] }
    { 100110; ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              DEA=F„lligkeitsdatum] }
    { 100120; ;Expiration Date     ;Date          ;CaptionML=[ENU=Expiration Date;
                                                              DEA=Ablaufdatum] }
    { 100130; ;Recurring Date Interval;DateFormula;CaptionML=[ENU=Recurring Date Interval;
                                                              DEA=Wiederholungsrate] }
    { 100200; ;All Day Event       ;Boolean       ;CaptionML=[ENU=All Day Event;
                                                              DEA=Ganzt„giges Ereignis] }
    { 100300; ;Interaction Group Code;Code10      ;TableRelation="Interaction Group";
                                                   CaptionML=[ENU=Interaction Group Code;
                                                              DEA=Aktivit„tengruppencode] }
    { 100310; ;Interaction Template Code;Code10   ;TableRelation="Interaction Template" WHERE (Interaction Group Code=FIELD(Interaction Group Code));
                                                   OnValidate=VAR
                                                                TodoInteractionLanguage@1000 : Record 5196;
                                                                Attachment@1001 : Record 5062;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Interaction Template Code;
                                                              DEA=Aktivit„tenvorlagencode] }
    { 100320; ;Activity Code       ;Code10        ;TableRelation=Activity;
                                                   OnValidate=BEGIN
                                                                ValidateActivityCode();
                                                              END;

                                                   CaptionML=[ENU=Activity Code;
                                                              DEA=Aktionscode];
                                                   NotBlank=Yes }
    { 100330; ;Step No.            ;Integer       ;CaptionML=[ENU=Step No.;
                                                              DEA=Schrittnr.] }
    { 100400; ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 100430; ;Maintask Step No.   ;Integer       ;CaptionML=[ENU=Maintask Step No.;
                                                              DEA=Hauptaufg. Schrittnr.] }
    { 100440; ;Maintask Line No.   ;Integer       ;CaptionML=[ENU=Maintask Step No.;
                                                              DEA=Hauptaufg. Schrittnr.] }
    { 100450; ;Subtype             ;Option        ;CaptionML=[ENU=Subtype;
                                                              DEA=Subtyp];
                                                   OptionString=[ ,Checklist,Team] }
    { 100500; ;Priority            ;Option        ;CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High }
    { 100600; ;Duration            ;Duration      ;CaptionML=[ENU=Duration;
                                                              DEA=Dauer] }
    { 100700; ;Clearable           ;Boolean       ;CaptionML=[ENU=Clearable;
                                                              DEA=Verrechenbar] }
    { 100710; ;Automated Posting   ;Boolean       ;CaptionML=[ENU=Automated Posting;
                                                              DEA=Automatische Buchung] }
    { 101000; ;Source Type         ;Option        ;CaptionML=[ENU=Source Type;
                                                              DEA=Herkunftsart];
                                                   OptionCaptionML=[ENU=Asset,Project,Contract,User,Tool,Contact,Workorder,Task;
                                                                    DEA=Anlage,Projekt,Vertrag,Benutzer,Werkzeug,Kontakt,Arbeitsauftrag,Aufgabe];
                                                   OptionString=Asset,Project,Contract,User,Tool,Contact,Workorder,Task }
    { 101010; ;Source No.          ;Code20        ;CaptionML=[ENU=Source No.;
                                                              DEA=Herkunftsnr.] }
    { 101015; ;Source Line No.     ;Integer       ;CaptionML=[ENU=Source No.;
                                                              DEA=Herkunftsnr.] }
    { 101020; ;Creation Date       ;Date          ;CaptionML=[ENU=Creation Date;
                                                              DEA=Errichtungsdatum] }
    { 101021; ;Created by          ;Code50        ;CaptionML=[ENU=Created by;
                                                              DEA=Errichtet von] }
    { 110000; ;XXX GPM Plant Mapping XXX;Boolean  ;OnValidate=BEGIN
                                                                {
                                                                ### GPM Plant Mapping
                                                                Key1 = GPM Plant ID
                                                                }
                                                              END;
                                                               }
    { 110100; ;Asset No.           ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Asset));
                                                   CaptionML=[ENU=CMMS Asset No.;
                                                              DEA=CMMS Anlagennr.] }
    { 110110; ;GPM Op. Mapping Comment;Text80     ;CaptionML=[ENU=Comment;
                                                              DEA=Kommentar] }
    { 120000; ;XXX GPM Operator Mapping XXX;Boolean;
                                                   OnValidate=BEGIN
                                                                {
                                                                ### GPM Operator Mapping
                                                                Key1 = GPM Operator ID
                                                                }
                                                              END;
                                                               }
    { 120100; ;User Id             ;Code50        ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=CMMS User ID;
                                                              DEA=CMMS Benutzer ID] }
    { 120110; ;GPM Plant Mapping Comment;Text80   ;CaptionML=[ENU=Comment;
                                                              DEA=Kommentar] }
    { 120120; ;Ignore this Operator;Boolean        }
    { 130000; ;XXX SUBSTITUE XXX   ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### SUBSTITUTE
                                                                Key1 = Original User ID (the one who is away)
                                                                Key2 = Substite User ID (the one who substitutes him)
                                                                }
                                                              END;
                                                               }
    { 130010; ;From Date           ;Date          ;CaptionML=ENU=From Date }
    { 130020; ;To Date             ;Date          ;CaptionML=ENU=To Date }
    { 140000; ;XXX MANUFACTURER XXX;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### MANUFACTURER
                                                                Key2 = Manufacturer Code
                                                                Line No. = Component Type <Equipment Hierarchie>
                                                                }
                                                              END;
                                                               }
    { 140010; ;Manufacturer Name   ;Text80         }
    { 150000; ;XXX MODEL XXX       ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### MODEL
                                                                Key2 = Manufacturer Code
                                                                Key3 = Model Code
                                                                Line No. = Component Type <Equipment Hierarchie>
                                                                }
                                                              END;
                                                               }
    { 150010; ;Model Name          ;Text80         }
    { 150020; ;Manufacturer Name_  ;Text80        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data"."Manufacturer Name" WHERE (Type=CONST(Manufacturer),
                                                                                                                        Key2=FIELD(Key2),
                                                                                                                        Line No.=FIELD(Line No.)));
                                                   CaptionML=ENU=Manufacturer Name;
                                                   Description=FF;
                                                   Editable=No }
    { 150030; ;Component Type      ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Asset Component"."Component Type" WHERE (Component Type Integer=FIELD(Line No.)));
                                                   CaptionML=ENU=Component Type;
                                                   OptionString=Modules,Inverter,Combiner Box,Sensor,Monitoring Hardware,Internet Connection HW,Security System,Meters,Transformer,Switchgear,Cables,Remote Access Details,,,,,,,Others;
                                                   Description=FF;
                                                   Editable=No }
    { 160000; ;XXX FIELDSET XXX    ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### FIELDSET
                                                                Key1 = Fieldset Code
                                                                }
                                                              END;
                                                               }
    { 160010; ;Fieldset Name       ;Text50        ;CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 160020; ;No. of Rows         ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(FieldsetRow),
                                                                                                   Key1=FIELD(Key1)));
                                                   CaptionML=[ENU=No. of Rows;
                                                              DEA=Anzahl Zeilen];
                                                   Description=FF;
                                                   Editable=No }
    { 180000; ;XXX FIELDSET ROW XXX;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### FIELDSET
                                                                Key1 = Fieldset Code
                                                                Line No. = Line Number (Row)
                                                                }
                                                              END;
                                                               }
    { 180006; ;Default Fieldset    ;Boolean       ;OnValidate=VAR
                                                                Rec2@1000000000 : Record 70021;
                                                              BEGIN
                                                                IF NOT "Default Fieldset" THEN
                                                                  EXIT;

                                                                Rec2.RESET;
                                                                Rec2.SETRANGE(Objecttype, Rec.Objecttype::Asset);
                                                                Rec2.SETRANGE(Type, Rec.Type::Fieldset);
                                                                Rec2.SETFILTER(Key1, '<>%1',Rec.Key1);
                                                                Rec2.SETRANGE("Default Fieldset", TRUE);
                                                                IF Rec2.FINDFIRST() THEN
                                                                  ERROR(Text019, Rec2.Key1);
                                                              END;
                                                               }
    { 180007; ;Style               ;Option        ;CaptionML=[ENU=Style;
                                                              DEA=Style];
                                                   OptionString=Normal,Short Caption,Short Value,Value Only,Caption Only }
    { 180008; ;Area                ;Option        ;CaptionML=[ENU=Area;
                                                              DEA=Bereich];
                                                   OptionString=Workorder,Task }
    { 180009; ;Position            ;Option        ;CaptionML=[ENU=Position;
                                                              DEA=Position];
                                                   OptionString=left,right }
    { 180010; ;Order               ;Integer       ;CaptionML=[ENU=Order;
                                                              DEA=Sortierung] }
    { 180100; ;Caption Type        ;Option        ;InitValue=Caption;
                                                   CaptionML=[ENU=Caption Type;
                                                              DEA=Beschreibung Typ];
                                                   OptionString=Caption,Value,Text }
    { 180110; ;Caption Table       ;Option        ;OnValidate=BEGIN
                                                                Rec."Caption Table Id" := GetCaptionTableId();
                                                              END;

                                                   CaptionML=[ENU=Caption Table;
                                                              DEA=Beschreibung Tabelle];
                                                   OptionString=Workorder,Task,Asset }
    { 180111; ;Caption Table Id    ;Integer       ;CaptionML=[ENU=Caption Table Id;
                                                              DEA=Beschreibung Tabelle Id] }
    { 180120; ;Caption Field Id    ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Caption Table Id));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Caption Fieldname");
                                                              END;

                                                   CaptionML=[ENU=Caption Field Id;
                                                              DEA=Beschreibung Feldnr.] }
    { 180121; ;Caption Fieldname   ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field."Field Caption" WHERE (TableNo=FIELD(Caption Table Id),
                                                                                                   No.=FIELD(Caption Field Id)));
                                                   CaptionML=[ENU=Caption Fieldname;
                                                              DEA=Beschreibung Feldname];
                                                   Description=FF;
                                                   Editable=No }
    { 180130; ;Caption Text        ;Text80        ;CaptionML=[ENU=Caption Text;
                                                              DEA=Beschreibung Text] }
    { 180500; ;Value Type          ;Option        ;InitValue=Value;
                                                   CaptionML=[ENU=Value Type;
                                                              DEA=Wert Type];
                                                   OptionString=Caption,Value,Text }
    { 180510; ;Value Table         ;Option        ;OnValidate=BEGIN
                                                                Rec."Value Table Id" := GetValueTableId();
                                                              END;

                                                   CaptionML=[ENU=Value Table;
                                                              DEA=Wert Tabelle];
                                                   OptionString=Workorder,Task,Asset }
    { 180511; ;Value Table Id      ;Integer       ;CaptionML=[ENU=Value Table Id;
                                                              DEA=Wert Tabellennr.] }
    { 180520; ;Value Field Id      ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Value Table Id));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Value Fieldname");
                                                              END;

                                                   CaptionML=[ENU=Value Field Id;
                                                              DEA=Wert Feldnr.] }
    { 180521; ;Value Fieldname     ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field."Field Caption" WHERE (TableNo=FIELD(Value Table Id),
                                                                                                   No.=FIELD(Value Field Id)));
                                                   CaptionML=[ENU=Value Fieldname;
                                                              DEA=Wert Feldname];
                                                   Description=FF;
                                                   Editable=No }
    { 180530; ;Value Text          ;Text80        ;CaptionML=[ENU=Value Text;
                                                              DEA=Wert Text] }
    { 200000; ;XXX REPORT FIELDSET SETUP XXX;Boolean;
                                                   OnValidate=BEGIN
                                                                {
                                                                ### FIELDSET
                                                                Key1 = ''
                                                                Key2 = Asset No. OR Cluster/Portfolio (UPPERCASE)
                                                                Key3 = Customer No.
                                                                }
                                                              END;
                                                               }
    { 200110; ;Portfolio / Cluster ;Text50        ;OnValidate=BEGIN
                                                                Key2 := UPPERCASE("Portfolio / Cluster");
                                                              END;
                                                               }
    { 200120; ;Asset No._          ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Asset));
                                                   OnValidate=BEGIN
                                                                Key2 := "Asset No._";
                                                              END;

                                                   CaptionML=[ENU=Asset No.;
                                                              DEA=Asset No.] }
    { 200200; ;Customer Company    ;Text30        ;TableRelation=Company.Name }
    { 200500; ;Fieldset Code       ;Code20        ;TableRelation="CMMS Additional Data".Key1 WHERE (Objecttype=CONST(Asset),
                                                                                                    Type=CONST(Fieldset),
                                                                                                    Default Fieldset=CONST(No));
                                                   NotBlank=Yes }
    { 210000; ;XXX NOTIFICATION COPY XXX;Boolean  ;OnValidate=BEGIN
                                                                {
                                                                ### SUBSTITUTE
                                                                Key1 = Original User ID
                                                                Key2 = Send Copy To User ID
                                                                }
                                                              END;
                                                               }
    { 210010; ;Not. Copy From Date ;Date          ;CaptionML=ENU=From Date }
    { 210020; ;Not. Copy To Date   ;Date          ;CaptionML=ENU=To Date }
  }
  KEYS
  {
    {    ;Objecttype,Type,Key1,Key2,Key3,Line No. ;Clustered=Yes }
    {    ;Objecttype,Type,Key2,Key1                }
    {    ;Objecttype,Type,Key3,Key1                }
    {    ;Objecttype,Type,Key1,Inactive,Start Date,Due Date,Interaction Group Code }
    {    ;Objecttype,Type,Key1,Area,Position,Order }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=%1 mustnot be the same as %2!;DEA=%1 darf nicht gleich %2 sein!';
      Text002@1000000001 : TextConst 'ENU=%1 is a Main Asset!;DEA=%1 ist eine Hauptanlage!';
      Text003@1000000002 : TextConst 'ENU=%1 is a Sub Asset!;DEA=%1 ist eine Unteranlage!';
      Text004@1000000003 : TextConst 'ENU=%1 is already a Sub Asset from Main Asset %2!;DEA=%1 ist bereits eine Unteranlage von Main Asset %2!';
      Text005@1000000004 : TextConst 'ENU=Main Asset No.;DEA=Hauptanlagennr.';
      Text006@1000000005 : TextConst 'ENU=Sub Asset No.;DEA=Unteranlagennr.';
      Text007@1000000006 : TextConst 'ENU=The Projct %1 already belongs to Asset %2!;DEA=Das Projekt %1 geh”rt schon zur Anlage %2!';
      Text008@1000000007 : TextConst 'ENU=Invalid Input.;DEA=Ungltige Eingabe.';
      Text009@1000000008 : TextConst 'ENU=Invalid Input. %1 is a Project.;DEA=Ungltige Eingabe. %1 ist ein Projekt!';
      Text010@1000000009 : TextConst 'ENU=Contract "%1" is a template!;DEA=Vertrag "%1" ist eine Vorlage!';
      Text011@1000000010 : TextConst 'ENU=Only one valid Source per Type allowed!;DEA=Es darf nur eine gltige Source pro Typ geben!';
      error004@1000000011 : TextConst 'ENU=Execution terminated!;DEA=Die Verarbeitung wurde abgebrochen!';
      CMGenMgt@1000000012 : Codeunit 70000;
      LogEntry@1000000013 : Record 5065;
      Text012@1000000014 : TextConst 'ENU=Contract "%1" was assigned to Object "%2".';
      Text013@1000000015 : TextConst 'ENU=Contract "%1" was detached from Object "%2" (Start Date %3).';
      Text014@1000000016 : TextConst 'ENU=User ID cannot be the same as Substitution!;DEA=Benutzer ID darf nicht die selbe wie Vertreter sein!';
      Text015@1000000017 : TextConst 'ENU=Please enter correct dates!;DEA=Bitte korrekte Datumswerte eingeben!';
      Text016@1000000018 : TextConst 'ENU=The associated %1 %2 is inactive!;DEA=Das zugeh”rige Asset %1 %2 ist inaktiv!';
      Text017@1000000019 : TextConst 'ENU=There can be only one Main Contract per Asset.;DEA=Es kann nur ein Hauptvertrag pro Anlage hinterlegt werden.';
      Text018@1000000020 : TextConst 'ENU=" ""%1"" has to be before ""%2"".";DEA=" ""%1"" muss vor ""%2"" liegen."';
      Text019@1000000021 : TextConst 'ENU=There is only one Default Fieldset allowe. Current Default Fieldset: %1.;DEA=Es darf nur ein Default Fieldset geben. Aktuelles Default Fieldset: %1.';
      Text020@1000000022 : TextConst 'ENU=Please provide %1 or %2.;DEA=Geben Sie entweder %1 oder %2 an.';
      Text021@1000000023 : TextConst 'ENU=Please provide Customer or Asset Information.;DEA=Geben Sie entweder Kunden oder Anlageninformationen an.';
      Text022@1000000024 : TextConst 'ENU=User ID cannot be the same as Send Copy to!;DEA=Benutzer ID darf nicht die selbe wie Copie senden an sein!';

    LOCAL PROCEDURE ValidateSubAsset@1000000000();
    VAR
      SubAsset@1000000000 : Record 70021;
      Asset@1000000001 : Record 70020;
    BEGIN
      //### SUB ASSET
      IF Rec.Type <> Rec.Type::SubAsset THEN
        EXIT;

      Asset.GET(Asset.Objecttype::Asset, Rec.Key1);
      IF Asset.Objecttype = Asset.Objecttype::Project THEN
        ERROR(STRSUBSTNO(Text009, Asset."No."));

      Asset.GET(Asset.Objecttype::Asset, Rec.Key2);
      IF Asset.Objecttype = Asset.Objecttype::Project THEN
        ERROR(STRSUBSTNO(Text009, Asset."No."));
      IF Asset."Asset Type" = Asset."Asset Type"::"Main Asset" THEN
        ERROR(STRSUBSTNO(Text002, Rec.Key2));

      IF Rec.Key1 = Rec.Key2 THEN
        ERROR(STRSUBSTNO(Text001,Text005, Text006));

      SubAsset.RESET;
      SubAsset.SETRANGE(Objecttype, Rec.Objecttype::Asset);
      SubAsset.SETRANGE(Type,Rec.Type::SubAsset);
      SubAsset.SETRANGE(Key1, Rec.Key2);
      IF SubAsset.FINDFIRST() THEN
        ERROR(STRSUBSTNO(Text002, Rec.Key2));

      SubAsset.RESET;
      SubAsset.SETCURRENTKEY(Objecttype,Type,Key2,Key1);
      SubAsset.SETRANGE(Objecttype, Rec.Objecttype::Asset);
      SubAsset.SETRANGE(Type,Rec.Type::SubAsset);
      SubAsset.SETRANGE(Key2, Rec.Key2);
      IF SubAsset.FINDFIRST() THEN
        ERROR(STRSUBSTNO(Text004, Rec.Key2, SubAsset.Key1));
    END;

    LOCAL PROCEDURE SetNewAsset@1000000004();
    VAR
      Asset@1000000000 : Record 70020;
    BEGIN
      //### SUB ASSET
      IF Rec.Type <> Rec.Type::SubAsset THEN
        EXIT;

      Asset.GET(Asset.Objecttype::Asset, Rec.Key1);
      Asset."Main Asset No." := Rec.Key1;
      Asset."Asset Type" := Asset."Asset Type"::"Main Asset";
      Asset.MODIFY(FALSE);

      Asset.GET(Asset.Objecttype::Asset, Rec.Key2);
      Asset."Main Asset No." := Rec.Key1;
      Asset."Asset Type" := Asset."Asset Type"::"Sub Asset";
      Asset.MODIFY(FALSE);
    END;

    LOCAL PROCEDURE ClearOldAsset@1000000006(Record@1000000002 : Record 70021);
    VAR
      Asset@1000000000 : Record 70020;
      SubAsset@1000000001 : Record 70021;
    BEGIN
      //### SUB ASSET
      IF Rec.Type <> Rec.Type::SubAsset THEN
        EXIT;

      SubAsset.RESET;
      SubAsset.SETRANGE(Objecttype, SubAsset.Objecttype::Asset);
      SubAsset.SETRANGE(Type,SubAsset.Type::SubAsset);
      SubAsset.SETRANGE(Key1, Record.Key1);
      SubAsset.SETFILTER(Key2,'<>%1', Record.Key2);
      IF NOT SubAsset.FINDFIRST() THEN BEGIN
        Asset.GET(Asset.Objecttype::Asset, Record.Key1);
        Asset."Asset Type" := Asset."Asset Type"::Asset;
        Asset."Main Asset No." := '';
        Asset.MODIFY(FALSE);
      END;

      Asset.GET(Asset.Objecttype::Asset, Record.Key2);
      Asset."Main Asset No." := '';
      Asset."Asset Type" := Asset."Asset Type"::Asset;
      Asset.MODIFY(FALSE);
    END;

    LOCAL PROCEDURE LookupCustomerNo@1000000002();
    VAR
      Customer@1000000000 : Record 18;
      CustomerList@1000000001 : Page 22;
      CompName@1000000002 : Text[30];
    BEGIN
      //### CUSTOMER
      IF Rec.Type <> Rec.Type::Customer THEN
        EXIT;

      CLEAR(Customer);
      CompName := GetObjectCompanyName();
      IF CompName <> '' THEN
        Customer.CHANGECOMPANY(CompName);

      CustomerList.LOOKUPMODE(TRUE);
      IF CompName <> '' THEN
        CustomerList.CMSetCompany(CompName);
      IF CustomerList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        CustomerList.GETRECORD(Customer);
        Rec.VALIDATE(Key3, Customer."No.");
      END;
    END;

    LOCAL PROCEDURE LookupCustomerNoReportFieldsetSetup@1000000031();
    VAR
      Customer@1000000000 : Record 18;
      CustomerList@1000000001 : Page 22;
    BEGIN
      //### REPORT FIELDSET SETUP
      IF Rec.Type <> Rec.Type::ReportFieldsetSetup THEN
        EXIT;

      CLEAR(Customer);
      IF "Customer Company" <> '' THEN
        Customer.CHANGECOMPANY("Customer Company");

      CustomerList.LOOKUPMODE(TRUE);
      IF "Customer Company" <> '' THEN
        CustomerList.CMSetCompany("Customer Company");
      IF CustomerList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        CustomerList.GETRECORD(Customer);
        Rec.VALIDATE(Key3, Customer."No.");
      END;
    END;

    LOCAL PROCEDURE LookupYieldType@1000000009();
    VAR
      CMCodeData@1000000000 : Record 70006;
    BEGIN
      IF Type <> Type::YieldStudy THEN
        EXIT;

      CMCodeData.LookupCodeData(Rec.RECORDID.TABLENO, Rec.FIELDNO(Key3), Rec.Type, Rec.Key3);

      Rec.VALIDATE(Key3);
    END;

    LOCAL PROCEDURE ValidateCustomerNo@1000000001();
    VAR
      Customer@1000000000 : Record 18;
      CompName@1000000001 : Text[30];
    BEGIN
      //### CUSTOMER
      IF Rec.Type <> Rec.Type::Customer THEN
        EXIT;

      CLEAR(Customer);
      CompName := GetObjectCompanyName();
      IF CompName <> '' THEN
        Customer.CHANGECOMPANY(CompName);

      Customer.GET(Key3);
      "Customer Name" := Customer.Name;
      "Customer Company Chain" := Customer."Chain Name";

      Rec.Share := 1;
    END;

    LOCAL PROCEDURE ValidateProject@1000000003();
    VAR
      Asset@1000000000 : Record 70020;
      Project@1000000001 : Record 70020;
      AssetProject@1000000002 : Record 70021;
    BEGIN
      IF Rec.Type <> Rec.Type::Project THEN
        EXIT;

      Asset.GET(Asset.Objecttype::Asset, Rec.Key1);
      Project.GET(Project.Objecttype::Project, Rec.Key2);

      IF(Asset.Objecttype <> Asset.Objecttype::Asset) OR (Project.Objecttype <> Project.Objecttype::Project) THEN
        ERROR(Text008);

      AssetProject.RESET;
      AssetProject.SETCURRENTKEY(Objecttype,Type,Key2,Key1);
      AssetProject.SETRANGE(Objecttype, AssetProject.Objecttype::Asset);
      AssetProject.SETRANGE(Type, Rec.Type::Project);
      AssetProject.SETRANGE(Key2, Rec.Key2);
      AssetProject.SETFILTER(Key1, '<>%1', Rec.Key1);
      IF AssetProject.FINDFIRST() THEN
        ERROR(STRSUBSTNO(Text007, AssetProject.Key2, AssetProject.Key1));

      Project.MODIFY(FALSE);
    END;

    LOCAL PROCEDURE ValidateContract@1000000005();
    VAR
      Contract@1000000000 : Record 70050;
      Asset@1000000002 : Record 70020;
      CMContractMgmt@1000000001 : Codeunit 70021;
      FromRecRef@1000000003 : RecordRef;
      ToRecRef@1000000004 : RecordRef;
    BEGIN
      IF Type <> Type::Contract THEN
        EXIT;

      ValidateMainContract();

      Contract.GET(Key2);
      IF Contract.Template THEN
        ERROR(STRSUBSTNO(Text010, Key2));

      {Update Contract Start Date}
      UpdateContractStartDate();
      Rec.TESTFIELD("Contract Start Date");
      Rec.TESTFIELD(Key3);

      {Update Contract Data}
      UpdateContractData();

      {Copy Recurring ToDos}
      Asset.GET(Asset.Objecttype::Asset, Key1);
      FromRecRef.GETTABLE(Contract);
      ToRecRef.GETTABLE(Asset);
      CMContractMgmt.CopyRelatedToDos(FromRecRef,ToRecRef);

      CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::"Contract Assigned", (Rec.Key2 + ' '  + FORMAT(Rec."Contract Start Date")), STRSUBSTNO(Text012, Rec.Key2, Rec.Key1, FORMAT(Rec."Contract Start Date")));
    END;

    LOCAL PROCEDURE ValidateMainContract@1000000018();
    VAR
      CMAddData@1000000000 : Record 70021;
    BEGIN
      //Only one Main Contract
      IF Rec."Main Contract" THEN BEGIN
        CMAddData.SETRANGE(Objecttype, Rec.Objecttype);
        CMAddData.SETRANGE(Key1, Rec.Key1);
        CMAddData.SETFILTER(Key2, '<>%1', Rec.Key2);
        CMAddData.SETRANGE("Main Contract", TRUE);
        IF CMAddData.FINDFIRST() THEN
          ERROR(Text017);
      END;
    END;

    LOCAL PROCEDURE UpdateContractStartDate@1000000020();
    BEGIN
      IF Rec."Contract Start Date" <> 0D THEN BEGIN
        Rec.Key3 := DateToString(Rec."Contract Start Date");
        EXIT;
      END;

      IF Rec.Key3 <> '' THEN
        Rec."Contract Start Date" := StringToDate(Rec.Key3);
    END;

    LOCAL PROCEDURE UpdateContractData@1000000021();
    VAR
      CmmsContract@1000000000 : Record 70050;
    BEGIN
      IF NOT CmmsContract.GET(Rec.Key2) THEN CmmsContract.INIT();

      IF Rec."Currency Code" = '' THEN
        Rec.VALIDATE("Currency Code", CmmsContract."Currency Code");
      IF Rec."Accounting Entity" = '' THEN
        Rec.VALIDATE("Accounting Entity", CmmsContract."Accounting Entity");
    END;

    LOCAL PROCEDURE ValidateYieldType@1000000008();
    VAR
      CMCodeData@1000000000 : Record 70006;
      CMGenSetup@1000000001 : Record 70000;
      ENCGenMgt@1000000002 : Codeunit 50003;
    BEGIN
      IF Type <> Type::YieldStudy THEN
        EXIT;

      CMCodeData.ValidateCodeData(Rec.RECORDID.TABLENO, Rec.FIELDNO(Key3), Rec.Type, Rec.Key3);

      CMGenSetup.GET();
      CMGenSetup.TESTFIELD("Yield Type 1 (Starts with)");
      CMGenSetup.TESTFIELD("Yield Type 2 (Starts with)");

      IF ENCGenMgt.TextStartsWith(Rec.Key3, CMGenSetup."Yield Type 1 (Starts with)") THEN
        Rec."Unit of Measure" := CMGenSetup."Yield Unit 1";

      IF ENCGenMgt.TextStartsWith(Rec.Key3, CMGenSetup."Yield Type 2 (Starts with)") THEN
        Rec."Unit of Measure" := CMGenSetup."Yield Unit 2";
    END;

    LOCAL PROCEDURE ValidateValidYield@1000000007();
    VAR
      Rec2@1000000000 : Record 70021;
    BEGIN
      IF Type <> Type::YieldStudy THEN
        EXIT;

      IF NOT Rec."Valid Source" THEN
        EXIT;

      Rec2.SETRANGE(Objecttype, Rec.Objecttype);
      Rec2.SETRANGE(Type, Rec.Type);
      Rec2.SETRANGE(Key1, Rec.Key1);
      Rec2.SETFILTER(Key2, '<>%1', Rec.Key2); //Source
      Rec2.SETRANGE(Key3, Rec.Key3);
      Rec2.SETRANGE("Valid Source", TRUE);
      IF Rec2.FINDFIRST() THEN
        ERROR(Text011);
    END;

    LOCAL PROCEDURE ValidateActivityCode@1000000012();
    VAR
      Rec2@1000000000 : Record 70021;
      LText001@1000000001 : TextConst 'ENU=Durch diese Žnderung werden verbundene Zeilen gel”scht und neu Zeilen erstellt! Wollen Sie fortfahren?';
      Rec3@1000000005 : Record 70021;
      ActivityStep@1000000002 : Record 5082;
      NextLineNo@1000000003 : Integer;
      LineSpacing@1000000004 : Integer;
      LText002@1000000006 : TextConst 'ENU=There is not enough space to insert all activity lines.;DEA=Es gibt nicht gengend Platz, um alle Aufgabenzeilen einzufgen.';
      TempRec@1000000007 : TEMPORARY Record 70021;
    BEGIN
      IF Type <> Type::RecurringToDo THEN
        EXIT;

      IF ("Activity Code" = xRec."Activity Code") OR (Rec."Activity Code" = '') THEN
        EXIT;

      IF NOT MODIFY THEN INSERT;

      NextLineNo := Rec."Line No.";

      IF ("Activity Code" <> xRec."Activity Code") AND
        (xRec."Activity Code" <> '') THEN BEGIN
        Rec2.SETRANGE(Objecttype, Rec.Objecttype);
        Rec2.SETRANGE(Type, Rec.Type);
        Rec2.SETRANGE(Key1, Rec.Key1);
        Rec2.SETRANGE(Key2, Rec.Key2);
        Rec2.SETRANGE(Key3, Rec.Key3);
        Rec2.SETFILTER("Line No.", '<>%1', Rec."Line No.");
        Rec2.SETRANGE("Activity Code", xRec."Activity Code");
        IF Rec2.FINDFIRST() THEN
          IF CONFIRM(LText001,TRUE) THEN BEGIN
            {Delete Related Activities}
            Rec2.DELETEALL(TRUE);
          END ELSE BEGIN
            ERROR(error004);
          END;
      END;

      {Create New Activities}
      ActivityStep.SETRANGE("Activity Code", Rec."Activity Code");
      Rec3.SETRANGE(Objecttype, Rec.Objecttype);
      Rec3.SETRANGE(Type, Rec.Type);
      Rec3.SETRANGE(Key1, Rec.Key1);
      Rec3.SETRANGE(Key2, Rec.Key2);
      Rec3.SETRANGE(Key3, Rec.Key3);

      Rec3 := Rec;
      TempRec := Rec;

      IF Rec3.FIND('>') THEN BEGIN
        LineSpacing :=
          (Rec3."Line No." - Rec."Line No.") DIV
          (ActivityStep.COUNT);
        IF LineSpacing = 0 THEN
          ERROR(LText002);
      END ELSE
        LineSpacing := 10000;

      ActivityStep.SETRANGE("Activity Code", Rec."Activity Code");
      ActivityStep.SETFILTER("CM Subtype", '%1|%2', ActivityStep."CM Subtype"::" ", ActivityStep."CM Subtype"::Checklist);
      ActivityStep.SETCURRENTKEY("Activity Code","CM Subtype");
      IF ActivityStep.FIND('-') THEN BEGIN
        Rec.DELETE;
        REPEAT
          Rec2.INIT;
          Rec2 := TempRec;
          Rec2."Line No." := NextLineNo;
          Rec2."Step No." := ActivityStep."Step No.";
          Rec2.Description := ActivityStep.Description;
          Rec2.Priority := ActivityStep.Priority;
          Rec2."Interaction Group Code" := ActivityStep."CM Interaction Group Code";
          Rec2."Interaction Template Code" := ActivityStep."CM Interaction Template Code";
          Rec2."Activity Code" := ActivityStep."Activity Code";
          Rec2."Maintask Step No." := ActivityStep."CM Maintask Step No.";
          Rec2.Subtype := ActivityStep."CM Subtype";
          Rec2."Maintask Line No." := 0;

          //We need to find parent lineno when we have a subtype
          IF Rec2.Subtype = Rec2.Subtype::Checklist THEN BEGIN
            Rec3.SETRANGE(Objecttype, Rec2.Objecttype);
            Rec3.SETRANGE(Type, Rec2.Type);
            Rec3.SETRANGE(Key1, Rec2.Key1);
            Rec3.SETRANGE(Key2, Rec2.Key2);
            Rec3.SETRANGE(Key3, Rec2.Key3);
            Rec3.SETRANGE("Step No.", Rec2."Maintask Step No.");
            Rec3.SETRANGE(Subtype, Rec3.Subtype::" ");
            IF Rec3.FINDFIRST() THEN
              Rec2."Maintask Line No." := Rec3."Line No.";
          END;
          Rec2.INSERT;
          NextLineNo += LineSpacing;
        UNTIL ActivityStep.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ValidateToDo@1000000010();
    VAR
      LText001@1000000001 : TextConst 'ENU=Durch diese Žnderung werden verbundene Zeilen gel”scht und neu Zeilen erstellt! Wollen Sie fortfahren?';
      LText002@1000000006 : TextConst 'ENU=There is not enough space to insert all activity lines.;DEA=Es gibt nicht gengend Platz, um alle Aufgabenzeilen einzufgen.';
      CMObject@1000000000 : Record 70020;
    BEGIN
      IF Type <> Type::RecurringToDo THEN
        EXIT;

      "Source Type" := "Source Type"::User;
      "Creation Date" := TODAY;
      "Created by" := USERID;
    END;

    LOCAL PROCEDURE ValidateBusinessRelation@1000000013();
    VAR
      LText001@1000000001 : TextConst 'ENU=Durch diese Žnderung werden verbundene Zeilen gel”scht und neu Zeilen erstellt! Wollen Sie fortfahren?';
      LText002@1000000006 : TextConst 'ENU=There is not enough space to insert all activity lines.;DEA=Es gibt nicht gengend Platz, um alle Aufgabenzeilen einzufgen.';
      BusinessRelation@1000000000 : Record 5053;
      CMObject@1000000002 : Record 70020;
    BEGIN
      IF Type <> Type::Relation THEN
        EXIT;

      IF "Business Relation Code" <> xRec."Business Relation Code" THEN
        IF "Business Relation Code" = '' THEN
          "Business Relation Description" := ''
        ELSE
          IF BusinessRelation.GET("Business Relation Code") THEN
            "Business Relation Description" := BusinessRelation.Description;
    END;

    LOCAL PROCEDURE ValidateBusinessGroup@1000000016();
    VAR
      LText001@1000000001 : TextConst 'ENU=Durch diese Žnderung werden verbundene Zeilen gel”scht und neu Zeilen erstellt! Wollen Sie fortfahren?';
      LText002@1000000006 : TextConst 'ENU=There is not enough space to insert all activity lines.;DEA=Es gibt nicht gengend Platz, um alle Aufgabenzeilen einzufgen.';
      CMMSCodeDate@1000000000 : Record 70006;
    BEGIN
      IF Type <> Type::Relation THEN
        EXIT;

      IF "Relation Group Code" <> xRec."Relation Group Code" THEN BEGIN
        IF CMMSCodeDate.GET(Rec.RECORDID.TABLENO, FIELDNO("Relation Group Code"), 0, Rec."Relation Group Code") THEN
          Rec."Relation Group Description" := CMMSCodeDate.Description;
      END;
    END;

    LOCAL PROCEDURE ValidateUserSubstitution@1000000017();
    BEGIN
      IF Type <> Type::Substitue THEN
        EXIT;

      IF Key1 = Key2 THEN
        ERROR(Text014);

      IF ("From Date" < "To Date") THEN
        ERROR(Text015);
    END;

    LOCAL PROCEDURE ValidateNotificationCopy@1000000030();
    BEGIN
      IF Type <> Type::NotificationCopy THEN
        EXIT;

      IF Key1 = Key2 THEN
        ERROR(Text022);

      IF ("From Date" < "To Date") THEN
        ERROR(Text015);
    END;

    LOCAL PROCEDURE ValidateFieldsetRow@1000000027();
    VAR
      Rec2@1000000000 : Record 70021;
    BEGIN
      IF (Type <> Type::FieldsetRow) OR ("Line No." > 0) THEN
        EXIT;

      Rec."Line No." := 10000;

      Rec2.RESET;
      Rec2.SETRANGE(Objecttype, Rec.Objecttype::Asset);
      Rec2.SETRANGE(Type, Rec.Type::FieldsetRow);
      Rec2.SETRANGE(Key1, Rec.Key1);
      IF Rec2.FINDLAST() THEN
        Rec."Line No." := Rec2."Line No." + 10000;
    END;

    LOCAL PROCEDURE ValidateReportFieldsetSetup@1000000029();
    BEGIN
      IF Type <> Type::ReportFieldsetSetup THEN
        EXIT;

      IF (("Asset No._" <> '') AND ("Portfolio / Cluster" <> '')) THEN
        ERROR(Text020, FIELDCAPTION("Asset No._"), FIELDCAPTION("Portfolio / Cluster"));

      IF (Key2 = '') AND (Key3 = '') THEN
        ERROR(Text021);
    END;

    LOCAL PROCEDURE DeleteToDo@1000000014();
    VAR
      Rec2@1000000000 : Record 70021;
      LText001@1000000001 : TextConst 'ENU=Durch diese Žnderung werden verbundene Zeilen gel”scht und neu Zeilen erstellt! Wollen Sie fortfahren?';
      Rec3@1000000005 : Record 70021;
      ActivityStep@1000000002 : Record 5082;
      NextLineNo@1000000003 : Integer;
      LineSpacing@1000000004 : Integer;
      LText002@1000000006 : TextConst 'ENU=There is not enough space to insert all activity lines.;DEA=Es gibt nicht gengend Platz, um alle Aufgabenzeilen einzufgen.';
      TempRec@1000000007 : TEMPORARY Record 70021;
    BEGIN
      IF Type <> Type::RecurringToDo THEN
        EXIT;
    END;

    LOCAL PROCEDURE DeleteRecurChecklist@1000000011();
    VAR
      Rec2@1000000000 : Record 70021;
    BEGIN
      IF Type <> Type::RecurringToDo THEN
        EXIT;

      Rec2.RESET;
      Rec2.SETRANGE(Objecttype, Rec.Objecttype);
      Rec2.SETRANGE(Type, Rec.Type);
      Rec2.SETRANGE(Key1, Rec.Key1);
      Rec2.SETRANGE(Key2, Rec.Key2);
      Rec2.SETRANGE(Key3, Rec.Key3);
      Rec2.SETRANGE("Maintask Step No.", Rec."Step No.");
      Rec2.SETRANGE(Subtype, Rec.Subtype::Checklist);
      Rec2.DELETEALL(FALSE);
    END;

    LOCAL PROCEDURE DeleteFieldsetRows@1000000024();
    VAR
      Rec2@1000000000 : Record 70021;
    BEGIN
      IF Type <> Type::Fieldset THEN
        EXIT;

      Rec2.RESET;
      Rec2.SETRANGE(Objecttype, Rec.Objecttype::Asset);
      Rec2.SETRANGE(Type, Rec.Type::FieldsetRow);
      Rec2.SETRANGE(Key1, Rec.Key1);
      Rec2.DELETEALL(FALSE);
    END;

    LOCAL PROCEDURE RenameFieldsetRows@1000000026();
    VAR
      Rec2@1000000000 : Record 70021;
    BEGIN
      IF (Type <> Type::Fieldset) OR (xRec.Key1 = Rec.Key1) THEN
        EXIT;

      Rec2.RESET;
      Rec2.SETRANGE(Objecttype, Rec.Objecttype::Asset);
      Rec2.SETRANGE(Type, Rec.Type::FieldsetRow);
      Rec2.SETRANGE(Key1, xRec.Key1);
      WHILE(Rec2.FINDFIRST()) DO
        Rec2.RENAME(Rec2.Objecttype, Rec2.Type, Rec.Key1, Rec2.Key2, Rec2.Key3, Rec2."Line No.");
    END;

    LOCAL PROCEDURE UpdateYieldSum@1000000015();
    BEGIN
      IF Type <> Type::YieldStudy THEN
        EXIT;

      "Yield Total" :=
      (
        January +
        February +
        March +
        April +
        May +
        June +
        July +
        August +
        September +
        October +
        November +
        December
      );
    END;

    LOCAL PROCEDURE CheckAssetInactive@1000000028();
    VAR
      CMObject@1000000000 : Record 70020;
    BEGIN
      IF CMObject.GET(Rec.Objecttype, Rec.Key1) THEN BEGIN
        IF CMObject."Operational Status" = CMObject."Operational Status"::Inactive THEN
          ERROR(STRSUBSTNO(Text016, CMObject.Objecttype, CMObject."No."));
      END;
    END;

    PROCEDURE StringToDate@1000000019(value@1000000000 : Text) : Date;
    VAR
      DotNetDateTime@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
      DotNetCultureInfo@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Globalization.CultureInfo" SUPPRESSDISPOSE;
      LocDateTime@1000000003 : DateTime;
    BEGIN
      IF value = '' THEN
        EXIT(0D);

      DotNetDateTime := 0DT;
      LocDateTime := DotNetDateTime.ParseExact(value, 'yyyy-MM-dd', DotNetCultureInfo.InvariantCulture);
      EXIT(DT2DATE(LocDateTime));
    END;

    PROCEDURE DateToString@1000000022(value@1000000002 : Date) : Text;
    VAR
      DotNetDateTime@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
    BEGIN
      IF value = 0D THEN
        EXIT('');

      DotNetDateTime := DotNetDateTime.DateTime(DATE2DMY(value, 3), DATE2DMY(value, 2), DATE2DMY(value, 1));
      EXIT(DotNetDateTime.ToString('yyyy-MM-dd'));
    END;

    PROCEDURE GetCaptionTableId@1000000023() : Integer;
    BEGIN
      CASE Rec."Caption Table" OF
        Rec."Caption Table"::Asset     : EXIT(DATABASE::"CMMS Object");
        Rec."Caption Table"::Workorder : EXIT(DATABASE::Opportunity);
        Rec."Caption Table"::Task      : EXIT(DATABASE::"To-do");
      END;
      EXIT(0);
    END;

    PROCEDURE GetValueTableId@1000000025() : Integer;
    BEGIN
      CASE Rec."Value Table" OF
        Rec."Value Table"::Asset     : EXIT(DATABASE::"CMMS Object");
        Rec."Value Table"::Workorder : EXIT(DATABASE::Opportunity);
        Rec."Value Table"::Task      : EXIT(DATABASE::"To-do");
      END;
      EXIT(0);
    END;

    PROCEDURE GetObjectCompanyName@1000000032() : Text[30];
    VAR
      CMObject@1000000000 : Record 70020;
    BEGIN
      IF Rec.Type <> Rec.Type::Customer THEN
        EXIT('');

      IF NOT CMObject.GET(Rec.Objecttype, Rec.Key1) THEN
        EXIT('');

      IF CMObject.Objecttype = CMObject.Objecttype::Project THEN
        EXIT(CMObject."Project Company Name");

      CMObject.CALCFIELDS("Company Name");
      EXIT(CMObject."Company Name");
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70022 CMMS Asset Customer
{
  OBJECT-PROPERTIES
  {
    Date=15.09.16;
    Time=11:09:46;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnInsert=VAR
               Customer@1000000000 : Record 18;
             BEGIN
             END;

    OnRename=VAR
               Customer@1000000000 : Record 18;
             BEGIN
             END;

    CaptionML=[ENU=Anlage Debitor;
               DEA=Asset Customer];
  }
  FIELDS
  {
    { 100 ;   ;Asset No.           ;Code30        ;TableRelation="CMMS Object".No.;
                                                   CaptionML=[ENU=Asset No.;
                                                              DEA=Anlage Nr.];
                                                   NotBlank=Yes }
    { 200 ;   ;Customer No.        ;Code20        ;OnValidate=VAR
                                                                Customer@1000000000 : Record 18;
                                                              BEGIN
                                                                CALCFIELDS("Asset Company Name");
                                                                CLEAR(Customer);
                                                                IF "Asset Company Name" <> '' THEN
                                                                  Customer.CHANGECOMPANY("Asset Company Name");

                                                                Customer.GET("Customer No.");
                                                                "Customer Name" := Customer.Name;
                                                              END;

                                                   OnLookup=VAR
                                                              CustomerList@1000000000 : Page 22;
                                                              Customer@1000000001 : Record 18;
                                                            BEGIN
                                                              CALCFIELDS("Asset Company Name");
                                                              CLEAR(Customer);
                                                              IF "Asset Company Name" <> '' THEN
                                                                Customer.CHANGECOMPANY("Asset Company Name");

                                                              CustomerList.LOOKUPMODE := TRUE;
                                                              IF "Asset Company Name" <> '' THEN
                                                                CustomerList.CMSetCompany("Asset Company Name");
                                                              IF CustomerList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                CustomerList.GETRECORD(Customer);
                                                                Rec."Customer No." := Customer."No.";
                                                                Rec."Customer Name" := Customer.Name;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Customer No.;
                                                              DEA=Debitornr.];
                                                   NotBlank=Yes }
    { 210 ;   ;Customer Name       ;Text50        ;OnValidate=VAR
                                                                Customer@1000000000 : Record 18;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Customer Name;
                                                              DEA=Debitorname];
                                                   Editable=No }
    { 220 ;   ;Asset Company Name  ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object"."Company Name" WHERE (No.=FIELD(Asset No.)));
                                                   CaptionML=[ENU=Asset Companyname;
                                                              DEA=Anlage Firmenname];
                                                   Description=FF;
                                                   Editable=No }
    { 230 ;   ;Contact Person No.  ;Code20        ;TableRelation=Contact.No. WHERE (Type=CONST(Person));
                                                   CaptionML=[ENU=Contact Person No.;
                                                              DEA=Kontaktperson Nr.] }
    { 300 ;   ;Share               ;Integer       ;CaptionML=[ENU=Share;
                                                              DEA=Anteil];
                                                   MinValue=0 }
  }
  KEYS
  {
    {    ;Asset No.,Customer No.                  ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70025 CMMS Asset Component
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=11:53:42;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=Component Type,Description;
    OnInsert=BEGIN
               CheckAssetInactive();
               "Component Type Integer" := "Component Type";
             END;

    OnModify=BEGIN
               CheckAssetInactive();
             END;

    OnDelete=BEGIN
               CheckAssetInactive();
             END;

    OnRename=BEGIN
               CheckAssetInactive();
             END;

  }
  FIELDS
  {
    { 10  ;   ;Objecttype          ;Option        ;CaptionML=[ENU=Objecttype;
                                                              DEA=Objekttyp];
                                                   OptionString=Asset }
    { 20  ;   ;Type                ;Option        ;CaptionML=ENU=Type;
                                                   OptionString=Equipment,Spare Part }
    { 30  ;   ;Component Type      ;Option        ;OnValidate=BEGIN
                                                                "Component Type Integer" := "Component Type";
                                                              END;

                                                   CaptionML=ENU=Component Type;
                                                   OptionString=Modules,Inverter,Combiner Box,Sensor,Monitoring Hardware,Internet Connection HW,Security System,Meters,Transformer,Switchgear,Cables,Remote Access Details,,,,,,,Others }
    { 40  ;   ;Key1                ;Code20        ;CaptionML=ENU=Key1 }
    { 50  ;   ;Entry No.           ;Integer       ;CaptionML=ENU=Entry No. }
    { 60  ;   ;Line Type           ;Option        ;CaptionML=[ENU=Line Type;
                                                              DEA=Zeilenart];
                                                   OptionCaptionML=[ENU=Header,Line;
                                                                    DEA=Kopf,Zeile];
                                                   OptionString=Header,Line }
    { 200 ;   ;Replaced with Entry No.;Integer    ;CaptionML=[ENU=Replaced with Entry No.;
                                                              DEA=Ausgetauscht durch Eintragnr.] }
    { 900 ;   ;Asset Tag           ;Text50        ;CaptionML=ENU=Asset Tag }
    { 1000;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=Item No.;
                                                              DEA=Artikelnr.] }
    { 1100;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 1110;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              DEA=Beschreibung 2] }
    { 1201;   ;Manufacturer        ;Code50        ;TableRelation="CMMS Additional Data".Key2 WHERE (Type=CONST(Manufacturer),
                                                                                                    Line No.=FIELD(Component Type Integer),
                                                                                                    Component Type=FIELD(Component Type));
                                                   CaptionML=ENU=Manufacturer, Brand, Make }
    { 1211;   ;Model               ;Code50        ;TableRelation="CMMS Additional Data".Key3 WHERE (Type=CONST(Model),
                                                                                                    Key2=FIELD(Manufacturer),
                                                                                                    Line No.=FIELD(Component Type Integer));
                                                   CaptionML=ENU=Model, Type }
    { 1220;   ;Warranty End Date   ;Date          ;CaptionML=ENU=Warranty End Date }
    { 1230;   ;Serial Number       ;Text50        ;CaptionML=ENU=Serial Number }
    { 1500;   ;Location on Site    ;Text50        ;CaptionML=ENU=Location on Site }
    { 1600;   ;Quantity            ;Decimal       ;CaptionML=ENU=Quantity;
                                                   BlankZero=Yes }
    { 1700;   ;IP-Address          ;Text80        ;CaptionML=ENU=IP-Address }
    { 1710;   ;Type of Equipment   ;Code10        ;OnValidate=BEGIN
                                                                CMCodeData.ValidateCodeData(Rec.RECORDID.TABLENO,FIELDNO("Type of Equipment"),Objecttype,"Type of Equipment");
                                                              END;

                                                   OnLookup=BEGIN
                                                              CMCodeData.LookupCodeData(Rec.RECORDID.TABLENO,FIELDNO("Type of Equipment"),Objecttype,"Type of Equipment");
                                                            END;

                                                   CaptionML=ENU=Type of Equipment }
    { 1720;   ;Type of Equipment (Details);Text80  }
    { 1900;   ;Data Source ID      ;Text50        ;CaptionML=[ENU=Data Source ID;
                                                              DEA=Datenherkunfts-ID] }
    { 2000;   ;MODULES             ;Boolean        }
    { 2010;   ;Nominal DC Capacity ;Decimal       ;CaptionML=ENU=Nominal DC Capacity [kWp];
                                                   BlankZero=Yes }
    { 2020;   ;Azimut              ;Decimal       ;CaptionML=[ENU=Azimut;
                                                              DEA=Azimut] }
    { 2030;   ;Tilt                ;Decimal       ;CaptionML=[ENU=Tilt;
                                                              DEA=Tilt] }
    { 3000;   ;INVERTER            ;Boolean        }
    { 3010;   ;AC Capacity         ;Decimal       ;CaptionML=ENU=AC Capacity [kW];
                                                   BlankZero=Yes }
    { 4000;   ;COMBINER BOX        ;Boolean        }
    { 5000;   ;SENSOR              ;Boolean        }
    { 6000;   ;MONITORING HARDWARE ;Boolean        }
    { 7000;   ;INTERNET CONNECTION HW;Boolean      }
    { 8000;   ;SECURITY SYSTEM     ;Boolean        }
    { 9000;   ;METERS              ;Boolean        }
    { 10000;  ;TRANSFORMERS        ;Boolean        }
    { 11000;  ;SWITCHGEAR          ;Boolean        }
    { 12000;  ;CABLES              ;Boolean        }
    { 13000;  ;REMOTE ACCESS DETAILS;Boolean       }
    { 13010;  ;IP Address Local    ;Text80        ;CaptionML=ENU=IP Address Local }
    { 13020;  ;IP Address Remote/VPN;Text80       ;CaptionML=ENU=IP Address Remote/VPN }
    { 13030;  ;Username            ;Text50        ;CaptionML=ENU=Username }
    { 13040;  ;Password            ;Text50        ;CaptionML=ENU=Password }
    { 20000;  ;OTHERS              ;Boolean        }
    { 20010;  ;Detail 1            ;Text50        ;CaptionML=[ENU=Detail 1;
                                                              DEA=Detail 1] }
    { 20020;  ;Detail 2            ;Text50        ;CaptionML=[ENU=Detail 2;
                                                              DEA=Detail 2] }
    { 20030;  ;Detail 3            ;Text50        ;CaptionML=[ENU=Detail 3;
                                                              DEA=Detail 3] }
    { 50000;  ;Component Type Integer;Integer      }
  }
  KEYS
  {
    {    ;Objecttype,Type,Component Type,Key1,Entry No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;Serial Number,Description,Quantity,Description 2,Asset Tag }
  }
  CODE
  {
    VAR
      CMCodeData@1000000000 : Record 70006;
      Text001@1000000002 : TextConst 'ENU=The associated %1 %2 is inactive!;DEA=Das zugeh”rige Asset %1 %2 ist inaktiv!';

    LOCAL PROCEDURE CheckAssetInactive@1000000028();
    VAR
      CMObject@1000000000 : Record 70020;
    BEGIN
      IF CMObject.GET(Rec.Objecttype, Rec.Key1) THEN BEGIN
        IF CMObject."Operational Status" = CMObject."Operational Status"::Inactive THEN
          ERROR(STRSUBSTNO(Text001, CMObject.Objecttype, CMObject."No."));
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70050 CMMS Contract
{
  OBJECT-PROPERTIES
  {
    Date=15.05.18;
    Time=14:23:24;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               CMGenMgt.GetContractNo(Rec);
               CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::Created, Rec."No.", STRSUBSTNO(Text002, Rec."No."));
             END;

    CaptionML=ENU=CMMS Contract;
    LookupPageID=Page70024;
  }
  FIELDS
  {
    { 10  ;   ;No.                 ;Code20        ;CaptionML=[ENU=No.;
                                                              DEA=Nr.] }
    { 20  ;   ;Name                ;Text80        ;CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 30  ;   ;Template            ;Boolean       ;OnValidate=VAR
                                                                AssetContract@1000000000 : Record 70021;
                                                              BEGIN
                                                                CMGenMgt.ValidateTemplate(Rec);
                                                              END;
                                                               }
    { 40  ;   ;No. of linked Assets;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Objecttype=CONST(Asset),
                                                                                                   Type=CONST(Contract),
                                                                                                   Key2=FIELD(No.)));
                                                   CaptionML=ENU=No. of linked Assets;
                                                   Description=FF;
                                                   Editable=No }
    { 100 ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::"Status Change", FORMAT(Rec.Status), STRSUBSTNO(Text003, xRec.Status, Rec.Status));
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionString=New,Released,Inactive }
    { 110 ;   ;Comment             ;Text250       ;Description=#delete }
    { 210 ;   ;Type of Service     ;Option        ;OnValidate=BEGIN
                                                                CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::Modified, FIELDCAPTION("Type of Service"), STRSUBSTNO(Text003, xRec."Type of Service", Rec."Type of Service"));
                                                              END;

                                                   CaptionML=[ENU=Type of Service;
                                                              DEA=Serviceart];
                                                   OptionCaptionML=[ENU=" ,Full O&M,TAM,Monitoring,Portal Only,Individual,Support";
                                                                    DEA=" ,Full O&M,TAM,Monitoring,Portal Only,Individual,Support"];
                                                   OptionString=[ ,Full O&M,TAM,Monitoring,Portal Only,Individual,Support] }
    { 220 ;   ;Start Date          ;Date          ;OnValidate=BEGIN
                                                                IF (Rec."Start Date" <> 0D) AND
                                                                   (Rec."End Date" <> 0D) AND
                                                                   (Rec."Start Date" >= "End Date") THEN
                                                                  ERROR(Text004, Rec.FIELDCAPTION("Start Date"), Rec.FIELDCAPTION("End Date"));
                                                              END;

                                                   Description=Forecast }
    { 230 ;   ;End Date            ;Date          ;OnValidate=BEGIN
                                                                IF (Rec."Start Date" <> 0D) AND
                                                                   (Rec."End Date" <> 0D) AND
                                                                   (Rec."Start Date" >= "End Date") THEN
                                                                  ERROR(Text004, Rec.FIELDCAPTION("Start Date"), Rec.FIELDCAPTION("End Date"));
                                                              END;

                                                   Description=Forecast }
    { 240 ;   ;Contract Manager    ;Code50        ;TableRelation="User Setup"."User ID" }
    { 300 ;   ;Energy Monitor Access;Boolean       }
    { 305 ;   ;Energy Monitor Accounts;Text150    ;Description=#delete }
    { 310 ;   ;PVPlus Integration  ;Boolean       ;Description=#delete }
    { 325 ;   ;Accounting Entity   ;Text30        ;TableRelation=Company }
    { 400 ;   ;Responsible Sales User;Code50      ;TableRelation="User Setup"."User ID" }
    { 500 ;   ;Service Included    ;Text250       ;Description=#delete;
                                                   Editable=No }
    { 510 ;   ;Practical Customer Agreements;Text250;
                                                   Description=NEW2;
                                                   Editable=No }
    { 600 ;   ;Min. Reaction Time  ;Decimal       ;CaptionML=ENU=Min. Reaction Time [h] }
    { 601 ;   ;Reaction Time Details;Text250      ;Description=NEW2 }
    { 610 ;   ;Weekend Reaction    ;Boolean        }
    { 700 ;   ;Reporting Interval  ;Option        ;OptionString=[ ,Single Weekly,Single monthly,Single quarterly,Single Yearly,Portfolio Weekly,Portfolio Monthly,Portfolio Quarterly,Portfolio Yearly] }
    { 710 ;   ;Reporting Requirements;Text160     ;Description=#delete }
    { 720 ;   ;Reporting Format    ;Code20        ;TableRelation="CMMS Code Data".Code WHERE (TableID=CONST(70050),
                                                                                              FieldID=CONST(720),
                                                                                              Type=CONST(0)) }
    { 800 ;   ;Additional Services ;Text250       ;Description=#delete;
                                                   Editable=No }
    { 900 ;   ;Penalty Payments    ;Boolean        }
    { 910 ;   ;Penalty Payment Details;Text250    ;Description=#delete }
    { 920 ;   ;Penalty Risk Class  ;Code20        ;TableRelation="CMMS Code Data".Code WHERE (TableID=CONST(70050),
                                                                                              FieldID=CONST(920),
                                                                                              Type=CONST(0));
                                                   Description=NEW }
    { 1000;   ;Bonusagreement      ;Boolean        }
    { 1010;   ;Bonus Terms         ;Text250       ;Description=#delete }
    { 1020;   ;Extension Type      ;Code20        ;TableRelation="CMMS Code Data".Code WHERE (TableID=CONST(70050),
                                                                                              FieldID=CONST(1020),
                                                                                              Type=CONST(0));
                                                   Description=NEW }
    { 1100;   ;Invoice Receiver    ;Option        ;OptionString=[ ,SPV,Company Chain,Other];
                                                   Description=#delete }
    { 1200;   ;Currency Code       ;Code10        ;TableRelation=Currency.Code }
    { 1300;   ;Annual Fee          ;Decimal       ;OnValidate=BEGIN
                                                                CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::Modified, FIELDCAPTION(Rec."Annual Fee"), STRSUBSTNO(Text003, xRec."Annual Fee", Rec."Annual Fee"));
                                                              END;

                                                   Description=#delete }
    { 1310;   ;Annual Fee incl. Adaption;Decimal  ;OnValidate=BEGIN
                                                                CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::Modified, FIELDCAPTION(Rec."Annual Fee incl. Adaption"), STRSUBSTNO(Text003, xRec."Annual Fee incl. Adaption", Rec."Annual Fee incl. Adaption"));
                                                              END;

                                                   Description=#delete }
    { 1400;   ;Payment Terms Code  ;Code20        ;TableRelation="Payment Terms".Code }
    { 1410;   ;Other Info          ;Text250       ;Description=#delete }
    { 1420;   ;Cancellation External (Months);Integer }
    { 1430;   ;Indexation          ;Boolean        }
    { 1431;   ;Indexation Details  ;Text250       ;Description=#delete }
    { 1432;   ;Indexation Rate     ;Decimal        }
    { 1440;   ;Indexation Start Date;Date          }
    { 1450;   ;Indexation Cycle    ;Option        ;OptionString=[ ,Yearly,Other] }
    { 1500;   ;Extension Options   ;Text250       ;Description=NEW2;
                                                   Editable=No }
    { 2000;   ;Invoicing Period    ;Option        ;CaptionML=[ENU=Invoicing Period;
                                                              DEA=Verrechnungsperiode];
                                                   OptionString=Month,Quarter,Half Year,Year;
                                                   Description=Forecast }
    { 2010;   ;Invoicing Type      ;Option        ;CaptionML=[ENU=Invoicing Type;
                                                              DEA=Verrechnungsart];
                                                   OptionString=Pre,Post;
                                                   Description=Forecast }
    { 10000;  ;Import Site Nos.    ;BLOB           }
    { 20620;  ;Activities          ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (CM Is CMMS Log Entry=CONST(Yes),
                                                                                                    CM Source No.=FIELD(No.)));
                                                   CaptionML=[ENU=Activities;
                                                              DEA=Aktivit„ten];
                                                   Description=FF;
                                                   Editable=No }
    { 20660;  ;Relations           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Relation),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Relations;
                                                              DEA=Verbindungen];
                                                   Description=FF;
                                                   Editable=No }
    { 20670;  ;Contract Entities   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Objecttype=CONST(Asset),
                                                                                                   Type=CONST(Contract),
                                                                                                   Key2=FIELD(No.)));
                                                   CaptionML=ENU=Contract Entities;
                                                   Description=FF;
                                                   Editable=No }
    { 70000;  ;CM Is Temporary     ;Boolean       ;CaptionML=[ENU=Is Temporary;
                                                              DEA=Ist Tempor„r] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Template                                 }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name                                 }
  }
  CODE
  {
    VAR
      CMGenMgt@1000000000 : Codeunit 70000;
      Text001@1000000001 : TextConst 'ENU=This Contract is linked to an Asset an can therefore no be set as Template!;DEA=Dieser Vertrag ist einer Anlage zugewiesen und kann nicht als Vorlage definiert werden!';
      LogEntry@1000000002 : Record 5065;
      Text002@1000000003 : TextConst 'ENU=Contract "%1" created.';
      Text003@1000000004 : TextConst 'ENU=From "%1" to "%2"';
      Text004@1000000005 : TextConst 'ENU=" ""%1"" has to be before ""%2"".";DEA=" ""%1"" muss vor ""%2"" liegen."';

    BEGIN
    END.
  }
}

OBJECT Report 70000 CMMS Create Recuring Tasks
{
  OBJECT-PROPERTIES
  {
    Date=22.03.17;
    Time=11:54:34;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=CMMS - Create Recuring Tasks;
               DEA=CMMS - Erstelle wiederkehrende Aufgaben];
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   MESSAGE
                   (
                     FORMAT(c1) + ' Workorder(s) created.\' +
                     FORMAT(c2) + ' Task(s) created.\' +
                     FORMAT(c3) + ' Task(s) automatically closed.\'
                   );
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;RecuringTask      ;
               DataItemTable=Table70021;
               OnPreDataItem=BEGIN
                               IF NOT CMGenSetup.GET() THEN
                                 CMGenSetup.INIT;

                               c1 := 0;
                               c2 := 0;
                               c3 := 0;

                               RecuringTask.RESET;
                               RecuringTask.SETCURRENTKEY(Objecttype,Type,Key1,Inactive,"Start Date","Due Date","Interaction Group Code");
                               RecuringTask.SETRANGE(Objecttype, RecuringTask.Objecttype::Asset);
                               RecuringTask.SETRANGE(Type, RecuringTask.Type::RecurringToDo);
                               RecuringTask.SETRANGE(Subtype, RecuringTask.Subtype::" ");
                               RecuringTask.SETFILTER(Key1, '<>%1', '');
                               RecuringTask.SETRANGE(Inactive, FALSE);
                               RecuringTask.SETFILTER("Start Date", '<=%1', WORKDATE);

                               LastDueDate := 0D;
                               LastStartDate := 0D;
                               LastInteractionGroupCode := '';
                               counter1 := 1;

                               TempTask.RESET;
                               TempTask.DELETEALL;
                               TempWo.RESET;
                               TempWo.DELETEALL;

                               Workorder.SETCURRENTKEY("CM Is Workorder","CM Objecttype","CM Object No.","CM Source","CM Source Description","Creation Date");
                               Task.SETCURRENTKEY("CM Type","CM Objecttype","CM Object No.","CM Source","CM Source No.");
                             END;

               OnAfterGetRecord=BEGIN
                                  IF (RecuringTask."Expiration Date" < WORKDATE) AND (RecuringTask."Expiration Date" <> 0D) THEN BEGIN
                                    RecuringTask.Inactive := TRUE;
                                    RecuringTask.MODIFY(FALSE);
                                    CurrReport.SKIP();
                                  END;

                                  //New WO
                                  IF ((LastDueDate <> RecuringTask."Due Date") AND (LastStartDate <> RecuringTask."Start Date")) OR (LastObjNo <> RecuringTask.Key1)THEN BEGIN
                                   TempWo.INIT;
                                   TempWo."No." := '#$NEW-WO$#' + FORMAT(counter1);
                                   TempWo.Description := CMGenSetup."Recurring Workorder Name";
                                   TempWo."CM Is Workorder" := TRUE;
                                   TempWo."CM Is Temporary" := TRUE;
                                   TempWo."CM Source" := Workorder."CM Source"::Recuring;
                                   TempWo."CM Source Description" := FORMAT(WORKDATE) + ', ' + FORMAT(TIME);
                                   TempWo."CM Objecttype" := TempWo."CM Objecttype"::Asset;
                                   TempWo."CM Object No." := RecuringTask.Key1;
                                   TempWo."CM Due Date" := RecuringTask."Due Date";
                                   TempWo.INSERT(FALSE);
                                  END;

                                  //Check last Task
                                  Task.SETCURRENTKEY("CM Type","CM Objecttype","CM Object No.","CM Source","CM Source No.",Date);
                                  Task.SETRANGE("CM Type", Task."CM Type"::Task);
                                  Task.SETRANGE("CM Objecttype", Task."CM Objecttype");
                                  Task.SETRANGE("CM Object No.", RecuringTask.Key1);
                                  Task.SETRANGE("CM Source", Task."CM Source"::Recuring);
                                  Task.SETRANGE("CM Source No.", RecuringTask."Line No.");
                                  IF Task.FINDLAST() THEN BEGIN
                                    IF CALCDATE(RecuringTask."Recurring Date Interval", Task.Date) <= WORKDATE THEN BEGIN
                                      AddTempTask();
                                    END;
                                  END
                                  ELSE BEGIN
                                    Task.INIT;
                                    Task."No." := '';
                                    AddTempTask();
                                  END;

                                  LastDueDate := RecuringTask."Due Date";
                                  LastStartDate := RecuringTask."Start Date";
                                  LastInteractionGroupCode := RecuringTask."Interaction Group Code";
                                  LastObjNo := RecuringTask.Key1;
                                  counter1 += 1;
                                END;
                                 }

    { 1000000001;0;DataItem;TempWo           ;
               DataItemTable=Table5092;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               TempWo.RESET;
                               TempTask.RESET;
                               TempTask.SETCURRENTKEY("Opportunity No.","CM Type","CM Assigned User ID","CM Status");
                             END;

               OnAfterGetRecord=VAR
                                  LogEntry@1000000000 : Record 5065;
                                BEGIN
                                  TempTask.SETRANGE("Opportunity No.", TempWo."No.");
                                  IF NOT TempTask.FIND('-') THEN
                                    CurrReport.SKIP();

                                  //### Create Workorder ###:
                                  Workorder.RESET;
                                  Workorder.INIT;
                                  Workorder.TRANSFERFIELDS(TempWo,FALSE);
                                  Workorder."CM Is Temporary" := FALSE;
                                  Workorder."No." := '';
                                  Workorder.INSERT(TRUE);
                                  c1 += 1;

                                  REPEAT //### Create Task ###
                                    //Close existing Task
                                    IF (Task.GET(TempTask."No.")) AND (Task."CM Status" = Task."CM Status"::Open) THEN BEGIN
                                      Task."CM Status" := Task."CM Status"::Closed;
                                      Task.MODIFY(FALSE);
                                      c3 += 1;

                                      LogEntry.GET(CMGenMgt.CreateLogEntry(Task,LogEntry."CM Log Type"::"Status Change",FORMAT(Task."CM Status"), Text001));
                                      LogEntry."User ID" := CMGenSetup."System User ID";
                                      LogEntry."Salesperson Code" := CMGenSetup."System Salesperson";
                                      LogEntry."Contact No." := CMGenSetup."System Contact";
                                      LogEntry.MODIFY(FALSE);
                                    END;

                                    Task.INIT;
                                    Task.TRANSFERFIELDS(TempTask);
                                    Task."Opportunity No." := Workorder."No.";
                                    Task."No." := '';
                                    Task."CM Status" := 0;
                                    Task.INSERT(TRUE);
                                    c2 += 1;

                                    InsertSubTasks();

                                  UNTIL TempTask.NEXT = 0;
                                END;

               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      TempTask@1000000005 : TEMPORARY Record 5080;
      LastDueDate@1000000001 : Date;
      LastStartDate@1000000007 : Date;
      LastInteractionGroupCode@1000000000 : Code[20];
      LastObjNo@1000000008 : Code[20];
      Workorder@1000000002 : Record 5092;
      Task@1000000006 : Record 5080;
      counter1@1000000003 : Integer;
      counter2@1000000012 : Integer;
      counter3@1000000013 : Integer;
      CMWoMgt@1000000004 : Codeunit 70030;
      CMTaskMgt@1000000009 : Codeunit 70031;
      CMGenMgt@1000000010 : Codeunit 70000;
      CMGenSetup@1000000011 : Record 70000;
      LogEntry@1000000014 : Record 5065;
      Text001@1000000015 : TextConst 'ENU=Task was automatically closed, and recreated by the system (recurring Task).';
      c1@1000000016 : Integer;
      c2@1000000017 : Integer;
      c3@1000000018 : Integer;

    LOCAL PROCEDURE AddTempTask@1000000000();
    VAR
      InteractionTemplate@1000000000 : Record 5064;
    BEGIN
      TempTask.RESET;
      TempTask.INIT;
      TempTask.TRANSFERFIELDS(Task);
      TempTask."CM Status" := TempTask."CM Status"::Open;
      IF TempTask."No." = '' THEN
        TempTask."No." := '#$NEW-TASK$#' + FORMAT(counter1);

      IF InteractionTemplate.GET(RecuringTask."Interaction Template Code") THEN BEGIN
        TempTask."CM Wizard Action" := InteractionTemplate."Wizard Action";
        TempTask."CM Information Type" := InteractionTemplate."IG Information Type";
      END;

      TempTask."CM Type" := TempTask."CM Type"::Task;
      TempTask."CM Subtype" := TempTask."CM Subtype"::" ";
      TempTask."CM Assigned User ID" := '';
      TempTask.Date := WORKDATE;
      TempTask."Opportunity No." := TempWo."No.";

      TempTask."CM Source" := TempTask."CM Source"::Recuring;
      TempTask."CM Source No." := RecuringTask."Line No.";
      TempTask."CM Scheduled Date" := RecuringTask."Due Date";
      TempTask.Description := RecuringTask.Description;
      TempTask."CM Interaction Group Code" := RecuringTask."Interaction Group Code";
      TempTask."CM Interaction Template Code" := RecuringTask."Interaction Template Code";

      TempTask.INSERT(FALSE);
    END;

    LOCAL PROCEDURE InsertSubTasks@1000000005();
    VAR
      RecSubTask@1000000000 : Record 70021;
      SubTask@1000000001 : Record 5080;
    BEGIN
      RecSubTask.RESET;
      RecSubTask.SETRANGE(Objecttype, RecSubTask.Objecttype::Asset);
      RecSubTask.SETRANGE(Type, RecSubTask.Type::RecurringToDo);
      RecSubTask.SETRANGE(Key1, Task."CM Object No.");
      RecSubTask.SETRANGE(Subtype, RecSubTask.Subtype::Checklist);
      RecSubTask.SETRANGE("Maintask Line No.", Task."CM Source No.");
      IF RecSubTask.FIND('-') THEN BEGIN
        REPEAT
          SubTask.INIT;
          SubTask."No." := '';
          SubTask."CM Maintask No." := Task."No.";
          SubTask."CM Subtype" := RecSubTask.Subtype;
          SubTask.Description := RecSubTask.Description;
          SubTask."CM Type" := SubTask."CM Type"::Task;
          SubTask."CM Source" := SubTask."CM Source"::Recuring;
          SubTask."CM Source No." := Task."CM Source No.";
          SubTask.INSERT(TRUE);
        UNTIL RecSubTask.NEXT = 0;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}