OBJECT Table 38 Purchase Header
{
  OBJECT-PROPERTIES
  {
    Date=07.09.17;
    Time=14:07:52;
    Modified=Yes;
    Version List=NAVW19.00.00.46290,NAVDACH9.00.00.46290,CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Buy-from Vendor Name;
    OnInsert=BEGIN
               IF NOT SkipInitialization THEN
                 InitInsert;

               IF GETFILTER("Buy-from Vendor No.") <> '' THEN
                 IF GETRANGEMIN("Buy-from Vendor No.") = GETRANGEMAX("Buy-from Vendor No.") THEN
                   VALIDATE("Buy-from Vendor No.",GETRANGEMIN("Buy-from Vendor No."));

               "Doc. No. Occurrence" := ArchiveManagement.GetNextOccurrenceNo(DATABASE::"Purchase Header","Document Type","No.");
             END;

    OnDelete=BEGIN
               IF NOT UserSetupMgt.CheckRespCenter(1,"Responsibility Center") THEN
                 ERROR(
                   Text023,
                   RespCenter.TABLECAPTION,UserSetupMgt.GetPurchasesFilter);

               PurchPost.DeleteHeader(
                 Rec,PurchRcptHeader,PurchInvHeader,PurchCrMemoHeader,
                 ReturnShptHeader,PurchInvHeaderPrepmt,PurchCrMemoHeaderPrepmt);
               CASE "Document Type" OF
                 "Document Type"::Quote:
                   BEGIN
                     PurchSetup.GET;
                     CASE PurchSetup."Archiving Purchase Quote" OF
                       PurchSetup."Archiving Purchase Quote"::Always:
                         ArchiveManagement.ArchPurchDocumentNoConfirm(Rec);
                       PurchSetup."Archiving Purchase Quote"::Question:
                         ArchiveManagement.ArchivePurchDocument(Rec);
                     END;
                   END;
                 "Document Type"::Order,"Document Type"::"Blanket Order","Document Type"::"Return Order":
                   BEGIN
                     PurchSetup.GET;
                     IF PurchSetup."Arch. Orders and Ret. Orders" OR PurchSetup."Archiving Blanket Purch. Order" THEN
                       ArchiveManagement.ArchPurchDocumentNoConfirm(Rec);
                   END;
               END;

               VALIDATE("Applies-to ID",'');
               VALIDATE("Incoming Document Entry No.",0);

               ApprovalsMgmt.DeleteApprovalEntry(DATABASE::"Purchase Header","Document Type","No.");
               PurchLine.LOCKTABLE;

               WhseRequest.SETRANGE("Source Type",DATABASE::"Purchase Line");
               WhseRequest.SETRANGE("Source Subtype","Document Type");
               WhseRequest.SETRANGE("Source No.","No.");
               WhseRequest.DELETEALL(TRUE);

               PurchLine.SETRANGE("Document Type","Document Type");
               PurchLine.SETRANGE("Document No.","No.");
               PurchLine.SETRANGE(Type,PurchLine.Type::"Charge (Item)");
               DeletePurchaseLines;
               PurchLine.SETRANGE(Type);
               DeletePurchaseLines;

               PurchCommentLine.SETRANGE("Document Type","Document Type");
               PurchCommentLine.SETRANGE("No.","No.");
               PurchCommentLine.DELETEALL;

               IF (PurchRcptHeader."No." <> '') OR
                  (PurchInvHeader."No." <> '') OR
                  (PurchCrMemoHeader."No." <> '') OR
                  (ReturnShptHeader."No." <> '') OR
                  (PurchInvHeaderPrepmt."No." <> '') OR
                  (PurchCrMemoHeaderPrepmt."No." <> '')
               THEN
                 MESSAGE(PostedDocsToPrintCreatedMsg);
             END;

    OnRename=BEGIN
               ERROR(Text003,TABLECAPTION);
             END;

    CaptionML=[ENU=Purchase Header;
               DEA=Einkaufskopf];
    LookupPageID=Page53;
  }
  FIELDS
  {
    { 1   ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              DEA=Belegart];
                                                   OptionCaptionML=[ENU=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order;
                                                                    DEA=Anfrage,Bestellung,Rechnung,Gutschrift,Rahmenbestellung,Reklamation];
                                                   OptionString=Quote,Order,Invoice,Credit Memo,Blanket Order,Return Order }
    { 2   ;   ;Buy-from Vendor No. ;Code20        ;TableRelation=Vendor;
                                                   OnValidate=BEGIN
                                                                InitRecOnVendUpdate;
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Buy-from Vendor No." <> xRec."Buy-from Vendor No.") AND
                                                                   (xRec."Buy-from Vendor No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Buy-from Vendor No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    PurchLine.SETRANGE("Document Type","Document Type");
                                                                    PurchLine.SETRANGE("Document No.","No.");
                                                                    IF "Buy-from Vendor No." = '' THEN BEGIN
                                                                      IF NOT PurchLine.ISEMPTY THEN
                                                                        ERROR(
                                                                          Text005,
                                                                          FIELDCAPTION("Buy-from Vendor No."));
                                                                      INIT;
                                                                      PurchSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;
                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      PurchLine.SETFILTER("Quantity Received",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::Invoice THEN BEGIN
                                                                        PurchLine.SETRANGE("Buy-from Vendor No.",xRec."Buy-from Vendor No.");
                                                                        PurchLine.SETFILTER("Receipt No.",'<>%1','');
                                                                      END;
                                                                    IF PurchLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        PurchLine.TESTFIELD("Quantity Received",0)
                                                                      ELSE
                                                                        PurchLine.TESTFIELD("Receipt No.",'');

                                                                    PurchLine.SETRANGE("Receipt No.");
                                                                    PurchLine.SETRANGE("Quantity Received");
                                                                    PurchLine.SETRANGE("Buy-from Vendor No.");

                                                                    IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                      PurchLine.SETFILTER("Prepmt. Amt. Inv.",'<>0');
                                                                      IF PurchLine.FIND('-') THEN
                                                                        PurchLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      PurchLine.SETRANGE("Prepmt. Amt. Inv.");
                                                                    END;

                                                                    IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                      PurchLine.SETFILTER("Return Qty. Shipped",'<>0')
                                                                    ELSE
                                                                      IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                                                                        PurchLine.SETRANGE("Buy-from Vendor No.",xRec."Buy-from Vendor No.");
                                                                        PurchLine.SETFILTER("Return Shipment No.",'<>%1','');
                                                                      END;
                                                                    IF PurchLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                        PurchLine.TESTFIELD("Return Qty. Shipped",0)
                                                                      ELSE
                                                                        PurchLine.TESTFIELD("Return Shipment No.",'');

                                                                    PurchLine.RESET;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                GetVend("Buy-from Vendor No.");
                                                                Vend.CheckBlockedVendOnDocs(Vend,FALSE);
                                                                Vend.TESTFIELD("Gen. Bus. Posting Group");
                                                                "Buy-from Vendor Name" := Vend.Name;
                                                                "Buy-from Vendor Name 2" := Vend."Name 2";
                                                                "Buy-from Address" := Vend.Address;
                                                                "Buy-from Address 2" := Vend."Address 2";
                                                                "Buy-from City" := Vend.City;
                                                                "Buy-from Post Code" := Vend."Post Code";
                                                                "Buy-from County" := Vend.County;
                                                                "Buy-from Country/Region Code" := Vend."Country/Region Code";
                                                                IF NOT SkipBuyFromContact THEN
                                                                  "Buy-from Contact" := Vend.Contact;
                                                                "Gen. Bus. Posting Group" := Vend."Gen. Bus. Posting Group";
                                                                "VAT Bus. Posting Group" := Vend."VAT Bus. Posting Group";
                                                                "Tax Area Code" := Vend."Tax Area Code";
                                                                "Tax Liable" := Vend."Tax Liable";
                                                                "VAT Registration No." := Vend."VAT Registration No.";
                                                                "VAT Country/Region Code" := Vend."Country/Region Code";
                                                                "Registration No." := Vend."Registration No.";
                                                                VALIDATE("Lead Time Calculation",Vend."Lead Time Calculation");
                                                                "Responsibility Center" := UserSetupMgt.GetRespCenter(1,Vend."Responsibility Center");
                                                                VALIDATE("Sell-to Customer No.",'');
                                                                VALIDATE("Location Code",UserSetupMgt.GetLocation(1,Vend."Location Code","Responsibility Center"));

                                                                IF "Buy-from Vendor No." = xRec."Pay-to Vendor No." THEN
                                                                  IF ReceivedPurchLinesExist OR ReturnShipmentExist THEN BEGIN
                                                                    TESTFIELD("VAT Bus. Posting Group",xRec."VAT Bus. Posting Group");
                                                                    TESTFIELD("Gen. Bus. Posting Group",xRec."Gen. Bus. Posting Group");
                                                                  END;

                                                                "Buy-from IC Partner Code" := Vend."IC Partner Code";
                                                                "Send IC Document" := ("Buy-from IC Partner Code" <> '') AND ("IC Direction" = "IC Direction"::Outgoing);

                                                                IF Vend."Pay-to Vendor No." <> '' THEN
                                                                  VALIDATE("Pay-to Vendor No.",Vend."Pay-to Vendor No.")
                                                                ELSE BEGIN
                                                                  IF "Buy-from Vendor No." = "Pay-to Vendor No." THEN
                                                                    SkipPayToContact := TRUE;
                                                                  VALIDATE("Pay-to Vendor No.","Buy-from Vendor No.");
                                                                  SkipPayToContact := FALSE;
                                                                END;
                                                                "Order Address Code" := '';

                                                                VALIDATE("Order Address Code");

                                                                IF (xRec."Buy-from Vendor No." <> "Buy-from Vendor No.") OR
                                                                   (xRec."Currency Code" <> "Currency Code") OR
                                                                   (xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group") OR
                                                                   (xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group")
                                                                THEN
                                                                  RecreatePurchLines(FIELDCAPTION("Buy-from Vendor No."));

                                                                IF NOT SkipBuyFromContact THEN
                                                                  UpdateBuyFromCont("Buy-from Vendor No.");
                                                              END;

                                                   CaptionML=[ENU=Buy-from Vendor No.;
                                                              DEA=Eink. von Kred.-Nr.] }
    { 3   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  NoSeriesMgt.TestManual(GetNoSeriesCode);
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              DEA=Nr.] }
    { 4   ;   ;Pay-to Vendor No.   ;Code20        ;TableRelation=Vendor;
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF (xRec."Pay-to Vendor No." <> "Pay-to Vendor No.") AND
                                                                   (xRec."Pay-to Vendor No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Pay-to Vendor No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    PurchLine.SETRANGE("Document Type","Document Type");
                                                                    PurchLine.SETRANGE("Document No.","No.");

                                                                    IF "Document Type" = "Document Type"::Order THEN
                                                                      PurchLine.SETFILTER("Quantity Received",'<>0');
                                                                    IF "Document Type" = "Document Type"::Invoice THEN
                                                                      PurchLine.SETFILTER("Receipt No.",'<>%1','');
                                                                    IF PurchLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::Order THEN
                                                                        PurchLine.TESTFIELD("Quantity Received",0)
                                                                      ELSE
                                                                        PurchLine.TESTFIELD("Receipt No.",'');

                                                                    PurchLine.SETRANGE("Receipt No.");
                                                                    PurchLine.SETRANGE("Quantity Received");

                                                                    IF "Document Type" = "Document Type"::Order THEN BEGIN
                                                                      PurchLine.SETFILTER("Prepmt. Amt. Inv.",'<>0');
                                                                      IF PurchLine.FIND('-') THEN
                                                                        PurchLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      PurchLine.SETRANGE("Prepmt. Amt. Inv.");
                                                                    END;

                                                                    IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                      PurchLine.SETFILTER("Return Qty. Shipped",'<>0');
                                                                    IF "Document Type" = "Document Type"::"Credit Memo" THEN
                                                                      PurchLine.SETFILTER("Return Shipment No.",'<>%1','');
                                                                    IF PurchLine.FINDFIRST THEN
                                                                      IF "Document Type" = "Document Type"::"Return Order" THEN
                                                                        PurchLine.TESTFIELD("Return Qty. Shipped",0)
                                                                      ELSE
                                                                        PurchLine.TESTFIELD("Return Shipment No.",'');

                                                                    PurchLine.RESET;
                                                                  END ELSE
                                                                    "Pay-to Vendor No." := xRec."Pay-to Vendor No.";
                                                                END;

                                                                GetVend("Pay-to Vendor No.");
                                                                Vend.CheckBlockedVendOnDocs(Vend,FALSE);
                                                                Vend.TESTFIELD("Vendor Posting Group");

                                                                "Pay-to Name" := Vend.Name;
                                                                "Pay-to Name 2" := Vend."Name 2";
                                                                "Pay-to Address" := Vend.Address;
                                                                "Pay-to Address 2" := Vend."Address 2";
                                                                "Pay-to City" := Vend.City;
                                                                "Pay-to Post Code" := Vend."Post Code";
                                                                "Pay-to County" := Vend.County;
                                                                "Pay-to Country/Region Code" := Vend."Country/Region Code";
                                                                IF NOT SkipPayToContact THEN
                                                                  "Pay-to Contact" := Vend.Contact;
                                                                "Payment Terms Code" := Vend."Payment Terms Code";
                                                                "Prepmt. Payment Terms Code" := Vend."Payment Terms Code";

                                                                IF "Document Type" = "Document Type"::"Credit Memo" THEN BEGIN
                                                                  "Payment Method Code" := '';
                                                                  IF PaymentTerms.GET("Payment Terms Code") THEN
                                                                    IF PaymentTerms."Calc. Pmt. Disc. on Cr. Memos" THEN
                                                                      "Payment Method Code" := Vend."Payment Method Code"
                                                                END ELSE
                                                                  "Payment Method Code" := Vend."Payment Method Code";

                                                                "Shipment Method Code" := Vend."Shipment Method Code";
                                                                "Vendor Posting Group" := Vend."Vendor Posting Group";
                                                                GLSetup.GET;
                                                                IF GLSetup."Bill-to/Sell-to VAT Calc." = GLSetup."Bill-to/Sell-to VAT Calc."::"Bill-to/Pay-to No." THEN BEGIN
                                                                  "VAT Bus. Posting Group" := Vend."VAT Bus. Posting Group";
                                                                  "VAT Country/Region Code" := Vend."Country/Region Code";
                                                                  "VAT Registration No." := Vend."VAT Registration No.";
                                                                  "Gen. Bus. Posting Group" := Vend."Gen. Bus. Posting Group";
                                                                END;
                                                                "Prices Including VAT" := Vend."Prices Including VAT";
                                                                "Currency Code" := Vend."Currency Code";
                                                                "Invoice Disc. Code" := Vend."Invoice Disc. Code";
                                                                "Language Code" := Vend."Language Code";
                                                                "Purchaser Code" := Vend."Purchaser Code";
                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");
                                                                VALIDATE("Payment Method Code");
                                                                VALIDATE("Currency Code");
                                                                VALIDATE("Creditor No.",Vend."Creditor No.");

                                                                IF "Document Type" = "Document Type"::Order THEN
                                                                  VALIDATE("Prepayment %",Vend."Prepayment %");

                                                                IF "Pay-to Vendor No." = xRec."Pay-to Vendor No." THEN BEGIN
                                                                  IF ReceivedPurchLinesExist THEN
                                                                    TESTFIELD("Currency Code",xRec."Currency Code");
                                                                END;

                                                                CreateDim(
                                                                  DATABASE::Vendor,"Pay-to Vendor No.",
                                                                  DATABASE::"Salesperson/Purchaser","Purchaser Code",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center");

                                                                IF (xRec."Buy-from Vendor No." = "Buy-from Vendor No.") AND
                                                                   (xRec."Pay-to Vendor No." <> "Pay-to Vendor No.")
                                                                THEN
                                                                  RecreatePurchLines(FIELDCAPTION("Pay-to Vendor No."));

                                                                IF NOT SkipPayToContact THEN
                                                                  UpdatePayToCont("Pay-to Vendor No.");

                                                                "Pay-to IC Partner Code" := Vend."IC Partner Code";
                                                              END;

                                                   CaptionML=[ENU=Pay-to Vendor No.;
                                                              DEA=Zahlung an Kred.-Nr.];
                                                   NotBlank=Yes }
    { 5   ;   ;Pay-to Name         ;Text50        ;CaptionML=[ENU=Pay-to Name;
                                                              DEA=Zahlung an Name] }
    { 6   ;   ;Pay-to Name 2       ;Text50        ;CaptionML=[ENU=Pay-to Name 2;
                                                              DEA=Zahlung an Name 2] }
    { 7   ;   ;Pay-to Address      ;Text50        ;CaptionML=[ENU=Pay-to Address;
                                                              DEA=Zahlung an Adresse] }
    { 8   ;   ;Pay-to Address 2    ;Text50        ;CaptionML=[ENU=Pay-to Address 2;
                                                              DEA=Zahlung an Adresse 2] }
    { 9   ;   ;Pay-to City         ;Text30        ;TableRelation=IF (Pay-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Pay-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Pay-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Pay-to City;
                                                              DEA=Zahlung an Ort] }
    { 10  ;   ;Pay-to Contact      ;Text50        ;CaptionML=[ENU=Pay-to Contact;
                                                              DEA=Zahlung an Kontakt] }
    { 11  ;   ;Your Reference      ;Text35        ;CaptionML=[ENU=Your Reference;
                                                              DEA=Ihre Referenz] }
    { 12  ;   ;Ship-to Code        ;Code10        ;TableRelation="Ship-to Address".Code WHERE (Customer No.=FIELD(Sell-to Customer No.));
                                                   OnValidate=BEGIN
                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Ship-to Code" <> "Ship-to Code")
                                                                THEN BEGIN
                                                                  PurchLine.SETRANGE("Document Type",PurchLine."Document Type"::Order);
                                                                  PurchLine.SETRANGE("Document No.","No.");
                                                                  PurchLine.SETFILTER("Sales Order Line No.",'<>0');
                                                                  IF NOT PurchLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Ship-to Code"));
                                                                END;

                                                                IF "Ship-to Code" <> '' THEN BEGIN
                                                                  ShipToAddr.GET("Sell-to Customer No.","Ship-to Code");
                                                                  "Ship-to Name" := ShipToAddr.Name;
                                                                  "Ship-to Name 2" := ShipToAddr."Name 2";
                                                                  "Ship-to Address" := ShipToAddr.Address;
                                                                  "Ship-to Address 2" := ShipToAddr."Address 2";
                                                                  "Ship-to City" := ShipToAddr.City;
                                                                  "Ship-to Post Code" := ShipToAddr."Post Code";
                                                                  "Ship-to County" := ShipToAddr.County;
                                                                  "Ship-to Country/Region Code" := ShipToAddr."Country/Region Code";
                                                                  "Ship-to Contact" := ShipToAddr.Contact;
                                                                  "Shipment Method Code" := ShipToAddr."Shipment Method Code";
                                                                  IF ShipToAddr."Location Code" <> '' THEN
                                                                    VALIDATE("Location Code",ShipToAddr."Location Code");
                                                                END ELSE BEGIN
                                                                  TESTFIELD("Sell-to Customer No.");
                                                                  Cust.GET("Sell-to Customer No.");
                                                                  "Ship-to Name" := Cust.Name;
                                                                  "Ship-to Name 2" := Cust."Name 2";
                                                                  "Ship-to Address" := Cust.Address;
                                                                  "Ship-to Address 2" := Cust."Address 2";
                                                                  "Ship-to City" := Cust.City;
                                                                  "Ship-to Post Code" := Cust."Post Code";
                                                                  "Ship-to County" := Cust.County;
                                                                  "Ship-to Country/Region Code" := Cust."Country/Region Code";
                                                                  "Ship-to Contact" := Cust.Contact;
                                                                  "Shipment Method Code" := Cust."Shipment Method Code";
                                                                  IF Cust."Location Code" <> '' THEN
                                                                    VALIDATE("Location Code",Cust."Location Code");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Ship-to Code;
                                                              DEA=Lief. an Code] }
    { 13  ;   ;Ship-to Name        ;Text50        ;CaptionML=[ENU=Ship-to Name;
                                                              DEA=Lief. an Name] }
    { 14  ;   ;Ship-to Name 2      ;Text50        ;CaptionML=[ENU=Ship-to Name 2;
                                                              DEA=Lief. an Name 2] }
    { 15  ;   ;Ship-to Address     ;Text50        ;CaptionML=[ENU=Ship-to Address;
                                                              DEA=Lief. an Adresse] }
    { 16  ;   ;Ship-to Address 2   ;Text50        ;CaptionML=[ENU=Ship-to Address 2;
                                                              DEA=Lief. an Adresse 2] }
    { 17  ;   ;Ship-to City        ;Text30        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to City;
                                                              DEA=Lief. an Ort] }
    { 18  ;   ;Ship-to Contact     ;Text50        ;CaptionML=[ENU=Ship-to Contact;
                                                              DEA=Lief. an Kontakt] }
    { 19  ;   ;Order Date          ;Date          ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Document Type" IN ["Document Type"::Quote,"Document Type"::Order]) AND
                                                                   NOT ("Order Date" = xRec."Order Date")
                                                                THEN
                                                                  PriceMessageIfPurchLinesExist(FIELDCAPTION("Order Date"));
                                                              END;

                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Order Date;
                                                              DEA=Bestelldatum] }
    { 20  ;   ;Posting Date        ;Date          ;OnValidate=VAR
                                                                SkipJobCurrFactorUpdate@1000 : Boolean;
                                                              BEGIN
                                                                TestNoSeriesDate(
                                                                  "Posting No.","Posting No. Series",
                                                                  FIELDCAPTION("Posting No."),FIELDCAPTION("Posting No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepayment No.","Prepayment No. Series",
                                                                  FIELDCAPTION("Prepayment No."),FIELDCAPTION("Prepayment No. Series"));
                                                                TestNoSeriesDate(
                                                                  "Prepmt. Cr. Memo No.","Prepmt. Cr. Memo No. Series",
                                                                  FIELDCAPTION("Prepmt. Cr. Memo No."),FIELDCAPTION("Prepmt. Cr. Memo No. Series"));

                                                                IF "Incoming Document Entry No." = 0 THEN
                                                                  VALIDATE("Document Date","Posting Date");

                                                                IF ("Document Type" IN ["Document Type"::Invoice,"Document Type"::"Credit Memo"]) AND
                                                                   NOT ("Posting Date" = xRec."Posting Date")
                                                                THEN
                                                                  PriceMessageIfPurchLinesExist(FIELDCAPTION("Posting Date"));

                                                                IF "Currency Code" <> '' THEN BEGIN
                                                                  UpdateCurrencyFactor;
                                                                  IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                    SkipJobCurrFactorUpdate := NOT ConfirmUpdateCurrencyFactor;
                                                                END;

                                                                IF "Posting Date" <> xRec."Posting Date" THEN
                                                                  IF DeferralHeadersExist THEN
                                                                    ConfirmUpdateDeferralDate;

                                                                IF PurchLinesExist THEN
                                                                  JobUpdatePurchLines(SkipJobCurrFactorUpdate);
                                                              END;

                                                   CaptionML=[ENU=Posting Date;
                                                              DEA=Buchungsdatum] }
    { 21  ;   ;Expected Receipt Date;Date         ;OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION("Expected Receipt Date"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Expected Receipt Date;
                                                              DEA=Erwartetes Wareneingangsdatum] }
    { 22  ;   ;Posting Description ;Text50        ;CaptionML=[ENU=Posting Description;
                                                              DEA=Buchungsbeschreibung] }
    { 23  ;   ;Payment Terms Code  ;Code10        ;TableRelation="Payment Terms";
                                                   OnValidate=BEGIN
                                                                IF ("Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Payment Terms Code");
                                                                  IF (("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]) AND
                                                                      NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos")
                                                                  THEN BEGIN
                                                                    VALIDATE("Due Date","Document Date");
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    IF NOT UpdateDocumentDate THEN
                                                                      VALIDATE("Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Pmt. Discount Date",0D);
                                                                    VALIDATE("Payment Discount %",0);
                                                                  END;
                                                                END;
                                                                IF xRec."Payment Terms Code" = "Prepmt. Payment Terms Code" THEN
                                                                  VALIDATE("Prepmt. Payment Terms Code","Payment Terms Code");
                                                              END;

                                                   CaptionML=[ENU=Payment Terms Code;
                                                              DEA=Zlg.-Bedingungscode] }
    { 24  ;   ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              DEA=F„lligkeitsdatum] }
    { 25  ;   ;Payment Discount %  ;Decimal       ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Payment Discount %;
                                                              DEA=Skonto %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 26  ;   ;Pmt. Discount Date  ;Date          ;CaptionML=[ENU=Pmt. Discount Date;
                                                              DEA=Skontodatum] }
    { 27  ;   ;Shipment Method Code;Code10        ;TableRelation="Shipment Method";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                              END;

                                                   CaptionML=[ENU=Shipment Method Code;
                                                              DEA=Lieferbedingungscode] }
    { 28  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF ("Location Code" <> xRec."Location Code") AND
                                                                   (xRec."Buy-from Vendor No." = "Buy-from Vendor No.")
                                                                THEN
                                                                  MessageIfPurchLinesExist(FIELDCAPTION("Location Code"));

                                                                UpdateShipToAddress;

                                                                IF "Location Code" = '' THEN BEGIN
                                                                  IF InvtSetup.GET THEN
                                                                    "Inbound Whse. Handling Time" := InvtSetup."Inbound Whse. Handling Time";
                                                                END ELSE BEGIN
                                                                  IF Location.GET("Location Code") THEN;
                                                                  "Inbound Whse. Handling Time" := Location."Inbound Whse. Handling Time";
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Location Code;
                                                              DEA=Lagerortcode] }
    { 29  ;   ;Shortcut Dimension 1 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Shortcut Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 1 Code;
                                                              DEA=Shortcutdimensionscode 1];
                                                   CaptionClass='1,2,1' }
    { 30  ;   ;Shortcut Dimension 2 Code;Code20   ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Shortcut Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Shortcut Dimension 2 Code;
                                                              DEA=Shortcutdimensionscode 2];
                                                   CaptionClass='1,2,2' }
    { 31  ;   ;Vendor Posting Group;Code10        ;TableRelation="Vendor Posting Group";
                                                   CaptionML=[ENU=Vendor Posting Group;
                                                              DEA=Kreditorenbuchungsgruppe];
                                                   Editable=No }
    { 32  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date")]) OR ("Currency Code" <> xRec."Currency Code") THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                IF (CurrFieldNo <> FIELDNO("Currency Code")) AND ("Currency Code" = xRec."Currency Code") THEN
                                                                  UpdateCurrencyFactor
                                                                ELSE
                                                                  IF "Currency Code" <> xRec."Currency Code" THEN BEGIN
                                                                    UpdateCurrencyFactor;
                                                                    IF PurchLinesExist THEN
                                                                      IF CONFIRM(ChangeCurrencyQst,FALSE,FIELDCAPTION("Currency Code")) THEN BEGIN
                                                                        SetHideValidationDialog(TRUE);
                                                                        RecreatePurchLines(FIELDCAPTION("Currency Code"));
                                                                        SetHideValidationDialog(FALSE);
                                                                      END ELSE
                                                                        ERROR(Text018,FIELDCAPTION("Currency Code"));
                                                                  END ELSE
                                                                    IF "Currency Code" <> '' THEN BEGIN
                                                                      UpdateCurrencyFactor;
                                                                      IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                        ConfirmUpdateCurrencyFactor;
                                                                    END;
                                                              END;

                                                   CaptionML=[ENU=Currency Code;
                                                              DEA=W„hrungscode] }
    { 33  ;   ;Currency Factor     ;Decimal       ;OnValidate=BEGIN
                                                                IF "Currency Factor" <> xRec."Currency Factor" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Currency Factor"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Currency Factor;
                                                              DEA=W„hrungsfaktor];
                                                   DecimalPlaces=0:15;
                                                   MinValue=0;
                                                   Editable=No }
    { 35  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                PurchLine@1000 : Record 39;
                                                                Currency@1001 : Record 4;
                                                                RecalculatePrice@1002 : Boolean;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF "Prices Including VAT" <> xRec."Prices Including VAT" THEN BEGIN
                                                                  PurchLine.SETRANGE("Document Type","Document Type");
                                                                  PurchLine.SETRANGE("Document No.","No.");
                                                                  PurchLine.SETFILTER("Direct Unit Cost",'<>%1',0);
                                                                  PurchLine.SETFILTER("VAT %",'<>%1',0);
                                                                  IF PurchLine.FIND('-') THEN BEGIN
                                                                    RecalculatePrice :=
                                                                      CONFIRM(
                                                                        STRSUBSTNO(
                                                                          Text025 +
                                                                          Text027,
                                                                          FIELDCAPTION("Prices Including VAT"),PurchLine.FIELDCAPTION("Direct Unit Cost")),
                                                                        TRUE);
                                                                    PurchLine.SetPurchHeader(Rec);

                                                                    IF RecalculatePrice AND "Prices Including VAT" THEN
                                                                      PurchLine.MODIFYALL(Amount,0,TRUE);

                                                                    IF "Currency Code" = '' THEN
                                                                      Currency.InitRoundingPrecision
                                                                    ELSE
                                                                      Currency.GET("Currency Code");

                                                                    PurchLine.FINDSET;
                                                                    REPEAT
                                                                      PurchLine.TESTFIELD("Quantity Invoiced",0);
                                                                      PurchLine.TESTFIELD("Prepmt. Amt. Inv.",0);
                                                                      IF NOT RecalculatePrice THEN BEGIN
                                                                        PurchLine."VAT Difference" := 0;
                                                                        PurchLine.UpdateAmounts;
                                                                      END ELSE
                                                                        IF "Prices Including VAT" THEN BEGIN
                                                                          PurchLine."Direct Unit Cost" :=
                                                                            ROUND(
                                                                              PurchLine."Direct Unit Cost" * (1 + PurchLine."VAT %" / 100),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF PurchLine.Quantity <> 0 THEN BEGIN
                                                                            PurchLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                PurchLine.Quantity * PurchLine."Direct Unit Cost" * PurchLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            PurchLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                PurchLine."Inv. Discount Amount" * (1 + PurchLine."VAT %" / 100),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END ELSE BEGIN
                                                                          PurchLine."Direct Unit Cost" :=
                                                                            ROUND(
                                                                              PurchLine."Direct Unit Cost" / (1 + PurchLine."VAT %" / 100),
                                                                              Currency."Unit-Amount Rounding Precision");
                                                                          IF PurchLine.Quantity <> 0 THEN BEGIN
                                                                            PurchLine."Line Discount Amount" :=
                                                                              ROUND(
                                                                                PurchLine.Quantity * PurchLine."Direct Unit Cost" * PurchLine."Line Discount %" / 100,
                                                                                Currency."Amount Rounding Precision");
                                                                            PurchLine.VALIDATE("Inv. Discount Amount",
                                                                              ROUND(
                                                                                PurchLine."Inv. Discount Amount" / (1 + PurchLine."VAT %" / 100),
                                                                                Currency."Amount Rounding Precision"));
                                                                          END;
                                                                        END;
                                                                      PurchLine.MODIFY;
                                                                    UNTIL PurchLine.NEXT = 0;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prices Including VAT;
                                                              DEA=EK-Preise inkl. MwSt.] }
    { 37  ;   ;Invoice Disc. Code  ;Code20        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfPurchLinesExist(FIELDCAPTION("Invoice Disc. Code"));
                                                              END;

                                                   CaptionML=[ENU=Invoice Disc. Code;
                                                              DEA=Rechnungsrabattcode] }
    { 41  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=BEGIN
                                                                MessageIfPurchLinesExist(FIELDCAPTION("Language Code"));
                                                              END;

                                                   CaptionML=[ENU=Language Code;
                                                              DEA=Sprachcode] }
    { 43  ;   ;Purchaser Code      ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=VAR
                                                                ApprovalEntry@1001 : Record 454;
                                                              BEGIN
                                                                ApprovalEntry.SETRANGE("Table ID",DATABASE::"Purchase Header");
                                                                ApprovalEntry.SETRANGE("Document Type","Document Type");
                                                                ApprovalEntry.SETRANGE("Document No.","No.");
                                                                ApprovalEntry.SETFILTER(Status,'%1|%2',ApprovalEntry.Status::Created,ApprovalEntry.Status::Open);
                                                                IF NOT ApprovalEntry.ISEMPTY THEN
                                                                  ERROR(Text042,FIELDCAPTION("Purchaser Code"));

                                                                CreateDim(
                                                                  DATABASE::"Salesperson/Purchaser","Purchaser Code",
                                                                  DATABASE::Vendor,"Pay-to Vendor No.",
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::"Responsibility Center","Responsibility Center");
                                                              END;

                                                   CaptionML=[ENU=Purchaser Code;
                                                              DEA=Eink„ufercode] }
    { 45  ;   ;Order Class         ;Code10        ;CaptionML=[ENU=Order Class;
                                                              DEA=Bestellgruppe] }
    { 46  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Purch. Comment Line" WHERE (Document Type=FIELD(Document Type),
                                                                                                  No.=FIELD(No.),
                                                                                                  Document Line No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung];
                                                   Editable=No }
    { 47  ;   ;No. Printed         ;Integer       ;CaptionML=[ENU=No. Printed;
                                                              DEA=Anzahl gedruckt];
                                                   Editable=No }
    { 51  ;   ;On Hold             ;Code3         ;CaptionML=[ENU=On Hold;
                                                              DEA=Abwarten] }
    { 52  ;   ;Applies-to Doc. Type;Option        ;CaptionML=[ENU=Applies-to Doc. Type;
                                                              DEA=Ausgleich mit Belegart];
                                                   OptionCaptionML=[ENU=" ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund";
                                                                    DEA=" ,Zahlung,Rechnung,Gutschrift,Zinsrechnung,Mahnung,Erstattung"];
                                                   OptionString=[ ,Payment,Invoice,Credit Memo,Finance Charge Memo,Reminder,Refund] }
    { 53  ;   ;Applies-to Doc. No. ;Code20        ;OnValidate=BEGIN
                                                                IF "Applies-to Doc. No." <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');

                                                                IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." <> '') AND
                                                                   ("Applies-to Doc. No." <> '')
                                                                THEN BEGIN
                                                                  SetAmountToApply("Applies-to Doc. No.","Buy-from Vendor No.");
                                                                  SetAmountToApply(xRec."Applies-to Doc. No.","Buy-from Vendor No.");
                                                                END ELSE
                                                                  IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND (xRec."Applies-to Doc. No." = '') THEN
                                                                    SetAmountToApply("Applies-to Doc. No.","Buy-from Vendor No.")
                                                                  ELSE
                                                                    IF ("Applies-to Doc. No." <> xRec."Applies-to Doc. No.") AND ("Applies-to Doc. No." = '') THEN
                                                                      SetAmountToApply(xRec."Applies-to Doc. No.","Buy-from Vendor No.");
                                                              END;

                                                   OnLookup=BEGIN
                                                              TESTFIELD("Bal. Account No.",'');
                                                              VendLedgEntry.SETCURRENTKEY("Vendor No.",Open,Positive,"Due Date");
                                                              VendLedgEntry.SETRANGE("Vendor No.","Pay-to Vendor No.");
                                                              VendLedgEntry.SETRANGE(Open,TRUE);
                                                              IF "Applies-to Doc. No." <> '' THEN BEGIN
                                                                VendLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                VendLedgEntry.SETRANGE("Document No.","Applies-to Doc. No.");
                                                                IF VendLedgEntry.FINDFIRST THEN;
                                                                VendLedgEntry.SETRANGE("Document Type");
                                                                VendLedgEntry.SETRANGE("Document No.");
                                                              END ELSE
                                                                IF "Applies-to Doc. Type" <> 0 THEN BEGIN
                                                                  VendLedgEntry.SETRANGE("Document Type","Applies-to Doc. Type");
                                                                  IF VendLedgEntry.FINDFIRST THEN;
                                                                  VendLedgEntry.SETRANGE("Document Type");
                                                                END ELSE
                                                                  IF Amount <> 0 THEN BEGIN
                                                                    VendLedgEntry.SETRANGE(Positive,Amount < 0);
                                                                    IF VendLedgEntry.FINDFIRST THEN;
                                                                    VendLedgEntry.SETRANGE(Positive);
                                                                  END;
                                                              ApplyVendEntries.SetPurch(Rec,VendLedgEntry,PurchHeader.FIELDNO("Applies-to Doc. No."));
                                                              ApplyVendEntries.SETTABLEVIEW(VendLedgEntry);
                                                              ApplyVendEntries.SETRECORD(VendLedgEntry);
                                                              ApplyVendEntries.LOOKUPMODE(TRUE);
                                                              IF ApplyVendEntries.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                ApplyVendEntries.GetVendLedgEntry(VendLedgEntry);
                                                                GenJnlApply.CheckAgainstApplnCurrency(
                                                                  "Currency Code",VendLedgEntry."Currency Code",GenJnILine."Account Type"::Vendor,TRUE);
                                                                "Applies-to Doc. Type" := VendLedgEntry."Document Type";
                                                                "Applies-to Doc. No." := VendLedgEntry."Document No.";
                                                              END;
                                                              CLEAR(ApplyVendEntries);
                                                            END;

                                                   CaptionML=[ENU=Applies-to Doc. No.;
                                                              DEA=Ausgleich mit Belegnr.] }
    { 55  ;   ;Bal. Account No.    ;Code20        ;TableRelation=IF (Bal. Account Type=CONST(G/L Account)) "G/L Account"
                                                                 ELSE IF (Bal. Account Type=CONST(Bank Account)) "Bank Account";
                                                   OnValidate=BEGIN
                                                                IF "Bal. Account No." <> '' THEN
                                                                  CASE "Bal. Account Type" OF
                                                                    "Bal. Account Type"::"G/L Account":
                                                                      BEGIN
                                                                        GLAcc.GET("Bal. Account No.");
                                                                        GLAcc.CheckGLAcc;
                                                                        GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                      END;
                                                                    "Bal. Account Type"::"Bank Account":
                                                                      BEGIN
                                                                        BankAcc.GET("Bal. Account No.");
                                                                        BankAcc.TESTFIELD(Blocked,FALSE);
                                                                        BankAcc.TESTFIELD("Currency Code","Currency Code");
                                                                      END;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Bal. Account No.;
                                                              DEA=Gegenkontonr.] }
    { 56  ;   ;Recalculate Invoice Disc.;Boolean  ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Purchase Line" WHERE (Document Type=FIELD(Document Type),
                                                                                            Document No.=FIELD(No.),
                                                                                            Recalculate Invoice Disc.=CONST(Yes)));
                                                   CaptionML=[ENU=Recalculate Invoice Disc.;
                                                              DEA=Rechnungsrabatt neu berechnen];
                                                   Editable=No }
    { 57  ;   ;Receive             ;Boolean       ;CaptionML=[ENU=Receive;
                                                              DEA=Wareneingang] }
    { 58  ;   ;Invoice             ;Boolean       ;CaptionML=[ENU=Invoice;
                                                              DEA=Rechnung] }
    { 59  ;   ;Print Posted Documents;Boolean     ;CaptionML=[ENU=Print Posted Documents;
                                                              DEA=Gebuchte Belege drucken] }
    { 60  ;   ;Amount              ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line".Amount WHERE (Document Type=FIELD(Document Type),
                                                                                                 Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount;
                                                              DEA=Betrag];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 61  ;   ;Amount Including VAT;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Amount Including VAT" WHERE (Document Type=FIELD(Document Type),
                                                                                                                 Document No.=FIELD(No.)));
                                                   CaptionML=[ENU=Amount Including VAT;
                                                              DEA=Betrag inkl. MwSt.];
                                                   Editable=No;
                                                   AutoFormatType=1;
                                                   AutoFormatExpr="Currency Code" }
    { 62  ;   ;Receiving No.       ;Code20        ;CaptionML=[ENU=Receiving No.;
                                                              DEA=Liefernr.] }
    { 63  ;   ;Posting No.         ;Code20        ;CaptionML=[ENU=Posting No.;
                                                              DEA=Buchungsnr.] }
    { 64  ;   ;Last Receiving No.  ;Code20        ;TableRelation="Purch. Rcpt. Header";
                                                   CaptionML=[ENU=Last Receiving No.;
                                                              DEA=Letzte Lieferscheinnr.];
                                                   Editable=No }
    { 65  ;   ;Last Posting No.    ;Code20        ;TableRelation="Purch. Inv. Header";
                                                   CaptionML=[ENU=Last Posting No.;
                                                              DEA=Letzte Buchungsnr.];
                                                   Editable=No }
    { 66  ;   ;Vendor Order No.    ;Code35        ;CaptionML=[ENU=Vendor Order No.;
                                                              DEA=Kred.-Bestellnr.] }
    { 67  ;   ;Vendor Shipment No. ;Code35        ;CaptionML=[ENU=Vendor Shipment No.;
                                                              DEA=Kred.-Lieferungsnr.] }
    { 68  ;   ;Vendor Invoice No.  ;Code35        ;CaptionML=[ENU=Vendor Invoice No.;
                                                              DEA=Kred.-Rechnungsnr.] }
    { 69  ;   ;Vendor Cr. Memo No. ;Code35        ;CaptionML=[ENU=Vendor Cr. Memo No.;
                                                              DEA=Kred.-Gutschriftsnr.] }
    { 70  ;   ;VAT Registration No.;Text20        ;CaptionML=[ENU=VAT Registration No.;
                                                              DEA=USt-IdNr.] }
    { 72  ;   ;Sell-to Customer No.;Code20        ;TableRelation=Customer;
                                                   OnValidate=BEGIN
                                                                IF ("Document Type" = "Document Type"::Order) AND
                                                                   (xRec."Sell-to Customer No." <> "Sell-to Customer No.")
                                                                THEN BEGIN
                                                                  PurchLine.SETRANGE("Document Type",PurchLine."Document Type"::Order);
                                                                  PurchLine.SETRANGE("Document No.","No.");
                                                                  PurchLine.SETFILTER("Sales Order Line No.",'<>0');
                                                                  IF NOT PurchLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Sell-to Customer No."));

                                                                  PurchLine.SETRANGE("Sales Order Line No.");
                                                                  PurchLine.SETFILTER("Special Order Sales Line No.",'<>0');
                                                                  IF NOT PurchLine.ISEMPTY THEN
                                                                    ERROR(
                                                                      Text006,
                                                                      FIELDCAPTION("Sell-to Customer No."));
                                                                END;

                                                                IF "Sell-to Customer No." = '' THEN
                                                                  VALIDATE("Location Code",UserSetupMgt.GetLocation(1,'',"Responsibility Center"))
                                                                ELSE
                                                                  VALIDATE("Ship-to Code",'');
                                                              END;

                                                   CaptionML=[ENU=Sell-to Customer No.;
                                                              DEA=Verk. an Deb.-Nr.] }
    { 73  ;   ;Reason Code         ;Code10        ;TableRelation="Reason Code";
                                                   CaptionML=[ENU=Reason Code;
                                                              DEA=Ursachencode] }
    { 74  ;   ;Gen. Bus. Posting Group;Code10     ;TableRelation="Gen. Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF (xRec."Buy-from Vendor No." = "Buy-from Vendor No.") AND
                                                                   (xRec."Gen. Bus. Posting Group" <> "Gen. Bus. Posting Group")
                                                                THEN BEGIN
                                                                  IF GenBusPostingGrp.ValidateVatBusPostingGroup(GenBusPostingGrp,"Gen. Bus. Posting Group") THEN
                                                                    "VAT Bus. Posting Group" := GenBusPostingGrp."Def. VAT Bus. Posting Group";
                                                                  RecreatePurchLines(FIELDCAPTION("Gen. Bus. Posting Group"));
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Gen. Bus. Posting Group;
                                                              DEA=Gesch„ftsbuchungsgruppe] }
    { 76  ;   ;Transaction Type    ;Code10        ;TableRelation="Transaction Type";
                                                   OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION("Transaction Type"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Transaction Type;
                                                              DEA=Art des Gesch„ftes] }
    { 77  ;   ;Transport Method    ;Code10        ;TableRelation="Transport Method";
                                                   OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION("Transport Method"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Transport Method;
                                                              DEA=Verkehrszweig] }
    { 78  ;   ;VAT Country/Region Code;Code10     ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=VAT Country/Region Code;
                                                              DEA=MwSt.-L„nder-/Regionscode] }
    { 79  ;   ;Buy-from Vendor Name;Text50        ;CaptionML=[ENU=Buy-from Vendor Name;
                                                              DEA=Eink. von Name] }
    { 80  ;   ;Buy-from Vendor Name 2;Text50      ;CaptionML=[ENU=Buy-from Vendor Name 2;
                                                              DEA=Eink. von Name 2] }
    { 81  ;   ;Buy-from Address    ;Text50        ;CaptionML=[ENU=Buy-from Address;
                                                              DEA=Eink. von Adresse] }
    { 82  ;   ;Buy-from Address 2  ;Text50        ;CaptionML=[ENU=Buy-from Address 2;
                                                              DEA=Eink. von Adresse 2] }
    { 83  ;   ;Buy-from City       ;Text30        ;TableRelation=IF (Buy-from Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Buy-from Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Buy-from Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(
                                                                  "Buy-from City","Buy-from Post Code","Buy-from County","Buy-from Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Buy-from City;
                                                              DEA=Eink. von Ort] }
    { 84  ;   ;Buy-from Contact    ;Text50        ;CaptionML=[ENU=Buy-from Contact;
                                                              DEA=Eink. von Kontakt] }
    { 85  ;   ;Pay-to Post Code    ;Code20        ;TableRelation=IF (Pay-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Pay-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Pay-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Pay-to Post Code;
                                                              DEA=Zahlung an PLZ-Code] }
    { 86  ;   ;Pay-to County       ;Text30        ;CaptionML=[ENU=Pay-to County;
                                                              DEA=Zahlung an Bundesregion] }
    { 87  ;   ;Pay-to Country/Region Code;Code10  ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Pay-to Country/Region Code;
                                                              DEA=Zahlung an L„nder-/Regionscode] }
    { 88  ;   ;Buy-from Post Code  ;Code20        ;TableRelation=IF (Buy-from Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Buy-from Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Buy-from Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Buy-from City","Buy-from Post Code","Buy-from County","Buy-from Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Buy-from Post Code;
                                                              DEA=Eink. von PLZ-Code] }
    { 89  ;   ;Buy-from County     ;Text30        ;CaptionML=[ENU=Buy-from County;
                                                              DEA=Eink. von Bundesregion] }
    { 90  ;   ;Buy-from Country/Region Code;Code10;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Buy-from Country/Region Code;
                                                              DEA=Eink. von L„nder-/Regionscode] }
    { 91  ;   ;Ship-to Post Code   ;Code20        ;TableRelation=IF (Ship-to Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Ship-to Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Ship-to Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(
                                                                  "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Ship-to Post Code;
                                                              DEA=Lief. an PLZ-Code] }
    { 92  ;   ;Ship-to County      ;Text30        ;CaptionML=[ENU=Ship-to County;
                                                              DEA=Lief. an Bundesregion] }
    { 93  ;   ;Ship-to Country/Region Code;Code10 ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Ship-to Country/Region Code;
                                                              DEA=Lief. an L„nder-/Regionscode] }
    { 94  ;   ;Bal. Account Type   ;Option        ;CaptionML=[ENU=Bal. Account Type;
                                                              DEA=Gegenkontoart];
                                                   OptionCaptionML=[ENU=G/L Account,Bank Account;
                                                                    DEA=Sachkonto,Bankkonto];
                                                   OptionString=G/L Account,Bank Account }
    { 95  ;   ;Order Address Code  ;Code10        ;TableRelation="Order Address".Code WHERE (Vendor No.=FIELD(Buy-from Vendor No.));
                                                   OnValidate=BEGIN
                                                                IF "Order Address Code" <> '' THEN BEGIN
                                                                  OrderAddr.GET("Buy-from Vendor No.","Order Address Code");
                                                                  "Buy-from Vendor Name" := OrderAddr.Name;
                                                                  "Buy-from Vendor Name 2" := OrderAddr."Name 2";
                                                                  "Buy-from Address" := OrderAddr.Address;
                                                                  "Buy-from Address 2" := OrderAddr."Address 2";
                                                                  "Buy-from City" := OrderAddr.City;
                                                                  "Buy-from Contact" := OrderAddr.Contact;
                                                                  "Buy-from Post Code" := OrderAddr."Post Code";
                                                                  "Buy-from County" := OrderAddr.County;
                                                                  "Buy-from Country/Region Code" := OrderAddr."Country/Region Code";

                                                                  IF ("Document Type" = "Document Type"::"Return Order") OR
                                                                     ("Document Type" = "Document Type"::"Credit Memo")
                                                                  THEN BEGIN
                                                                    "Ship-to Name" := OrderAddr.Name;
                                                                    "Ship-to Name 2" := OrderAddr."Name 2";
                                                                    "Ship-to Address" := OrderAddr.Address;
                                                                    "Ship-to Address 2" := OrderAddr."Address 2";
                                                                    "Ship-to City" := OrderAddr.City;
                                                                    "Ship-to Post Code" := OrderAddr."Post Code";
                                                                    "Ship-to County" := OrderAddr.County;
                                                                    "Ship-to Country/Region Code" := OrderAddr."Country/Region Code";
                                                                    "Ship-to Contact" := OrderAddr.Contact;
                                                                  END
                                                                END ELSE BEGIN
                                                                  GetVend("Buy-from Vendor No.");
                                                                  "Buy-from Vendor Name" := Vend.Name;
                                                                  "Buy-from Vendor Name 2" := Vend."Name 2";
                                                                  "Buy-from Address" := Vend.Address;
                                                                  "Buy-from Address 2" := Vend."Address 2";
                                                                  "Buy-from City" := Vend.City;
                                                                  "Buy-from Contact" := Vend.Contact;
                                                                  "Buy-from Post Code" := Vend."Post Code";
                                                                  "Buy-from County" := Vend.County;
                                                                  "Buy-from Country/Region Code" := Vend."Country/Region Code";

                                                                  "Registration No." := Vend."Registration No.";

                                                                  IF ("Document Type" = "Document Type"::"Return Order") OR
                                                                     ("Document Type" = "Document Type"::"Credit Memo")
                                                                  THEN BEGIN
                                                                    "Ship-to Name" := Vend.Name;
                                                                    "Ship-to Name 2" := Vend."Name 2";
                                                                    "Ship-to Address" := Vend.Address;
                                                                    "Ship-to Address 2" := Vend."Address 2";
                                                                    "Ship-to City" := Vend.City;
                                                                    "Ship-to Post Code" := Vend."Post Code";
                                                                    "Ship-to County" := Vend.County;
                                                                    "Ship-to Country/Region Code" := Vend."Country/Region Code";
                                                                    "Ship-to Contact" := Vend.Contact;
                                                                    "Shipment Method Code" := Vend."Shipment Method Code";
                                                                    IF Vend."Location Code" <> '' THEN
                                                                      VALIDATE("Location Code",Vend."Location Code");
                                                                  END
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Order Address Code;
                                                              DEA=Bestelladresscode] }
    { 97  ;   ;Entry Point         ;Code10        ;TableRelation="Entry/Exit Point";
                                                   OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION("Entry Point"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Entry Point;
                                                              DEA=Einstiegspunkt] }
    { 98  ;   ;Correction          ;Boolean       ;CaptionML=[ENU=Correction;
                                                              DEA=Storno] }
    { 99  ;   ;Document Date       ;Date          ;OnValidate=BEGIN
                                                                IF xRec."Document Date" <> "Document Date" THEN
                                                                  UpdateDocumentDate := TRUE;
                                                                VALIDATE("Payment Terms Code");
                                                                VALIDATE("Prepmt. Payment Terms Code");
                                                              END;

                                                   CaptionML=[ENU=Document Date;
                                                              DEA=Belegdatum] }
    { 101 ;   ;Area                ;Code10        ;TableRelation=Area;
                                                   OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION(Area),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Area;
                                                              DEA=Bestimmungsregion] }
    { 102 ;   ;Transaction Specification;Code10   ;TableRelation="Transaction Specification";
                                                   OnValidate=BEGIN
                                                                UpdatePurchLines(FIELDCAPTION("Transaction Specification"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Transaction Specification;
                                                              DEA=Verfahren] }
    { 104 ;   ;Payment Method Code ;Code10        ;TableRelation="Payment Method";
                                                   OnValidate=BEGIN
                                                                PaymentMethod.INIT;
                                                                IF "Payment Method Code" <> '' THEN
                                                                  PaymentMethod.GET("Payment Method Code");
                                                                "Bal. Account Type" := PaymentMethod."Bal. Account Type";
                                                                "Bal. Account No." := PaymentMethod."Bal. Account No.";
                                                                IF "Bal. Account No." <> '' THEN BEGIN
                                                                  TESTFIELD("Applies-to Doc. No.",'');
                                                                  TESTFIELD("Applies-to ID",'');
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Payment Method Code;
                                                              DEA=Zahlungsformcode] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              DEA=Nummernserie];
                                                   Editable=No }
    { 108 ;   ;Posting No. Series  ;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Posting No. Series" <> '' THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  TestNoSeries;
                                                                  NoSeriesMgt.TestSeries(GetPostingNoSeriesCode,"Posting No. Series");
                                                                END;
                                                                TESTFIELD("Posting No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH PurchHeader DO BEGIN
                                                                PurchHeader := Rec;
                                                                PurchSetup.GET;
                                                                TestNoSeries;
                                                                IF NoSeriesMgt.LookupSeries(GetPostingNoSeriesCode,"Posting No. Series") THEN
                                                                  VALIDATE("Posting No. Series");
                                                                Rec := PurchHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Posting No. Series;
                                                              DEA=Buchungsnr.-Serie] }
    { 109 ;   ;Receiving No. Series;Code10        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Receiving No. Series" <> '' THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  PurchSetup.TESTFIELD("Posted Receipt Nos.");
                                                                  NoSeriesMgt.TestSeries(PurchSetup."Posted Receipt Nos.","Receiving No. Series");
                                                                END;
                                                                TESTFIELD("Receiving No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH PurchHeader DO BEGIN
                                                                PurchHeader := Rec;
                                                                PurchSetup.GET;
                                                                PurchSetup.TESTFIELD("Posted Receipt Nos.");
                                                                IF NoSeriesMgt.LookupSeries(PurchSetup."Posted Receipt Nos.","Receiving No. Series") THEN
                                                                  VALIDATE("Receiving No. Series");
                                                                Rec := PurchHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Receiving No. Series;
                                                              DEA=Lieferungsnr.-Serie] }
    { 114 ;   ;Tax Area Code       ;Code20        ;TableRelation="Tax Area";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfPurchLinesExist(FIELDCAPTION("Tax Area Code"));
                                                              END;

                                                   CaptionML=[ENU=Tax Area Code;
                                                              DEA=Steuergebietscode] }
    { 115 ;   ;Tax Liable          ;Boolean       ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                MessageIfPurchLinesExist(FIELDCAPTION("Tax Liable"));
                                                              END;

                                                   CaptionML=[ENU=Tax Liable;
                                                              DEA=Steuerpflichtig] }
    { 116 ;   ;VAT Bus. Posting Group;Code10      ;TableRelation="VAT Business Posting Group";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF (xRec."Buy-from Vendor No." = "Buy-from Vendor No.") AND
                                                                   (xRec."VAT Bus. Posting Group" <> "VAT Bus. Posting Group")
                                                                THEN
                                                                  RecreatePurchLines(FIELDCAPTION("VAT Bus. Posting Group"));
                                                              END;

                                                   CaptionML=[ENU=VAT Bus. Posting Group;
                                                              DEA=MwSt.-Gesch„ftsbuchungsgruppe] }
    { 118 ;   ;Applies-to ID       ;Code50        ;OnValidate=VAR
                                                                TempVendLedgEntry@1000 : Record 25;
                                                              BEGIN
                                                                IF "Applies-to ID" <> '' THEN
                                                                  TESTFIELD("Bal. Account No.",'');
                                                                IF ("Applies-to ID" <> xRec."Applies-to ID") AND (xRec."Applies-to ID" <> '') THEN BEGIN
                                                                  VendLedgEntry.SETCURRENTKEY("Vendor No.",Open);
                                                                  VendLedgEntry.SETRANGE("Vendor No.","Pay-to Vendor No.");
                                                                  VendLedgEntry.SETRANGE(Open,TRUE);
                                                                  VendLedgEntry.SETRANGE("Applies-to ID",xRec."Applies-to ID");
                                                                  IF VendLedgEntry.FINDFIRST THEN
                                                                    VendEntrySetApplID.SetApplId(VendLedgEntry,TempVendLedgEntry,'');
                                                                  VendLedgEntry.RESET;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Applies-to ID;
                                                              DEA=Ausgleichs-ID] }
    { 119 ;   ;VAT Base Discount % ;Decimal       ;OnValidate=BEGIN
                                                                GLSetup.GET;
                                                                IF "VAT Base Discount %" > GLSetup."VAT Tolerance %" THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed :=
                                                                      CONFIRM(
                                                                        Text007 +
                                                                        Text008,FALSE,
                                                                        FIELDCAPTION("VAT Base Discount %"),
                                                                        GLSetup.FIELDCAPTION("VAT Tolerance %"),
                                                                        GLSetup.TABLECAPTION);
                                                                  IF NOT Confirmed THEN
                                                                    "VAT Base Discount %" := xRec."VAT Base Discount %";
                                                                END;

                                                                IF ("VAT Base Discount %" = xRec."VAT Base Discount %") AND
                                                                   (CurrFieldNo <> 0)
                                                                THEN
                                                                  EXIT;

                                                                PurchLine.SETRANGE("Document Type","Document Type");
                                                                PurchLine.SETRANGE("Document No.","No.");
                                                                PurchLine.SETFILTER(Type,'<>%1',PurchLine.Type::" ");
                                                                PurchLine.SETFILTER(Quantity,'<>0');
                                                                PurchLine.LOCKTABLE;
                                                                IF PurchLine.FINDSET THEN BEGIN
                                                                  MODIFY;
                                                                  REPEAT
                                                                    PurchLine.UpdateAmounts;
                                                                    PurchLine.MODIFY;
                                                                  UNTIL PurchLine.NEXT = 0;
                                                                END;
                                                                PurchLine.RESET;
                                                              END;

                                                   CaptionML=[ENU=VAT Base Discount %;
                                                              DEA=MwSt.-Bemessungsgr. Skonto %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 120 ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionCaptionML=[ENU=Open,Released,Pending Approval,Pending Prepayment;
                                                                    DEA=Offen,Freigegeben,Genehmigung ausstehend,Vorauszahlung ausstehend];
                                                   OptionString=Open,Released,Pending Approval,Pending Prepayment;
                                                   Editable=No }
    { 121 ;   ;Invoice Discount Calculation;Option;CaptionML=[ENU=Invoice Discount Calculation;
                                                              DEA=Rechnungsrab.-Berechnung];
                                                   OptionCaptionML=[ENU=None,%,Amount;
                                                                    DEA=Kein,%,Betrag];
                                                   OptionString=None,%,Amount;
                                                   Editable=No }
    { 122 ;   ;Invoice Discount Value;Decimal     ;CaptionML=[ENU=Invoice Discount Value;
                                                              DEA=Rechnungsrab.-Wert];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 123 ;   ;Send IC Document    ;Boolean       ;OnValidate=BEGIN
                                                                IF "Send IC Document" THEN BEGIN
                                                                  TESTFIELD("Buy-from IC Partner Code");
                                                                  TESTFIELD("IC Direction","IC Direction"::Outgoing);
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Send IC Document;
                                                              DEA=IC-Beleg senden] }
    { 124 ;   ;IC Status           ;Option        ;CaptionML=[ENU=IC Status;
                                                              DEA=IC-Status];
                                                   OptionCaptionML=[ENU=New,Pending,Sent;
                                                                    DEA=Neu,Offen,Gesendet];
                                                   OptionString=New,Pending,Sent }
    { 125 ;   ;Buy-from IC Partner Code;Code20    ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=Buy-from IC Partner Code;
                                                              DEA=Eink. von IC-Partnercode];
                                                   Editable=No }
    { 126 ;   ;Pay-to IC Partner Code;Code20      ;TableRelation="IC Partner";
                                                   CaptionML=[ENU=Pay-to IC Partner Code;
                                                              DEA=Zahlung an IC-Partnercode];
                                                   Editable=No }
    { 129 ;   ;IC Direction        ;Option        ;OnValidate=BEGIN
                                                                IF "IC Direction" = "IC Direction"::Incoming THEN
                                                                  "Send IC Document" := FALSE;
                                                              END;

                                                   CaptionML=[ENU=IC Direction;
                                                              DEA=IC-Richtung];
                                                   OptionCaptionML=[ENU=Outgoing,Incoming;
                                                                    DEA=Ausgehend,Eingehend];
                                                   OptionString=Outgoing,Incoming }
    { 130 ;   ;Prepayment No.      ;Code20        ;CaptionML=[ENU=Prepayment No.;
                                                              DEA=Vorauszahlungsnr.] }
    { 131 ;   ;Last Prepayment No. ;Code20        ;TableRelation="Purch. Inv. Header";
                                                   CaptionML=[ENU=Last Prepayment No.;
                                                              DEA=Letzte Vorauszahlungsnr.] }
    { 132 ;   ;Prepmt. Cr. Memo No.;Code20        ;CaptionML=[ENU=Prepmt. Cr. Memo No.;
                                                              DEA=Vorauszahlungs-Gutschriftnr.] }
    { 133 ;   ;Last Prepmt. Cr. Memo No.;Code20   ;TableRelation="Purch. Cr. Memo Hdr.";
                                                   CaptionML=[ENU=Last Prepmt. Cr. Memo No.;
                                                              DEA=Letzte Vorauszahlungs-Gutschriftnr.] }
    { 134 ;   ;Prepayment %        ;Decimal       ;OnValidate=BEGIN
                                                                IF xRec."Prepayment %" <> "Prepayment %" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Prepayment %"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Prepayment %;
                                                              DEA=Vorauszahlung %];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 135 ;   ;Prepayment No. Series;Code10       ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepayment No. Series" <> '' THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  PurchSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series");
                                                                END;
                                                                TESTFIELD("Prepayment No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH PurchHeader DO BEGIN
                                                                PurchHeader := Rec;
                                                                PurchSetup.GET;
                                                                PurchSetup.TESTFIELD("Posted Prepmt. Inv. Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepayment No. Series") THEN
                                                                  VALIDATE("Prepayment No. Series");
                                                                Rec := PurchHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Prepayment No. Series;
                                                              DEA=Vorauszahlung Nummernserie] }
    { 136 ;   ;Compress Prepayment ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[ENU=Compress Prepayment;
                                                              DEA=Vorauszahlung komprimieren] }
    { 137 ;   ;Prepayment Due Date ;Date          ;CaptionML=[ENU=Prepayment Due Date;
                                                              DEA=F„lligkeitsdatum Vorauszahlung] }
    { 138 ;   ;Prepmt. Cr. Memo No. Series;Code10 ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Prepmt. Cr. Memo No. Series" <> '' THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  PurchSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                  NoSeriesMgt.TestSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series");
                                                                END;
                                                                TESTFIELD("Prepmt. Cr. Memo No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH PurchHeader DO BEGIN
                                                                PurchHeader := Rec;
                                                                PurchSetup.GET;
                                                                PurchSetup.TESTFIELD("Posted Prepmt. Cr. Memo Nos.");
                                                                IF NoSeriesMgt.LookupSeries(GetPostingPrepaymentNoSeriesCode,"Prepmt. Cr. Memo No. Series") THEN
                                                                  VALIDATE("Prepmt. Cr. Memo No. Series");
                                                                Rec := PurchHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Prepmt. Cr. Memo No. Series;
                                                              DEA=Vorauszahlungsgutschrift Nummernserie] }
    { 139 ;   ;Prepmt. Posting Description;Text50 ;CaptionML=[ENU=Prepmt. Posting Description;
                                                              DEA=Vorauszahlungs-Buchungsbeschreibung] }
    { 142 ;   ;Prepmt. Pmt. Discount Date;Date    ;CaptionML=[ENU=Prepmt. Pmt. Discount Date;
                                                              DEA=Skontodatum Vorauszahlung] }
    { 143 ;   ;Prepmt. Payment Terms Code;Code10  ;TableRelation="Payment Terms";
                                                   OnValidate=VAR
                                                                PaymentTerms@1000 : Record 3;
                                                              BEGIN
                                                                IF ("Prepmt. Payment Terms Code" <> '') AND ("Document Date" <> 0D) THEN BEGIN
                                                                  PaymentTerms.GET("Prepmt. Payment Terms Code");
                                                                  IF (("Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"]) AND
                                                                      NOT PaymentTerms."Calc. Pmt. Disc. on Cr. Memos")
                                                                  THEN BEGIN
                                                                    VALIDATE("Prepayment Due Date","Document Date");
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END ELSE BEGIN
                                                                    "Prepayment Due Date" := CALCDATE(PaymentTerms."Due Date Calculation","Document Date");
                                                                    "Prepmt. Pmt. Discount Date" := CALCDATE(PaymentTerms."Discount Date Calculation","Document Date");
                                                                    IF NOT UpdateDocumentDate THEN
                                                                      VALIDATE("Prepmt. Payment Discount %",PaymentTerms."Discount %")
                                                                  END;
                                                                END ELSE BEGIN
                                                                  VALIDATE("Prepayment Due Date","Document Date");
                                                                  IF NOT UpdateDocumentDate THEN BEGIN
                                                                    VALIDATE("Prepmt. Pmt. Discount Date",0D);
                                                                    VALIDATE("Prepmt. Payment Discount %",0);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Payment Terms Code;
                                                              DEA=Zlg.-Bedingungscode Vorauszahlung] }
    { 144 ;   ;Prepmt. Payment Discount %;Decimal ;OnValidate=BEGIN
                                                                IF NOT (CurrFieldNo IN [0,FIELDNO("Posting Date"),FIELDNO("Document Date")]) THEN
                                                                  TESTFIELD(Status,Status::Open);
                                                                GLSetup.GET;
                                                                IF "Payment Discount %" < GLSetup."VAT Tolerance %" THEN
                                                                  "VAT Base Discount %" := "Payment Discount %"
                                                                ELSE
                                                                  "VAT Base Discount %" := GLSetup."VAT Tolerance %";
                                                                VALIDATE("VAT Base Discount %");
                                                              END;

                                                   CaptionML=[ENU=Prepmt. Payment Discount %;
                                                              DEA=Skonto % Vorauszahlung];
                                                   DecimalPlaces=0:5;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 151 ;   ;Quote No.           ;Code20        ;CaptionML=[ENU=Quote No.;
                                                              DEA=Angebotsnr.];
                                                   Editable=No }
    { 160 ;   ;Job Queue Status    ;Option        ;OnLookup=VAR
                                                              JobQueueEntry@1000 : Record 472;
                                                            BEGIN
                                                              IF "Job Queue Status" = "Job Queue Status"::" " THEN
                                                                EXIT;
                                                              JobQueueEntry.ShowStatusMsg("Job Queue Entry ID");
                                                            END;

                                                   CaptionML=[ENU=Job Queue Status;
                                                              DEA=Aufgabenwarteschlange - Status];
                                                   OptionCaptionML=[ENU=" ,Scheduled for Posting,Error,Posting";
                                                                    DEA=" ,Geplant fr Buchung,Fehler,Buchung"];
                                                   OptionString=[ ,Scheduled for Posting,Error,Posting];
                                                   Editable=No }
    { 161 ;   ;Job Queue Entry ID  ;GUID          ;CaptionML=[ENU=Job Queue Entry ID;
                                                              DEA=Aufgabenwarteschlange - Posten-ID];
                                                   Editable=No }
    { 165 ;   ;Incoming Document Entry No.;Integer;TableRelation="Incoming Document";
                                                   OnValidate=VAR
                                                                IncomingDocument@1000 : Record 130;
                                                              BEGIN
                                                                IF "Incoming Document Entry No." = xRec."Incoming Document Entry No." THEN
                                                                  EXIT;
                                                                IF "Incoming Document Entry No." = 0 THEN
                                                                  IncomingDocument.RemoveReferenceToWorkingDocument(xRec."Incoming Document Entry No.")
                                                                ELSE
                                                                  IncomingDocument.SetPurchDoc(Rec);
                                                              END;

                                                   CaptionML=[ENU=Incoming Document Entry No.;
                                                              DEA=Lfd. Nr. eingehender Beleg] }
    { 170 ;   ;Creditor No.        ;Code20        ;CaptionML=[ENU=Creditor No.;
                                                              DEA=Gl„ubiger-Identifikationsnummer];
                                                   Numeric=Yes }
    { 171 ;   ;Payment Reference   ;Code50        ;OnValidate=BEGIN
                                                                IF "Payment Reference" <> '' THEN
                                                                  TESTFIELD("Creditor No.");
                                                              END;

                                                   CaptionML=[ENU=Payment Reference;
                                                              DEA=Zahlungsreferenz];
                                                   Numeric=Yes }
    { 480 ;   ;Dimension Set ID    ;Integer       ;TableRelation="Dimension Set Entry";
                                                   OnLookup=BEGIN
                                                              ShowDocDim;
                                                            END;

                                                   CaptionML=[ENU=Dimension Set ID;
                                                              DEA=Dimensionssatz-ID];
                                                   Editable=No }
    { 1305;   ;Invoice Discount Amount;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Purchase Line"."Inv. Discount Amount" WHERE (Document No.=FIELD(No.),
                                                                                                                 Document Type=FIELD(Document Type)));
                                                   CaptionML=[ENU=Invoice Discount Amount;
                                                              DEA=Rechnungsrab.-Betrag];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5043;   ;No. of Archived Versions;Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Max("Purchase Header Archive"."Version No." WHERE (Document Type=FIELD(Document Type),
                                                                                                                  No.=FIELD(No.),
                                                                                                                  Doc. No. Occurrence=FIELD(Doc. No. Occurrence)));
                                                   CaptionML=[ENU=No. of Archived Versions;
                                                              DEA=Anz. archivierter Versionen];
                                                   Editable=No }
    { 5048;   ;Doc. No. Occurrence ;Integer       ;CaptionML=[ENU=Doc. No. Occurrence;
                                                              DEA=Belegnr.-H„ufigkeit] }
    { 5050;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   OnValidate=BEGIN
                                                                CreateDim(
                                                                  DATABASE::Campaign,"Campaign No.",
                                                                  DATABASE::Vendor,"Pay-to Vendor No.",
                                                                  DATABASE::"Salesperson/Purchaser","Purchaser Code",
                                                                  DATABASE::"Responsibility Center","Responsibility Center");
                                                              END;

                                                   CaptionML=[ENU=Campaign No.;
                                                              DEA=Kampagnennr.] }
    { 5052;   ;Buy-from Contact No.;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1000 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF ("Buy-from Contact No." <> xRec."Buy-from Contact No.") AND
                                                                   (xRec."Buy-from Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Buy-from Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    PurchLine.SETRANGE("Document Type","Document Type");
                                                                    PurchLine.SETRANGE("Document No.","No.");
                                                                    IF ("Buy-from Contact No." = '') AND ("Buy-from Vendor No." = '') THEN BEGIN
                                                                      IF NOT PurchLine.ISEMPTY THEN
                                                                        ERROR(
                                                                          Text005,
                                                                          FIELDCAPTION("Buy-from Contact No."));
                                                                      INIT;
                                                                      PurchSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    Rec := xRec;
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Buy-from Vendor No." <> '') AND ("Buy-from Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Buy-from Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
                                                                  ContBusinessRelation.SETRANGE("No.","Buy-from Vendor No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    IF ContBusinessRelation."Contact No." <> Cont."Company No." THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Buy-from Vendor No.");
                                                                END;

                                                                UpdateBuyFromVend("Buy-from Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1001 : Record 5050;
                                                              ContBusinessRelation@1000 : Record 5054;
                                                            BEGIN
                                                              IF "Buy-from Vendor No." <> '' THEN
                                                                IF Cont.GET("Buy-from Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
                                                                  ContBusinessRelation.SETRANGE("No.","Buy-from Vendor No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Buy-from Contact No." <> '' THEN
                                                                IF Cont.GET("Buy-from Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Buy-from Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Buy-from Contact No.;
                                                              DEA=Eink. von Kontaktnr.] }
    { 5053;   ;Pay-to Contact No.  ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                ContBusinessRelation@1004 : Record 5054;
                                                                Cont@1002 : Record 5050;
                                                              BEGIN
                                                                TESTFIELD(Status,Status::Open);

                                                                IF ("Pay-to Contact No." <> xRec."Pay-to Contact No.") AND
                                                                   (xRec."Pay-to Contact No." <> '')
                                                                THEN BEGIN
                                                                  IF HideValidationDialog THEN
                                                                    Confirmed := TRUE
                                                                  ELSE
                                                                    Confirmed := CONFIRM(Text004,FALSE,FIELDCAPTION("Pay-to Contact No."));
                                                                  IF Confirmed THEN BEGIN
                                                                    PurchLine.SETRANGE("Document Type","Document Type");
                                                                    PurchLine.SETRANGE("Document No.","No.");
                                                                    IF ("Pay-to Contact No." = '') AND ("Pay-to Vendor No." = '') THEN BEGIN
                                                                      IF NOT PurchLine.ISEMPTY THEN
                                                                        ERROR(
                                                                          Text005,
                                                                          FIELDCAPTION("Pay-to Contact No."));
                                                                      INIT;
                                                                      PurchSetup.GET;
                                                                      "No. Series" := xRec."No. Series";
                                                                      InitRecord;
                                                                      InitNoSeries;
                                                                      EXIT;
                                                                    END;
                                                                  END ELSE BEGIN
                                                                    "Pay-to Contact No." := xRec."Pay-to Contact No.";
                                                                    EXIT;
                                                                  END;
                                                                END;

                                                                IF ("Pay-to Vendor No." <> '') AND ("Pay-to Contact No." <> '') THEN BEGIN
                                                                  Cont.GET("Pay-to Contact No.");
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
                                                                  ContBusinessRelation.SETRANGE("No.","Pay-to Vendor No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    IF ContBusinessRelation."Contact No." <> Cont."Company No." THEN
                                                                      ERROR(Text038,Cont."No.",Cont.Name,"Pay-to Vendor No.");
                                                                END;

                                                                UpdatePayToVend("Pay-to Contact No.");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1000 : Record 5050;
                                                              ContBusinessRelation@1001 : Record 5054;
                                                            BEGIN
                                                              IF "Pay-to Vendor No." <> '' THEN
                                                                IF Cont.GET("Pay-to Contact No.") THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.")
                                                                ELSE BEGIN
                                                                  ContBusinessRelation.RESET;
                                                                  ContBusinessRelation.SETCURRENTKEY("Link to Table","No.");
                                                                  ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
                                                                  ContBusinessRelation.SETRANGE("No.","Pay-to Vendor No.");
                                                                  IF ContBusinessRelation.FINDFIRST THEN
                                                                    Cont.SETRANGE("Company No.",ContBusinessRelation."Contact No.")
                                                                  ELSE
                                                                    Cont.SETRANGE("No.",'');
                                                                END;

                                                              IF "Pay-to Contact No." <> '' THEN
                                                                IF Cont.GET("Pay-to Contact No.") THEN ;
                                                              IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                xRec := Rec;
                                                                VALIDATE("Pay-to Contact No.",Cont."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Pay-to Contact No.;
                                                              DEA=Zahlung an Kontaktnr.] }
    { 5700;   ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF NOT UserSetupMgt.CheckRespCenter(1,"Responsibility Center") THEN
                                                                  ERROR(
                                                                    Text028,
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetPurchasesFilter);

                                                                "Location Code" := UserSetupMgt.GetLocation(1,'',"Responsibility Center");
                                                                IF "Location Code" = '' THEN BEGIN
                                                                  IF InvtSetup.GET THEN
                                                                    "Inbound Whse. Handling Time" := InvtSetup."Inbound Whse. Handling Time";
                                                                END ELSE BEGIN
                                                                  IF Location.GET("Location Code") THEN;
                                                                  "Inbound Whse. Handling Time" := Location."Inbound Whse. Handling Time";
                                                                END;

                                                                UpdateShipToAddress;

                                                                CreateDim(
                                                                  DATABASE::"Responsibility Center","Responsibility Center",
                                                                  DATABASE::Vendor,"Pay-to Vendor No.",
                                                                  DATABASE::"Salesperson/Purchaser","Purchaser Code",
                                                                  DATABASE::Campaign,"Campaign No.");

                                                                IF xRec."Responsibility Center" <> "Responsibility Center" THEN BEGIN
                                                                  RecreatePurchLines(FIELDCAPTION("Responsibility Center"));
                                                                  "Assigned User ID" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Responsibility Center;
                                                              DEA=Zust„ndigkeitseinheitencode] }
    { 5752;   ;Completely Received ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Min("Purchase Line"."Completely Received" WHERE (Document Type=FIELD(Document Type),
                                                                                                                Document No.=FIELD(No.),
                                                                                                                Type=FILTER(<>' '),
                                                                                                                Location Code=FIELD(Location Filter)));
                                                   CaptionML=[ENU=Completely Received;
                                                              DEA=Komplettlieferung (Eingang)];
                                                   Editable=No }
    { 5753;   ;Posting from Whse. Ref.;Integer    ;AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Posting from Whse. Ref.;
                                                              DEA=Buchung von Lagerref.-Nr.] }
    { 5754;   ;Location Filter     ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Location;
                                                   CaptionML=[ENU=Location Filter;
                                                              DEA=Lagerortfilter] }
    { 5790;   ;Requested Receipt Date;Date        ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Promised Receipt Date" <> 0D THEN
                                                                  ERROR(
                                                                    Text034,
                                                                    FIELDCAPTION("Requested Receipt Date"),
                                                                    FIELDCAPTION("Promised Receipt Date"));

                                                                IF "Requested Receipt Date" <> xRec."Requested Receipt Date" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Requested Receipt Date"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 99000880=R;
                                                   CaptionML=[ENU=Requested Receipt Date;
                                                              DEA=Gewnschtes Wareneingangsdatum] }
    { 5791;   ;Promised Receipt Date;Date         ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Promised Receipt Date" <> xRec."Promised Receipt Date" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Promised Receipt Date"),CurrFieldNo <> 0);
                                                              END;

                                                   CaptionML=[ENU=Promised Receipt Date;
                                                              DEA=Zugesagtes Wareneingangsdatum] }
    { 5792;   ;Lead Time Calculation;DateFormula  ;OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Lead Time Calculation" <> xRec."Lead Time Calculation" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Lead Time Calculation"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 120=R;
                                                   CaptionML=[ENU=Lead Time Calculation;
                                                              DEA=Beschaffungszeit] }
    { 5793;   ;Inbound Whse. Handling Time;DateFormula;
                                                   OnValidate=BEGIN
                                                                TESTFIELD(Status,Status::Open);
                                                                IF "Inbound Whse. Handling Time" <> xRec."Inbound Whse. Handling Time" THEN
                                                                  UpdatePurchLines(FIELDCAPTION("Inbound Whse. Handling Time"),CurrFieldNo <> 0);
                                                              END;

                                                   AccessByPermission=TableData 14=R;
                                                   CaptionML=[ENU=Inbound Whse. Handling Time;
                                                              DEA=Eingeh. Lagerdurchlaufzeit] }
    { 5796;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              DEA=Datumsfilter] }
    { 5800;   ;Vendor Authorization No.;Code35    ;CaptionML=[ENU=Vendor Authorization No.;
                                                              DEA=Kreditorenbearbeitungsnr.] }
    { 5801;   ;Return Shipment No. ;Code20        ;CaptionML=[ENU=Return Shipment No.;
                                                              DEA=Rcklieferungsnr.] }
    { 5802;   ;Return Shipment No. Series;Code10  ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                IF "Return Shipment No. Series" <> '' THEN BEGIN
                                                                  PurchSetup.GET;
                                                                  PurchSetup.TESTFIELD("Posted Return Shpt. Nos.");
                                                                  NoSeriesMgt.TestSeries(PurchSetup."Posted Return Shpt. Nos.","Return Shipment No. Series");
                                                                END;
                                                                TESTFIELD("Return Shipment No.",'');
                                                              END;

                                                   OnLookup=BEGIN
                                                              WITH PurchHeader DO BEGIN
                                                                PurchHeader := Rec;
                                                                PurchSetup.GET;
                                                                PurchSetup.TESTFIELD("Posted Return Shpt. Nos.");
                                                                IF NoSeriesMgt.LookupSeries(PurchSetup."Posted Return Shpt. Nos.","Return Shipment No. Series") THEN
                                                                  VALIDATE("Return Shipment No. Series");
                                                                Rec := PurchHeader;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Return Shipment No. Series;
                                                              DEA=Rcklieferungsnr.-Serie] }
    { 5803;   ;Ship                ;Boolean       ;CaptionML=[ENU=Ship;
                                                              DEA=Warenausgang] }
    { 5804;   ;Last Return Shipment No.;Code20    ;TableRelation="Return Shipment Header";
                                                   CaptionML=[ENU=Last Return Shipment No.;
                                                              DEA=Letzte Rcklieferungsnr.];
                                                   Editable=No }
    { 9000;   ;Assigned User ID    ;Code50        ;TableRelation="User Setup";
                                                   OnValidate=BEGIN
                                                                IF NOT UserSetupMgt.CheckRespCenter2(1,"Responsibility Center","Assigned User ID") THEN
                                                                  ERROR(
                                                                    Text049,"Assigned User ID",
                                                                    RespCenter.TABLECAPTION,UserSetupMgt.GetPurchasesFilter2("Assigned User ID"));
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              DEA=Zugewiesene Benutzer-ID] }
    { 9001;   ;Pending Approvals   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Approval Entry" WHERE (Table ID=CONST(38),
                                                                                             Document Type=FIELD(Document Type),
                                                                                             Document No.=FIELD(No.),
                                                                                             Status=FILTER(Open|Created)));
                                                   CaptionML=[ENU=Pending Approvals;
                                                              DEA=Ausstehende Genehmigungen] }
    { 11000;  ;Registration No.    ;Text20        ;CaptionML=[ENU=Registration No.;
                                                              DEA=Steuernummer] }
    { 70000;  ;CM Is CMMS Purchase Order;Boolean  ;CaptionML=[ENU=Is CMMS Purchase Order;
                                                              DEA=Ist CMMS Bestellung] }
    { 70005;  ;CM Company          ;Text30        ;TableRelation=Company.Name;
                                                   OnValidate=VAR
                                                                CMGenMgt@1000000000 : Codeunit 70000;
                                                              BEGIN
                                                                //ENC
                                                                CMGenMgt.CMCompanyOnValidate(Rec);
                                                              END;

                                                   CaptionML=[ENU=Company;
                                                              DEA=Mandant] }
    { 70010;  ;CM Vendor No.       ;Code20        ;OnValidate=VAR
                                                                CMGenMgt@1000000000 : Codeunit 70000;
                                                              BEGIN
                                                                //ENC
                                                                CMGenMgt.CMVendorNoOnValidate(Rec);
                                                              END;

                                                   OnLookup=VAR
                                                              CMGenMgt@1000000000 : Codeunit 70000;
                                                            BEGIN
                                                              //ENC
                                                              CMGenMgt.CMVendorNoOnLookup(Rec);
                                                            END;

                                                   CaptionML=[ENU=Vender No.;
                                                              DEA=Kreditor Nr.] }
    { 90000;  ;IG Status Code      ;Code20        ;CaptionML=[ENU=Processing Status;
                                                              DEA=Bearbeitungsstatus];
                                                   Description=IG }
    { 90001;  ;IG Status Name      ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("IG Status Sequence Header".Description WHERE (Type=CONST(status),
                                                                                                                     Code=FIELD(IG Status Code)));
                                                   CaptionML=[ENU=Processing Status;
                                                              DEA=Bearbeitungsstatus];
                                                   Description=FF;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Document Type,No.                       ;Clustered=Yes }
    {    ;No.,Document Type                        }
    {    ;Document Type,Buy-from Vendor No.        }
    {    ;Document Type,Pay-to Vendor No.          }
    {    ;Buy-from Vendor No.                      }
    {    ;Incoming Document Entry No.              }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text003@1003 : TextConst 'ENU=You cannot rename a %1.;DEA=Sie k”nnen einen %1 nicht umbenennen.';
      Text004@1004 : TextConst 'ENU=Do you want to change %1?;DEA=M”chten Sie %1 „ndern?';
      Text005@1005 : TextConst 'ENU=You cannot reset %1 because the document still has one or more lines.;DEA=Sie k”nnen %1 nicht zurcksetzen, da der Beleg eine oder mehrere Zeilen enth„lt.';
      Text006@1006 : TextConst 'ENU=You cannot change %1 because the order is associated with one or more sales orders.;DEA=Sie k”nnen %1 nicht „ndern, da die Bestellung zu einem oder mehreren Auftr„gen geh”rt.';
      Text007@1007 : TextConst 'ENU=%1 is greater than %2 in the %3 table.\;DEA=%1 ist gr”áer als %2 in der Tabelle %3.\';
      Text008@1008 : TextConst 'ENU=Confirm change?;DEA=Žnderung best„tigen?';
      Text009@1009 : TextConst 'ENU="Deleting this document will cause a gap in the number series for receipts. ";DEA="Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie der Lieferungen. "';
      Text010@1010 : TextConst 'ENU=An empty receipt %1 will be created to fill this gap in the number series.\\;DEA=Die leere Lieferung %1 wird erzeugt, um die Lcke in der Nummernserie auszufllen.\\';
      Text011@1011 : TextConst 'ENU=Do you want to continue?;DEA=M”chten Sie fortfahren?';
      Text012@1012 : TextConst 'ENU="Deleting this document will cause a gap in the number series for posted invoices. ";DEA="Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie der gebuchten Rechnungen. "';
      Text013@1013 : TextConst 'ENU=An empty posted invoice %1 will be created to fill this gap in the number series.\\;DEA=Die leere gebuchte Rechnung %1 wird erzeugt, um die Lcke in der Nummernserie auszufllen.\\';
      Text014@1014 : TextConst 'ENU="Deleting this document will cause a gap in the number series for posted credit memos. ";DEA="Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie fr gebuchte Gutschriften. "';
      Text015@1015 : TextConst 'ENU=An empty posted credit memo %1 will be created to fill this gap in the number series.\\;DEA=Die leere Gutschrift %1 wird erzeugt, um die Lcke in der Nummernserie auszufllen.\\';
      Text016@1016 : TextConst 'ENU=If you change %1, the existing purchase lines will be deleted and new purchase lines based on the new information in the header will be created.\\;DEA=Wenn Sie %1 „ndern, werden vorhandene Einkaufszeilen gel”scht und neue Einkaufszeilen basierend auf den neuen Informationen des Kopfes werden erstellt.\\';
      Text018@1017 : TextConst 'ENU=You must delete the existing purchase lines before you can change %1.;DEA=Sie mssen die vorhandenen Einkaufszeilen l”schen, bevor Sie das Feld %1 „ndern k”nnen.';
      Text019@1018 : TextConst 'ENU=You have changed %1 on the purchase header, but it has not been changed on the existing purchase lines.\;DEA=Sie haben das Feld %1 im Einkaufskopf ge„ndert, aber die dazugeh”rigen Einkaufszeilen wurden nicht ge„ndert.\';
      Text020@1019 : TextConst 'ENU=You must update the existing purchase lines manually.;DEA=Sie mssen die vorhandenen Einkaufszeilen manuell aktualisieren.';
      Text021@1020 : TextConst 'ENU=The change may affect the exchange rate used on the price calculation of the purchase lines.;DEA=Die Žnderung kann eventuell den Wechselkurs, der fr die Preiskalkulation der Einkaufszeilen verwendet wurde, beinflussen.';
      Text022@1021 : TextConst 'ENU=Do you want to update the exchange rate?;DEA=M”chten Sie den Wechselkurs „ndern?';
      Text023@1022 : TextConst 'ENU=You cannot delete this document. Your identification is set up to process from %1 %2 only.;DEA=Sie k”nnen diesen Beleg nicht l”schen. Ihre Benutzereinrichtung l„sst nur %1 %2 zu.';
      Text025@1024 : TextConst 'ENU="You have modified the %1 field. Note that the recalculation of VAT may cause penny differences, so you must check the amounts afterwards. ";DEA="Sie haben das Feld %1 ge„ndert. Beachten Sie, dass die Neuberechnung der MwSt. Differenzen im Dezimalbereich hervorrufen kann und Sie daher anschlieáend die Betr„ge berprfen mssen. "';
      Text027@1026 : TextConst 'ENU=Do you want to update the %2 field on the lines to reflect the new value of %1?;DEA=M”chten Sie das Feld %2 in den Zeilen aktualisieren, um den neuen Wert der %1 abzubilden?';
      Text028@1027 : TextConst 'ENU=Your identification is set up to process from %1 %2 only.;DEA=Ihre Benutzereinrichtung l„sst nur %1 %2 zu.';
      Text029@1028 : TextConst 'ENU="Deleting this document will cause a gap in the number series for return shipments. ";DEA="Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie fr Rcklieferungen. "';
      Text030@1029 : TextConst 'ENU=An empty return shipment %1 will be created to fill this gap in the number series.\\;DEA=Die leere Rcklieferung %1 wird erstellt, um die Lcke in der Nummernserie auszufllen.\\';
      Text032@1031 : TextConst 'ENU=You have modified %1.\\;DEA=Sie haben das Feld %1 ge„ndert.\\';
      Text033@1032 : TextConst 'ENU=Do you want to update the lines?;DEA=M”chten Sie die Zeilen aktualisieren?';
      PurchSetup@1033 : Record 312;
      GLSetup@1034 : Record 98;
      GLAcc@1035 : Record 15;
      PurchLine@1036 : Record 39;
      xPurchLine@1080 : Record 39;
      VendLedgEntry@1037 : Record 25;
      Vend@1038 : Record 23;
      PaymentTerms@1039 : Record 3;
      PaymentMethod@1040 : Record 289;
      CurrExchRate@1041 : Record 330;
      PurchHeader@1042 : Record 38;
      PurchCommentLine@1043 : Record 43;
      ShipToAddr@1044 : Record 222;
      Cust@1045 : Record 18;
      CompanyInfo@1046 : Record 79;
      PostCode@1047 : Record 225;
      OrderAddr@1048 : Record 224;
      BankAcc@1049 : Record 270;
      PurchRcptHeader@1050 : Record 120;
      PurchInvHeader@1051 : Record 122;
      PurchCrMemoHeader@1052 : Record 124;
      ReturnShptHeader@1053 : Record 6650;
      PurchInvHeaderPrepmt@1090 : Record 122;
      PurchCrMemoHeaderPrepmt@1089 : Record 124;
      GenBusPostingGrp@1054 : Record 250;
      GenJnILine@1055 : Record 81;
      RespCenter@1056 : Record 5714;
      Location@1057 : Record 14;
      WhseRequest@1058 : Record 5765;
      InvtSetup@1059 : Record 313;
      NoSeriesMgt@1060 : Codeunit 396;
      TransferExtendedText@1061 : Codeunit 378;
      GenJnlApply@1062 : Codeunit 225;
      PurchPost@1063 : Codeunit 90;
      VendEntrySetApplID@1064 : Codeunit 111;
      DimMgt@1065 : Codeunit 408;
      ApprovalsMgmt@1082 : Codeunit 1535;
      UserSetupMgt@1066 : Codeunit 5700;
      ArchiveManagement@1074 : Codeunit 5063;
      ApplyVendEntries@1068 : Page 233;
      CurrencyDate@1069 : Date;
      HideValidationDialog@1070 : Boolean;
      Confirmed@1071 : Boolean;
      Text034@1072 : TextConst 'ENU=You cannot change the %1 when the %2 has been filled in.;DEA=Sie k”nnen das %1 nicht „ndern, wenn das %2 ausgefllt wurde.';
      Text037@1076 : TextConst 'ENU=Contact %1 %2 is not related to vendor %3.;DEA=Kontakt %1 %2 ist nicht mit Kreditor %3 verknpft.';
      Text038@1075 : TextConst 'ENU=Contact %1 %2 is related to a different company than vendor %3.;DEA=Kontakt %1 %2 ist mit einem anderen Unternehmen als Kreditor %3 verknpft.';
      Text039@1077 : TextConst 'ENU=Contact %1 %2 is not related to a vendor.;DEA=Kontakt %1 %2 ist mit keinem Kreditor verknpft.';
      SkipBuyFromContact@1030 : Boolean;
      SkipPayToContact@1078 : Boolean;
      Text040@1079 : TextConst 'ENU="You can not change the %1 field because %2 %3 has %4 = %5 and the %6 has already been assigned %7 %8.";DEA=Sie k”nnen das Feld %1 nicht „ndern, da die %2 %3 als %4 %5 hat und dem Beleg der Art %6 bereits die %7 %8 zugewiesen wurde.';
      Text041@1182 : TextConst 'ENU=The purchase %1 %2 has item tracking. Do you want to delete it anyway?;DEA=Fr den Einkauf %1 %2 wurde Artikelverfolgung festgelegt. M”chten Sie ihn trotzdem l”schen?';
      Text042@1084 : TextConst 'ENU=You must cancel the approval process if you wish to change the %1.;DEA=Der Genehmigungsprozess muss abgebrochen werden, wenn Sie %1 „ndern m”chten.';
      Text045@1086 : TextConst 'ENU=Deleting this document will cause a gap in the number series for prepayment invoices. An empty prepayment invoice %1 will be created to fill this gap in the number series.\\Do you want to continue?;DEA=Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie fr Vorauszahlungsrechnungen. Die leere Vorauszahlungsrechnung ''%1'' wird erstellt, um die Lcke in der Nummernserie zu schlieáen.\\Soll der Vorgang fortgesetzt werden?';
      Text046@1087 : TextConst 'ENU=Deleting this document will cause a gap in the number series for prepayment credit memos. An empty prepayment credit memo %1 will be created to fill this gap in the number series.\\Do you want to continue?;DEA=Das L”schen dieses Belegs verursacht eine Lcke in der Nummernserie fr Vorauszahlungsgutschriften. Die leere gebuchte Vorauszahlungsgutschrift ''%1'' wird erstellt, um die Lcke in der Nummernserie zu schlieáen.\\Soll der Vorgang fortgesetzt werden?';
      Text049@1092 : TextConst 'ENU=%1 is set up to process from %2 %3 only.;DEA=%1 ist nur fr die Verarbeitung von %2 %3 eingerichtet.';
      Text050@1067 : TextConst 'ENU=Reservations exist for this order. These reservations will be canceled if a date conflict is caused by this change.\\;DEA=Fr die Bestellung sind Reservierungen vorhanden. Die Reservierungen werden storniert, falls durch die Žnderung ein Datumskonflikt verursacht wird.\\';
      Text051@1025 : TextConst 'ENU=You may have changed a dimension.\\Do you want to update the lines?;DEA=Sie haben unter Umst„nden eine Dimension ge„ndert.\\M”chten Sie die Zeilen aktualisieren?';
      Text052@1091 : TextConst 'ENU=The %1 field on the purchase order %2 must be the same as on sales order %3.;DEA=Das Feld ''%1'' in der Einkaufsbestellung ''%2'' muss dem Feld im Verkaufsauftrag ''%3'' entsprechen.';
      NameAddressDetails@1093 : Text[512];
      DropShptNameAddressDetails@1094 : Text[512];
      SpecOrderNameAddressDetails@1121 : Text[512];
      UpdateDocumentDate@1120 : Boolean;
      Text053@1095 : TextConst 'ENU=There are unposted prepayment amounts on the document of type %1 with the number %2.;DEA=Fr den Beleg vom Typ ''%1'' mit der Nummer %2 sind ungebuchte Vorauszahlungsbetr„ge vorhanden.';
      Text054@1096 : TextConst 'ENU=There are unpaid prepayment invoices that are related to the document of type %1 with the number %2.;DEA=Fr den Beleg vom Typ %1 mit der Nummer %2 sind unbezahlte Vorauszahlungsrechnungen vorhanden.';
      DeferralLineQst@1155 : TextConst '@@@="%1=The posting date on the document.";ENU=You have changed the %1 on the purchase header, do you want to update the deferral schedules for the lines with this date?;DEA=Sie haben %1 auf dem Einkaufskopf ge„ndert. M”chten Sie die Abgrenzungspl„ne fr die Zeilen mit diesem Datum „ndern?';
      ChangeCurrencyQst@1073 : TextConst 'ENU=If you change %1, the existing purchase lines will be deleted and new purchase lines based on the new information in the header will be created. You may need to update the price information manually.\\Do you want to change %1?;DEA=Wenn Sie %1 „ndern, werden die vorhandenen Einkaufszeilen gel”scht und neue Einkaufszeilen auf der Grundlage der neuen Kopfinformationen erstellt. M”glicherweise mssen Sie die Preisinformationen manuell aktualisieren.\\M”chten Sie %1 „ndern?';
      PostedDocsToPrintCreatedMsg@1081 : TextConst 'ENU=One or more documents have been posted during deletion, which you can print from the related posted document.;DEA=Mindestens ein Beleg wurde w„hrend des L”schens gebucht, den Sie ber den dazugeh”renden gebuchten Beleg drucken k”nnen.';

    LOCAL PROCEDURE InitInsert@41();
    BEGIN
      IF "No." = '' THEN BEGIN
        TestNoSeries;
        NoSeriesMgt.InitSeries(GetNoSeriesCode,xRec."No. Series","Posting Date","No.","No. Series");
      END;

      InitRecord;
    END;

    LOCAL PROCEDURE SkipInitialization@42() : Boolean;
    BEGIN
      IF "No." = '' THEN
        EXIT(FALSE);

      IF "Buy-from Vendor No." = '' THEN
        EXIT(FALSE);

      IF xRec."Document Type" <> "Document Type" THEN
        EXIT(FALSE);

      IF GETFILTER("Buy-from Vendor No.") <> '' THEN
        IF GETRANGEMIN("Buy-from Vendor No.") = GETRANGEMAX("Buy-from Vendor No.") THEN
          IF "Buy-from Vendor No." = GETRANGEMIN("Buy-from Vendor No.") THEN
            EXIT(FALSE);

      EXIT(TRUE);
    END;

    PROCEDURE InitRecord@10();
    BEGIN
      PurchSetup.GET;

      CASE "Document Type" OF
        "Document Type"::Quote,"Document Type"::Order:
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",PurchSetup."Posted Invoice Nos.");
            NoSeriesMgt.SetDefaultSeries("Receiving No. Series",PurchSetup."Posted Receipt Nos.");
            IF "Document Type" = "Document Type"::Order THEN BEGIN
              NoSeriesMgt.SetDefaultSeries("Prepayment No. Series",PurchSetup."Posted Prepmt. Inv. Nos.");
              NoSeriesMgt.SetDefaultSeries("Prepmt. Cr. Memo No. Series",PurchSetup."Posted Prepmt. Cr. Memo Nos.");
            END;
          END;
        "Document Type"::Invoice:
          BEGIN
            IF ("No. Series" <> '') AND
               (PurchSetup."Invoice Nos." = PurchSetup."Posted Invoice Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",PurchSetup."Posted Invoice Nos.");
            IF PurchSetup."Receipt on Invoice" THEN
              NoSeriesMgt.SetDefaultSeries("Receiving No. Series",PurchSetup."Posted Receipt Nos.");
          END;
        "Document Type"::"Return Order":
          BEGIN
            NoSeriesMgt.SetDefaultSeries("Posting No. Series",PurchSetup."Posted Credit Memo Nos.");
            NoSeriesMgt.SetDefaultSeries("Return Shipment No. Series",PurchSetup."Posted Return Shpt. Nos.");
          END;
        "Document Type"::"Credit Memo":
          BEGIN
            IF ("No. Series" <> '') AND
               (PurchSetup."Credit Memo Nos." = PurchSetup."Posted Credit Memo Nos.")
            THEN
              "Posting No. Series" := "No. Series"
            ELSE
              NoSeriesMgt.SetDefaultSeries("Posting No. Series",PurchSetup."Posted Credit Memo Nos.");
            IF PurchSetup."Return Shipment on Credit Memo" THEN
              NoSeriesMgt.SetDefaultSeries("Return Shipment No. Series",PurchSetup."Posted Return Shpt. Nos.");
          END;
      END;

      IF "Document Type" IN ["Document Type"::Order,"Document Type"::Invoice,"Document Type"::"Return Order"] THEN
        "Order Date" := WORKDATE;

      IF "Document Type" = "Document Type"::Invoice THEN
        "Expected Receipt Date" := WORKDATE;

      IF NOT ("Document Type" IN ["Document Type"::"Blanket Order","Document Type"::Quote]) AND
         ("Posting Date" = 0D)
      THEN
        "Posting Date" := WORKDATE;

      IF PurchSetup."Default Posting Date" = PurchSetup."Default Posting Date"::"No Date" THEN
        "Posting Date" := 0D;

      "Document Date" := WORKDATE;

      VALIDATE("Sell-to Customer No.",'');

      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN BEGIN
        GLSetup.GET;
        Correction := GLSetup."Mark Cr. Memos as Corrections";
      END;

      "Posting Description" := FORMAT("Document Type") + ' ' + "No.";

      IF InvtSetup.GET THEN
        "Inbound Whse. Handling Time" := InvtSetup."Inbound Whse. Handling Time";

      "Responsibility Center" := UserSetupMgt.GetRespCenter(1,"Responsibility Center");
    END;

    LOCAL PROCEDURE InitNoSeries@52();
    BEGIN
      IF xRec."Receiving No." <> '' THEN BEGIN
        "Receiving No. Series" := xRec."Receiving No. Series";
        "Receiving No." := xRec."Receiving No.";
      END;
      IF xRec."Posting No." <> '' THEN BEGIN
        "Posting No. Series" := xRec."Posting No. Series";
        "Posting No." := xRec."Posting No.";
      END;
      IF xRec."Return Shipment No." <> '' THEN BEGIN
        "Return Shipment No. Series" := xRec."Return Shipment No. Series";
        "Return Shipment No." := xRec."Return Shipment No.";
      END;
      IF xRec."Prepayment No." <> '' THEN BEGIN
        "Prepayment No. Series" := xRec."Prepayment No. Series";
        "Prepayment No." := xRec."Prepayment No.";
      END;
      IF xRec."Prepmt. Cr. Memo No." <> '' THEN BEGIN
        "Prepmt. Cr. Memo No. Series" := xRec."Prepmt. Cr. Memo No. Series";
        "Prepmt. Cr. Memo No." := xRec."Prepmt. Cr. Memo No.";
      END;
    END;

    PROCEDURE AssistEdit@2(OldPurchHeader@1000 : Record 38) : Boolean;
    BEGIN
      PurchSetup.GET;
      TestNoSeries;
      IF NoSeriesMgt.SelectSeries(GetNoSeriesCode,OldPurchHeader."No. Series","No. Series") THEN BEGIN
        PurchSetup.GET;
        TestNoSeries;
        NoSeriesMgt.SetSeries("No.");
        EXIT(TRUE);
      END;
    END;

    LOCAL PROCEDURE TestNoSeries@6() : Boolean;
    BEGIN
      PurchSetup.GET;
      CASE "Document Type" OF
        "Document Type"::Quote:
          PurchSetup.TESTFIELD("Quote Nos.");
        "Document Type"::Order:
          PurchSetup.TESTFIELD("Order Nos.");
        "Document Type"::Invoice:
          BEGIN
            PurchSetup.TESTFIELD("Invoice Nos.");
            PurchSetup.TESTFIELD("Posted Invoice Nos.");
          END;
        "Document Type"::"Return Order":
          PurchSetup.TESTFIELD("Return Order Nos.");
        "Document Type"::"Credit Memo":
          BEGIN
            PurchSetup.TESTFIELD("Credit Memo Nos.");
            PurchSetup.TESTFIELD("Posted Credit Memo Nos.");
          END;
        "Document Type"::"Blanket Order":
          PurchSetup.TESTFIELD("Blanket Order Nos.");
      END;
    END;

    LOCAL PROCEDURE GetNoSeriesCode@9() : Code[10];
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(PurchSetup."Quote Nos.");
        "Document Type"::Order:
          EXIT(PurchSetup."Order Nos.");
        "Document Type"::Invoice:
          EXIT(PurchSetup."Invoice Nos.");
        "Document Type"::"Return Order":
          EXIT(PurchSetup."Return Order Nos.");
        "Document Type"::"Credit Memo":
          EXIT(PurchSetup."Credit Memo Nos.");
        "Document Type"::"Blanket Order":
          EXIT(PurchSetup."Blanket Order Nos.");
      END;
    END;

    LOCAL PROCEDURE GetPostingNoSeriesCode@8() : Code[10];
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT(PurchSetup."Posted Credit Memo Nos.");
      EXIT(PurchSetup."Posted Invoice Nos.");
    END;

    LOCAL PROCEDURE GetPostingPrepaymentNoSeriesCode@37() : Code[10];
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT(PurchSetup."Posted Prepmt. Cr. Memo Nos.");
      EXIT(PurchSetup."Posted Prepmt. Inv. Nos.");
    END;

    LOCAL PROCEDURE TestNoSeriesDate@40(No@1000 : Code[20];NoSeriesCode@1001 : Code[10];NoCapt@1002 : Text[1024];NoSeriesCapt@1004 : Text[1024]);
    VAR
      NoSeries@1005 : Record 308;
    BEGIN
      IF (No <> '') AND (NoSeriesCode <> '') THEN BEGIN
        NoSeries.GET(NoSeriesCode);
        IF NoSeries."Date Order" THEN
          ERROR(
            Text040,
            FIELDCAPTION("Posting Date"),NoSeriesCapt,NoSeriesCode,
            NoSeries.FIELDCAPTION("Date Order"),NoSeries."Date Order","Document Type",
            NoCapt,No);
      END;
    END;

    PROCEDURE ConfirmDeletion@11() : Boolean;
    BEGIN
      PurchPost.TestDeleteHeader(
        Rec,PurchRcptHeader,PurchInvHeader,PurchCrMemoHeader,
        ReturnShptHeader,PurchInvHeaderPrepmt,PurchCrMemoHeaderPrepmt);
      IF PurchRcptHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text009 +
             Text010 +
             Text011,TRUE,
             PurchRcptHeader."No.")
        THEN
          EXIT;
      IF PurchInvHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text012 +
             Text013 +
             Text011,TRUE,
             PurchInvHeader."No.")
        THEN
          EXIT;
      IF PurchCrMemoHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text014 +
             Text015 +
             Text011,TRUE,
             PurchCrMemoHeader."No.")
        THEN
          EXIT;
      IF ReturnShptHeader."No." <> '' THEN
        IF NOT CONFIRM(
             Text029 +
             Text030 +
             Text011,TRUE,
             ReturnShptHeader."No.")
        THEN
          EXIT;
      IF "Prepayment No." <> '' THEN
        IF NOT CONFIRM(
             Text045,TRUE,
             PurchInvHeaderPrepmt."No.")
        THEN
          EXIT;
      IF "Prepmt. Cr. Memo No." <> '' THEN
        IF NOT CONFIRM(
             Text046,TRUE,
             PurchCrMemoHeaderPrepmt."No.")
        THEN
          EXIT;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE GetVend@1(VendNo@1000 : Code[20]);
    BEGIN
      IF VendNo <> Vend."No." THEN
        Vend.GET(VendNo);
    END;

    PROCEDURE PurchLinesExist@3() : Boolean;
    BEGIN
      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      EXIT(PurchLine.FINDFIRST);
    END;

    LOCAL PROCEDURE RecreatePurchLines@4(ChangedFieldName@1000 : Text[100]);
    VAR
      PurchLineTmp@1001 : TEMPORARY Record 39;
      ItemChargeAssgntPurch@1005 : Record 5805;
      TempItemChargeAssgntPurch@1004 : TEMPORARY Record 5805;
      TempInteger@1003 : TEMPORARY Record 2000000026;
      SalesHeader@1006 : Record 36;
      SalesLine@1007 : Record 37;
      CopyDocMgt@1008 : Codeunit 6620;
      ExtendedTextAdded@1002 : Boolean;
    BEGIN
      IF PurchLinesExist THEN BEGIN
        IF HideValidationDialog THEN
          Confirmed := TRUE
        ELSE
          Confirmed :=
            CONFIRM(
              Text016 +
              Text004,FALSE,ChangedFieldName);
        IF Confirmed THEN BEGIN
          PurchLine.LOCKTABLE;
          ItemChargeAssgntPurch.LOCKTABLE;
          MODIFY;

          PurchLine.RESET;
          PurchLine.SETRANGE("Document Type","Document Type");
          PurchLine.SETRANGE("Document No.","No.");
          IF PurchLine.FINDSET THEN BEGIN
            REPEAT
              PurchLine.TESTFIELD("Quantity Received",0);
              PurchLine.TESTFIELD("Quantity Invoiced",0);
              PurchLine.TESTFIELD("Return Qty. Shipped",0);
              PurchLine.CALCFIELDS("Reserved Qty. (Base)");
              PurchLine.TESTFIELD("Reserved Qty. (Base)",0);
              PurchLine.TESTFIELD("Receipt No.",'');
              PurchLine.TESTFIELD("Return Shipment No.",'');
              PurchLine.TESTFIELD("Blanket Order No.",'');
              IF PurchLine."Drop Shipment" OR PurchLine."Special Order" THEN BEGIN
                CASE TRUE OF
                  PurchLine."Drop Shipment":
                    SalesHeader.GET(SalesHeader."Document Type"::Order,PurchLine."Sales Order No.");
                  PurchLine."Special Order":
                    SalesHeader.GET(SalesHeader."Document Type"::Order,PurchLine."Special Order Sales No.");
                END;
                TESTFIELD("Sell-to Customer No.",SalesHeader."Sell-to Customer No.");
                TESTFIELD("Ship-to Code",SalesHeader."Ship-to Code");
              END;

              PurchLine.TESTFIELD("Prepmt. Amt. Inv.",0);
              PurchLineTmp := PurchLine;
              IF PurchLine.Nonstock THEN BEGIN
                PurchLine.Nonstock := FALSE;
                PurchLine.MODIFY;
              END;
              PurchLineTmp.INSERT;
            UNTIL PurchLine.NEXT = 0;

            ItemChargeAssgntPurch.SETRANGE("Document Type","Document Type");
            ItemChargeAssgntPurch.SETRANGE("Document No.","No.");
            IF ItemChargeAssgntPurch.FINDSET THEN BEGIN
              REPEAT
                TempItemChargeAssgntPurch.INIT;
                TempItemChargeAssgntPurch := ItemChargeAssgntPurch;
                TempItemChargeAssgntPurch.INSERT;
              UNTIL ItemChargeAssgntPurch.NEXT = 0;
              ItemChargeAssgntPurch.DELETEALL;
            END;

            PurchLine.DELETEALL(TRUE);

            PurchLine.INIT;
            PurchLine."Line No." := 0;
            PurchLineTmp.FINDSET;
            ExtendedTextAdded := FALSE;
            REPEAT
              IF PurchLineTmp."Attached to Line No." = 0 THEN BEGIN
                PurchLine.INIT;
                PurchLine."Line No." := PurchLine."Line No." + 10000;
                PurchLine.VALIDATE(Type,PurchLineTmp.Type);
                IF PurchLineTmp."No." = '' THEN BEGIN
                  PurchLine.VALIDATE(Description,PurchLineTmp.Description);
                  PurchLine.VALIDATE("Description 2",PurchLineTmp."Description 2");
                END ELSE BEGIN
                  PurchLine.VALIDATE("No.",PurchLineTmp."No.");
                  IF PurchLine.Type <> PurchLine.Type::" " THEN
                    CASE TRUE OF
                      PurchLineTmp."Drop Shipment":
                        BEGIN
                          SalesLine.GET(SalesLine."Document Type"::Order,
                            PurchLineTmp."Sales Order No.",
                            PurchLineTmp."Sales Order Line No.");
                          CopyDocMgt.TransfldsFromSalesToPurchLine(SalesLine,PurchLine);
                          PurchLine."Drop Shipment" := PurchLineTmp."Drop Shipment";
                          PurchLine."Purchasing Code" := SalesLine."Purchasing Code";
                          PurchLine."Sales Order No." := PurchLineTmp."Sales Order No.";
                          PurchLine."Sales Order Line No." := PurchLineTmp."Sales Order Line No.";
                          EVALUATE(PurchLine."Inbound Whse. Handling Time",'<0D>');
                          PurchLine.VALIDATE("Inbound Whse. Handling Time");

                          SalesLine.VALIDATE("Unit Cost (LCY)",PurchLine."Unit Cost (LCY)");
                          SalesLine."Purchase Order No." := PurchLine."Document No.";
                          SalesLine."Purch. Order Line No." := PurchLine."Line No.";
                          SalesLine.MODIFY;
                        END;
                      PurchLineTmp."Special Order":
                        BEGIN
                          SalesLine.GET(SalesLine."Document Type"::Order,
                            PurchLineTmp."Special Order Sales No.",
                            PurchLineTmp."Special Order Sales Line No.");
                          CopyDocMgt.TransfldsFromSalesToPurchLine(SalesLine,PurchLine);
                          PurchLine."Special Order" := PurchLineTmp."Special Order";
                          PurchLine."Purchasing Code" := SalesLine."Purchasing Code";
                          PurchLine."Special Order Sales No." := PurchLineTmp."Special Order Sales No.";
                          PurchLine."Special Order Sales Line No." := PurchLineTmp."Special Order Sales Line No.";

                          SalesLine.VALIDATE("Unit Cost (LCY)",PurchLine."Unit Cost (LCY)");
                          SalesLine."Special Order Purchase No." := PurchLine."Document No.";
                          SalesLine."Special Order Purch. Line No." := PurchLine."Line No.";
                          SalesLine.MODIFY;
                        END;
                      ELSE BEGIN
                        PurchLine.VALIDATE("Unit of Measure Code",PurchLineTmp."Unit of Measure Code");
                        PurchLine.VALIDATE("Variant Code",PurchLineTmp."Variant Code");
                        PurchLine."Prod. Order No." := PurchLineTmp."Prod. Order No.";
                        IF PurchLine."Prod. Order No." <> '' THEN BEGIN
                          PurchLine.Description := PurchLineTmp.Description;
                          PurchLine.VALIDATE("VAT Prod. Posting Group",PurchLineTmp."VAT Prod. Posting Group");
                          PurchLine.VALIDATE("Gen. Prod. Posting Group",PurchLineTmp."Gen. Prod. Posting Group");
                          PurchLine.VALIDATE("Expected Receipt Date",PurchLineTmp."Expected Receipt Date");
                          PurchLine.VALIDATE("Requested Receipt Date",PurchLineTmp."Requested Receipt Date");
                          PurchLine.VALIDATE("Qty. per Unit of Measure",PurchLineTmp."Qty. per Unit of Measure");
                        END;
                        IF (PurchLineTmp."Job No." <> '') AND (PurchLineTmp."Job Task No." <> '') THEN BEGIN
                          PurchLine.VALIDATE("Job No.",PurchLineTmp."Job No.");
                          PurchLine.VALIDATE("Job Task No.",PurchLineTmp."Job Task No.");
                          PurchLine."Job Line Type" := PurchLineTmp."Job Line Type";
                        END;
                        IF PurchLineTmp.Quantity <> 0 THEN
                          PurchLine.VALIDATE(Quantity,PurchLineTmp.Quantity);
                        IF ("Currency Code" = xRec."Currency Code") AND (PurchLine."Direct Unit Cost" = 0) THEN
                          PurchLine.VALIDATE("Direct Unit Cost",PurchLineTmp."Direct Unit Cost");
                        PurchLine."Routing No." := PurchLineTmp."Routing No.";
                        PurchLine."Routing Reference No." := PurchLineTmp."Routing Reference No.";
                        PurchLine."Operation No." := PurchLineTmp."Operation No.";
                        PurchLine."Work Center No." := PurchLineTmp."Work Center No.";
                        PurchLine."Prod. Order Line No." := PurchLineTmp."Prod. Order Line No.";
                        PurchLine."Overhead Rate" := PurchLineTmp."Overhead Rate";
                      END;
                    END;
                END;

                PurchLine.INSERT;
                ExtendedTextAdded := FALSE;

                IF PurchLine.Type = PurchLine.Type::Item THEN BEGIN
                  ClearItemAssgntPurchFilter(TempItemChargeAssgntPurch);
                  TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. Type",PurchLineTmp."Document Type");
                  TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. No.",PurchLineTmp."Document No.");
                  TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. Line No.",PurchLineTmp."Line No.");
                  IF TempItemChargeAssgntPurch.FINDSET THEN
                    REPEAT
                      IF NOT TempItemChargeAssgntPurch.MARK THEN BEGIN
                        TempItemChargeAssgntPurch."Applies-to Doc. Line No." := PurchLine."Line No.";
                        TempItemChargeAssgntPurch.Description := PurchLine.Description;
                        TempItemChargeAssgntPurch.MODIFY;
                        TempItemChargeAssgntPurch.MARK(TRUE);
                      END;
                    UNTIL TempItemChargeAssgntPurch.NEXT = 0;
                END;
                IF PurchLine.Type = PurchLine.Type::"Charge (Item)" THEN BEGIN
                  TempInteger.INIT;
                  TempInteger.Number := PurchLine."Line No.";
                  TempInteger.INSERT;
                END;
              END ELSE
                IF NOT ExtendedTextAdded THEN BEGIN
                  TransferExtendedText.PurchCheckIfAnyExtText(PurchLine,TRUE);
                  TransferExtendedText.InsertPurchExtText(PurchLine);
                  PurchLine.FINDLAST;
                  ExtendedTextAdded := TRUE;
                END;
            UNTIL PurchLineTmp.NEXT = 0;

            ClearItemAssgntPurchFilter(TempItemChargeAssgntPurch);
            PurchLineTmp.SETRANGE(Type,PurchLine.Type::"Charge (Item)");
            IF PurchLineTmp.FINDSET THEN
              REPEAT
                TempItemChargeAssgntPurch.SETRANGE("Document Line No.",PurchLineTmp."Line No.");
                IF TempItemChargeAssgntPurch.FINDSET THEN BEGIN
                  REPEAT
                    TempInteger.FINDFIRST;
                    ItemChargeAssgntPurch.INIT;
                    ItemChargeAssgntPurch := TempItemChargeAssgntPurch;
                    ItemChargeAssgntPurch."Document Line No." := TempInteger.Number;
                    ItemChargeAssgntPurch.VALIDATE("Unit Cost",0);
                    ItemChargeAssgntPurch.INSERT;
                  UNTIL TempItemChargeAssgntPurch.NEXT = 0;
                  TempInteger.DELETE;
                END;
              UNTIL PurchLineTmp.NEXT = 0;

            PurchLineTmp.SETRANGE(Type);
            PurchLineTmp.DELETEALL;
            ClearItemAssgntPurchFilter(TempItemChargeAssgntPurch);
            TempItemChargeAssgntPurch.DELETEALL;
          END;
        END ELSE
          ERROR(
            Text018,ChangedFieldName);
      END;
    END;

    LOCAL PROCEDURE MessageIfPurchLinesExist@5(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF PurchLinesExist AND NOT HideValidationDialog THEN
        MESSAGE(
          Text019 +
          Text020,
          ChangedFieldName);
    END;

    LOCAL PROCEDURE PriceMessageIfPurchLinesExist@7(ChangedFieldName@1000 : Text[100]);
    BEGIN
      IF PurchLinesExist AND NOT HideValidationDialog THEN
        MESSAGE(
          Text019 +
          Text021,ChangedFieldName);
    END;

    LOCAL PROCEDURE UpdateCurrencyFactor@12();
    BEGIN
      IF "Currency Code" <> '' THEN BEGIN
        IF "Posting Date" <> 0D THEN
          CurrencyDate := "Posting Date"
        ELSE
          CurrencyDate := WORKDATE;

        "Currency Factor" := CurrExchRate.ExchangeRate(CurrencyDate,"Currency Code");
      END ELSE
        "Currency Factor" := 0;
    END;

    LOCAL PROCEDURE ConfirmUpdateCurrencyFactor@13() : Boolean;
    BEGIN
      IF HideValidationDialog THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(Text022,FALSE);
      IF Confirmed THEN
        VALIDATE("Currency Factor")
      ELSE
        "Currency Factor" := xRec."Currency Factor";
      EXIT(Confirmed);
    END;

    PROCEDURE SetHideValidationDialog@14(NewHideValidationDialog@1000 : Boolean);
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    LOCAL PROCEDURE UpdatePurchLines@15(ChangedFieldName@1000 : Text[100];AskQuestion@1001 : Boolean);
    VAR
      PurchLineReserve@1003 : Codeunit 99000834;
      Question@1002 : Text[250];
    BEGIN
      IF NOT PurchLinesExist THEN
        EXIT;

      IF AskQuestion THEN BEGIN
        Question := STRSUBSTNO(
            Text032 +
            Text033,ChangedFieldName);
        IF GUIALLOWED THEN
          IF DIALOG.CONFIRM(Question,TRUE) THEN
            CASE ChangedFieldName OF
              FIELDCAPTION("Expected Receipt Date"),
              FIELDCAPTION("Requested Receipt Date"),
              FIELDCAPTION("Promised Receipt Date"),
              FIELDCAPTION("Lead Time Calculation"),
              FIELDCAPTION("Inbound Whse. Handling Time"):
                ConfirmResvDateConflict;
            END
          ELSE
            EXIT;
      END;

      PurchLine.LOCKTABLE;
      MODIFY;

      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      IF PurchLine.FINDSET THEN
        REPEAT
          xPurchLine := PurchLine;
          CASE ChangedFieldName OF
            FIELDCAPTION("Expected Receipt Date"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Expected Receipt Date","Expected Receipt Date");
            FIELDCAPTION("Currency Factor"):
              IF PurchLine.Type <> PurchLine.Type::" " THEN
                PurchLine.VALIDATE("Direct Unit Cost");
            FIELDCAPTION("Transaction Type"):
              PurchLine.VALIDATE("Transaction Type","Transaction Type");
            FIELDCAPTION("Transport Method"):
              PurchLine.VALIDATE("Transport Method","Transport Method");
            FIELDCAPTION("Entry Point"):
              PurchLine.VALIDATE("Entry Point","Entry Point");
            FIELDCAPTION(Area):
              PurchLine.VALIDATE(Area,Area);
            FIELDCAPTION("Transaction Specification"):
              PurchLine.VALIDATE("Transaction Specification","Transaction Specification");
            FIELDCAPTION("Requested Receipt Date"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Requested Receipt Date","Requested Receipt Date");
            FIELDCAPTION("Prepayment %"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Prepayment %","Prepayment %");
            FIELDCAPTION("Promised Receipt Date"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Promised Receipt Date","Promised Receipt Date");
            FIELDCAPTION("Lead Time Calculation"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Lead Time Calculation","Lead Time Calculation");
            FIELDCAPTION("Inbound Whse. Handling Time"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Inbound Whse. Handling Time","Inbound Whse. Handling Time");
            PurchLine.FIELDCAPTION("Deferral Code"):
              IF PurchLine."No." <> '' THEN
                PurchLine.VALIDATE("Deferral Code");
          END;
          PurchLine.MODIFY(TRUE);
          PurchLineReserve.VerifyChange(PurchLine,xPurchLine);
        UNTIL PurchLine.NEXT = 0;
    END;

    LOCAL PROCEDURE ConfirmResvDateConflict@31();
    VAR
      ResvEngMgt@1000 : Codeunit 99000831;
    BEGIN
      IF ResvEngMgt.ResvExistsForPurchHeader(Rec) THEN
        IF NOT CONFIRM(Text050 + Text011,FALSE) THEN
          ERROR('');
    END;

    PROCEDURE CreateDim@16(Type1@1000 : Integer;No1@1001 : Code[20];Type2@1002 : Integer;No2@1003 : Code[20];Type3@1004 : Integer;No3@1005 : Code[20];Type4@1006 : Integer;No4@1007 : Code[20]);
    VAR
      SourceCodeSetup@1010 : Record 242;
      TableID@1011 : ARRAY [10] OF Integer;
      No@1012 : ARRAY [10] OF Code[20];
      OldDimSetID@1008 : Integer;
    BEGIN
      SourceCodeSetup.GET;
      TableID[1] := Type1;
      No[1] := No1;
      TableID[2] := Type2;
      No[2] := No2;
      TableID[3] := Type3;
      No[3] := No3;
      TableID[4] := Type4;
      No[4] := No4;
      "Shortcut Dimension 1 Code" := '';
      "Shortcut Dimension 2 Code" := '';
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.GetDefaultDimID(TableID,No,SourceCodeSetup.Purchases,"Shortcut Dimension 1 Code","Shortcut Dimension 2 Code",0,0);

      IF (OldDimSetID <> "Dimension Set ID") AND PurchLinesExist THEN BEGIN
        MODIFY;
        UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@19(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    VAR
      OldDimSetID@1005 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      DimMgt.ValidateShortcutDimValues(FieldNumber,ShortcutDimCode,"Dimension Set ID");
      IF "No." <> '' THEN
        MODIFY;

      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF PurchLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE ReceivedPurchLinesExist@20() : Boolean;
    BEGIN
      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      PurchLine.SETFILTER("Quantity Received",'<>0');
      EXIT(PurchLine.FINDFIRST);
    END;

    LOCAL PROCEDURE ReturnShipmentExist@5800() : Boolean;
    BEGIN
      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      PurchLine.SETFILTER("Return Qty. Shipped",'<>0');
      EXIT(PurchLine.FINDFIRST);
    END;

    LOCAL PROCEDURE UpdateShipToAddress@21();
    BEGIN
      IF "Document Type" IN ["Document Type"::"Return Order","Document Type"::"Credit Memo"] THEN
        EXIT;

      IF ("Location Code" <> '') AND
         Location.GET("Location Code") AND
         ("Sell-to Customer No." = '')
      THEN BEGIN
        "Ship-to Name" := Location.Name;
        "Ship-to Name 2" := Location."Name 2";
        "Ship-to Address" := Location.Address;
        "Ship-to Address 2" := Location."Address 2";
        "Ship-to City" := Location.City;
        "Ship-to Post Code" := Location."Post Code";
        "Ship-to County" := Location.County;
        "Ship-to Country/Region Code" := Location."Country/Region Code";
        "Ship-to Contact" := Location.Contact;
      END;

      IF ("Location Code" = '') AND
         ("Sell-to Customer No." = '')
      THEN BEGIN
        CompanyInfo.GET;
        "Ship-to Code" := '';
        "Ship-to Name" := CompanyInfo."Ship-to Name";
        "Ship-to Name 2" := CompanyInfo."Ship-to Name 2";
        "Ship-to Address" := CompanyInfo."Ship-to Address";
        "Ship-to Address 2" := CompanyInfo."Ship-to Address 2";
        "Ship-to City" := CompanyInfo."Ship-to City";
        "Ship-to Post Code" := CompanyInfo."Ship-to Post Code";
        "Ship-to County" := CompanyInfo."Ship-to County";
        "Ship-to Country/Region Code" := CompanyInfo."Ship-to Country/Region Code";
        "Ship-to Contact" := CompanyInfo."Ship-to Contact";
      END;
    END;

    LOCAL PROCEDURE DeletePurchaseLines@17();
    BEGIN
      IF PurchLine.FINDSET THEN BEGIN
        HandleItemTrackingDeletion;
        REPEAT
          PurchLine.SuspendStatusCheck(TRUE);
          PurchLine.DELETE(TRUE);
        UNTIL PurchLine.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE HandleItemTrackingDeletion@36();
    VAR
      ReservEntry@1000 : Record 337;
      ReservEntry2@1001 : Record 337;
    BEGIN
      WITH ReservEntry DO BEGIN
        RESET;
        SETCURRENTKEY(
          "Source ID","Source Ref. No.","Source Type","Source Subtype",
          "Source Batch Name","Source Prod. Order Line","Reservation Status");
        SETRANGE("Source Type",DATABASE::"Purchase Line");
        SETRANGE("Source Subtype","Document Type");
        SETRANGE("Source ID","No.");
        SETRANGE("Source Batch Name",'');
        SETRANGE("Source Prod. Order Line",0);
        SETFILTER("Item Tracking",'> %1',"Item Tracking"::None);
        IF ISEMPTY THEN
          EXIT;

        IF HideValidationDialog OR NOT GUIALLOWED THEN
          Confirmed := TRUE
        ELSE
          Confirmed := CONFIRM(Text041,FALSE,LOWERCASE(FORMAT("Document Type")),"No.");

        IF NOT Confirmed THEN
          ERROR('');

        IF FINDSET THEN
          REPEAT
            ReservEntry2 := ReservEntry;
            ReservEntry2.ClearItemTrackingFields;
            ReservEntry2.MODIFY;
          UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ClearItemAssgntPurchFilter@22(VAR TempItemChargeAssgntPurch@1000 : Record 5805);
    BEGIN
      TempItemChargeAssgntPurch.SETRANGE("Document Line No.");
      TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. Type");
      TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. No.");
      TempItemChargeAssgntPurch.SETRANGE("Applies-to Doc. Line No.");
    END;

    LOCAL PROCEDURE UpdateBuyFromCont@24(VendorNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Vend@1004 : Record 23;
    BEGIN
      IF Vend.GET(VendorNo) THEN BEGIN
        IF Vend."Primary Contact No." <> '' THEN
          "Buy-from Contact No." := Vend."Primary Contact No."
        ELSE BEGIN
          ContBusRel.RESET;
          ContBusRel.SETCURRENTKEY("Link to Table","No.");
          ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
          ContBusRel.SETRANGE("No.","Buy-from Vendor No.");
          IF ContBusRel.FINDFIRST THEN
            "Buy-from Contact No." := ContBusRel."Contact No."
          ELSE
            "Buy-from Contact No." := '';
        END;
        "Buy-from Contact" := Vend.Contact;
      END;
    END;

    LOCAL PROCEDURE UpdatePayToCont@27(VendorNo@1000 : Code[20]);
    VAR
      ContBusRel@1003 : Record 5054;
      Vend@1001 : Record 23;
    BEGIN
      IF Vend.GET(VendorNo) THEN BEGIN
        IF Vend."Primary Contact No." <> '' THEN
          "Pay-to Contact No." := Vend."Primary Contact No."
        ELSE BEGIN
          ContBusRel.RESET;
          ContBusRel.SETCURRENTKEY("Link to Table","No.");
          ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
          ContBusRel.SETRANGE("No.","Pay-to Vendor No.");
          IF ContBusRel.FINDFIRST THEN
            "Pay-to Contact No." := ContBusRel."Contact No."
          ELSE
            "Pay-to Contact No." := '';
        END;
        "Pay-to Contact" := Vend.Contact;
      END;
    END;

    LOCAL PROCEDURE UpdateBuyFromVend@25(ContactNo@1002 : Code[20]);
    VAR
      ContBusinessRelation@1007 : Record 5054;
      Vend@1006 : Record 23;
      Cont@1005 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Buy-from Contact No." := Cont."No.";
        IF Cont.Type = Cont.Type::Person THEN
          "Buy-from Contact" := Cont.Name
        ELSE
          IF Vend.GET("Buy-from Vendor No.") THEN
            "Buy-from Contact" := Vend.Contact
          ELSE
            "Buy-from Contact" := ''
      END ELSE BEGIN
        "Buy-from Contact" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF ("Buy-from Vendor No." <> '') AND
           ("Buy-from Vendor No." <> ContBusinessRelation."No.")
        THEN
          ERROR(Text037,Cont."No.",Cont.Name,"Buy-from Vendor No.");
        IF "Buy-from Vendor No." = '' THEN BEGIN
          SkipBuyFromContact := TRUE;
          VALIDATE("Buy-from Vendor No.",ContBusinessRelation."No.");
          SkipBuyFromContact := FALSE;
        END;
      END ELSE
        ERROR(Text039,Cont."No.",Cont.Name);

      IF ("Buy-from Vendor No." = "Pay-to Vendor No.") OR
         ("Pay-to Vendor No." = '')
      THEN
        VALIDATE("Pay-to Contact No.","Buy-from Contact No.");
    END;

    LOCAL PROCEDURE UpdatePayToVend@26(ContactNo@1000 : Code[20]);
    VAR
      ContBusinessRelation@1005 : Record 5054;
      Vend@1004 : Record 23;
      Cont@1003 : Record 5050;
    BEGIN
      IF Cont.GET(ContactNo) THEN BEGIN
        "Pay-to Contact No." := Cont."No.";
        IF Cont.Type = Cont.Type::Person THEN
          "Pay-to Contact" := Cont.Name
        ELSE
          IF Vend.GET("Pay-to Vendor No.") THEN
            "Pay-to Contact" := Vend.Contact
          ELSE
            "Pay-to Contact" := '';
      END ELSE BEGIN
        "Pay-to Contact" := '';
        EXIT;
      END;

      ContBusinessRelation.RESET;
      ContBusinessRelation.SETCURRENTKEY("Link to Table","Contact No.");
      ContBusinessRelation.SETRANGE("Link to Table",ContBusinessRelation."Link to Table"::Vendor);
      ContBusinessRelation.SETRANGE("Contact No.",Cont."Company No.");
      IF ContBusinessRelation.FINDFIRST THEN BEGIN
        IF "Pay-to Vendor No." = '' THEN BEGIN
          SkipPayToContact := TRUE;
          VALIDATE("Pay-to Vendor No.",ContBusinessRelation."No.");
          SkipPayToContact := FALSE;
        END ELSE
          IF "Pay-to Vendor No." <> ContBusinessRelation."No." THEN
            ERROR(Text037,Cont."No.",Cont.Name,"Pay-to Vendor No.");
      END ELSE
        ERROR(Text039,Cont."No.",Cont.Name);
    END;

    PROCEDURE CreateInvtPutAwayPick@29();
    VAR
      WhseRequest@1000 : Record 5765;
    BEGIN
      TESTFIELD(Status,Status::Released);

      WhseRequest.RESET;
      WhseRequest.SETCURRENTKEY("Source Document","Source No.");
      CASE "Document Type" OF
        "Document Type"::Order:
          WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Purchase Order");
        "Document Type"::"Return Order":
          WhseRequest.SETRANGE("Source Document",WhseRequest."Source Document"::"Purchase Return Order");
      END;
      WhseRequest.SETRANGE("Source No.","No.");
      REPORT.RUNMODAL(REPORT::"Create Invt Put-away/Pick/Mvmt",TRUE,FALSE,WhseRequest);
    END;

    PROCEDURE ShowDocDim@32();
    VAR
      OldDimSetID@1000 : Integer;
    BEGIN
      OldDimSetID := "Dimension Set ID";
      "Dimension Set ID" :=
        DimMgt.EditDimensionSet2(
          "Dimension Set ID",STRSUBSTNO('%1 %2',"Document Type","No."),
          "Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");

      IF OldDimSetID <> "Dimension Set ID" THEN BEGIN
        MODIFY;
        IF PurchLinesExist THEN
          UpdateAllLineDim("Dimension Set ID",OldDimSetID);
      END;
    END;

    LOCAL PROCEDURE UpdateAllLineDim@34(NewParentDimSetID@1000 : Integer;OldParentDimSetID@1001 : Integer);
    VAR
      NewDimSetID@1002 : Integer;
      ReceivedShippedItemLineDimChangeConfirmed@1003 : Boolean;
    BEGIN
      // Update all lines with changed dimensions.

      IF NewParentDimSetID = OldParentDimSetID THEN
        EXIT;
      IF NOT CONFIRM(Text051) THEN
        EXIT;

      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      PurchLine.LOCKTABLE;
      IF PurchLine.FIND('-') THEN
        REPEAT
          NewDimSetID := DimMgt.GetDeltaDimSetID(PurchLine."Dimension Set ID",NewParentDimSetID,OldParentDimSetID);
          IF PurchLine."Dimension Set ID" <> NewDimSetID THEN BEGIN
            PurchLine."Dimension Set ID" := NewDimSetID;

            IF NOT HideValidationDialog AND GUIALLOWED THEN
              VerifyReceivedShippedItemLineDimChange(ReceivedShippedItemLineDimChangeConfirmed);

            DimMgt.UpdateGlobalDimFromDimSetID(
              PurchLine."Dimension Set ID",PurchLine."Shortcut Dimension 1 Code",PurchLine."Shortcut Dimension 2 Code");
            PurchLine.MODIFY;
          END;
        UNTIL PurchLine.NEXT = 0;
    END;

    LOCAL PROCEDURE VerifyReceivedShippedItemLineDimChange@71(VAR ReceivedShippedItemLineDimChangeConfirmed@1000 : Boolean);
    BEGIN
      IF PurchLine.IsReceivedShippedItemDimChanged THEN
        IF NOT ReceivedShippedItemLineDimChangeConfirmed THEN
          ReceivedShippedItemLineDimChangeConfirmed := PurchLine.ConfirmReceivedShippedItemDimChange;
    END;

    PROCEDURE SetAmountToApply@18(AppliesToDocNo@1000 : Code[20];VendorNo@1001 : Code[20]);
    VAR
      VendLedgEntry@1002 : Record 25;
    BEGIN
      VendLedgEntry.SETCURRENTKEY("Document No.");
      VendLedgEntry.SETRANGE("Document No.",AppliesToDocNo);
      VendLedgEntry.SETRANGE("Vendor No.",VendorNo);
      VendLedgEntry.SETRANGE(Open,TRUE);
      IF VendLedgEntry.FINDFIRST THEN BEGIN
        IF VendLedgEntry."Amount to Apply" = 0 THEN  BEGIN
          VendLedgEntry.CALCFIELDS("Remaining Amount");
          VendLedgEntry."Amount to Apply" := VendLedgEntry."Remaining Amount";
        END ELSE
          VendLedgEntry."Amount to Apply" := 0;
        VendLedgEntry."Accepted Payment Tolerance" := 0;
        VendLedgEntry."Accepted Pmt. Disc. Tolerance" := FALSE;
        CODEUNIT.RUN(CODEUNIT::"Vend. Entry-Edit",VendLedgEntry);
      END;
    END;

    PROCEDURE SetShipToForSpecOrder@23();
    BEGIN
      IF Location.GET("Location Code") THEN BEGIN
        "Ship-to Code" := '';
        "Ship-to Name" := Location.Name;
        "Ship-to Name 2" := Location."Name 2";
        "Ship-to Address" := Location.Address;
        "Ship-to Address 2" := Location."Address 2";
        "Ship-to City" := Location.City;
        "Ship-to Post Code" := Location."Post Code";
        "Ship-to County" := Location.County;
        "Ship-to Country/Region Code" := Location."Country/Region Code";
        "Ship-to Contact" := Location.Contact;
        "Location Code" := Location.Code;
      END ELSE BEGIN
        CompanyInfo.GET;
        "Ship-to Code" := '';
        "Ship-to Name" := CompanyInfo."Ship-to Name";
        "Ship-to Name 2" := CompanyInfo."Ship-to Name 2";
        "Ship-to Address" := CompanyInfo."Ship-to Address";
        "Ship-to Address 2" := CompanyInfo."Ship-to Address 2";
        "Ship-to City" := CompanyInfo."Ship-to City";
        "Ship-to Post Code" := CompanyInfo."Ship-to Post Code";
        "Ship-to County" := CompanyInfo."Ship-to County";
        "Ship-to Country/Region Code" := CompanyInfo."Ship-to Country/Region Code";
        "Ship-to Contact" := CompanyInfo."Ship-to Contact";
        "Location Code" := '';
      END;
    END;

    LOCAL PROCEDURE JobUpdatePurchLines@28(SkipJobCurrFactorUpdate@1000 : Boolean);
    BEGIN
      WITH PurchLine DO BEGIN
        SETFILTER("Job No.",'<>%1','');
        SETFILTER("Job Task No.",'<>%1','');
        LOCKTABLE;
        IF FINDSET(TRUE,FALSE) THEN BEGIN
          SetPurchHeader(Rec);
          REPEAT
            IF NOT SkipJobCurrFactorUpdate THEN
              JobSetCurrencyFactor;
            CreateTempJobJnlLine(FALSE);
            UpdateJobPrices;
            MODIFY;
          UNTIL NEXT = 0;
        END;
      END
    END;

    PROCEDURE GetPstdDocLinesToRevere@47();
    VAR
      PurchPostedDocLines@1002 : Page 5855;
    BEGIN
      GetVend("Buy-from Vendor No.");
      PurchPostedDocLines.SetToPurchHeader(Rec);
      PurchPostedDocLines.SETRECORD(Vend);
      PurchPostedDocLines.LOOKUPMODE := TRUE;
      IF PurchPostedDocLines.RUNMODAL = ACTION::LookupOK THEN
        PurchPostedDocLines.CopyLineToDoc;

      CLEAR(PurchPostedDocLines);
    END;

    PROCEDURE SetSecurityFilterOnRespCenter@43();
    BEGIN
      IF UserSetupMgt.GetPurchasesFilter <> '' THEN BEGIN
        FILTERGROUP(2);
        SETRANGE("Responsibility Center",UserSetupMgt.GetPurchasesFilter);
        FILTERGROUP(0);
      END;

      SETRANGE("Date Filter",0D,WORKDATE - 1);
    END;

    PROCEDURE CalcInvDiscForHeader@45();
    VAR
      PurchaseInvDisc@1000 : Codeunit 70;
    BEGIN
      PurchSetup.GET;
      IF PurchSetup."Calc. Inv. Discount" THEN
        PurchaseInvDisc.CalculateIncDiscForHeader(Rec);
    END;

    PROCEDURE AddShipToAddress@46(SalesHeader@1000 : Record 36;ShowError@1001 : Boolean);
    VAR
      PurchLine2@1002 : Record 39;
    BEGIN
      IF ShowError THEN BEGIN
        PurchLine2.RESET;
        PurchLine2.SETRANGE("Document Type","Document Type"::Order);
        PurchLine2.SETRANGE("Document No.","No.");
        IF NOT PurchLine2.ISEMPTY THEN BEGIN
          IF "Ship-to Name" <> SalesHeader."Ship-to Name" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Name"),"No.",SalesHeader."No.");
          IF "Ship-to Name 2" <> SalesHeader."Ship-to Name 2" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Name 2"),"No.",SalesHeader."No.");
          IF "Ship-to Address" <> SalesHeader."Ship-to Address" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Address"),"No.",SalesHeader."No.");
          IF "Ship-to Address 2" <> SalesHeader."Ship-to Address 2" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Address 2"),"No.",SalesHeader."No.");
          IF "Ship-to Post Code" <> SalesHeader."Ship-to Post Code" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Post Code"),"No.",SalesHeader."No.");
          IF "Ship-to City" <> SalesHeader."Ship-to City" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to City"),"No.",SalesHeader."No.");
          IF "Ship-to Contact" <> SalesHeader."Ship-to Contact" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Contact"),"No.",SalesHeader."No.");
        END ELSE BEGIN
          // no purchase line exists
          "Ship-to Name" := SalesHeader."Ship-to Name";
          "Ship-to Name 2" := SalesHeader."Ship-to Name 2";
          "Ship-to Address" := SalesHeader."Ship-to Address";
          "Ship-to Address 2" := SalesHeader."Ship-to Address 2";
          "Ship-to Post Code" := SalesHeader."Ship-to Post Code";
          "Ship-to City" := SalesHeader."Ship-to City";
          "Ship-to Contact" := SalesHeader."Ship-to Contact";
        END;
      END;
    END;

    PROCEDURE DropShptOrderExists@48(SalesHeader@1000 : Record 36) : Boolean;
    VAR
      SalesLine2@1001 : Record 37;
    BEGIN
      // returns TRUE if sales is either Drop Shipment of Special Order
      SalesLine2.RESET;
      SalesLine2.SETRANGE("Document Type",SalesLine2."Document Type"::Order);
      SalesLine2.SETRANGE("Document No.",SalesHeader."No.");
      SalesLine2.SETRANGE("Drop Shipment",TRUE);
      EXIT(NOT SalesLine2.ISEMPTY);
    END;

    PROCEDURE SpecialOrderExists@81(SalesHeader@1000 : Record 36) : Boolean;
    VAR
      SalesLine3@1001 : Record 37;
    BEGIN
      SalesLine3.RESET;
      SalesLine3.SETRANGE("Document Type",SalesLine3."Document Type"::Order);
      SalesLine3.SETRANGE("Document No.",SalesHeader."No.");
      SalesLine3.SETRANGE("Special Order",TRUE);
      EXIT(NOT SalesLine3.ISEMPTY);
    END;

    PROCEDURE QtyToReceiveIsZero@30() : Boolean;
    BEGIN
      PurchLine.RESET;
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      PurchLine.SETFILTER("Qty. to Receive",'<>0');
      EXIT(PurchLine.ISEMPTY);
    END;

    LOCAL PROCEDURE IsApprovedForPosting@50() : Boolean;
    VAR
      PrepaymentMgt@1000 : Codeunit 441;
    BEGIN
      IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN BEGIN
        IF PrepaymentMgt.TestPurchasePrepayment(Rec) THEN
          ERROR(STRSUBSTNO(Text053,"Document Type","No."));
        IF PrepaymentMgt.TestPurchasePayment(Rec) THEN
          IF NOT CONFIRM(STRSUBSTNO(Text054,"Document Type","No."),TRUE) THEN
            EXIT(FALSE);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE IsApprovedForPostingBatch@51() : Boolean;
    VAR
      PrepaymentMgt@1000 : Codeunit 441;
    BEGIN
      IF ApprovalsMgmt.PrePostApprovalCheckPurch(Rec) THEN BEGIN
        IF PrepaymentMgt.TestPurchasePrepayment(Rec) THEN
          EXIT(FALSE);
        IF PrepaymentMgt.TestPurchasePayment(Rec) THEN
          EXIT(FALSE);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE SendToPosting@57(PostingCodeunitID@1000 : Integer);
    BEGIN
      IF NOT IsApprovedForPosting THEN
        EXIT;
      CODEUNIT.RUN(PostingCodeunitID,Rec);
    END;

    PROCEDURE CancelBackgroundPosting@33();
    VAR
      PurchasePostViaJobQueue@1000 : Codeunit 98;
    BEGIN
      PurchasePostViaJobQueue.CancelQueueEntry(Rec);
    END;

    PROCEDURE CheckDropShptAddressDetails@79(SalesHeader@1000 : Record 36) : Boolean;
    BEGIN
      NameAddressDetails := DropShptNameAddressDetails;
      DropShptNameAddressDetails :=
        SalesHeader."Ship-to Name" + SalesHeader."Ship-to Name 2" +
        SalesHeader."Ship-to Address" + SalesHeader."Ship-to Address 2" +
        SalesHeader."Ship-to Post Code" + SalesHeader."Ship-to City" +
        SalesHeader."Ship-to Contact";
      IF NameAddressDetails = '' THEN
        NameAddressDetails := DropShptNameAddressDetails;
      EXIT(NameAddressDetails = DropShptNameAddressDetails);
    END;

    PROCEDURE AddSpecialOrderToAddress@80(SalesHeader@1000 : Record 36;ShowError@1001 : Boolean);
    VAR
      PurchLine3@1003 : Record 39;
      LocationCode@1004 : Record 14;
    BEGIN
      IF ShowError THEN BEGIN
        PurchLine3.RESET;
        PurchLine3.SETRANGE("Document Type","Document Type"::Order);
        PurchLine3.SETRANGE("Document No.","No.");
        IF NOT PurchLine3.ISEMPTY THEN BEGIN
          LocationCode.GET("Location Code");
          IF "Ship-to Name" <> LocationCode.Name THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Name"),"No.",SalesHeader."No.");
          IF "Ship-to Name 2" <> LocationCode."Name 2" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Name 2"),"No.",SalesHeader."No.");
          IF "Ship-to Address" <> LocationCode.Address THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Address"),"No.",SalesHeader."No.");
          IF "Ship-to Address 2" <> LocationCode."Address 2" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Address 2"),"No.",SalesHeader."No.");
          IF "Ship-to Post Code" <> LocationCode."Post Code" THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Post Code"),"No.",SalesHeader."No.");
          IF "Ship-to City" <> LocationCode.City THEN
            ERROR(Text052,FIELDCAPTION("Ship-to City"),"No.",SalesHeader."No.");
          IF "Ship-to Contact" <> LocationCode.Contact THEN
            ERROR(Text052,FIELDCAPTION("Ship-to Contact"),"No.",SalesHeader."No.");
        END ELSE
          SetShipToForSpecOrder;
      END;
    END;

    PROCEDURE CheckSpecOrderAddressDetails@82(SalesHeader@1000 : Record 36) : Boolean;
    VAR
      LocationCode@1001 : Record 14;
    BEGIN
      NameAddressDetails := SpecOrderNameAddressDetails;
      IF LocationCode.GET(SalesHeader."Location Code") THEN
        SpecOrderNameAddressDetails :=
          LocationCode.Name + LocationCode."Name 2" +
          LocationCode.Address + LocationCode."Address 2" +
          LocationCode."Post Code" + LocationCode.City +
          LocationCode.Contact
      ELSE BEGIN
        CompanyInfo.GET;
        SpecOrderNameAddressDetails :=
          CompanyInfo."Ship-to Name" + CompanyInfo."Ship-to Name 2" +
          CompanyInfo."Ship-to Address" + CompanyInfo."Ship-to Address 2" +
          CompanyInfo."Ship-to Post Code" + CompanyInfo."Ship-to City" +
          CompanyInfo."Ship-to Contact";
      END;
      IF NameAddressDetails = '' THEN
        NameAddressDetails := SpecOrderNameAddressDetails;
      EXIT(NameAddressDetails = SpecOrderNameAddressDetails);
    END;

    LOCAL PROCEDURE InitRecOnVendUpdate@39();
    BEGIN
      IF NOT SkipInitialization THEN
        InitInsert;
    END;

    PROCEDURE InvoicedLineExists@56() : Boolean;
    VAR
      PurchLine@1000 : Record 39;
    BEGIN
      PurchLine.SETRANGE("Document Type","Document Type");
      PurchLine.SETRANGE("Document No.","No.");
      PurchLine.SETFILTER(Type,'<>%1',PurchLine.Type::" ");
      PurchLine.SETFILTER("Quantity Invoiced",'<>%1',0);
      EXIT(NOT PurchLine.ISEMPTY);
    END;

    PROCEDURE CreateDimSetForPrepmtAccDefaultDim@44();
    VAR
      PurchaseLine@1001 : Record 39;
      TempPurchaseLine@1002 : TEMPORARY Record 39;
    BEGIN
      PurchaseLine.SETRANGE("Document Type","Document Type");
      PurchaseLine.SETRANGE("Document No.","No.");
      PurchaseLine.SETFILTER("Prepmt. Amt. Inv.",'<>%1',0);
      IF PurchaseLine.FINDSET THEN
        REPEAT
          CollectParamsInBufferForCreateDimSet(TempPurchaseLine,PurchaseLine);
        UNTIL PurchaseLine.NEXT = 0;
      TempPurchaseLine.RESET;
      TempPurchaseLine.MARKEDONLY(FALSE);
      IF TempPurchaseLine.FINDSET THEN
        REPEAT
          PurchaseLine.CreateDim(DATABASE::"G/L Account",TempPurchaseLine."No.",
            DATABASE::Job,TempPurchaseLine."Job No.",
            DATABASE::"Responsibility Center",TempPurchaseLine."Responsibility Center",
            DATABASE::"Work Center",TempPurchaseLine."Work Center No.");
        UNTIL TempPurchaseLine.NEXT = 0;
    END;

    LOCAL PROCEDURE CollectParamsInBufferForCreateDimSet@49(VAR TempPurchaseLine@1000 : TEMPORARY Record 39;PurchaseLine@1001 : Record 39);
    VAR
      GenPostingSetup@1002 : Record 252;
      DefaultDimension@1003 : Record 352;
    BEGIN
      TempPurchaseLine.SETRANGE("Gen. Bus. Posting Group",PurchaseLine."Gen. Bus. Posting Group");
      TempPurchaseLine.SETRANGE("Gen. Prod. Posting Group",PurchaseLine."Gen. Prod. Posting Group");
      IF NOT TempPurchaseLine.FINDFIRST THEN BEGIN
        GenPostingSetup.GET(PurchaseLine."Gen. Bus. Posting Group",PurchaseLine."Gen. Prod. Posting Group");
        GenPostingSetup.TESTFIELD("Purch. Prepayments Account");
        DefaultDimension.SETRANGE("Table ID",DATABASE::"G/L Account");
        DefaultDimension.SETRANGE("No.",GenPostingSetup."Purch. Prepayments Account");
        InsertTempPurchaseLineInBuffer(TempPurchaseLine,PurchaseLine,
          GenPostingSetup."Purch. Prepayments Account",DefaultDimension.ISEMPTY);
      END ELSE
        IF NOT TempPurchaseLine.MARK THEN BEGIN
          TempPurchaseLine.SETRANGE("Job No.",PurchaseLine."Job No.");
          TempPurchaseLine.SETRANGE("Responsibility Center",PurchaseLine."Responsibility Center");
          TempPurchaseLine.SETRANGE("Work Center No.",PurchaseLine."Work Center No.");
          IF TempPurchaseLine.ISEMPTY THEN
            InsertTempPurchaseLineInBuffer(TempPurchaseLine,PurchaseLine,TempPurchaseLine."No.",FALSE)
        END;
    END;

    LOCAL PROCEDURE InsertTempPurchaseLineInBuffer@35(VAR TempPurchaseLine@1000 : TEMPORARY Record 39;PurchaseLine@1001 : Record 39;AccountNo@1002 : Code[20];DefaultDimenstionsNotExist@1003 : Boolean);
    BEGIN
      TempPurchaseLine.INIT;
      TempPurchaseLine."Line No." := PurchaseLine."Line No.";
      TempPurchaseLine."No." := AccountNo;
      TempPurchaseLine."Job No." := PurchaseLine."Job No.";
      TempPurchaseLine."Responsibility Center" := PurchaseLine."Responsibility Center";
      TempPurchaseLine."Work Center No." := PurchaseLine."Work Center No.";
      TempPurchaseLine."Gen. Bus. Posting Group" := PurchaseLine."Gen. Bus. Posting Group";
      TempPurchaseLine."Gen. Prod. Posting Group" := PurchaseLine."Gen. Prod. Posting Group";
      TempPurchaseLine.MARK := DefaultDimenstionsNotExist;
      TempPurchaseLine.INSERT;
    END;

    PROCEDURE OpenPurchaseOrderStatistics@60();
    BEGIN
      CalcInvDiscForHeader;
      CreateDimSetForPrepmtAccDefaultDim;
      COMMIT;
      PAGE.RUNMODAL(PAGE::"Purchase Order Statistics",Rec);
    END;

    PROCEDURE GetCardpageID@58() : Integer;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::Quote:
          EXIT(PAGE::"Purchase Quote");
        "Document Type"::Order:
          EXIT(PAGE::"Purchase Order");
        "Document Type"::Invoice:
          EXIT(PAGE::"Purchase Invoice");
        "Document Type"::"Credit Memo":
          EXIT(PAGE::"Purchase Credit Memo");
        "Document Type"::"Blanket Order":
          EXIT(PAGE::"Blanket Purchase Order");
        "Document Type"::"Return Order":
          EXIT(PAGE::"Purchase Return Order");
      END;
    END;

    [Integration(TRUE)]
    PROCEDURE OnCheckPurchasePostRestrictions@54();
    BEGIN
    END;

    [Integration(TRUE)]
    PROCEDURE OnCheckPurchaseReleaseRestrictions@55();
    BEGIN
    END;

    PROCEDURE SetStatus@53(NewStatus@1000 : Option);
    BEGIN
      Status := NewStatus;
      MODIFY;
    END;

    PROCEDURE TriggerOnAfterPostPurchaseDoc@116(VAR GenJnlPostLine@1001 : Codeunit 12;PurchRcpHdrNo@1002 : Code[20];RetShptHdrNo@1003 : Code[20];PurchInvHdrNo@1004 : Code[20];PurchCrMemoHdrNo@1005 : Code[20]);
    VAR
      PurchPost@1000 : Codeunit 90;
    BEGIN
      PurchPost.OnAfterPostPurchaseDoc(Rec,GenJnlPostLine,PurchRcpHdrNo,RetShptHdrNo,PurchInvHdrNo,PurchCrMemoHdrNo);
    END;

    PROCEDURE DeferralHeadersExist@38() : Boolean;
    VAR
      DeferralHeader@1000 : Record 1701;
      DeferralUtilities@1001 : Codeunit 1720;
    BEGIN
      DeferralHeader.SETRANGE("Deferral Doc. Type",DeferralUtilities.GetPurchDeferralDocType);
      DeferralHeader.SETRANGE("Gen. Jnl. Template Name",'');
      DeferralHeader.SETRANGE("Gen. Jnl. Batch Name",'');
      DeferralHeader.SETRANGE("Document Type","Document Type");
      DeferralHeader.SETRANGE("Document No.","No.");
      EXIT(NOT DeferralHeader.ISEMPTY);
    END;

    LOCAL PROCEDURE ConfirmUpdateDeferralDate@85();
    BEGIN
      IF HideValidationDialog THEN
        Confirmed := TRUE
      ELSE
        Confirmed := CONFIRM(DeferralLineQst,FALSE,FIELDCAPTION("Posting Date"));
      IF Confirmed THEN
        UpdatePurchLines(PurchLine.FIELDCAPTION("Deferral Code"),FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Table 91 User Setup
{
  OBJECT-PROPERTIES
  {
    Date=30.04.18;
    Time=18:36:25;
    Modified=Yes;
    Version List=NAVW19.00.00.44974,CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               CMGenMgt.UserSetupOnInsert(Rec); //CM
             END;

    OnDelete=VAR
               NotificationSetup@1000 : Record 1512;
             BEGIN
               NotificationSetup.SETRANGE("User ID","User ID");
               NotificationSetup.DELETEALL(TRUE);
             END;

    OnRename=BEGIN
               CMGenMgt.UserSetupOnRename(Rec,xRec); //CM
             END;

    CaptionML=[ENU=User Setup;
               DEA=Benutzer Einrichtung];
    LookupPageID=Page119;
    DrillDownPageID=Page119;
  }
  FIELDS
  {
    { 1   ;   ;User ID             ;Code50        ;TableRelation=User."User Name";
                                                   OnValidate=VAR
                                                                UserMgt@1000 : Codeunit 418;
                                                              BEGIN
                                                                UserMgt.ValidateUserID("User ID");
                                                              END;

                                                   OnLookup=VAR
                                                              UserMgt@1000 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("User ID");
                                                            END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=User ID;
                                                              DEA=Benutzer-ID];
                                                   NotBlank=Yes }
    { 2   ;   ;Allow Posting From  ;Date          ;CaptionML=[ENU=Allow Posting From;
                                                              DEA=Buchungen zugel. ab] }
    { 3   ;   ;Allow Posting To    ;Date          ;CaptionML=[ENU=Allow Posting To;
                                                              DEA=Buchungen zugel. bis] }
    { 4   ;   ;Register Time       ;Boolean       ;CaptionML=[ENU=Register Time;
                                                              DEA=Protokollzeit] }
    { 10  ;   ;Salespers./Purch. Code;Code10      ;TableRelation=Salesperson/Purchaser.Code;
                                                   OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Salespers./Purch. Code" <> '' THEN BEGIN
                                                                  UserSetup.SETCURRENTKEY("Salespers./Purch. Code");
                                                                  UserSetup.SETRANGE("Salespers./Purch. Code","Salespers./Purch. Code");
                                                                  IF UserSetup.FINDFIRST THEN
                                                                    ERROR(Text001,"Salespers./Purch. Code",UserSetup."User ID");
                                                                END;
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Salespers./Purch. Code;
                                                              DEA=Verk.-/Eink„ufercode] }
    { 11  ;   ;Approver ID         ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                IF "Approver ID" = "User ID" THEN
                                                                  FIELDERROR("Approver ID");
                                                              END;

                                                   OnLookup=VAR
                                                              UserSetup@1000 : Record 91;
                                                            BEGIN
                                                              UserSetup.SETFILTER("User ID",'<>%1',"User ID");
                                                              IF PAGE.RUNMODAL(PAGE::"Approval User Setup",UserSetup) = ACTION::LookupOK THEN
                                                                VALIDATE("Approver ID",UserSetup."User ID");
                                                            END;

                                                   CaptionML=[ENU=Approver ID;
                                                              DEA=Genehmiger-ID] }
    { 12  ;   ;Sales Amount Approval Limit;Integer;OnValidate=BEGIN
                                                                IF "Unlimited Sales Approval" AND ("Sales Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Sales Amount Approval Limit"),FIELDCAPTION("Unlimited Sales Approval"));
                                                                IF "Sales Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Sales Amount Approval Limit;
                                                              DEA=Grenzbetrag fr Verkauf];
                                                   BlankZero=Yes }
    { 13  ;   ;Purchase Amount Approval Limit;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Unlimited Purchase Approval" AND ("Purchase Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Purchase Amount Approval Limit"),FIELDCAPTION("Unlimited Purchase Approval"));
                                                                IF "Purchase Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Purchase Amount Approval Limit;
                                                              DEA=Grenzbetrag fr Einkauf];
                                                   BlankZero=Yes }
    { 14  ;   ;Unlimited Sales Approval;Boolean   ;OnValidate=BEGIN
                                                                IF "Unlimited Sales Approval" THEN
                                                                  "Sales Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Sales Approval;
                                                              DEA=Unbegrenzte Verkaufsgenehmigung] }
    { 15  ;   ;Unlimited Purchase Approval;Boolean;OnValidate=BEGIN
                                                                IF "Unlimited Purchase Approval" THEN
                                                                  "Purchase Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Purchase Approval;
                                                              DEA=Unbegrenzte Einkaufsgenehmigung] }
    { 16  ;   ;Substitute          ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                IF Substitute = "User ID" THEN
                                                                  FIELDERROR(Substitute);
                                                              END;

                                                   OnLookup=VAR
                                                              UserSetup@1000 : Record 91;
                                                            BEGIN
                                                              UserSetup.SETFILTER("User ID",'<>%1',"User ID");
                                                              IF PAGE.RUNMODAL(PAGE::"Approval User Setup",UserSetup) = ACTION::LookupOK THEN
                                                                VALIDATE(Substitute,UserSetup."User ID");
                                                            END;

                                                   CaptionML=[ENU=Substitute;
                                                              DEA=Stellvertreter] }
    { 17  ;   ;E-Mail              ;Text100       ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail;
                                                              DEA=E-Mail] }
    { 19  ;   ;Request Amount Approval Limit;Integer;
                                                   OnValidate=BEGIN
                                                                IF "Unlimited Request Approval" AND ("Request Amount Approval Limit" <> 0) THEN
                                                                  ERROR(Text003,FIELDCAPTION("Request Amount Approval Limit"),FIELDCAPTION("Unlimited Request Approval"));
                                                                IF "Request Amount Approval Limit" < 0 THEN
                                                                  ERROR(Text005);
                                                              END;

                                                   CaptionML=[ENU=Request Amount Approval Limit;
                                                              DEA=Grenzbetrag fr Anfrageanforderung];
                                                   BlankZero=Yes }
    { 20  ;   ;Unlimited Request Approval;Boolean ;OnValidate=BEGIN
                                                                IF "Unlimited Request Approval" THEN
                                                                  "Request Amount Approval Limit" := 0;
                                                              END;

                                                   CaptionML=[ENU=Unlimited Request Approval;
                                                              DEA=Unbegrenzte Anfragegenehmigung] }
    { 21  ;   ;Approval Administrator;Boolean     ;OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Approval Administrator" THEN BEGIN
                                                                  UserSetup.SETRANGE("Approval Administrator",TRUE);
                                                                  IF NOT UserSetup.ISEMPTY THEN
                                                                    FIELDERROR("Approval Administrator");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Approval Administrator;
                                                              DEA=Genehmigungsadministrator] }
    { 950 ;   ;Time Sheet Admin.   ;Boolean       ;CaptionML=[ENU=Time Sheet Admin.;
                                                              DEA=Arbeitszeittabellenadministrator] }
    { 5600;   ;Allow FA Posting From;Date         ;CaptionML=[ENU=Allow FA Posting From;
                                                              DEA=Anlagenbuchungen zugel. ab] }
    { 5601;   ;Allow FA Posting To ;Date          ;CaptionML=[ENU=Allow FA Posting To;
                                                              DEA=Anlagenbuchungen zugel. bis] }
    { 5700;   ;Sales Resp. Ctr. Filter;Code10     ;TableRelation="Responsibility Center".Code;
                                                   CaptionML=[ENU=Sales Resp. Ctr. Filter;
                                                              DEA=Verk.-Zust„ndigk.-Einh. Filter] }
    { 5701;   ;Purchase Resp. Ctr. Filter;Code10  ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Purchase Resp. Ctr. Filter;
                                                              DEA=Eink.-Zust„ndigk.-Einh. Filter] }
    { 5900;   ;Service Resp. Ctr. Filter;Code10   ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Service Resp. Ctr. Filter;
                                                              DEA=Serv.-Zust„ndigk.-Einh. Filter] }
    { 50008;  ;IG PO Resp. Ctr. Filter;Text80     ;TableRelation="Responsibility Center";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=CMMS Purch. Order Resp. Ctr. Filter;
                                                              DEA=CMMS Bestellungen -Zust„ndigk.-Einh. Filter];
                                                   Description=CMMS }
    { 50009;  ;IG Asset Resp. Ctr. Filter;Text80  ;TableRelation="Responsibility Center";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Asset Resp. Ctr. Filter;
                                                              DEA=Anlagen.-Zust„ndigk.-Einh. Filter];
                                                   Description=CMMS }
    { 50010;  ;IG Project Resp. Ctr. Filter;Text80;TableRelation="Responsibility Center";
                                                   ValidateTableRelation=No;
                                                   CaptionML=[ENU=Project Resp. Ctr. Filter;
                                                              DEA=Projekt-Zust„ndigk.-Einh. Filter];
                                                   Description=CMMS }
    { 50050;  ;IG Paraph           ;Code5         ;CaptionML=[ENU=Paraph;
                                                              DEA=Paraphe];
                                                   Description=CMMS }
    { 50110;  ;IG Phone No.        ;Text50        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              DEA=Telefonnr.];
                                                   Description=CMMS }
    { 50120;  ;IG Fax No.          ;Text50        ;CaptionML=[ENU=Fax No.;
                                                              DEA=Faxnr.];
                                                   Description=CMMS }
    { 50200;  ;IG Function Code    ;Code20        ;OnValidate=VAR
                                                                IGCodeData@1000000000 : Record 70006;
                                                              BEGIN
                                                                // ++ IG_001_20150921_DU
                                                                IF "IG Function Code" <> '' THEN
                                                                IGCodeData.ValidateCodeData(
                                                                  DATABASE::"User Setup",
                                                                  FIELDNO("IG Function Code"),
                                                                  0,
                                                                  "IG Function Code");
                                                                // ++ IG_001_20150921_DU
                                                              END;

                                                   OnLookup=VAR
                                                              IGCodeData@1160000 : Record 70006;
                                                            BEGIN
                                                              // ++ IG_001_20150921_DU
                                                              IGCodeData.LookupCodeData(
                                                                DATABASE::"User Setup",
                                                                FIELDNO("IG Function Code"),
                                                                0,
                                                                "IG Function Code")
                                                              // ++ IG_001_20150921_DU
                                                            END;

                                                   CaptionML=[ENU=Function Code;
                                                              DEA=Funktionscode];
                                                   Description=CMMS }
    { 50310;  ;IG Resource No.     ;Code20        ;TableRelation=Resource.No.;
                                                   CaptionML=[ENU=Resource No.;
                                                              DEA=Ressourcennr.];
                                                   Description=CMMS }
    { 51000;  ;IG Asset Administrator;Boolean     ;OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Approval Administrator" THEN BEGIN
                                                                  UserSetup.SETRANGE("Approval Administrator",TRUE);
                                                                  IF NOT UserSetup.ISEMPTY THEN
                                                                    FIELDERROR("Approval Administrator");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Asset Administrator;
                                                              DEA=Anlagenadministrator];
                                                   Description=CMMS }
    { 51010;  ;IG Project Administrator;Boolean   ;OnValidate=VAR
                                                                UserSetup@1000 : Record 91;
                                                              BEGIN
                                                                IF "Approval Administrator" THEN BEGIN
                                                                  UserSetup.SETRANGE("Approval Administrator",TRUE);
                                                                  IF NOT UserSetup.ISEMPTY THEN
                                                                    FIELDERROR("Approval Administrator");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Project Administrator;
                                                              DEA=Projektadministrator];
                                                   Description=CMMS }
    { 51020;  ;IG Workorder Administrator;Boolean ;CaptionML=[ENU=Work Order Administrator;
                                                              DEA=Arbeitsautrag Administrator];
                                                   Description=CMMS }
    { 52000;  ;CM Salesperson Code ;Code20        ;TableRelation=Salesperson/Purchaser.Code;
                                                   CaptionML=[ENU=Salesperson Code;
                                                              DEA=Verk„ufer Code];
                                                   Description=CMMS }
    { 52010;  ;CM Name             ;Text80        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(User ID)));
                                                   CaptionML=[ENU=Name;
                                                              DEA=Name];
                                                   Description=CMMS FF;
                                                   Editable=No }
    { 52020;  ;CM Timetrack. Revers. Allowed;Boolean;
                                                   CaptionML=[ENU=Timetracking Reversal Allowed;
                                                              DEA=Zeiterfassung Storno erlaubt] }
    { 52030;  ;CM Substitution Admin;Boolean      ;CaptionML=[ENU=Substitution Admin;
                                                              DEA=Vertreter Administrator] }
    { 52040;  ;CM User Admin       ;Boolean       ;CaptionML=[ENU=User Admin;
                                                              DEA=Benutzer Administrator] }
    { 52050;  ;CM Timetrack. Mandatory;Boolean    ;CaptionML=[ENU=Timetracking Mandatory;
                                                              DEA=Zeiterfassung Pflicht] }
    { 52060;  ;CM Change Oper. Status Allowed;Boolean;
                                                   CaptionML=[ENU=Change Operational Status Allowed;
                                                              DEA=Operational Status warten erlaubt] }
    { 52070;  ;CM Discard Workorders Allowed;Boolean;
                                                   CaptionML=ENU=Discard Workorders Allowed }
    { 53000;  ;CM Notifications    ;Boolean       ;CaptionML=ENU=Notifications }
    { 53100;  ;CM Connector        ;Option        ;CaptionML=ENU=Connector;
                                                   OptionString=[ ,Email,Skype] }
    { 53110;  ;CM Connector Id     ;Text80        ;CaptionML=ENU=Connector Id (Optional) }
    { 53200;  ;CM Notification 1   ;Boolean       ;CaptionML=ENU=New Workorder assigned to me;
                                                   Description=New Workorder assigned to me }
    { 53201;  ;CM Notification 2   ;Boolean       ;CaptionML=ENU=Workorder assigned to me;
                                                   Description=Workorder assigned to me }
    { 53202;  ;CM Notification 3   ;Boolean       ;CaptionML=ENU=My Workorder status changed;
                                                   Description=My Workorder - status changed }
    { 53203;  ;CM Notification 4   ;Boolean       ;CaptionML=ENU=My Workorder - new Task;
                                                   Description=My Workorder - new Task }
    { 53204;  ;CM Notification 5   ;Boolean       ;CaptionML=ENU=Task assigend to me;
                                                   Description=Task assigend to me }
    { 53205;  ;CM Notification 6   ;Boolean       ;CaptionML=ENU=My Task - status changed;
                                                   Description=My Task - status changed }
    { 75000;  ;CM Time Tracking Qty.;Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(CM Date Filter),
                                                                                                            CM User ID=FIELD(User ID)));
                                                   Editable=No }
    { 80000;  ;CM No. of WOs (Due Date);Integer   ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Assigned User ID=FIELD(User ID),
                                                                                        CM Due Date=FIELD(CM Date Filter),
                                                                                        CM Status=FIELD(CM Status Filter)));
                                                   Editable=No }
    { 85000;  ;CM No. of To-dos  (Due Date);Integer;
                                                   FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Assigned User ID=FIELD(User ID),
                                                                                  Date=FIELD(CM Date Filter),
                                                                                  CM Status=FIELD(CM Status Filter)));
                                                   Editable=No }
    { 90000;  ;CM Date Filter      ;Date          ;FieldClass=FlowFilter;
                                                   Editable=No }
    { 90010;  ;CM Status Filter    ;Option        ;FieldClass=FlowFilter;
                                                   OptionString=0,1,2,3,4,5,6,7,8,9,10 }
  }
  KEYS
  {
    {    ;User ID                                 ;Clustered=Yes }
    {    ;Salespers./Purch. Code                   }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;User ID,CM Name                          }
  }
  CODE
  {
    VAR
      Text001@1000 : TextConst 'ENU=The %1 Salesperson/Purchaser code is already assigned to another User ID %2.;DEA=Der Verk„ufer-/Eink„ufercode ''%1'' ist bereits einer anderen Benutzer-ID ''%2'' zugewiesen.';
      Text003@1002 : TextConst 'ENU="You cannot have both a %1 and %2. ";DEA="%1 und %2 k”nnen nicht zugleich vorhanden sein. "';
      Text005@1004 : TextConst 'ENU=You cannot have approval limits less than zero.;DEA=Die Genehmigungsgrenzwerte k”nnen nicht kleiner als Null sein.';
      CMGenMgt@1000000000 : Codeunit 70000;

    BEGIN
    END.
  }
}

OBJECT Table 370 Excel Buffer
{
  OBJECT-PROPERTIES
  {
    Date=07.09.17;
    Time=15:10:23;
    Modified=Yes;
    Version List=NAVW19.00,ENC,CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Excel Buffer;
               DEA=Excelpuffer];
  }
  FIELDS
  {
    { 1   ;   ;Row No.             ;Integer       ;OnValidate=BEGIN
                                                                xlRowID := '';
                                                                IF "Row No." <> 0 THEN
                                                                  xlRowID := FORMAT("Row No.");
                                                              END;

                                                   CaptionML=[ENU=Row No.;
                                                              DEA=Zeilennr.] }
    { 2   ;   ;xlRowID             ;Text10        ;CaptionML=[ENU=xlRowID;
                                                              DEA=XlZeileID] }
    { 3   ;   ;Column No.          ;Integer       ;OnValidate=VAR
                                                                x@1000 : Integer;
                                                                i@1001 : Integer;
                                                                y@1003 : Integer;
                                                                c@1002 : Char;
                                                                t@1102601000 : Text[30];
                                                              BEGIN
                                                                xlColID := '';
                                                                x := "Column No.";
                                                                WHILE x > 26 DO BEGIN
                                                                  y := x MOD 26;
                                                                  IF y = 0 THEN
                                                                    y := 26;
                                                                  c := 64 + y;
                                                                  i := i + 1;
                                                                  t[i] := c;
                                                                  x := (x - y) DIV 26;
                                                                END;
                                                                IF x > 0 THEN BEGIN
                                                                  c := 64 + x;
                                                                  i := i + 1;
                                                                  t[i] := c;
                                                                END;
                                                                FOR x := 1 TO i DO
                                                                  xlColID[x] := t[1 + i - x];
                                                              END;

                                                   CaptionML=[ENU=Column No.;
                                                              DEA=Spaltennr.] }
    { 4   ;   ;xlColID             ;Text10        ;CaptionML=[ENU=xlColID;
                                                              DEA=XlSpalteID] }
    { 5   ;   ;Cell Value as Text  ;Text250       ;CaptionML=[ENU=Cell Value as Text;
                                                              DEA=Zellenwert als Text] }
    { 6   ;   ;Comment             ;Text250       ;CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung] }
    { 7   ;   ;Formula             ;Text250       ;CaptionML=[ENU=Formula;
                                                              DEA=Formel] }
    { 8   ;   ;Bold                ;Boolean       ;CaptionML=[ENU=Bold;
                                                              DEA=Fett] }
    { 9   ;   ;Italic              ;Boolean       ;CaptionML=[ENU=Italic;
                                                              DEA=Kursiv] }
    { 10  ;   ;Underline           ;Boolean       ;CaptionML=[ENU=Underline;
                                                              DEA=Unterstrichen] }
    { 11  ;   ;NumberFormat        ;Text30        ;CaptionML=[ENU=NumberFormat;
                                                              DEA=Nummernformat] }
    { 12  ;   ;Formula2            ;Text250       ;CaptionML=[ENU=Formula2;
                                                              DEA=Formel 2] }
    { 13  ;   ;Formula3            ;Text250       ;CaptionML=[ENU=Formula3;
                                                              DEA=Formel 3] }
    { 14  ;   ;Formula4            ;Text250       ;CaptionML=[ENU=Formula4;
                                                              DEA=Formel 4] }
    { 15  ;   ;Cell Type           ;Option        ;CaptionML=[ENU=Cell Type;
                                                              DEA=Zellentyp];
                                                   OptionCaptionML=[ENU=Number,Text,Date,Time;
                                                                    DEA=Nummer,Text,Datum,Uhrzeit];
                                                   OptionString=Number,Text,Date,Time }
    { 16  ;   ;Double Underline    ;Boolean       ;CaptionML=[ENU=Double Underline;
                                                              DEA=Doppelt unterstrichen] }
    { 50000;  ;BlobValue           ;BLOB           }
  }
  KEYS
  {
    {    ;Row No.,Column No.                      ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst '@@@="{Locked=""Excel""}";ENU=Excel not found.;DEA=Excel wurde nicht gefunden.';
      Text001@1001 : TextConst 'ENU=You must enter a file name.;DEA=Sie mssen einen Dateinamen angeben.';
      Text002@1002 : TextConst '@@@="{Locked=""Excel""}";ENU=You must enter an Excel worksheet name.;DEA=Sie mssen einen Exceltabellennamen angeben.';
      Text003@1003 : TextConst 'ENU=The file %1 does not exist.;DEA=Die Datei %1 ist nicht vorhanden.';
      Text004@1004 : TextConst '@@@="{Locked=""Excel""}";ENU=The Excel worksheet %1 does not exist.;DEA=Die Exceltabelle %1 ist nicht vorhanden.';
      Text005@1005 : TextConst '@@@="{Locked=""Excel""}";ENU=Creating Excel worksheet...\\;DEA=Excel-Arbeitsbl. erstellen...\\';
      Text006@1006 : TextConst 'ENU=%1%3%4%3Page %2;DEA=%1%3%4%3Seite %2';
      Text007@1007 : TextConst '@@@="{Locked=""Excel""}";ENU=Reading Excel worksheet...\\;DEA=Excel-Arbeitsbl. lesen...\\';
      Text013@1013 : TextConst 'ENU=&B;DEA=&B';
      Text014@1014 : TextConst 'ENU=&D;DEA=&D';
      Text015@1015 : TextConst 'ENU=&P;DEA=&P';
      Text016@1016 : TextConst 'ENU=A1;DEA=A1';
      Text017@1017 : TextConst 'ENU=SUMIF;DEA=SUMIF';
      Text018@1018 : TextConst 'ENU=#N/A;DEA=#N/A';
      Text019@1019 : TextConst '@@@={Locked} Used to define an Excel range name. You must refer to Excel rules to change this term.;ENU=GLAcc;DEA=GLAcc';
      Text020@1020 : TextConst '@@@={Locked} Used to define an Excel range name. You must refer to Excel rules to change this term.;ENU=Period;DEA=Period';
      Text021@1021 : TextConst 'ENU=Budget;DEA=Budget';
      InfoExcelBuf@1036 : TEMPORARY Record 370;
      FileManagement@1045 : Codeunit 419;
      XlWrkBkWriter@1022 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorkbookWriter";
      XlWrkBkReader@1023 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorkbookReader";
      XlWrkShtWriter@1024 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorksheetWriter";
      XlWrkShtReader@1043 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorksheetReader";
      XlApp@1044 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.ApplicationClass" RUNONCLIENT;
      XlWrkBk@1051 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Workbook" RUNONCLIENT;
      XlWrkSht@1009 : DotNet "'Microsoft.Office.Interop.Excel, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.Microsoft.Office.Interop.Excel.Worksheet" RUNONCLIENT;
      XlHelper@1052 : DotNet "'Microsoft.Dynamics.Nav.Integration.Office, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Integration.Office.Excel.ExcelHelper" RUNONCLIENT;
      ActiveSheetName@1049 : Text[250];
      RangeStartXlRow@1034 : Text[30];
      RangeStartXlCol@1033 : Text[30];
      RangeEndXlRow@1032 : Text[30];
      RangeEndXlCol@1031 : Text[30];
      FileNameServer@1046 : Text;
      FriendlyName@1025 : Text;
      CurrentRow@1029 : Integer;
      CurrentCol@1030 : Integer;
      UseInfoSheet@1035 : Boolean;
      Text022@1041 : TextConst '@@@={Locked} Used to define an Excel range name. You must refer to Excel rules to change this term.;ENU=CostAcc;DEA=CostAcc';
      Text023@1037 : TextConst 'ENU=Information;DEA=Informationen';
      Text034@1039 : TextConst '@@@="{Split=r''\|\*\..{1,4}\|?''}{Locked=""Excel""}";ENU=Excel Files (*.xls*)|*.xls*|All Files (*.*)|*.*;DEA=Excel-Dateien (*.xls*)|*.xls*|Alle Dateien (*.*)|*.*';
      Text035@1040 : TextConst 'ENU=The operation was canceled.;DEA=Der Vorgang wurde abgebrochen.';
      Text036@1042 : TextConst '@@@="{Locked=""Excel""}";ENU=The Excel workbook does not exist.;DEA=Die Excel-Tabelle ist nicht vorhanden.';
      Text037@1047 : TextConst '@@@="{Locked=""Excel""}";ENU=Could not create the Excel workbook.;DEA=Die Excel-Tabelle konnte nicht erstellt werden.';
      Text038@1048 : TextConst 'ENU=Global variable %1 is not included for test.;DEA=Die globale Variable ''%1'' ist nicht fr den Test enthalten.';
      Text039@1050 : TextConst 'ENU=Cell type has not been set.;DEA=Die Zellenart wurde nicht definiert.';
      Text040@1008 : TextConst '@@@="{Locked=""Excel""}";ENU=Export Excel File;DEA=Excel-Datei exportieren';
      SavingDocumentMsg@1010 : TextConst 'ENU=Saving the following document: %1.;DEA=Das folgende Dokument wird gespeichert: %1.';
      ExcelFileExtensionTok@1012 : TextConst '@@@={Locked};ENU=.xlsx;DEA=.xlsx';
      IGUseFill@1000000001 : Boolean;
      IGFill@1000000002 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.Fill";

    PROCEDURE CreateBook@1(FileName@1001 : Text;SheetName@1000 : Text[250]);
    BEGIN
      IF SheetName = '' THEN
        ERROR(Text002);

      IF FileName = '' THEN
        FileNameServer := FileManagement.ServerTempFileName('xlsx')
      ELSE BEGIN
        IF EXISTS(FileName) THEN
          ERASE(FileName);
        FileNameServer := FileName;
      END;

      XlWrkBkWriter := XlWrkBkWriter.Create(FileNameServer);
      IF ISNULL(XlWrkBkWriter) THEN
        ERROR(Text037);

      XlWrkShtWriter := XlWrkBkWriter.FirstWorksheet;
      IF SheetName <> '' THEN BEGIN
        XlWrkShtWriter.Name := SheetName;
        ActiveSheetName := SheetName;
      END
    END;

    PROCEDURE OpenBook@2(FileName@1000 : Text;SheetName@1001 : Text[250]);
    BEGIN
      IF FileName = '' THEN
        ERROR(Text001);

      IF SheetName = '' THEN
        ERROR(Text002);

      XlWrkBkReader := XlWrkBkReader.Open(FileName);
      IF XlWrkBkReader.HasWorksheet(SheetName) THEN BEGIN
        XlWrkShtReader := XlWrkBkReader.GetWorksheetByName(SheetName);
      END ELSE BEGIN
        QuitExcel;
        ERROR(Text004,SheetName);
      END;
    END;

    PROCEDURE UpdateBook@5(FileName@1000 : Text;SheetName@1001 : Text[250]);
    BEGIN
      IF FileName = '' THEN
        ERROR(Text001);

      IF SheetName = '' THEN
        ERROR(Text002);

      FileNameServer := FileName;
      XlWrkBkWriter := XlWrkBkWriter.Open(FileNameServer);
      IF XlWrkBkWriter.HasWorksheet(SheetName) THEN BEGIN
        XlWrkShtWriter := XlWrkBkWriter.GetWorksheetByName(SheetName);
        ActiveSheetName := SheetName;
      END ELSE BEGIN
        QuitExcel;
        ERROR(Text004,SheetName);
      END;
    END;

    PROCEDURE CloseBook@30();
    BEGIN
      IF NOT ISNULL(XlWrkBkWriter) THEN BEGIN
        XlWrkBkWriter.ClearFormulaCalculations;
        XlWrkBkWriter.ValidateDocument;
        XlWrkBkWriter.Close;
        CLEAR(XlWrkShtWriter);
        CLEAR(XlWrkBkWriter);
      END;

      IF NOT ISNULL(XlWrkBkReader) THEN BEGIN
        CLEAR(XlWrkShtReader);
        CLEAR(XlWrkBkReader);
      END;
    END;

    PROCEDURE WriteSheet@37(ReportHeader@1001 : Text;CompanyName2@1002 : Text;UserID2@1003 : Text);
    VAR
      ExcelBufferDialogMgt@1009 : Codeunit 5370;
      OrientationValues@1000 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.OrientationValues";
      CRLF@1008 : Char;
      RecNo@1010 : Integer;
      InfoRecNo@1012 : Integer;
      TotalRecNo@1011 : Integer;
      LastUpdate@1004 : DateTime;
    BEGIN
      LastUpdate := CURRENTDATETIME;
      ExcelBufferDialogMgt.Open(Text005);

      CRLF := 10;
      RecNo := 1;
      TotalRecNo := COUNT + InfoExcelBuf.COUNT;
      RecNo := 0;

      XlWrkShtWriter.AddPageSetup(OrientationValues.Landscape);

      // commit is required because of the result boolean check of ExcelBufferDialogMgt.RUN
      COMMIT;

      IF FINDSET THEN
        REPEAT
          RecNo := RecNo + 1;
          IF NOT UpdateProgressDialog(ExcelBufferDialogMgt,LastUpdate,RecNo,TotalRecNo) THEN BEGIN
            QuitExcel;
            ERROR(Text035)
          END;
          IF Formula = '' THEN
            WriteCellValue(Rec)
          ELSE
            WriteCellFormula(Rec)
        UNTIL NEXT = 0;

      IF ReportHeader <> '' THEN
        XlWrkShtWriter.AddHeader(
          TRUE,
          STRSUBSTNO('%1%2%1%3%4',GetExcelReference(1),ReportHeader,CRLF,CompanyName2));

      XlWrkShtWriter.AddHeader(
        FALSE,
        STRSUBSTNO(Text006,GetExcelReference(2),GetExcelReference(3),CRLF,UserID2));

      IF UseInfoSheet THEN
        IF InfoExcelBuf.FINDSET THEN BEGIN
          XlWrkShtWriter := XlWrkBkWriter.AddWorksheet(Text023);
          REPEAT
            InfoRecNo := InfoRecNo + 1;
            IF NOT UpdateProgressDialog(ExcelBufferDialogMgt,LastUpdate,RecNo + InfoRecNo,TotalRecNo) THEN BEGIN
              QuitExcel;
              ERROR(Text035)
            END;
            IF InfoExcelBuf.Formula = '' THEN
              WriteCellValue(InfoExcelBuf)
            ELSE
              WriteCellFormula(InfoExcelBuf)
          UNTIL InfoExcelBuf.NEXT = 0;
        END;

      ExcelBufferDialogMgt.Close;
    END;

    LOCAL PROCEDURE WriteCellValue@28(ExcelBuffer@1000 : Record 370);
    VAR
      Decorator@1001 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.CellDecorator";
    BEGIN
      WITH ExcelBuffer DO BEGIN
        GetCellDecorator(Bold,Italic,Underline,"Double Underline",Decorator);

        //++IG
        IF (IGUseFill) AND (NOT ISNULL(IGFill))THEN
          Decorator.Fill := IGFill;
        //--IG
        CASE "Cell Type" OF
          "Cell Type"::Number:
            XlWrkShtWriter.SetCellValueNumber("Row No.",xlColID,"Cell Value as Text",NumberFormat,Decorator);
          "Cell Type"::Text:
            XlWrkShtWriter.SetCellValueText("Row No.",xlColID,"Cell Value as Text", Decorator);
          "Cell Type"::Date:
            XlWrkShtWriter.SetCellValueDate("Row No.",xlColID,"Cell Value as Text",NumberFormat,Decorator);
          "Cell Type"::Time:
            XlWrkShtWriter.SetCellValueTime("Row No.",xlColID,"Cell Value as Text",NumberFormat,Decorator);
          ELSE
            ERROR(Text039)
        END;
      END;
    END;

    LOCAL PROCEDURE WriteCellFormula@38(ExcelBuffer@1000 : Record 370);
    VAR
      Decorator@1001 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.CellDecorator";
    BEGIN
      WITH ExcelBuffer DO BEGIN
        GetCellDecorator(Bold,Italic,Underline,"Double Underline",Decorator);

        XlWrkShtWriter.SetCellFormula("Row No.",xlColID,GetFormula,NumberFormat,Decorator);
      END;
    END;

    LOCAL PROCEDURE GetCellDecorator@33(IsBold@1000 : Boolean;IsItalic@1001 : Boolean;IsUnderlined@1002 : Boolean;IsDoubleUnderlined@1004 : Boolean;VAR Decorator@1003 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.CellDecorator");
    BEGIN
      IF IsBold AND IsItalic THEN BEGIN
        IF IsDoubleUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultBoldItalicDoubleUnderlinedCellDecorator;
          EXIT;
        END;
        IF IsUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultBoldItalicUnderlinedCellDecorator;
          EXIT;
        END;
      END;

      IF IsBold AND IsItalic THEN BEGIN
        Decorator := XlWrkShtWriter.DefaultBoldItalicCellDecorator;
        EXIT;
      END;

      IF IsBold THEN BEGIN
        IF IsDoubleUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultBoldDoubleUnderlinedCellDecorator;
          EXIT;
        END;
        IF IsUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultBoldUnderlinedCellDecorator;
          EXIT;
        END;
      END;

      IF IsBold THEN BEGIN
        Decorator := XlWrkShtWriter.DefaultBoldCellDecorator;
        EXIT;
      END;

      IF IsItalic THEN BEGIN
        IF IsDoubleUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultItalicDoubleUnderlinedCellDecorator;
          EXIT;
        END;
        IF IsUnderlined THEN BEGIN
          Decorator := XlWrkShtWriter.DefaultItalicUnderlinedCellDecorator;
          EXIT;
        END;
      END;

      IF IsItalic THEN BEGIN
        Decorator := XlWrkShtWriter.DefaultItalicCellDecorator;
        EXIT;
      END;

      IF IsDoubleUnderlined THEN
        Decorator := XlWrkShtWriter.DefaultDoubleUnderlinedCellDecorator
      ELSE BEGIN
        IF IsUnderlined THEN
          Decorator := XlWrkShtWriter.DefaultUnderlinedCellDecorator
        ELSE
          Decorator := XlWrkShtWriter.DefaultCellDecorator;
      END;
    END;

    PROCEDURE CreateRangeName@9(RangeName@1000 : Text[30];FromColumnNo@1001 : Integer;FromRowNo@1002 : Integer);
    VAR
      TempExcelBuf@1005 : TEMPORARY Record 370;
      ToxlRowID@1004 : Text[10];
    BEGIN
      SETCURRENTKEY("Row No.","Column No.");
      IF FIND('+') THEN
        ToxlRowID := xlRowID;
      TempExcelBuf.VALIDATE("Row No.",FromRowNo);
      TempExcelBuf.VALIDATE("Column No.",FromColumnNo);

      XlWrkShtWriter.AddRange(
        RangeName,
        GetExcelReference(4) + TempExcelBuf.xlColID + GetExcelReference(4) + TempExcelBuf.xlRowID +
        ':' +
        GetExcelReference(4) + TempExcelBuf.xlColID + GetExcelReference(4) + ToxlRowID);
    END;

    PROCEDURE GiveUserControl@3();
    BEGIN
      IF NOT ISNULL(XlApp) THEN BEGIN
        XlApp.Visible := TRUE;
        XlApp.UserControl := TRUE;
        CLEAR(XlApp);
      END;
    END;

    PROCEDURE ReadSheet@4();
    VAR
      ExcelBufferDialogMgt@1003 : Codeunit 5370;
      CellData@1002 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.CellData";
      Enumerator@1001 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.IEnumerator";
      i@1000 : Integer;
      RowCount@1009 : Integer;
      LastUpdate@1004 : DateTime;
    BEGIN
      LastUpdate := CURRENTDATETIME;
      ExcelBufferDialogMgt.Open(Text007);
      DELETEALL;

      Enumerator := XlWrkShtReader.GetEnumerator;
      RowCount := XlWrkShtReader.RowCount;
      WHILE Enumerator.MoveNext DO BEGIN
        CellData := Enumerator.Current;
        IF CellData.HasValue THEN BEGIN
          VALIDATE("Row No.",CellData.RowNumber);
          VALIDATE("Column No.",CellData.ColumnNumber);
          ParseCellValue(CellData.Value,CellData.Format);
          INSERT;
        END;

        i := i + 1;
        COMMIT;
        IF NOT UpdateProgressDialog(ExcelBufferDialogMgt,LastUpdate,i,RowCount) THEN BEGIN
          QuitExcel;
          ERROR(Text035)
        END;
      END;

      QuitExcel;
      ExcelBufferDialogMgt.Close;
    END;

    LOCAL PROCEDURE ParseCellValue@40(Value@1000 : Text;FormatString@1001 : Text);
    VAR
      Decimal@1004 : Decimal;
    BEGIN
      // The format contains only en-US number separators, this is an OpenXML standard requirement
      // The algorithm sieves the data based on formatting as follows (the steps must run in this order)
      // 1. FormatString = '@' -> Text
      // 2. FormatString.Contains(':') -> Time
      // 3. FormatString.ContainsOneOf('y', 'm', 'd') && FormatString.DoesNotContain('Red') -> Date
      // 4. anything else -> Decimal

      NumberFormat := COPYSTR(FormatString,1,30);

      IF FormatString = '@' THEN BEGIN
        "Cell Type" := "Cell Type"::Text;
        //++ENC
        IF STRLEN(Value) > 250 THEN BEGIN
          CMSetBlob(Value);
          "Cell Value as Text" := '';
        END
        ELSE BEGIN
          "Cell Value as Text" := Value;
          CMSetBlob('');
        END;
        //--ENC
        EXIT;
      END;

      EVALUATE(Decimal,Value);

      IF STRPOS(FormatString,':') <> 0 THEN BEGIN
        // Excel Time is stored in OADate format
        "Cell Type" := "Cell Type"::Time;
        "Cell Value as Text" := FORMAT(DT2TIME(ConvertDateTimeDecimalToDateTime(Decimal)));
        EXIT;
      END;

      IF ((STRPOS(FormatString,'y') <> 0) OR
          (STRPOS(FormatString,'m') <> 0) OR
          (STRPOS(FormatString,'d') <> 0)) AND
         (STRPOS(FormatString,'Red') = 0)
      THEN BEGIN
        "Cell Type" := "Cell Type"::Date;
        "Cell Value as Text" := FORMAT(DT2DATE(ConvertDateTimeDecimalToDateTime(Decimal)));
        EXIT;
      END;

      "Cell Type" := "Cell Type"::Number;
      "Cell Value as Text" := FORMAT(ROUND(Decimal,0.000001),0,1);
    END;

    PROCEDURE SelectSheetsName@6(FileName@1000 : Text) : Text[250];
    VAR
      TempNameValueBuffer@1009 : TEMPORARY Record 823;
      SheetNames@1008 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.ArrayList";
      SheetName@1002 : Text[250];
      SelectedSheetName@1007 : Text[250];
      i@1001 : Integer;
    BEGIN
      IF FileName = '' THEN
        ERROR(Text001);

      XlWrkBkReader := XlWrkBkReader.Open(FileName);

      SelectedSheetName := '';
      SheetNames := SheetNames.ArrayList(XlWrkBkReader.SheetNames);
      IF NOT ISNULL(SheetNames) THEN BEGIN
        FOR i := 0 TO SheetNames.Count - 1 DO BEGIN
          SheetName := SheetNames.Item(i);
          IF SheetName <> '' THEN BEGIN
            TempNameValueBuffer.INIT;
            TempNameValueBuffer.ID := i;
            TempNameValueBuffer.Name := FORMAT(i + 1);
            TempNameValueBuffer.Value := SheetName;
            TempNameValueBuffer.INSERT;
          END;
        END;
        IF NOT TempNameValueBuffer.ISEMPTY THEN
          IF TempNameValueBuffer.COUNT = 1 THEN
            SelectedSheetName := TempNameValueBuffer.Value
          ELSE BEGIN
            TempNameValueBuffer.FINDFIRST;
            IF PAGE.RUNMODAL(PAGE::"Name/Value Lookup",TempNameValueBuffer) = ACTION::LookupOK THEN
              SelectedSheetName := TempNameValueBuffer.Value;
          END;
      END;

      QuitExcel;
      EXIT(SelectedSheetName);
    END;

    PROCEDURE GetExcelReference@10(Which@1000 : Integer) : Text[250];
    BEGIN
      CASE Which OF
        1:
          EXIT(Text013);
        // DO NOT TRANSLATE: &B is the Excel code to turn bold printing on or off for customized Header/Footer.
        2:
          EXIT(Text014);
        // DO NOT TRANSLATE: &D is the Excel code to print the current date in customized Header/Footer.
        3:
          EXIT(Text015);
        // DO NOT TRANSLATE: &P is the Excel code to print the page number in customized Header/Footer.
        4:
          EXIT('$');
        // DO NOT TRANSLATE: $ is the Excel code for absolute reference to cells.
        5:
          EXIT(Text016);
        // DO NOT TRANSLATE: A1 is the Excel reference of the first cell.
        6:
          EXIT(Text017);
        // DO NOT TRANSLATE: SUMIF is the name of the Excel function used to summarize values according to some conditions.
        7:
          EXIT(Text018);
        // DO NOT TRANSLATE: The #N/A Excel error value occurs when a value is not available to a function or formula.
        8:
          EXIT(Text019);
        // DO NOT TRANSLATE: GLAcc is used to define an Excel range name. You must refer to Excel rules to change this term.
        9:
          EXIT(Text020);
        // DO NOT TRANSLATE: Period is used to define an Excel range name. You must refer to Excel rules to change this term.
        10:
          EXIT(Text021);
        // DO NOT TRANSLATE: Budget is used to define an Excel worksheet name. You must refer to Excel rules to change this term.
        11:
          EXIT(Text022);
        // DO NOT TRANSLATE: CostAcc is used to define an Excel range name. You must refer to Excel rules to change this term.
      END;
    END;

    PROCEDURE ExportBudgetFilterToFormula@11(VAR ExcelBuf@1000 : Record 370) : Boolean;
    VAR
      ExcelBufFormula@1001 : TEMPORARY Record 370;
      FirstRow@1002 : Integer;
      LastRow@1003 : Integer;
      HasFormulaError@1005 : Boolean;
      ThisCellHasFormulaError@1006 : Boolean;
      ExcelBufFormula2@1004 : TEMPORARY Record 370;
    BEGIN
      ExcelBuf.SETFILTER(Formula,'<>%1','');
      IF ExcelBuf.FINDSET THEN
        REPEAT
          ExcelBufFormula := ExcelBuf;
          ExcelBufFormula.INSERT;
        UNTIL ExcelBuf.NEXT = 0;
      ExcelBuf.RESET;

      WITH ExcelBufFormula DO
        IF FINDSET THEN
          REPEAT
            ThisCellHasFormulaError := FALSE;
            ExcelBuf.SETRANGE("Column No.",1);
            ExcelBuf.SETFILTER("Row No.",'<>%1',"Row No.");
            ExcelBuf.SETFILTER("Cell Value as Text",Formula);
            ExcelBufFormula2 := ExcelBufFormula;
            IF ExcelBuf.FINDSET THEN
              REPEAT
                IF NOT GET(ExcelBuf."Row No.","Column No.") THEN
                  ExcelBuf.MARK(TRUE);
              UNTIL ExcelBuf.NEXT = 0;
            ExcelBufFormula := ExcelBufFormula2;
            ClearFormula;
            ExcelBuf.SETRANGE("Cell Value as Text");
            ExcelBuf.SETRANGE("Row No.");
            IF ExcelBuf.FINDSET THEN
              REPEAT
                IF ExcelBuf.MARK THEN BEGIN
                  LastRow := ExcelBuf."Row No.";
                  IF FirstRow = 0 THEN
                    FirstRow := LastRow;
                END ELSE
                  IF FirstRow <> 0 THEN BEGIN
                    IF FirstRow = LastRow THEN
                      ThisCellHasFormulaError := AddToFormula(xlColID + FORMAT(FirstRow))
                    ELSE
                      ThisCellHasFormulaError :=
                        AddToFormula('SUM(' + xlColID + FORMAT(FirstRow) + ':' + xlColID + FORMAT(LastRow) + ')');
                    FirstRow := 0;
                    IF ThisCellHasFormulaError THEN
                      SetFormula(ExcelBuf.GetExcelReference(7));
                  END;
              UNTIL ThisCellHasFormulaError OR (ExcelBuf.NEXT = 0);

            IF NOT ThisCellHasFormulaError AND (FirstRow <> 0) THEN BEGIN
              IF FirstRow = LastRow THEN
                ThisCellHasFormulaError := AddToFormula(xlColID + FORMAT(FirstRow))
              ELSE
                ThisCellHasFormulaError :=
                  AddToFormula('SUM(' + xlColID + FORMAT(FirstRow) + ':' + xlColID + FORMAT(LastRow) + ')');
              FirstRow := 0;
              IF ThisCellHasFormulaError THEN
                SetFormula(ExcelBuf.GetExcelReference(7));
            END;

            ExcelBuf.RESET;
            ExcelBuf.GET("Row No.","Column No.");
            ExcelBuf.SetFormula(GetFormula);
            ExcelBuf.MODIFY;
            HasFormulaError := HasFormulaError OR ThisCellHasFormulaError;
          UNTIL NEXT = 0;

      EXIT(HasFormulaError);
    END;

    PROCEDURE AddToFormula@12(Text@1001 : Text[30]) : Boolean;
    VAR
      Overflow@1002 : Boolean;
      LongFormula@1000 : Text[1000];
    BEGIN
      LongFormula := GetFormula;
      IF LongFormula = '' THEN
        LongFormula := '=';
      IF LongFormula <> '=' THEN
        IF STRLEN(LongFormula) + 1 > MAXSTRLEN(LongFormula) THEN
          Overflow := TRUE
        ELSE
          LongFormula := LongFormula + '+';
      IF STRLEN(LongFormula) + STRLEN(Text) > MAXSTRLEN(LongFormula) THEN
        Overflow := TRUE
      ELSE
        SetFormula(LongFormula + Text);
      EXIT(Overflow);
    END;

    PROCEDURE GetFormula@13() : Text[1000];
    BEGIN
      EXIT(Formula + Formula2 + Formula3 + Formula4);
    END;

    PROCEDURE SetFormula@22(LongFormula@1000 : Text[1000]);
    BEGIN
      ClearFormula;
      IF LongFormula = '' THEN
        EXIT;

      Formula := COPYSTR(LongFormula,1,MAXSTRLEN(Formula));
      IF STRLEN(LongFormula) > MAXSTRLEN(Formula) THEN
        Formula2 := COPYSTR(LongFormula,MAXSTRLEN(Formula) + 1,MAXSTRLEN(Formula2));
      IF STRLEN(LongFormula) > MAXSTRLEN(Formula) + MAXSTRLEN(Formula2) THEN
        Formula3 := COPYSTR(LongFormula,MAXSTRLEN(Formula) + MAXSTRLEN(Formula2) + 1,MAXSTRLEN(Formula3));
      IF STRLEN(LongFormula) > MAXSTRLEN(Formula) + MAXSTRLEN(Formula2) + MAXSTRLEN(Formula3) THEN
        Formula4 := COPYSTR(LongFormula,MAXSTRLEN(Formula) + MAXSTRLEN(Formula2) + MAXSTRLEN(Formula3) + 1,MAXSTRLEN(Formula4));
    END;

    PROCEDURE ClearFormula@18();
    BEGIN
      Formula := '';
      Formula2 := '';
      Formula3 := '';
      Formula4 := '';
    END;

    PROCEDURE NewRow@14();
    BEGIN
      CurrentRow := CurrentRow + 1;
      CurrentCol := 0;
    END;

    PROCEDURE AddColumn@16(Value@1000 : Variant;IsFormula@1001 : Boolean;CommentText@1002 : Text[1000];IsBold@1003 : Boolean;IsItalics@1004 : Boolean;IsUnderline@1005 : Boolean;NumFormat@1006 : Text[30];CellType@1007 : Option);
    BEGIN
      IF CurrentRow < 1 THEN
        NewRow;

      CurrentCol := CurrentCol + 1;
      INIT;
      VALIDATE("Row No.",CurrentRow);
      VALIDATE("Column No.",CurrentCol);
      IF IsFormula THEN
        SetFormula(FORMAT(Value))
      ELSE
        "Cell Value as Text" := FORMAT(Value);
      Comment := CommentText;
      Bold := IsBold;
      Italic := IsItalics;
      Underline := IsUnderline;
      NumberFormat := NumFormat;
      "Cell Type" := CellType;
      INSERT;
    END;

    PROCEDURE StartRange@19();
    VAR
      TempExcelBuf@1000 : TEMPORARY Record 370;
    BEGIN
      TempExcelBuf.VALIDATE("Row No.",CurrentRow);
      TempExcelBuf.VALIDATE("Column No.",CurrentCol);

      RangeStartXlRow := TempExcelBuf.xlRowID;
      RangeStartXlCol := TempExcelBuf.xlColID;
    END;

    PROCEDURE EndRange@23();
    VAR
      TempExcelBuf@1000 : TEMPORARY Record 370;
    BEGIN
      TempExcelBuf.VALIDATE("Row No.",CurrentRow);
      TempExcelBuf.VALIDATE("Column No.",CurrentCol);

      RangeEndXlRow := TempExcelBuf.xlRowID;
      RangeEndXlCol := TempExcelBuf.xlColID;
    END;

    PROCEDURE CreateRange@45(RangeName@1000 : Text[250]);
    BEGIN
      XlWrkShtWriter.AddRange(
        RangeName,
        GetExcelReference(4) + RangeStartXlCol + GetExcelReference(4) + RangeStartXlRow +
        ':' +
        GetExcelReference(4) + RangeEndXlCol + GetExcelReference(4) + RangeEndXlRow);
    END;

    PROCEDURE AutoFit@20(RangeName@1000 : Text[50]);
    BEGIN
      IF NOT ISNULL(XlWrkBk) THEN
        XlHelper.AutoFitRangeColumns(XlWrkBk,ActiveSheetName,RangeName);
    END;

    PROCEDURE BorderAround@39(RangeName@1000 : Text[50]);
    BEGIN
      IF NOT ISNULL(XlWrkBk) THEN
        XlHelper.BorderAroundRange(XlWrkBk,ActiveSheetName,RangeName,1);
    END;

    PROCEDURE ClearNewRow@26();
    BEGIN
      CurrentRow := 0;
      CurrentCol := 0;
    END;

    PROCEDURE SetUseInfoSheet@25();
    BEGIN
      UseInfoSheet := TRUE;
    END;

    PROCEDURE AddInfoColumn@24(Value@1006 : Variant;IsFormula@1005 : Boolean;CommentText@1004 : Text[1000];IsBold@1003 : Boolean;IsItalics@1002 : Boolean;IsUnderline@1001 : Boolean;NumFormat@1000 : Text[30];CellType@1007 : Option);
    BEGIN
      IF CurrentRow < 1 THEN
        NewRow;

      CurrentCol := CurrentCol + 1;
      INIT;
      InfoExcelBuf.VALIDATE("Row No.",CurrentRow);
      InfoExcelBuf.VALIDATE("Column No.",CurrentCol);
      IF IsFormula THEN
        InfoExcelBuf.SetFormula(FORMAT(Value))
      ELSE
        InfoExcelBuf."Cell Value as Text" := FORMAT(Value);
      InfoExcelBuf.Bold := IsBold;
      InfoExcelBuf.Italic := IsItalics;
      InfoExcelBuf.Underline := IsUnderline;
      InfoExcelBuf.NumberFormat := NumFormat;
      InfoExcelBuf."Cell Type" := CellType;
      InfoExcelBuf.INSERT;
    END;

    PROCEDURE UTgetGlobalValue@35(globalVariable@1001 : Text[30];VAR value@1000 : Variant);
    BEGIN
      CASE globalVariable OF
        'CurrentRow':
          value := CurrentRow;
        'CurrentCol':
          value := CurrentCol;
        'RangeStartXlRow':
          value := RangeStartXlRow;
        'RangeStartXlCol':
          value := RangeStartXlCol;
        'RangeEndXlRow':
          value := RangeEndXlRow;
        'RangeEndXlCol':
          value := RangeEndXlCol;
        'XlWrkSht':
          value := XlWrkShtWriter;
        'ExcelFile':
          value := FileNameServer;
        ELSE
          ERROR(Text038,globalVariable);
      END;
    END;

    PROCEDURE SetCurrent@27(NewCurrentRow@1000 : Integer;NewCurrentCol@1001 : Integer);
    BEGIN
      CurrentRow := NewCurrentRow;
      CurrentCol := NewCurrentCol;
    END;

    PROCEDURE CreateValidationRule@17(Range@1000 : Code[20]);
    BEGIN
      XlWrkShtWriter.AddRangeDataValidation(
        Range,
        GetExcelReference(4) + RangeStartXlCol + GetExcelReference(4) + RangeStartXlRow +
        ':' +
        GetExcelReference(4) + RangeEndXlCol + GetExcelReference(4) + RangeEndXlRow);
    END;

    PROCEDURE QuitExcel@29();
    BEGIN
      // Close and clear the OpenXml book
      CloseBook;

      // Clear the worksheet automation
      IF NOT ISNULL(XlWrkSht) THEN
        CLEAR(XlWrkSht);

      // Clear the workbook automation
      IF NOT ISNULL(XlWrkBk) THEN
        CLEAR(XlWrkBk);

      // Clear and quit the Excel application automation
      IF NOT ISNULL(XlApp) THEN BEGIN
        XlHelper.CallQuit(XlApp);
        CLEAR(XlApp);
      END;
    END;

    PROCEDURE OpenExcel@31();
    VAR
      FileNameClient@1000 : Text;
    BEGIN
      IF OpenUsingDocumentService('') THEN
        EXIT;

      IF NOT PreOpenExcel THEN
        EXIT;

      // rename the Temporary filename into a more UI friendly name in a new subdirectory
      FileNameClient := FileManagement.DownloadTempFile(FileNameServer);
      FileNameClient := FileManagement.MoveAndRenameClientFile(FileNameClient,GetFriendlyFilename,FORMAT(CREATEGUID));

      XlWrkBk := XlHelper.CallOpen(XlApp,FileNameClient);

      PostOpenExcel;
    END;

    PROCEDURE DownloadAndOpenExcel@34();
    VAR
      ClientFilename@1000 : Text;
    BEGIN
      ClientFilename := GetFriendlyFilename;

      IF FileManagement.CanRunDotNetOnClient THEN BEGIN
        ClientFilename := FileManagement.SaveFileDialog('Save file','',Text034);
        IF ClientFilename = '' THEN
          EXIT;
        IF FileManagement.GetExtension(ClientFilename) = '' THEN
          ClientFilename += ExcelFileExtensionTok;
      END;

      OverwriteAndOpenExistingExcel(ClientFilename);
    END;

    PROCEDURE OverwriteAndOpenExistingExcel@15(FileName@1000 : Text);
    BEGIN
      IF FileName = '' THEN
        ERROR(Text001);

      IF OpenUsingDocumentService(FileName) THEN
        EXIT;

      IF NOT PreOpenExcel THEN
        EXIT;

      FileManagement.DownloadToFile(FileNameServer,FileName);
      XlWrkBk := XlHelper.CallOpen(XlApp,FileName);

      PostOpenExcel;
    END;

    LOCAL PROCEDURE OpenUsingDocumentService@21(FileName@1000 : Text) : Boolean;
    VAR
      DocumentServiceMgt@1005 : Codeunit 9510;
      FileMgt@1004 : Codeunit 419;
      PathHelper@1003 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path";
      DialogWindow@1002 : Dialog;
      DocumentUrl@1001 : Text;
    BEGIN
      IF NOT EXISTS(FileNameServer) THEN
        ERROR(Text003,FileNameServer);

      // if document service is configured we save the generated document to SharePoint and open it from there.
      IF DocumentServiceMgt.IsConfigured THEN BEGIN
        IF FileName = '' THEN
          FileName := 'Book.' + PathHelper.ChangeExtension(PathHelper.GetRandomFileName,'xlsx')
        ELSE BEGIN
          // if file is not applicable for the service it can not be opened using the document service.
          IF NOT DocumentServiceMgt.IsServiceUri(FileName) THEN
            EXIT(FALSE);

          FileName := FileMgt.GetFileName(FileName);
        END;

        DialogWindow.OPEN(STRSUBSTNO(SavingDocumentMsg,FileName));
        DocumentUrl := DocumentServiceMgt.SaveFile(FileNameServer,FileName,TRUE);
        DocumentServiceMgt.OpenDocument(DocumentUrl);
        DialogWindow.CLOSE;
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE PreOpenExcel@7() : Boolean;
    BEGIN
      IF NOT EXISTS(FileNameServer) THEN
        ERROR(Text003,FileNameServer);

      // Download file, if none RTC it should return a filename, and use client automation instead.
      IF NOT FileManagement.CanRunDotNetOnClient THEN BEGIN
        IF NOT FileManagement.DownloadHandler(FileNameServer,Text040,'',Text034,GetFriendlyFilename) THEN
          ERROR(Text001);
        EXIT(FALSE);
      END;

      XlApp := XlApp.ApplicationClass;
      IF ISNULL(XlApp) THEN
        ERROR(Text000);

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE PostOpenExcel@8();
    BEGIN
      XlWrkBk := XlApp.ActiveWorkbook;

      IF ISNULL(XlWrkBk) THEN
        ERROR(Text036);

      // autofit all columns on all worksheets
      XlHelper.AutoFitColumnsInAllWorksheets(XlWrkBk);

      // activate the previous saved sheet name in the workbook
      XlHelper.ActivateSheet(XlWrkBk,ActiveSheetName);
    END;

    PROCEDURE CreateBookAndOpenExcel@32(FileName@1004 : Text;SheetName@1000 : Text[250];ReportHeader@1003 : Text;CompanyName2@1002 : Text;UserID2@1001 : Text);
    BEGIN
      CreateBook(FileName,SheetName);
      WriteSheet(ReportHeader,CompanyName2,UserID2);
      CloseBook;
      OpenExcel;
      GiveUserControl;
    END;

    LOCAL PROCEDURE UpdateProgressDialog@36(VAR ExcelBufferDialogManagement@1000 : Codeunit 5370;VAR LastUpdate@1001 : DateTime;CurrentCount@1002 : Integer;TotalCount@1004 : Integer) : Boolean;
    VAR
      CurrentTime@1003 : DateTime;
    BEGIN
      // Refresh at 100%, and every second in between 0% to 100%
      // Duration is measured in miliseconds -> 1 sec = 1000 ms
      CurrentTime := CURRENTDATETIME;
      IF (CurrentCount = TotalCount) OR (CurrentTime - LastUpdate >= 1000) THEN BEGIN
        LastUpdate := CurrentTime;
        ExcelBufferDialogManagement.SetProgress(ROUND(CurrentCount / TotalCount * 10000,1));
        IF NOT ExcelBufferDialogManagement.RUN THEN
          EXIT(FALSE);
      END;

      EXIT(TRUE)
    END;

    LOCAL PROCEDURE GetFriendlyFilename@46() : Text;
    BEGIN
      IF FriendlyName = '' THEN
        EXIT('Book1' + ExcelFileExtensionTok);

      EXIT(FileManagement.StripNotsupportChrInFileName(FriendlyName) + ExcelFileExtensionTok);
    END;

    PROCEDURE SetFriendlyFilename@41(Name@1000 : Text);
    BEGIN
      FriendlyName := Name;
    END;

    PROCEDURE ConvertDateTimeDecimalToDateTime@43(DateTimeAsOADate@1000 : Decimal) : DateTime;
    VAR
      DotNetDateTime@1003 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime";
      DotNetDateTimeWithKind@1002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime";
      DotNetDateTimeKind@1001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTimeKind";
    BEGIN
      DotNetDateTime := DotNetDateTime.FromOADate(DateTimeAsOADate);
      DotNetDateTimeWithKind := DotNetDateTime.DateTime(DotNetDateTime.Ticks,DotNetDateTimeKind.Local);
      EXIT(DotNetDateTimeWithKind);
    END;

    PROCEDURE ENCCreateWorksheet@1000000000(SheetName@1000 : Text[250]);
    BEGIN
      //++ hier
      IF SheetName = '' THEN
        ERROR(Text002);

      IF SheetName <> '' THEN BEGIN
        XlWrkBkWriter.AddWorksheet(SheetName);
        //XlWrkShtWriter.Name := SheetName;
        //ActiveSheetName := SheetName;
      END
      //-- hier
      {
        IF InfoExcelBuf.FINDSET THEN BEGIN
          XlWrkShtWriter := XlWrkBkWriter.AddWorksheet(Text023);
          REPEAT
            InfoRecNo := InfoRecNo + 1;
            IF NOT UpdateProgressDialog(ExcelBufferDialogMgt,LastUpdate,RecNo + InfoRecNo,TotalRecNo) THEN BEGIN
              QuitExcel;
              ERROR(Text035)
            END;
            IF InfoExcelBuf.Formula = '' THEN
              WriteCellValue(InfoExcelBuf)
            ELSE
              WriteCellFormula(InfoExcelBuf)
          UNTIL InfoExcelBuf.NEXT = 0;
        END;


      }
    END;

    PROCEDURE ENCUpdateBook@1000000001(SheetName@1001 : Text[250]);
    BEGIN
      IF SheetName = '' THEN
        ERROR(Text002);

      IF XlWrkBkWriter.HasWorksheet(SheetName) THEN BEGIN
        XlWrkShtWriter := XlWrkBkWriter.GetWorksheetByName(SheetName);
        ActiveSheetName := SheetName;
      END ELSE BEGIN
        QuitExcel;
        ERROR(Text004,SheetName);
      END;
    END;

    PROCEDURE CMSetBlob@1000000004(value@1000000000 : Text);
    VAR
      OutStr@1000000001 : OutStream;
    BEGIN
      CLEAR(BlobValue);
      Rec.BlobValue.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(value);
      IF NOT Rec.MODIFY(FALSE) THEN
        ;
    END;

    PROCEDURE CMGetBlob@1000000003() : Text;
    VAR
      InStr@1000000000 : InStream;
      CMGMgt@1000000001 : Codeunit 70000;
    BEGIN
      CALCFIELDS(BlobValue);
      Rec.BlobValue.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      EXIT(CMGMgt.Instream2Text(InStr));
    END;

    PROCEDURE CMGetValue@1000000005() : Text;
    BEGIN
      IF Rec."Cell Value as Text" <> '' THEN
        EXIT(Rec."Cell Value as Text");

      CALCFIELDS(BlobValue);
      IF BlobValue.HASVALUE() THEN
        EXIT(CMGetBlob())
      ELSE
        EXIT('');
    END;

    PROCEDURE IGSetCurrentSheetName@1000000002(Name@1000000000 : Text[30]);
    BEGIN
      XlWrkShtWriter.Name(Name);
      ActiveSheetName := Name;
    END;

    PROCEDURE IGSetBackgroundColor@1000000007(HexColor@1000000012 : Code[6]);
    VAR
      IGBorder@1000000000 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.Border";
      IGBorderBottom@1000000009 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.BottomBorder";
      IGBorderStyleValues@1000000010 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.BorderStyleValues";
      IGLocFill@1000000007 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.Fill";
      IGPatFill@1000000006 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.PatternFill";
      IGBgColor@1000000005 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.ForegroundColor";
      IGPatternTypeEnum@1000000004 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.EnumValue`1";
      IGOpenXMLAttr@1000000003 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.OpenXmlAttribute";
      IGColor@1000000002 : DotNet "'DocumentFormat.OpenXml, Version=2.5.5631.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.DocumentFormat.OpenXml.Spreadsheet.Color";
      XlWrkShtWriter@1000000011 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorksheetWriter";
    BEGIN
      IF HexColor = '' THEN BEGIN
        IGUseFill := FALSE;
        EXIT;
      END;

      //Background Color:
      IGLocFill := IGLocFill.Fill();
      IGPatFill := IGPatFill.PatternFill();
      IGBgColor := IGBgColor.ForegroundColor();
      IGOpenXMLAttr := IGOpenXMLAttr.OpenXmlAttribute('rgb','', 'FF'+HexColor);
      IGBgColor.SetAttribute(IGOpenXMLAttr);
      IGOpenXMLAttr := IGOpenXMLAttr.OpenXmlAttribute('patternType','','solid');
      IGPatFill.SetAttribute(IGOpenXMLAttr);
      IGPatFill.ForegroundColor(IGBgColor);
      IGLocFill.PatternFill(IGPatFill);


      IGUseFill := TRUE;
      IGFill := IGLocFill;
    END;

    BEGIN
    {
      ENC 20160324  Added Functions ENCUpdateBook(),ENCCreateWorksheet()
      CM  20161010  Added Field BlobValue
                    Changed Function ParseCellValue()
                    Added Functions: CMGetBlob(), CMGetValue, CMSetBlob()
    }
    END.
  }
}

OBJECT Table 952 Time Sheet Detail
{
  OBJECT-PROPERTIES
  {
    Date=20.02.18;
    Time=16:14:07;
    Modified=Yes;
    Version List=NAVW17.00,CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               IF NOT "CM Is CMMS Timesheet" THEN //CM
                 TimeSheetMgt.CheckAccPeriod(Date);
             END;

    OnModify=BEGIN
               IF NOT "CM Is CMMS Timesheet" THEN //CM
                 TimeSheetMgt.CheckAccPeriod(Date);
             END;

    CaptionML=[ENU=Time Sheet Detail;
               DEA=Arbeitszeittabellendetails];
  }
  FIELDS
  {
    { 1   ;   ;Time Sheet No.      ;Code20        ;TableRelation="Time Sheet Header";
                                                   CaptionML=[ENU=Time Sheet No.;
                                                              DEA=Arbeitszeittabelle - Nr.];
                                                   Description=CM }
    { 2   ;   ;Time Sheet Line No. ;Integer       ;CaptionML=[ENU=Time Sheet Line No.;
                                                              DEA=Arbeitszeittabelle - Zeilennr.];
                                                   Description=CM }
    { 3   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              DEA=Datum] }
    { 4   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              DEA=Art];
                                                   OptionCaptionML=[ENU=" ,Resource,Job,Service,Absence,Assembly Order";
                                                                    DEA=" ,Ressource,Projekt,Service,Abwesenheit,Montageauftrag"];
                                                   OptionString=[ ,Resource,Job,Service,Absence,Assembly Order] }
    { 5   ;   ;Resource No.        ;Code20        ;TableRelation=Resource;
                                                   CaptionML=[ENU=Resource No.;
                                                              DEA=Ressourcennr.] }
    { 6   ;   ;Job No.             ;Code20        ;TableRelation=Job;
                                                   CaptionML=[ENU=Job No.;
                                                              DEA=Projektnr.] }
    { 7   ;   ;Job Task No.        ;Code20        ;TableRelation="Job Task"."Job Task No." WHERE (Job No.=FIELD(Job No.));
                                                   CaptionML=[ENU=Job Task No.;
                                                              DEA=Projektaufgabennr.] }
    { 9   ;   ;Cause of Absence Code;Code10       ;TableRelation="Cause of Absence";
                                                   CaptionML=[ENU=Cause of Absence Code;
                                                              DEA=Code Abwesenheitsgrund] }
    { 13  ;   ;Service Order No.   ;Code20        ;TableRelation=IF (Posted=CONST(No)) "Service Header".No. WHERE (Document Type=CONST(Order));
                                                   CaptionML=[ENU=Service Order No.;
                                                              DEA=Serviceauftragsnr.] }
    { 14  ;   ;Service Order Line No.;Integer     ;CaptionML=[ENU=Service Order Line No.;
                                                              DEA=Serviceauftragszeilennr.] }
    { 15  ;   ;Quantity            ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              DEA=Menge];
                                                   Editable=No }
    { 16  ;   ;Posted Quantity     ;Decimal       ;CaptionML=[ENU=Posted Quantity;
                                                              DEA=Gebuchte Menge] }
    { 18  ;   ;Assembly Order No.  ;Code20        ;TableRelation=IF (Posted=CONST(No)) "Assembly Header".No. WHERE (Document Type=CONST(Order));
                                                   CaptionML=[ENU=Assembly Order No.;
                                                              DEA=Montageauftragsnr.] }
    { 19  ;   ;Assembly Order Line No.;Integer    ;CaptionML=[ENU=Assembly Order Line No.;
                                                              DEA=Montageauftragszeilennr.] }
    { 20  ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionCaptionML=[ENU=Open,Submitted,Rejected,Approved;
                                                                    DEA=Offen,šbermittelt,Abgelehnt,Genehmigt];
                                                   OptionString=Open,Submitted,Rejected,Approved }
    { 23  ;   ;Posted              ;Boolean       ;CaptionML=[ENU=Posted;
                                                              DEA=Gebucht];
                                                   Description=CM }
    { 50000;  ;CM Is CMMS Timesheet;Boolean       ;CaptionML=[ENU=Is CMMS Timesheet;
                                                              DEA=Ist CMMS Zeitsheet] }
    { 50010;  ;CM Entry Date       ;Date          ;CaptionML=[ENU=Entry Date;
                                                              DEA=Eintrag Datum];
                                                   NotBlank=Yes }
    { 50015;  ;CM Posted Datetime  ;DateTime       }
    { 50090;  ;CM Main Asset No.   ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Asset),
                                                                                          Asset Type=CONST(Main Asset));
                                                   CaptionML=[ENU=Main Asset No.;
                                                              DEA=Hauptanlagennr.] }
    { 50100;  ;CM Asset No.        ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Asset),
                                                                                          Asset Type=FILTER(Asset|Sub Asset));
                                                   CaptionML=[ENU=Asset No.;
                                                              DEA=Anlagennr.] }
    { 50110;  ;CM Project No.      ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Project));
                                                   CaptionML=[ENU=Project No.;
                                                              DEA=Projektnr.] }
    { 50200;  ;CM Workorder No.    ;Code20        ;TableRelation=Opportunity.No. WHERE (CM Is Workorder=CONST(Yes));
                                                   CaptionML=[ENU=Workorder No.;
                                                              DEA=Arbeitsauftragnr.] }
    { 50300;  ;CM Task No.         ;Code20        ;TableRelation=To-do.No. WHERE (CM Type=CONST(Task));
                                                   CaptionML=[ENU=Task No.;
                                                              DEA=Aufgabennr.] }
    { 50400;  ;CM User ID          ;Code50        ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=User ID;
                                                              DEA=Benutzer ID] }
    { 50500;  ;CM Assigned User ID ;Code50        ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=Assigned User ID;
                                                              DEA=Zugewiesener Benztzer ID] }
    { 50510;  ;CM Posted By User ID;Code50        ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=Posted By User ID;
                                                              DEA=Gebucht von Benutzer ID] }
    { 50600;  ;CM Description      ;Text250       ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 50610;  ;CM UoM Code         ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Unit of Measure;
                                                              DEA=Einheit] }
    { 50620;  ;CM Quantity         ;Decimal       ;CaptionML=[ENU=Quantity;
                                                              DEA=Menge];
                                                   DecimalPlaces=2:2;
                                                   BlankZero=Yes }
    { 50700;  ;CM Dimension Value 1;Code20        ;TableRelation="Dimension Value".Code WHERE (Dimension Code=FIELD(CM Dimension Code 1));
                                                   CaptionClass=CMTTMgt.GetDimCaption(1) }
    { 50710;  ;CM Dimension Value 2;Code20        ;TableRelation="Dimension Value".Code WHERE (Dimension Code=FIELD(CM Dimension Code 2));
                                                   CaptionClass=CMTTMgt.GetDimCaption(2) }
    { 50720;  ;CM Dimension Value 3;Code20        ;TableRelation="Dimension Value".Code WHERE (Dimension Code=FIELD(CM Dimension Code 3));
                                                   CaptionClass=CMTTMgt.GetDimCaption(3) }
    { 50730;  ;CM Dimension Value 4;Code20        ;TableRelation="Dimension Value".Code WHERE (Dimension Code=FIELD(CM Dimension Code 4));
                                                   CaptionClass=CMTTMgt.GetDimCaption(4) }
    { 50800;  ;CM Dimension Code 1 ;Code20        ;TableRelation=Dimension.Code }
    { 50810;  ;CM Dimension Code 2 ;Code20        ;TableRelation=Dimension.Code }
    { 50820;  ;CM Dimension Code 3 ;Code20        ;TableRelation=Dimension.Code }
    { 50830;  ;CM Dimension Code 4 ;Code20        ;TableRelation=Dimension.Code }
    { 50890;  ;CM Dimension Set ID ;Integer       ;TableRelation="Dimension Set Entry"."Dimension Set ID" }
    { 50900;  ;CM Clienttype       ;Text30        ;CaptionML=[ENU=Clienttype;
                                                              DEA=Clientart] }
    { 60000;  ;CM Reverse Line No. ;Integer       ;TableRelation="Time Sheet Detail"."Time Sheet Line No." WHERE (CM Is CMMS Timesheet=CONST(Yes));
                                                   CaptionML=[ENU=Reverse Line No.;
                                                              DEA=Storno Zeilennr.] }
    { 70000;  ;CM Empty 1          ;Text1          }
    { 70010;  ;CM Empty 2          ;Text1          }
    { 70020;  ;CM Empty 3          ;Text1          }
    { 70030;  ;CM Empty 4          ;Text1          }
    { 70040;  ;CM Text 1           ;Text250        }
    { 70050;  ;CM Text 2           ;Text250        }
  }
  KEYS
  {
    {    ;Time Sheet No.,Time Sheet Line No.,Date ;Clustered=Yes }
    {    ;Type,Job No.,Job Task No.,Status,Posted ;SumIndexFields=Quantity }
    {    ;CM Is CMMS Timesheet,Time Sheet No.,Time Sheet Line No. }
    {    ;CM Is CMMS Timesheet,CM User ID,CM Entry Date }
    {    ;CM Is CMMS Timesheet,CM Reverse Line No. }
    {    ;CM Is CMMS Timesheet,CM Workorder No.    }
    {    ;CM Is CMMS Timesheet,CM Task No.         }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;CM Entry Date,CM Description,CM Quantity,CM Text 1,CM Dimension Value 3,CM Text 2 }
  }
  CODE
  {
    VAR
      TimeSheetMgt@1001 : Codeunit 950;
      CMTTMgt@1000000000 : Codeunit 70040;

    PROCEDURE CopyFromTimeSheetLine@2(TimeSheetLine@1000 : Record 951);
    BEGIN
      "Time Sheet No." := TimeSheetLine."Time Sheet No.";
      "Time Sheet Line No." := TimeSheetLine."Line No.";
      Type := TimeSheetLine.Type;
      "Job No." := TimeSheetLine."Job No.";
      "Job Task No." := TimeSheetLine."Job Task No.";
      "Cause of Absence Code" := TimeSheetLine."Cause of Absence Code";
      "Service Order No." := TimeSheetLine."Service Order No.";
      "Service Order Line No." := TimeSheetLine."Service Order Line No.";
      "Assembly Order No." := TimeSheetLine."Assembly Order No.";
      "Assembly Order Line No." := TimeSheetLine."Assembly Order Line No.";
      Status := TimeSheetLine.Status;
    END;

    PROCEDURE GetMaxQtyToPost@3() : Decimal;
    BEGIN
      EXIT(Quantity - "Posted Quantity");
    END;

    BEGIN
    {
      ENC 20160923  Added CM* Fields
                    Added Global VAR CMTTMgt
                    Added Code in OnInsert(), OnDelete(), OnModify()
                    Added Key "CM Is CMMS Timesheet,Time Sheet No.,Time Sheet Line No."
                    Added Key "CM Is CMMS Timesheet,CM Posted By User ID,CM Date"
                    Added Field Group "Brick"
    }
    END.
  }
}

OBJECT Table 1511 Notification Entry
{
  OBJECT-PROPERTIES
  {
    Date=04.05.18;
    Time=12:30:50;
    Modified=Yes;
    Version List=NAVW19.00,CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               "Created Date-Time" := ROUNDDATETIME(CURRENTDATETIME,60000);
               "Created By" := USERID;
             END;

    CaptionML=[ENU=Notification Entry;
               DEA=Benachrichtigung];
  }
  FIELDS
  {
    { 1   ;   ;ID                  ;Integer       ;AutoIncrement=Yes;
                                                   CaptionML=[ENU=ID;
                                                              DEA=ID] }
    { 3   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              DEA=Art];
                                                   OptionCaptionML=[ENU=New Record,Approval,Overdue;
                                                                    DEA=Neuer Datensatz,Genehmigung,šberf„llig];
                                                   OptionString=New Record,Approval,Overdue }
    { 4   ;   ;Recipient User ID   ;Code50        ;CaptionML=[ENU=Recipient User ID;
                                                              DEA=Benutzer-ID des Empf„ngers] }
    { 5   ;   ;Triggered By Record ;RecordID      ;CaptionML=[ENU=Triggered By Record;
                                                              DEA=Ausgel”st von Datensatz];
                                                   Description=CM }
    { 6   ;   ;Link Target Page    ;Integer       ;TableRelation="Page Metadata".ID;
                                                   CaptionML=[ENU=Link Target Page;
                                                              DEA=Link zur Zielseite] }
    { 7   ;   ;Custom Link         ;Text250       ;ExtendedDatatype=URL;
                                                   CaptionML=[ENU=Custom Link;
                                                              DEA=Benutzerdefinierter Link] }
    { 8   ;   ;Error Message       ;Text250       ;CaptionML=[ENU=Error Message;
                                                              DEA=Fehlermeldung];
                                                   Editable=No }
    { 9   ;   ;Created Date-Time   ;DateTime      ;CaptionML=[ENU=Created Date-Time;
                                                              DEA=Datum/Uhrzeit der Erstellung];
                                                   Description=CM;
                                                   Editable=No }
    { 10  ;   ;Created By          ;Code50        ;TableRelation=User."User Name";
                                                   CaptionML=[ENU=Created By;
                                                              DEA=Erstellt von];
                                                   Description=CM;
                                                   Editable=No }
    { 50000;  ;CM Type             ;Option        ;OptionString=[ ,New Workorder assigned to me,Workorder assigned to me,My Workorder - status changed,My Workorder - new Task,Task assigend to me,My Task - status changed] }
    { 50010;  ;CM Type Text        ;Text30         }
    { 50100;  ;CM To Connector     ;Option        ;OptionString=[ ,Email,Skype] }
    { 50110;  ;CM To Connector Text;Text30         }
    { 50120;  ;CM To UserID        ;Code50         }
    { 50130;  ;CM To Connector ID  ;Text80         }
    { 60000;  ;CM Key Data 1       ;Text20         }
    { 60010;  ;CM Key Data 2       ;Text20         }
    { 60020;  ;CM Key Data 3       ;Text20         }
    { 61000;  ;CM Data Short 1     ;Text20         }
    { 61001;  ;CM Data Short 2     ;Text20         }
    { 61002;  ;CM Data Short 3     ;Text20         }
    { 61003;  ;CM Data Short 4     ;Text20         }
    { 61004;  ;CM Data Short 5     ;Text20         }
    { 61005;  ;CM Data Short 6     ;Text20         }
    { 61006;  ;CM Data Short 7     ;Text20         }
    { 62000;  ;CM Data Medium 1    ;Text80         }
    { 62001;  ;CM Data Medium 2    ;Text80         }
    { 62002;  ;CM Data Medium 3    ;Text80         }
    { 62003;  ;CM Data Medium 4    ;Text80         }
    { 62004;  ;CM Data Medium 5    ;Text80         }
    { 62005;  ;CM Data Medium 6    ;Text80         }
    { 62006;  ;CM Data Medium 7    ;Text80         }
    { 62007;  ;CM Data Medium 8    ;Text80         }
    { 62008;  ;CM Data Medium 9    ;Text80         }
    { 62009;  ;CM Data Medium 10   ;Text80         }
    { 63000;  ;CM Data Long 1      ;Text250        }
    { 63001;  ;CM Data Long 2      ;Text250        }
    { 63002;  ;CM Data Long 3      ;Text250        }
    { 70000;  ;CM NAV Link 1       ;Text250        }
    { 70001;  ;CM NAV Link 2       ;Text250        }
    { 80000;  ;CM Subject 1        ;Text250        }
    { 80001;  ;CM Subject 2        ;Text250        }
  }
  KEYS
  {
    {    ;ID                                      ;Clustered=Yes }
    {    ;Created Date-Time                        }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      DataTypeManagement@1000 : Codeunit 701;

    PROCEDURE CreateNew@1(NewType@1003 : 'New Record,Approval,Overdue';NewUserID@1002 : Code[50];NewRecord@1000 : Variant;NewLinkTargetPage@1004 : Integer;NewCustomLink@1005 : Text[250]);
    VAR
      NewRecRef@1001 : RecordRef;
    BEGIN
      IF NOT DataTypeManagement.GetRecordRef(NewRecord,NewRecRef) THEN
        EXIT;
      CLEAR(Rec);
      Type := NewType;
      "Recipient User ID" := NewUserID;
      "Triggered By Record" := NewRecRef.RECORDID;
      "Link Target Page" := NewLinkTargetPage;
      "Custom Link" := NewCustomLink;

      INSERT(TRUE);
    END;

    BEGIN
    END.
  }
}

OBJECT Table 5050 Contact
{
  OBJECT-PROPERTIES
  {
    Date=10.03.17;
    Time=10:54:08;
    Modified=Yes;
    Version List=NAVW19.00.00.46621,CMMS;
  }
  PROPERTIES
  {
    Permissions=TableData 36=rm,
                TableData 5065=r,
                TableData 5093=rm;
    DataCaptionFields=No.,Name;
    OnInsert=BEGIN
               RMSetup.GET;

               IF "No." = '' THEN BEGIN
                 RMSetup.TESTFIELD("Contact Nos.");
                 NoSeriesMgt.InitSeries(RMSetup."Contact Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;

               IF NOT SkipDefaults THEN BEGIN
                 IF "Salesperson Code" = '' THEN
                   "Salesperson Code" := RMSetup."Default Salesperson Code";
                 IF "Territory Code" = '' THEN
                   "Territory Code" := RMSetup."Default Territory Code";
                 IF "Country/Region Code" = '' THEN
                   "Country/Region Code" := RMSetup."Default Country/Region Code";
                 IF "Language Code" = '' THEN
                   "Language Code" := RMSetup."Default Language Code";
                 IF "Correspondence Type" = "Correspondence Type"::" " THEN
                   "Correspondence Type" := RMSetup."Default Correspondence Type";
                 IF "Salutation Code" = '' THEN
                   IF Type = Type::Company THEN
                     "Salutation Code" := RMSetup."Def. Company Salutation Code"
                   ELSE
                     "Salutation Code" := RMSetup."Default Person Salutation Code";
               END;

               TypeChange;

               "Last Date Modified" := TODAY;
               "Last Time Modified" := TIME;
             END;

    OnModify=BEGIN
               OnModify(xRec);
             END;

    OnDelete=VAR
               Todo@1000 : Record 5080;
               SegLine@1001 : Record 5077;
               ContIndustGrp@1002 : Record 5058;
               ContactWebSource@1003 : Record 5060;
               ContJobResp@1004 : Record 5067;
               ContMailingGrp@1005 : Record 5056;
               ContProfileAnswer@1006 : Record 5089;
               RMCommentLine@1007 : Record 5061;
               ContAltAddr@1008 : Record 5051;
               ContAltAddrDateRange@1009 : Record 5052;
               InteractLogEntry@1010 : Record 5065;
               Opp@1011 : Record 5092;
               DOPaymentCreditCard@1017 : Record 827;
               CampaignTargetGrMgt@1016 : Codeunit 7030;
               VATRegistrationLogMgt@1012 : Codeunit 249;
             BEGIN
               DOPaymentCreditCard.DeleteByContact(Rec);

               Todo.SETCURRENTKEY("Contact Company No.","Contact No.",Closed,Date);
               Todo.SETRANGE("Contact Company No.","Company No.");
               Todo.SETRANGE("Contact No.","No.");
               Todo.SETRANGE(Closed,FALSE);
               IF Todo.FIND('-') THEN
                 ERROR(Text000,TABLECAPTION,"No.");

               SegLine.SETCURRENTKEY("Contact No.");
               SegLine.SETRANGE("Contact No.","No.");
               IF SegLine.FINDFIRST THEN
                 ERROR(Text001,TABLECAPTION,"No.");

               Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
               Opp.SETRANGE("Contact Company No.","Company No.");
               Opp.SETRANGE("Contact No.","No.");
               Opp.SETRANGE(Status,Opp.Status::"Not Started",Opp.Status::"In Progress");
               IF Opp.FIND('-') THEN
                 ERROR(Text002,TABLECAPTION,"No.");

               CASE Type OF
                 Type::Company:
                   BEGIN
                     ContBusRel.SETRANGE("Contact No.","No.");
                     ContBusRel.DELETEALL;
                     ContIndustGrp.SETRANGE("Contact No.","No.");
                     ContIndustGrp.DELETEALL;
                     ContactWebSource.SETRANGE("Contact No.","No.");
                     ContactWebSource.DELETEALL;
                     DuplMgt.RemoveContIndex(Rec,FALSE);
                     InteractLogEntry.SETCURRENTKEY("Contact Company No.");
                     InteractLogEntry.SETRANGE("Contact Company No.","No.");
                     IF InteractLogEntry.FIND('-') THEN
                       REPEAT
                         CampaignTargetGrMgt.DeleteContfromTargetGr(InteractLogEntry);
                         CLEAR(InteractLogEntry."Contact Company No.");
                         CLEAR(InteractLogEntry."Contact No.");
                         InteractLogEntry.MODIFY;
                       UNTIL InteractLogEntry.NEXT = 0;

                     Cont.RESET;
                     Cont.SETCURRENTKEY("Company No.");
                     Cont.SETRANGE("Company No.","No.");
                     Cont.SETRANGE(Type,Type::Person);
                     IF Cont.FIND('-') THEN
                       REPEAT
                         Cont.DELETE(TRUE);
                       UNTIL Cont.NEXT = 0;

                     Opp.RESET;
                     Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                     Opp.SETRANGE("Contact Company No.","Company No.");
                     Opp.SETRANGE("Contact No.","No.");
                     IF Opp.FIND('-') THEN
                       REPEAT
                         CLEAR(Opp."Contact No.");
                         CLEAR(Opp."Contact Company No.");
                         Opp.MODIFY;
                       UNTIL Opp.NEXT = 0;

                     Todo.RESET;
                     Todo.SETCURRENTKEY("Contact Company No.");
                     Todo.SETRANGE("Contact Company No.","Company No.");
                     IF Todo.FIND('-') THEN
                       REPEAT
                         CLEAR(Todo."Contact No.");
                         CLEAR(Todo."Contact Company No.");
                         Todo.MODIFY;
                       UNTIL Todo.NEXT = 0;
                   END;
                 Type::Person:
                   BEGIN
                     ContJobResp.SETRANGE("Contact No.","No.");
                     ContJobResp.DELETEALL;

                     InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                     InteractLogEntry.SETRANGE("Contact Company No.","Company No.");
                     InteractLogEntry.SETRANGE("Contact No.","No.");
                     InteractLogEntry.MODIFYALL("Contact No.","Company No.");

                     Opp.RESET;
                     Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                     Opp.SETRANGE("Contact Company No.","Company No.");
                     Opp.SETRANGE("Contact No.","No.");
                     Opp.MODIFYALL("Contact No.","Company No.");

                     Todo.RESET;
                     Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
                     Todo.SETRANGE("Contact Company No.","Company No.");
                     Todo.SETRANGE("Contact No.","No.");
                     Todo.MODIFYALL("Contact No.","Company No.");
                   END;
               END;

               ContMailingGrp.SETRANGE("Contact No.","No.");
               ContMailingGrp.DELETEALL;

               ContProfileAnswer.SETRANGE("Contact No.","No.");
               ContProfileAnswer.DELETEALL;

               RMCommentLine.SETRANGE("Table Name",RMCommentLine."Table Name"::Contact);
               RMCommentLine.SETRANGE("No.","No.");
               RMCommentLine.SETRANGE("Sub No.",0);
               RMCommentLine.DELETEALL;

               ContAltAddr.SETRANGE("Contact No.","No.");
               ContAltAddr.DELETEALL;

               ContAltAddrDateRange.SETRANGE("Contact No.","No.");
               ContAltAddrDateRange.DELETEALL;

               VATRegistrationLogMgt.DeleteContactLog(Rec);
             END;

    OnRename=BEGIN
               VALIDATE("Lookup Contact No.");
             END;

    CaptionML=[ENU=Contact;
               DEA=Kontakt];
    LookupPageID=Page5052;
    DrillDownPageID=Page5052;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  RMSetup.GET;
                                                                  NoSeriesMgt.TestManual(RMSetup."Contact Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   AltSearchField=Search Name;
                                                   CaptionML=[ENU=No.;
                                                              DEA=Nr.] }
    { 2   ;   ;Name                ;Text50        ;OnValidate=BEGIN
                                                                NameBreakdown;
                                                                ProcessNameChange;
                                                              END;

                                                   CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 3   ;   ;Search Name         ;Code50        ;CaptionML=[ENU=Search Name;
                                                              DEA=Suchbegriff] }
    { 4   ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              DEA=Name 2] }
    { 5   ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              DEA=Adresse] }
    { 6   ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              DEA=Adresse 2] }
    { 7   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              DEA=Ort] }
    { 9   ;   ;Phone No.           ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              DEA=Telefonnr.] }
    { 10  ;   ;Telex No.           ;Text20        ;CaptionML=[ENU=Telex No.;
                                                              DEA=Telexnr.] }
    { 15  ;   ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=[ENU=Territory Code;
                                                              DEA=Gebietscode] }
    { 22  ;   ;Currency Code       ;Code10        ;TableRelation=Currency;
                                                   CaptionML=[ENU=Currency Code;
                                                              DEA=W„hrungscode] }
    { 24  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[ENU=Language Code;
                                                              DEA=Sprachcode] }
    { 29  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Salesperson Code;
                                                              DEA=Verk„ufercode] }
    { 35  ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              DEA=L„nder-/Regionscode] }
    { 38  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Rlshp. Mgt. Comment Line" WHERE (Table Name=CONST(Contact),
                                                                                                       No.=FIELD(No.),
                                                                                                       Sub No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung];
                                                   Editable=No }
    { 54  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              DEA=Korrigiert am];
                                                   Editable=No }
    { 84  ;   ;Fax No.             ;Text30        ;CaptionML=[ENU=Fax No.;
                                                              DEA=Faxnr.] }
    { 85  ;   ;Telex Answer Back   ;Text20        ;CaptionML=[ENU=Telex Answer Back;
                                                              DEA=Telex Namengeber] }
    { 86  ;   ;VAT Registration No.;Text20        ;OnValidate=VAR
                                                                VATRegNoFormat@1000 : Record 381;
                                                                VATRegistrationLogMgt@1001 : Codeunit 249;
                                                              BEGIN
                                                                IF VATRegNoFormat.Test("VAT Registration No.","Country/Region Code","No.",DATABASE::Contact) THEN
                                                                  IF "VAT Registration No." <> xRec."VAT Registration No." THEN
                                                                    VATRegistrationLogMgt.LogContact(Rec);
                                                              END;

                                                   CaptionML=[ENU=VAT Registration No.;
                                                              DEA=USt-IdNr.] }
    { 89  ;   ;Picture             ;BLOB          ;CaptionML=[ENU=Picture;
                                                              DEA=Bild];
                                                   SubType=Bitmap }
    { 91  ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              DEA=PLZ-Code] }
    { 92  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              DEA=Bundesregion] }
    { 102 ;   ;E-Mail              ;Text80        ;OnValidate=BEGIN
                                                                IF ("Search E-Mail" = UPPERCASE(xRec."E-Mail")) OR ("Search E-Mail" = '') THEN
                                                                  "Search E-Mail" := "E-Mail";
                                                              END;

                                                   ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail;
                                                              DEA=E-Mail] }
    { 103 ;   ;Home Page           ;Text80        ;ExtendedDatatype=URL;
                                                   CaptionML=[ENU=Home Page;
                                                              DEA=Homepage] }
    { 107 ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              DEA=Nummernserie] }
    { 5050;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                IF (CurrFieldNo <> 0) AND ("No." <> '') THEN BEGIN
                                                                  TypeChange;
                                                                  MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              DEA=Art];
                                                   OptionCaptionML=[ENU=Company,Person;
                                                                    DEA=Unternehmen,Person];
                                                   OptionString=Company,Person }
    { 5051;   ;Company No.         ;Code20        ;TableRelation=Contact WHERE (Type=CONST(Company));
                                                   OnValidate=VAR
                                                                Opp@1000 : Record 5092;
                                                                OppEntry@1001 : Record 5093;
                                                                Todo@1002 : Record 5080;
                                                                InteractLogEntry@1003 : Record 5065;
                                                                SegLine@1005 : Record 5077;
                                                                SalesHeader@1004 : Record 36;
                                                                OriginalEmail@1006 : Text[80];
                                                              BEGIN
                                                                IF "Company No." = xRec."Company No." THEN
                                                                  EXIT;

                                                                OriginalEmail := "E-Mail";

                                                                TESTFIELD(Type,Type::Person);

                                                                SegLine.SETCURRENTKEY("Contact No.");
                                                                SegLine.SETRANGE("Contact No.","No.");
                                                                IF SegLine.FINDFIRST THEN
                                                                  ERROR(Text012,FIELDCAPTION("Company No."));

                                                                IF Cont.GET("Company No.") THEN
                                                                  InheritCompanyToPersonData(Cont,xRec."Company No." = '')
                                                                ELSE
                                                                  CLEAR("Company Name");

                                                                IF Cont.GET("No.") THEN BEGIN
                                                                  IF xRec."Company No." <> '' THEN BEGIN
                                                                    Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Opp.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    Opp.SETRANGE("Contact No.","No.");
                                                                    Opp.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    OppEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    OppEntry.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    OppEntry.SETRANGE("Contact No.","No.");
                                                                    OppEntry.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Todo.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    Todo.SETRANGE("Contact No.","No.");
                                                                    Todo.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    InteractLogEntry.SETRANGE("Contact Company No.",xRec."Company No.");
                                                                    InteractLogEntry.SETRANGE("Contact No.","No.");
                                                                    InteractLogEntry.MODIFYALL("Contact No.",xRec."Company No.");
                                                                    ContBusRel.RESET;
                                                                    ContBusRel.SETCURRENTKEY("Link to Table","No.");
                                                                    ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
                                                                    ContBusRel.SETRANGE("Contact No.",xRec."Company No.");
                                                                    SalesHeader.SETCURRENTKEY("Sell-to Customer No.","External Document No.");
                                                                    SalesHeader.SETRANGE("Sell-to Contact No.","No.");
                                                                    IF ContBusRel.FINDFIRST THEN
                                                                      SalesHeader.SETRANGE("Sell-to Customer No.",ContBusRel."No.")
                                                                    ELSE
                                                                      SalesHeader.SETRANGE("Sell-to Customer No.",'');
                                                                    IF SalesHeader.FIND('-') THEN
                                                                      REPEAT
                                                                        SalesHeader."Sell-to Contact No." := xRec."Company No.";
                                                                        IF SalesHeader."Sell-to Contact No." = SalesHeader."Bill-to Contact No." THEN
                                                                          SalesHeader."Bill-to Contact No." := xRec."Company No.";
                                                                        SalesHeader.MODIFY;
                                                                      UNTIL SalesHeader.NEXT = 0;
                                                                    SalesHeader.RESET;
                                                                    SalesHeader.SETCURRENTKEY("Bill-to Contact No.");
                                                                    SalesHeader.SETRANGE("Bill-to Contact No.","No.");
                                                                    SalesHeader.MODIFYALL("Bill-to Contact No.",xRec."Company No.");
                                                                  END ELSE BEGIN
                                                                    Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Opp.SETRANGE("Contact Company No.",'');
                                                                    Opp.SETRANGE("Contact No.","No.");
                                                                    Opp.MODIFYALL("Contact Company No.","Company No.");
                                                                    OppEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    OppEntry.SETRANGE("Contact Company No.",'');
                                                                    OppEntry.SETRANGE("Contact No.","No.");
                                                                    OppEntry.MODIFYALL("Contact Company No.","Company No.");
                                                                    Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    Todo.SETRANGE("Contact Company No.",'');
                                                                    Todo.SETRANGE("Contact No.","No.");
                                                                    Todo.MODIFYALL("Contact Company No.","Company No.");
                                                                    InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
                                                                    InteractLogEntry.SETRANGE("Contact Company No.",'');
                                                                    InteractLogEntry.SETRANGE("Contact No.","No.");
                                                                    InteractLogEntry.MODIFYALL("Contact Company No.","Company No.");
                                                                  END;
                                                                  IF OriginalEmail <> '' THEN
                                                                    "E-Mail" := OriginalEmail;
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Company No.;
                                                              DEA=Unternehmensnr.] }
    { 5052;   ;Company Name        ;Text50        ;CaptionML=[ENU=Company Name;
                                                              DEA=Unternehmensname];
                                                   Editable=No }
    { 5053;   ;Lookup Contact No.  ;Code20        ;TableRelation=Contact;
                                                   OnValidate=BEGIN
                                                                IF Type = Type::Company THEN
                                                                  "Lookup Contact No." := ''
                                                                ELSE
                                                                  "Lookup Contact No." := "No.";
                                                              END;

                                                   CaptionML=[ENU=Lookup Contact No.;
                                                              DEA=Look-up Kontaktnr.];
                                                   Editable=No }
    { 5054;   ;First Name          ;Text30        ;OnValidate=BEGIN
                                                                Name := CalculatedName;
                                                                ProcessNameChange;
                                                              END;

                                                   CaptionML=[ENU=First Name;
                                                              DEA=Vorname] }
    { 5055;   ;Middle Name         ;Text30        ;OnValidate=BEGIN
                                                                Name := CalculatedName;
                                                                ProcessNameChange;
                                                              END;

                                                   CaptionML=[ENU=Middle Name;
                                                              DEA=Vorname 2] }
    { 5056;   ;Surname             ;Text30        ;OnValidate=BEGIN
                                                                Name := CalculatedName;
                                                                ProcessNameChange;
                                                              END;

                                                   CaptionML=[ENU=Surname;
                                                              DEA=Nachname] }
    { 5058;   ;Job Title           ;Text30        ;CaptionML=[ENU=Job Title;
                                                              DEA=Titel] }
    { 5059;   ;Initials            ;Text30        ;CaptionML=[ENU=Initials;
                                                              DEA=Initialen] }
    { 5060;   ;Extension No.       ;Text30        ;CaptionML=[ENU=Extension No.;
                                                              DEA=Durchwahl] }
    { 5061;   ;Mobile Phone No.    ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Mobile Phone No.;
                                                              DEA=Mobiltelefonnr.] }
    { 5062;   ;Pager               ;Text30        ;CaptionML=[ENU=Pager;
                                                              DEA=Pager] }
    { 5063;   ;Organizational Level Code;Code10   ;TableRelation="Organizational Level";
                                                   CaptionML=[ENU=Organizational Level Code;
                                                              DEA=Positionscode] }
    { 5064;   ;Exclude from Segment;Boolean       ;CaptionML=[ENU=Exclude from Segment;
                                                              DEA=Nicht segmentieren] }
    { 5065;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              DEA=Datumsfilter] }
    { 5066;   ;Next To-do Date     ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Min(To-do.Date WHERE (Contact Company No.=FIELD(Company No.),
                                                                                     Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                     Closed=CONST(No),
                                                                                     System To-do Type=CONST(Contact Attendee)));
                                                   CaptionML=[ENU=Next To-do Date;
                                                              DEA=N„chste Aufgabe am];
                                                   Editable=No }
    { 5067;   ;Last Date Attempted ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Max("Interaction Log Entry".Date WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                       Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                       Initiated By=CONST(Us),
                                                                                                       Postponed=CONST(No)));
                                                   CaptionML=[ENU=Last Date Attempted;
                                                              DEA=Letzte Kontaktaufnahme am];
                                                   Editable=No }
    { 5068;   ;Date of Last Interaction;Date      ;FieldClass=FlowField;
                                                   CalcFormula=Max("Interaction Log Entry".Date WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                       Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                       Attempt Failed=CONST(No),
                                                                                                       Postponed=CONST(No)));
                                                   CaptionML=[ENU=Date of Last Interaction;
                                                              DEA=Letzte Aktivit„t am];
                                                   Editable=No }
    { 5069;   ;No. of Job Responsibilities;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Job Responsibility" WHERE (Contact No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Job Responsibilities;
                                                              DEA=Anzahl Verantwortlichkeiten];
                                                   Editable=No }
    { 5070;   ;No. of Industry Groups;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Industry Group" WHERE (Contact No.=FIELD(Company No.)));
                                                   CaptionML=[ENU=No. of Industry Groups;
                                                              DEA=Anzahl Branchen];
                                                   Editable=No }
    { 5071;   ;No. of Business Relations;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Business Relation" WHERE (Contact No.=FIELD(Company No.)));
                                                   CaptionML=[ENU=No. of Business Relations;
                                                              DEA=Anzahl Gesch„ftsbeziehungen];
                                                   Editable=No }
    { 5072;   ;No. of Mailing Groups;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Contact Mailing Group" WHERE (Contact No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. of Mailing Groups;
                                                              DEA=Anzahl Verteiler];
                                                   Editable=No }
    { 5073;   ;External ID         ;Code20        ;CaptionML=[ENU=External ID;
                                                              DEA=Externe ID] }
    { 5074;   ;No. of Interactions ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (Contact Company No.=FIELD(FILTER(Company No.)),
                                                                                                    Canceled=CONST(No),
                                                                                                    Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                    Date=FIELD(Date Filter),
                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=No. of Interactions;
                                                              DEA=Anzahl Aktivit„ten];
                                                   Editable=No }
    { 5076;   ;Cost (LCY)          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Cost (LCY)" WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                               Canceled=CONST(No),
                                                                                                               Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                               Date=FIELD(Date Filter),
                                                                                                               Postponed=CONST(No)));
                                                   CaptionML=[ENU=Cost (LCY);
                                                              DEA=Einstandsbetrag (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5077;   ;Duration (Min.)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Duration (Min.)" WHERE (Contact Company No.=FIELD(Company No.),
                                                                                                                    Canceled=CONST(No),
                                                                                                                    Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                                    Date=FIELD(Date Filter),
                                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=Duration (Min.);
                                                              DEA=Dauer (Min.)];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 5078;   ;No. of Opportunities;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Opportunity Entry" WHERE (Active=CONST(Yes),
                                                                                                Contact Company No.=FIELD(Company No.),
                                                                                                Estimated Close Date=FIELD(Date Filter),
                                                                                                Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                Action Taken=FIELD(Action Taken Filter)));
                                                   CaptionML=[ENU=No. of Opportunities;
                                                              DEA=Anzahl Verkaufschancen];
                                                   Editable=No }
    { 5079;   ;Estimated Value (LCY);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Estimated Value (LCY)" WHERE (Active=CONST(Yes),
                                                                                                                      Contact Company No.=FIELD(Company No.),
                                                                                                                      Estimated Close Date=FIELD(Date Filter),
                                                                                                                      Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                                      Action Taken=FIELD(Action Taken Filter)));
                                                   CaptionML=[ENU=Estimated Value (LCY);
                                                              DEA=Erwarteter Wert (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5080;   ;Calcd. Current Value (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Calcd. Current Value (LCY)" WHERE (Active=CONST(Yes),
                                                                                                                           Contact Company No.=FIELD(Company No.),
                                                                                                                           Estimated Close Date=FIELD(Date Filter),
                                                                                                                           Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                                           Action Taken=FIELD(Action Taken Filter)));
                                                   CaptionML=[ENU=Calcd. Current Value (LCY);
                                                              DEA=Berech. aktueller Wert (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 5082;   ;Opportunity Entry Exists;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Opportunity Entry" WHERE (Active=CONST(Yes),
                                                                                                Contact Company No.=FIELD(Company No.),
                                                                                                Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                                Sales Cycle Code=FIELD(Sales Cycle Filter),
                                                                                                Sales Cycle Stage=FIELD(Sales Cycle Stage Filter),
                                                                                                Salesperson Code=FIELD(Salesperson Filter),
                                                                                                Campaign No.=FIELD(Campaign Filter),
                                                                                                Action Taken=FIELD(Action Taken Filter),
                                                                                                Estimated Value (LCY)=FIELD(Estimated Value Filter),
                                                                                                Calcd. Current Value (LCY)=FIELD(Calcd. Current Value Filter),
                                                                                                Completed %=FIELD(Completed % Filter),
                                                                                                Chances of Success %=FIELD(Chances of Success % Filter),
                                                                                                Probability %=FIELD(Probability % Filter),
                                                                                                Estimated Close Date=FIELD(Date Filter),
                                                                                                Close Opportunity Code=FIELD(Close Opportunity Filter)));
                                                   CaptionML=[ENU=Opportunity Entry Exists;
                                                              DEA=Verkaufschancenposten vorh.];
                                                   Editable=No }
    { 5083;   ;To-do Entry Exists  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (Contact Company No.=FIELD(Company No.),
                                                                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                                                                  Team Code=FIELD(Team Filter),
                                                                                  Salesperson Code=FIELD(Salesperson Filter),
                                                                                  Campaign No.=FIELD(Campaign Filter),
                                                                                  Date=FIELD(Date Filter),
                                                                                  Status=FIELD(To-do Status Filter),
                                                                                  Priority=FIELD(Priority Filter),
                                                                                  Closed=FIELD(To-do Closed Filter)));
                                                   CaptionML=[ENU=To-do Entry Exists;
                                                              DEA=Aufgabenposten vorhanden];
                                                   Editable=No }
    { 5084;   ;Salesperson Filter  ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Salesperson Filter;
                                                              DEA=Verk„uferfilter] }
    { 5085;   ;Campaign Filter     ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Campaign;
                                                   CaptionML=[ENU=Campaign Filter;
                                                              DEA=Kampagnenfilter] }
    { 5087;   ;Action Taken Filter ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Action Taken Filter;
                                                              DEA=Kriterienaktionsfilter];
                                                   OptionCaptionML=[ENU=" ,Next,Previous,Updated,Jumped,Won,Lost";
                                                                    DEA=" ,N„chster Schritt,Vorheriger Schritt,Aktualisiert,šbersprungen,Gewonnen,Verloren"];
                                                   OptionString=[ ,Next,Previous,Updated,Jumped,Won,Lost] }
    { 5088;   ;Sales Cycle Filter  ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Sales Cycle";
                                                   CaptionML=[ENU=Sales Cycle Filter;
                                                              DEA=Verkaufsprozessfilter] }
    { 5089;   ;Sales Cycle Stage Filter;Integer   ;FieldClass=FlowFilter;
                                                   TableRelation="Sales Cycle Stage".Stage WHERE (Sales Cycle Code=FIELD(Sales Cycle Filter));
                                                   CaptionML=[ENU=Sales Cycle Stage Filter;
                                                              DEA=Verkaufsprozess-Stufenfilter] }
    { 5090;   ;Probability % Filter;Decimal       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Probability % Filter;
                                                              DEA=Wahrscheinlichkeit % Filter];
                                                   DecimalPlaces=1:1;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 5091;   ;Completed % Filter  ;Decimal       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Completed % Filter;
                                                              DEA=Abgeschlossen % Filter];
                                                   DecimalPlaces=1:1;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 5092;   ;Estimated Value Filter;Decimal     ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Estimated Value Filter;
                                                              DEA=Erwarteter Wert Filter];
                                                   AutoFormatType=1 }
    { 5093;   ;Calcd. Current Value Filter;Decimal;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Calcd. Current Value Filter;
                                                              DEA=Berech. aktueller Wert Filter];
                                                   AutoFormatType=1 }
    { 5094;   ;Chances of Success % Filter;Decimal;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Chances of Success % Filter;
                                                              DEA=Erfolgschancen % Filter];
                                                   DecimalPlaces=0:0;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 5095;   ;To-do Status Filter ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=To-do Status Filter;
                                                              DEA=Aufgabenstatusfilter];
                                                   OptionCaptionML=[ENU=Not Started,In Progress,Completed,Waiting,Postponed;
                                                                    DEA=Nicht begonnen,In Bearbeitung,Erledigt,Warten,Zurckgestellt];
                                                   OptionString=Not Started,In Progress,Completed,Waiting,Postponed }
    { 5096;   ;To-do Closed Filter ;Boolean       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=To-do Closed Filter;
                                                              DEA=Abgeschlossene Aufgaben Filter] }
    { 5097;   ;Priority Filter     ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Priority Filter;
                                                              DEA=Priorit„tenfilter];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High }
    { 5098;   ;Team Filter         ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Team;
                                                   CaptionML=[ENU=Team Filter;
                                                              DEA=Teamfilter] }
    { 5099;   ;Close Opportunity Filter;Code10    ;FieldClass=FlowFilter;
                                                   TableRelation="Close Opportunity Code";
                                                   CaptionML=[ENU=Close Opportunity Filter;
                                                              DEA=Verkaufschancenabschlussfilter] }
    { 5100;   ;Correspondence Type ;Option        ;CaptionML=[ENU=Correspondence Type;
                                                              DEA=Korrespondenzart];
                                                   OptionCaptionML=[ENU=" ,Hard Copy,E-Mail,Fax";
                                                                    DEA=" ,Brief,E-Mail,Fax"];
                                                   OptionString=[ ,Hard Copy,E-Mail,Fax] }
    { 5101;   ;Salutation Code     ;Code10        ;TableRelation=Salutation;
                                                   CaptionML=[ENU=Salutation Code;
                                                              DEA=Anredecode] }
    { 5102;   ;Search E-Mail       ;Code80        ;CaptionML=[ENU=Search E-Mail;
                                                              DEA=E-Mail-Suchbegriff] }
    { 5104;   ;Last Time Modified  ;Time          ;CaptionML=[ENU=Last Time Modified;
                                                              DEA=Korrigiert um] }
    { 5105;   ;E-Mail 2            ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail 2;
                                                              DEA=E-Mail 2] }
    { 50000;  ;CMMS Is CMMS Contact;Boolean        }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Search Name                              }
    {    ;Company Name,Company No.,Type,Name       }
    {    ;Company No.                              }
    {    ;Territory Code                           }
    {    ;Salesperson Code                         }
    {    ;VAT Registration No.                     }
    {    ;Search E-Mail                            }
    {    ;Name                                     }
    {    ;City                                     }
    {    ;Post Code                                }
    {    ;Phone No.                                }
    {    ;CMMS Is CMMS Contact,No.                 }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name,Type,City,Post Code,Phone No.   }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot delete the %2 record of the %1 because there are one or more to-dos open.;DEA=Sie k”nnen %1 %2 nicht l”schen, da es eine oder mehrere offene Aufgaben gibt.';
      Text001@1001 : TextConst 'ENU=You cannot delete the %2 record of the %1 because the contact is assigned one or more unlogged segments.;DEA=Sie k”nnen %1 %2 nicht l”schen, da der Kontakt einem oder mehreren unprotokollierten Segmenten zugeordnet ist.';
      Text002@1002 : TextConst 'ENU=You cannot delete the %2 record of the %1 because one or more opportunities are in not started or progress.;DEA=Sie k”nnen %1 %2 nicht l”schen, da es eine oder mehrere Verkaufschancen gibt, die in Bearbeitung sind oder noch nicht begonnen wurden.';
      Text003@1003 : TextConst 'ENU=%1 cannot be changed because one or more interaction log entries are linked to the contact.;DEA=%1 kann nicht ge„ndert werden, da mindestens ein Aktivit„tenprotokollposten mit dem Kontakt verknpft ist.';
      Text005@1005 : TextConst 'ENU=%1 cannot be changed because one or more to-dos are linked to the contact.;DEA=%1 kann nicht ge„ndert werden, da mindestens eine Aufgabe mit dem Kontakt verknpft ist.';
      Text006@1006 : TextConst 'ENU=%1 cannot be changed because one or more opportunities are linked to the contact.;DEA=%1 kann nicht ge„ndert werden, da mindestens eine Verkaufschance mit dem Kontakt verknpft ist.';
      Text007@1007 : TextConst 'ENU=%1 cannot be changed because there are one or more related people linked to the contact.;DEA=%1 kann nicht ge„ndert werden, da es eine oder mehrere Personen gibt, die mit dem Kontakt verknpft sind.';
      Text009@1009 : TextConst 'ENU=The %2 record of the %1 has been created.;DEA=%1 %2 wurde erstellt.';
      Text010@1010 : TextConst 'ENU=The %2 record of the %1 is not linked with any other table.;DEA=%1 %2 ist nicht mit einer anderen Tabelle verknpft.';
      RMSetup@1012 : Record 5079;
      Cont@1013 : Record 5050;
      ContBusRel@1014 : Record 5054;
      PostCode@1011 : Record 225;
      DuplMgt@1015 : Codeunit 5060;
      NoSeriesMgt@1016 : Codeunit 396;
      UpdateCustVendBank@1017 : Codeunit 5055;
      CampaignMgt@1050 : Codeunit 7030;
      ContChanged@1018 : Boolean;
      SkipDefaults@1019 : Boolean;
      Text012@1020 : TextConst 'ENU=You cannot change %1 because one or more unlogged segments are assigned to the contact.;DEA=Sie k”nnen %1 nicht „ndern, da diesem Kontakt mindestens ein unprotokolliertes Segment zugeordnet ist.';
      Text019@1022 : TextConst 'ENU=The %2 record of the %1 already has the %3 with %4 %5.;DEA=%1 %2 hat bereits die %3 mit %4 %5.';
      Text020@1021 : TextConst 'ENU=Do you want to create a contact %1 %2 as a customer using a customer template?;DEA=M”chten Sie aus dem Kontakt %1 %2 einen Debitor unter Verwendung einer Debitorenvorlage erstellen?';
      Text021@1023 : TextConst 'ENU=You have to set up formal and informal salutation formulas in %1  language for the %2 contact.;DEA=Sie mssen formelle und informelle Anredeformeln in der Sprache %1 fr den Kontakt %2 einrichten.';
      HideValidationDialog@1032 : Boolean;
      Text022@1034 : TextConst 'ENU=The creation of the customer has been aborted.;DEA=Die Erstellung des Debitors wurde abgebrochen.';
      Text029@1045 : TextConst 'ENU=The total length of first name, middle name and surname is %1 character(s)longer than the maximum length allowed for the Name field.;DEA=Die Gesamtl„nge von Vorname, zweitem Vornamen und Nachnamen ist %1 Zeichen l„nger als die zul„ssige Maximall„nge fr das Namensfeld.';
      Text032@1048 : TextConst 'ENU=The length of %1 is %2 character(s)longer than the maximum length allowed for the %1 field.;DEA=Die L„nge von %1 ist um %2 Zeichen l„nger als die maximal zul„ssige L„nge des %1-Felds.';
      Text033@1008 : TextConst 'ENU=Before you can use Online Map, you must fill in the Online Map Setup window.\See Setting Up Online Map in Help.;DEA=Bevor Sie Online Map verwenden k”nnen, mssen Sie die Felder des Fensters ''Online Map-Einrichtung'' ausfllen.\Informationen hierzu finden Sie in der Hilfe zum Einrichten von Online Map.';

    PROCEDURE OnModify@4(xRec@1005 : Record 5050);
    VAR
      OldCont@1001 : Record 5050;
    BEGIN
      "Last Date Modified" := TODAY;
      "Last Time Modified" := TIME;

      IF Type = Type::Company THEN BEGIN
        IF (Name <> xRec.Name) OR
           ("Search Name" <> xRec."Search Name") OR
           ("Name 2" <> xRec."Name 2") OR
           (Address <> xRec.Address) OR
           ("Address 2" <> xRec."Address 2") OR
           (City <> xRec.City) OR
           ("Phone No." <> xRec."Phone No.") OR
           ("Telex No." <> xRec."Telex No.") OR
           ("Territory Code" <> xRec."Territory Code") OR
           ("Currency Code" <> xRec."Currency Code") OR
           ("Language Code" <> xRec."Language Code") OR
           ("Salesperson Code" <> xRec."Salesperson Code") OR
           ("Country/Region Code" <> xRec."Country/Region Code") OR
           ("Fax No." <> xRec."Fax No.") OR
           ("Telex Answer Back" <> xRec."Telex Answer Back") OR
           ("VAT Registration No." <> xRec."VAT Registration No.") OR
           ("Post Code" <> xRec."Post Code") OR
           (County <> xRec.County) OR
           ("E-Mail" <> xRec."E-Mail") OR
           ("Home Page" <> xRec."Home Page")
        THEN
          UpdateCustVendBank.RUN(Rec);

        RMSetup.GET;
        Cont.RESET;
        Cont.SETCURRENTKEY("Company No.");
        Cont.SETRANGE("Company No.","No.");
        Cont.SETRANGE(Type,Type::Person);
        IF Cont.FIND('-') THEN
          REPEAT
            ContChanged := FALSE;
            OldCont := Cont;
            IF Name <> xRec.Name THEN BEGIN
              Cont."Company Name" := Name;
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Salesperson Code" AND
               (xRec."Salesperson Code" <> "Salesperson Code") AND
               (xRec."Salesperson Code" = Cont."Salesperson Code")
            THEN BEGIN
              Cont."Salesperson Code" := "Salesperson Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Territory Code" AND
               (xRec."Territory Code" <> "Territory Code") AND
               (xRec."Territory Code" = Cont."Territory Code")
            THEN BEGIN
              Cont."Territory Code" := "Territory Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Country/Region Code" AND
               (xRec."Country/Region Code" <> "Country/Region Code") AND
               (xRec."Country/Region Code" = Cont."Country/Region Code")
            THEN BEGIN
              Cont."Country/Region Code" := "Country/Region Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Language Code" AND
               (xRec."Language Code" <> "Language Code") AND
               (xRec."Language Code" = Cont."Language Code")
            THEN BEGIN
              Cont."Language Code" := "Language Code";
              ContChanged := TRUE;
            END;
            IF RMSetup."Inherit Address Details" THEN
              IF xRec.IdenticalAddress(Cont) THEN BEGIN
                IF xRec.Address <> Address THEN BEGIN
                  Cont.Address := Address;
                  ContChanged := TRUE;
                END;
                IF xRec."Address 2" <> "Address 2" THEN BEGIN
                  Cont."Address 2" := "Address 2";
                  ContChanged := TRUE;
                END;
                IF xRec."Post Code" <> "Post Code" THEN BEGIN
                  Cont."Post Code" := "Post Code";
                  ContChanged := TRUE;
                END;
                IF xRec.City <> City THEN BEGIN
                  Cont.City := City;
                  ContChanged := TRUE;
                END;
                IF xRec.County <> County THEN BEGIN
                  Cont.County := County;
                  ContChanged := TRUE;
                END;
              END;
            IF RMSetup."Inherit Communication Details" THEN BEGIN
              IF (xRec."Phone No." <> "Phone No.") AND (xRec."Phone No." = Cont."Phone No.") THEN BEGIN
                Cont."Phone No." := "Phone No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Telex No." <> "Telex No.") AND (xRec."Telex No." = Cont."Telex No.") THEN BEGIN
                Cont."Telex No." := "Telex No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Fax No." <> "Fax No.") AND (xRec."Fax No." = Cont."Fax No.") THEN BEGIN
                Cont."Fax No." := "Fax No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Telex Answer Back" <> "Telex Answer Back") AND (xRec."Telex Answer Back" = Cont."Telex Answer Back") THEN BEGIN
                Cont."Telex Answer Back" := "Telex Answer Back";
                ContChanged := TRUE;
              END;
              IF (xRec."E-Mail" <> "E-Mail") AND (xRec."E-Mail" = Cont."E-Mail") THEN BEGIN
                Cont.VALIDATE("E-Mail","E-Mail");
                ContChanged := TRUE;
              END;
              IF (xRec."Home Page" <> "Home Page") AND (xRec."Home Page" = Cont."Home Page") THEN BEGIN
                Cont."Home Page" := "Home Page";
                ContChanged := TRUE;
              END;
              IF (xRec."Extension No." <> "Extension No.") AND (xRec."Extension No." = Cont."Extension No.") THEN BEGIN
                Cont."Extension No." := "Extension No.";
                ContChanged := TRUE;
              END;
              IF (xRec."Mobile Phone No." <> "Mobile Phone No.") AND (xRec."Mobile Phone No." = Cont."Mobile Phone No.") THEN BEGIN
                Cont."Mobile Phone No." := "Mobile Phone No.";
                ContChanged := TRUE;
              END;
              IF (xRec.Pager <> Pager) AND (xRec.Pager = Cont.Pager) THEN BEGIN
                Cont.Pager := Pager;
                ContChanged := TRUE;
              END;
            END;
            IF ContChanged THEN BEGIN
              Cont.OnModify(OldCont);
              Cont.MODIFY;
            END;
          UNTIL Cont.NEXT = 0;

        IF (Name <> xRec.Name) OR
           ("Name 2" <> xRec."Name 2") OR
           (Address <> xRec.Address) OR
           ("Address 2" <> xRec."Address 2") OR
           (City <> xRec.City) OR
           ("Post Code" <> xRec."Post Code") OR
           ("VAT Registration No." <> xRec."VAT Registration No.") OR
           ("Phone No." <> xRec."Phone No.")
        THEN
          CheckDupl;
      END;
    END;

    PROCEDURE TypeChange@1();
    VAR
      InteractLogEntry@1000 : Record 5065;
      Opp@1001 : Record 5092;
      Todo@1002 : Record 5080;
      CampaignTargetGrMgt@1003 : Codeunit 7030;
    BEGIN
      RMSetup.GET;

      InteractLogEntry.LOCKTABLE;
      Todo.LOCKTABLE;
      Opp.LOCKTABLE;
      Cont.LOCKTABLE;
      InteractLogEntry.SETCURRENTKEY("Contact Company No.","Contact No.");
      InteractLogEntry.SETRANGE("Contact Company No.","Company No.");
      InteractLogEntry.SETRANGE("Contact No.","No.");
      IF InteractLogEntry.FINDFIRST THEN
        ERROR(Text003,FIELDCAPTION(Type));
      Todo.SETCURRENTKEY("Contact Company No.","Contact No.");
      Todo.SETRANGE("Contact Company No.","Company No.");
      Todo.SETRANGE("Contact No.","No.");
      IF Todo.FINDFIRST THEN
        ERROR(Text005,FIELDCAPTION(Type));
      Opp.SETCURRENTKEY("Contact Company No.","Contact No.");
      Opp.SETRANGE("Contact Company No.","Company No.");
      Opp.SETRANGE("Contact No.","No.");
      IF Opp.FINDFIRST THEN
        ERROR(Text006,FIELDCAPTION(Type));

      CASE Type OF
        Type::Company:
          BEGIN
            IF Type <> xRec.Type THEN BEGIN
              TESTFIELD("Organizational Level Code",'');
              TESTFIELD("No. of Job Responsibilities",0);
            END;
            "First Name" := '';
            "Middle Name" := '';
            Surname := '';
            "Job Title" := '';
            "Company No." := "No.";
            "Company Name" := Name;
            "Salutation Code" := RMSetup."Def. Company Salutation Code";
          END;
        Type::Person:
          BEGIN
            CampaignTargetGrMgt.DeleteContfromTargetGr(InteractLogEntry);
            Cont.RESET;
            Cont.SETCURRENTKEY("Company No.");
            Cont.SETRANGE("Company No.","No.");
            Cont.SETRANGE(Type,Type::Person);
            IF Cont.FIND('-') THEN
              ERROR(Text007,FIELDCAPTION(Type));
            IF Type <> xRec.Type THEN BEGIN
              TESTFIELD("No. of Business Relations",0);
              TESTFIELD("No. of Industry Groups",0);
              TESTFIELD("Currency Code",'');
              TESTFIELD("VAT Registration No.",'');
            END;
            IF "Company No." = "No." THEN BEGIN
              "Company No." := '';
              "Company Name" := '';
              "Salutation Code" := RMSetup."Default Person Salutation Code";
              NameBreakdown;
            END;
          END;
      END;
      VALIDATE("Lookup Contact No.");

      IF Cont.GET("No.") THEN BEGIN
        IF Type = Type::Company THEN
          CheckDupl
        ELSE
          DuplMgt.RemoveContIndex(Rec,FALSE);
      END;
    END;

    PROCEDURE AssistEdit@2(OldCont@1000 : Record 5050) : Boolean;
    BEGIN
      WITH Cont DO BEGIN
        Cont := Rec;
        RMSetup.GET;
        RMSetup.TESTFIELD("Contact Nos.");
        IF NoSeriesMgt.SelectSeries(RMSetup."Contact Nos.",OldCont."No. Series","No. Series") THEN BEGIN
          RMSetup.GET;
          RMSetup.TESTFIELD("Contact Nos.");
          NoSeriesMgt.SetSeries("No.");
          Rec := Cont;
          EXIT(TRUE);
        END;
      END;
    END;

    PROCEDURE CreateCustomer@3(CustomerTemplate@1006 : Code[10]);
    VAR
      Cust@1000 : Record 18;
      ContComp@1001 : Record 5050;
      CustTemplate@1003 : Record 5105;
      DefaultDim@1005 : Record 352;
      DefaultDim2@1004 : Record 352;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Customers");

      ContBusRel.RESET;
      ContBusRel.SETRANGE("Contact No.","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      IF ContBusRel.FINDFIRST THEN
        ERROR(
          Text019,
          TABLECAPTION,"No.",ContBusRel.TABLECAPTION,ContBusRel."Link to Table",ContBusRel."No.");

      IF CustomerTemplate <> '' THEN
        CustTemplate.GET(CustomerTemplate);

      CLEAR(Cust);
      Cust.SetInsertFromContact(TRUE);
      Cust.INSERT(TRUE);
      Cust.SetInsertFromContact(FALSE);

      IF Type = Type::Company THEN
        ContComp := Rec
      ELSE
        ContComp.GET("Company No.");

      ContBusRel."Contact No." := ContComp."No.";
      ContBusRel."Business Relation Code" := RMSetup."Bus. Rel. Code for Customers";
      ContBusRel."Link to Table" := ContBusRel."Link to Table"::Customer;
      ContBusRel."No." := Cust."No.";
      ContBusRel.INSERT(TRUE);

      UpdateCustVendBank.UpdateCustomer(ContComp,ContBusRel);

      Cust.GET(ContBusRel."No.");
      Cust.VALIDATE(Name,"Company Name");
      Cust.MODIFY;

      IF CustTemplate.Code <> '' THEN BEGIN
        Cust."Territory Code" := CustTemplate."Territory Code";
        Cust."Currency Code" := CustTemplate."Currency Code";
        Cust."Country/Region Code" := CustTemplate."Country/Region Code";
        Cust."Customer Posting Group" := CustTemplate."Customer Posting Group";
        Cust."Customer Price Group" := CustTemplate."Customer Price Group";
        IF CustTemplate."Invoice Disc. Code" <> '' THEN
          Cust."Invoice Disc. Code" := CustTemplate."Invoice Disc. Code";
        Cust."Customer Disc. Group" := CustTemplate."Customer Disc. Group";
        Cust."Allow Line Disc." := CustTemplate."Allow Line Disc.";
        Cust."Gen. Bus. Posting Group" := CustTemplate."Gen. Bus. Posting Group";
        Cust."VAT Bus. Posting Group" := CustTemplate."VAT Bus. Posting Group";
        Cust."Payment Terms Code" := CustTemplate."Payment Terms Code";
        Cust."Payment Method Code" := CustTemplate."Payment Method Code";
        Cust."Shipment Method Code" := CustTemplate."Shipment Method Code";
        Cust.MODIFY;

        DefaultDim.SETRANGE("Table ID",DATABASE::"Customer Template");
        DefaultDim.SETRANGE("No.",CustTemplate.Code);
        IF DefaultDim.FIND('-') THEN
          REPEAT
            CLEAR(DefaultDim2);
            DefaultDim2.INIT;
            DefaultDim2.VALIDATE("Table ID",DATABASE::Customer);
            DefaultDim2."No." := Cust."No.";
            DefaultDim2.VALIDATE("Dimension Code",DefaultDim."Dimension Code");
            DefaultDim2.VALIDATE("Dimension Value Code",DefaultDim."Dimension Value Code");
            DefaultDim2."Value Posting" := DefaultDim."Value Posting";
            DefaultDim2.INSERT(TRUE);
          UNTIL DefaultDim.NEXT = 0;
      END;

      UpdateQuotes(Cust);
      CampaignMgt.ConverttoCustomer(Rec,Cust);
      MESSAGE(Text009,Cust.TABLECAPTION,Cust."No.");
    END;

    PROCEDURE CreateVendor@7();
    VAR
      Vend@1000 : Record 23;
      ContComp@1001 : Record 5050;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Vendors");

      CLEAR(Vend);
      Vend.SetInsertFromContact(TRUE);
      Vend.INSERT(TRUE);
      Vend.SetInsertFromContact(FALSE);

      IF Type = Type::Company THEN
        ContComp := Rec
      ELSE
        ContComp.GET("Company No.");

      ContBusRel."Contact No." := ContComp."No.";
      ContBusRel."Business Relation Code" := RMSetup."Bus. Rel. Code for Vendors";
      ContBusRel."Link to Table" := ContBusRel."Link to Table"::Vendor;
      ContBusRel."No." := Vend."No.";
      ContBusRel.INSERT(TRUE);

      UpdateCustVendBank.UpdateVendor(ContComp,ContBusRel);

      MESSAGE(Text009,Vend.TABLECAPTION,Vend."No.");
    END;

    PROCEDURE CreateBankAccount@8();
    VAR
      BankAcc@1000 : Record 270;
      ContComp@1001 : Record 5050;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Bank Accs.");

      CLEAR(BankAcc);
      BankAcc.SetInsertFromContact(TRUE);
      BankAcc.INSERT(TRUE);
      BankAcc.SetInsertFromContact(FALSE);

      IF Type = Type::Company THEN
        ContComp := Rec
      ELSE
        ContComp.GET("Company No.");

      ContBusRel."Contact No." := ContComp."No.";
      ContBusRel."Business Relation Code" := RMSetup."Bus. Rel. Code for Bank Accs.";
      ContBusRel."Link to Table" := ContBusRel."Link to Table"::"Bank Account";
      ContBusRel."No." := BankAcc."No.";
      ContBusRel.INSERT(TRUE);

      UpdateCustVendBank.UpdateBankAccount(ContComp,ContBusRel);

      MESSAGE(Text009,BankAcc.TABLECAPTION,BankAcc."No.");
    END;

    PROCEDURE CreateCustomerLink@5();
    VAR
      Cust@1001 : Record 18;
      ContBusRel@1000 : Record 5054;
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Customers");
      CreateLink(
        PAGE::"Customer Link",
        RMSetup."Bus. Rel. Code for Customers",
        ContBusRel."Link to Table"::Customer);

      ContBusRel.SETCURRENTKEY("Link to Table","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      ContBusRel.SETRANGE("Contact No.","Company No.");
      IF ContBusRel.FINDFIRST THEN
        IF Cust.GET(ContBusRel."No.") THEN
          UpdateQuotes(Cust);
    END;

    PROCEDURE CreateVendorLink@6();
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Vendors");
      CreateLink(
        PAGE::"Vendor Link",
        RMSetup."Bus. Rel. Code for Vendors",
        ContBusRel."Link to Table"::Vendor);
    END;

    PROCEDURE CreateBankAccountLink@9();
    BEGIN
      TESTFIELD("Company No.");
      RMSetup.GET;
      RMSetup.TESTFIELD("Bus. Rel. Code for Bank Accs.");
      CreateLink(
        PAGE::"Bank Account Link",
        RMSetup."Bus. Rel. Code for Bank Accs.",
        ContBusRel."Link to Table"::"Bank Account");
    END;

    LOCAL PROCEDURE CreateLink@11(CreateForm@1000 : Integer;BusRelCode@1001 : Code[10];Table@1002 : 'Customer,Vendor,Bank Account');
    VAR
      TempContBusRel@1003 : TEMPORARY Record 5054;
    BEGIN
      TempContBusRel."Contact No." := "Company No.";
      TempContBusRel."Business Relation Code" := BusRelCode;
      TempContBusRel."Link to Table" := Table;
      TempContBusRel.INSERT;
      IF PAGE.RUNMODAL(CreateForm,TempContBusRel) = ACTION::LookupOK THEN; // enforce look up mode dialog
      TempContBusRel.DELETEALL;
    END;

    PROCEDURE CreateInteraction@10();
    VAR
      SegmentLine@1000 : TEMPORARY Record 5077;
    BEGIN
      SegmentLine.CreateInteractionFromContact(Rec);
    END;

    PROCEDURE ShowCustVendBank@12();
    VAR
      ContBusRel@1000 : Record 5054;
      FormSelected@1001 : Boolean;
      Cust@1002 : Record 18;
      Vend@1003 : Record 23;
      BankAcc@1004 : Record 270;
    BEGIN
      FormSelected := TRUE;

      ContBusRel.RESET;
      ContBusRel.SETRANGE("Contact No.","Company No.");
      ContBusRel.SETFILTER("No.",'<>''''');

      CASE ContBusRel.COUNT OF
        0:
          ERROR(Text010,TABLECAPTION,"No.");
        1:
          ContBusRel.FINDFIRST;
        ELSE
          FormSelected := PAGE.RUNMODAL(PAGE::"Contact Business Relations",ContBusRel) = ACTION::LookupOK;
      END;

      IF FormSelected THEN
        CASE ContBusRel."Link to Table" OF
          ContBusRel."Link to Table"::Customer:
            BEGIN
              Cust.GET(ContBusRel."No.");
              PAGE.RUN(PAGE::"Customer Card",Cust);
            END;
          ContBusRel."Link to Table"::Vendor:
            BEGIN
              Vend.GET(ContBusRel."No.");
              PAGE.RUN(PAGE::"Vendor Card",Vend);
            END;
          ContBusRel."Link to Table"::"Bank Account":
            BEGIN
              BankAcc.GET(ContBusRel."No.");
              PAGE.RUN(PAGE::"Bank Account Card",BankAcc);
            END;
        END;
    END;

    LOCAL PROCEDURE NameBreakdown@13();
    VAR
      NamePart@1000 : ARRAY [30] OF Text[250];
      TempName@1001 : Text[250];
      FirstName250@1004 : Text[250];
      i@1002 : Integer;
      NoOfParts@1003 : Integer;
    BEGIN
      IF Type = Type::Company THEN
        EXIT;

      TempName := Name;
      WHILE STRPOS(TempName,' ') > 0 DO BEGIN
        IF STRPOS(TempName,' ') > 1 THEN BEGIN
          i := i + 1;
          NamePart[i] := COPYSTR(TempName,1,STRPOS(TempName,' ') - 1);
        END;
        TempName := COPYSTR(TempName,STRPOS(TempName,' ') + 1);
      END;
      i := i + 1;
      NamePart[i] := TempName;
      NoOfParts := i;

      "First Name" := '';
      "Middle Name" := '';
      Surname := '';
      FOR i := 1 TO NoOfParts DO
        IF (i = NoOfParts) AND (NoOfParts > 1) THEN BEGIN
          IF STRLEN(NamePart[i]) > MAXSTRLEN(Surname) THEN
            ERROR(Text032,FIELDCAPTION(Surname),STRLEN(NamePart[i]) - MAXSTRLEN(Surname));
          Surname := NamePart[i]
        END ELSE
          IF (i = NoOfParts - 1) AND (NoOfParts > 2) THEN BEGIN
            IF STRLEN(NamePart[i]) > MAXSTRLEN("Middle Name") THEN
              ERROR(Text032,FIELDCAPTION("Middle Name"),STRLEN(NamePart[i]) - MAXSTRLEN("Middle Name"));
            "Middle Name" := NamePart[i]
          END ELSE BEGIN
            FirstName250 := DELCHR("First Name" + ' ' + NamePart[i],'<',' ');
            IF STRLEN(FirstName250) > MAXSTRLEN("First Name") THEN
              ERROR(Text032,FIELDCAPTION("First Name"),STRLEN(FirstName250) - MAXSTRLEN("First Name"));
            "First Name" := FirstName250;
          END;
    END;

    PROCEDURE SetSkipDefault@15(Defaults@1000 : Boolean);
    BEGIN
      SkipDefaults := NOT Defaults;
    END;

    PROCEDURE IdenticalAddress@16(VAR Cont@1000 : Record 5050) : Boolean;
    BEGIN
      EXIT(
        (Address = Cont.Address) AND
        ("Address 2" = Cont."Address 2") AND
        ("Post Code" = Cont."Post Code") AND
        (City = Cont.City))
    END;

    PROCEDURE ActiveAltAddress@17(ActiveDate@1000 : Date) : Code[10];
    VAR
      ContAltAddrDateRange@1001 : Record 5052;
    BEGIN
      ContAltAddrDateRange.SETCURRENTKEY("Contact No.","Starting Date");
      ContAltAddrDateRange.SETRANGE("Contact No.","No.");
      ContAltAddrDateRange.SETRANGE("Starting Date",0D,ActiveDate);
      ContAltAddrDateRange.SETFILTER("Ending Date",'>=%1|%2',ActiveDate,0D);
      IF ContAltAddrDateRange.FINDLAST THEN
        EXIT(ContAltAddrDateRange."Contact Alt. Address Code");

      EXIT('');
    END;

    LOCAL PROCEDURE CalculatedName@14() NewName@1000 : Text[50];
    VAR
      NewName92@1001 : Text[92];
    BEGIN
      IF "First Name" <> '' THEN
        NewName92 := "First Name";
      IF "Middle Name" <> '' THEN
        NewName92 := NewName92 + ' ' + "Middle Name";
      IF Surname <> '' THEN
        NewName92 := NewName92 + ' ' + Surname;

      NewName92 := DELCHR(NewName92,'<',' ');

      IF STRLEN(NewName92) > MAXSTRLEN(Name) THEN
        ERROR(Text029,STRLEN(NewName92) - MAXSTRLEN(Name));

      NewName := COPYSTR(NewName92,1,STRLEN(NewName92));
    END;

    LOCAL PROCEDURE UpdateSearchName@22();
    BEGIN
      IF ("Search Name" = UPPERCASE(xRec.Name)) OR ("Search Name" = '') THEN
        "Search Name" := Name;
    END;

    LOCAL PROCEDURE CheckDupl@21();
    BEGIN
      IF RMSetup."Maintain Dupl. Search Strings" THEN
        DuplMgt.MakeContIndex(Rec);
      IF GUIALLOWED THEN
        IF DuplMgt.DuplicateExist(Rec) THEN BEGIN
          MODIFY;
          COMMIT;
          DuplMgt.LaunchDuplicateForm(Rec);
        END;
    END;

    PROCEDURE FindCustomerTemplate@23() FindCustTemplate@1001 : Code[10];
    VAR
      CustTemplate@1003 : Record 5105;
      ContCompany@1002 : Record 5050;
    BEGIN
      CustTemplate.RESET;
      CustTemplate.SETRANGE("Territory Code","Territory Code");
      CustTemplate.SETRANGE("Country/Region Code","Country/Region Code");
      IF ContCompany.GET("Company No.") THEN
        CustTemplate.SETRANGE("Currency Code",ContCompany."Currency Code");

      IF CustTemplate.COUNT = 1 THEN BEGIN
        CustTemplate.FINDFIRST;
        EXIT(CustTemplate.Code);
      END;
    END;

    PROCEDURE ChooseCustomerTemplate@27() ChooseCustTemplate@1001 : Code[10];
    VAR
      CustTemplate@1000 : Record 5105;
    BEGIN
      ContBusRel.RESET;
      ContBusRel.SETRANGE("Contact No.","No.");
      ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
      IF ContBusRel.FINDFIRST THEN
        ERROR(
          Text019,
          TABLECAPTION,"No.",ContBusRel.TABLECAPTION,ContBusRel."Link to Table",ContBusRel."No.");

      IF CONFIRM(Text020,TRUE,"No.",Name) THEN BEGIN
        IF PAGE.RUNMODAL(0,CustTemplate) = ACTION::LookupOK THEN
          EXIT(CustTemplate.Code);

        ERROR(Text022);
      END;
    END;

    LOCAL PROCEDURE UpdateQuotes@29(Customer@1000 : Record 18);
    VAR
      SalesHeader@1003 : Record 36;
      Cont@1004 : Record 5050;
      SalesLine@1001 : Record 37;
    BEGIN
      Cont.SETCURRENTKEY("Company No.");
      Cont.SETRANGE("Company No.","Company No.");

      IF Cont.FIND('-') THEN
        REPEAT
          SalesHeader.RESET;
          SalesHeader.SETCURRENTKEY("Document Type","Sell-to Contact No.");
          SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Quote);
          SalesHeader.SETRANGE("Sell-to Contact No.",Cont."No.");
          IF SalesHeader.FIND('-') THEN
            REPEAT
              SalesHeader."Sell-to Customer No." := Customer."No.";
              SalesHeader."Sell-to Customer Template Code" := '';
              SalesHeader.MODIFY;
              SalesLine.SETRANGE("Document Type",SalesHeader."Document Type");
              SalesLine.SETRANGE("Document No.",SalesHeader."No.");
              IF SalesLine.FINDFIRST THEN
                SalesLine.MODIFYALL("Sell-to Customer No.",SalesHeader."Sell-to Customer No.");
            UNTIL SalesHeader.NEXT = 0;

          SalesHeader.RESET;
          SalesHeader.SETCURRENTKEY("Bill-to Contact No.");
          SalesHeader.SETRANGE("Document Type",SalesHeader."Document Type"::Quote);
          SalesHeader.SETRANGE("Bill-to Contact No.",Cont."No.");
          IF SalesHeader.FIND('-') THEN
            REPEAT
              SalesHeader."Bill-to Customer No." := Customer."No.";
              SalesHeader."Bill-to Customer Template Code" := '';
              SalesHeader."Salesperson Code" := Customer."Salesperson Code";
              SalesHeader.MODIFY;
              SalesLine.SETRANGE("Document Type",SalesHeader."Document Type");
              SalesLine.SETRANGE("Document No.",SalesHeader."No.");
              IF SalesLine.FINDFIRST THEN
                SalesLine.MODIFYALL("Bill-to Customer No.",SalesHeader."Bill-to Customer No.");
            UNTIL SalesHeader.NEXT = 0;
        UNTIL Cont.NEXT = 0;
    END;

    PROCEDURE GetSalutation@18(SalutationType@1001 : 'Formal,Informal';LanguageCode@1000 : Code[10]) : Text[260];
    VAR
      SalutationFormula@1005 : Record 5069;
      NamePart@1004 : ARRAY [5] OF Text[50];
      SubStr@1003 : Text[30];
      i@1002 : Integer;
    BEGIN
      IF NOT SalutationFormula.GET("Salutation Code",LanguageCode,SalutationType) THEN
        ERROR(Text021,LanguageCode,"No.");
      SalutationFormula.TESTFIELD(Salutation);

      CASE SalutationFormula."Name 1" OF
        SalutationFormula."Name 1"::"Job Title":
          NamePart[1] := "Job Title";
        SalutationFormula."Name 1"::"First Name":
          NamePart[1] := "First Name";
        SalutationFormula."Name 1"::"Middle Name":
          NamePart[1] := "Middle Name";
        SalutationFormula."Name 1"::Surname:
          NamePart[1] := Surname;
        SalutationFormula."Name 1"::Initials:
          NamePart[1] := Initials;
        SalutationFormula."Name 1"::"Company Name":
          NamePart[1] := "Company Name";
      END;

      CASE SalutationFormula."Name 2" OF
        SalutationFormula."Name 2"::"Job Title":
          NamePart[2] := "Job Title";
        SalutationFormula."Name 2"::"First Name":
          NamePart[2] := "First Name";
        SalutationFormula."Name 2"::"Middle Name":
          NamePart[2] := "Middle Name";
        SalutationFormula."Name 2"::Surname:
          NamePart[2] := Surname;
        SalutationFormula."Name 2"::Initials:
          NamePart[2] := Initials;
        SalutationFormula."Name 2"::"Company Name":
          NamePart[2] := "Company Name";
      END;

      CASE SalutationFormula."Name 3" OF
        SalutationFormula."Name 3"::"Job Title":
          NamePart[3] := "Job Title";
        SalutationFormula."Name 3"::"First Name":
          NamePart[3] := "First Name";
        SalutationFormula."Name 3"::"Middle Name":
          NamePart[3] := "Middle Name";
        SalutationFormula."Name 3"::Surname:
          NamePart[3] := Surname;
        SalutationFormula."Name 3"::Initials:
          NamePart[3] := Initials;
        SalutationFormula."Name 3"::"Company Name":
          NamePart[3] := "Company Name";
      END;

      CASE SalutationFormula."Name 4" OF
        SalutationFormula."Name 4"::"Job Title":
          NamePart[4] := "Job Title";
        SalutationFormula."Name 4"::"First Name":
          NamePart[4] := "First Name";
        SalutationFormula."Name 4"::"Middle Name":
          NamePart[4] := "Middle Name";
        SalutationFormula."Name 4"::Surname:
          NamePart[4] := Surname;
        SalutationFormula."Name 4"::Initials:
          NamePart[4] := Initials;
        SalutationFormula."Name 4"::"Company Name":
          NamePart[4] := "Company Name";
      END;

      CASE SalutationFormula."Name 5" OF
        SalutationFormula."Name 5"::"Job Title":
          NamePart[5] := "Job Title";
        SalutationFormula."Name 5"::"First Name":
          NamePart[5] := "First Name";
        SalutationFormula."Name 5"::"Middle Name":
          NamePart[5] := "Middle Name";
        SalutationFormula."Name 5"::Surname:
          NamePart[5] := Surname;
        SalutationFormula."Name 5"::Initials:
          NamePart[5] := Initials;
        SalutationFormula."Name 5"::"Company Name":
          NamePart[5] := "Company Name";
      END;

      FOR i := 1 TO 5 DO
        IF NamePart[i] = '' THEN BEGIN
          SubStr := '%' + FORMAT(i) + ' ';
          IF STRPOS(SalutationFormula.Salutation,SubStr) > 0 THEN
            SalutationFormula.Salutation :=
              DELSTR(SalutationFormula.Salutation,STRPOS(SalutationFormula.Salutation,SubStr),3);
        END;

      EXIT(STRSUBSTNO(SalutationFormula.Salutation,NamePart[1],NamePart[2],NamePart[3],NamePart[4],NamePart[5]))
    END;

    PROCEDURE InheritCompanyToPersonData@24(Cont@1000 : Record 5050;KeepPersonalData@1001 : Boolean);
    BEGIN
      "Company Name" := Cont.Name;

      RMSetup.GET;
      IF RMSetup."Inherit Salesperson Code" THEN
        "Salesperson Code" := Cont."Salesperson Code";
      IF RMSetup."Inherit Territory Code" THEN
        "Territory Code" := Cont."Territory Code";
      IF RMSetup."Inherit Country/Region Code" THEN
        "Country/Region Code" := Cont."Country/Region Code";
      IF RMSetup."Inherit Language Code" THEN
        "Language Code" := Cont."Language Code";
      IF RMSetup."Inherit Address Details" AND
         ((NOT KeepPersonalData) OR
          (Cont.Address + Cont."Address 2" + Cont.County + Cont."Post Code" + Cont.City <> ''))
      THEN BEGIN
        Address := Cont.Address;
        "Address 2" := Cont."Address 2";
        "Post Code" := Cont."Post Code";
        City := Cont.City;
        County := Cont.County;
      END;
      IF RMSetup."Inherit Communication Details" THEN BEGIN
        IF (Cont."Phone No." <> '') OR NOT KeepPersonalData THEN
          "Phone No." := Cont."Phone No.";
        IF (Cont."Telex No." <> '') OR NOT KeepPersonalData THEN
          "Telex No." := Cont."Telex No.";
        IF (Cont."Fax No." <> '') OR NOT KeepPersonalData THEN
          "Fax No." := Cont."Fax No.";
        IF (Cont."Telex Answer Back" <> '') OR NOT KeepPersonalData THEN
          "Telex Answer Back" := Cont."Telex Answer Back";
        IF (Cont."E-Mail" <> '') OR NOT KeepPersonalData THEN
          VALIDATE("E-Mail",Cont."E-Mail");
        IF (Cont."Home Page" <> '') OR NOT KeepPersonalData THEN
          "Home Page" := Cont."Home Page";
        IF (Cont."Extension No." <> '') OR NOT KeepPersonalData THEN
          "Extension No." := Cont."Extension No.";
        IF (Cont."Mobile Phone No." <> '') OR NOT KeepPersonalData THEN
          "Mobile Phone No." := Cont."Mobile Phone No.";
        IF (Cont.Pager <> '') OR NOT KeepPersonalData THEN
          Pager := Cont.Pager;
        IF (Cont."Correspondence Type" <> "Correspondence Type"::" ") OR NOT KeepPersonalData THEN
          "Correspondence Type" := Cont."Correspondence Type";
      END;
      CALCFIELDS("No. of Industry Groups","No. of Business Relations");
    END;

    PROCEDURE SetHideValidationDialog@26(NewHideValidationDialog@1000 : Boolean) : Boolean;
    BEGIN
      HideValidationDialog := NewHideValidationDialog;
    END;

    PROCEDURE DisplayMap@36();
    VAR
      MapPoint@1001 : Record 800;
      MapMgt@1000 : Codeunit 802;
    BEGIN
      IF MapPoint.FINDFIRST THEN
        MapMgt.MakeSelection(DATABASE::Contact,GETPOSITION)
      ELSE
        MESSAGE(Text033);
    END;

    LOCAL PROCEDURE ProcessNameChange@37();
    VAR
      ContBusRel@1000 : Record 5054;
      Cust@1001 : Record 18;
      Vend@1002 : Record 23;
    BEGIN
      UpdateSearchName;

      IF Type = Type::Company THEN
        "Company Name" := Name;

      IF Type = Type::Person THEN BEGIN
        ContBusRel.RESET;
        ContBusRel.SETCURRENTKEY("Link to Table","Contact No.");
        ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Customer);
        ContBusRel.SETRANGE("Contact No.","Company No.");
        IF ContBusRel.FINDFIRST THEN
          IF Cust.GET(ContBusRel."No.") THEN
            IF Cust."Primary Contact No." = "No." THEN BEGIN
              Cust.Contact := Name;
              Cust.MODIFY;
            END;

        ContBusRel.SETRANGE("Link to Table",ContBusRel."Link to Table"::Vendor);
        IF ContBusRel.FINDFIRST THEN
          IF Vend.GET(ContBusRel."No.") THEN
            IF Vend."Primary Contact No." = "No." THEN BEGIN
              Vend.Contact := Name;
              Vend.MODIFY;
            END;
      END;
    END;

    BEGIN
    {
      CMMS
        20170310  Added Field "CMMS Is CMMS Contact"
                  Added Key "CMMS Is CMMS Contact,No."
    }
    END.
  }
}

OBJECT Table 5064 Interaction Template
{
  OBJECT-PROPERTIES
  {
    Date=09.11.16;
    Time=14:07:35;
    Modified=Yes;
    Version List=NAVW17.00,CMMS;
  }
  PROPERTIES
  {
    OnDelete=VAR
               InteractTmplLanguage@1000 : Record 5103;
             BEGIN
               InteractTmplLanguage.SETRANGE("Interaction Template Code",Code);
               InteractTmplLanguage.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=Interaction Template;
               DEA=Aktivit„tenvorlage];
    LookupPageID=Page5075;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              DEA=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Interaction Group Code;Code10      ;TableRelation="Interaction Group";
                                                   CaptionML=[ENU=Interaction Group Code;
                                                              DEA=Aktivit„tengruppencode];
                                                   NotBlank=Yes }
    { 3   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 4   ;   ;Unit Cost (LCY)     ;Decimal       ;CaptionML=[ENU=Unit Cost (LCY);
                                                              DEA=Einstandspreis (MW)];
                                                   MinValue=0;
                                                   AutoFormatType=1 }
    { 5   ;   ;Unit Duration (Min.);Decimal       ;CaptionML=[ENU=Unit Duration (Min.);
                                                              DEA=Vorgabedauer (Min.)];
                                                   DecimalPlaces=0:0;
                                                   MinValue=0 }
    { 6   ;   ;Information Flow    ;Option        ;CaptionML=[ENU=Information Flow;
                                                              DEA=Informationsfluss];
                                                   OptionCaptionML=[ENU=" ,Outbound,Inbound";
                                                                    DEA=" ,Ausgehend,Eingehend"];
                                                   OptionString=[ ,Outbound,Inbound] }
    { 7   ;   ;Initiated By        ;Option        ;CaptionML=[ENU=Initiated By;
                                                              DEA=Veranlasst durch];
                                                   OptionCaptionML=[ENU=" ,Us,Them";
                                                                    DEA=" ,Uns,Kontakt"];
                                                   OptionString=[ ,Us,Them] }
    { 8   ;   ;Attachment No.      ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Interaction Tmpl. Language"."Attachment No." WHERE (Interaction Template Code=FIELD(Code),
                                                                                                                           Language Code=FIELD("Language Code (Default)")));
                                                   CaptionML=[ENU=Attachment No.;
                                                              DEA=Dateianhangsnr.];
                                                   Editable=No }
    { 9   ;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   CaptionML=[ENU=Campaign No.;
                                                              DEA=Kampagnennr.] }
    { 10  ;   ;Campaign Target     ;Boolean       ;CaptionML=[ENU=Campaign Target;
                                                              DEA=Kampagnenziel] }
    { 11  ;   ;Campaign Response   ;Boolean       ;CaptionML=[ENU=Campaign Response;
                                                              DEA=Kampagnenreaktion] }
    { 12  ;   ;Correspondence Type (Default);Option;
                                                   OnValidate=VAR
                                                                Attachment@1001 : Record 5062;
                                                                ErrorText@1000 : Text[80];
                                                              BEGIN
                                                                IF NOT Attachment.GET("Attachment No.") THEN
                                                                  EXIT;

                                                                ErrorText := Attachment.CheckCorrespondenceType("Correspondence Type (Default)");
                                                                IF ErrorText <> '' THEN
                                                                  ERROR(
                                                                    STRSUBSTNO('%1%2',
                                                                      STRSUBSTNO(Text003,
                                                                        FIELDCAPTION("Correspondence Type (Default)"),
                                                                        "Correspondence Type (Default)",
                                                                        TABLECAPTION,
                                                                        Code),
                                                                      ErrorText));
                                                              END;

                                                   CaptionML=[ENU=Correspondence Type (Default);
                                                              DEA=Korrespondenzart (Standard)];
                                                   OptionCaptionML=[ENU=" ,Hard Copy,E-Mail,Fax";
                                                                    DEA=" ,Brief,E-Mail,Fax"];
                                                   OptionString=[ ,Hard Copy,E-Mail,Fax] }
    { 13  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              DEA=Datumsfilter] }
    { 14  ;   ;No. of Interactions ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (Interaction Template Code=FIELD(Code),
                                                                                                    Canceled=CONST(No),
                                                                                                    Date=FIELD(Date Filter),
                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=No. of Interactions;
                                                              DEA=Anzahl Aktivit„ten];
                                                   Editable=No }
    { 15  ;   ;Cost (LCY)          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Cost (LCY)" WHERE (Interaction Template Code=FIELD(Code),
                                                                                                               Canceled=CONST(No),
                                                                                                               Date=FIELD(Date Filter),
                                                                                                               Postponed=CONST(No)));
                                                   CaptionML=[ENU=Cost (LCY);
                                                              DEA=Einstandsbetrag (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 16  ;   ;Duration (Min.)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Duration (Min.)" WHERE (Interaction Template Code=FIELD(Code),
                                                                                                                    Canceled=CONST(No),
                                                                                                                    Date=FIELD(Date Filter),
                                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=Duration (Min.);
                                                              DEA=Dauer (Min.)];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 17  ;   ;Language Code (Default);Code10     ;TableRelation=Language;
                                                   OnValidate=VAR
                                                                InteractTmplLanguage@1000 : Record 5103;
                                                              BEGIN
                                                                IF NOT InteractTmplLanguage.GET(Code,"Language Code (Default)") THEN BEGIN
                                                                  IF CONFIRM(Text004,TRUE,InteractTmplLanguage.TABLECAPTION,"Language Code (Default)") THEN BEGIN
                                                                    InteractTmplLanguage.INIT;
                                                                    InteractTmplLanguage."Interaction Template Code" := Code;
                                                                    InteractTmplLanguage."Language Code" := "Language Code (Default)";
                                                                    InteractTmplLanguage.Description := Description;
                                                                    InteractTmplLanguage.INSERT;
                                                                  END ELSE
                                                                    ERROR('');
                                                                END;
                                                                CALCFIELDS("Attachment No.");
                                                              END;

                                                   OnLookup=VAR
                                                              InteractTmplLanguage@1000 : Record 5103;
                                                            BEGIN
                                                              InteractTmplLanguage.SETRANGE("Interaction Template Code",Code);
                                                              IF PAGE.RUNMODAL(0,InteractTmplLanguage) = ACTION::LookupOK THEN
                                                                "Language Code (Default)" := InteractTmplLanguage."Language Code";
                                                            END;

                                                   CaptionML=[ENU=Language Code (Default);
                                                              DEA=Sprachcode (Standard)] }
    { 18  ;   ;Wizard Action       ;Option        ;CaptionML=[ENU=Wizard Action;
                                                              DEA=Aktion des Assistenten];
                                                   OptionCaptionML=[ENU=" ,Open,Import,,,,,Information";
                                                                    DEA=" ,Dateianhang ”ffnen,Dateianhang importieren,,,,,Information"];
                                                   OptionString=[ ,Open,Import,,,,,Information];
                                                   Description=IG }
    { 19  ;   ;Ignore Contact Corres. Type;Boolean;CaptionML=[ENU=Ignore Contact Corres. Type;
                                                              DEA=Kontakt Korrespond.-Art ignor.] }
    { 50000;  ;IG Information Type ;Option        ;CaptionML=[ENU=Information Type;
                                                              DEA=Information Typ];
                                                   OptionCaptionML=[ENU=" ,Comment,Comment (long),,,,,,,,Replacement,Installation";
                                                                    DEA=" ,Kommentar,Kommentar (lang),,,,,,,,Austausch,Installation"];
                                                   OptionString=[ ,Comment,Comment (long),,,,,,,,Replacement,Installation];
                                                   Description=IG }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
    {    ;Interaction Group Code                   }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Code,Description,Information Flow        }
  }
  CODE
  {
    VAR
      Text003@1003 : TextConst 'ENU="%1 = %2 can not be specified for %3 %4.\";DEA="Die %1 = %2 kann fr %3 %4 nicht angegeben werden.\"';
      Text004@1004 : TextConst 'ENU=Do you want to create %1 %2?;DEA=M”chten Sie die %1 %2 erstellen?';

    BEGIN
    END.
  }
}

OBJECT Table 5065 Interaction Log Entry
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=13:14:15;
    Modified=Yes;
    Version List=NAVW19.00,NAVDACH9.00,CMMS;
  }
  PROPERTIES
  {
    OnDelete=VAR
               InteractionCommentLine@1000 : Record 5123;
               CampaignMgt@1001 : Codeunit 7030;
             BEGIN
               InteractionCommentLine.SETRANGE("Entry No.","Entry No.");
               InteractionCommentLine.DELETEALL;

               CampaignMgt.DeleteContfromTargetGr(Rec);
             END;

    CaptionML=[ENU=Interaction Log Entry;
               DEA=Aktivit„tenprotokollposten];
    LookupPageID=Page5076;
    DrillDownPageID=Page5076;
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer       ;CaptionML=[ENU=Entry No.;
                                                              DEA=Lfd. Nr.];
                                                   Description=CM }
    { 2   ;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   CaptionML=[ENU=Contact No.;
                                                              DEA=Kontaktnr.] }
    { 3   ;   ;Contact Company No. ;Code20        ;TableRelation=Contact WHERE (Type=CONST(Company));
                                                   CaptionML=[ENU=Contact Company No.;
                                                              DEA=Kontakt Unternehmensnr.] }
    { 4   ;   ;Date                ;Date          ;CaptionML=[ENU=Date;
                                                              DEA=Datum];
                                                   Description=CM }
    { 5   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung];
                                                   Description=CM }
    { 6   ;   ;Information Flow    ;Option        ;CaptionML=[ENU=Information Flow;
                                                              DEA=Informationsfluss];
                                                   OptionCaptionML=[ENU=" ,Outbound,Inbound";
                                                                    DEA=" ,Ausgehend,Eingehend"];
                                                   OptionString=[ ,Outbound,Inbound] }
    { 7   ;   ;Initiated By        ;Option        ;CaptionML=[ENU=Initiated By;
                                                              DEA=Veranlasst durch];
                                                   OptionCaptionML=[ENU=" ,Us,Them";
                                                                    DEA=" ,Uns,Kontakt"];
                                                   OptionString=[ ,Us,Them] }
    { 8   ;   ;Attachment No.      ;Integer       ;TableRelation=Attachment;
                                                   CaptionML=[ENU=Attachment No.;
                                                              DEA=Dateianhangsnr.] }
    { 9   ;   ;Cost (LCY)          ;Decimal       ;CaptionML=[ENU=Cost (LCY);
                                                              DEA=Einstandsbetrag (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 10  ;   ;Duration (Min.)     ;Decimal       ;CaptionML=[ENU=Duration (Min.);
                                                              DEA=Dauer (Min.)];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 11  ;   ;User ID             ;Code50        ;TableRelation=User."User Name";
                                                   OnLookup=VAR
                                                              UserMgt@1000 : Codeunit 418;
                                                            BEGIN
                                                              UserMgt.LookupUserID("User ID");
                                                            END;

                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=User ID;
                                                              DEA=Benutzer-ID];
                                                   Description=CM }
    { 12  ;   ;Interaction Group Code;Code10      ;TableRelation="Interaction Group";
                                                   CaptionML=[ENU=Interaction Group Code;
                                                              DEA=Aktivit„tengruppencode] }
    { 13  ;   ;Interaction Template Code;Code10   ;TableRelation="Interaction Template";
                                                   CaptionML=[ENU=Interaction Template Code;
                                                              DEA=Aktivit„tenvorlagencode] }
    { 14  ;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   CaptionML=[ENU=Campaign No.;
                                                              DEA=Kampagnennr.] }
    { 15  ;   ;Campaign Entry No.  ;Integer       ;TableRelation="Campaign Entry" WHERE (Campaign No.=FIELD(Campaign No.));
                                                   CaptionML=[ENU=Campaign Entry No.;
                                                              DEA=Kampagnenposten Lfd. Nr.] }
    { 16  ;   ;Campaign Response   ;Boolean       ;CaptionML=[ENU=Campaign Response;
                                                              DEA=Kampagnenreaktion] }
    { 17  ;   ;Campaign Target     ;Boolean       ;CaptionML=[ENU=Campaign Target;
                                                              DEA=Kampagnenziel] }
    { 18  ;   ;Segment No.         ;Code20        ;CaptionML=[ENU=Segment No.;
                                                              DEA=Segmentnr.] }
    { 19  ;   ;Evaluation          ;Option        ;CaptionML=[ENU=Evaluation;
                                                              DEA=Bewertung];
                                                   OptionCaptionML=[ENU=" ,Very Positive,Positive,Neutral,Negative,Very Negative";
                                                                    DEA=" ,Sehr positiv,Positiv,Neutral,Negativ,Sehr negativ"];
                                                   OptionString=[ ,Very Positive,Positive,Neutral,Negative,Very Negative];
                                                   Editable=No }
    { 20  ;   ;Time of Interaction ;Time          ;CaptionML=[ENU=Time of Interaction;
                                                              DEA=Uhrzeit];
                                                   Description=CM }
    { 21  ;   ;Attempt Failed      ;Boolean       ;CaptionML=[ENU=Attempt Failed;
                                                              DEA=Nicht erreicht] }
    { 23  ;   ;To-do No.           ;Code20        ;TableRelation=To-do;
                                                   CaptionML=[ENU=To-do No.;
                                                              DEA=Aufgabennr.];
                                                   Description=CM }
    { 24  ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[ENU=Salesperson Code;
                                                              DEA=Verk„ufercode] }
    { 25  ;   ;Delivery Status     ;Option        ;CaptionML=[ENU=Delivery Status;
                                                              DEA=šbermittlungsstatus];
                                                   OptionCaptionML=[ENU=" ,In Progress,Error";
                                                                    DEA=" ,In Bearbeitung,Fehler"];
                                                   OptionString=[ ,In Progress,Error] }
    { 26  ;   ;Canceled            ;Boolean       ;CaptionML=[ENU=Canceled;
                                                              DEA=Storniert];
                                                   Description=CM }
    { 27  ;   ;Correspondence Type ;Option        ;CaptionML=[ENU=Correspondence Type;
                                                              DEA=Korrespondenzart];
                                                   OptionCaptionML=[ENU=" ,Hard Copy,E-Mail,Fax";
                                                                    DEA=" ,Brief,E-Mail,Fax"];
                                                   OptionString=[ ,Hard Copy,E-Mail,Fax] }
    { 28  ;   ;Contact Alt. Address Code;Code10   ;TableRelation="Contact Alt. Address".Code WHERE (Contact No.=FIELD(Contact No.));
                                                   CaptionML=[ENU=Contact Alt. Address Code;
                                                              DEA=Alt. Kontaktadresscode] }
    { 29  ;   ;Logged Segment Entry No.;Integer   ;TableRelation="Logged Segment";
                                                   CaptionML=[ENU=Logged Segment Entry No.;
                                                              DEA=Protok. Segmentposten Lfd. Nr.] }
    { 30  ;   ;Document Type       ;Option        ;CaptionML=[ENU=Document Type;
                                                              DEA=Belegart];
                                                   OptionCaptionML=[ENU=" ,Sales Qte.,Sales Blnkt. Ord,Sales Ord. Cnfrmn.,Sales Inv.,Sales Shpt. Note,Sales Cr. Memo,Sales Stmnt.,Sales Rmdr.,Serv. Ord. Create,Serv. Ord. Post,Purch.Qte.,Purch. Blnkt. Ord.,Purch. Ord.,Purch. Inv.,Purch. Rcpt.,Purch. Cr. Memo,Cover Sheet,Sales Return Order,Sales Finance Charge Memo,Sales Return Receipt,Purch. Return Shipment,Purch. Return Ord. Cnfrmn.,Service Contract,Service Contract Quote,Service Quote";
                                                                    DEA=" ,Angebot,Rahmenauftrag,Auftragsbest.,VK-Rech.,VK-Liefersch.,VK-Gutschr.,Kontoausz.,Mahnung,Serv.-Auftr. erst.,Serv.-Auftr. buchen,Anfrage,Rahmenbestellung,Bestellung,EK-Rech.,EK-Liefersch.,EK-Gutschr.,Deckblatt,Verkaufsreklamation,Zinsrechnung,Rcksendung,Rcklieferung,Eink.-Reklamationsbest„tigung,Servicevertrag,Servicevertragsangebot,Serviceangebot"];
                                                   OptionString=[ ,Sales Qte.,Sales Blnkt. Ord,Sales Ord. Cnfrmn.,Sales Inv.,Sales Shpt. Note,Sales Cr. Memo,Sales Stmnt.,Sales Rmdr.,Serv. Ord. Create,Serv. Ord. Post,Purch.Qte.,Purch. Blnkt. Ord.,Purch. Ord.,Purch. Inv.,Purch. Rcpt.,Purch. Cr. Memo,Cover Sheet,Sales Return Order,Sales Finance Charge Memo,Sales Return Receipt,Purch. Return Shipment,Purch. Return Ord. Cnfrmn.,Service Contract,Service Contract Quote,Service Quote] }
    { 31  ;   ;Document No.        ;Code20        ;TestTableRelation=No;
                                                   CaptionML=[ENU=Document No.;
                                                              DEA=Belegnr.] }
    { 32  ;   ;Version No.         ;Integer       ;CaptionML=[ENU=Version No.;
                                                              DEA=Versionsnr.] }
    { 33  ;   ;Doc. No. Occurrence ;Integer       ;CaptionML=[ENU=Doc. No. Occurrence;
                                                              DEA=Belegnr.-H„ufigkeit] }
    { 34  ;   ;Contact Via         ;Text80        ;CaptionML=[ENU=Contact Via;
                                                              DEA=Nummer/Adresse] }
    { 35  ;   ;Send Word Docs. as Attmt.;Boolean  ;CaptionML=[ENU=Send Word Docs. as Attmt.;
                                                              DEA=Word-Dokumente als Anh. senden] }
    { 36  ;   ;Interaction Language Code;Code10   ;TableRelation=Language;
                                                   CaptionML=[ENU=Interaction Language Code;
                                                              DEA=Aktivit„tensprachcode] }
    { 37  ;   ;E-Mail Logged       ;Boolean       ;CaptionML=[ENU=E-Mail Logged;
                                                              DEA=E-Mail protokolliert] }
    { 38  ;   ;Subject             ;Text50        ;CaptionML=[ENU=Subject;
                                                              DEA=Betreff] }
    { 39  ;   ;Contact Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact No.)));
                                                   CaptionML=[ENU=Contact Name;
                                                              DEA=Kontaktname];
                                                   Editable=No }
    { 40  ;   ;Contact Company Name;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact Company No.),
                                                                                          Type=CONST(Company)));
                                                   CaptionML=[ENU=Contact Company Name;
                                                              DEA=Kontakt Unternehmensname];
                                                   Editable=No }
    { 43  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Inter. Log Entry Comment Line" WHERE (Entry No.=FIELD(Entry No.)));
                                                   CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung];
                                                   Editable=No }
    { 44  ;   ;Opportunity No.     ;Code20        ;TableRelation=Opportunity;
                                                   CaptionML=[ENU=Opportunity No.;
                                                              DEA=Verkaufschancennr.];
                                                   Description=CM }
    { 45  ;   ;Postponed           ;Boolean       ;CaptionML=[ENU=Postponed;
                                                              DEA=Zurckgestellt] }
    { 50000;  ;CM Is CMMS Log Entry;Boolean       ;CaptionML=[ENU=Ist CMMS Log Entry;
                                                              DEA=Ist CMMS Log Eintrag] }
    { 50100;  ;CM Source           ;Option        ;CaptionML=[ENU=Source;
                                                              DEA=Herkunft];
                                                   OptionCaptionML=[ENU=Asset/Project,Workorder,Task,Contract,Checklist;
                                                                    DEA=Anlage/Projekt,Arbeitsauftrag,Aufgabe,Vertrag,Checkliste];
                                                   OptionString=Asset/Project,Workorder,Task,Contract,Checklist }
    { 50110;  ;CM Source No.       ;Code20        ;CaptionML=[ENU=Source No.;
                                                              DEA=Herkunftsnr.] }
    { 50200;  ;CM Log Type         ;Option        ;CaptionML=[ENU=Log Type;
                                                              DEA=Log Typ];
                                                   OptionString=Read,Created,Modified,Deleted,Comment,Status Change,Picture,Attachment,Assigned User Changed,Contract Assigned,Contract Detached }
    { 51190;  ;CM Objecttype       ;Option        ;CaptionML=[ENU=Objecttype;
                                                              DEA=Objecttyp];
                                                   OptionString=Asset,Project }
    { 51200;  ;CM Object No.       ;Code20        ;CaptionML=[ENU=Asset No.;
                                                              DEA=Anlage Nr.] }
    { 51300;  ;CM Comment          ;Text250       ;CaptionML=[ENU=Comment;
                                                              DEA=Kommentar] }
    { 51400;  ;CM Internal         ;Boolean       ;CaptionML=[ENU=Internal;
                                                              DEA=Intern] }
    { 51420;  ;CM Issue            ;Option        ;CaptionML=[ENU=Issue;
                                                              DEA=Grund];
                                                   OptionString=[ ,Maintenance,Fault rectification,Communication Issue,Temporary Issue,Inform] }
    { 51430;  ;CM Production Effect;Option        ;CaptionML=[ENU=Production Effect;
                                                              DEA=Auswirkung auf Produktion];
                                                   OptionString=[ ,No impact,Minor impact,Production impact] }
    { 51500;  ;CM Created Datetime ;DateTime      ;CaptionML=[ENU=Datetime;
                                                              DEA=Datum Uhrzeit] }
    { 52000;  ;CM Status Change Standard Text;Option;
                                                   CaptionML=ENU=Status Change Standard Text;
                                                   OptionString=[ ,False alarm,Alarm condition disappeared,Technician has been informed,Work started,Technician is on site,Technician is on the way,Operational work has been finished,Work Order needs to be invoiced,Plant back in production,Alarm solved,Communication issue,Internet connection problem,On-Site Check has been scheduled] }
    { 52010;  ;CM Deleted          ;Boolean       ;CaptionML=[ENU=Deleted;
                                                              DEA=Gel”scht] }
    { 52020;  ;CM Deleted By User ID;Code50       ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=Deleted by User ID;
                                                              DEA=Gel”scht von User ID] }
    { 52030;  ;CM Deleted Date     ;Date          ;CaptionML=[ENU=Deleted Date;
                                                              DEA=Gel”scht Datum] }
    { 52031;  ;CM Deleted Time     ;Time          ;CaptionML=[ENU=Deleted Time;
                                                              DEA=Gel”scht Uhrzeit] }
    { 52040;  ;CM Comment Copied f. Entry No.;Integer;
                                                   TableRelation="Interaction Log Entry"."Entry No.";
                                                   CaptionML=[ENU=Comment Copied f. Entry No.;
                                                              DEA=Kommentar kopiert v. Eintrag Nr.] }
    { 53000;  ;CM No Data          ;Boolean        }
    { 53010;  ;CM Identifier       ;Text64         }
    { 53020;  ;CM Health And Safety Document;Boolean;
                                                   CaptionML=[ENU=Health And Safety Document;
                                                              DEA=Health And Safety Document] }
    { 54000;  ;CM Related Entry No.;Integer       ;TableRelation="Interaction Log Entry"."Entry No.";
                                                   CaptionML=[ENU=Related Entry No.;
                                                              DEA=Verbundene Lfd. Nr.] }
    { 55000;  ;CM User Name        ;Text80        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(User ID)));
                                                   CaptionML=[ENU=User Name;
                                                              DEA=Benutzername];
                                                   Description=FF;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Contact Company No.,Contact No.,Date,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Contact Company No.,Date,Contact No.,Canceled,Initiated By,Attempt Failed,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.);
                                                   MaintainSIFTIndex=No }
    {    ;Interaction Group Code,Date              }
    {    ;Interaction Group Code,Canceled,Date,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Interaction Template Code,Date           }
    {    ;Interaction Template Code,Canceled,Date,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Canceled,Campaign No.,Campaign Entry No.,Date,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Campaign No.,Campaign Entry No.,Date,Postponed;
                                                   SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Salesperson Code,Date,Postponed         ;SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Canceled,Salesperson Code,Date,Postponed;SumIndexFields=Cost (LCY),Duration (Min.) }
    {    ;Logged Segment Entry No.,Postponed       }
    {    ;Attachment No.                           }
    {    ;To-do No.,Date                           }
    {    ;Contact No.,Correspondence Type,E-Mail Logged,Subject,Postponed }
    {    ;Campaign No.,Campaign Target             }
    {    ;Campaign No.,Contact Company No.,Campaign Target,Postponed }
    {    ;Opportunity No.,Date                     }
    {    ;CM Is CMMS Log Entry,CM Source,CM Source No. }
    {    ;CM Is CMMS Log Entry,CM Source,CM Source No.,CM Log Type }
    {    ;CM Is CMMS Log Entry,CM Objecttype,CM Object No. }
    {    ;CM Is CMMS Log Entry,Opportunity No.     }
    {    ;CM Is CMMS Log Entry,To-do No.           }
    {    ;CM Is CMMS Log Entry,CM No Data,CM Log Type,CM Identifier }
    {    ;CM Is CMMS Log Entry,Opportunity No.,CM Log Type,CM Deleted,CM Internal,CM Created Datetime,CM Source }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Entry No.,Description,Contact No.,Date   }
    { 2   ;Brick               ;CM Created Datetime,Description,CM Log Type,CM Comment,CM Source,User ID }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=%1 %2 is marked %3.\;DEA=%1 %2 ist als %3 gekennzeichnet.\';
      Text001@1001 : TextConst 'ENU=Do you wish to remove the checkmark?;DEA=M”chten Sie das Kennzeichen Storniert entfernen?';
      Text002@1002 : TextConst 'ENU=Do you wish to mark %1 %2 as %3?;DEA=M”chten Sie den %1 %2 als %3 kennzeichnen?';
      Text003@1003 : TextConst 'ENU=It is not possible to view sales statements after they have been printed.;DEA=Es ist nicht m”glich Kontoauszge einzusehen, nachdem sie gedruckt wurden.';
      Text004@1004 : TextConst 'ENU=It is not possible to show cover sheets after they have been printed.;DEA=Es ist nicht m”glich Deckbl„tter einzusehen, nachdem sie gedruckt wurden.';
      Text005@1005 : TextConst 'ENU=Do you wish to remove the checkmark from the selected %1 lines?;DEA=M”chten Sie die Markierung von den gew„hlten %1 entfernen?';
      Text006@1006 : TextConst 'ENU=Do you wish to mark the selected %1 lines as %2?;DEA=M”chten Sie die ausgew„hlten %1 als %2 kennzeichnen?';
      Text009@1007 : TextConst 'ENU=Do you want to remove Attachment?;DEA=M”chten Sie den Anhang entfernen?';
      Text010@1008 : TextConst 'ENU=Do you want to remove unique Attachments for the selected lines?;DEA=M”chten Sie die eindeutigen Anh„nge fr die gew„hlten Zeilen entfernen?';
      Text011@1009 : TextConst 'ENU=Very Positive,Positive,Neutral,Negative,Very Negative;DEA=Sehr positiv,Positiv,Neutral,Negativ,Sehr negativ';

    PROCEDURE CreateInteraction@10();
    VAR
      SegLine@1000 : TEMPORARY Record 5077;
    BEGIN
      SegLine.CreateInteractionFromIntLogEnt(Rec);
    END;

    PROCEDURE CreateTodo@8();
    VAR
      TempTodo@1000 : TEMPORARY Record 5080;
    BEGIN
      TempTodo.CreateToDoFromInteractLogEntry(Rec)
    END;

    PROCEDURE OpenAttachment@5();
    VAR
      Attachment@1000 : Record 5062;
      SegLine@1001 : Record 5077;
    BEGIN
      IF "Attachment No." = 0 THEN
        EXIT;
      Attachment.GET("Attachment No.");

      IF Attachment."Storage Type" <> Attachment."Storage Type"::"Exchange Storage" THEN BEGIN
        SegLine."Contact No." := "Contact No.";
        SegLine."Salesperson Code" := "Salesperson Code";
        SegLine."Contact Alt. Address Code" := "Contact Alt. Address Code";
        SegLine.Date := Date;
        SegLine."Campaign No." := "Campaign No.";
        SegLine."Segment No." := "Segment No.";
        SegLine."Line No." := "Entry No.";
        SegLine.Description := Description;
        SegLine.Subject := Subject;
        SegLine."Language Code" := "Interaction Language Code";
        Attachment.ShowAttachment(SegLine,FORMAT("Entry No.") + ' ' + Description,FALSE);
      END ELSE
        Attachment.DisplayInOutlook;
    END;

    PROCEDURE ToggleCanceledCheckmark@7();
    VAR
      ErrorTxt@1004 : Text[80];
      MasterCanceledCheckmark@1001 : Boolean;
      RemoveUniqueAttachment@1000 : Boolean;
    BEGIN
      IF FIND('-') THEN BEGIN
        IF ConfirmToggleCanceledCheckmark(COUNT,ErrorTxt) THEN BEGIN
          MasterCanceledCheckmark := NOT Canceled;
          IF FindUniqueAttachment AND MasterCanceledCheckmark THEN
            RemoveUniqueAttachment := CONFIRM(ErrorTxt,FALSE);
          SETCURRENTKEY("Entry No.");
          IF FIND('-') THEN
            REPEAT
              SetCanceledCheckmark(MasterCanceledCheckmark,RemoveUniqueAttachment);
            UNTIL NEXT = 0
        END;
      END
    END;

    PROCEDURE SetCanceledCheckmark@2(CanceledCheckmark@1003 : Boolean;RemoveUniqueAttachment@1004 : Boolean);
    VAR
      CampaignEntry@1000 : Record 5072;
      LoggedSeg@1001 : Record 5075;
      Attachment@1002 : Record 5062;
    BEGIN
      IF Canceled AND NOT CanceledCheckmark THEN BEGIN
        IF "Logged Segment Entry No." <> 0 THEN BEGIN
          LoggedSeg.GET("Logged Segment Entry No.");
          LoggedSeg.TESTFIELD(Canceled,FALSE);
        END;
        IF "Campaign Entry No." <> 0 THEN BEGIN
          CampaignEntry.GET("Campaign Entry No.");
          CampaignEntry.TESTFIELD(Canceled,FALSE);
        END;
      END;

      IF NOT Canceled AND CanceledCheckmark THEN
        IF UniqueAttachment AND RemoveUniqueAttachment THEN BEGIN
          Attachment.GET("Attachment No.");
          IF Attachment.RemoveAttachment(FALSE) THEN
            "Attachment No." := 0;
        END;

      Canceled := CanceledCheckmark;
      MODIFY;
    END;

    LOCAL PROCEDURE ConfirmToggleCanceledCheckmark@3(NumberOfSelectedLines@1000 : Integer;VAR ErrorTxt@1001 : Text[80]) : Boolean;
    BEGIN
      IF NumberOfSelectedLines = 1 THEN BEGIN
        ErrorTxt := Text009;
        IF Canceled THEN
          EXIT(CONFIRM(
              Text000 +
              Text001,TRUE,TABLECAPTION,"Entry No.",FIELDCAPTION(Canceled)));

        EXIT(CONFIRM(
            Text002,TRUE,TABLECAPTION,"Entry No.",FIELDCAPTION(Canceled)));
      END;
      ErrorTxt := Text010;
      IF Canceled THEN
        EXIT(CONFIRM(
            Text005,TRUE,TABLECAPTION));

      EXIT(CONFIRM(
          Text006,TRUE,TABLECAPTION,FIELDCAPTION(Canceled)));
    END;

    PROCEDURE UniqueAttachment@4() IsUnique@1000 : Boolean;
    VAR
      InteractLogEntry@1001 : Record 5065;
    BEGIN
      IF "Attachment No." <> 0 THEN BEGIN
        InteractLogEntry.SETCURRENTKEY("Attachment No.");
        InteractLogEntry.SETRANGE("Attachment No.","Attachment No.");
        InteractLogEntry.SETFILTER("Entry No.",'<>%1',"Entry No.");
        IsUnique := NOT InteractLogEntry.FINDFIRST;
      END;
    END;

    LOCAL PROCEDURE FindUniqueAttachment@6() IsUnique@1000 : Boolean;
    BEGIN
      IF FIND('-') THEN
        REPEAT
          IsUnique := UniqueAttachment;
        UNTIL (NEXT = 0) OR IsUnique
    END;

    PROCEDURE ShowDocument@1();
    VAR
      SalesHeader@1000 : Record 36;
      SalesHeaderArchive@1011 : Record 5107;
      SalesInvHeader@1001 : Record 112;
      SalesShptHeader@1002 : Record 110;
      SalesCrMemoHeader@1003 : Record 114;
      IssuedReminderHeader@1004 : Record 297;
      PurchHeader@1005 : Record 38;
      PurchHeaderArchive@1012 : Record 5109;
      PurchInvHeader@1006 : Record 122;
      PurchRcptHeader@1007 : Record 120;
      PurchCrMemoHeader@1008 : Record 124;
      ServHeader@1009 : Record 5900;
      ReturnRcptHeader@1013 : Record 6660;
      IssuedFinChargeMemoHeader@1015 : Record 304;
      ReturnReceiptHeader@1014 : Record 6660;
      ReturnShipmentHeader@1016 : Record 6650;
      ServiceContractHeader@1017 : Record 5965;
    BEGIN
      CASE "Document Type" OF
        "Document Type"::"Sales Qte.":
          IF "Version No." <> 0 THEN BEGIN
            SalesHeaderArchive.GET(
              SalesHeaderArchive."Document Type"::Quote,"Document No.",
              "Doc. No. Occurrence","Version No.");
            SalesHeaderArchive.SETRANGE("Document Type",SalesHeaderArchive."Document Type"::Quote);
            SalesHeaderArchive.SETRANGE("No.","Document No.");
            SalesHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
            PAGE.RUN(PAGE::"Sales Quote Archive",SalesHeaderArchive);
          END ELSE BEGIN
            SalesHeader.GET(SalesHeader."Document Type"::Quote,"Document No.");
            PAGE.RUN(PAGE::"Sales Quote",SalesHeader);
          END;
        "Document Type"::"Sales Blnkt. Ord":
          BEGIN
            IF "Version No." <> 0 THEN BEGIN
              SalesHeaderArchive.GET(SalesHeaderArchive."Document Type"::"Blanket Order","Document No.",
                "Doc. No. Occurrence","Version No.");
              SalesHeaderArchive.SETRANGE("Document Type",SalesHeaderArchive."Document Type"::"Blanket Order");
              SalesHeaderArchive.SETRANGE("No.","Document No.");
              SalesHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
              PAGE.RUN(PAGE::"Blanket Sales Order Archive",SalesHeaderArchive);
            END ELSE BEGIN
              SalesHeader.GET(SalesHeader."Document Type"::"Blanket Order","Document No.");
              PAGE.RUN(PAGE::"Blanket Sales Order",SalesHeader);
            END;
          END;
        "Document Type"::"Sales Ord. Cnfrmn.":
          IF "Version No." <> 0 THEN BEGIN
            SalesHeaderArchive.GET(
              SalesHeaderArchive."Document Type"::Order,"Document No.",
              "Doc. No. Occurrence","Version No.");
            SalesHeaderArchive.SETRANGE("Document Type",SalesHeaderArchive."Document Type"::Order);
            SalesHeaderArchive.SETRANGE("No.","Document No.");
            SalesHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
            PAGE.RUN(PAGE::"Sales Order Archive",SalesHeaderArchive);
          END ELSE BEGIN
            SalesHeader.GET(SalesHeader."Document Type"::Order,"Document No.");
            PAGE.RUN(PAGE::"Sales Order",SalesHeader);
          END;
        "Document Type"::"Sales Inv.":
          BEGIN
            SalesInvHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Sales Invoice",SalesInvHeader);
          END;
        "Document Type"::"Sales Shpt. Note":
          BEGIN
            SalesShptHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Sales Shipment",SalesShptHeader);
          END;
        "Document Type"::"Sales Cr. Memo":
          BEGIN
            SalesCrMemoHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Sales Credit Memo",SalesCrMemoHeader);
          END;
        "Document Type"::"Sales Stmnt.":
          ERROR(Text003);
        "Document Type"::"Sales Rmdr.":
          BEGIN
            IssuedReminderHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Issued Reminder",IssuedReminderHeader);
          END;
        "Document Type"::"Serv. Ord. Create":
          BEGIN
            ServHeader.GET(ServHeader."Document Type"::Order,"Document No.");
            PAGE.RUN(PAGE::"Service Order",ServHeader)
          END;
        "Document Type"::"Purch.Qte.":
          IF "Version No." <> 0 THEN BEGIN
            PurchHeaderArchive.GET(
              PurchHeaderArchive."Document Type"::Quote,"Document No.",
              "Doc. No. Occurrence","Version No.");
            PurchHeaderArchive.SETRANGE("Document Type",PurchHeaderArchive."Document Type"::Quote);
            PurchHeaderArchive.SETRANGE("No.","Document No.");
            PurchHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
            PAGE.RUN(PAGE::"Purchase Quote Archive",PurchHeaderArchive);
          END ELSE BEGIN
            PurchHeader.GET(PurchHeader."Document Type"::Quote,"Document No.");
            PAGE.RUN(PAGE::"Purchase Quote",PurchHeader);
          END;
        "Document Type"::"Purch. Blnkt. Ord.":
          BEGIN
            IF "Version No." <> 0 THEN BEGIN
              PurchHeaderArchive.GET(
                PurchHeaderArchive."Document Type"::"Blanket Order","Document No.",
                "Doc. No. Occurrence","Version No.");
              PurchHeaderArchive.SETRANGE("Document Type",PurchHeaderArchive."Document Type"::"Blanket Order");
              PurchHeaderArchive.SETRANGE("No.","Document No.");
              PurchHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
              PAGE.RUN(PAGE::"Blanket Purchase Order Archive",PurchHeaderArchive);
            END ELSE BEGIN
              PurchHeader.GET(PurchHeader."Document Type"::"Blanket Order","Document No.");
              PAGE.RUN(PAGE::"Blanket Purchase Order",PurchHeader);
            END;
          END;
        "Document Type"::"Purch. Ord.":
          IF "Version No." <> 0 THEN BEGIN
            PurchHeaderArchive.GET(
              PurchHeaderArchive."Document Type"::Order,"Document No.",
              "Doc. No. Occurrence","Version No.");
            PurchHeaderArchive.SETRANGE("Document Type",PurchHeaderArchive."Document Type"::Order);
            PurchHeaderArchive.SETRANGE("No.","Document No.");
            PurchHeaderArchive.SETRANGE("Doc. No. Occurrence","Doc. No. Occurrence");
            PAGE.RUN(PAGE::"Purchase Order Archive",PurchHeaderArchive);
          END ELSE BEGIN
            PurchHeader.GET(PurchHeader."Document Type"::Order,"Document No.");
            PAGE.RUN(PAGE::"Purchase Order",PurchHeader);
          END;
        "Document Type"::"Purch. Inv.":
          BEGIN
            PurchInvHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Purchase Invoice",PurchInvHeader);
          END;
        "Document Type"::"Purch. Rcpt.":
          BEGIN
            PurchRcptHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Purchase Receipt",PurchRcptHeader);
          END;
        "Document Type"::"Purch. Cr. Memo":
          BEGIN
            PurchCrMemoHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Purchase Credit Memo",PurchCrMemoHeader);
          END;
        "Document Type"::"Cover Sheet":
          ERROR(Text004);
        "Document Type"::"Sales Return Order":
          IF SalesHeader.GET(SalesHeader."Document Type"::"Return Order","Document No.") THEN
            PAGE.RUN(PAGE::"Sales Return Order",SalesHeader)
          ELSE BEGIN
            ReturnRcptHeader.SETRANGE("Return Order No.","Document No.");
            PAGE.RUN(PAGE::"Posted Return Receipt",ReturnRcptHeader);
          END;
        "Document Type"::"Sales Finance Charge Memo":
          BEGIN
            IssuedFinChargeMemoHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Issued Finance Charge Memo",IssuedFinChargeMemoHeader);
          END;
        "Document Type"::"Sales Return Receipt":
          BEGIN
            ReturnReceiptHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Return Receipt",ReturnReceiptHeader);
          END;
        "Document Type"::"Purch. Return Shipment":
          BEGIN
            ReturnShipmentHeader.GET("Document No.");
            PAGE.RUN(PAGE::"Posted Return Shipment",ReturnShipmentHeader);
          END;
        "Document Type"::"Purch. Return Ord. Cnfrmn.":
          IF PurchHeader.GET(PurchHeader."Document Type"::"Return Order","Document No.") THEN
            PAGE.RUN(PAGE::"Purchase Return Order",PurchHeader)
          ELSE BEGIN
            ReturnShipmentHeader.SETRANGE("Return Order No.","Document No.");
            PAGE.RUN(PAGE::"Posted Return Shipment",ReturnShipmentHeader);
          END;
        "Document Type"::"Service Contract":
          BEGIN
            ServiceContractHeader.GET(ServiceContractHeader."Contract Type"::Contract,"Document No.");
            PAGE.RUN(PAGE::"Service Contract",ServiceContractHeader);
          END;
        "Document Type"::"Service Contract Quote":
          BEGIN
            ServiceContractHeader.GET(ServiceContractHeader."Contract Type"::Quote,"Document No.");
            PAGE.RUN(PAGE::"Service Contract Quote",ServiceContractHeader);
          END;
        "Document Type"::"Service Quote":
          BEGIN
            ServHeader.GET(ServHeader."Document Type"::Quote,"Document No.");
            PAGE.RUN(PAGE::"Service Quote",ServHeader);
          END;
      END;
    END;

    PROCEDURE EvaluateInteraction@9();
    VAR
      Selected@1000 : Integer;
    BEGIN
      IF FIND('-') THEN BEGIN
        Selected := DIALOG.STRMENU(Text011);
        IF Selected <> 0 THEN
          REPEAT
            Evaluation := Selected;
            MODIFY;
          UNTIL NEXT = 0
      END;
    END;

    PROCEDURE ResumeInteraction@11();
    VAR
      SegLine@1000 : TEMPORARY Record 5077;
      Cont@1006 : Record 5050;
      Salesperson@1005 : Record 13;
      Campaign@1004 : Record 5071;
      Todo@1003 : Record 5080;
      Opportunity@1002 : Record 5092;
      SegManagement@1001 : Codeunit 5051;
    BEGIN
      SegLine.DELETEALL;
      SegLine.INIT;
      SegManagement.CopyFieldsFromInteractLogEntry(SegLine,Rec);
      SegLine.VALIDATE(Date,WORKDATE);

      IF Todo.GET(GETFILTER("To-do No.")) THEN
        SegLine.SETRANGE("To-do No.",Todo."No.");
      IF Cont.GET(GETFILTER("Contact Company No.")) THEN
        SegLine.SETRANGE("Contact Company No.",Cont."No.");
      IF Cont.GET(GETFILTER("Contact No.")) THEN
        SegLine.SETRANGE("Contact No.",Cont."No.");
      IF Salesperson.GET(GETFILTER("Salesperson Code")) THEN
        SegLine.SETRANGE("Salesperson Code",Salesperson.Code);
      IF Campaign.GET(GETFILTER("Campaign No.")) THEN
        SegLine.SETRANGE("Campaign No.",Campaign."No.");
      IF Opportunity.GET(GETFILTER("Opportunity No.")) THEN
        SegLine.SETRANGE("Opportunity No.",Opportunity."No.");

      SegLine.StartWizard;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 5080 To-do
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=17:40:14;
    Modified=Yes;
    Version List=NAVW19.00,CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Description;
    OnInsert=BEGIN
               CMTaskMgt.OnInsert(Rec); //CM

               IF "No." = '' THEN BEGIN
                 RMSetup.GET;
                 RMSetup.TESTFIELD("To-do Nos.");
                 NoSeriesMgt.InitSeries(RMSetup."To-do Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
               IF (("System To-do Type" = "System To-do Type"::Organizer) AND
                   ("Team Code" = '')) OR
                  ("System To-do Type" = "System To-do Type"::Team)
               THEN
                 "Organizer To-do No." := "No.";
               "Last Date Modified" := TODAY;
               "Last Time Modified" := TIME;
             END;

    OnModify=BEGIN
               CMTaskMgt.OnModify(Rec,xRec); //CM

               IF "No." <> '' THEN BEGIN
                 "Last Date Modified" := TODAY;
                 "Last Time Modified" := TIME;

                 UpdateAttendeeTodos("No.");
               END;
             END;

    OnDelete=VAR
               Attendee@1001 : Record 5199;
               Todo@1000 : Record 5080;
               TodoInteractionLanguage@1002 : Record 5196;
             BEGIN
               CMTaskMgt.OnDelete(Rec); //CM

               RMCommentLine.SETRANGE("Table Name",RMCommentLine."Table Name"::"To-do");
               RMCommentLine.SETRANGE("No.","No.");
               RMCommentLine.DELETEALL;
               Todo.SETRANGE("Organizer To-do No.","No.");
               Todo.SETFILTER("No.",'<>%1',"No.");
               IF Todo.FINDFIRST THEN
                 Todo.DELETEALL;

               Attendee.SETRANGE("To-do No.","No.");
               Attendee.DELETEALL;

               TodoInteractionLanguage.SETRANGE("To-do No.","No.");
               TodoInteractionLanguage.DELETEALL(TRUE);
             END;

    CaptionML=[ENU=To-do;
               DEA=Aufgabe];
    LookupPageID=Page5096;
    DrillDownPageID=Page5096;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  RMSetup.GET;
                                                                  NoSeriesMgt.TestManual(RMSetup."To-do Nos.");
                                                                  "No. Series" := '';
                                                                  IF ("System To-do Type" = "System To-do Type"::Organizer) OR
                                                                     ("System To-do Type" = "System To-do Type"::Team)
                                                                  THEN
                                                                    UpdateAttendeeTodos(xRec."No.");
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              DEA=Nr.];
                                                   Description=CM }
    { 2   ;   ;Team Code           ;Code10        ;TableRelation=Team;
                                                   OnValidate=BEGIN
                                                                IF ("Team Code" <> xRec."Team Code") AND
                                                                   ("No." <> '') AND
                                                                   IsCalledFromForm
                                                                THEN BEGIN
                                                                  IF ("Team Code" = '') AND ("Salesperson Code" = '') THEN
                                                                    ERROR(Text035,FIELDCAPTION("Salesperson Code"),FIELDCAPTION("Team Code"));
                                                                  IF xRec."Team Code" <> '' THEN BEGIN
                                                                    IF Closed THEN BEGIN
                                                                      IF CONFIRM(STRSUBSTNO(Text039,"No.",xRec."Team Code","Team Code")) THEN BEGIN
                                                                        ChangeTeam;
                                                                        GET("No.");
                                                                        VALIDATE(Closed,FALSE);
                                                                      END ELSE
                                                                        "Team Code" := xRec."Team Code"
                                                                    END ELSE BEGIN
                                                                      IF CONFIRM(STRSUBSTNO(Text030,xRec."Team Code","Team Code")) THEN
                                                                        ChangeTeam
                                                                      ELSE
                                                                        "Team Code" := xRec."Team Code"
                                                                    END
                                                                  END ELSE BEGIN
                                                                    IF Closed THEN BEGIN
                                                                      IF CONFIRM(STRSUBSTNO(Text042,"No.","Team Code")) THEN BEGIN
                                                                        ReassignSalespersonTodoToTeam;
                                                                        GET("No.");
                                                                        VALIDATE(Closed,FALSE);
                                                                      END ELSE
                                                                        "Team Code" := ''
                                                                    END ELSE
                                                                      ReassignSalespersonTodoToTeam;
                                                                  END
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Team Code;
                                                              DEA=Teamcode] }
    { 3   ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=BEGIN
                                                                IF (xRec."Salesperson Code" <> "Salesperson Code") AND
                                                                   ("No." <> '') AND
                                                                   IsCalledFromForm
                                                                THEN BEGIN
                                                                  IF ("Team Code" = '') AND ("Salesperson Code" = '') THEN
                                                                    ERROR(Text035,FIELDCAPTION("Salesperson Code"),FIELDCAPTION("Team Code"));
                                                                  IF (Type = Type::Meeting) AND ("Team Code" = '') THEN
                                                                    ERROR(Text009,FIELDCAPTION("Salesperson Code"));

                                                                  IF "Team Code" <> '' THEN BEGIN
                                                                    IF Type = Type::Meeting THEN
                                                                      IF Closed THEN
                                                                        IF CONFIRM(STRSUBSTNO(Text040,"No.","Salesperson Code")) THEN BEGIN
                                                                          ReassignTeamTodoToSalesperson;
                                                                          GET("No.");
                                                                          VALIDATE(Closed,FALSE);
                                                                        END ELSE
                                                                          "Salesperson Code" := xRec."Salesperson Code"
                                                                      ELSE
                                                                        IF CONFIRM(STRSUBSTNO(Text033,"No.","Salesperson Code")) THEN
                                                                          ReassignTeamTodoToSalesperson
                                                                        ELSE
                                                                          "Salesperson Code" := xRec."Salesperson Code"
                                                                    ELSE
                                                                      IF Closed THEN
                                                                        IF CONFIRM(STRSUBSTNO(Text041,"No.","Salesperson Code")) THEN BEGIN
                                                                          ReassignTeamTodoToSalesperson;
                                                                          GET("No.");
                                                                          VALIDATE(Closed,FALSE);
                                                                        END ELSE
                                                                          "Salesperson Code" := xRec."Salesperson Code"
                                                                      ELSE
                                                                        IF CONFIRM(STRSUBSTNO(Text032,"No.","Salesperson Code")) THEN
                                                                          ReassignTeamTodoToSalesperson
                                                                        ELSE
                                                                          "Salesperson Code" := xRec."Salesperson Code"
                                                                  END
                                                                END
                                                              END;

                                                   CaptionML=[ENU=Salesperson Code;
                                                              DEA=Verk„ufercode] }
    { 4   ;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   CaptionML=[ENU=Campaign No.;
                                                              DEA=Kampagnennr.] }
    { 5   ;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                AttendeeTemp@1000 : TEMPORARY Record 5199;
                                                              BEGIN
                                                                IF Cont.GET("Contact No.") THEN
                                                                  "Contact Company No." := Cont."Company No."
                                                                ELSE
                                                                  CLEAR("Contact Company No.");

                                                                IF ("No." <> '') AND
                                                                   ("No." = "Organizer To-do No.") AND
                                                                   ("Contact No." <> xRec."Contact No.") AND
                                                                   (Type <> Type::Meeting)
                                                                THEN
                                                                  CASE TRUE OF
                                                                    (xRec."Contact No." = '') AND ("Contact No." <> ''):
                                                                      BEGIN
                                                                        AttendeeTemp.CreateAttendee(
                                                                          AttendeeTemp,
                                                                          "No.",10000,AttendeeTemp."Attendance Type"::Required,
                                                                          AttendeeTemp."Attendee Type"::Contact,
                                                                          "Contact No.",FALSE);
                                                                        CreateSubTodo(AttendeeTemp,Rec);
                                                                      END;
                                                                    (xRec."Contact No." <> '') AND ("Contact No." = ''):
                                                                      BEGIN
                                                                        AttendeeTemp.CreateAttendee(
                                                                          AttendeeTemp,
                                                                          "No.",10000,AttendeeTemp."Attendance Type"::Required,
                                                                          AttendeeTemp."Attendee Type"::Contact,
                                                                          xRec."Contact No.",FALSE);
                                                                        DeleteAttendeeTodo(AttendeeTemp);
                                                                      END;
                                                                    xRec."Contact No." <> "Contact No.":
                                                                      BEGIN
                                                                        AttendeeTemp.CreateAttendee(
                                                                          AttendeeTemp,
                                                                          "No.",10000,AttendeeTemp."Attendance Type"::Required,
                                                                          AttendeeTemp."Attendee Type"::Contact,
                                                                          xRec."Contact No.",FALSE);
                                                                        DeleteAttendeeTodo(AttendeeTemp);
                                                                        AttendeeTemp.CreateAttendee(
                                                                          AttendeeTemp,
                                                                          "No.",20000,AttendeeTemp."Attendance Type"::Required,
                                                                          AttendeeTemp."Attendee Type"::Contact,
                                                                          "Contact No.",FALSE);
                                                                        CreateSubTodo(AttendeeTemp,Rec);
                                                                      END;
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Contact No.;
                                                              DEA=Kontaktnr.] }
    { 6   ;   ;Opportunity No.     ;Code20        ;TableRelation=Opportunity;
                                                   OnValidate=VAR
                                                                OppEntry@1001 : Record 5093;
                                                              BEGIN
                                                                OppEntry.RESET;
                                                                OppEntry.SETCURRENTKEY(Active,"Opportunity No.");
                                                                OppEntry.SETRANGE(Active,TRUE);
                                                                OppEntry.SETRANGE("Opportunity No.","Opportunity No.");
                                                                IF OppEntry.FINDFIRST THEN
                                                                  "Opportunity Entry No." := OppEntry."Entry No."
                                                                ELSE
                                                                  "Opportunity Entry No." := 0;
                                                              END;

                                                   CaptionML=[ENU=Opportunity No.;
                                                              DEA=Verkaufschancennr.] }
    { 7   ;   ;Segment No.         ;Code20        ;TableRelation="Segment Header";
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Segment No.;
                                                              DEA=Segmentnr.] }
    { 8   ;   ;Type                ;Option        ;OnValidate=VAR
                                                                OldEndDate@1000 : Date;
                                                              BEGIN
                                                                IF "No." <> '' THEN BEGIN
                                                                  IF ((xRec.Type = Type::Meeting) AND (Type <> Type::Meeting)) OR
                                                                     ((xRec.Type <> Type::Meeting) AND (Type = Type::Meeting))
                                                                  THEN
                                                                    ERROR(Text012);
                                                                END ELSE BEGIN
                                                                  IF CurrFieldNo = 0 THEN
                                                                    EXIT;

                                                                  IF xRec.Type <> Type::Meeting THEN
                                                                    TempEndDateTime := CREATEDATETIME(xRec.Date,xRec."Start Time") - OneDayDuration + xRec.Duration
                                                                  ELSE
                                                                    TempEndDateTime := CREATEDATETIME(xRec.Date,xRec."Start Time") + xRec.Duration;

                                                                  OldEndDate := DT2DATE(TempEndDateTime);

                                                                  IF (xRec.Type = Type::Meeting) AND (Type <> Type::Meeting) THEN BEGIN
                                                                    "Start Time" := 0T;
                                                                    "All Day Event" := FALSE;
                                                                    SetDuration(OldEndDate,0T);
                                                                  END;

                                                                  IF (xRec.Type <> Type::Meeting) AND (Type = Type::Meeting) THEN BEGIN
                                                                    "Start Time" := 0T;
                                                                    IF OldEndDate = Date THEN BEGIN
                                                                      SetDuration(OldEndDate,DT2TIME(CREATEDATETIME(OldEndDate,0T) + 30 * 60 * 1000));
                                                                    END ELSE
                                                                      SetDuration(OldEndDate,0T);
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Type;
                                                              DEA=Art];
                                                   OptionCaptionML=[ENU=" ,Meeting,Phone Call";
                                                                    DEA=" ,Besprechung,Telefonat"];
                                                   OptionString=[ ,Meeting,Phone Call] }
    { 9   ;   ;Date                ;Date          ;OnValidate=BEGIN
                                                                IF (Date < 01011900D) OR (Date > 31122999D) THEN
                                                                  ERROR(Text006,01011900D,31122999D);

                                                                IF Date <> xRec.Date THEN
                                                                  GetEndDateTime;
                                                              END;

                                                   CaptionML=[ENU=Date;
                                                              DEA=Datum];
                                                   NotBlank=Yes }
    { 10  ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                IF Status = Status::Completed THEN
                                                                  VALIDATE(Closed,TRUE)
                                                                ELSE
                                                                  VALIDATE(Closed,FALSE);
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionCaptionML=[ENU=Not Started,In Progress,Completed,Waiting,Postponed;
                                                                    DEA=Nicht begonnen,In Bearbeitung,Erledigt,Warten,Zurckgestellt];
                                                   OptionString=Not Started,In Progress,Completed,Waiting,Postponed;
                                                   Description=CM }
    { 11  ;   ;Priority            ;Option        ;InitValue=Normal;
                                                   CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High;
                                                   Description=CM }
    { 12  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung];
                                                   Description=CM }
    { 13  ;   ;Closed              ;Boolean       ;OnValidate=BEGIN
                                                                IF Closed THEN BEGIN
                                                                  "Date Closed" := TODAY;
                                                                  Status := Status::Completed;
                                                                  IF NOT Canceled THEN BEGIN
                                                                    IF ("Team Code" <> '') AND
                                                                       ("Completed By" = '')
                                                                    THEN
                                                                      ERROR(STRSUBSTNO(Text029,FIELDCAPTION("Completed By")));
                                                                    IF CurrFieldNo <> 0 THEN
                                                                      IF CONFIRM(Text004,TRUE) THEN
                                                                        CreateInteraction
                                                                  END;
                                                                  IF Recurring THEN
                                                                    CreateRecurringTodo;
                                                                END ELSE BEGIN
                                                                  Canceled := FALSE;
                                                                  "Date Closed" := 0D;
                                                                  IF Status = Status::Completed THEN
                                                                    Status := Status::"In Progress";
                                                                  IF "Completed By" <> '' THEN
                                                                    "Completed By" := ''
                                                                END;
                                                                IF CurrFieldNo <> 0 THEN
                                                                  MODIFY(TRUE);
                                                              END;

                                                   CaptionML=[ENU=Closed;
                                                              DEA=Abgeschlossen] }
    { 14  ;   ;Date Closed         ;Date          ;CaptionML=[ENU=Date Closed;
                                                              DEA=Abgeschlossen am];
                                                   Editable=No }
    { 15  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              DEA=Nummernserie];
                                                   Editable=No }
    { 16  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Rlshp. Mgt. Comment Line" WHERE (Table Name=CONST(To-do),
                                                                                                       No.=FIELD(Organizer To-do No.),
                                                                                                       Sub No.=CONST(0)));
                                                   CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung];
                                                   Editable=No }
    { 17  ;   ;Canceled            ;Boolean       ;OnValidate=BEGIN
                                                                IF Canceled AND NOT Closed THEN
                                                                  VALIDATE(Closed,TRUE);
                                                                IF (NOT Canceled) AND Closed THEN
                                                                  VALIDATE(Closed,FALSE);
                                                              END;

                                                   CaptionML=[ENU=Canceled;
                                                              DEA=Storniert] }
    { 18  ;   ;Contact Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact No.)));
                                                   CaptionML=[ENU=Contact Name;
                                                              DEA=Kontaktname];
                                                   Editable=No }
    { 19  ;   ;Team Name           ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Team.Name WHERE (Code=FIELD(Team Code)));
                                                   CaptionML=[ENU=Team Name;
                                                              DEA=Teamname];
                                                   NotBlank=No;
                                                   Editable=No }
    { 20  ;   ;Salesperson Name    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Salesperson Code)));
                                                   CaptionML=[ENU=Salesperson Name;
                                                              DEA=Verk„ufername];
                                                   Editable=No }
    { 21  ;   ;Campaign Description;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Campaign.Description WHERE (No.=FIELD(Campaign No.)));
                                                   CaptionML=[ENU=Campaign Description;
                                                              DEA=Kampagnenbeschreibung];
                                                   Editable=No }
    { 22  ;   ;Contact Company No. ;Code20        ;TableRelation=Contact WHERE (Type=CONST(Company));
                                                   CaptionML=[ENU=Contact Company No.;
                                                              DEA=Kontakt Unternehmensnr.] }
    { 23  ;   ;Contact Company Name;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact Company No.)));
                                                   CaptionML=[ENU=Contact Company Name;
                                                              DEA=Kontakt Unternehmensname];
                                                   Editable=No }
    { 24  ;   ;Recurring           ;Boolean       ;CaptionML=[ENU=Recurring;
                                                              DEA=Wiederkehrend];
                                                   Description=CM }
    { 25  ;   ;Recurring Date Interval;DateFormula;OnValidate=BEGIN
                                                                IF Recurring THEN
                                                                  TESTFIELD("Recurring Date Interval");
                                                              END;

                                                   CaptionML=[ENU=Recurring Date Interval;
                                                              DEA=Wiederholungsrate] }
    { 26  ;   ;Calc. Due Date From ;Option        ;OnValidate=BEGIN
                                                                IF Recurring THEN
                                                                  TESTFIELD("Calc. Due Date From");
                                                              END;

                                                   CaptionML=[ENU=Calc. Due Date From;
                                                              DEA=F„lligkeitsdatum berechnen von];
                                                   OptionCaptionML=[ENU=" ,Due Date,Closing Date";
                                                                    DEA=" ,F„lligkeitsdatum,Abschlussdatum"];
                                                   OptionString=[ ,Due Date,Closing Date] }
    { 27  ;   ;Opportunity Description;Text50     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Opportunity.Description WHERE (No.=FIELD(Opportunity No.)));
                                                   CaptionML=[ENU=Opportunity Description;
                                                              DEA=Verkaufschancenbeschreibung];
                                                   Editable=No }
    { 28  ;   ;Start Time          ;Time          ;OnValidate=BEGIN
                                                                IF "Start Time" <> xRec."Start Time" THEN
                                                                  GetEndDateTime;
                                                              END;

                                                   CaptionML=[ENU=Start Time;
                                                              DEA=Startzeit] }
    { 29  ;   ;Duration            ;Duration      ;OnValidate=BEGIN
                                                                IF Duration < 0 THEN
                                                                  ERROR(Text005);

                                                                IF Duration < (60 * 1000) THEN
                                                                  ERROR(Text007);

                                                                IF Duration > (CREATEDATETIME(TODAY + 3650,0T) - CREATEDATETIME(TODAY,0T)) THEN
                                                                  ERROR(Text008);

                                                                IF Duration <> xRec.Duration THEN
                                                                  GetEndDateTime;
                                                              END;

                                                   CaptionML=[ENU=Duration;
                                                              DEA=Dauer];
                                                   Description=CM }
    { 31  ;   ;Opportunity Entry No.;Integer      ;TableRelation="Opportunity Entry";
                                                   CaptionML=[ENU=Opportunity Entry No.;
                                                              DEA=Verkaufschancenposten Lfd. Nr.] }
    { 32  ;   ;Last Date Modified  ;Date          ;CaptionML=[ENU=Last Date Modified;
                                                              DEA=Korrigiert am] }
    { 33  ;   ;Last Time Modified  ;Time          ;CaptionML=[ENU=Last Time Modified;
                                                              DEA=Korrigiert um] }
    { 34  ;   ;All Day Event       ;Boolean       ;OnValidate=BEGIN
                                                                IF "All Day Event" THEN BEGIN
                                                                  "Start Time" := 0T;
                                                                  TempStartDateTime := CREATEDATETIME(Date,"Start Time");
                                                                  TempEndDateTime := TempStartDateTime + Duration;
                                                                  IF DT2DATE(TempEndDateTime) = Date THEN
                                                                    Duration := 1440 * 1000 * 60
                                                                  ELSE
                                                                    Duration := ROUNDDATETIME(TempEndDateTime + 1,1440 * 1000 * 60,'>') - TempStartDateTime;
                                                                END ELSE
                                                                  Duration := Duration - 1440 * 1000 * 60;
                                                              END;

                                                   CaptionML=[ENU=All Day Event;
                                                              DEA=Ganzt„giges Ereignis] }
    { 35  ;   ;Location            ;Text50        ;CaptionML=[ENU=Location;
                                                              DEA=Ort] }
    { 36  ;   ;Organizer To-do No. ;Code20        ;TableRelation=To-do;
                                                   CaptionML=[ENU=Organizer To-do No.;
                                                              DEA=Organisatoraufgabennr.] }
    { 37  ;   ;Interaction Template Code;Code10   ;TableRelation="Interaction Template";
                                                   OnValidate=VAR
                                                                TodoInteractionLanguage@1000 : Record 5196;
                                                                Attachment@1001 : Record 5062;
                                                              BEGIN
                                                                IF "No." <> '' THEN
                                                                  UpdateInteractionTemplate(
                                                                    Rec,TodoInteractionLanguage,Attachment,"Interaction Template Code",FALSE);
                                                              END;

                                                   CaptionML=[ENU=Interaction Template Code;
                                                              DEA=Aktivit„tenvorlagencode];
                                                   Description=CM }
    { 38  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=VAR
                                                                TodoInteractionLanguage@1000 : Record 5196;
                                                              BEGIN
                                                                IF CurrFieldNo <> 0 THEN
                                                                  MODIFY;

                                                                IF "Language Code" = xRec."Language Code" THEN
                                                                  EXIT;

                                                                IF NOT TodoInteractionLanguage.GET("No.","Language Code") THEN BEGIN
                                                                  IF "No." = '' THEN
                                                                    EXIT;
                                                                  IF CurrFieldNo <> 0 THEN
                                                                    IF CONFIRM(Text010,TRUE,TodoInteractionLanguage.TABLECAPTION,"Language Code") THEN BEGIN
                                                                      TodoInteractionLanguage.INIT;
                                                                      TodoInteractionLanguage."To-do No." := "No.";
                                                                      TodoInteractionLanguage."Language Code" := "Language Code";
                                                                      TodoInteractionLanguage.Description := FORMAT("Interaction Template Code") + ' ' + FORMAT("Language Code");
                                                                      TodoInteractionLanguage.INSERT(TRUE);
                                                                      "Attachment No." := 0;
                                                                      MODIFY;
                                                                    END ELSE
                                                                      ERROR('');
                                                                END ELSE
                                                                  "Attachment No." := TodoInteractionLanguage."Attachment No.";
                                                              END;

                                                   OnLookup=VAR
                                                              TodoInteractionLanguage@1000 : Record 5196;
                                                            BEGIN
                                                              MODIFY;
                                                              COMMIT;

                                                              TodoInteractionLanguage.SETRANGE("To-do No.","Organizer To-do No.");
                                                              IF TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN;
                                                              IF PAGE.RUNMODAL(0,TodoInteractionLanguage) = ACTION::LookupOK THEN BEGIN
                                                                IF ("System To-do Type" = "System To-do Type"::Organizer) OR
                                                                   ("System To-do Type" = "System To-do Type"::Team)
                                                                THEN
                                                                  IF NOT TodoInteractionLanguage.ISEMPTY THEN BEGIN
                                                                    "Language Code" := TodoInteractionLanguage."Language Code";
                                                                    "Attachment No." := TodoInteractionLanguage."Attachment No.";
                                                                  END ELSE BEGIN
                                                                    "Language Code" := '';
                                                                    "Attachment No." := 0;
                                                                  END;
                                                              END ELSE
                                                                IF NOT TodoInteractionLanguage.ISEMPTY THEN BEGIN
                                                                  IF "Language Code" = TodoInteractionLanguage."Language Code" THEN
                                                                    "Attachment No." := TodoInteractionLanguage."Attachment No.";
                                                                END ELSE BEGIN
                                                                  "Language Code" := '';
                                                                  "Attachment No." := 0;
                                                                END;
                                                            END;

                                                   CaptionML=[ENU=Language Code;
                                                              DEA=Sprachcode] }
    { 39  ;   ;Attachment No.      ;Integer       ;CaptionML=[ENU=Attachment No.;
                                                              DEA=Dateianhangsnr.] }
    { 40  ;   ;Subject             ;Text50        ;OnValidate=BEGIN
                                                                IF CurrFieldNo <> 0 THEN
                                                                  MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Subject;
                                                              DEA=Betreff] }
    { 41  ;   ;Unit Cost (LCY)     ;Decimal       ;OnValidate=BEGIN
                                                                IF CurrFieldNo <> 0 THEN
                                                                  MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Unit Cost (LCY);
                                                              DEA=Einstandspreis (MW)];
                                                   DecimalPlaces=2:2 }
    { 42  ;   ;Unit Duration (Min.);Decimal       ;OnValidate=BEGIN
                                                                IF CurrFieldNo <> 0 THEN
                                                                  MODIFY;
                                                              END;

                                                   CaptionML=[ENU=Unit Duration (Min.);
                                                              DEA=Vorgabedauer (Min.)];
                                                   DecimalPlaces=0:2 }
    { 43  ;   ;No. of Attendees    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Attendee WHERE (To-do No.=FIELD(Organizer To-do No.)));
                                                   CaptionML=[ENU=No. of Attendees;
                                                              DEA=Anzahl Teilnehmer];
                                                   Editable=No }
    { 44  ;   ;Attendees Accepted No.;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count(Attendee WHERE (To-do No.=FIELD(Organizer To-do No.),
                                                                                     Invitation Response Type=CONST(Accepted)));
                                                   CaptionML=[ENU=Attendees Accepted No.;
                                                              DEA=Anzahl Teilnehmerzusagen];
                                                   Editable=No }
    { 45  ;   ;System To-do Type   ;Option        ;CaptionML=[ENU=System To-do Type;
                                                              DEA=Systemaufgabenart];
                                                   OptionCaptionML=[ENU=Organizer,Salesperson Attendee,Contact Attendee,Team;
                                                                    DEA=Organisator,Teilnehmer Verk„ufer,Teilnehmer Kontakt,Team];
                                                   OptionString=Organizer,Salesperson Attendee,Contact Attendee,Team }
    { 46  ;   ;Completed By        ;Code10        ;TableRelation=Salesperson/Purchaser.Code;
                                                   OnValidate=BEGIN
                                                                IF (xRec."Completed By" = '') AND
                                                                   ("Completed By" <> '')
                                                                THEN
                                                                  IF CONFIRM(Text034) THEN
                                                                    VALIDATE(Closed,TRUE)
                                                                  ELSE
                                                                    "Completed By" := '';
                                                              END;

                                                   CaptionML=[ENU=Completed By;
                                                              DEA=Abgeschlossen von] }
    { 47  ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                IF "Ending Date" <> xRec."Ending Date" THEN
                                                                  SetDuration("Ending Date","Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Date;
                                                              DEA=Enddatum] }
    { 48  ;   ;Ending Time         ;Time          ;OnValidate=BEGIN
                                                                IF "Ending Time" <> xRec."Ending Time" THEN
                                                                  SetDuration("Ending Date","Ending Time");
                                                              END;

                                                   CaptionML=[ENU=Ending Time;
                                                              DEA=Endzeit] }
    { 9501;   ;Wizard Step         ;Option        ;CaptionML=[ENU=Wizard Step;
                                                              DEA=Assistentenschritt];
                                                   OptionCaptionML=[ENU=" ,1,2,3,4,5,6";
                                                                    DEA=" ,1,2,3,4,5,6"];
                                                   OptionString=[ ,1,2,3,4,5,6];
                                                   Editable=No }
    { 9504;   ;Team To-do          ;Boolean       ;CaptionML=[ENU=Team To-do;
                                                              DEA=Teamaufgabe] }
    { 9505;   ;Send on finish      ;Boolean       ;CaptionML=[ENU=Send on finish;
                                                              DEA=Nach Abschluss senden] }
    { 9506;   ;Segment Description ;Text50        ;CaptionML=[ENU=Segment Description;
                                                              DEA=Segmentbeschreibung] }
    { 9507;   ;Team Meeting Organizer;Code20      ;CaptionML=[ENU=Team Meeting Organizer;
                                                              DEA=Organisator der Teambesprechung] }
    { 9508;   ;Activity Code       ;Code10        ;TableRelation=Activity.Code;
                                                   CaptionML=[ENU=Activity Code;
                                                              DEA=Aktionscode] }
    { 9509;   ;Wizard Contact Name ;Text50        ;CaptionML=[ENU=Wizard Contact Name;
                                                              DEA=Assistent fr Kontaktname] }
    { 9510;   ;Wizard Campaign Description;Text50 ;CaptionML=[ENU=Wizard Campaign Description;
                                                              DEA=Assistent fr Kampagnenbeschreibung] }
    { 9511;   ;Wizard Opportunity Description;Text50;
                                                   CaptionML=[ENU=Wizard Opportunity Description;
                                                              DEA=Assistent fr Verkaufschancenbeschreibung] }
    { 50000;  ;CM Type             ;Option        ;CaptionML=[ENU=CMMS Type;
                                                              DEA=CMMS Typ];
                                                   OptionString=[ ,Task,Request] }
    { 50001;  ;CM Extended Description;Text250    ;CaptionML=[ENU=Extended Description;
                                                              DEA=Erweiterte Beschreibung] }
    { 50010;  ;CM Source           ;Option        ;CaptionML=[ENU=Source;
                                                              DEA=Herkunft];
                                                   OptionString=Standard,Interface,Recuring,Request }
    { 50020;  ;CM Source No.       ;Integer       ;CaptionML=[ENU=Source Nr.;
                                                              DEA=Herkunftnr.] }
    { 50030;  ;CM Created Datetime ;DateTime       }
    { 50090;  ;CM Subtype          ;Option        ;CaptionML=[ENU=Subtype;
                                                              DEA=Subtyp];
                                                   OptionString=[ ,Checklist,Team] }
    { 50100;  ;CM Request Type     ;Option        ;CaptionML=[ENU=Request Type;
                                                              DEA=Anfragetyp];
                                                   OptionString=New Project,Start Plant Onboarding,Fault rectification,Sales and Marketing,After Sales and Customer Request,Contracts and Legal,Internal Project,Organisatory Task,Request to IT,Finance and Accounting,Human Resources,Quality Health and Safety,Improvement suggestion,CMMS Support request }
    { 50110;  ;CM Transf. to Workorder No.;Code20 ;TableRelation=Opportunity.No. WHERE (CM Is Workorder=CONST(Yes));
                                                   CaptionML=[ENU=Transfered to Workorder No.;
                                                              DEA=Transferiert zu Arbeitsauftragnr.] }
    { 50120;  ;CM Transf. to Task No.;Code20      ;TableRelation=To-do.No. WHERE (CM Type=CONST(Task));
                                                   CaptionML=[ENU=Transfered to Task No.;
                                                              DEA=Transferiert zu Aufgabennr.] }
    { 50210;  ;CM Maintask No.     ;Code20        ;CaptionML=[ENU=Maintask No.;
                                                              DEA=Hauptaufgabe Nr.];
                                                   Description=Applies to Checklist }
    { 50220;  ;CM Maintask Status  ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(To-do."CM Status" WHERE (No.=FIELD(CM Maintask No.)));
                                                   OptionString=Open,Done Positive,Done Negative,Closed;
                                                   Description=FF;
                                                   Editable=No }
    { 50300;  ;CM Status           ;Option        ;CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionString=Open,Done Positive,Done Negative,Closed }
    { 50301;  ;CM Checklist Status (Helper);Option;OptionString=---,Yes,No,Not Applicable }
    { 50310;  ;CM Automatically Closed;Boolean    ;CaptionML=[ENU=Automatically Closed;
                                                              DEA=Automatisch Geschlossen] }
    { 50400;  ;CM Scheduled Date   ;Date          ;CaptionML=[ENU=Scheduled Date;
                                                              DEA=Geplantes Datum] }
    { 50410;  ;CM Scheduled Time   ;Time          ;CaptionML=[ENU=Scheduled Time;
                                                              DEA=Geplante Zeit] }
    { 50430;  ;CM Due Date         ;Date          ;CaptionML=[ENU=Due Date;
                                                              DEA=F„llig Am] }
    { 50500;  ;CM Duration (Planned);Duration     ;CaptionML=[ENU=Duration (Planned);
                                                              DEA=Dauer (Geplant)] }
    { 50700;  ;CM Assigned User ID ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                CMTaskMgt.ChangeAssignedUserID(Rec, Rec."CM Assigned User ID", xRec."CM Assigned User ID", FALSE);
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              DEA=Zugewiesener Benutzer ID] }
    { 50705;  ;CM Assigned User Name;Text80       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(CM Assigned User ID)));
                                                   CaptionML=[ENU=Assigned User Name;
                                                              DEA=Zugwiesener Benutzername];
                                                   Description=FF;
                                                   Editable=No }
    { 50710;  ;CM Created By User ID;Code50       ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=Created By User ID;
                                                              DEA=Erstellt von Benutzer ID] }
    { 50715;  ;CM Created By User Name;Text50     ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(CM Created By User ID)));
                                                   CaptionML=[ENU=Created By User Name;
                                                              DEA=Erstellt von Benutzer Name];
                                                   Description=FF;
                                                   Editable=No }
    { 50800;  ;CM Comment Text     ;Text250       ;CaptionML=[ENU=Comment Text;
                                                              DEA=Kommentar Text] }
    { 50890;  ;CM Objecttype       ;Option        ;CaptionML=[ENU=Objecttype;
                                                              DEA=Objeckttyp];
                                                   OptionString=Asset,Project }
    { 50900;  ;CM Object No.       ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=FIELD(CM Objecttype));
                                                   CaptionML=[ENU=Asset/Project No.;
                                                              DEA=Anlagen/Projectnr.] }
    { 50901;  ;CM Object Name      ;Text100       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object".Name WHERE (Objecttype=FIELD(CM Objecttype),
                                                                                                No.=FIELD(CM Object No.)));
                                                   CaptionML=[ENU=Object Name;
                                                              DEA=Objektname];
                                                   Description=FF;
                                                   Editable=No }
    { 50905;  ;CM From Task No.    ;Code20        ;TableRelation=To-do.No. WHERE (CM Type=CONST(Task));
                                                   CaptionML=[ENU=From Task No.;
                                                              DEA=Von Aufgabe Nr.];
                                                   Description=Applies to Requests only }
    { 50910;  ;CM Workorder Description;Text50    ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Opportunity.Description WHERE (No.=FIELD(Opportunity No.)));
                                                   CaptionML=[ENU=Workorder Description;
                                                              DEA=Arbeitsauftrag Beschreibung];
                                                   Description=FF;
                                                   Editable=No }
    { 50920;  ;CM Workoder Status  ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Opportunity."CM Status" WHERE (No.=FIELD(Opportunity No.)));
                                                   CaptionML=[ENU=Workorder Status;
                                                              DEA=Arbeitsauftrag Status];
                                                   OptionString=New,Open,In Process,Completed,Done,Discarded;
                                                   Description=FF;
                                                   Editable=No }
    { 50990;  ;CM Has Checklist    ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (CM Maintask No.=FIELD(No.),
                                                                                  CM Type=CONST(Task),
                                                                                  CM Subtype=CONST(Checklist)));
                                                   Description=FF }
    { 50991;  ;CM Has Team         ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (CM Maintask No.=FIELD(No.),
                                                                                  CM Type=CONST(Task),
                                                                                  CM Subtype=CONST(Team)));
                                                   Description=FF }
    { 50992;  ;CM User In Team     ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (CM Type=CONST(Task),
                                                                                  CM Subtype=CONST(Team),
                                                                                  CM Maintask No.=FIELD(No.),
                                                                                  CM Assigned User ID=FIELD(CM User In Team Filter)));
                                                   Description=FF;
                                                   Editable=No }
    { 50993;  ;CM User In Team Filter;Code50      ;FieldClass=FlowFilter;
                                                   Description=FFilter;
                                                   Editable=No }
    { 51000;  ;CM Interaction Template Code;Code10;TableRelation="Interaction Template".Code }
    { 51010;  ;CM Wizard Action    ;Option        ;CaptionML=[ENU=Wizard Action;
                                                              DEA=Aktion des Assistenten];
                                                   OptionCaptionML=[ENU=" ,Open,Import,,,,,Information";
                                                                    DEA=" ,Dateianhang ”ffnen,Dateianhang importieren,,,,,Information"];
                                                   OptionString=[ ,Open,Import,,,,,Information] }
    { 51020;  ;CM Information Type ;Option        ;CaptionML=[ENU=Information Type;
                                                              DEA=Information Typ];
                                                   OptionCaptionML=[ENU=" ,Comment,Comment (long),,,,,,,,Replacement,Installation";
                                                                    DEA=" ,Kommentar,Kommentar (lang),,,,,,,,Austausch,Installation"];
                                                   OptionString=[ ,Comment,Comment (long),,,,,,,,Replacement,Installation] }
    { 51030;  ;CM Interaction Group Code;Code10   ;TableRelation="Interaction Group";
                                                   CaptionML=[ENU=Interaction Group Code;
                                                              DEA=Aktivit„tengruppencode];
                                                   NotBlank=Yes }
    { 60000;  ;CM Creation Type    ;Option        ;CaptionML=[ENU=Creation Type;
                                                              DEA=Art der Erstellung];
                                                   OptionCaptionML=[ENU=Manual,Workorder Type,Request;
                                                                    DEA=Manuell,Arbeitsauftrag Typ,Anfrage];
                                                   OptionString=Manual,Workorder Type,Request }
    { 60100;  ;CM Internal         ;Boolean       ;CaptionML=[ENU=Internal;
                                                              DEA=Intern] }
    { 70000;  ;CM Is Temporary     ;Boolean       ;CaptionML=[ENU=Is Temporary;
                                                              DEA=Ist Tempor„r] }
    { 70010;  ;CM Selected         ;Boolean       ;CaptionML=[ENU=Selected;
                                                              DEA=Ausgew„hlt] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Contact Company No.,Date,Contact No.,Closed }
    {    ;Contact Company No.,Contact No.,Closed,Date }
    {    ;Salesperson Code,Date,Closed             }
    {    ;Team Code,Date,Closed                    }
    {    ;Campaign No.,Date                        }
    {    ;Segment No.,Date                         }
    {    ;Opportunity No.,Date,Closed              }
    {    ;Organizer To-do No.,System To-do Type    }
    {    ;Opportunity No.,CM Type,CM Assigned User ID,CM Status }
    {    ;CM Type,CM Maintask No.,CM Assigned User ID,CM Status }
    {    ;CM Type,CM Objecttype,CM Object No.      }
    {    ;CM Type,CM Objecttype,CM Object No.,CM Source,CM Source No.,Date }
    {    ;CM Type,Opportunity No.,No.              }
    {    ;CM Type,CM Subtype,Opportunity No.,No.   }
    {    ;CM Type,Opportunity No.,CM Subtype,CM Status,No. }
    {    ;CM Type,CM Subtype,CM Maintask No.,No.   }
    {    ;CM Type,CM Subtype,CM Status,CM Due Date,Priority }
    {    ;CM Type,CM Subtype,CM Status,Priority,CM Due Date }
    {    ;CM Type,CM Subtype,CM Status,CM Due Date,CM Assigned User ID }
    {    ;CM Type,CM Subtype,CM Status,CM Due Date,CM Objecttype,CM Object No. }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Description,Status                   }
    { 2   ;Brick               ;CM Assigned User ID,Description,CM Status,Priority,CM Request Type }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=%1 must be specified.;DEA=%1 muss angegeben werden.';
      Text001@1001 : TextConst 'ENU=%1 No. %2 has been created from recurring %3 %4.;DEA=%1 Nr. %2 wurde ausgehend von der wiederkehrenden %3 %4 erstellt.';
      Text002@1002 : TextConst 'ENU=Do you want to create a to-do for all contacts in the %1 segment;DEA=M”chten Sie eine Aufgabe fr alle Kontakte in Segment %1 erstellen?';
      Text003@1003 : TextConst 'ENU=Do you want to assign an activity to all contacts in the %1 segment;DEA=M”chten Sie allen Kontakten in Segment %1 eine Aktion zuordnen?';
      RMSetup@1004 : Record 5079;
      Cont@1005 : Record 5050;
      RMCommentLine@1006 : Record 5061;
      Salesperson@1021 : Record 13;
      Activity@1069 : Record 5081;
      Campaign@1059 : Record 5071;
      Team@1050 : Record 5083;
      Opp@1041 : Record 5092;
      SegHeader@1040 : Record 5076;
      AttendeeTemp@1039 : TEMPORARY Record 5199;
      SalesPurchPerson@1038 : Record 13;
      TodoInteractionLanguage@1037 : TEMPORARY Record 5196;
      AttachmentTemp@1026 : TEMPORARY Record 5062;
      RMCommentLineTmp@1024 : TEMPORARY Record 5061;
      NoSeriesMgt@1007 : Codeunit 396;
      Text004@1008 : TextConst 'ENU=Do you want to register an interaction log entry?;DEA=M”chten Sie einen Aktivit„tenprotokollposten erfassen?';
      TempEndDateTime@1012 : DateTime;
      Text005@1013 : TextConst 'ENU=Information that you have entered in this field will cause the duration to be negative which is not allowed. Please modify the ending date/time value.;DEA=Die von Ihnen in dieses Feld eingegebenen Daten resultieren in einer negativen Dauer, was unzul„ssig ist. Žndern Sie den Wert von Enddatum und/oder Endzeit.';
      TempStartDateTime@1014 : DateTime;
      Text006@1015 : TextConst 'ENU=The valid range of dates is from %1 to %2. Please enter a date within this range.;DEA=Der gltige Datumsbereich reicht vom %1 bis zum %2. Bitte geben Sie ein Datum ein, das innerhalb dieses Zeitraums liegt.';
      Text007@1016 : TextConst 'ENU=Information that you have entered in this field will cause the duration to be less than 1 minute, which is not allowed. Please modify the ending date/time value.;DEA=Die von Ihnen in dieses Feld eingegebenen Daten resultieren in einer Dauer von weniger als einer Minute, was unzul„ssig ist. Žndern Sie den Wert von Enddatum und/oder Endzeit.';
      Text008@1017 : TextConst 'ENU=Information that you have entered in this field will cause the duration to be more than 10 years, which is not allowed. Please modify the ending date/time value.;DEA=Die von Ihnen in dieses Feld eingegebenen Daten resultieren in einer Dauer von mehr als zehn Jahren, was unzul„ssig ist. Žndern Sie den Wert von Enddatum und/oder Endzeit.';
      Text009@1022 : TextConst 'ENU=You cannot change the %1 for this to-do, because this salesperson is the meeting organizer.;DEA=Sie k”nnen den %1 fr diese Aufgabe nicht „ndern, da dieser Verk„ufer der Organisator der Besprechung ist.';
      Text010@1023 : TextConst 'ENU=Do you want to create a new %2 value in %1 for this to-do?;DEA=M”chten Sie einen neuen %2-Wert in %1 fr diese Aufgabe erstellen?';
      Text012@1025 : TextConst 'ENU=You cannot change a to-do type from Blank or Phone Call to Meeting and vice versa. You can only change a to-do type from Blank to Phone Call or from Phone Call to Blank.;DEA=Sie k”nnen die Aufgabenart nicht von "leer" oder Telefonat in Besprechung „ndern oder umgekehrt. Es ist nur m”glich, die Aufgabeart von "leer" in Telefonat oder von Telefonat in "leer" zu „ndern.';
      Text015@1029 : TextConst 'ENU=Dear %1,;DEA=Sehr geehrte(r) %1,';
      Text016@1030 : TextConst '@@@="%1 = To-Do Date,%2 = To-Do StartTime,%3=To-Do location";ENU=You are cordially invited to attend the meeting, which will take place on %1, %2 at %3.;DEA=Sie sind herzlich zu unserer Besprechung eingeladen. Datum: %1, Uhrzeit: %2, Ort: %3.';
      Text017@1028 : TextConst 'ENU=Yours sincerely,;DEA=Mit freundlichen Gráen';
      Text018@1031 : TextConst 'ENU=The %1 check box is not selected.;DEA=Das Kontrollk„stchen %1 wurde nicht aktiviert.';
      Text019@1032 : TextConst 'ENU=Send invitations to all Attendees with selected %1 check boxes.;DEA=Einladungen an alle Teilnehmer mit aktiviertem Kontrollk„stchen %1 senden.';
      Text020@1033 : TextConst 'ENU=Send invitations to Attendees who have not been sent invitations yet.;DEA=Einladungen an alle Teilnehmer ohne bereits erhaltene Einladung senden.';
      Text021@1034 : TextConst 'ENU=Do not send invitations.;DEA=Keine Einladungen senden.';
      Text022@1035 : TextConst 'ENU=Invitations have already been sent to Attendees with selected %1 check boxes. Do you want to resend the invitations?;DEA=Teilnehmer, fr die das Kontrollk„stchen %1 aktiviert wurde, haben bereits Einladungen erhalten. M”chten Sie die Einladungen erneut senden?';
      Text023@1036 : TextConst 'ENU=Outlook failed to send an invitation to %1.;DEA=Outlook konnte keine Einladung an %1 senden.';
      Text029@1042 : TextConst 'ENU=The %1 field must be filled in for to-dos assigned to a team.;DEA=Das Feld %1 muss fr Aufgaben ausgefllt werden, die einem Team zugewiesen sind.';
      Text030@1043 : TextConst 'ENU=The to-dos of the %1 team members who do not belong to the %2 team will be deleted. Do you want to continue?;DEA=Die Aufgaben der %1 Teammitglieder, die nicht dem %2 Team angeh”ren, werden gel”scht. Soll der Vorgang fortgesetzt werden?';
      Text032@1045 : TextConst 'ENU=To-do no. %1 will be reassigned to %2 and the corresponding salesperson to-dos for team members will be deleted. Do you want to continue?;DEA=Aufgabennr. %1 wird %2 neu zugewiesen, und die entsprechenden Verk„uferaufgaben fr Teammitglieder werden gel”scht. Soll der Vorgang fortgesetzt werden?';
      Text033@1046 : TextConst 'ENU=To-do no. %1 will be reassigned to %2. Do you want to continue?;DEA=Aufgabennr. %1 wird %2 neu zugewiesen. Soll der Vorgang fortgesetzt werden?';
      Text034@1047 : TextConst 'ENU=Do you want to close the to-do?;DEA=Soll die Aufgabe geschlossen werden?';
      Text035@1027 : TextConst 'ENU=You must fill in either the %1 field or the %2 field.;DEA=Sie mssen entweder in Feld %1 oder in Feld %2 einen Wert eingeben.';
      Text036@1049 : TextConst 'ENU=Creating to-dos...\;DEA=Aufgaben werden erstellt...\';
      Text037@1048 : TextConst 'ENU=To-do No. #1##############\;DEA=Aufgabenr. #1##############\';
      Text038@1044 : TextConst 'ENU=Status    @2@@@@@@@@@@@@@@;DEA=Status     @2@@@@@@@@@@@@@@';
      Text039@1051 : TextConst 'ENU=To-do no. %1 is closed and will be reopened. The to-dos of the %2 team members who do not belong to the %3 team will be deleted. Do you want to continue?;DEA=Aufgabennr. %1 ist abgeschlossen und wird erneut ge”ffnet. Die Aufgaben der %2 Teammitglieder, die nicht dem Team %3 angeh”ren, werden gel”scht. Soll der Vorgang fortgesetzt werden?';
      Text040@1052 : TextConst 'ENU=To-do no. %1 is closed and will be reopened. It will be reassigned to %2, and the corresponding salesperson to-dos for team members will be deleted. Do you want to continue?;DEA=Aufgabennr. %1 ist abgeschlossen und wird erneut ge”ffnet. Die Aufgabe wird %2 erneut zugewiesen, und die entsprechenden Verk„uferaufgaben fr Teammitglieder werden gel”scht. Soll der Vorgang fortgesetzt werden?';
      Text041@1053 : TextConst 'ENU=To-do no. %1 is closed. It will be reopened and reassigned to %2. Do you want to continue?;DEA=Aufgabennr. %1 ist abgeschlossen. Sie wird erneut ge”ffnet und %2 neu zugewiesen. Soll der Vorgang fortgesetzt werden?';
      Text042@1054 : TextConst 'ENU=To-do no. %1 is closed. Do you want to reopen it and assign to the %2 team?;DEA=Aufgabennr. %1 ist abgeschlossen. Soll sie neu ge”ffnet und Team %2 zugewiesen werden?';
      SalespersonFilter@1058 : Code[10];
      ContactFilter@1057 : Code[20];
      Text043@1068 : TextConst 'ENU=You must fill in the %1 field.;DEA=Sie mssen das Feld %1 ausfllen.';
      Text047@1072 : TextConst 'ENU=You cannot use the wizard to create an attachment. You can create an attachment in the Interaction Template window.;DEA=Sie k”nnen den Assistenten nicht fr die Erstellung eines Dateianhangs verwenden. Einen Dateianhang k”nnen Sie im Fenster Aktivit„tenvorlage erstellen.';
      Text051@1077 : TextConst 'ENU=Activity Code;DEA=Aktionscode';
      Text053@1076 : TextConst 'ENU=You must specify %1 or %2.;DEA=Sie mssen %1 oder %2 angeben.';
      Text056@1073 : TextConst 'ENU=Activity %1 contains to-dos of type Meeting. You must fill in the Meeting Organizer field.;DEA=Aktion %1 enth„lt Aufgaben des Typs "Besprechung". Sie mssen einen Organisator fr die Besprechung eingeben.';
      Text065@1083 : TextConst 'ENU=You must specify the to-do organizer.;DEA=Geben Sie den Organisator an.';
      Text067@1019 : TextConst 'ENU=The %1 must contain an attachment if you want to send an invitation to an %2 of the contact type.;DEA=Wenn Sie eine Einladung an ''%2'' vom Typ ''Kontakt'' senden m”chten, muss ''%1'' einen Dateianhang enthalten.';
      Text068@1080 : TextConst 'ENU=You cannot select the Send invitation(s) on Finish check box, because none of the %1 check boxes are selected.;DEA=Sie k”nnen das Feld ''Einladung(en) versenden, wenn auf Beenden geklickt wird'' nicht aktivieren, da keines der Felder fr %1 ausgew„hlt wurde.';
      RunFormCode@1020 : Boolean;
      CMTaskMgt@1000000000 : Codeunit 70031;

    PROCEDURE CreateToDoFromToDo@1(VAR ToDo@1000 : Record 5080);
    VAR
      Cont@1001 : Record 5050;
      SalesPurchPerson@1002 : Record 13;
      Team@1003 : Record 5083;
      Campaign@1004 : Record 5071;
      Opp@1005 : Record 5092;
      SegHeader@1006 : Record 5076;
    BEGIN
      DELETEALL;
      INIT;
      IF ToDo.GETFILTER("Contact Company No.") <> '' THEN
        IF Cont.GET(ToDo.GETRANGEMIN("Contact Company No.")) THEN BEGIN
          VALIDATE("Contact No.",Cont."No.");
          "Salesperson Code" := Cont."Salesperson Code";
          SETRANGE("Contact Company No.","Contact No.");
        END;
      IF Cont.GET(ToDo.GETFILTER("Contact No.")) THEN BEGIN
        VALIDATE("Contact No.",Cont."No.");
        "Salesperson Code" := Cont."Salesperson Code";
        SETRANGE("Contact No.","Contact No.");
      END;
      IF SalesPurchPerson.GET(ToDo.GETFILTER("Salesperson Code")) THEN BEGIN
        "Salesperson Code" := SalesPurchPerson.Code;
        SETRANGE("Salesperson Code","Salesperson Code");
      END;
      IF Team.GET(ToDo.GETFILTER("Team Code")) THEN BEGIN
        VALIDATE("Team Code",Team.Code);
        SETRANGE("Team Code","Team Code");
      END;
      IF Campaign.GET(ToDo.GETFILTER("Campaign No.")) THEN BEGIN
        "Campaign No." := Campaign."No.";
        "Salesperson Code" := Campaign."Salesperson Code";
        SETRANGE("Campaign No.","Campaign No.");
      END;
      IF Opp.GET(ToDo.GETFILTER("Opportunity No.")) THEN BEGIN
        VALIDATE("Opportunity No.",Opp."No.");
        "Contact No." := Opp."Contact No.";
        "Contact Company No." := Opp."Contact Company No.";
        "Campaign No." := Opp."Campaign No.";
        "Salesperson Code" := Opp."Salesperson Code";
        SETRANGE("Opportunity No.","Opportunity No.");
      END;
      IF SegHeader.GET(ToDo.GETFILTER("Segment No.")) THEN BEGIN
        "Segment No." := SegHeader."No.";
        "Campaign No." := SegHeader."Campaign No.";
        "Salesperson Code" := SegHeader."Salesperson Code";
        SETRANGE("Segment No.","Segment No.");
      END;

      StartWizard;
    END;

    PROCEDURE CreateToDoFromSalesHeader@50(SalesHeader@1000 : Record 36);
    BEGIN
      DELETEALL;
      INIT;
      VALIDATE("Contact No.",SalesHeader."Sell-to Contact No.");
      SETRANGE("Contact No.",SalesHeader."Sell-to Contact No.");
      IF SalesHeader."Salesperson Code" <> '' THEN BEGIN
        "Salesperson Code" := SalesHeader."Salesperson Code";
        SETRANGE("Salesperson Code","Salesperson Code");
      END;
      IF SalesHeader."Campaign No." <> '' THEN BEGIN
        "Campaign No." := SalesHeader."Campaign No.";
        SETRANGE("Campaign No.","Campaign No.");
      END;

      StartWizard;
    END;

    PROCEDURE CreateToDoFromInteractLogEntry@51(InteractionLogEntry@1000 : Record 5065);
    BEGIN
      INIT;
      VALIDATE("Contact No.",InteractionLogEntry."Contact No.");
      "Salesperson Code" := InteractionLogEntry."Salesperson Code";
      "Campaign No." := InteractionLogEntry."Campaign No.";

      StartWizard;
    END;

    LOCAL PROCEDURE CreateInteraction@10();
    VAR
      SegLine@1000 : TEMPORARY Record 5077;
    BEGIN
      SegLine.CreateInteractionFromToDo(Rec);
    END;

    LOCAL PROCEDURE CreateRecurringTodo@4();
    VAR
      RMCommentLine@1000 : Record 5061;
      ToDo2@1002 : Record 5080;
      TodoInteractLanguage@1003 : Record 5196;
      Attachment@1004 : Record 5062;
      Attendee@1005 : Record 5199;
      AttendeeTemp@1007 : TEMPORARY Record 5199;
      RMCommentLine3@1006 : Record 5061;
    BEGIN
      TESTFIELD("Recurring Date Interval");
      IF "Calc. Due Date From" = "Calc. Due Date From"::" " THEN
        ERROR(
          STRSUBSTNO(Text000,FIELDCAPTION("Calc. Due Date From")));

      ToDo2 := Rec;
      WITH ToDo2 DO BEGIN
        Status := 0;
        Closed := FALSE;
        Canceled := FALSE;
        "Date Closed" := 0D;
        "Completed By" := '';
        CASE "Calc. Due Date From" OF
          "Calc. Due Date From"::"Due Date":
            Date := CALCDATE("Recurring Date Interval",Date);
          "Calc. Due Date From"::"Closing Date":
            Date := CALCDATE("Recurring Date Interval",TODAY);
        END;
        GetEndDateTime;

        WITH RMCommentLine3 DO BEGIN
          RESET;
          SETRANGE("Table Name",RMCommentLine."Table Name"::"To-do");
          SETRANGE("No.","No.");
          SETRANGE("Sub No.",0);
        END;

        TodoInteractLanguage.SETRANGE("To-do No.","No.");

        IF Type = Type::Meeting THEN BEGIN
          Attendee.SETRANGE("To-do No.","No.");
          GET(InsertTodoAndRelatedData(
              ToDo2,TodoInteractLanguage,Attachment,Attendee,RMCommentLine3));
        END ELSE BEGIN
          CreateAttendeesFromTodo(AttendeeTemp,ToDo2,'');
          GET(InsertTodoAndRelatedData(
              ToDo2,TodoInteractLanguage,Attachment,AttendeeTemp,RMCommentLine3));
        END;
      END;

      MESSAGE(
        STRSUBSTNO(Text001,
          TABLECAPTION,ToDo2."Organizer To-do No.",TABLECAPTION,"No."));
    END;

    PROCEDURE InsertTodo@2(Todo2@1000 : Record 5080;VAR RMCommentLineTmp@1004 : Record 5061;VAR AttendeeTemp@1005 : Record 5199;VAR TodoInteractLanguageTemp@1007 : Record 5196;VAR AttachmentTemp@1008 : Record 5062;ActivityCode@1001 : Code[10];Deliver@1010 : Boolean);
    VAR
      SegHeader@1002 : Record 5076;
      SegLine@1003 : Record 5077;
      ConfirmText@1006 : Text[250];
    BEGIN
      IF SegHeader.GET(GETFILTER("Segment No.")) THEN BEGIN
        SegLine.SETRANGE("Segment No.",SegHeader."No.");
        SegLine.SETFILTER("Contact No.",'<>%1','');
        IF SegLine.FINDFIRST THEN BEGIN
          IF ActivityCode = '' THEN
            ConfirmText := Text002
          ELSE
            ConfirmText := Text003;
          IF CONFIRM(ConfirmText,TRUE,SegHeader."No.") THEN BEGIN
            IF ActivityCode = '' THEN BEGIN
              Todo2.GET(InsertTodoAndRelatedData(
                  Todo2,TodoInteractLanguageTemp,
                  AttachmentTemp,AttendeeTemp,RMCommentLineTmp));
              IF (Todo2.Type = Type::Meeting) AND Deliver THEN
                SendMAPIInvitations(Todo2,TRUE);
            END ELSE
              InsertActivityTodo(Todo2,ActivityCode,AttendeeTemp);
          END;
        END;
      END ELSE BEGIN
        IF ActivityCode = '' THEN BEGIN
          Todo2.GET(InsertTodoAndRelatedData(
              Todo2,TodoInteractLanguageTemp,
              AttachmentTemp,AttendeeTemp,RMCommentLineTmp));
          IF (Todo2.Type = Type::Meeting) AND Deliver THEN
            SendMAPIInvitations(Todo2,TRUE);
        END ELSE
          InsertActivityTodo(Todo2,ActivityCode,AttendeeTemp);
      END;

      IF (Todo2.Type = Todo2.Type::Meeting) AND
         Todo2.GET(Todo2."Organizer To-do No.")
      THEN
        Todo2.ArrangeOrganizerAttendee
    END;

    LOCAL PROCEDURE InsertTodoAndRelatedData@14(Todo2@1000 : Record 5080;VAR TodoInteractLanguage@1001 : Record 5196;VAR Attachment@1002 : Record 5062;VAR Attendee@1003 : Record 5199;VAR RMCommentLine@1004 : Record 5061) TodoNo : Code[20];
    VAR
      TodoInteractLanguage2@1005 : Record 5196;
      AttendeeTemp@1006 : TEMPORARY Record 5199;
      Todo@1007 : Record 5080;
      TeamSalesperson@1008 : Record 5084;
      Attendee2@1010 : Record 5199;
      SalespersonCode@1009 : Code[10];
      Window@1013 : Dialog;
      AttendeeCounter@1017 : Integer;
      TotalAttendees@1018 : Integer;
      CommentLineInserted@1019 : Boolean;
    BEGIN
      IF Todo2."Team Code" = '' THEN
        Todo2."System To-do Type" := "System To-do Type"::Organizer
      ELSE
        Todo2."System To-do Type" := "System To-do Type"::Team;
      IF Todo2.Type = Type::Meeting THEN BEGIN
        SalespersonCode := Todo2."Salesperson Code";
        CLEAR(Todo2."No.");
        IF Todo2."System To-do Type" = Todo2."System To-do Type"::Team THEN
          Todo2."Salesperson Code" := '';
        Todo2.INSERT(TRUE);

        CreateTodoInteractLanguages(TodoInteractLanguage,Attachment,Todo2."No.");
        IF TodoInteractLanguage2.GET(Todo2."No.",Todo2."Language Code") THEN BEGIN
          Todo2."Attachment No." := TodoInteractLanguage2."Attachment No.";
          Todo2.MODIFY;
        END;

        IF "Team Code" <> '' THEN BEGIN
          Attendee.SETCURRENTKEY("To-do No.","Attendance Type");
          Attendee.SETRANGE("Attendance Type",Attendee."Attendance Type"::"To-do Organizer");
          IF Attendee.FIND('-') THEN BEGIN
            CreateSubTodo(Attendee,Todo2);
            Attendee2.INIT;
            Attendee2 := Attendee;
            Attendee2."To-do No." := Todo2."No.";
            Attendee2.INSERT;
          END;
          Attendee.SETFILTER("Attendance Type",'<>%1',Attendee."Attendance Type"::"To-do Organizer")
        END;
        IF Attendee.FIND('-') THEN
          REPEAT
            CreateSubTodo(Attendee,Todo2);
            Attendee2.INIT;
            Attendee2 := Attendee;
            Attendee2."To-do No." := Todo2."No.";
            Attendee2.INSERT
          UNTIL Attendee.NEXT = 0;

        Todo2.GetMeetingOrganizerTodo(Todo);
        TodoNo := Todo."No."
      END ELSE
        IF Todo2."Segment No." = '' THEN BEGIN
          CLEAR(Todo2."No.");

          Todo2.INSERT(TRUE);
          TodoNo := Todo2."No.";
          IF Todo2."System To-do Type" = "System To-do Type"::Team THEN BEGIN
            TeamSalesperson.SETRANGE("Team Code",Todo2."Team Code");
            IF TeamSalesperson.FIND('-') THEN
              REPEAT
                AttendeeTemp.CreateAttendee(
                  AttendeeTemp,
                  Todo2."No.",10000,
                  AttendeeTemp."Attendance Type"::"To-do Organizer",
                  AttendeeTemp."Attendee Type"::Salesperson,
                  TeamSalesperson."Salesperson Code",
                  TRUE);
                CreateSubTodo(AttendeeTemp,Todo2);
                AttendeeTemp.DELETEALL
              UNTIL TeamSalesperson.NEXT = 0
          END;
          IF Attendee.FIND('-') THEN
            REPEAT
              CreateSubTodo(Attendee,Todo2);
            UNTIL Attendee.NEXT = 0;
        END ELSE
          IF Attendee.FIND('-') THEN BEGIN
            Window.OPEN(Text036 + Text037 + Text038);
            TotalAttendees := Attendee.COUNT;
            REPEAT
              IF Todo2."System To-do Type" = "System To-do Type"::Team THEN BEGIN
                Todo.INIT;
                Todo := Todo2;
                CLEAR(Todo."No.");
                FillSalesPersonContact(Todo,Attendee);
                Todo.INSERT(TRUE);
                TodoNo := Todo."No.";
                AttendeeTemp.INIT;
                AttendeeTemp := Attendee;
                AttendeeTemp.INSERT;
                CreateSubTodo(AttendeeTemp,Todo);
                AttendeeTemp.DELETEALL;
                TeamSalesperson.SETRANGE("Team Code",Todo."Team Code");
                IF TeamSalesperson.FIND('-') THEN
                  REPEAT
                    AttendeeTemp.CreateAttendee(
                      AttendeeTemp,
                      "No.",10000,
                      AttendeeTemp."Attendance Type"::"To-do Organizer",
                      AttendeeTemp."Attendee Type"::Salesperson,
                      TeamSalesperson."Salesperson Code",
                      TRUE);
                    CreateSubTodo(AttendeeTemp,Todo);
                    AttendeeTemp.DELETEALL
                  UNTIL TeamSalesperson.NEXT = 0
              END ELSE BEGIN
                Todo.INIT;
                Todo := Todo2;
                CLEAR(Todo."No.");
                Todo."System To-do Type" := "System To-do Type"::Organizer;
                FillSalesPersonContact(Todo,Attendee);
                Todo.INSERT(TRUE);
                TodoNo := Todo."No.";

                AttendeeTemp.INIT;
                AttendeeTemp := Attendee;
                AttendeeTemp.INSERT;
                CreateSubTodo(AttendeeTemp,Todo);
              END;
              AttendeeCounter := AttendeeCounter + 1;
              CreateCommentLines(RMCommentLine,TodoNo);
              Window.UPDATE(1,Todo."Organizer To-do No.");
              Window.UPDATE(2,ROUND(AttendeeCounter / TotalAttendees * 10000,1));
              COMMIT
            UNTIL Attendee.NEXT = 0;
            Window.CLOSE;
            CommentLineInserted := TRUE;
          END;
      IF NOT CommentLineInserted THEN
        CreateCommentLines(RMCommentLine,Todo2."No.");
    END;

    PROCEDURE CreateSubTodo@15(VAR Attendee@1001 : Record 5199;Todo@1000 : Record 5080) TodoNo : Code[20];
    VAR
      Todo2@1002 : Record 5080;
    BEGIN
      Todo2.INIT;
      Todo2.TRANSFERFIELDS(Todo,FALSE);

      IF Attendee."Attendance Type" <> Attendee."Attendance Type"::"To-do Organizer" THEN BEGIN
        IF Attendee."Attendee Type" = Attendee."Attendee Type"::Salesperson THEN BEGIN
          Todo2.VALIDATE("Salesperson Code",Attendee."Attendee No.");
          Todo2."Organizer To-do No." := Todo."No.";
          Todo2."System To-do Type" := "System To-do Type"::"Salesperson Attendee";
        END ELSE BEGIN
          Todo2.VALIDATE("Salesperson Code",Todo."Salesperson Code");
          Todo2.VALIDATE("Team Code",Todo."Team Code");
          Todo2.VALIDATE("Contact No.",Attendee."Attendee No.");
          Todo2."Organizer To-do No." := Todo."No.";
          Todo2."System To-do Type" := "System To-do Type"::"Contact Attendee";
        END;
        Todo2.INSERT(TRUE)
      END ELSE
        IF Todo."Team Code" <> '' THEN BEGIN
          Todo2."System To-do Type" := Todo2."System To-do Type"::Organizer;
          Todo2.VALIDATE("Salesperson Code",Attendee."Attendee No.");

          Todo2.INSERT(TRUE);
        END;
      EXIT(Todo2."No.")
    END;

    PROCEDURE DeleteAttendeeTodo@20(Attendee@1000 : Record 5199);
    VAR
      Todo@1001 : Record 5080;
    BEGIN
      IF FindAttendeeTodo(Todo,Attendee) THEN
        Todo.DELETE;
    END;

    PROCEDURE FindAttendeeTodo@25(VAR Todo@1000 : Record 5080;Attendee@1001 : Record 5199) : Boolean;
    BEGIN
      Todo.RESET;
      Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
      Todo.SETRANGE("Organizer To-do No.",Attendee."To-do No.");
      IF Attendee."Attendee Type" = Attendee."Attendee Type"::Contact THEN BEGIN
        Todo.SETRANGE("System To-do Type",Todo."System To-do Type"::"Contact Attendee");
        Todo.SETRANGE("Contact No.",Attendee."Attendee No.")
      END ELSE BEGIN
        Todo.SETRANGE("System To-do Type",Todo."System To-do Type"::"Salesperson Attendee");
        Todo.SETRANGE("Salesperson Code",Attendee."Attendee No.");
      END;
      EXIT(Todo.FIND('-'));
    END;

    LOCAL PROCEDURE CreateAttendeesFromTodo@19(VAR Attendee@1000 : Record 5199;Todo@1001 : Record 5080;TeamMeetingOrganizer@1008 : Code[10]);
    VAR
      Cont@1002 : Record 5050;
      Salesperson@1003 : Record 13;
      SegHeader@1004 : Record 5076;
      SegLine@1005 : Record 5077;
      Opp@1006 : Record 5092;
      AttendeeLineNo@1007 : Integer;
    BEGIN
      IF Todo."Segment No." = '' THEN BEGIN
        IF Todo.Type = Type::Meeting THEN
          IF Todo."Team Code" = '' THEN BEGIN
            IF Salesperson.GET(Todo."Salesperson Code") THEN
              Attendee.CreateAttendee(
                Attendee,
                Todo."No.",10000,Attendee."Attendance Type"::"To-do Organizer",
                Attendee."Attendee Type"::Salesperson,
                Salesperson.Code,TRUE)
          END ELSE
            Todo.CreateAttendeesFromTeam(
              Attendee,
              TeamMeetingOrganizer);

        IF Attendee.FIND('+') THEN
          AttendeeLineNo := Attendee."Line No." + 10000
        ELSE
          AttendeeLineNo := 10000;

        IF Cont.GET(Todo."Contact No.") THEN
          Attendee.CreateAttendee(
            Attendee,
            Todo."No.",AttendeeLineNo,Attendee."Attendance Type"::Required,
            Attendee."Attendee Type"::Contact,
            Cont."No.",Cont."E-Mail" <> '');
      END ELSE BEGIN
        IF Todo."Team Code" = '' THEN BEGIN
          IF Salesperson.GET(Todo."Salesperson Code") THEN
            Attendee.CreateAttendee(
              Attendee,
              Todo."No.",10000,Attendee."Attendance Type"::"To-do Organizer",
              Attendee."Attendee Type"::Salesperson,
              Salesperson.Code,TRUE);
        END ELSE
          Todo.CreateAttendeesFromTeam(Attendee,TransformFromCode20ToCode10(Todo."Team Meeting Organizer"));

        IF Attendee.FIND('+') THEN
          AttendeeLineNo := Attendee."Line No." + 10000
        ELSE
          AttendeeLineNo := 10000;

        IF Opp.GET(Todo."Opportunity No.") THEN
          Attendee.CreateAttendee(
            Attendee,
            Todo."No.",AttendeeLineNo,Attendee."Attendance Type"::Required,
            Attendee."Attendee Type"::Contact,
            Opp."Contact No.",
            (Cont.GET(Opp."Contact No.") AND
             (Cont."E-Mail" <> '')))
        ELSE
          IF SegHeader.GET(Todo."Segment No.") THEN BEGIN
            SegLine.SETRANGE("Segment No.",Todo."Segment No.");
            SegLine.SETFILTER("Contact No.",'=%1',Todo."Contact No.");
            IF SegLine.FIND('-') THEN
              REPEAT
                Attendee.CreateAttendee(
                  Attendee,
                  Todo."No.",AttendeeLineNo,Attendee."Attendance Type"::Required,
                  Attendee."Attendee Type"::Contact,
                  SegLine."Contact No.",
                  (Cont.GET(SegLine."Contact No.") AND
                   (Cont."E-Mail" <> '')));
                AttendeeLineNo := AttendeeLineNo + 10000;
              UNTIL SegLine.NEXT = 0;
          END;
      END;
    END;

    LOCAL PROCEDURE CreateTodoInteractLanguages@17(VAR TodoInteractLanguage@1000 : Record 5196;VAR Attachment@1001 : Record 5062;TodoNo@1002 : Code[20]);
    VAR
      TodoInteractLanguage2@1003 : Record 5196;
      Attachment2@1004 : Record 5062;
      MarketingSetup@1006 : Record 5079;
      AttachmentManagement@1005 : Codeunit 5052;
      FileName@1007 : Text;
    BEGIN
      IF TodoInteractLanguage.FIND('-') THEN
        REPEAT
          TodoInteractLanguage2.INIT;
          TodoInteractLanguage2."To-do No." := TodoNo;
          TodoInteractLanguage2."Language Code" := TodoInteractLanguage."Language Code";
          TodoInteractLanguage2.Description := TodoInteractLanguage.Description;
          IF TodoInteractLanguage."Attachment No." <> 0 THEN BEGIN
            Attachment.GET(TodoInteractLanguage."Attachment No.");
            Attachment2.GET(AttachmentManagement.InsertAttachment(0));
            Attachment2.TRANSFERFIELDS(Attachment,FALSE);
            Attachment.CALCFIELDS(Attachment);
            Attachment2.Attachment := Attachment.Attachment;
            Attachment2.WizSaveAttachment;
            Attachment2.MODIFY(TRUE);
            MarketingSetup.GET;
            IF MarketingSetup."Attachment Storage Type" = MarketingSetup."Attachment Storage Type"::"Disk File" THEN
              IF Attachment2."No." <> 0 THEN BEGIN
                FileName := Attachment2.ConstDiskFileName;
                IF FileName <> '' THEN
                  Attachment.ExportAttachmentToServerFile(FileName);
              END;
            TodoInteractLanguage2."Attachment No." := Attachment2."No.";
          END ELSE
            TodoInteractLanguage2."Attachment No." := 0;
          TodoInteractLanguage2.INSERT;
        UNTIL TodoInteractLanguage.NEXT = 0;
    END;

    PROCEDURE AssignActivityFromToDo@9(VAR ToDo@1007 : Record 5080);
    VAR
      Cont@1001 : Record 5050;
      SalesPurchPerson@1002 : Record 13;
      Team@1003 : Record 5083;
      Campaign@1004 : Record 5071;
      SegHeader@1005 : Record 5076;
      Opp@1006 : Record 5092;
    BEGIN
      INIT;

      IF Cont.GET(ToDo.GETFILTER("Contact Company No.")) THEN BEGIN
        VALIDATE("Contact No.",Cont."No.");
        "Salesperson Code" := Cont."Salesperson Code";
        SETRANGE("Contact Company No.","Contact No.");
      END;

      IF Cont.GET(ToDo.GETFILTER("Contact No.")) THEN BEGIN
        VALIDATE("Contact No.",Cont."No.");
        "Salesperson Code" := Cont."Salesperson Code";
        SETRANGE("Contact No.","Contact No.");
      END;

      IF SegHeader.GET(ToDo.GETFILTER("Segment No.")) THEN BEGIN
        VALIDATE("Segment No.",SegHeader."No.");
        "Campaign No." := SegHeader."Campaign No.";
        "Salesperson Code" := SegHeader."Salesperson Code";
        SETRANGE("Segment No.","Segment No.");
      END;

      IF SalesPurchPerson.GET(ToDo.GETFILTER("Salesperson Code")) THEN BEGIN
        "Salesperson Code" := SalesPurchPerson.Code;
        SETRANGE("Salesperson Code","Salesperson Code");
      END;

      IF Team.GET(ToDo.GETFILTER("Team Code")) THEN BEGIN
        "Team Code" := Team.Code;
        SETRANGE("Team Code","Team Code");
      END;

      IF Campaign.GET(ToDo.GETFILTER("Campaign No.")) THEN BEGIN
        "Campaign No." := Campaign."No.";
        "Salesperson Code" := Campaign."Salesperson Code";
        SETRANGE("Campaign No.","Campaign No.");
      END;

      IF Opp.GET(ToDo.GETFILTER("Opportunity No.")) THEN BEGIN
        VALIDATE("Opportunity No.",Opp."No.");
        "Contact No." := Opp."Contact No.";
        "Contact Company No." := Opp."Contact Company No.";
        "Campaign No." := Opp."Campaign No.";
        "Salesperson Code" := Opp."Salesperson Code";
        SETRANGE("Opportunity No.","Opportunity No.");
      END;

      StartWizard2;
    END;

    LOCAL PROCEDURE InsertActivityTodo@3(Todo2@1000 : Record 5080;ActivityCode@1001 : Code[10];VAR Attendee@1004 : Record 5199);
    VAR
      ActivityStep@1002 : Record 5082;
      TodoDate@1003 : Date;
    BEGIN
      TodoDate := Todo2.Date;
      ActivityStep.SETRANGE("Activity Code",ActivityCode);
      IF ActivityStep.FIND('-') THEN BEGIN
        REPEAT
          InsertActivityStepTodo(Todo2,ActivityStep,TodoDate,Attendee);
        UNTIL ActivityStep.NEXT = 0;
      END ELSE
        InsertActivityStepTodo(Todo2,ActivityStep,TodoDate,Attendee);
    END;

    LOCAL PROCEDURE InsertActivityStepTodo@22(Todo2@1010 : Record 5080;ActivityStep@1009 : Record 5082;TodoDate@1012 : Date;VAR Attendee2@1015 : Record 5199) TodoNo : Code[20];
    VAR
      TodoTemp@1011 : TEMPORARY Record 5080;
      InteractionTemplateSetup@1008 : Record 5122;
      InteractionTemplate@1007 : Record 5064;
      TodoInteractionLanguage@1006 : TEMPORARY Record 5196;
      Attachment@1005 : TEMPORARY Record 5062;
      AttendeeTemp@1004 : TEMPORARY Record 5199;
      RMCommentLine@1003 : TEMPORARY Record 5061;
    BEGIN
      TodoTemp.INIT;
      TodoTemp := Todo2;
      TodoTemp.INSERT;
      IF NOT ActivityStep.ISEMPTY THEN BEGIN
        TodoTemp.Type := ActivityStep.Type;
        TodoTemp.Priority := ActivityStep.Priority;
        TodoTemp.Description := ActivityStep.Description;
        TodoTemp.Date := CALCDATE(ActivityStep."Date Formula",TodoDate);
      END;

      IF TodoTemp.Type = Type::Meeting THEN BEGIN
        IF NOT Attendee2.ISEMPTY THEN BEGIN
          Attendee2.SETRANGE("Attendance Type",Attendee2."Attendance Type"::"To-do Organizer");
          Attendee2.FIND('-')
        END;
        AttendeeTemp.DELETEALL;
        TodoTemp.VALIDATE("All Day Event",TRUE);

        InteractionTemplateSetup.GET;
        IF (InteractionTemplateSetup."Meeting Invitation" <> '') AND
           InteractionTemplate.GET(InteractionTemplateSetup."Meeting Invitation")
        THEN
          UpdateInteractionTemplate(
            TodoTemp,TodoInteractionLanguage,Attachment,InteractionTemplate.Code,TRUE);

        CreateAttendeesFromTodo(AttendeeTemp,TodoTemp,Attendee2."Attendee No.");

        TodoTemp.VALIDATE("Contact No.",'');

        TodoNo := InsertTodoAndRelatedData(
            TodoTemp,TodoInteractionLanguage,
            Attachment,AttendeeTemp,RMCommentLine);
      END ELSE BEGIN
        AttendeeTemp.DELETEALL;
        CreateAttendeesFromTodo(AttendeeTemp,TodoTemp,'');

        InsertTodoAndRelatedData(
          TodoTemp,TodoInteractionLanguage,
          Attachment,AttendeeTemp,RMCommentLine);
      END;
      TodoTemp.DELETE;
    END;

    PROCEDURE CancelOpenTodos@6(OpportunityNo@1000 : Code[20]);
    VAR
      OldTodo@1001 : Record 5080;
      OldTodo2@1002 : Record 5080;
    BEGIN
      IF OpportunityNo = '' THEN
        EXIT;

      OldTodo.RESET;
      OldTodo.SETCURRENTKEY("Opportunity No.");
      OldTodo.SETRANGE("Opportunity No.",OpportunityNo);
      OldTodo.SETRANGE(Closed,FALSE);
      OldTodo.SETRANGE(Canceled,FALSE);

      IF OldTodo.FIND('-') THEN
        REPEAT
          OldTodo2.GET(OldTodo."No.");
          OldTodo2.Recurring := FALSE;
          OldTodo2.VALIDATE(Canceled,TRUE);
          OldTodo2.MODIFY;
        UNTIL OldTodo.NEXT = 0;
    END;

    LOCAL PROCEDURE CreateCommentLines@7(VAR RMCommentLineTmp@1001 : Record 5061;TodoNo@1000 : Code[20]);
    BEGIN
      IF RMCommentLineTmp.FIND('-') THEN
        REPEAT
          RMCommentLine.INIT;
          RMCommentLine := RMCommentLineTmp;
          RMCommentLine."No." := TodoNo;
          RMCommentLine.INSERT;
        UNTIL RMCommentLineTmp.NEXT = 0;
    END;

    PROCEDURE SetDuration@16(EndingDate@1000 : Date;EndingTime@1001 : Time);
    BEGIN
      IF (EndingDate < 01011900D) OR (EndingDate > 31122999D) THEN
        ERROR(Text006,01011900D,31122999D);
      IF NOT "All Day Event" AND (Type = Type::Meeting) THEN
        Duration := CREATEDATETIME(EndingDate,EndingTime) - CREATEDATETIME(Date,"Start Time")
      ELSE
        Duration := CREATEDATETIME(EndingDate + 1,0T) - CREATEDATETIME(Date,0T);

      VALIDATE(Duration);
    END;

    PROCEDURE GetEndDateTime@18();
    BEGIN
      IF (Type <> Type::Meeting) OR "All Day Event" THEN BEGIN
        IF "Start Time" <> 0T THEN
          TempEndDateTime := CREATEDATETIME(Date - 1,"Start Time") + Duration
        ELSE
          TempEndDateTime := CREATEDATETIME(Date,0T) + Duration;
      END ELSE
        TempEndDateTime := CREATEDATETIME(Date,"Start Time") + Duration;

      "Ending Date" := DT2DATE(TempEndDateTime);
      "Ending Time" := DT2TIME(TempEndDateTime);
    END;

    LOCAL PROCEDURE UpdateAttendeeTodos@12(OldTodoNo@1003 : Code[20]);
    VAR
      Todo2@1001 : Record 5080;
      TodoBuffer@1002 : TEMPORARY Record 5080;
    BEGIN
      Todo2.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
      Todo2.SETRANGE("Organizer To-do No.",OldTodoNo);
      IF "Team Code" = '' THEN
        Todo2.SETFILTER(
          "System To-do Type",
          '%1|%2',
          Todo2."System To-do Type"::"Salesperson Attendee",
          Todo2."System To-do Type"::"Contact Attendee")
      ELSE
        Todo2.SETFILTER("System To-do Type",'<>%1',Todo2."System To-do Type"::Team);
      IF Todo2.FIND('-') THEN
        REPEAT
          TodoBuffer.INIT;
          TodoBuffer.TRANSFERFIELDS(Todo2,FALSE);
          TodoBuffer.INSERT;
          Todo2.TRANSFERFIELDS(Rec,FALSE);
          Todo2."System To-do Type" := TodoBuffer."System To-do Type";
          IF Todo2."System To-do Type" = Todo2."System To-do Type"::"Contact Attendee" THEN
            Todo2.VALIDATE("Contact No.",TodoBuffer."Contact No.")
          ELSE
            Todo2."Salesperson Code" := TodoBuffer."Salesperson Code";
          IF Todo2."No." <> OldTodoNo THEN
            Todo2.MODIFY(TRUE);
          TodoBuffer.DELETE;
        UNTIL Todo2.NEXT = 0
    END;

    LOCAL PROCEDURE UpdateInteractionTemplate@13(VAR Todo@1004 : Record 5080;VAR TodoInteractionLanguage@1007 : Record 5196;VAR Attachment@1001 : Record 5062;InteractTmplCode@1006 : Code[10];AttachmentTemporary@1005 : Boolean);
    VAR
      InteractTmpl@1002 : Record 5064;
      InteractTemplLanguage@1008 : Record 5103;
      Attachment2@1003 : Record 5062;
      AttachmentManagement@1000 : Codeunit 5052;
    BEGIN
      Todo.MODIFY;
      TodoInteractionLanguage.SETRANGE("To-do No.",Todo."No.");

      IF AttachmentTemporary THEN
        TodoInteractionLanguage.DELETEALL
      ELSE
        TodoInteractionLanguage.DELETEALL(TRUE);

      Todo."Interaction Template Code" := InteractTmplCode;

      IF InteractTmpl.GET(Todo."Interaction Template Code") THEN BEGIN
        Todo."Language Code" := InteractTmpl."Language Code (Default)";
        Todo.Subject := InteractTmpl.Description;
        Todo."Unit Cost (LCY)" := InteractTmpl."Unit Cost (LCY)";
        Todo."Unit Duration (Min.)" := InteractTmpl."Unit Duration (Min.)";
        IF Todo."Campaign No." = '' THEN
          Todo."Campaign No." := InteractTmpl."Campaign No.";

        IF AttachmentTemporary THEN
          Attachment.DELETEALL;

        InteractTemplLanguage.RESET;
        InteractTemplLanguage.SETRANGE("Interaction Template Code",Todo."Interaction Template Code");
        IF InteractTemplLanguage.FIND('-') THEN
          REPEAT
            TodoInteractionLanguage.INIT;
            TodoInteractionLanguage."To-do No." := Todo."No.";
            TodoInteractionLanguage."Language Code" := InteractTemplLanguage."Language Code";
            TodoInteractionLanguage.Description := InteractTemplLanguage.Description;
            IF Attachment2.GET(InteractTemplLanguage."Attachment No.") THEN BEGIN
              IF AttachmentTemporary THEN BEGIN
                Attachment.INIT;
                IF Attachment2."Storage Type" = Attachment2."Storage Type"::Embedded THEN
                  Attachment2.CALCFIELDS(Attachment);
                Attachment.TRANSFERFIELDS(Attachment2);
                Attachment.INSERT;
                TodoInteractionLanguage."Attachment No." := Attachment."No.";
              END ELSE
                TodoInteractionLanguage."Attachment No." :=
                  AttachmentManagement.InsertAttachment(InteractTemplLanguage."Attachment No.");
            END;
            TodoInteractionLanguage.INSERT;
          UNTIL InteractTemplLanguage.NEXT = 0
        ELSE
          Todo."Attachment No." := 0;
      END ELSE BEGIN
        Todo."Language Code" := '';
        Todo.Subject := '';
        Todo."Unit Cost (LCY)" := 0;
        Todo."Unit Duration (Min.)" := 0;
        Todo."Attachment No." := 0;
      END;

      IF TodoInteractionLanguage.GET(Todo."No.",Todo."Language Code") THEN
        Todo."Attachment No." := TodoInteractionLanguage."Attachment No.";

      Todo.MODIFY;
    END;

    PROCEDURE SendMAPIInvitations@21(Todo@1000 : Record 5080;FromWizard@1019 : Boolean);
    VAR
      Attendee@1001 : Record 5199;
      Todo2@1002 : Record 5080;
      Salesperson@1004 : Record 13;
      Salesperson2@1013 : Record 13;
      Mail@1012 : Codeunit 397;
      Body@1015 : Text[260];
      NoToSend@1014 : Integer;
      NoNotSent@1016 : Integer;
      Selected@1018 : Integer;
      Options@1017 : Text[1024];
    BEGIN
      IF Todo."System To-do Type" <> Todo."System To-do Type"::Organizer THEN
        Todo.GetMeetingOrganizerTodo(Todo);
      IF Todo."Attachment No." = 0 THEN BEGIN
        Attendee.SETRANGE("To-do No.",Todo."Organizer To-do No.");
        Attendee.SETRANGE("Send Invitation",TRUE);
        Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Contact);
        IF Attendee.FIND('-') THEN BEGIN
          Attendee.SETCURRENTKEY("To-do No.","Attendance Type");
          Attendee.SETRANGE("Send Invitation");
          Attendee.SETRANGE("Attendee Type");
          Attendee.SETRANGE("Attendance Type",Attendee."Attendance Type"::"To-do Organizer");
          IF Attendee.FIND('-') THEN
            ERROR(Text067,Todo.TABLECAPTION,Attendee.TABLECAPTION)
        END;
        Attendee.RESET;
      END;

      Attendee.SETRANGE("To-do No.",Todo."Organizer To-do No.");
      Attendee.SETFILTER("Attendance Type",'<>%1',Attendee."Attendance Type"::"To-do Organizer");
      Attendee.SETRANGE("Send Invitation",TRUE);

      IF NOT FromWizard THEN BEGIN
        NoToSend := Attendee.COUNT;
        Attendee.SETRANGE("Invitation Sent",FALSE);
        NoNotSent := Attendee.COUNT;
        IF NoToSend = 0 THEN
          ERROR(Text018,Attendee.FIELDCAPTION("Send Invitation"));
        IF (NoToSend > NoNotSent) AND (NoNotSent <> 0) THEN BEGIN
          Options :=
            STRSUBSTNO(
              Text019,Attendee.FIELDCAPTION("Send Invitation")) + ',' +
            STRSUBSTNO(
              Text020,Attendee.FIELDCAPTION("Send Invitation")) + ',' +
            Text021;
          Selected := STRMENU(Options,1);
          IF Selected IN [0,3] THEN
            ERROR('');
        END;
        IF NoNotSent = 0 THEN BEGIN
          IF NOT CONFIRM(
               STRSUBSTNO(
                 Text022,Attendee.FIELDCAPTION("Send Invitation")),FALSE)
          THEN
            ERROR('');
        END;
        IF NoToSend = NoNotSent THEN BEGIN
          IF NOT CONFIRM(STRSUBSTNO(Text019,Attendee.FIELDCAPTION("Send Invitation")),FALSE) THEN
            ERROR('');
        END;

        Attendee.RESET;
        Attendee.SETRANGE("To-do No.",Todo."Organizer To-do No.");
        Attendee.SETRANGE("Send Invitation",TRUE);
        IF Selected = 2 THEN
          Attendee.SETRANGE("Invitation Sent",FALSE);
      END;

      IF Attendee.FIND('-') THEN
        REPEAT
          IF FindAttendeeTodo(Todo2,Attendee) THEN
            IF Attendee."Attendee Type" = Attendee."Attendee Type"::Salesperson
            THEN BEGIN
              IF Salesperson2.GET(Todo2."Salesperson Code") AND
                 Salesperson.GET(Todo."Salesperson Code")
              THEN BEGIN
                Body :=
                  STRSUBSTNO(Text015,Salesperson2.Name) + '<br/><br/>' +
                  STRSUBSTNO(Text016,FORMAT(Todo.Date),FORMAT(Todo."Start Time"),FORMAT(Todo.Location)) + '<br/><br/>' +
                  Text017 + '<br/>' +
                  Salesperson.Name + '<br/>' +
                  FORMAT(TODAY) + ' ' + FORMAT(TIME);
                IF Mail.NewMessage(
                     Salesperson2."E-Mail",'','',Todo2.Description,
                     Body,'',FALSE)
                THEN BEGIN
                  Attendee."Invitation Sent" := TRUE;
                  Attendee.MODIFY;
                END ELSE
                  MESSAGE(Text023,Attendee."Attendee Name");
              END;
            END ELSE BEGIN
              LogTodoInteraction(Todo,Todo2,TRUE);

              Attendee."Invitation Sent" := TRUE;
              Attendee.MODIFY;
            END;
        UNTIL Attendee.NEXT = 0;
    END;

    PROCEDURE CreateAttachment@23(PageNotEditable@1000 : Boolean);
    VAR
      TodoInteractionLanguage@1001 : Record 5196;
    BEGIN
      IF "Interaction Template Code" = '' THEN
        EXIT;
      IF NOT TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN BEGIN
        TodoInteractionLanguage.INIT;
        TodoInteractionLanguage."To-do No." := "Organizer To-do No.";
        TodoInteractionLanguage."Language Code" := "Language Code";
        TodoInteractionLanguage.INSERT(TRUE);
      END;
      IF TodoInteractionLanguage.CreateAttachment(PageNotEditable) THEN BEGIN
        "Attachment No." := TodoInteractionLanguage."Attachment No.";
        MODIFY(TRUE);
      END;
    END;

    PROCEDURE OpenAttachment@24(PageNotEditable@1000 : Boolean);
    VAR
      TodoInteractionLanguage@1001 : Record 5196;
    BEGIN
      IF "Interaction Template Code" = '' THEN
        EXIT;
      IF TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN
        IF TodoInteractionLanguage."Attachment No." <> 0 THEN
          TodoInteractionLanguage.OpenAttachment(PageNotEditable);
      MODIFY(TRUE);
    END;

    PROCEDURE ImportAttachment@26();
    VAR
      TodoInteractionLanguage@1000 : Record 5196;
    BEGIN
      IF "Interaction Template Code" = '' THEN
        EXIT;

      IF NOT TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN BEGIN
        TodoInteractionLanguage.INIT;
        TodoInteractionLanguage."To-do No." := "Organizer To-do No.";
        TodoInteractionLanguage."Language Code" := "Language Code";
        TodoInteractionLanguage.INSERT(TRUE);
      END;
      TodoInteractionLanguage.ImportAttachment;
      "Attachment No." := TodoInteractionLanguage."Attachment No.";
      MODIFY(TRUE);
    END;

    PROCEDURE ExportAttachment@27();
    VAR
      TodoInteractionLanguage@1000 : Record 5196;
    BEGIN
      IF "Interaction Template Code" = '' THEN
        EXIT;

      IF TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN
        IF TodoInteractionLanguage."Attachment No." <> 0 THEN
          TodoInteractionLanguage.ExportAttachment;
    END;

    PROCEDURE RemoveAttachment@28(Prompt@1000 : Boolean);
    VAR
      TodoInteractionLanguage@1001 : Record 5196;
    BEGIN
      IF "Interaction Template Code" = '' THEN
        EXIT;

      IF TodoInteractionLanguage.GET("Organizer To-do No.","Language Code") THEN
        IF TodoInteractionLanguage."Attachment No." <> 0 THEN
          IF TodoInteractionLanguage.RemoveAttachment(Prompt) THEN BEGIN
            "Attachment No." := 0;
            MODIFY(TRUE);
          END;
      MODIFY(TRUE);
    END;

    LOCAL PROCEDURE LogTodoInteraction@30(VAR Todo@1006 : Record 5080;VAR Todo2@1000 : Record 5080;Deliver@1010 : Boolean);
    VAR
      SegLine@1001 : TEMPORARY Record 5077;
      Cont@1002 : Record 5050;
      Salesperson@1003 : Record 13;
      Campaign@1004 : Record 5071;
      Attachment@1007 : Record 5062;
      AttachmentTemp@1008 : TEMPORARY Record 5062;
      InterLogEntryCommentLineTmp@1009 : TEMPORARY Record 5123;
      SegManagement@1005 : Codeunit 5051;
    BEGIN
      IF Attachment.GET(Todo."Attachment No.") THEN BEGIN
        AttachmentTemp.DELETEALL;
        AttachmentTemp.INIT;
        AttachmentTemp.WizEmbeddAttachment(Attachment);
        AttachmentTemp.INSERT;
      END;

      SegLine.DELETEALL;
      SegLine.INIT;
      SegLine."To-do No." := Todo."Organizer To-do No.";
      SegLine.SETRANGE("To-do No.",SegLine."To-do No.");
      IF Cont.GET(Todo2."Contact No.") THEN
        SegLine.VALIDATE("Contact No.",Todo2."Contact No.");
      IF Salesperson.GET(Todo."Salesperson Code") THEN
        SegLine."Salesperson Code" := Salesperson.Code;
      IF Campaign.GET(Todo."Campaign No.") THEN
        SegLine."Campaign No." := Campaign."No.";
      SegLine."Interaction Template Code" := Todo."Interaction Template Code";
      SegLine."Attachment No." := Todo."Attachment No.";
      SegLine."Language Code" := Todo."Language Code";
      SegLine.Subject := Todo.Description;
      SegLine.Description := Todo.Description;
      SegLine."Correspondence Type" := SegLine."Correspondence Type"::"E-Mail";
      SegLine."Cost (LCY)" := Todo."Unit Cost (LCY)";
      SegLine."Duration (Min.)" := Todo."Unit Duration (Min.)";
      SegLine."Opportunity No." := Todo."Opportunity No.";
      SegLine.VALIDATE(Date,WORKDATE);

      SegLine.INSERT;
      SegManagement.LogInteraction(SegLine,AttachmentTemp,InterLogEntryCommentLineTmp,Deliver,FALSE);
    END;

    PROCEDURE CreateAttendeesFromTeam@33(VAR Attendee@1002 : Record 5199;TeamMeetingOrganizer@1000 : Code[10]);
    VAR
      TeamSalesperson@1003 : Record 5084;
      AttendeeLineNo@1004 : Integer;
    BEGIN
      IF TeamMeetingOrganizer = '' THEN
        EXIT;
      Attendee.CreateAttendee(
        Attendee,
        "No.",10000,Attendee."Attendance Type"::"To-do Organizer",
        Attendee."Attendee Type"::Salesperson,
        TeamMeetingOrganizer,
        TRUE);

      TeamSalesperson.SETRANGE("Team Code","Team Code");
      IF TeamSalesperson.FIND('-') THEN BEGIN
        AttendeeLineNo := 20000;
        REPEAT
          IF TeamSalesperson."Salesperson Code" <> TeamMeetingOrganizer THEN
            Attendee.CreateAttendee(
              Attendee,
              "No.",AttendeeLineNo,Attendee."Attendance Type"::Required,
              Attendee."Attendee Type"::Salesperson,
              TeamSalesperson."Salesperson Code",
              FALSE);
          AttendeeLineNo := AttendeeLineNo + 10000;
        UNTIL TeamSalesperson.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ChangeTeam@37();
    VAR
      Todo@1000 : Record 5080;
      TeamSalesperson@1001 : Record 5084;
      TeamSalespersonOld@1004 : Record 5084;
      AttendeeTemp@1002 : TEMPORARY Record 5199;
      Attendee@1003 : Record 5199;
      Salesperson@1007 : Record 13;
      AttendeeLineNo@1005 : Integer;
      SendInvitation@1006 : Boolean;
      TeamCode@1009 : Code[10];
    BEGIN
      MODIFY;
      TeamSalespersonOld.SETRANGE("Team Code",xRec."Team Code");
      TeamSalesperson.SETRANGE("Team Code","Team Code");
      IF TeamSalesperson.FIND('-') THEN
        REPEAT
          TeamSalesperson.MARK(TRUE)
        UNTIL TeamSalesperson.NEXT = 0;

      IF Type = Type::Meeting THEN BEGIN
        Attendee.SETCURRENTKEY("To-do No.","Attendee Type","Attendee No.");
        Attendee.SETRANGE("To-do No.","Organizer To-do No.");
        Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Salesperson);
        IF Attendee.FIND('-') THEN
          REPEAT
            TeamSalesperson.SETRANGE("Salesperson Code",Attendee."Attendee No.");
            IF TeamSalesperson.FIND('-') THEN
              TeamSalesperson.MARK(FALSE)
            ELSE
              IF Attendee."Attendance Type" <> Attendee."Attendance Type"::"To-do Organizer" THEN BEGIN
                TeamSalespersonOld.SETRANGE("Salesperson Code",Attendee."Attendee No.");
                IF TeamSalespersonOld.FINDFIRST THEN BEGIN
                  Attendee.MARK(TRUE);
                  DeleteAttendeeTodo(Attendee)
                END
              END
          UNTIL Attendee.NEXT = 0;
        Attendee.MARKEDONLY(TRUE);
        Attendee.DELETEALL
      END ELSE BEGIN
        Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
        Todo.SETRANGE("Organizer To-do No.","Organizer To-do No.");
        Todo.SETFILTER("System To-do Type",'%1|%2',
          Todo."System To-do Type"::Organizer,
          Todo."System To-do Type"::"Salesperson Attendee");
        IF Todo.FIND('-') THEN
          REPEAT
            TeamSalesperson.SETRANGE("Salesperson Code",Todo."Salesperson Code");
            IF TeamSalesperson.FIND('-') THEN
              TeamSalesperson.MARK(FALSE)
            ELSE
              Todo.DELETE(TRUE)
          UNTIL Todo.NEXT = 0
      END;

      TeamCode := "Team Code";
      GET("No.");
      "Team Code" := TeamCode;

      TeamSalesperson.MARKEDONLY(TRUE);
      TeamSalesperson.SETRANGE("Salesperson Code");
      IF TeamSalesperson.FIND('-') THEN BEGIN
        IF Type = Type::Meeting THEN
          REPEAT
            Attendee.RESET;
            Attendee.SETRANGE("To-do No.","Organizer To-do No.");
            IF Attendee.FIND('+') THEN
              AttendeeLineNo := Attendee."Line No." + 10000
            ELSE
              AttendeeLineNo := 10000;
            IF Salesperson.GET(TeamSalesperson."Salesperson Code") THEN
              IF Salesperson."E-Mail" <> '' THEN
                SendInvitation := TRUE
              ELSE
                SendInvitation := FALSE;
            Attendee.CreateAttendee(
              Attendee,
              "Organizer To-do No.",AttendeeLineNo,
              Attendee."Attendance Type"::Required,
              Attendee."Attendee Type"::Salesperson,
              TeamSalesperson."Salesperson Code",SendInvitation);
            CreateSubTodo(Attendee,Rec)
          UNTIL TeamSalesperson.NEXT = 0
        ELSE
          REPEAT
            AttendeeTemp.CreateAttendee(
              AttendeeTemp,
              "No.",10000,
              AttendeeTemp."Attendance Type"::"To-do Organizer",
              AttendeeTemp."Attendee Type"::Salesperson,
              TeamSalesperson."Salesperson Code",
              TRUE);
            CreateSubTodo(AttendeeTemp,Rec);
            AttendeeTemp.DELETEALL
          UNTIL TeamSalesperson.NEXT = 0
      END;
      MODIFY(TRUE)
    END;

    LOCAL PROCEDURE ReassignTeamTodoToSalesperson@38();
    VAR
      Todo@1000 : Record 5080;
      Attendee@1001 : Record 5199;
      AttendeeLineNo@1002 : Integer;
      SalespersonCode@1005 : Code[10];
    BEGIN
      MODIFY;
      IF Type = Type::Meeting THEN BEGIN
        Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
        Todo.SETRANGE("Organizer To-do No.","No.");
        Todo.SETRANGE("Salesperson Code","Salesperson Code");
        IF Todo.FINDFIRST THEN BEGIN
          Attendee.SETCURRENTKEY("To-do No.","Attendee Type","Attendee No.");
          Attendee.SETRANGE("To-do No.","No.");
          Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Salesperson);
          Attendee.SETRANGE("Attendee No.","Salesperson Code");
          IF Attendee.FINDFIRST THEN
            IF Attendee."Attendance Type" = Attendee."Attendance Type"::"To-do Organizer" THEN BEGIN
              Attendee.DELETE;
              Todo.DELETE;
            END ELSE
              Attendee.DELETE(TRUE)
        END;

        SalespersonCode := "Salesperson Code";
        GET("No.");
        "Salesperson Code" := SalespersonCode;

        Todo.SETRANGE("Salesperson Code");
        Todo.SETRANGE("System To-do Type","System To-do Type"::Organizer);
        IF Todo.FINDFIRST THEN BEGIN
          Attendee.RESET;
          Attendee.SETCURRENTKEY("To-do No.","Attendee Type","Attendee No.");
          Attendee.SETRANGE("To-do No.","No.");
          Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Salesperson);
          Attendee.SETRANGE("Attendee No.",Todo."Salesperson Code");
          IF Attendee.FINDFIRST THEN BEGIN
            Attendee."Attendance Type" := Attendee."Attendance Type"::Required;
            Attendee.MODIFY
          END;
          Todo."System To-do Type" := Todo."System To-do Type"::"Salesperson Attendee";
          Todo.MODIFY(TRUE)
        END;

        Attendee.RESET;
        Attendee.SETRANGE("To-do No.","No.");
        IF Attendee.FINDLAST THEN
          AttendeeLineNo := Attendee."Line No." + 10000
        ELSE
          AttendeeLineNo := 10000;
        Attendee.CreateAttendee(
          Attendee,"No.",AttendeeLineNo,
          Attendee."Attendance Type"::"To-do Organizer",
          Attendee."Attendee Type"::Salesperson,
          "Salesperson Code",TRUE);
        ArrangeOrganizerAttendee;
      END ELSE BEGIN
        Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
        Todo.SETRANGE("Organizer To-do No.","No.");
        Todo.SETRANGE("System To-do Type","System To-do Type"::Organizer);
        IF Todo.FINDFIRST THEN
          Todo.DELETEALL(TRUE);

        IF "Contact No." <> '' THEN BEGIN
          Todo.SETRANGE("System To-do Type","System To-do Type"::"Contact Attendee");
          IF Todo.FINDFIRST THEN BEGIN
            Todo."Salesperson Code" := "Salesperson Code";
            Todo.MODIFY(TRUE)
          END
        END
      END;

      "System To-do Type" := "System To-do Type"::Organizer;
      "Team Code" := '';
      MODIFY(TRUE);
    END;

    LOCAL PROCEDURE ReassignSalespersonTodoToTeam@36();
    VAR
      TeamSalesperson@1000 : Record 5084;
      Attendee@1001 : Record 5199;
      AttendeeTemp@1002 : TEMPORARY Record 5199;
      Todo@1003 : Record 5080;
      AttendeeLineNo@1004 : Integer;
      SendInvitation@1005 : Boolean;
      SalespersonCode@1006 : Code[10];
      TodoNo@1007 : Code[20];
    BEGIN
      MODIFY;
      SalespersonCode := "Salesperson Code";
      "Salesperson Code" := '';
      "System To-do Type" := "System To-do Type"::Team;
      MODIFY;

      Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
      Todo.SETRANGE("Organizer To-do No.","No.");

      IF Type = Type::Meeting THEN BEGIN
        Attendee.SETRANGE("To-do No.","No.");
        Attendee.SETRANGE("Attendance Type",Attendee."Attendance Type"::"To-do Organizer");
        IF Attendee.FINDFIRST THEN BEGIN
          Attendee."Attendance Type" := Attendee."Attendance Type"::Required;
          TodoNo := CreateSubTodo(Attendee,Rec);
          Attendee."Attendance Type" := Attendee."Attendance Type"::"To-do Organizer";
          Attendee.MODIFY;
          IF Todo.GET(TodoNo) THEN BEGIN
            Todo."System To-do Type" := Todo."System To-do Type"::Organizer;
            Todo.MODIFY;
          END
        END;

        Todo.SETFILTER("System To-do Type",'<>%1',Todo."System To-do Type"::"Contact Attendee");
        TeamSalesperson.SETRANGE("Team Code","Team Code");
        IF TeamSalesperson.FIND('-') THEN
          REPEAT
            Todo.SETRANGE("Salesperson Code",TeamSalesperson."Salesperson Code");
            IF Todo.FINDFIRST THEN BEGIN
              IF (Todo."System To-do Type" = Todo."System To-do Type"::Organizer) AND
                 (Todo."Salesperson Code" <> SalespersonCode)
              THEN BEGIN
                Todo."System To-do Type" := Todo."System To-do Type"::"Salesperson Attendee";
                MODIFY(TRUE)
              END
            END ELSE BEGIN
              Attendee.RESET;
              Attendee.SETRANGE("To-do No.","No.");
              IF Attendee.FINDLAST THEN
                AttendeeLineNo := Attendee."Line No." + 10000
              ELSE
                AttendeeLineNo := 10000;
              IF Salesperson.GET(TeamSalesperson."Salesperson Code") THEN
                IF Salesperson."E-Mail" <> '' THEN
                  SendInvitation := TRUE
                ELSE
                  SendInvitation := FALSE;
              Attendee.CreateAttendee(
                Attendee,"No.",AttendeeLineNo,
                Attendee."Attendance Type"::Required,
                Attendee."Attendee Type"::Salesperson,
                TeamSalesperson."Salesperson Code",
                SendInvitation);
              CreateSubTodo(Attendee,Rec)
            END
          UNTIL TeamSalesperson.NEXT = 0
      END ELSE BEGIN
        TeamSalesperson.SETRANGE("Team Code","Team Code");
        IF TeamSalesperson.FIND('-') THEN
          REPEAT
            AttendeeTemp.CreateAttendee(
              AttendeeTemp,
              "No.",10000,
              AttendeeTemp."Attendance Type"::"To-do Organizer",
              AttendeeTemp."Attendee Type"::Salesperson,
              TeamSalesperson."Salesperson Code",
              TRUE);
            CreateSubTodo(AttendeeTemp,Rec);
            AttendeeTemp.DELETEALL
          UNTIL TeamSalesperson.NEXT = 0;
      END;

      MODIFY(TRUE)
    END;

    PROCEDURE GetMeetingOrganizerTodo@39(VAR Todo@1000 : Record 5080);
    BEGIN
      IF Type = Type::Meeting THEN
        IF "Team Code" <> '' THEN BEGIN
          Todo.SETCURRENTKEY("Organizer To-do No.","System To-do Type");
          Todo.SETRANGE("Organizer To-do No.","Organizer To-do No.");
          Todo.SETRANGE("System To-do Type","System To-do Type"::Organizer);
          Todo.FIND('-')
        END ELSE
          Todo.GET("Organizer To-do No.")
    END;

    PROCEDURE ArrangeOrganizerAttendee@40();
    VAR
      Attendee@1000 : Record 5199;
      FirstLineNo@1001 : Integer;
      LastLineNo@1002 : Integer;
      OrganizerLineNo@1003 : Integer;
    BEGIN
      Attendee.SETRANGE("To-do No.","No.");
      IF NOT Attendee.FINDFIRST THEN
        EXIT;
      FirstLineNo := Attendee."Line No.";
      Attendee.FINDLAST;
      LastLineNo := Attendee."Line No.";

      Attendee.SETCURRENTKEY("To-do No.","Attendance Type");
      Attendee.SETRANGE("Attendance Type",Attendee."Attendance Type"::"To-do Organizer");
      Attendee.FINDFIRST;
      OrganizerLineNo := Attendee."Line No.";

      IF FirstLineNo <> OrganizerLineNo THEN BEGIN
        Attendee.RENAME("No.",LastLineNo + 1);
        Attendee.GET("No.",FirstLineNo);
        Attendee.RENAME("No.",OrganizerLineNo);
        Attendee.GET("No.",LastLineNo + 1);
        Attendee.RENAME("No.",FirstLineNo)
      END
    END;

    LOCAL PROCEDURE StartWizard@48();
    BEGIN
      "Wizard Step" := "Wizard Step"::"1";

      "Wizard Contact Name" := GetContactName;
      IF Campaign.GET("Campaign No.") THEN
        "Wizard Campaign Description" := Campaign.Description;
      IF Opp.GET("Opportunity No.") THEN
        "Wizard Opportunity Description" := Opp.Description;
      IF SegHeader.GET(GETFILTER("Segment No.")) THEN
        "Segment Description" := SegHeader.Description;
      IF Team.GET(GETFILTER("Team Code")) THEN
        "Team To-do" := TRUE;

      Duration := 1440 * 1000 * 60;
      Date := TODAY;
      GetEndDateTime;

      INSERT;
      PAGE.RUNMODAL(PAGE::"Create To-do",Rec);
    END;

    PROCEDURE PerformNextWizardStatus@43();
    BEGIN
      CASE "Wizard Step" OF
        "Wizard Step"::"1":
          BEGIN
            {
            IF Type <> xRec.Type THEN
              IF Type = Type::Meeting THEN BEGIN
                AssignDefaultAttendeeInfo;
                LoadTempAttachment;
              END ELSE
                ClearDefaultAttendeeInfo;
            }
            IF (Type = Type::Meeting) AND
               (NOT "Team To-do" OR
                (GETFILTER("Team Code") <> ''))
            THEN
              "Wizard Step" := "Wizard Step"::"3"
            ELSE
              "Wizard Step" := "Wizard Step"::"2";
          END;
        "Wizard Step"::"2":
          IF Type <> Type::Meeting THEN
            "Wizard Step" := "Wizard Step"::"4"
          ELSE
            "Wizard Step" := "Wizard Step"::"3";
        ELSE
          "Wizard Step" := "Wizard Step" + 1;
      END;

      IF "Wizard Step" = "Wizard Step"::"3" THEN
        IF NOT "Team To-do" THEN
          IF "Salesperson Code" = '' THEN BEGIN
            IF Cont.GET("Contact No.") THEN
              VALIDATE("Salesperson Code",Cont."Salesperson Code")
            ELSE
              IF Cont.GET("Contact Company No.") THEN
                VALIDATE("Salesperson Code",Cont."Salesperson Code");
            IF Campaign.GET(GETFILTER("Campaign No.")) THEN
              VALIDATE("Salesperson Code",Campaign."Salesperson Code");
            IF Opp.GET(GETFILTER("Opportunity No.")) THEN
              VALIDATE("Salesperson Code",Opp."Salesperson Code");
            IF SegHeader.GET(GETFILTER("Segment No.")) THEN
              VALIDATE("Salesperson Code",SegHeader."Salesperson Code");
            MODIFY;
          END;
    END;

    PROCEDURE PerformPrevWizardStatus@52();
    BEGIN
      CASE "Wizard Step" OF
        "Wizard Step"::"3":
          BEGIN
            IF (Type = Type::Meeting) AND
               (NOT "Team To-do" OR
                (GETFILTER("Team Code") <> ''))
            THEN
              "Wizard Step" := "Wizard Step"::"1"
            ELSE
              "Wizard Step" := "Wizard Step"::"2";
          END;
        "Wizard Step"::"4":
          IF Type <> Type::Meeting THEN
            "Wizard Step" := "Wizard Step"::"2"
          ELSE
            "Wizard Step" := "Wizard Step"::"3";
        ELSE
          "Wizard Step" := "Wizard Step" - 1;
      END;
    END;

    PROCEDURE CheckStatus@42() : Boolean;
    BEGIN
      CASE "Wizard Step" OF
        "Wizard Step"::"1":
          BEGIN
            IF Date = 0D THEN
              ErrorMessage(FIELDCAPTION(Date));
            IF Description = '' THEN
              ErrorMessage(FIELDCAPTION(Description));
            IF (Type = Type::Meeting) AND (NOT "All Day Event") THEN BEGIN
              IF "Start Time" = 0T THEN
                ErrorMessage(FIELDCAPTION("Start Time"));
              IF Duration = 0 THEN
                ErrorMessage(FIELDCAPTION(Duration));
            END;
          END;
        "Wizard Step"::"2":
          BEGIN
            IF "Team To-do" AND ("Team Code" = '') THEN
              ErrorMessage(FIELDCAPTION("Team Code"));
            IF NOT "Team To-do" AND ("Salesperson Code" = '') THEN
              ErrorMessage(FIELDCAPTION("Salesperson Code"));
          END;
        "Wizard Step"::"3":
          BEGIN
            IF ("Interaction Template Code" = '') AND "Send on finish" THEN
              ErrorMessage(FIELDCAPTION("Interaction Template Code"));

            AttendeeTemp.RESET;
            // CurrForm.AttendeeSubform.PAGE.GetAttendee(AttendeeTemp);
            AttendeeTemp.SETRANGE("Attendance Type",AttendeeTemp."Attendance Type"::"To-do Organizer");
            IF AttendeeTemp.ISEMPTY THEN BEGIN
              AttendeeTemp.RESET;
              ERROR(Text065);
            END;

            IF AttendeeTemp.FIND('-') THEN
              SalesPurchPerson.GET(AttendeeTemp."Attendee No.");
            AttendeeTemp.RESET;
            // CurrForm.AttendeeSubform.PAGE.GetAttendee(AttendeeTemp);
            IF ("Attachment No." = 0) AND "Send on finish" THEN BEGIN
              AttendeeTemp.SETRANGE("Send Invitation",TRUE);
              AttendeeTemp.SETRANGE("Attendee Type",AttendeeTemp."Attendee Type"::Contact);
              IF NOT AttendeeTemp.ISEMPTY THEN BEGIN
                AttendeeTemp.RESET;
                ERROR(Text067,TABLECAPTION,AttendeeTemp.TABLECAPTION);
              END;
              AttendeeTemp.RESET;
            END;
            AttendeeTemp.RESET;
            // CurrForm.AttendeeSubform.PAGE.GetAttendee(AttendeeTemp);
            IF "Send on finish" THEN BEGIN
              AttendeeTemp.SETRANGE("Send Invitation",TRUE);
              IF AttendeeTemp.ISEMPTY THEN BEGIN
                AttendeeTemp.RESET;
                ERROR(Text068,AttendeeTemp.FIELDCAPTION("Send Invitation"));
              END;
              AttendeeTemp.RESET;
            END;
          END;
        "Wizard Step"::"4":
          BEGIN
            IF (Location = '') AND "Send on finish" THEN
              ErrorMessage(FIELDCAPTION(Location));
          END;
      END;
    END;

    PROCEDURE FinishWizard@41() : Boolean;
    VAR
      SegLine@1000 : Record 5077;
      SendOnFinish@1001 : Boolean;
    BEGIN
      IF Recurring THEN BEGIN
        TESTFIELD("Recurring Date Interval");
        TESTFIELD("Calc. Due Date From");
      END;
      IF Type = Type::Meeting THEN BEGIN
        IF NOT "Team To-do" THEN BEGIN
          AttendeeTemp.SETRANGE("Attendance Type",AttendeeTemp."Attendance Type"::"To-do Organizer");
          AttendeeTemp.FIND('-');
          VALIDATE("Salesperson Code",AttendeeTemp."Attendee No.");
          AttendeeTemp.RESET;
        END;
        VALIDATE("Contact No.",'');
      END ELSE BEGIN
        IF Cont.GET("Contact No.") THEN
          AttendeeTemp.CreateAttendee(
            AttendeeTemp,
            "No.",10000,AttendeeTemp."Attendance Type"::Required,
            AttendeeTemp."Attendee Type"::Contact,
            Cont."No.",Cont."E-Mail" <> '');
        IF SegHeader.GET("Segment No.") THEN BEGIN
          SegLine.SETRANGE("Segment No.","Segment No.");
          SegLine.SETFILTER("Contact No.",'<>%1','');
          IF SegLine.FIND('-') THEN
            REPEAT
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",SegLine."Line No.",AttendeeTemp."Attendance Type"::Required,
                AttendeeTemp."Attendee Type"::Contact,
                SegLine."Contact No.",
                (Cont.GET(SegLine."Contact No.") AND
                 (Cont."E-Mail" <> '')));
            UNTIL SegLine.NEXT = 0;
        END;
      END;

      SendOnFinish := "Send on finish";
      "Wizard Step" := "Wizard Step"::" ";
      "Team To-do" := FALSE;
      "Send on finish" := FALSE;
      "Segment Description" := '';
      "Team Meeting Organizer" := '';
      "Activity Code" := '';
      "Wizard Contact Name" := '';
      "Wizard Campaign Description" := '';
      "Wizard Opportunity Description" := '';
      MODIFY;
      InsertTodo(Rec,RMCommentLineTmp,AttendeeTemp,TodoInteractionLanguage,AttachmentTemp,'',SendOnFinish);
      DELETE;
    END;

    LOCAL PROCEDURE GetContactName@65() : Text[50];
    BEGIN
      IF Cont.GET("Contact No.") THEN
        EXIT(Cont.Name);
      IF Cont.GET("Contact Company No.") THEN
        EXIT(Cont.Name);
    END;

    LOCAL PROCEDURE ErrorMessage@47(FieldName@1000 : Text[1024]);
    BEGIN
      ERROR(Text043,FieldName);
    END;

    PROCEDURE AssignDefaultAttendeeInfo@46();
    VAR
      InteractionTemplate@1002 : Record 5064;
      InteractionTemplateSetup@1001 : Record 5122;
      SegLine@1003 : Record 5077;
      TeamSalesperson@1004 : Record 5084;
      AttendeeLineNo@1005 : Integer;
    BEGIN
      IF AttendeeTemp.FIND('+') THEN
        AttendeeLineNo := AttendeeTemp."Line No." + 10000
      ELSE
        AttendeeLineNo := 10000;
      CASE TRUE OF
        (GETFILTER("Contact No.") <> '') AND (GETFILTER("Salesperson Code") <> ''):
          BEGIN
            IF SalesPurchPerson.GET(GETFILTER("Salesperson Code")) THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::"To-do Organizer",
                AttendeeTemp."Attendee Type"::Salesperson,
                SalesPurchPerson.Code,TRUE);
              AttendeeLineNo := AttendeeLineNo + 10000;
              SalespersonFilter := SalesPurchPerson.Code;
            END;
            IF Cont.GET(GETFILTER("Contact No.")) THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::Required,
                AttendeeTemp."Attendee Type"::Contact,
                Cont."No.",
                Cont."E-Mail" <> '');
              AttendeeLineNo := AttendeeLineNo + 10000;
              ContactFilter := Cont."No.";
            END;
          END;
        (GETFILTER("Contact No.") <> '') AND (GETFILTER("Campaign No.") <> ''):
          BEGIN
            IF Campaign.GET(GETFILTER("Campaign No.")) THEN
              IF SalesPurchPerson.GET(Campaign."Salesperson Code") THEN BEGIN
                AttendeeTemp.CreateAttendee(
                  AttendeeTemp,
                  "No.",AttendeeLineNo,
                  AttendeeTemp."Attendance Type"::"To-do Organizer",
                  AttendeeTemp."Attendee Type"::Salesperson,
                  SalesPurchPerson.Code,TRUE);
                AttendeeLineNo := AttendeeLineNo + 10000
              END;
            IF Cont.GET(GETFILTER("Contact No.")) THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::Required,
                AttendeeTemp."Attendee Type"::Contact,
                Cont."No.",Cont."E-Mail" <> '');
              AttendeeLineNo := AttendeeLineNo + 10000;
              ContactFilter := Cont."No.";
            END;
          END
        ELSE BEGIN
          IF Cont.GET(GETFILTER("Contact No.")) THEN BEGIN
            IF Cont."Salesperson Code" <> '' THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::"To-do Organizer",
                AttendeeTemp."Attendee Type"::Salesperson,
                Cont."Salesperson Code",TRUE);
              AttendeeLineNo := AttendeeLineNo + 10000
            END;
            AttendeeTemp.CreateAttendee(
              AttendeeTemp,
              "No.",AttendeeLineNo,
              AttendeeTemp."Attendance Type"::Required,
              AttendeeTemp."Attendee Type"::Contact,
              Cont."No.",Cont."E-Mail" <> '');
            AttendeeLineNo := AttendeeLineNo + 10000;
            ContactFilter := Cont."No.";
          END ELSE
            IF Cont.GET(GETFILTER("Contact Company No.")) THEN BEGIN
              IF Cont."Salesperson Code" <> '' THEN BEGIN
                AttendeeTemp.CreateAttendee(
                  AttendeeTemp,
                  "No.",AttendeeLineNo,
                  AttendeeTemp."Attendance Type"::"To-do Organizer",
                  AttendeeTemp."Attendee Type"::Salesperson,
                  Cont."Salesperson Code",TRUE);
                AttendeeLineNo := AttendeeLineNo + 10000
              END;
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::Required,
                AttendeeTemp."Attendee Type"::Contact,
                Cont."No.",Cont."E-Mail" <> '');
              AttendeeLineNo := AttendeeLineNo + 10000;
              ContactFilter := Cont."No.";
            END;

          IF SalesPurchPerson.GET(GETFILTER("Salesperson Code")) THEN BEGIN
            AttendeeTemp.CreateAttendee(
              AttendeeTemp,
              "No.",AttendeeLineNo,
              AttendeeTemp."Attendance Type"::"To-do Organizer",
              AttendeeTemp."Attendee Type"::Salesperson,
              SalesPurchPerson.Code,TRUE);
            AttendeeLineNo := AttendeeLineNo + 10000;
            SalespersonFilter := SalesPurchPerson.Code;
          END;

          IF Campaign.GET(GETFILTER("Campaign No.")) THEN
            IF SalesPurchPerson.GET(Campaign."Salesperson Code") THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::"To-do Organizer",
                AttendeeTemp."Attendee Type"::Salesperson,
                SalesPurchPerson.Code,TRUE);
              AttendeeLineNo := AttendeeLineNo + 10000
            END;

          IF Opp.GET(GETFILTER("Opportunity No.")) THEN BEGIN
            IF SalesPurchPerson.GET(Opp."Salesperson Code") THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::"To-do Organizer",
                AttendeeTemp."Attendee Type"::Salesperson,
                SalesPurchPerson.Code,TRUE);
              AttendeeLineNo := AttendeeLineNo + 10000
            END;
            IF Cont.GET(Opp."Contact No.") THEN BEGIN
              AttendeeTemp.CreateAttendee(
                AttendeeTemp,
                "No.",AttendeeLineNo,
                AttendeeTemp."Attendance Type"::Required,
                AttendeeTemp."Attendee Type"::Contact,
                Cont."No.",Cont."E-Mail" <> '');
              AttendeeLineNo := AttendeeLineNo + 10000
            END;
          END;
        END;
      END;

      IF SegHeader.GET(GETFILTER("Segment No.")) THEN BEGIN
        IF SalesPurchPerson.GET(SegHeader."Salesperson Code") THEN BEGIN
          AttendeeTemp.CreateAttendee(
            AttendeeTemp,
            "No.",AttendeeLineNo,
            AttendeeTemp."Attendance Type"::"To-do Organizer",
            AttendeeTemp."Attendee Type"::Salesperson,
            SalesPurchPerson.Code,TRUE);
          AttendeeLineNo := AttendeeLineNo + 10000
        END;
        SegLine.SETRANGE("Segment No.","Segment No.");
        SegLine.SETFILTER("Contact No.",'<>%1','');
        IF SegLine.FIND('-') THEN
          REPEAT
            AttendeeTemp.CreateAttendee(
              AttendeeTemp,
              "No.",AttendeeLineNo,
              AttendeeTemp."Attendance Type"::Required,
              AttendeeTemp."Attendee Type"::Contact,
              SegLine."Contact No.",
              (Cont.GET(SegLine."Contact No.") AND
               (Cont."E-Mail" <> '')));
            AttendeeLineNo := AttendeeLineNo + 10000
          UNTIL SegLine.NEXT = 0;
      END;
      IF Team.GET("Team Code") THEN BEGIN
        TeamSalesperson.SETRANGE("Team Code",Team.Code);
        IF TeamSalesperson.FIND('-') THEN
          REPEAT
            AttendeeTemp.SETRANGE("Attendee Type",AttendeeTemp."Attendee Type"::Salesperson);
            AttendeeTemp.SETRANGE("Attendee No.",TeamSalesperson."Salesperson Code");
            IF NOT AttendeeTemp.FIND('-') THEN
              IF SalesPurchPerson.GET(TeamSalesperson."Salesperson Code") THEN BEGIN
                AttendeeTemp.RESET;
                AttendeeTemp.CreateAttendee(
                  AttendeeTemp,
                  "No.",AttendeeLineNo,
                  AttendeeTemp."Attendance Type"::Required,
                  AttendeeTemp."Attendee Type"::Salesperson,
                  TeamSalesperson."Salesperson Code",
                  SalesPurchPerson."E-Mail" <> '');
                AttendeeLineNo := AttendeeLineNo + 10000
              END;
            AttendeeTemp.RESET;
          UNTIL TeamSalesperson.NEXT = 0;
      END;

      InteractionTemplateSetup.GET;
      IF (InteractionTemplateSetup."Meeting Invitation" <> '') AND
         InteractionTemplate.GET(InteractionTemplateSetup."Meeting Invitation")
      THEN
        UpdateInteractionTemplate(
          Rec,TodoInteractionLanguage,AttachmentTemp,InteractionTemplate.Code,TRUE);
    END;

    PROCEDURE ValidateInteractionTemplCode@66();
    BEGIN
      UpdateInteractionTemplate(
        Rec,TodoInteractionLanguage,AttachmentTemp,"Interaction Template Code",TRUE);
      LoadTempAttachment;
    END;

    PROCEDURE AssistEditAttachment@58();
    BEGIN
      IF AttachmentTemp.GET("Attachment No.") THEN BEGIN
        AttachmentTemp.OpenAttachment("Interaction Template Code" + ' ' + Description,TRUE,"Language Code");
        AttachmentTemp.MODIFY;
      END ELSE
        ERROR(Text047);
    END;

    PROCEDURE ValidateLanguageCode@67();
    BEGIN
      IF "Language Code" = xRec."Language Code" THEN
        EXIT;

      IF NOT TodoInteractionLanguage.GET("No.","Language Code") THEN BEGIN
        IF "No." = '' THEN
          ERROR(Text009,TodoInteractionLanguage.TABLECAPTION);
      END ELSE
        "Attachment No." := TodoInteractionLanguage."Attachment No.";
    END;

    PROCEDURE LookupLanguageCode@68();
    BEGIN
      TodoInteractionLanguage.SETFILTER("To-do No.",'');
      IF TodoInteractionLanguage.GET('',"Language Code") THEN
        IF PAGE.RUNMODAL(0,TodoInteractionLanguage) = ACTION::LookupOK THEN BEGIN
          "Language Code" := TodoInteractionLanguage."Language Code";
          "Attachment No." := TodoInteractionLanguage."Attachment No.";
        END;
    END;

    LOCAL PROCEDURE UpdInteractionTemplate@57();
    BEGIN
      UpdateInteractionTemplate(
        Rec,TodoInteractionLanguage,AttachmentTemp,"Interaction Template Code",TRUE);
    END;

    PROCEDURE LoadTempAttachment@45();
    VAR
      Attachment@1000 : Record 5062;
      AttachmentTemp2@1001 : TEMPORARY Record 5062;
    BEGIN
      IF AttachmentTemp.FIND('-') THEN
        REPEAT
          AttachmentTemp2 := AttachmentTemp;
          AttachmentTemp2.INSERT;
        UNTIL AttachmentTemp.NEXT = 0;

      IF AttachmentTemp2.FIND('-') THEN
        REPEAT
          Attachment.GET(AttachmentTemp2."No.");
          Attachment.CALCFIELDS(Attachment);
          AttachmentTemp.GET(AttachmentTemp2."No.");
          AttachmentTemp.WizEmbeddAttachment(Attachment);
          AttachmentTemp."No." := AttachmentTemp2."No.";
          AttachmentTemp.MODIFY;
        UNTIL AttachmentTemp2.NEXT = 0;
    END;

    PROCEDURE ClearDefaultAttendeeInfo@44();
    BEGIN
      AttendeeTemp.DELETEALL;
      // CurrForm.AttendeeSubform.PAGE.SetAttendee(AttendeeTemp);
      // CurrForm.AttendeeSubform.PAGE.UpdateForm;
      AttachmentTemp.DELETEALL;
      TodoInteractionLanguage.DELETEALL;
      "Interaction Template Code" := '';
      "Language Code" := '';
      "Attachment No." := 0;
      Subject := '';
      "Unit Cost (LCY)" := 0;
      "Unit Duration (Min.)" := 0;
      MODIFY;
    END;

    PROCEDURE GetAttendee@59(VAR Attendee@1000 : Record 5199);
    BEGIN
      Attendee.DELETEALL;
      IF AttendeeTemp.FIND('-') THEN
        REPEAT
          Attendee := AttendeeTemp;
          Attendee.INSERT;
        UNTIL AttendeeTemp.NEXT = 0;
    END;

    PROCEDURE SetAttendee@49(VAR Attendee@1000 : Record 5199);
    BEGIN
      AttendeeTemp.DELETEALL;

      IF Attendee.FINDSET THEN
        REPEAT
          AttendeeTemp := Attendee;
          AttendeeTemp.INSERT;
        UNTIL Attendee.NEXT = 0;
    END;

    LOCAL PROCEDURE HasComment@55() : Boolean;
    BEGIN
      EXIT(NOT RMCommentLineTmp.ISEMPTY)
    END;

    LOCAL PROCEDURE ShowComment@56();
    BEGIN
      RMCommentLineTmp.SETRANGE("Table Name",RMCommentLineTmp."Table Name"::"To-do");
      RMCommentLineTmp.SETRANGE("No.","No.");
      RMCommentLineTmp.SETRANGE("Sub No.",0);
      PAGE.RUNMODAL(PAGE::"Rlshp. Mgt. Comment Sheet",RMCommentLineTmp);
    END;

    LOCAL PROCEDURE GetComments@64(VAR RMCommentLine@1001 : Record 5061);
    BEGIN
      RMCommentLine.DELETEALL;
      IF RMCommentLineTmp.FIND('-') THEN
        REPEAT
          RMCommentLine := RMCommentLineTmp;
          RMCommentLine.INSERT;
        UNTIL RMCommentLineTmp.NEXT = 0;
    END;

    PROCEDURE SetComments@53(VAR RMCommentLine@1001 : Record 5061);
    BEGIN
      RMCommentLineTmp.DELETEALL;

      IF RMCommentLine.FINDSET THEN
        REPEAT
          RMCommentLineTmp := RMCommentLine;
          RMCommentLineTmp.INSERT;
        UNTIL RMCommentLine.NEXT = 0;
    END;

    LOCAL PROCEDURE StartWizard2@63();
    BEGIN
      "Wizard Contact Name" := GetContactName;
      IF Cont.GET(GETFILTER("Contact No.")) THEN
        "Wizard Contact Name" := Cont.Name
      ELSE
        IF Cont.GET(GETFILTER("Contact Company No.")) THEN
          "Wizard Contact Name" := Cont.Name;

      IF Campaign.GET(GETFILTER("Campaign No.")) THEN
        "Wizard Campaign Description" := Campaign.Description;

      IF SegHeader.GET(GETFILTER("Segment No.")) THEN
        "Segment Description" := SegHeader.Description;

      "Wizard Step" := "Wizard Step"::"1";
      Duration := 1440 * 1000 * 60;

      INSERT;

      PAGE.RUNMODAL(PAGE::"Assign Activity",Rec);
    END;

    PROCEDURE PerformNextWizardStatus2@62();
    BEGIN
      "Wizard Step" := "Wizard Step" + 1;
    END;

    PROCEDURE PerformPrevWizardStatus2@61();
    BEGIN
      "Wizard Step" := "Wizard Step" - 1;
    END;

    PROCEDURE CheckStatus2@60() : Boolean;
    BEGIN
      CASE "Wizard Step" OF
        "Wizard Step"::"1":
          BEGIN
            IF "Activity Code" = '' THEN
              ErrorMessage(Text051);
            IF Date = 0D THEN
              ErrorMessage(FIELDCAPTION(Date));
            IF ("Team Code" = '') AND ("Salesperson Code" = '') THEN
              ERROR(Text053,FIELDCAPTION("Salesperson Code"),FIELDCAPTION("Team Code"));
            IF ("Team Code" <> '') AND
               Activity.IncludesMeeting("Activity Code") AND
               ("Team Meeting Organizer" = '')
            THEN
              ERROR(Text056,"Activity Code",Type::Meeting);
          END;
      END;
    END;

    PROCEDURE FinishWizard2@54() : Boolean;
    VAR
      RMCommentLine@1003 : TEMPORARY Record 5061;
      AttendeeTemp@1002 : TEMPORARY Record 5199;
      TodoInteractionLanguageTemp@1001 : TEMPORARY Record 5196;
      AttachmentTemp@1000 : TEMPORARY Record 5062;
    BEGIN
      AttendeeTemp.DELETEALL;
      IF "Team Meeting Organizer" <> '' THEN
        AttendeeTemp.CreateAttendee(
          AttendeeTemp,
          "No.",10000,AttendeeTemp."Attendance Type"::"To-do Organizer",
          AttendeeTemp."Attendee Type"::Salesperson,
          "Team Meeting Organizer",
          TRUE)
      ELSE
        IF "Salesperson Code" <> '' THEN
          AttendeeTemp.CreateAttendee(
            AttendeeTemp,
            "No.",10000,AttendeeTemp."Attendance Type"::"To-do Organizer",
            AttendeeTemp."Attendee Type"::Salesperson,
            "Salesperson Code",
            TRUE);
      InsertTodo(
        Rec,RMCommentLine,AttendeeTemp,
        TodoInteractionLanguageTemp,AttachmentTemp,"Activity Code",FALSE);
      DELETE;
    END;

    LOCAL PROCEDURE ValidateSalesPerson@71();
    BEGIN
      IF SalesPurchPerson.GET("Salesperson Code") THEN BEGIN
        "Team Meeting Organizer" := '';
        "Team Code" := ''
      END
    END;

    LOCAL PROCEDURE TransformFromCode20ToCode10@5(Code20Input@1000 : Code[20]) : Code[10];
    BEGIN
      IF STRLEN(Code20Input) > 10 THEN
        EXIT('');
      EXIT(COPYSTR(Code20Input,1,10));
    END;

    LOCAL PROCEDURE FillSalesPersonContact@8(VAR ToDoParameter@1000 : Record 5080;AttendeeParameter@1001 : Record 5199);
    BEGIN
      CASE AttendeeParameter."Attendee Type" OF
        AttendeeParameter."Attendee Type"::Contact:
          ToDoParameter.VALIDATE("Contact No.",AttendeeParameter."Attendee No.");
        AttendeeParameter."Attendee Type"::Salesperson:
          ToDoParameter.VALIDATE("Salesperson Code",TransformFromCode20ToCode10(AttendeeParameter."Attendee No."));
      END;
    END;

    PROCEDURE SetRunFromForm@11();
    BEGIN
      RunFormCode := TRUE;
    END;

    LOCAL PROCEDURE IsCalledFromForm@29() : Boolean;
    BEGIN
      EXIT((CurrFieldNo <> 0) OR RunFormCode);
    END;

    LOCAL PROCEDURE OneDayDuration@31() : Integer;
    BEGIN
      EXIT(86400000); // 24 * 60 * 60 * 1000 = 86,400,000 ms in 24 hours
    END;

    BEGIN
    {
      CM  20160706  Added CM* Fields
                    Added Code in OnInsert(), OnModify() and OnDelete() Trigger
                    Added Key "CM Is Task","CM Maintask No.","CM Assigned User ID","CM Status"
                    Added Key "Opportunity No.","CM Is Task","CM Assigned User ID","CM Status"
                    Added Key "CM Type,CM Objecttype,CM Object No."
    }
    END.
  }
}

OBJECT Table 5081 Activity
{
  OBJECT-PROPERTIES
  {
    Date=29.01.18;
    Time=09:59:48;
    Modified=Yes;
    Version List=NAVW17.00,CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=Code,Description;
    OnDelete=VAR
               ActivityStep@1000 : Record 5082;
             BEGIN
               ActivityStep.SETRANGE("Activity Code",Code);
               ActivityStep.DELETEALL;
             END;

    CaptionML=[ENU=Activity;
               DEA=Aktion];
    LookupPageID=Page5103;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              DEA=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 50200;  ;CM Priority         ;Option        ;CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High }
    { 50300;  ;CM Extended Description;Text250    ;CaptionML=[ENU=Extended Description;
                                                              DEA=Erweiterte Beschreibung] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE IncludesMeeting@1(ActivityCode@1000 : Code[10]) : Boolean;
    VAR
      ActivityStep@1001 : Record 5082;
    BEGIN
      WITH ActivityStep DO BEGIN
        SETCURRENTKEY("Activity Code",Type);
        SETRANGE("Activity Code",ActivityCode);
        SETRANGE(Type,Type::Meeting);
        EXIT(FINDFIRST);
      END;
    END;

    BEGIN
    {
      CM  20161020  Added CM* Fields
    }
    END.
  }
}

OBJECT Table 5082 Activity Step
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=14:56:01;
    Modified=Yes;
    Version List=NAVW16.00,CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               CMTaskMgt.WoTypeTaskOnInsert(Rec); //CM
             END;

    OnModify=BEGIN
               CMTaskMgt.WoTypeTaskOnModify(Rec,xRec); //CM
             END;

    OnDelete=BEGIN
               CMTaskMgt.WoTypeTaskOnDelete(Rec); //CM
             END;

    OnRename=BEGIN
               CMTaskMgt.WoTypeTaskOnRename(Rec, xRec); //CM
             END;

    CaptionML=[ENU=Activity Step;
               DEA=Aktionsschritt];
  }
  FIELDS
  {
    { 1   ;   ;Activity Code       ;Code10        ;TableRelation=Activity;
                                                   CaptionML=[ENU=Activity Code;
                                                              DEA=Aktionscode];
                                                   NotBlank=Yes }
    { 2   ;   ;Step No.            ;Integer       ;CaptionML=[ENU=Step No.;
                                                              DEA=Schrittnr.] }
    { 3   ;   ;Type                ;Option        ;CaptionML=[ENU=Type;
                                                              DEA=Art];
                                                   OptionCaptionML=[ENU=" ,Meeting,Phone Call";
                                                                    DEA=" ,Besprechung,Telefonat"];
                                                   OptionString=[ ,Meeting,Phone Call] }
    { 4   ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 5   ;   ;Priority            ;Option        ;CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High }
    { 6   ;   ;Date Formula        ;DateFormula   ;CaptionML=[ENU=Date Formula;
                                                              DEA=Datumsformel] }
    { 50090;  ;CM Subtype          ;Option        ;CaptionML=[ENU=Subtype;
                                                              DEA=Subtyp];
                                                   OptionString=[ ,Checklist,Team] }
    { 50100;  ;CM Extended Description;Text250    ;CaptionML=[ENU=Extended Description;
                                                              DEA=Erweiterte Beschreibung] }
    { 50210;  ;CM Maintask Step No.;Integer       ;CaptionML=[ENU=Maintask Step No.;
                                                              DEA=Hauptaufg. Schrittnr.] }
    { 50300;  ;CM Planned Duration ;Duration      ;CaptionML=[ENU=Planned Duration;
                                                              DEA=Geplante Dauer] }
    { 50700;  ;CM Assigned User ID ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                CMTaskMgt.ValidateWoTypeTeam(Rec);
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              DEA=Zugewiesener Benutzer ID] }
    { 50705;  ;CM Assigned User Name;Text50       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(CM Assigned User ID)));
                                                   CaptionML=[ENU=Assigned User Name;
                                                              DEA=Zugwiesener Benutzername];
                                                   Description=FF;
                                                   Editable=No }
    { 51000;  ;CM Interaction Template Code;Code10;TableRelation="Interaction Template".Code;
                                                   CaptionML=[ENU=Interaction Template Code;
                                                              DEA=Aktivit„tenvorlage Code] }
    { 51010;  ;CM Wizard Action    ;Option        ;CaptionML=[ENU=Wizard Action;
                                                              DEA=Aktion des Assistenten];
                                                   OptionCaptionML=[ENU=" ,Open,Import,,,,,Information";
                                                                    DEA=" ,Dateianhang ”ffnen,Dateianhang importieren,,,,,Information"];
                                                   OptionString=[ ,Open,Import,,,,,Information];
                                                   Description=CM }
    { 51020;  ;CM Information Type ;Option        ;CaptionML=[ENU=Information Type;
                                                              DEA=Information Typ];
                                                   OptionCaptionML=[ENU=" ,Comment,Comment (long),,,,,,,,Replacement,Installation";
                                                                    DEA=" ,Kommentar,Kommentar (lang),,,,,,,,Austausch,Installation"];
                                                   OptionString=[ ,Comment,Comment (long),,,,,,,,Replacement,Installation];
                                                   Description=CM }
    { 51030;  ;CM Interaction Group Code;Code10   ;TableRelation="Interaction Group";
                                                   CaptionML=[ENU=Interaction Group Code;
                                                              DEA=Aktivit„tengruppencode];
                                                   NotBlank=Yes;
                                                   Description=CM }
  }
  KEYS
  {
    {    ;Activity Code,Step No.                  ;Clustered=Yes }
    {    ;Activity Code,Type                       }
    {    ;CM Maintask Step No.                     }
    {    ;Activity Code,CM Subtype                 }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      CMTaskMgt@1000000000 : Codeunit 70031;

    BEGIN
    {
      CM  20161020  Added CM* Fields
                    Added Key "CM Is CMMS WO Typ Task"
                    Added Key "CM Is CMMS WO Typ Task","CM Is Subtask"
                    Added Code in OnInsert(), OnModify(), OnDelete()
                    Added Key "Activity Code,CM Subtype"
    }
    END.
  }
}

OBJECT Table 5092 Opportunity
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=13:14:28;
    Modified=Yes;
    Version List=NAVW19.00.00.45834,CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Description;
    OnInsert=BEGIN
               CMWoMgt.OnInsert(Rec); //CM

               IF "No." = '' THEN BEGIN
                 RMSetup.GET;
                 RMSetup.TESTFIELD("Opportunity Nos.");
                 NoSeriesMgt.InitSeries(RMSetup."Opportunity Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
             END;

    OnModify=BEGIN
               CMWoMgt.OnModify(Rec,xRec); //CM
             END;

    OnDelete=VAR
               OppEntry@1000 : Record 5093;
             BEGIN
               CMWoMgt.OnDelete(Rec); //CM

               IF Status = Status::"In Progress" THEN
                 ERROR(Text000);

               RMCommentLine.SETRANGE("Table Name",RMCommentLine."Table Name"::Opportunity);
               RMCommentLine.SETRANGE("No.","No.");
               RMCommentLine.DELETEALL;

               OppEntry.SETCURRENTKEY("Opportunity No.");
               OppEntry.SETRANGE("Opportunity No.","No.");
               OppEntry.DELETEALL;
             END;

    CaptionML=[ENU=Opportunity;
               DEA=Verkaufschance];
    LookupPageID=Page5123;
    DrillDownPageID=Page5123;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  RMSetup.GET;
                                                                  NoSeriesMgt.TestManual(RMSetup."Opportunity Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=No.;
                                                              DEA=Nr.] }
    { 2   ;   ;Description         ;Text50        ;OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_Description(Rec,xRec);//CM
                                                              END;

                                                   CaptionML=[ENU=Description;
                                                              DEA=Beschreibung];
                                                   Description=CM }
    { 3   ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   OnValidate=VAR
                                                                Todo@1000 : Record 5080;
                                                                Todo2@1004 : Record 5080;
                                                                OppEntry@1001 : Record 5093;
                                                                Attendee@1005 : Record 5199;
                                                                Window@1009 : Dialog;
                                                                TotalRecordsNumber@1003 : Integer;
                                                                Counter@1002 : Integer;
                                                                StartTime@1007 : Time;
                                                                EndTime@1008 : Time;
                                                              BEGIN
                                                                IF ("Salesperson Code" <> xRec."Salesperson Code") AND
                                                                   (xRec."Salesperson Code" <> '') AND
                                                                   ("No." <> '')
                                                                THEN BEGIN
                                                                  TESTFIELD("Salesperson Code");
                                                                  Todo.RESET;
                                                                  Todo.SETCURRENTKEY("Opportunity No.",Date,Closed);
                                                                  Todo.SETRANGE("Opportunity No.","No.");
                                                                  Todo.SETRANGE(Closed,FALSE);
                                                                  Todo.SETRANGE("Salesperson Code",xRec."Salesperson Code");
                                                                  TotalRecordsNumber := Todo.COUNT;
                                                                  Counter := 0;
                                                                  IF Todo.FIND('-') THEN
                                                                    IF CONFIRM(Text008,FALSE,FIELDCAPTION("Salesperson Code")) THEN BEGIN
                                                                      Window.OPEN(Text012 + Text013);
                                                                      Window.UPDATE(2,Text014);
                                                                      StartTime := TIME;
                                                                      REPEAT
                                                                        Counter := Counter + 1;
                                                                        Window.UPDATE(1,ROUND(Counter / TotalRecordsNumber * 10000,1));
                                                                        IF Todo.Type = Todo.Type::Meeting THEN BEGIN
                                                                          Todo.GetMeetingOrganizerTodo(Todo2);
                                                                          IF Todo."Salesperson Code" <> Todo2."Salesperson Code" THEN BEGIN
                                                                            Todo.VALIDATE("Salesperson Code","Salesperson Code");
                                                                            Todo.MODIFY;
                                                                          END;
                                                                          Attendee.RESET;
                                                                          Attendee.SETRANGE("To-do No.",Todo2."No.");
                                                                          Attendee.SETRANGE("Attendee No.",xRec."Salesperson Code");
                                                                          Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Salesperson);
                                                                          Attendee.SETRANGE("Attendance Type",Attendee."Attendance Type"::Required,Attendee."Attendance Type"::Optional);
                                                                          IF Attendee.FINDFIRST THEN BEGIN
                                                                            Attendee.VALIDATE("Attendee No.","Salesperson Code");
                                                                            Attendee.MODIFY(TRUE);
                                                                          END;
                                                                        END
                                                                        ELSE BEGIN
                                                                          Todo.VALIDATE("Salesperson Code","Salesperson Code");
                                                                          Todo.MODIFY(TRUE);
                                                                        END;
                                                                      UNTIL Todo.NEXT = 0;
                                                                      EndTime := TIME;
                                                                      Window.CLOSE;
                                                                    END;

                                                                  OppEntry.RESET;
                                                                  OppEntry.SETCURRENTKEY(Active,"Opportunity No.");
                                                                  OppEntry.SETRANGE(Active,TRUE);
                                                                  OppEntry.SETRANGE("Opportunity No.","No.");
                                                                  IF OppEntry.FIND('-') THEN
                                                                    REPEAT
                                                                      OppEntry."Salesperson Code" := "Salesperson Code";
                                                                      OppEntry.MODIFY;
                                                                    UNTIL OppEntry.NEXT = 0;

                                                                  MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Salesperson Code;
                                                              DEA=Verk„ufercode] }
    { 4   ;   ;Campaign No.        ;Code20        ;TableRelation=Campaign;
                                                   OnValidate=VAR
                                                                Todo@1001 : Record 5080;
                                                                OppEntry@1000 : Record 5093;
                                                              BEGIN
                                                                IF ("Campaign No." <> xRec."Campaign No.") AND
                                                                   ("No." <> '')
                                                                THEN BEGIN
                                                                  Todo.RESET;
                                                                  Todo.SETCURRENTKEY("Opportunity No.",Date,Closed);
                                                                  Todo.SETRANGE("Opportunity No.","No.");
                                                                  Todo.SETRANGE(Closed,FALSE);
                                                                  Todo.SETRANGE("Campaign No.",xRec."Campaign No.");
                                                                  IF Todo.FIND('-') THEN
                                                                    IF CONFIRM(Text008,FALSE,FIELDCAPTION("Campaign No.")) THEN
                                                                      REPEAT
                                                                        Todo."Campaign No." := "Campaign No.";
                                                                        Todo.MODIFY;
                                                                      UNTIL Todo.NEXT = 0;

                                                                  OppEntry.RESET;
                                                                  OppEntry.SETCURRENTKEY(Active,"Opportunity No.");
                                                                  OppEntry.SETRANGE(Active,TRUE);
                                                                  OppEntry.SETRANGE("Opportunity No.","No.");
                                                                  IF OppEntry.FIND('-') THEN
                                                                    REPEAT
                                                                      OppEntry."Campaign No." := "Campaign No.";
                                                                      OppEntry.MODIFY;
                                                                    UNTIL OppEntry.NEXT = 0;

                                                                  MODIFY;
                                                                END;
                                                              END;

                                                   CaptionML=[ENU=Campaign No.;
                                                              DEA=Kampagnennr.] }
    { 5   ;   ;Contact No.         ;Code20        ;TableRelation=Contact;
                                                   OnValidate=VAR
                                                                Cont@1000 : Record 5050;
                                                                Todo@1002 : Record 5080;
                                                                Todo2@1005 : Record 5080;
                                                                OppEntry@1001 : Record 5093;
                                                                SalesHeader@1003 : Record 36;
                                                                Attendee@1004 : Record 5199;
                                                                Window@1007 : Dialog;
                                                                TotalRecordsNumber@1011 : Integer;
                                                                Counter@1012 : Integer;
                                                                StartTime@1008 : Time;
                                                                EndTime@1009 : Time;
                                                              BEGIN
                                                                TESTFIELD("Contact No.");
                                                                Cont.GET("Contact No.");

                                                                IF ("Contact No." <> xRec."Contact No.") AND
                                                                   (xRec."Contact No." <> '') AND
                                                                   ("No." <> '')
                                                                THEN BEGIN
                                                                  CALCFIELDS("Contact Name");
                                                                  IF ("Contact Company No." <> Cont."Company No.") AND
                                                                     (Status <> Status::"Not Started")
                                                                  THEN
                                                                    ERROR(Text009,Cont."No.",Cont.Name);

                                                                  IF ("Sales Document No." <> '') AND ("Sales Document Type" = "Sales Document Type"::Quote) THEN BEGIN
                                                                    SalesHeader.GET(SalesHeader."Document Type"::Quote,"Sales Document No.");
                                                                    IF SalesHeader."Sell-to Contact No." <> "Contact No." THEN BEGIN
                                                                      MODIFY;
                                                                      SalesHeader.SetHideValidationDialog(TRUE);
                                                                      SalesHeader.VALIDATE("Sell-to Contact No.","Contact No.");
                                                                      SalesHeader.MODIFY
                                                                    END
                                                                  END;
                                                                  Todo.RESET;
                                                                  Todo.SETCURRENTKEY("Opportunity No.",Date,Closed);
                                                                  Todo.SETRANGE("Opportunity No.","No.");
                                                                  Todo.SETRANGE(Closed,FALSE);
                                                                  Todo.SETRANGE("Contact No.",xRec."Contact No.");
                                                                  TotalRecordsNumber := Todo.COUNT;
                                                                  Counter := 0;
                                                                  IF Todo.FIND('-') THEN
                                                                    IF CONFIRM(Text008,FALSE,FIELDCAPTION("Contact No.")) THEN BEGIN
                                                                      Window.OPEN(Text012 + Text013);
                                                                      Window.UPDATE(2,Text014);
                                                                      StartTime := TIME;
                                                                      REPEAT
                                                                        Counter := Counter + 1;
                                                                        Window.UPDATE(1,ROUND(Counter / TotalRecordsNumber * 10000,1));
                                                                        IF Todo.Type = Todo.Type::Meeting THEN BEGIN
                                                                          Todo.GetMeetingOrganizerTodo(Todo2);
                                                                          Todo.VALIDATE("Contact No.","Contact No.");
                                                                          Todo.MODIFY;
                                                                          Attendee.RESET;
                                                                          Attendee.SETRANGE("To-do No.",Todo2."No.");
                                                                          Attendee.SETRANGE("Attendee No.",xRec."Contact No.");
                                                                          Attendee.SETRANGE("Attendee Type",Attendee."Attendee Type"::Contact);
                                                                          IF Attendee.FINDFIRST THEN BEGIN
                                                                            Attendee.VALIDATE("Attendee No.","Contact No.");
                                                                            Attendee.MODIFY(TRUE);
                                                                          END;
                                                                        END ELSE BEGIN
                                                                          Todo.VALIDATE("Contact No.","Contact No.");
                                                                          Todo.MODIFY(TRUE);
                                                                        END;
                                                                      UNTIL Todo.NEXT = 0;
                                                                      EndTime := TIME;
                                                                      Window.CLOSE;
                                                                    END;

                                                                  OppEntry.RESET;
                                                                  OppEntry.SETCURRENTKEY(Active,"Opportunity No.");
                                                                  OppEntry.SETRANGE(Active,TRUE);
                                                                  OppEntry.SETRANGE("Opportunity No.","No.");
                                                                  IF OppEntry.FIND('-') THEN
                                                                    REPEAT
                                                                      OppEntry.VALIDATE("Contact No.","Contact No.");
                                                                      OppEntry.MODIFY;
                                                                    UNTIL OppEntry.NEXT = 0;

                                                                  MODIFY;
                                                                END;

                                                                "Contact Company No." := Cont."Company No.";
                                                                CALCFIELDS("Contact Name","Contact Company Name");
                                                              END;

                                                   OnLookup=VAR
                                                              Cont@1000 : Record 5050;
                                                            BEGIN
                                                              IF Cont.GET("Contact No.") THEN BEGIN
                                                                IF Status <> Status::"Not Started" THEN
                                                                  Cont.SETRANGE("Company No.",Cont."Company No.");
                                                                IF PAGE.RUNMODAL(0,Cont) = ACTION::LookupOK THEN BEGIN
                                                                  xRec."Contact No." := "Contact No.";
                                                                  VALIDATE("Contact No.",Cont."No.");
                                                                END;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Contact No.;
                                                              DEA=Kontaktnr.] }
    { 6   ;   ;Contact Company No. ;Code20        ;TableRelation=Contact WHERE (Type=CONST(Company));
                                                   CaptionML=[ENU=Contact Company No.;
                                                              DEA=Kontakt Unternehmensnr.] }
    { 7   ;   ;Sales Cycle Code    ;Code10        ;TableRelation="Sales Cycle";
                                                   OnValidate=VAR
                                                                SalesCycle@1000 : Record 5090;
                                                              BEGIN
                                                                SalesCycle.GET("Sales Cycle Code");
                                                                SalesCycle.TESTFIELD(Blocked,FALSE);
                                                              END;

                                                   CaptionML=[ENU=Sales Cycle Code;
                                                              DEA=Verkaufsprozesscode] }
    { 8   ;   ;Sales Document No.  ;Code20        ;TableRelation=IF (Sales Document Type=CONST(Quote)) "Sales Header".No. WHERE (Document Type=CONST(Quote),
                                                                                                                                 Sell-to Contact No.=FIELD(Contact No.))
                                                                                                                                 ELSE IF (Sales Document Type=CONST(Order)) "Sales Header".No. WHERE (Document Type=CONST(Order),
                                                                                                                                                                                                      Sell-to Contact No.=FIELD(Contact No.))
                                                                                                                                                                                                      ELSE IF (Sales Document Type=CONST(Posted Invoice)) "Sales Invoice Header".No. WHERE (Sell-to Contact No.=FIELD(Contact No.));
                                                   OnValidate=VAR
                                                                Opp@1000 : Record 5092;
                                                                SalesHeader@1001 : Record 36;
                                                              BEGIN
                                                                IF "Sales Document No." = '' THEN BEGIN
                                                                  "Sales Document Type" := "Sales Document Type"::" ";
                                                                  IF xRec."Sales Document Type" = "Sales Document Type"::Quote THEN
                                                                    IF SalesHeader.GET(SalesHeader."Document Type"::Quote,xRec."Sales Document No.") THEN BEGIN
                                                                      SalesHeader."Opportunity No." := '';
                                                                      SalesHeader.MODIFY
                                                                    END
                                                                END ELSE
                                                                  IF "Sales Document No." <> xRec."Sales Document No." THEN BEGIN
                                                                    Opp.RESET;
                                                                    Opp.SETCURRENTKEY("Sales Document Type","Sales Document No.");
                                                                    Opp.SETRANGE("Sales Document Type","Sales Document Type");
                                                                    Opp.SETRANGE("Sales Document No.","Sales Document No.");
                                                                    IF Opp.FINDFIRST THEN
                                                                      IF Opp."No." <> "No." THEN
                                                                        ERROR(Text006,Opp."Sales Document Type",Opp."Sales Document No.",Opp."No.");

                                                                    IF xRec."Sales Document Type" = "Sales Document Type"::Quote THEN
                                                                      IF SalesHeader.GET(SalesHeader."Document Type"::Quote,xRec."Sales Document No.") THEN BEGIN
                                                                        SalesHeader."Opportunity No." := '';
                                                                        SalesHeader.MODIFY
                                                                      END;
                                                                    IF "Sales Document Type" = "Sales Document Type"::Quote THEN
                                                                      IF SalesHeader.GET(SalesHeader."Document Type"::Quote,"Sales Document No.") THEN BEGIN
                                                                        SalesHeader."Opportunity No." := "No.";
                                                                        SalesHeader.MODIFY
                                                                      END
                                                                  END;
                                                              END;

                                                   CaptionML=[ENU=Sales Document No.;
                                                              DEA=Verkaufsbelegnr.] }
    { 9   ;   ;Creation Date       ;Date          ;CaptionML=[ENU=Creation Date;
                                                              DEA=Errichtungsdatum] }
    { 10  ;   ;Status              ;Option        ;CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionCaptionML=[ENU=Not Started,In Progress,Won,Lost;
                                                                    DEA=Nicht begonnen,In Bearbeitung,Gewonnen,Verloren];
                                                   OptionString=Not Started,In Progress,Won,Lost;
                                                   Editable=No }
    { 11  ;   ;Priority            ;Option        ;InitValue=Normal;
                                                   OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_Priority(Rec,xRec);//CM
                                                              END;

                                                   CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High }
    { 12  ;   ;Closed              ;Boolean       ;CaptionML=[ENU=Closed;
                                                              DEA=Abgeschlossen];
                                                   Editable=No }
    { 13  ;   ;Date Closed         ;Date          ;CaptionML=[ENU=Date Closed;
                                                              DEA=Abgeschlossen am];
                                                   Editable=No }
    { 15  ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[ENU=No. Series;
                                                              DEA=Nummernserie];
                                                   Editable=No }
    { 16  ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Rlshp. Mgt. Comment Line" WHERE (Table Name=CONST(Opportunity),
                                                                                                       No.=FIELD(No.)));
                                                   CaptionML=[ENU=Comment;
                                                              DEA=Bemerkung];
                                                   Editable=No }
    { 17  ;   ;Current Sales Cycle Stage;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Opportunity Entry"."Sales Cycle Stage" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                     Active=CONST(Yes)));
                                                   CaptionML=[ENU=Current Sales Cycle Stage;
                                                              DEA=Aktuelle Verkaufsprozess-Stufe];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 18  ;   ;Estimated Value (LCY);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Estimated Value (LCY)" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                      Active=CONST(Yes)));
                                                   CaptionML=[ENU=Estimated Value (LCY);
                                                              DEA=Erwarteter Wert (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 19  ;   ;Probability %       ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Opportunity Entry"."Probability %" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                 Active=CONST(Yes)));
                                                   CaptionML=[ENU=Probability %;
                                                              DEA=Wahrscheinlichkeit %];
                                                   DecimalPlaces=1:1;
                                                   Editable=No }
    { 20  ;   ;Calcd. Current Value (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Calcd. Current Value (LCY)" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                           Active=CONST(Yes)));
                                                   CaptionML=[ENU=Calcd. Current Value (LCY);
                                                              DEA=Berech. aktueller Wert (MW)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 21  ;   ;Chances of Success %;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Opportunity Entry"."Chances of Success %" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                        Active=CONST(Yes)));
                                                   CaptionML=[ENU=Chances of Success %;
                                                              DEA=Erfolgschancen %];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 22  ;   ;Completed %         ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Opportunity Entry"."Completed %" WHERE (Opportunity No.=FIELD(No.),
                                                                                                               Active=CONST(Yes)));
                                                   CaptionML=[ENU=Completed %;
                                                              DEA=Abgeschlossen %];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 23  ;   ;Contact Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact No.)));
                                                   CaptionML=[ENU=Contact Name;
                                                              DEA=Kontaktname];
                                                   Editable=No }
    { 24  ;   ;Contact Company Name;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Contact Company No.)));
                                                   CaptionML=[ENU=Contact Company Name;
                                                              DEA=Kontakt Unternehmensname];
                                                   Editable=No }
    { 25  ;   ;Salesperson Name    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Salesperson/Purchaser.Name WHERE (Code=FIELD(Salesperson Code)));
                                                   CaptionML=[ENU=Salesperson Name;
                                                              DEA=Verk„ufername];
                                                   Editable=No }
    { 26  ;   ;Campaign Description;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Campaign.Description WHERE (No.=FIELD(Campaign No.)));
                                                   CaptionML=[ENU=Campaign Description;
                                                              DEA=Kampagnenbeschreibung];
                                                   Editable=No }
    { 27  ;   ;Segment No.         ;Code20        ;TableRelation="Segment Header";
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Segment No.;
                                                              DEA=Segmentnr.] }
    { 28  ;   ;Estimated Closing Date;Date        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Opportunity Entry"."Estimated Close Date" WHERE (Opportunity No.=FIELD(No.),
                                                                                                                        Active=CONST(Yes)));
                                                   CaptionML=[ENU=Estimated Closing Date;
                                                              DEA=Erwartetes Abschlussdatum];
                                                   Editable=No }
    { 29  ;   ;Sales Document Type ;Option        ;OnValidate=BEGIN
                                                                IF "Sales Document Type" = xRec."Sales Document Type" THEN
                                                                  EXIT;
                                                                IF "Sales Document Type" = "Sales Document Type"::" " THEN
                                                                  VALIDATE("Sales Document No.",'');
                                                              END;

                                                   CaptionML=[ENU=Sales Document Type;
                                                              DEA=Verkaufsbelegart];
                                                   OptionCaptionML=[ENU=" ,Quote,Order,Posted Invoice";
                                                                    DEA=" ,Angebot,Auftrag,Gebuchte Rechnung"];
                                                   OptionString=[ ,Quote,Order,Posted Invoice] }
    { 30  ;   ;No. of Interactions ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (Opportunity No.=FIELD(FILTER(No.)),
                                                                                                    Canceled=CONST(No),
                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[ENU=No. of Interactions;
                                                              DEA=Anzahl Aktivit„ten];
                                                   Editable=No }
    { 9501;   ;Wizard Step         ;Option        ;CaptionML=[ENU=Wizard Step;
                                                              DEA=Assistentenschritt];
                                                   OptionCaptionML=[ENU=" ,1,2,3,4,5,6";
                                                                    DEA=" ,1,2,3,4,5,6"];
                                                   OptionString=[ ,1,2,3,4,5,6];
                                                   Editable=No }
    { 9502;   ;Activate First Stage;Boolean       ;CaptionML=[ENU=Activate First Stage;
                                                              DEA=Erste Stufe aktivieren] }
    { 9503;   ;Segment Description ;Text50        ;CaptionML=[ENU=Segment Description;
                                                              DEA=Segmentbeschreibung] }
    { 9504;   ;Wizard Estimated Value (LCY);Decimal;
                                                   CaptionML=[ENU=Wizard Estimated Value (LCY);
                                                              DEA=Assistent fr erwarteten Wert (MW)];
                                                   AutoFormatType=1 }
    { 9505;   ;Wizard Chances of Success %;Decimal;CaptionML=[ENU=Wizard Chances of Success %;
                                                              DEA=Assistent fr Erfolgschancen %];
                                                   DecimalPlaces=0:0 }
    { 9506;   ;Wizard Estimated Closing Date;Date ;CaptionML=[ENU=Wizard Estimated Closing Date;
                                                              DEA=Assistent fr erwartetes Abschlussdatum] }
    { 9507;   ;Wizard Contact Name ;Text50        ;CaptionML=[ENU=Wizard Contact Name;
                                                              DEA=Assistent fr Kontaktname] }
    { 9508;   ;Wizard Campaign Description;Text50 ;CaptionML=[ENU=Wizard Campaign Description;
                                                              DEA=Assistent fr Kampagnenbeschreibung] }
    { 50000;  ;CM Is Workorder     ;Boolean       ;CaptionML=[ENU=Is Workorder;
                                                              DEA=Ist Arbeitsauftrag] }
    { 50010;  ;CM Source           ;Option        ;CaptionML=[ENU=Source;
                                                              DEA=Herkunft];
                                                   OptionString=Standard,Alarm,Recuring,Request,Manual Alarm }
    { 50020;  ;CM Source Description;Text50       ;CaptionML=[ENU=Source Description;
                                                              DEA=Herkunftsbeschreibung] }
    { 50090;  ;CM Objecttype       ;Option        ;OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_CMObjectType(Rec, xRec);
                                                              END;

                                                   CaptionML=[ENU=Objecttype;
                                                              DEA=Objeckttyp];
                                                   OptionString=Asset,Project }
    { 50100;  ;CM Object No.       ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=FIELD(CM Objecttype));
                                                   OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_CMObjectNo(Rec, xRec);
                                                              END;

                                                   CaptionML=[ENU=Object No.;
                                                              DEA=Objektnr.] }
    { 50110;  ;CM Object Name      ;Text50        ;CaptionML=[ENU=Object Name;
                                                              DEA=Objektname];
                                                   Editable=No }
    { 50111;  ;CM Object Name 2    ;Text100       ;CaptionML=[ENU=Object Name 2;
                                                              DEA=Objektname 2];
                                                   Editable=No }
    { 50200;  ;CM Work Order Type Code;Code10     ;TableRelation=Activity.Code;
                                                   OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_CMWorkorderTypeCode(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Workorder Type Code;
                                                              DEA=Arbeitsauftrag Typ Code] }
    { 50210;  ;CM Work Order Type Descr.;Text50   ;CaptionML=[ENU=Workorder Type Description;
                                                              DEA=Arbeitsauftrag Typ Beschreibung] }
    { 50300;  ;CM Status           ;Option        ;OnValidate=BEGIN
                                                                //New = Newly created,
                                                                //Open = Assigned to User and ready to be done
                                                                //In Process = Some Tasks are Completed, some are open
                                                                //Completed = All Tasks are Done, but Approval from Plant Manager needed
                                                                //Done = All Tasks are Done, Plant Manager Approved
                                                                //Closed = Closed by Plant Manager
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionString=New,Open,In Process,Completed,Done,Discarded }
    { 50400;  ;CM Due Date         ;Date          ;OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_DueDates(Rec, xRec);
                                                              END;

                                                   CaptionML=[ENU=Due Date;
                                                              DEA=F„lligkeitsdatum] }
    { 50410;  ;CM Scheduled Due Date;Date         ;OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_DueDates(Rec, xRec);
                                                              END;

                                                   CaptionML=[ENU=Scheduled Due Date (Planned);
                                                              DEA=Geplantes F„lligkeitsdatum] }
    { 50700;  ;CM Assigned User ID ;Code50        ;TableRelation="User Setup"."User ID";
                                                   OnValidate=BEGIN
                                                                CMWoMgt.OnValidate_CMAssignedUserID(Rec,xRec);
                                                              END;

                                                   CaptionML=[ENU=Assigned User ID;
                                                              DEA=Zugewiesener Benutzer ID] }
    { 50705;  ;CM Assigned User Name;Text80       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(CM Assigned User ID)));
                                                   CaptionML=[ENU=Assigned User Name;
                                                              DEA=Zugwiesener Benutzername];
                                                   Description=FF;
                                                   Editable=No }
    { 50810;  ;CM Created By User ID;Code50       ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=Created By User ID;
                                                              DEA=Erstell von Benutzer ID];
                                                   Editable=No }
    { 50840;  ;CM Created Datetime ;DateTime       }
    { 60200;  ;CM Done Pos. Tasks  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Task),
                                                                                  Opportunity No.=FIELD(No.),
                                                                                  CM Status=CONST(Done Positive),
                                                                                  CM Maintask No.=CONST()));
                                                   CaptionML=[ENU=Positive Done Tasks;
                                                              DEA=Positiv Erledig. Aufgaben] }
    { 60300;  ;CM Done Neg. Tasks  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Task),
                                                                                  Opportunity No.=FIELD(No.),
                                                                                  CM Status=CONST(Done Negative),
                                                                                  CM Maintask No.=CONST()));
                                                   CaptionML=[ENU=Negative Done Tasks;
                                                              DEA=Negativ Erledig. Aufgaben] }
    { 60400;  ;CM Billing Info     ;Option        ;CaptionML=ENU=Billing Info;
                                                   OptionString=[ ,Billable,Included in contract,Internal costs] }
    { 60410;  ;CM Internal         ;Boolean       ;CaptionML=[ENU=Internal;
                                                              DEA=Intern] }
    { 60420;  ;CM Status Change Standard Text;Option;
                                                   CaptionML=ENU=Status Change Standard Text;
                                                   OptionString=[ ,False alarm,Alarm condition disappeared,Technician has been informed,Work started,Technician is on site,Technician is on the way,Operational work has been finished,Work Order needs to be invoiced,Plant back in production,Alarm solved,Communication issue,Internet connection problem,On-Site Check has been scheduled];
                                                   Editable=No }
    { 60500;  ;CM Open Tasks       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Task),
                                                                                  Opportunity No.=FIELD(No.),
                                                                                  CM Status=CONST(Open),
                                                                                  CM Subtype=CONST(" ")));
                                                   CaptionML=[ENU=Open Tasks;
                                                              DEA=Offene Tasks];
                                                   Description=FF;
                                                   Editable=No }
    { 60510;  ;CM Finished Tasks   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Task),
                                                                                  Opportunity No.=FIELD(No.),
                                                                                  CM Status=FILTER(<>Open),
                                                                                  CM Subtype=CONST(" ")));
                                                   CaptionML=[ENU=Finished Tasks;
                                                              DEA=Erledigte Tasks];
                                                   Description=FF;
                                                   Editable=No }
    { 60521;  ;CM All Tasks Finished;Boolean      ;FieldClass=FlowField;
                                                   CalcFormula=-Exist(To-do WHERE (CM Type=CONST(Task),
                                                                                   Opportunity No.=FIELD(No.),
                                                                                   CM Status=CONST(Open),
                                                                                   CM Subtype=CONST(" ")));
                                                   CaptionML=[ENU=All Tasks Finished;
                                                              DEA=Alle Tasks Erledigt];
                                                   Description=FF;
                                                   Editable=No }
    { 60530;  ;CM Subcontractor No.;Code20        ;TableRelation=Contact.No.;
                                                   CaptionML=[ENU=Subcontractor No.;
                                                              DEA=Sublieferant Nr.] }
    { 60540;  ;CM Email Notification;Boolean      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object"."Email Notification" WHERE (Objecttype=FIELD(CM Objecttype),
                                                                                                                No.=FIELD(CM Object No.)));
                                                   CaptionML=ENU=Email Notification;
                                                   Description=FF;
                                                   Editable=No }
    { 61000;  ;CM GPM Ticket Id    ;Integer       ;CaptionML=[ENU=Ticket ID;
                                                              DEA=Ticket ID] }
    { 61001;  ;CM GPM Ticket Name  ;Text150       ;CaptionML=ENU=Ticket Name }
    { 61010;  ;CM GPM Grouping     ;Option        ;CaptionML=[ENU=Grouping;
                                                              DEA=Grouping];
                                                   OptionString=[ ,Communications,Production,Warnings,Manuals,Scheduled] }
    { 61020;  ;CM GPM Activated DateTime;DateTime ;CaptionML=[ENU=Activated DateTime;
                                                              DEA=Activated DateTime] }
    { 61021;  ;CM GPM Activated Date;Date         ;CaptionML=[ENU=Activated Date;
                                                              DEA=Activated Date] }
    { 61022;  ;CM GPM Activated Time;Time         ;CaptionML=[ENU=Activated Time;
                                                              DEA=Activated Time] }
    { 61030;  ;CM GPM Deactivated DateTime;DateTime;
                                                   CaptionML=[ENU=Deactivated DateTime;
                                                              DEA=Deactivated DateTime] }
    { 61031;  ;CM GPM Deactivated Date;Date       ;CaptionML=[ENU=Deactivated Date;
                                                              DEA=Deactivated Date] }
    { 61032;  ;CM GPM Deactivated Time;Time       ;CaptionML=[ENU=Deactivated Time;
                                                              DEA=Deactivated Time] }
    { 61033;  ;CM GPM Reference Element ID;Integer;CaptionML=ENU=Reference Element ID }
    { 61034;  ;CM GPM Reference Element Name;Text250;
                                                   CaptionML=ENU=Reference Element Name }
    { 61040;  ;CM GPM Prority      ;Integer       ;CaptionML=[ENU=Priority;
                                                              DEA=Priority] }
    { 61050;  ;CM GPM State        ;Option        ;CaptionML=[ENU=PV+ Alarm State;
                                                              DEA=PV+ Alarm State];
                                                   OptionString=[ ,Activated,Assigned,Deactivated,Deactivated and Assigned] }
    { 61060;  ;CM GPM Alert Type   ;Option        ;CaptionML=[ENU=Alert Type;
                                                              DEA=Alert Type];
                                                   OptionString=[ ,Usual Alert,Alert with Ticket] }
    { 61070;  ;CM GPM Activation Description;BLOB ;CaptionML=[ENU=Activation Description;
                                                              DEA=Activation Description] }
    { 61080;  ;CM GPM Deactivation Descr.;BLOB    ;CaptionML=[ENU=Deactivation Description;
                                                              DEA=Deactivation Description] }
    { 61090;  ;CM GPM Activation Details;BLOB     ;CaptionML=[ENU=Activation Details;
                                                              DEA=Activation Details] }
    { 61100;  ;CM GPM Deactivation Details;BLOB   ;CaptionML=[ENU=Deactivation Details;
                                                              DEA=Deactivation Details] }
    { 61101;  ;CM GPM Plant ID     ;Integer       ;CaptionML=ENU=GPM Plant ID }
    { 61110;  ;CM GPM Affects Availibility;Boolean;CaptionML=[ENU=Affects Availibility;
                                                              DEA=Affects Availibility] }
    { 61120;  ;CM GPM Calculate Loss;Boolean      ;CaptionML=[ENU=Calculate Loss;
                                                              DEA=Calculate Loss] }
    { 61130;  ;CM GPM Problem Description;BLOB    ;CaptionML=[ENU=Problem Description;
                                                              DEA=Problem Description] }
    { 61140;  ;CM GPM Company      ;Text50        ;CaptionML=[ENU=Company;
                                                              DEA=Company] }
    { 61150;  ;CM GPM Ticket Duration;Integer     ;CaptionML=[ENU=Ticket Durations;
                                                              DEA=Ticket Durations] }
    { 61160;  ;CM GPM Actions Performed;BLOB      ;CaptionML=[ENU=Actions Performed;
                                                              DEA=Actions Performed] }
    { 61170;  ;CM GPM Maintenance Type;Option     ;CaptionML=[ENU=Maintenance Type;
                                                              DEA=Maintenance Type];
                                                   OptionString=[ ,Undefined Maintenance,NotSpecified Maintenance,Corrective Maintenance,Preventive Maintenance,Deductive Maintenance] }
    { 61180;  ;CM GPM Notified DateTime;DateTime  ;CaptionML=[ENU=Notified DateTime;
                                                              DEA=Notified DateTime] }
    { 61181;  ;CM GPM Notified Date;Date          ;CaptionML=[ENU=Notified Date;
                                                              DEA=Notified Date] }
    { 61182;  ;CM GPM Notified Time;Time          ;CaptionML=[ENU=Notified Time;
                                                              DEA=Notified Time] }
    { 62000;  ;CM GPM No. of Updates;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS GPM Ticket Archive" WHERE (ticket_id=FIELD(CM GPM Ticket Id),
                                                                                                      Workorder No.=FIELD(No.)));
                                                   CaptionML=[ENU=No. Of Updates;
                                                              DEA=No. Of Updates];
                                                   Description=FF;
                                                   Editable=No }
    { 70000;  ;CM Is Temporary     ;Boolean       ;CaptionML=[ENU=Is Temporary;
                                                              DEA=Ist Tempor„r] }
    { 90000;  ;CM Show Workorder   ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (Opportunity No.=FIELD(No.),
                                                                                  CM Assigned User ID=FIELD(CM User ID Filter),
                                                                                  CM Status=CONST(Open),
                                                                                  CM Type=CONST(Task),
                                                                                  CM Subtype=FILTER(' '|Team)));
                                                   CaptionML=ENU=CM Show Workorder;
                                                   Description=FF;
                                                   Editable=No }
    { 90100;  ;CM User ID Filter   ;Text250       ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=User ID Filter;
                                                              DEA=Benutzer-ID-Filter] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Contact Company No.,Contact No.,Closed   }
    {    ;Salesperson Code,Closed                  }
    {    ;Campaign No.,Closed                      }
    {    ;Segment No.,Closed                       }
    {    ;Sales Document Type,Sales Document No.   }
    {    ;CM Is Workorder,CM Object No.            }
    {    ;CM Is Workorder,CM Objecttype,CM Object No.,CM Source,CM Source Description,Creation Date }
    {    ;CM Is Workorder,CM Status,CM Source      }
    {    ;CM Is Workorder,CM Source                }
    {    ;CM Is Workorder,CM Assigned User ID      }
    {    ;CM Is Workorder,Priority,CM Objecttype,CM Object No. }
    {    ;CM Is Workorder,CM Objecttype,CM Object No.,Priority }
    {    ;CM Is Workorder,CM Objecttype,CM Object No.,No. }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Description,Creation Date,Status     }
    { 2   ;Brick               ;No.,Description,CM Status,CM Object Name,Priority,CM GPM Activated Date }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'ENU=You cannot delete this opportunity while it is active.;DEA=Sie k”nnen diese Verkaufschance nicht l”schen, solange sie in Bearbeitung ist.';
      Text001@1001 : TextConst 'ENU=You cannot create opportunities on an empty segment.;DEA=Sie k”nnen keine Verkaufschancen fr ein leeres Segment erstellen.';
      Text002@1002 : TextConst 'ENU=Do you want to create an opportunity for all contacts in the %1 segment?;DEA=M”chten Sie eine Verkaufschance fr alle Kontakte im Segment %1 erstellen?';
      Text003@1009 : TextConst 'ENU=There is no sales quote that is assigned to this opportunity.;DEA=Dieser Verkaufschance ist kein Verkaufsangebot zugeordnet.';
      Text004@1003 : TextConst 'ENU=Sales quote %1 does not exist.;DEA=Das Verkaufsangebot ''%1'' ist nicht vorhanden.';
      Text005@1005 : TextConst 'ENU=You cannot assign a sales quote to the %2 record of the %1 while the %2 record of the %1 has no contact company assigned.;DEA=Sie k”nnen dem Datensatz %2 kein Angebot von %1 zuweisen, solange dem Datensatz %2 von %1 kein Kontaktunternehmen zugewiesen ist.';
      RMSetup@1011 : Record 5079;
      Opp@1012 : Record 5092;
      RMCommentLine@1013 : Record 5061;
      SegHeader@1018 : Record 5076;
      OppEntry@1020 : Record 5093;
      RMCommentLineTmp@1022 : TEMPORARY Record 5061;
      NoSeriesMgt@1014 : Codeunit 396;
      Text006@1004 : TextConst 'ENU=Sales %1 %2 is already assigned to opportunity %3.;DEA=Verkauf %1 %2 wurde bereits der Verkaufschance %3 zugewiesen.';
      Text008@1007 : TextConst 'ENU=Do you want to change %1 on the related open to-dos with the same %1?;DEA=M”chten Sie den %1 in den zugeh”rigen offenen Aufgaben mit derselben/demselben %1 „ndern?';
      Text009@1008 : TextConst 'ENU=Contact %1 %2 is related to another company.;DEA=Kontakt %1 %2 ist mit einem anderen Unternehmen verknpft.';
      Text011@1010 : TextConst 'ENU=A sales quote has already been assigned to this opportunity.;DEA=Dieser Verkaufschance wurde bereits ein Verkaufsangebot zugewiesen.';
      Text012@1017 : TextConst 'ENU=Current process @1@@@@@@@@@@@@@@@\;DEA=Aktueller Prozess @1@@@@@@@@@@@@@@@\';
      Text013@1016 : TextConst 'ENU=Current status  #2###############;DEA=Aktueller Status  #2###############';
      Text014@1015 : TextConst 'ENU=Updating To-dos;DEA=Aufgaben werden aktualisiert';
      Text022@1026 : TextConst 'ENU=You must fill in the %1 field.;DEA=Sie mssen das Feld %1 ausfllen.';
      Text023@1025 : TextConst 'ENU=You must fill in the contact that is involved in the opportunity.;DEA=Sie mssen den Kontakt, auf den sich diese Verkaufschance bezieht, ausfllen.';
      Text024@1024 : TextConst 'ENU=%1 must be greater than 0.;DEA=%1 muss gr”áer als 0 sein.';
      Text025@1023 : TextConst 'ENU=The Estimated closing date has to be later than this change;DEA=Das erwartete Abschlussdatum muss nach dem Datum dieser Žnderung liegen';
      NoCustomerErr@1006 : TextConst '@@@=%1 - Contact No;ENU=There is no customer related to contact %1, which is specified in the opportunity.;DEA=Dem Kontakt %1, der in der Verkaufschance angegeben ist, ist kein Debitor zugeordnet.';
      CMWoMgt@1000000000 : Codeunit 70030;

    PROCEDURE CreateOppFromOpp@1(VAR Opp@1007 : Record 5092);
    VAR
      Cont@1001 : Record 5050;
      SalesPurchPerson@1002 : Record 13;
      Campaign@1003 : Record 5071;
      SegHeader@1004 : Record 5076;
      SegLine@1005 : Record 5077;
      SalesCycle@1006 : Record 5090;
    BEGIN
      DELETEALL;
      INIT;
      "Creation Date" := WORKDATE;
      RMSetup.GET;
      IF RMSetup."Default Sales Cycle Code" <> '' THEN
        IF SalesCycle.GET(RMSetup."Default Sales Cycle Code") THEN
          IF NOT SalesCycle.Blocked THEN
            "Sales Cycle Code" := RMSetup."Default Sales Cycle Code";
      IF Cont.GET(Opp.GETFILTER("Contact Company No.")) THEN BEGIN
        VALIDATE("Contact No.",Cont."No.");
        "Salesperson Code" := Cont."Salesperson Code";
        SETRANGE("Contact Company No.","Contact No.");
      END;
      IF Cont.GET(Opp.GETFILTER("Contact No.")) THEN BEGIN
        VALIDATE("Contact No.",Cont."No.");
        "Salesperson Code" := Cont."Salesperson Code";
        SETRANGE("Contact No.","Contact No.");
      END;
      IF SalesPurchPerson.GET(Opp.GETFILTER("Salesperson Code")) THEN BEGIN
        "Salesperson Code" := SalesPurchPerson.Code;
        SETRANGE("Salesperson Code","Salesperson Code");
      END;
      IF Campaign.GET(Opp.GETFILTER("Campaign No.")) THEN BEGIN
        "Campaign No." := Campaign."No.";
        "Salesperson Code" := Campaign."Salesperson Code";
        SETRANGE("Campaign No.","Campaign No.");
      END;
      IF SegHeader.GET(Opp.GETFILTER("Segment No.")) THEN BEGIN
        SegLine.SETRANGE("Segment No.",SegHeader."No.");
        IF SegLine.COUNT = 0 THEN
          ERROR(Text001);
        "Segment No." := SegHeader."No.";
        "Campaign No." := SegHeader."Campaign No.";
        "Salesperson Code" := SegHeader."Salesperson Code";
        SETRANGE("Segment No.","Segment No.");
      END;

      StartWizard;
    END;

    LOCAL PROCEDURE InsertOpportunity@3(VAR Opp2@1000 : Record 5092;OppEntry2@1004 : Record 5093;VAR RMCommentLineTmp@1007 : Record 5061;ActivateFirstStage@1006 : Boolean);
    VAR
      SegHeader@1001 : Record 5076;
      SegLine@1002 : Record 5077;
      SalesCycleStage@1003 : Record 5091;
      OppEntry@1005 : Record 5093;
    BEGIN
      Opp := Opp2;

      IF ActivateFirstStage THEN BEGIN
        SalesCycleStage.RESET;
        SalesCycleStage.SETRANGE("Sales Cycle Code",Opp."Sales Cycle Code");
        IF SalesCycleStage.FINDFIRST THEN
          OppEntry2."Sales Cycle Stage" := SalesCycleStage.Stage;
      END;

      IF SegHeader.GET(GETFILTER("Segment No.")) THEN BEGIN
        SegLine.SETRANGE("Segment No.",SegHeader."No.");
        SegLine.SETFILTER("Contact No.",'<>%1','');
        IF SegLine.FIND('-') THEN BEGIN
          IF CONFIRM(Text002,TRUE,SegHeader."No.") THEN
            REPEAT
              Opp."Contact No." := SegLine."Contact No.";
              Opp."Contact Company No." := SegLine."Contact Company No.";
              CLEAR(Opp."No.");
              Opp.INSERT(TRUE);
              CreateCommentLines(RMCommentLineTmp,Opp."No.");
              IF ActivateFirstStage THEN BEGIN
                OppEntry.INIT;
                OppEntry := OppEntry2;
                OppEntry.InitOpportunityEntry(Opp);
                OppEntry.InsertEntry(OppEntry,FALSE,TRUE);
                OppEntry.UpdateEstimates;
              END;
            UNTIL SegLine.NEXT = 0;
        END;
      END ELSE BEGIN
        Opp.INSERT(TRUE);
        CreateCommentLines(RMCommentLineTmp,Opp."No.");
        IF ActivateFirstStage THEN BEGIN
          OppEntry.INIT;
          OppEntry := OppEntry2;
          OppEntry.InitOpportunityEntry(Opp);
          OppEntry.InsertEntry(OppEntry,FALSE,TRUE);
          OppEntry.UpdateEstimates;
        END;
      END;
    END;

    PROCEDURE UpdateOpportunity@4();
    VAR
      TempOppEntry@1000 : TEMPORARY Record 5093;
    BEGIN
      IF "No." <> '' THEN
        TempOppEntry.UpdateOppFromOpp(Rec);
    END;

    PROCEDURE CloseOpportunity@5();
    VAR
      TempOppEntry@1000 : TEMPORARY Record 5093;
    BEGIN
      IF "No." <> '' THEN
        TempOppEntry.CloseOppFromOpp(Rec);
    END;

    PROCEDURE AssignQuote@6();
    VAR
      Cont@1001 : Record 5050;
      ContactBusinessRelation@1002 : Record 5054;
      SalesHeader@1000 : Record 36;
    BEGIN
      Cont.GET("Contact No.");

      IF (Cont.Type = Cont.Type::Person) AND (Cont."Company No." = '') THEN
        ERROR(
          Text005,
          Cont.TABLECAPTION,Cont."No.");

      ContactBusinessRelation.SETRANGE("Contact No.","Contact No.");
      ContactBusinessRelation.SETRANGE("Link to Table",ContactBusinessRelation."Link to Table"::Customer);
      IF ContactBusinessRelation.ISEMPTY THEN
        ERROR(NoCustomerErr,"Contact No.");

      TESTFIELD(Status,Status::"In Progress");

      IF NOT SalesHeader.GET(SalesHeader."Document Type"::Quote,"Sales Document No.") THEN BEGIN
        SalesHeader.SETRANGE("Sell-to Contact No.",Cont."No.");
        SalesHeader.INIT;
        SalesHeader."Document Type" := SalesHeader."Document Type"::Quote;
        SalesHeader.INSERT(TRUE);
        SalesHeader.VALIDATE("Salesperson Code","Salesperson Code");
        SalesHeader.VALIDATE("Campaign No.","Campaign No.");
        SalesHeader."Opportunity No." := "No.";
        SalesHeader."Order Date" := GetEstimatedClosingDate;
        SalesHeader."Shipment Date" := SalesHeader."Order Date";
        SalesHeader.MODIFY;
        "Sales Document Type" := "Sales Document Type"::Quote;
        "Sales Document No." := SalesHeader."No.";
        MODIFY;
      END ELSE
        ERROR(Text011);
      PAGE.RUN(PAGE::"Sales Quote",SalesHeader);
    END;

    LOCAL PROCEDURE GetEstimatedClosingDate@8() : Date;
    VAR
      OppEntry@1000 : Record 5093;
    BEGIN
      OppEntry.SETCURRENTKEY(Active,"Opportunity No.");
      OppEntry.SETRANGE(Active,TRUE);
      OppEntry.SETRANGE("Opportunity No.","No.");
      IF OppEntry.FINDFIRST THEN
        EXIT(OppEntry."Estimated Close Date");
    END;

    PROCEDURE ShowQuote@2();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      IF SalesHeader.GET(SalesHeader."Document Type"::Quote,"Sales Document No.") THEN
        PAGE.RUNMODAL(PAGE::"Sales Quote",SalesHeader);
    END;

    LOCAL PROCEDURE CreateCommentLines@7(VAR RMCommentLineTmp@1001 : Record 5061;OppNo@1000 : Code[20]);
    BEGIN
      IF RMCommentLineTmp.FIND('-') THEN
        REPEAT
          RMCommentLine.INIT;
          RMCommentLine := RMCommentLineTmp;
          RMCommentLine."No." := OppNo;
          RMCommentLine.INSERT;
        UNTIL RMCommentLineTmp.NEXT = 0;
    END;

    LOCAL PROCEDURE StartWizard@11();
    VAR
      Cont@1000 : Record 5050;
      Campaign@1001 : Record 5071;
      SegHeader@1002 : Record 5076;
    BEGIN
      "Wizard Step" := "Wizard Step"::"1";

      IF Cont.GET(GETFILTER("Contact No.")) THEN
        "Wizard Contact Name" := Cont.Name
      ELSE
        IF Cont.GET(GETFILTER("Contact Company No.")) THEN
          "Wizard Contact Name" := Cont.Name;

      IF Campaign.GET(GETFILTER("Campaign No.")) THEN
        "Wizard Campaign Description" := Campaign.Description;
      IF SegHeader.GET(GETFILTER("Segment No.")) THEN
        "Segment Description" := SegHeader.Description;

      INSERT;
      PAGE.RUNMODAL(PAGE::"Create Opportunity",Rec);
    END;

    PROCEDURE PerformNextWizardStatus@9();
    VAR
      Cont@1001 : Record 5050;
    BEGIN
      "Wizard Step" := "Wizard Step" + 1;

      IF "Wizard Step" = "Wizard Step"::"2" THEN BEGIN
        CLEAR(Cont);
        IF Cont.GET(GETFILTER("Contact No.")) THEN
          "Contact Name" := Cont.Name
        ELSE
          IF Cont.GET(GETFILTER("Contact Company No.")) THEN
            "Contact Name" := Cont.Name;
      END;
    END;

    PROCEDURE PerformPrevWizardStatus@12();
    BEGIN
      "Wizard Step" := "Wizard Step" - 1;
    END;

    PROCEDURE CheckStatus@16();
    BEGIN
      CASE "Wizard Step" OF
        "Wizard Step"::"1":
          BEGIN
            IF "Creation Date" = 0D THEN
              ErrorMessage(FIELDCAPTION("Creation Date"));
            IF Description = '' THEN
              ErrorMessage(FIELDCAPTION(Description));
          END;
        "Wizard Step"::"2":
          BEGIN
            IF NOT SegHeader.GET(GETFILTER("Segment No.")) THEN
              IF "Contact No." = '' THEN
                ERROR(Text023);
            IF "Salesperson Code" = '' THEN
              ErrorMessage(FIELDCAPTION("Salesperson Code"));
            IF "Sales Cycle Code" = '' THEN
              ErrorMessage(FIELDCAPTION("Sales Cycle Code"));
          END;
        "Wizard Step"::"4":
          IF "Activate First Stage" THEN BEGIN
            IF "Wizard Estimated Value (LCY)" <= 0 THEN
              ERROR(Text024,FIELDCAPTION("Wizard Estimated Value (LCY)"));
            IF "Wizard Chances of Success %" <= 0 THEN
              ERROR(Text024,FIELDCAPTION("Wizard Chances of Success %"));
            IF "Wizard Estimated Closing Date" = 0D THEN
              ErrorMessage(FIELDCAPTION("Wizard Estimated Closing Date"));
            IF "Wizard Estimated Closing Date" < OppEntry."Date of Change" THEN
              ERROR(Text025);
          END;
      END;
    END;

    PROCEDURE FinishWizard@18() : Boolean;
    VAR
      ActivateFirstStage@1000 : Boolean;
    BEGIN
      "Wizard Step" := Opp."Wizard Step"::" ";
      ActivateFirstStage := "Activate First Stage";
      "Activate First Stage" := FALSE;
      OppEntry."Chances of Success %" := "Wizard Chances of Success %";
      OppEntry."Estimated Close Date" := "Wizard Estimated Closing Date";
      OppEntry."Estimated Value (LCY)" := "Wizard Estimated Value (LCY)";

      "Wizard Chances of Success %" := 0;
      "Wizard Estimated Closing Date" := 0D;
      "Wizard Estimated Value (LCY)" := 0;
      "Segment Description" := '';
      "Wizard Contact Name" := '';
      "Wizard Campaign Description" := '';

      InsertOpportunity(Rec,OppEntry,RMCommentLineTmp,ActivateFirstStage);
      DELETE;
    END;

    LOCAL PROCEDURE ErrorMessage@10(FieldName@1000 : Text[1024]);
    BEGIN
      ERROR(Text022,FieldName);
    END;

    LOCAL PROCEDURE ShowComments@13();
    BEGIN
      RMCommentLineTmp.SETRANGE("Table Name",RMCommentLineTmp."Table Name"::Opportunity);
      RMCommentLineTmp.SETRANGE("No.","No.");
      RMCommentLineTmp.SETRANGE("Sub No.",0);
      PAGE.RUNMODAL(PAGE::"Rlshp. Mgt. Comment Sheet",RMCommentLineTmp);
    END;

    LOCAL PROCEDURE CommentsExist@14() : Boolean;
    BEGIN
      EXIT(NOT RMCommentLineTmp.ISEMPTY)
    END;

    LOCAL PROCEDURE GetComments@64(VAR RMCommentLine@1001 : Record 5061);
    BEGIN
      RMCommentLine.DELETEALL;
      IF RMCommentLineTmp.FIND('-') THEN
        REPEAT
          RMCommentLine := RMCommentLineTmp;
          RMCommentLine.INSERT;
        UNTIL RMCommentLineTmp.NEXT = 0;
    END;

    PROCEDURE SetComments@53(VAR RMCommentLine@1001 : Record 5061);
    BEGIN
      RMCommentLineTmp.DELETEALL;

      IF RMCommentLine.FINDSET THEN
        REPEAT
          RMCommentLineTmp := RMCommentLine;
          RMCommentLineTmp.INSERT;
        UNTIL RMCommentLine.NEXT = 0;
    END;

    PROCEDURE ShowSalesQuoteWithCheck@15();
    VAR
      SalesHeader@1000 : Record 36;
    BEGIN
      IF ("Sales Document Type" <> "Sales Document Type"::Quote) OR
         ("Sales Document No." = '')
      THEN
        ERROR(Text003);

      IF NOT SalesHeader.GET(SalesHeader."Document Type"::Quote,"Sales Document No.") THEN
        ERROR(Text004,"Sales Document No.");
      PAGE.RUN(PAGE::"Sales Quote",SalesHeader);
    END;

    BEGIN
    END.
  }
}

OBJECT Table 5714 Responsibility Center
{
  OBJECT-PROPERTIES
  {
    Date=30.09.16;
    Time=13:41:10;
    Modified=Yes;
    Version List=NAVW19.00,CMMS;
  }
  PROPERTIES
  {
    OnDelete=BEGIN
               DimMgt.DeleteDefaultDim(DATABASE::"Responsibility Center",Code);
             END;

    CaptionML=[ENU=Responsibility Center;
               DEA=Zust„ndigkeitseinheitencode];
    LookupPageID=Page5715;
    DrillDownPageID=Page5715;
  }
  FIELDS
  {
    { 1   ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              DEA=Code];
                                                   NotBlank=Yes }
    { 2   ;   ;Name                ;Text50        ;CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 3   ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              DEA=Adresse] }
    { 4   ;   ;Address 2           ;Text50        ;CaptionML=[ENU=Address 2;
                                                              DEA=Adresse 2] }
    { 5   ;   ;City                ;Text30        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code".City
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code".City WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidateCity(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=City;
                                                              DEA=Ort] }
    { 6   ;   ;Post Code           ;Code20        ;TableRelation=IF (Country/Region Code=CONST()) "Post Code"
                                                                 ELSE IF (Country/Region Code=FILTER(<>'')) "Post Code" WHERE (Country/Region Code=FIELD(Country/Region Code));
                                                   OnValidate=BEGIN
                                                                PostCode.ValidatePostCode(City,"Post Code",County,"Country/Region Code",(CurrFieldNo <> 0) AND GUIALLOWED);
                                                              END;

                                                   ValidateTableRelation=No;
                                                   TestTableRelation=No;
                                                   CaptionML=[ENU=Post Code;
                                                              DEA=PLZ-Code] }
    { 7   ;   ;Country/Region Code ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=[ENU=Country/Region Code;
                                                              DEA=L„nder-/Regionscode] }
    { 8   ;   ;Phone No.           ;Text30        ;ExtendedDatatype=Phone No.;
                                                   CaptionML=[ENU=Phone No.;
                                                              DEA=Telefonnr.] }
    { 9   ;   ;Fax No.             ;Text30        ;CaptionML=[ENU=Fax No.;
                                                              DEA=Faxnr.] }
    { 10  ;   ;Name 2              ;Text50        ;CaptionML=[ENU=Name 2;
                                                              DEA=Name 2] }
    { 11  ;   ;Contact             ;Text50        ;CaptionML=[ENU=Contact;
                                                              DEA=Kontakt] }
    { 12  ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 1 Code;
                                                              DEA=Globaler Dimensionscode 1];
                                                   CaptionClass='1,1,1' }
    { 13  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[ENU=Global Dimension 2 Code;
                                                              DEA=Globaler Dimensionscode 2];
                                                   CaptionClass='1,1,2' }
    { 14  ;   ;Location Code       ;Code10        ;TableRelation=Location WHERE (Use As In-Transit=CONST(No));
                                                   CaptionML=[ENU=Location Code;
                                                              DEA=Lagerortcode] }
    { 15  ;   ;County              ;Text30        ;CaptionML=[ENU=County;
                                                              DEA=Bundesregion] }
    { 102 ;   ;E-Mail              ;Text80        ;ExtendedDatatype=E-Mail;
                                                   CaptionML=[ENU=E-Mail;
                                                              DEA=E-Mail] }
    { 103 ;   ;Home Page           ;Text90        ;ExtendedDatatype=URL;
                                                   CaptionML=[ENU=Home Page;
                                                              DEA=Homepage] }
    { 5900;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              DEA=Datumsfilter] }
    { 5901;   ;Contract Gain/Loss Amount;Decimal  ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Contract Gain/Loss Entry".Amount WHERE (Responsibility Center=FIELD(Code),
                                                                                                            Change Date=FIELD(Date Filter)));
                                                   CaptionML=[ENU=Contract Gain/Loss Amount;
                                                              DEA=Gewinn-/Verlustbetrag (Vertr.)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 50000;  ;Company Name        ;Text30        ;TableRelation=Company.Name;
                                                   CaptionML=[ENU=Company Name;
                                                              DEA=Mandantenname] }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;Code,Name,Location Code                  }
  }
  CODE
  {
    VAR
      PostCode@1000 : Record 225;
      DimMgt@1001 : Codeunit 408;

    LOCAL PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::"Responsibility Center",Code,FieldNumber,ShortcutDimCode);
      MODIFY;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 50002 ENC Report Buffer
{
  OBJECT-PROPERTIES
  {
    Date=12.03.18;
    Time=15:30:30;
    Modified=Yes;
    Version List=ENC,SHFT,CMMS;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer        }
    { 10  ;   ;Dim1                ;Code20         }
    { 20  ;   ;Dim2                ;Code20         }
    { 50  ;   ;DimSetID1           ;Integer        }
    { 60  ;   ;DimSetID2           ;Integer        }
    { 100 ;   ;DocNo1              ;Code20         }
    { 110 ;   ;DocNo2              ;Code20         }
    { 150 ;   ;PostingDate1        ;Date           }
    { 151 ;   ;PostingDate2        ;Date           }
    { 200 ;   ;SourceNo1           ;Code50         }
    { 210 ;   ;SourceNo2           ;Code50         }
    { 300 ;   ;ProductNo1          ;Code20         }
    { 310 ;   ;ProductNo2          ;Code20         }
    { 400 ;   ;UoM1                ;Code20         }
    { 500 ;   ;Qty1                ;Decimal        }
    { 510 ;   ;Qty2                ;Decimal        }
    { 520 ;   ;Qty3                ;Decimal        }
    { 530 ;   ;Qty4                ;Decimal        }
    { 700 ;   ;Amount1             ;Decimal        }
    { 710 ;   ;Amount2             ;Decimal        }
    { 720 ;   ;Amount3             ;Decimal        }
    { 730 ;   ;Amount4             ;Decimal        }
    { 740 ;   ;Amount5             ;Decimal        }
    { 750 ;   ;Amount6             ;Decimal        }
    { 800 ;   ;CurFactor1          ;Decimal        }
    { 810 ;   ;CurFactor2          ;Decimal        }
    { 900 ;   ;Weight1             ;Decimal        }
    { 910 ;   ;Weight2             ;Decimal        }
    { 920 ;   ;Weight3             ;Decimal        }
    { 1000;   ;UserID1             ;Code50         }
    { 1100;   ;Type1               ;Option        ;OptionString=0,1,2,3,4,5,6,7,8,9 }
    { 1110;   ;Type2               ;Option        ;OptionString=0,1,2,3,4,5,6,7,8,9 }
    { 1200;   ;TypeText1           ;Text250        }
    { 1210;   ;TypeText2           ;Text250        }
    { 1300;   ;CountryCode1        ;Code10         }
    { 5000;   ;Text1               ;Text250        }
    { 5010;   ;Text2               ;Text250        }
    { 5020;   ;Text3               ;Text250        }
    { 5030;   ;Text4               ;Text250        }
    { 6000;   ;Year1               ;Integer        }
    { 6100;   ;Quarter1            ;Integer        }
    { 6200;   ;Month1              ;Integer        }
    { 7000;   ;PostingGrp1         ;Code20         }
    { 7010;   ;PostingGrp2         ;Code20         }
    { 7020;   ;PostingGrp3         ;Code20         }
    { 7021;   ;PostingGrp4         ;Code20         }
    { 8000;   ;EntryNo1            ;Integer        }
    { 8010;   ;EntryNo2            ;Integer        }
    { 8020;   ;EntryNo3            ;Integer        }
    { 9000;   ;OK1                 ;Boolean        }
    { 9010;   ;OK2                 ;Boolean        }
    { 9020;   ;OK3                 ;Boolean        }
    { 10000;  ;FromTime            ;Time           }
    { 10010;  ;ToTime              ;Time           }
    { 10020;  ;FromTime2           ;Time           }
    { 10030;  ;ToTime2             ;Time           }
    { 10040;  ;FromTime3           ;Time           }
    { 10050;  ;ToTime3             ;Time           }
    { 10060;  ;FromTime4           ;Time           }
    { 10070;  ;ToTime4             ;Time           }
    { 11000;  ;LineNo1             ;Integer        }
    { 11010;  ;LineNo2             ;Integer        }
    { 11020;  ;LineNo3             ;Integer        }
    { 11030;  ;LineNo4             ;Integer        }
    { 12000;  ;Int1                ;Integer        }
    { 12010;  ;Int2                ;Integer        }
    { 12020;  ;Int3                ;Integer        }
    { 12030;  ;Int4                ;Integer        }
    { 12040;  ;Int5                ;Integer        }
    { 12050;  ;Int6                ;Integer        }
    { 12060;  ;Int7                ;Integer        }
    { 13000;  ;blob1               ;BLOB           }
    { 13010;  ;blob2               ;BLOB           }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
    {    ;Dim2,SourceNo1                           }
    {    ;ProductNo1,SourceNo2                     }
    {    ;SourceNo1,TypeText1,ProductNo1           }
    {    ;Month1,SourceNo1                         }
    {    ;SourceNo1,Text3                          }
    {    ;DimSetID1,DimSetID2                      }
    {    ;SourceNo1,SourceNo2,PostingDate1         }
    {    ;SourceNo1,SourceNo2,PostingDate1,EntryNo1 }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 50004 CMMS GPM Ticket
{
  OBJECT-PROPERTIES
  {
    Date=07.06.17;
    Time=15:35:50;
    Modified=Yes;
    Version List=CMMS,GPM;
  }
  PROPERTIES
  {
    OnInsert=VAR
               GPMTicketArchive@1000000000 : Record 50005;
             BEGIN
               {
                 This table should be used only as Temporary Table for the Webservice!
               }
             END;

  }
  FIELDS
  {
    { 100 ;   ;id                  ;Integer       ;AutoIncrement=Yes }
    { 200 ;   ;ticket_id           ;Integer        }
    { 210 ;   ;deleted             ;Boolean        }
    { 300 ;   ;name                ;Text150        }
    { 400 ;   ;grouping            ;Integer        }
    { 500 ;   ;activated_time      ;DateTime       }
    { 600 ;   ;deactivated_time    ;DateTime       }
    { 700 ;   ;reference_plant_id  ;Integer        }
    { 800 ;   ;reference_element_id;Integer        }
    { 810 ;   ;reference_element_name;Text250      }
    { 900 ;   ;priority            ;Integer        }
    { 1000;   ;reference_alerm_id  ;Integer        }
    { 1100;   ;state               ;Integer        }
    { 1200;   ;alert_type          ;Integer        }
    { 1300;   ;operator_name       ;Text50         }
    { 1400;   ;activation_description_BLOB;BLOB    }
    { 1500;   ;deactivation_description_BLOB;BLOB  }
    { 1600;   ;activation_details_BLOB;BLOB        }
    { 1700;   ;deactivation_details_BLOB;BLOB      }
    { 1800;   ;affects_availibility;Boolean        }
    { 1900;   ;calculate_loss      ;Boolean        }
    { 2000;   ;repercussion_id     ;Integer        }
    { 2100;   ;affected_element_id ;Integer        }
    { 2200;   ;reason_id           ;Integer        }
    { 2300;   ;problem_description_BLOB;BLOB       }
    { 2400;   ;company             ;Text50         }
    { 2500;   ;time_t              ;Integer        }
    { 2600;   ;actions_performed_BLOB;BLOB         }
    { 2700;   ;maintenance_type_id ;Integer        }
    { 2800;   ;reference_element_type_id;Integer   }
    { 2900;   ;notified_time       ;DateTime       }
    { 3000;   ;estimated_activation_time;DateTime  }
    { 3100;   ;operator_id         ;Integer        }
  }
  KEYS
  {
    {    ;id                                      ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE GetBlobValues@1000000002(VAR activation_description@1000000005 : Text;VAR deactivation_description@1000000004 : Text;VAR activation_details@1000000003 : Text;VAR deactivation_details@1000000002 : Text;VAR problem_description@1000000001 : Text;VAR actions_performed@1000000000 : Text);
    VAR
      InStr@1000000006 : InStream;
      CMGenMgt@1000000007 : Codeunit 70000;
    BEGIN
      Rec.CALCFIELDS(activation_description_BLOB);
      Rec.CALCFIELDS(deactivation_description_BLOB);
      Rec.CALCFIELDS(activation_details_BLOB);
      Rec.CALCFIELDS(deactivation_details_BLOB);
      Rec.CALCFIELDS(problem_description_BLOB);
      Rec.CALCFIELDS(actions_performed_BLOB);

      Rec.activation_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      activation_description := CMGenMgt.Instream2Text(InStr);

      Rec.deactivation_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      deactivation_description := CMGenMgt.Instream2Text(InStr);

      Rec.activation_details_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      activation_details := CMGenMgt.Instream2Text(InStr);

      Rec.deactivation_details_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      deactivation_details := CMGenMgt.Instream2Text(InStr);

      Rec.problem_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      problem_description := CMGenMgt.Instream2Text(InStr);

      Rec.actions_performed_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      actions_performed := CMGenMgt.Instream2Text(InStr);
    END;

    PROCEDURE SetBlobValues@1000000000(activation_description@1000000005 : Text;deactivation_description@1000000004 : Text;activation_details@1000000003 : Text;deactivation_details@1000000002 : Text;problem_description@1000000001 : Text;actions_performed@1000000000 : Text);
    VAR
      OutStr@1000000006 : OutStream;
    BEGIN
      CLEAR(Rec.activation_description_BLOB);
      CLEAR(Rec.deactivation_description_BLOB);
      CLEAR(Rec.activation_details_BLOB);
      CLEAR(Rec.deactivation_details_BLOB);
      CLEAR(Rec.problem_description_BLOB);
      CLEAR(Rec.actions_performed_BLOB);

      Rec.activation_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(activation_description);

      Rec.deactivation_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(deactivation_description);

      Rec.activation_details_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(activation_details);

      Rec.deactivation_details_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(deactivation_details);

      Rec.problem_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(problem_description);

      Rec.actions_performed_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(actions_performed);

      //IF NOT Rec.MODIFY(FALSE) THEN
        //;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 50005 CMMS GPM Ticket Archive
{
  OBJECT-PROPERTIES
  {
    Date=02.01.18;
    Time=16:34:16;
    Modified=Yes;
    Version List=CMMS,GPM;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               "Creation Date" := TODAY;
               "Creation Time" := TIME;

               CMIfMgt.ProcessRecord(Rec, FALSE);
             END;

    CaptionML=ENU=CMMS GPM Ticket Archive;
    LookupPageID=Page70002;
    DrillDownPageID=Page70002;
  }
  FIELDS
  {
    { 100 ;   ;id                  ;Integer       ;AutoIncrement=Yes }
    { 200 ;   ;ticket_id           ;Integer        }
    { 210 ;   ;deleted             ;Boolean        }
    { 300 ;   ;name                ;Text150        }
    { 400 ;   ;grouping            ;Integer        }
    { 500 ;   ;activated_time      ;DateTime       }
    { 501 ;   ;activated_time_DATE ;Date           }
    { 502 ;   ;activated_time_TIME ;Time           }
    { 600 ;   ;deactivated_time    ;DateTime       }
    { 601 ;   ;deactivated_time_DATE;Date          }
    { 602 ;   ;deactivated_time_TIME;Time          }
    { 700 ;   ;reference_plant_id  ;Integer        }
    { 800 ;   ;reference_element_id;Integer        }
    { 810 ;   ;reference_element_name;Text250      }
    { 900 ;   ;priority            ;Integer        }
    { 1000;   ;reference_alerm_id  ;Integer        }
    { 1100;   ;state               ;Integer        }
    { 1200;   ;alert_type          ;Integer        }
    { 1300;   ;operator_name       ;Text50         }
    { 1400;   ;activation_description_BLOB;BLOB    }
    { 1500;   ;deactivation_description_BLOB;BLOB  }
    { 1600;   ;activation_details_BLOB;BLOB        }
    { 1700;   ;deactivation_details_BLOB;BLOB      }
    { 1800;   ;affects_availibility;Boolean        }
    { 1900;   ;calculate_loss      ;Boolean        }
    { 2000;   ;repercussion_id     ;Integer        }
    { 2100;   ;affected_element_id ;Integer        }
    { 2200;   ;reason_id           ;Integer        }
    { 2300;   ;problem_description_BLOB;BLOB       }
    { 2400;   ;company             ;Text50         }
    { 2500;   ;time_t              ;Integer        }
    { 2600;   ;actions_performed_BLOB;BLOB         }
    { 2700;   ;maintenance_type_id ;Integer        }
    { 2800;   ;reference_element_type_id;Integer   }
    { 2900;   ;notified_time       ;DateTime       }
    { 2901;   ;notified_time_DATE  ;Date           }
    { 2902;   ;notified_time_TIME  ;Time           }
    { 3000;   ;estimated_activation_time;DateTime  }
    { 3100;   ;operator_id         ;Integer        }
    { 20000;  ;ARCHIVE             ;Code1         ;Description=20000.. Are Archive Information }
    { 20001;  ;Creation Date       ;Date           }
    { 20002;  ;Creation Time       ;Time           }
    { 20003;  ;Processed           ;Boolean        }
    { 20004;  ;Processed Date      ;Date           }
    { 20005;  ;Processed Time      ;Time           }
    { 20010;  ;Is Error            ;Boolean        }
    { 20020;  ;Error Text          ;Text80         }
    { 20050;  ;Creation Datetime   ;DateTime       }
    { 20060;  ;Processed Datetime  ;DateTime       }
    { 21000;  ;Workorder No.       ;Code20        ;TableRelation=Opportunity.No. WHERE (CM Is Workorder=CONST(Yes));
                                                   OnLookup=VAR
                                                              CMWoMgt@1000000000 : Codeunit 70030;
                                                              Workorder@1000000001 : Record 5092;
                                                            BEGIN
                                                            END;
                                                             }
    { 21010;  ;Workorder Updated   ;Boolean        }
  }
  KEYS
  {
    {    ;id                                      ;Clustered=Yes }
    {    ;ticket_id,Workorder No.,id               }
    {    ;Workorder No.,id                         }
    {    ;state                                    }
    {    ;activated_time_DATE                      }
    {    ;Is Error                                 }
    {    ;Creation Date                            }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      CMIfMgt@1000000000 : Codeunit 70026;

    PROCEDURE GetBlobValues@1000000002(VAR activation_description@1000000005 : Text;VAR deactivation_description@1000000004 : Text;VAR activation_details@1000000003 : Text;VAR deactivation_details@1000000002 : Text;VAR problem_description@1000000001 : Text;VAR actions_performed@1000000000 : Text);
    VAR
      InStr@1000000006 : InStream;
      CMGenMgt@1000000007 : Codeunit 70000;
    BEGIN
      Rec.CALCFIELDS(activation_description_BLOB);
      Rec.CALCFIELDS(deactivation_description_BLOB);
      Rec.CALCFIELDS(activation_details_BLOB);
      Rec.CALCFIELDS(deactivation_details_BLOB);
      Rec.CALCFIELDS(problem_description_BLOB);
      Rec.CALCFIELDS(actions_performed_BLOB);

      Rec.activation_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      activation_description := CMGenMgt.Instream2Text(InStr);

      Rec.deactivation_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      deactivation_description := CMGenMgt.Instream2Text(InStr);

      Rec.activation_details_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      activation_details := CMGenMgt.Instream2Text(InStr);

      Rec.deactivation_details_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      deactivation_details := CMGenMgt.Instream2Text(InStr);

      Rec.problem_description_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      problem_description := CMGenMgt.Instream2Text(InStr);

      Rec.actions_performed_BLOB.CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      actions_performed := CMGenMgt.Instream2Text(InStr);
    END;

    PROCEDURE SetBlobValues@1000000001(activation_description@1000000005 : Text;deactivation_description@1000000004 : Text;activation_details@1000000003 : Text;deactivation_details@1000000002 : Text;problem_description@1000000001 : Text;actions_performed@1000000000 : Text);
    VAR
      OutStr@1000000006 : OutStream;
    BEGIN
      CLEAR(Rec.activation_description_BLOB);
      CLEAR(Rec.deactivation_description_BLOB);
      CLEAR(Rec.activation_details_BLOB);
      CLEAR(Rec.deactivation_details_BLOB);
      CLEAR(Rec.problem_description_BLOB);
      CLEAR(Rec.actions_performed_BLOB);

      Rec.activation_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(activation_description);

      Rec.deactivation_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(deactivation_description);

      Rec.activation_details_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(activation_details);

      Rec.deactivation_details_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(deactivation_details);

      Rec.problem_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(problem_description);

      Rec.actions_performed_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(actions_performed);

      //IF NOT Rec.MODIFY(FALSE) THEN
        //;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70000 CMMS General Setup
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=09:27:15;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=ENU=CMMS General Setup;
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10        ;CaptionML=[ENU=Primary Key;
                                                              DEA=Prim„rschlssel] }
    { 1000;   ;NO. SERIES          ;Boolean       ;CaptionML=[ENU=NO. SERIES;
                                                              DEA=NUMMERNSERIE] }
    { 1100;   ;Asset Nos. Code     ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Anlage Nrs. Code;
                                                              DEA=Anlage Nrs. Code] }
    { 1110;   ;Project Nos. Code   ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Project Nrs. Code;
                                                              DEA=Projekt Nrs. Code] }
    { 1200;   ;Workorder Nos. Code ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Workorder Nos. Code;
                                                              DEA=Arbeitsauftrag Nrs. Code] }
    { 1300;   ;Task Nos. Code      ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Task Nos. Code;
                                                              DEA=Aufgabe Nrs. Code] }
    { 1310;   ;Checklist Nos. Code ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Checklist Nos. Code;
                                                              DEA=Checklist Nrs. Code] }
    { 1320;   ;Team Nos. Code      ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Team Nos. Code;
                                                              DEA=Team Nrs. Code] }
    { 1400;   ;Contract Nos. Code  ;Code20        ;TableRelation="No. Series".Code;
                                                   CaptionML=[ENU=Contract Nos. Code;
                                                              DEA=Vertrag Nrs. Code] }
    { 2000;   ;PHOTOS              ;Boolean        }
    { 2010;   ;Photo Quality %     ;Integer       ;InitValue=80;
                                                   CaptionML=[ENU=Photo Quality %;
                                                              DEA=Foto Qualit„t %];
                                                   MinValue=1;
                                                   MaxValue=100 }
    { 3000;   ;MAPSETUP            ;Boolean        }
    { 3010;   ;Map Setup (Coordinates);Code10     ;TableRelation="Online Map Parameter Setup".Code;
                                                   CaptionML=[ENU=Map Setup (Coordinates);
                                                              DEA=Karteneinrichtung (Koordinaten)] }
    { 3020;   ;Map Setup (Address) ;Code10        ;TableRelation="Online Map Parameter Setup".Code;
                                                   CaptionML=[ENU=Map Setup (Coordinaten);
                                                              DEA=Karteneinrichtung (Adresse)] }
    { 4000;   ;TIMETRACKING        ;Boolean        }
    { 4010;   ;Max. Posting per Day;Decimal       ;CaptionML=[ENU=Max. Posting per Day;
                                                              DEA=Max. Verbuchung pro Tag] }
    { 4020;   ;Rounding Precision  ;Decimal       ;CaptionML=[ENU=Rounding Precision;
                                                              DEA=Rundungspr„zision] }
    { 4030;   ;Default UoM Code    ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Default UoM Code;
                                                              DEA=Standard Einheitencode] }
    { 4040;   ;Posting Allowed to (Past);DateFormula;
                                                   CaptionML=[ENU=Time Posting Allowed To (Past);
                                                              DEA=Zeiterfassung Erlaubt (Vergang.)] }
    { 4050;   ;Posting Allowed to (Future);DateFormula;
                                                   CaptionML=[ENU=Time Posting Allowed To (Future);
                                                              DEA=Zeiterfassung Erlaubt (Zufkunft)] }
    { 4060;   ;Posting Descr. Min. Length;Integer ;CaptionML=[ENU=Posting Descr. Min. Length;
                                                              DEA=Buchungsbeschr. Min. L„nge];
                                                   MinValue=0;
                                                   MaxValue=50 }
    { 4100;   ;Dimension 1         ;Code20        ;TableRelation=Dimension.Code }
    { 4110;   ;Dimension 2         ;Code20        ;TableRelation=Dimension.Code }
    { 4120;   ;Dimension 3         ;Code20        ;TableRelation=Dimension.Code }
    { 4130;   ;Dimension 4         ;Code20        ;TableRelation=Dimension.Code }
    { 5000;   ;YIELD STUDY         ;Boolean        }
    { 5010;   ;Yield Type 1 (Starts with);Code20  ;OnValidate=VAR
                                                                CodeData@1000000000 : Record 70006;
                                                                CMAddData@1000000001 : Record 70021;
                                                              BEGIN
                                                                //CodeData.ValidateCodeData(CMAddData.RECORDID.TABLENO, CMAddData.FIELDNO(Key3),CMAddData.Type::YieldStudy, Rec."Yield Type 1");
                                                              END;

                                                   OnLookup=VAR
                                                              CodeData@1000000000 : Record 70006;
                                                              CMAddData@1000000001 : Record 70021;
                                                              Value@1000000002 : Code[20];
                                                            BEGIN
                                                              CodeData.LookupCodeData(CMAddData.RECORDID.TABLENO, CMAddData.FIELDNO(Key3),CMAddData.Type::YieldStudy, Rec."Yield Type 1 (Starts with)");
                                                            END;
                                                             }
    { 5020;   ;Yield Unit 1        ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Yield Unit 1;
                                                              DEA=Ertrag Einheit 1] }
    { 5030;   ;Yield Type 2 (Starts with);Code20  ;OnValidate=VAR
                                                                CodeData@1000000000 : Record 70006;
                                                                CMAddData@1000000001 : Record 70021;
                                                              BEGIN
                                                                //CodeData.ValidateCodeData(CMAddData.RECORDID.TABLENO, CMAddData.FIELDNO(Key3),CMAddData.Type::YieldStudy, Rec."Yield Type 2");
                                                              END;

                                                   OnLookup=VAR
                                                              CodeData@1000000000 : Record 70006;
                                                              CMAddData@1000000001 : Record 70021;
                                                              Value@1000000002 : Code[20];
                                                            BEGIN
                                                              CodeData.LookupCodeData(CMAddData.RECORDID.TABLENO, CMAddData.FIELDNO(Key3),CMAddData.Type::YieldStudy, Rec."Yield Type 2 (Starts with)");
                                                            END;
                                                             }
    { 5040;   ;Yield Unit 2        ;Code10        ;TableRelation="Unit of Measure".Code;
                                                   CaptionML=[ENU=Yield Unit 2;
                                                              DEA=Ertrag Einheit 2] }
    { 5300;   ;Degradation Allow. (Starts w.);Code20;
                                                   OnLookup=VAR
                                                              CodeData@1000000001 : Record 70006;
                                                              CMAddData@1000000000 : Record 70021;
                                                              Value@1000000002 : Code[20];
                                                            BEGIN
                                                              CodeData.LookupCodeData(CMAddData.RECORDID.TABLENO, CMAddData.FIELDNO(Key3),CMAddData.Type::YieldStudy, Rec."Degradation Allow. (Starts w.)");
                                                            END;
                                                             }
    { 6000;   ;Dimensions          ;Boolean        }
    { 6010;   ;Asset Dimension Code;Code20        ;TableRelation=Dimension.Code;
                                                   CaptionML=[ENU=Asset Dimension;
                                                              DEA=Anlagendimension] }
    { 6020;   ;Project Dimension Code;Code20      ;TableRelation=Dimension.Code;
                                                   CaptionML=[ENU=Project Dimension;
                                                              DEA=Projektdimension] }
    { 10000;  ;MISC                ;Boolean        }
    { 10010;  ;Default Interact. Tpl. Code;Code20 ;TableRelation="Interaction Template".Code;
                                                   CaptionML=[ENU=Default Interaction Template Code;
                                                              DEA=Standard Aktivit„tenvorlagencode] }
    { 10020;  ;Recurring Workorder Name;Text50    ;CaptionML=[ENU=Recurring Workorder Name;
                                                              DEA=Wiederkehrender Arbeitsauftragname] }
    { 10030;  ;System Contact      ;Code20        ;TableRelation=Contact.No.;
                                                   CaptionML=[ENU=System Contact (Log);
                                                              DEA=System Kontakt (Log)] }
    { 10040;  ;System Salesperson  ;Code20        ;TableRelation=Salesperson/Purchaser.Code;
                                                   CaptionML=[ENU=System Salesperson (Log);
                                                              DEA=System Verk„ufer (Log)] }
    { 10050;  ;System User ID      ;Code50        ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=System User ID;
                                                              DEA=System Benutzer ID] }
    { 10100;  ;Subcontractor Bus. Rel. Code;Code20;TableRelation="Business Relation".Code;
                                                   CaptionML=[ENU=Subcontractor Bus. Rel. Code;
                                                              DEA=Sublieferant Gesch. Bez. Code] }
    { 10110;  ;Min. Comment Len. (Wo. Status);Integer;
                                                   CaptionML=ENU=Min. Comment Len. (Wo. Status);
                                                   MinValue=0;
                                                   MaxValue=250 }
    { 10200;  ;Allow CMMS Purch. Orders;Boolean   ;CaptionML=[ENU=Allow CMMS Purch. Orders;
                                                              DEA=Erlaube CMMS Bestellungen] }
    { 10210;  ;CMMS PO Default Vendor;Code20      ;TableRelation=Vendor.No.;
                                                   CaptionML=ENU=CMMS Bestellung Default Kreditor }
    { 10220;  ;CMMS PO Status Sequence;Code20     ;TableRelation="IG Status Sequence Header".Code WHERE (Type=CONST(sequence));
                                                   CaptionML=[ENU=CMMS Purch. Order Status Sequence;
                                                              DEA=CMMS Bestellung Statusablauf] }
    { 10230;  ;CMMS PO Initial Status;Code20      ;TableRelation="IG Status Sequence Header".Code WHERE (Type=CONST(status));
                                                   CaptionML=[ENU=CMMS Purch. Order Initial Status;
                                                              DEA=CMMS Bestellung Initialstatus] }
    { 10240;  ;CMMS PO Released Status;Code20     ;CaptionML=[ENU=CMMS Purch. Order Released Status;
                                                              DEA=CMMS Bestellung Freigabestatus] }
    { 12000;  ;EXCEL EXPORT        ;Boolean        }
    { 12010;  ;Excel Export Template 1 Path;Text250;
                                                   OnLookup=BEGIN
                                                              VALIDATE("Excel Export Template 1 Path", FileMgt.OpenFileDialog(Text001,'','Excel Workbook (*.xls, *.xlsx)|*.xls;*.xlsx'));
                                                            END;

                                                   CaptionML=[ENU=Template 1 Path;
                                                              DEA=Vorlage 1 Pfad] }
    { 12020;  ;Excel Export Template 2 Path;Text250;
                                                   OnLookup=BEGIN
                                                              VALIDATE("Excel Export Template 2 Path", FileMgt.OpenFileDialog(Text001,'','Excel Workbook (*.xls, *.xlsx)|*.xls;*.xlsx'));
                                                            END;

                                                   CaptionML=[ENU=Template 2 Path;
                                                              DEA=Vorlage 2 Pfad] }
    { 12030;  ;Excel Export Template 3 Path;Text250;
                                                   OnLookup=BEGIN
                                                              VALIDATE("Excel Export Template 3 Path", FileMgt.OpenFileDialog(Text001,'','Excel Workbook (*.xls, *.xlsx)|*.xls;*.xlsx'));
                                                            END;

                                                   CaptionML=[ENU=Template 3 Path;
                                                              DEA=Vorlage 3 Pfad] }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      FileMgt@1000000000 : Codeunit 419;
      Text001@1000000001 : TextConst 'ENU=Open file...;DEA=Datei ”ffnen...';

    BEGIN
    END.
  }
}

OBJECT Table 70006 CMMS Code Data
{
  OBJECT-PROPERTIES
  {
    Date=19.05.17;
    Time=07:56:48;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    LookupPageID=Page70004;
  }
  FIELDS
  {
    { 1   ;   ;TableID             ;Integer       ;TableRelation=Object.ID WHERE (Type=CONST(Table));
                                                   OnLookup=VAR
                                                              Object@1000000001 : Record 2000000001;
                                                              Objects@1000000000 : Page 358;
                                                            BEGIN
                                                              Object.SETRANGE(Object.Type,Object.Type::Table);
                                                              Objects.SETTABLEVIEW(Object);
                                                              Objects.LOOKUPMODE := TRUE;
                                                              IF Objects.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                Objects.GETRECORD(Object);
                                                                VALIDATE(TableID, Object.ID);
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=TableID;
                                                              DEA=TableID];
                                                   NotBlank=Yes }
    { 2   ;   ;Table Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(AllObjWithCaption."Object Name" WHERE (Object Type=CONST(Table),
                                                                                                             Object ID=FIELD(TableID)));
                                                   CaptionML=[ENU=Table Name;
                                                              DEA=Tabellenname];
                                                   Editable=No }
    { 3   ;   ;Table Caption       ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(AllObjWithCaption."Object Caption" WHERE (Object Type=CONST(Table),
                                                                                                                Object ID=FIELD(TableID))) }
    { 5   ;   ;FieldID             ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(TableID));
                                                   OnLookup=VAR
                                                              Field@1160001 : Record 2000000041;
                                                              Fields@1000000000 : Page 6218;
                                                            BEGIN
                                                              IF TableID = 0 THEN EXIT;
                                                              Field.SETRANGE(TableNo,TableID);
                                                              Fields.SETTABLEVIEW(Field);
                                                              Fields.LOOKUPMODE := TRUE;
                                                              IF Fields.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                Fields.GETRECORD(Field);
                                                                VALIDATE(FieldID, Field."No.");
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=FieldID;
                                                              DEA=Feld-ID] }
    { 6   ;   ;Field Name          ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field.FieldName WHERE (TableNo=FIELD(TableID),
                                                                                             No.=FIELD(FieldID)));
                                                   CaptionML=[ENU=Field Name;
                                                              DEA=Feldname] }
    { 7   ;   ;Field Caption       ;Text250       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field."Field Caption" WHERE (TableNo=FIELD(TableID),
                                                                                                   No.=FIELD(FieldID)));
                                                   CaptionML=[ENU=Field Caption;
                                                              DEA=Feldcaption] }
    { 10  ;   ;Type                ;Integer       ;CaptionML=[ENU=Type;
                                                              DEA=Art] }
    { 20  ;   ;Code                ;Code10        ;CaptionML=[ENU=Code;
                                                              DEA=Code];
                                                   NotBlank=Yes }
    { 30  ;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung];
                                                   NotBlank=Yes }
    { 100 ;   ;Description Long    ;Text250       ;CaptionML=[ENU=Description Long;
                                                              DEA=Langbeschreibung] }
  }
  KEYS
  {
    {    ;TableID,FieldID,Type,Code               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Code,Description                         }
  }
  CODE
  {
    VAR
      Text000@1000000000 : TextConst 'ENU=Code %1 does not exist.;DEA=Code %1 existiert nicht.';

    PROCEDURE ValidateCodeData@1160001(STableID@1160002 : Integer;SFieldID@1160001 : Integer;SType@1000000000 : Integer;SCode@1160000 : Code[20]);
    VAR
      CodeDataRec@1160003 : Record 70006;
    BEGIN
      CodeDataRec.SETRANGE(TableID,STableID);
      CodeDataRec.SETRANGE(FieldID,SFieldID);
      CodeDataRec.SETRANGE(Type,SType);
      CodeDataRec.SETRANGE(Code,SCode);

      IF NOT CodeDataRec.FINDFIRST THEN ERROR(
        Text000, SCode);
    END;

    PROCEDURE LookupCodeData@1160002(STableID@1160002 : Integer;SFieldID@1160004 : Integer;SType@1000000001 : Integer;VAR SCode@1160005 : Code[20]);
    VAR
      CodeDataRec@1160000 : Record 70006;
      Table@1160003 : Record 2000000028;
      CodeDataList@1000000000 : Page 70004;
    BEGIN
      Table.SETRANGE("Table No.",STableID);
      IF NOT Table.FINDFIRST THEN EXIT;

      CodeDataRec.FILTERGROUP(2);
      CodeDataRec.SETRANGE(TableID,STableID);
      CodeDataRec.SETRANGE(FieldID,SFieldID);
      CodeDataRec.SETRANGE(Type,SType);
      CodeDataRec.FILTERGROUP(0);

      CodeDataList.SETTABLEVIEW(CodeDataRec);
      CodeDataList.LOOKUPMODE := TRUE;

      IF CodeDataList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        CodeDataList.GETRECORD(CodeDataRec);
        SCode := CodeDataRec.Code;
        //exit(true);
      END;
    END;

    PROCEDURE GetCodeData@1160000(STableID@1160003 : Integer;SFieldID@1160002 : Integer;SCode@1160001 : Code[20];SCode2@1160000 : Code[20];SLanguageCode@1160004 : Code[20]) ReturnValue : Text[50];
    VAR
      CodeDataRec@1160005 : Record 70006;
    BEGIN
      CodeDataRec.SETRANGE(TableID,STableID);
      CodeDataRec.SETRANGE(FieldID,SFieldID);
      CodeDataRec.SETRANGE(Code,SCode);
      IF NOT CodeDataRec.FINDFIRST THEN CodeDataRec.INIT;

      ReturnValue := CodeDataRec.Description;
      {
      IF SLanguageCode <> '' THEN
        IF MDTranslation.GetTranslation(DATABASE::"IG Code Data",CodeDataRec.FIELDNO(Description),SCode,SCode2,SLanguageCode) <> '' THEN
          ReturnValue := MDTranslation.GetTranslation(DATABASE::"IG Code Data",CodeDataRec.FIELDNO(Description),SCode,SCode2,SLanguageCode);
      }
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70007 CMMS Report Buffer
{
  OBJECT-PROPERTIES
  {
    Date=19.06.17;
    Time=13:26:56;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Entry No.           ;Integer        }
    { 1000;   ;AssetNo1            ;Code20         }
    { 1010;   ;ProjectNo1          ;Code20         }
    { 1020;   ;ContractNo1         ;Code20         }
    { 1030;   ;ContactNo1          ;Code20         }
    { 1040;   ;CustomerNo1         ;Code20         }
    { 1050;   ;UserID1             ;Code50         }
    { 2000;   ;BusRelCode1         ;Code20         }
    { 3000;   ;TypeText1           ;Text80         }
    { 3001;   ;TypeInt1            ;Integer        }
    { 3010;   ;TypeText2           ;Text80         }
    { 3011;   ;TypeInt2            ;Integer        }
    { 3020;   ;TypeText3           ;Text80         }
    { 3021;   ;TypeInt3            ;Integer        }
    { 3030;   ;TypeText4           ;Text80         }
    { 3040;   ;TypeText5           ;Text80         }
    { 3050;   ;TypeText6           ;Text80         }
    { 3060;   ;TypeText7           ;Text80         }
    { 3070;   ;TypeText8           ;Text80         }
    { 4000;   ;Name1               ;Text250        }
    { 4010;   ;Name2               ;Text250        }
    { 4020;   ;Name3               ;Text250        }
    { 4030;   ;Name4               ;Text250        }
    { 5000;   ;LineNo1             ;Integer        }
    { 10000;  ;Amount1             ;Decimal        }
    { 10010;  ;Amount2             ;Decimal        }
    { 10020;  ;Amount3             ;Decimal        }
    { 10030;  ;Amount4             ;Decimal        }
    { 10040;  ;Amount5             ;Decimal        }
  }
  KEYS
  {
    {    ;Entry No.                               ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70009 CMMS Department
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=11:07:27;
    Modified=Yes;
    Version List=CMMS,DPT;
  }
  PROPERTIES
  {
    OnDelete=VAR
               DepartmentTeam@1000000000 : Record 70010;
             BEGIN
               DepartmentTeam.RESET;
               DepartmentTeam.SETRANGE(Type, DepartmentTeam.Type::Department);
               DepartmentTeam.SETRANGE(Code, xRec.Code);
               DepartmentTeam.DELETEALL(TRUE);

               DepartmentTeam.RESET;
               DepartmentTeam.SETCURRENTKEY("Belongs To Department Code");
               DepartmentTeam.SETRANGE("Belongs To Department Code", xRec.Code);
               DepartmentTeam.DELETEALL(TRUE);
             END;

    OnRename=VAR
               DepartmentTeam@1000000000 : Record 70010;
             BEGIN
               DepartmentTeam.RESET;
               DepartmentTeam.SETRANGE(Type, DepartmentTeam.Type::Department);
               DepartmentTeam.SETRANGE(Code, xRec.Code);
               WHILE(DepartmentTeam.FINDFIRST()) DO BEGIN
                 DepartmentTeam.RENAME(DepartmentTeam.Type, Rec.Code);
               END;

               DepartmentTeam.RESET;
               DepartmentTeam.SETCURRENTKEY("Belongs To Department Code");
               DepartmentTeam.SETRANGE("Belongs To Department Code", xRec.Code);
               DepartmentTeam.MODIFYALL("Belongs To Department Code", Rec.Code, TRUE);
             END;

    CaptionML=[ENU=Department;
               DEA=Abteilung];
  }
  FIELDS
  {
    { 100 ;   ;Code                ;Code20        ;CaptionML=[ENU=Code;
                                                              DEA=Code] }
    { 200 ;   ;Name                ;Text50        ;CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 300 ;   ;Company             ;Text30        ;TableRelation=Company.Name;
                                                   CaptionML=[ENU=Company;
                                                              DEA=Mandant] }
    { 1000;   ;In Scheduling Tool  ;Boolean       ;CaptionML=ENU=In Scheduling Tool }
  }
  KEYS
  {
    {    ;Code                                    ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70010 CMMS Department Team
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=11:36:34;
    Modified=Yes;
    Version List=CMMS,DPT;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Department Team;
               DEA=Abteilung Team];
  }
  FIELDS
  {
    { 100 ;   ;Type                ;Option        ;OptionCaptionML=[ENU=User,Department;
                                                                    DEA=Benutzer,Abteilung];
                                                   OptionString=User,Department }
    { 200 ;   ;Code                ;Code50        ;TableRelation=IF (Type=CONST(Department)) "CMMS Department".Code }
    { 201 ;   ;User Name           ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(User."Full Name" WHERE (User Name=FIELD(Code)));
                                                   CaptionML=[ENU=User Name;
                                                              DEA=Benutzername];
                                                   Description=FF;
                                                   Editable=No }
    { 202 ;   ;Department Name     ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Department".Name WHERE (Code=FIELD(Code)));
                                                   CaptionML=[ENU=Department Name;
                                                              DEA=Abteilungsname];
                                                   Description=FF;
                                                   Editable=No }
    { 203 ;   ;Department Comany   ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Department".Company WHERE (Code=FIELD(Code)));
                                                   CaptionML=[ENU=Department Company;
                                                              DEA=Abteilung Mandant];
                                                   Description=FF;
                                                   Editable=No }
    { 300 ;   ;Belongs To Department Code;Code20  ;TableRelation="CMMS Department".Code }
    { 301 ;   ;Belongs To Department Comany;Text30;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Department".Company WHERE (Code=FIELD(Belongs To Department Code)));
                                                   CaptionML=[ENU=Belongs To Department Company;
                                                              DEA=Geh”rt zu Abteilung Mandant];
                                                   Description=FF;
                                                   Editable=No }
    { 1000;   ;User Role           ;Option        ;OnValidate=BEGIN
                                                                TESTFIELD(Type, Type::User)
                                                              END;

                                                   CaptionML=[ENU=User Role;
                                                              DEA=Benutzerrolle];
                                                   OptionCaptionML=[ENU=" ,Leader";
                                                                    DEA=" ,Vorgesetzter"];
                                                   OptionString=[ ,Leader] }
    { 1010;   ;Dept. in Scheduling Tool;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Department"."In Scheduling Tool" WHERE (Code=FIELD(Belongs To Department Code)));
                                                   CaptionML=ENU=In Scheduling Tool;
                                                   Description=FF;
                                                   Editable=No }
  }
  KEYS
  {
    {    ;Type,Code,Belongs To Department Code    ;Clustered=Yes }
    {    ;User Role                                }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Invalid User "%1".;DEA=Ungltiger Benutzer "%1".';

    PROCEDURE LookupUserID@1000000003();
    VAR
      User@1000000000 : Record 2000000120;
      UserList@1000000001 : Page 9800;
    BEGIN
      IF Type <> Type::User THEN
        EXIT;

      UserList.LOOKUPMODE(TRUE);
      IF UserList.RUNMODAL <> ACTION::LookupOK THEN
        EXIT;

      UserList.GETRECORD(User);
      Code := User."User Name";
    END;

    PROCEDURE ValidateUserID@1000000004();
    VAR
      User@1000000000 : Record 2000000120;
    BEGIN
      IF Type <> Type::User THEN
        EXIT;

      User.RESET;
      User.SETCURRENTKEY("User Name");
      User.SETRANGE("User Name", Rec.Code);
      IF NOT User.FINDFIRST() THEN
        ERROR(STRSUBSTNO(Text001, Rec.Code));
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70011 CMMS Management Cue
{
  OBJECT-PROPERTIES
  {
    Date=09.05.17;
    Time=11:30:06;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
  }
  FIELDS
  {
    { 1   ;   ;Primary Key         ;Code10         }
    { 100 ;   ;Assets              ;Integer       ;AccessByPermission=TableData 70020=R;
                                                   CaptionML=[ENU=Assets;
                                                              DEA=Anlagen];
                                                   Editable=No }
    { 101 ;   ;Main Assets         ;Integer       ;AccessByPermission=TableData 70020=R;
                                                   CaptionML=[ENU=Main Assets;
                                                              DEA=Hauptanlagen];
                                                   Editable=No }
    { 120 ;   ;Projects            ;Integer       ;AccessByPermission=TableData 70020=R;
                                                   CaptionML=[ENU=Projects;
                                                              DEA=Projekte];
                                                   Editable=No }
    { 140 ;   ;Contracts           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Contract");
                                                   AccessByPermission=TableData 70050=R;
                                                   CaptionML=[ENU=Contracts;
                                                              DEA=Vertr„ge];
                                                   Description=FF;
                                                   Editable=No }
    { 1000;   ;-- TIME RECORDS --  ;Boolean        }
    { 1500;   ;Time Records (Today);Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Today Date Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=Time Records (Today);
                                                              DEA=Gebuchte Stunden (Heute)] }
    { 1510;   ;My Time Records (Today);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Today Date Filter),
                                                                                                            CM User ID=FIELD(User ID Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=My Time Records (Today);
                                                              DEA=Meine Gebuchte Stunden (Heute)] }
    { 1520;   ;Time Records (Week) ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Week Date Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=Time Records (Week);
                                                              DEA=Gebuchte Stunden (Woche)] }
    { 1530;   ;My Time Records (Week);Decimal     ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Week Date Filter),
                                                                                                            CM User ID=FIELD(User ID Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=My Time Records (Week);
                                                              DEA=Meine Gebuchte Stunden (Woche)] }
    { 1531;   ;My Time Records (Month);Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Month Date Filter),
                                                                                                            CM User ID=FIELD(User ID Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=My Time Records (Month);
                                                              DEA=Meine Gebuchte Stunden (Monat)] }
    { 1540;   ;Time Records        ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=Time Records;
                                                              DEA=Gebuchte Stunden] }
    { 1550;   ;My Time Records     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM User ID=FIELD(User ID Filter)));
                                                   AccessByPermission=TableData 952=R;
                                                   CaptionML=[ENU=My Time Records;
                                                              DEA=Meine Gebuchte Stunden] }
    { 1600;   ;-- WORK ORDERS --   ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes)));
                                                   AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=Work Orders;
                                                              DEA=Arbeitsauftr„ge];
                                                   Editable=No }
    { 1610;   ;My Work Orders      ;Integer       ;AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Work Orders;
                                                              DEA=Meine Arbeitsauftr„ge];
                                                   Editable=No }
    { 1611;   ;My Planned Work. (Due);Integer     ;AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Planned Work Orders;
                                                              DEA=Meine Geplanten Arbeitsauft.];
                                                   Editable=No }
    { 1612;   ;My Planned Work. (Overdue);Integer ;AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Overdue Work Orders;
                                                              DEA=Meine šberf„lligen Arbeitsauft.];
                                                   Editable=No }
    { 1620;   ;My Sub. Work Orders ;Integer       ;AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Work Orders;
                                                              DEA=Meine Arbeitsauftr„ge];
                                                   Editable=No }
    { 1621;   ;My Planned Sub. WO (Due);Integer   ;AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Planned Work Orders;
                                                              DEA=Meine Geplanten Arbeitsauft.];
                                                   Editable=No }
    { 1622;   ;My Planned Sub. WO (Overdue);Integer;
                                                   AccessByPermission=TableData 5092=R;
                                                   CaptionML=[ENU=My Overdue Work Orders;
                                                              DEA=Meine šberf„lligen Arbeitsauft.];
                                                   Editable=No }
    { 1800;   ;New Work Orders (Resp.);Integer    ;CaptionML=[ENU=New Work Orders;
                                                              DEA=Neue Arbeitsauftr„ge];
                                                   Editable=No }
    { 1801;   ;New Alarm Work Orders (Resp.);Integer;
                                                   CaptionML=[ENU=New Alarm Work Orders;
                                                              DEA=Neue Alarm Arbeitsauftr„ge];
                                                   Editable=No }
    { 1810;   ;Open Work Orders (Resp.);Integer   ;CaptionML=[ENU=Open Work Orders;
                                                              DEA=Offene Arbeitsauftr„ge];
                                                   Editable=No }
    { 1820;   ;Work Orders In Process (Resp.);Integer;
                                                   CaptionML=[ENU=Work Orders In Process;
                                                              DEA=Arbeitsauftr„ge in Bearbeitung];
                                                   Editable=No }
    { 1830;   ;Completed Work Orders (Resp.);Integer;
                                                   CaptionML=[ENU=Completed Work Orders;
                                                              DEA=Fertiggestellte Arbeitsauftr„ge];
                                                   Editable=No }
    { 3000;   ;-- REQUESTS --      ;Boolean        }
    { 3001;   ;Requests            ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Request),
                                                                                  CM Status=CONST(Open)));
                                                   AccessByPermission=TableData 5080=R;
                                                   CaptionML=[ENU=Requests;
                                                              DEA=Anfragen];
                                                   Editable=No }
    { 3010;   ;My Requests         ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Request),
                                                                                  CM Assigned User ID=FIELD(User ID Filter),
                                                                                  CM Status=CONST(Open)));
                                                   AccessByPermission=TableData 5080=R;
                                                   CaptionML=[ENU=My Requests;
                                                              DEA=Meine Anfragen];
                                                   Editable=No }
    { 3020;   ;Postboned Requests  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Type=CONST(Request),
                                                                                  CM Scheduled Date=FIELD(Undue Date Filter),
                                                                                  CM Status=CONST(Open)));
                                                   AccessByPermission=TableData 5080=R;
                                                   CaptionML=[ENU=Postboned Requests;
                                                              DEA=Zurckgestellte Anfragen];
                                                   Editable=No }
    { 4000;   ;--ALARMS--          ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS General Setup");
                                                   CaptionML=[ENU=My New Alarms;
                                                              DEA=Meine Neuen Alarme];
                                                   Editable=No }
    { 4100;   ;New Alarms          ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Source=FILTER(Alarm|Manual Alarm),
                                                                                        CM Status=CONST(New)));
                                                   CaptionML=[ENU=New Alarms;
                                                              DEA=Neue Alarme];
                                                   Description=FF;
                                                   Editable=No }
    { 4105;   ;Open Alarms         ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Source=FILTER(Alarm|Manual Alarm),
                                                                                        CM Status=CONST(Open)));
                                                   CaptionML=[ENU=Open Alarms;
                                                              DEA=Offene Alarme];
                                                   Description=FF;
                                                   Editable=No }
    { 4110;   ;Alarms In Process   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Source=FILTER(Alarm|Manual Alarm),
                                                                                        CM Status=CONST(In Process)));
                                                   CaptionML=[ENU=Alarms In Process;
                                                              DEA=Alarme In Bearbeitung];
                                                   Description=FF;
                                                   Editable=No }
    { 4120;   ;Completed Alarms    ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Source=FILTER(Alarm|Manual Alarm),
                                                                                        CM Status=CONST(Completed)));
                                                   CaptionML=[ENU=Completed Alarms;
                                                              DEA=Fertiggestellte Alarme];
                                                   Description=FF;
                                                   Editable=No }
    { 9999;   ;-- FILTERS --       ;Boolean        }
    { 10000;  ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Date Filter;
                                                              DEA=Datumsfilter];
                                                   Editable=No }
    { 10010;  ;Due Date Filter     ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Due Date Filter;
                                                              DEA=F„lligkeitsdatumsfilter];
                                                   Editable=No }
    { 10011;  ;Due Date Filter (Planned);Date     ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Due Date Filter (Planned);
                                                              DEA=F„lligkeitsdatumsfilter (Geplant)];
                                                   Editable=No }
    { 10012;  ;Overdue Date Filter (Planned);Date ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Overdue Date Filter (Planned);
                                                              DEA=šberf„lligkeitsdatumsfilter (Geplant)];
                                                   Editable=No }
    { 10020;  ;Overdue Date Filter ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Overdue Date Filter;
                                                              DEA=šberf„lligkeits-Datumsfilter] }
    { 10025;  ;Undue Date Filter   ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Undue Date Filter;
                                                              DEA=Nichtf„lligkeits-Datumsfilter] }
    { 10030;  ;Today Date Filter   ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Today Date Filter;
                                                              DEA=Heute Datumsfilter] }
    { 10040;  ;Week Date Filter    ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=This Week Date Filter;
                                                              DEA=Diese Woche Datumsfilter] }
    { 10050;  ;Month Date Filter   ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=This Moth Filter;
                                                              DEA=Dieses Monat Filter] }
    { 10100;  ;User ID Filter      ;Code50        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=User ID Filter;
                                                              DEA=Benutzer-ID-Filter] }
    { 10200;  ;Resp. Center Filter Asset;Code10   ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Resp. Center Filter Asset;
                                                              DEA=Zust„ndigkeitseinheitenfilter Anlagen];
                                                   Editable=No }
    { 10210;  ;Resp. Center Filter Project;Code10 ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=Resp. Center Filter Project;
                                                              DEA=Zust„ndigkeitseinheitenfilter Projekt];
                                                   Editable=No }
    { 20010;  ;RC Allow New Workorder;Boolean      }
    { 20020;  ;RC Allow New Request;Boolean        }
  }
  KEYS
  {
    {    ;Primary Key                             ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    PROCEDURE SetRespCenterFilter@1();
    VAR
      CMUserAccMgt@1000 : Codeunit 70010;
    BEGIN
      {Asset}
      IF CMUserAccMgt.GetAssetRespFilter() <> '' THEN BEGIN
        FILTERGROUP(2);
        SETFILTER("Resp. Center Filter Asset", CMUserAccMgt.GetAssetRespFilter());
        FILTERGROUP(0);
      END;

      {Project}
      IF CMUserAccMgt.GetProjectRespFilter() <> '' THEN BEGIN
        FILTERGROUP(2);
        SETFILTER("Resp. Center Filter Project", CMUserAccMgt.GetProjectRespFilter());
        FILTERGROUP(0);
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70020 CMMS Object
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=16:28:30;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Operational Status;
    OnInsert=BEGIN
               IF "CM Is Temporary" THEN
                 EXIT;

               CMGenMgt.GetNo(Rec);
               CMAssetMgt.CreateUpdateContact(Rec);
               CMAssetMgt.CreateUpdateDimension(Rec);

               CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::Created, Rec."No.", STRSUBSTNO(Text001, Rec."No."));
             END;

    OnModify=BEGIN
               IF "CM Is Temporary" THEN
                 EXIT;

               IF (Rec.Name <> xRec.Name) AND (Rec."No." <> '') THEN BEGIN
                 CMAssetMgt.CreateUpdateContact(Rec);
                 CMAssetMgt.CreateUpdateDimension(Rec);
               END;
             END;

    OnDelete=BEGIN
               IF "CM Is Temporary" THEN
                 EXIT;

               CMGenMgt.DeleteWoAndTaskByAsset(Rec,TRUE);
               CMGenMgt.DeleteAssetAddData(Rec);
             END;

    CaptionML=ENU=CMMS Object;
    LookupPageID=Page70021;
    DrillDownPageID=Page70021;
  }
  FIELDS
  {
    { 10  ;   ;_GENERAL            ;Boolean        }
    { 90  ;   ;Objecttype          ;Option        ;CaptionML=[ENU=Objecttype;
                                                              DEA=Objekttyp];
                                                   OptionString=Asset,Project }
    { 100 ;   ;No.                 ;Code20        ;CaptionML=[ENU=No.;
                                                              DEA=Nr.] }
    { 200 ;   ;Name                ;Text50        ;CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 210 ;   ;Name 2              ;Text100       ;CaptionML=ENU=Alternative Name;
                                                   Description=EXT }
    { 220 ;   ;Address             ;Text50        ;CaptionML=[ENU=Address;
                                                              DEA=Adresse];
                                                   Description=EXT }
    { 230 ;   ;Extended Address    ;Text50        ;CaptionML=[ENU=Extended Address 2;
                                                              DEA=Erweiterte Adresse];
                                                   Description=EXT }
    { 240 ;   ;City                ;Text50        ;OnValidate=VAR
                                                                DummyCounty@1000000000 : Text[30];
                                                              BEGIN
                                                              END;

                                                   CaptionML=ENU=City }
    { 250 ;   ;Post Code           ;Text20        ;TableRelation=IF (Country Code=FILTER(>'')) "Post Code".Code WHERE (Country/Region Code=FIELD(Country Code))
                                                                 ELSE IF (Country Code=CONST()) "Post Code".Code;
                                                   OnValidate=VAR
                                                                DummyCounty@1000000000 : Text[30];
                                                              BEGIN
                                                              END;

                                                   ValidateTableRelation=No;
                                                   CaptionML=ENU=ZIP Code }
    { 260 ;   ;Country Code        ;Code10        ;TableRelation=Country/Region;
                                                   CaptionML=ENU=Country Code }
    { 261 ;   ;Coordinates Latitude;Decimal       ;CaptionML=ENU=Coordinates Latitude;
                                                   DecimalPlaces=0:6 }
    { 262 ;   ;Coordinates Longitude;Decimal      ;CaptionML=ENU=Coordinates Longitude;
                                                   DecimalPlaces=0:6 }
    { 263 ;   ;Country/Region Name ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Country/Region.Name WHERE (Code=FIELD(Country Code)));
                                                   CaptionML=ENU=Country Name;
                                                   Description=FF }
    { 265 ;   ;Company Name        ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data"."Accounting Entity" WHERE (Type=CONST(Contract),
                                                                                                                        Key1=FIELD(No.),
                                                                                                                        Main Contract=CONST(Yes)));
                                                   TableRelation=Company.Name;
                                                   CaptionML=ENU=Company Name;
                                                   Description=FF;
                                                   Editable=No }
    { 266 ;   ;Contact No.         ;Code20        ;TableRelation=Contact.No. WHERE (Type=CONST(Company));
                                                   CaptionML=ENU=Contact No.;
                                                   Editable=No }
    { 270 ;   ;Portfolio           ;Text50        ;CaptionML=ENU=Portfolio }
    { 271 ;   ;Capacity DC kWp     ;Decimal       ;CaptionML=ENU=Capacity [DC kWp];
                                                   MinValue=0;
                                                   Description=[[kWp]]] }
    { 279 ;   ;_ADDITONAL          ;Boolean        }
    { 490 ;   ;Country Specific ID ;Text250       ;CaptionML=ENU=Country Specific ID;
                                                   Description=#delete }
    { 500 ;   ;Other General Information;Text250  ;Description=#delete? }
    { 999 ;   ;_INTERNAL           ;Boolean        }
    { 1600;   ;Operational Status  ;Option        ;OnValidate=BEGIN
                                                                CMUserAccMgt.ChangeOperationalStatusAllowed(TRUE);
                                                              END;

                                                   CaptionML=[ENU=Operational Status;
                                                              DEA=Status];
                                                   OptionCaptionML=[DEU=Neu,Freigegeben,Inaktiv;
                                                                    ENU=New,Released,Inactive];
                                                   OptionString=New,Released,Inactive }
    { 1610;   ;Commercial Status   ;Option        ;OnValidate=BEGIN
                                                                CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::Modified, Rec.FIELDNAME("Commercial Status"), STRSUBSTNO(Text002, FORMAT(xRec."Commercial Status"), FORMAT(Rec."Commercial Status")));
                                                              END;

                                                   CaptionML=ENU=Commercial Status;
                                                   OptionString=Not Ready For Invoicing,Ready For Invoicing }
    { 1620;   ;Inactive at Date    ;Date          ;CaptionML=[ENU=Inactive at Date;
                                                              DEA=Inaktiv ab Datum] }
    { 2000;   ;Main Asset No.      ;Code20        ;CaptionML=[ENU=Main Asset No.;
                                                              DEA=Hauptanlagennr.];
                                                   Editable=No }
    { 2100;   ;Asset Type          ;Option        ;CaptionML=[ENU=Asset Type;
                                                              DEA=Asset Type];
                                                   OptionCaptionML=[ENU=Asset,Main Asset,Sub Asset;
                                                                    DEA=Anlage,Hauptanlage,Unteranlage];
                                                   OptionString=Asset,Main Asset,Sub Asset;
                                                   Editable=No }
    { 2110;   ;Is Project of Asset ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("CMMS Additional Data" WHERE (Objecttype=CONST(Asset),
                                                                                                   Type=CONST(Project),
                                                                                                   Key1=FIELD(Asset No. Filter),
                                                                                                   Key2=FIELD(No.)));
                                                   CaptionML=[ENU=Is Project of Asset;
                                                              DEA=Ist Projekt von Anlage];
                                                   Description=FF;
                                                   Editable=No }
    { 2120;   ;Asset No. Filter    ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Asset));
                                                   CaptionML=[ENU=Asset No. Filter;
                                                              DEA=Anlagennr. Filter];
                                                   Description=FF;
                                                   Editable=No }
    { 2200;   ;Dimension Set ID    ;Integer       ;CaptionML=[ENU=Dimension Set ID;
                                                              DEA=Dimensionssatz ID] }
    { 20000;  ;New Workorders      ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(New)));
                                                   CaptionML=[ENU=New Workorders;
                                                              DEA=Neue Arbeitsauftr„ge];
                                                   Editable=No }
    { 20100;  ;Open Workorders     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(Open)));
                                                   CaptionML=[ENU=Open Workorders;
                                                              DEA=Offene Arbeitsauftr„ge];
                                                   Editable=No }
    { 20200;  ;In Proc. Workorders ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(In Process)));
                                                   CaptionML=[ENU=In Proc. Workorders;
                                                              DEA=In Bearb. - Arbeitsauftr„ge];
                                                   Editable=No }
    { 20300;  ;Completed Workorders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(Completed)));
                                                   CaptionML=[ENU=Completed Workorders;
                                                              DEA=Fertiggestellte Arbeitsauftr„ge];
                                                   Editable=No }
    { 20400;  ;Done Workorders     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(Done)));
                                                   CaptionML=[ENU=Done Workorders;
                                                              DEA=Erledigte Arbeitsauftr„ge];
                                                   Description=FF;
                                                   Editable=No }
    { 20500;  ;Discarded Workorders;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Status=CONST(Discarded)));
                                                   CaptionML=[ENU=Discraded Workorders;
                                                              DEA=Geschlossene Arbeitsauftr„ge];
                                                   Description=FF;
                                                   Editable=No }
    { 20600;  ;Users               ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(User),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Users;
                                                              DEA=Benutzer];
                                                   Description=FF;
                                                   Editable=No }
    { 20610;  ;Customers           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Customer),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Customers;
                                                              DEA=Debitoren];
                                                   Description=FF;
                                                   Editable=No }
    { 20620;  ;Activities          ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (CM Is CMMS Log Entry=CONST(Yes),
                                                                                                    CM Object No.=FIELD(No.)));
                                                   CaptionML=[ENU=Activities;
                                                              DEA=Aktivit„ten];
                                                   Description=FF;
                                                   Editable=No }
    { 20630;  ;Subassets           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(SubAsset),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Subassets;
                                                              DEA=Unteranlagen];
                                                   Description=FF;
                                                   Editable=No }
    { 20640;  ;Projects            ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Project),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Projects;
                                                              DEA=Projekte];
                                                   Description=FF;
                                                   Editable=No }
    { 20650;  ;Contracts           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Contract),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Contracts;
                                                              DEA=Vetr„ge];
                                                   Description=FF;
                                                   Editable=No }
    { 20660;  ;Relations           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Relation),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Relations;
                                                              DEA=Verbindungen];
                                                   Description=FF;
                                                   Editable=No }
    { 20670;  ;Assets              ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Project),
                                                                                                   Key2=FIELD(No.)));
                                                   CaptionML=[ENU=Assets;
                                                              DEA=Anlagen];
                                                   Description=FF;
                                                   Editable=No }
    { 25999;  ;_TECHNICAL          ;Boolean        }
    { 26500;  ;Inverter Type       ;Option        ;OptionString=[ ,Central,Decentral,Other] }
    { 26600;  ;Mounting            ;Option        ;CaptionML=ENU=Mounted;
                                                   OptionString=[ ,Ground,Roof,Other] }
    { 26610;  ;Surroundings        ;Text50        ;CaptionML=ENU=Surroundings }
    { 26710;  ;Commissioning Date  ;Date          ;CaptionML=ENU=Commissioning Date }
    { 26720;  ;PAC Date            ;Date          ;CaptionML=ENU=PAC Date }
    { 26730;  ;FAC Date            ;Date          ;CaptionML=ENU=FAC Date }
    { 26740;  ;Additional Technical Info;Text250  ;CaptionML=ENU=Additional Technical Info }
    { 26750;  ;Azimut              ;Decimal       ;CaptionML=[ENU=Azimut;
                                                              DEA=Azimut];
                                                   Description=#delete }
    { 26760;  ;Tilt                ;Decimal       ;CaptionML=[ENU=Tilt;
                                                              DEA=Tilt];
                                                   Description=#delete }
    { 29999;  ;_REPORTING          ;Boolean        }
    { 30010;  ;Export PPA Price    ;Decimal       ;DecimalPlaces=2:4 }
    { 30011;  ;Export PPA Currency ;Code10        ;TableRelation=Currency.Code;
                                                   Description=NEW }
    { 30050;  ;Irradiation Yield Study;Decimal    ;FieldClass=FlowField;
                                                   CalcFormula=Sum("CMMS Additional Data"."Yield Total" WHERE (Objecttype=CONST(Asset),
                                                                                                               Type=CONST(YieldStudy),
                                                                                                               Key1=FIELD(No.),
                                                                                                               Key3=FILTER(IRRAD*),
                                                                                                               Valid Source=CONST(Yes)));
                                                   CaptionML=ENU=Irradiation Yield Study [kWh/mý/Year];
                                                   Description=FF;
                                                   Editable=No }
    { 30060;  ;Anticipated Annual Yield;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("CMMS Additional Data"."Yield Total" WHERE (Objecttype=CONST(Asset),
                                                                                                               Type=CONST(YieldStudy),
                                                                                                               Key1=FIELD(No.),
                                                                                                               Key3=FILTER(PROD*),
                                                                                                               Valid Source=CONST(Yes)));
                                                   CaptionML=ENU=Anticipated Annual Yield [kWh];
                                                   Description=FF;
                                                   Editable=No }
    { 30110;  ;Subsidy Tariff Details;Decimal     ;DecimalPlaces=2:4 }
    { 30111;  ;Subsidy Tariff Currency;Code10     ;TableRelation=Currency.Code;
                                                   Description=NEW }
    { 30200;  ;Email Notification  ;Boolean       ;CaptionML=[ENU=Email Notification;
                                                              DEA=Email Benachrichtigung] }
    { 39999;  ;_OPERATIONAL        ;Boolean        }
    { 41000;  ;Available in PV Plus;Boolean        }
    { 41010;  ;Available in EEM    ;Boolean        }
    { 41020;  ;EEM Identification  ;Text250       ;Description=#datatype change }
    { 41030;  ;Direct Marketer Interface;Boolean  ;CaptionML=ENU=Direct Marketer Interface }
    { 41100;  ;External Portal Available;Boolean  ;CaptionML=ENU=External Portal Available }
    { 41110;  ;Monitoring Type of Internet;Option ;OptionString=[ ,GSM,Microwave Link,Other];
                                                   Description=#delete }
    { 41120;  ;Monitoring Internet Details;Text150;Description=#delete }
    { 41130;  ;Security Internet Details;Text150  ;Description=#delete }
    { 41200;  ;On Site Maintanance ;Option        ;CaptionML=[ENU=On Site Maintanance;
                                                              DEA=Vor Ort Wartung];
                                                   OptionString=[ ,Internal,Subcontractor,Internal and Subcontractor,Not relevant] }
    { 41210;  ;Security Center Handling;Boolean   ;CaptionML=ENU=Security Center Handling;
                                                   Description=#wording }
    { 41220;  ;Site Entry Specifics;Text250        }
    { 41230;  ;Health and Safety Requirements;Text250 }
    { 49999;  ;_PROJECT            ;Boolean        }
    { 50000;  ;Project Order No.   ;Code20        ;CaptionML=[ENU=Order No.;
                                                              DEA=Auftragsnr.] }
    { 50010;  ;Project Quote No    ;Code20        ;CaptionML=[ENU=Quote No.;
                                                              DEA=Angebotsnr.] }
    { 50020;  ;Project Start Date  ;Date          ;CaptionML=[ENU=Start Date;
                                                              DEA=Startdatum] }
    { 50030;  ;Project End Date    ;Date          ;CaptionML=[ENU=End Date;
                                                              DEA=Enddatum] }
    { 50031;  ;Project Due date    ;Date          ;CaptionML=ENU=Due Date }
    { 50040;  ;Project Trigger     ;Option        ;CaptionML=[ENU=Trigger;
                                                              DEA=Ausl”ser];
                                                   OptionString=[ ,Internal,Technical Enhancement,Customer Request,,,,,,,,,Other] }
    { 50050;  ;Project Goals       ;Text80        ;CaptionML=[ENU=Goals;
                                                              DEA=Ziele] }
    { 50060;  ;Project Summary     ;Text80        ;CaptionML=[ENU=Summary;
                                                              DEA=Zusammenfassung] }
    { 50070;  ;Project Documentation;Text80       ;CaptionML=[ENU=Documentation;
                                                              DEA=Dokumentation] }
    { 50200;  ;Project Prority     ;Option        ;CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionString=Low,Medium,High }
    { 50210;  ;Project Status      ;Option        ;OptionString=Conception,Detail planning,Under Construction,Comissioned,Closed }
    { 50220;  ;First Project Manager;Code50       ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data".Key2 WHERE (Type=CONST(User),
                                                                                                         Objecttype=CONST(Project),
                                                                                                         Key1=FIELD(No.),
                                                                                                         Project Manager=CONST(Yes)));
                                                   CaptionML=ENU=First Project Manager;
                                                   Description=FF;
                                                   Editable=No }
    { 50221;  ;First Related Customer;Code20      ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data".Key3 WHERE (Type=CONST(Customer),
                                                                                                         Objecttype=CONST(Project),
                                                                                                         Key1=FIELD(No.)));
                                                   CaptionML=ENU=First Related Customer;
                                                   Description=FF;
                                                   Editable=No }
    { 50222;  ;First Related Customer Name;Text50 ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data"."Customer Name" WHERE (Type=CONST(Customer),
                                                                                                                    Objecttype=CONST(Project),
                                                                                                                    Key1=FIELD(No.)));
                                                   CaptionML=ENU=First Related Customer;
                                                   Description=FF;
                                                   Editable=No }
    { 50223;  ;First Related Asset ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data".Key1 WHERE (Type=CONST(Project),
                                                                                                         Objecttype=CONST(Asset),
                                                                                                         Key2=FIELD(No.)));
                                                   CaptionML=ENU=First Related Asset;
                                                   Description=FF;
                                                   Editable=No }
    { 50230;  ;Project Company Name;Text30        ;TableRelation=Company.Name;
                                                   CaptionML=ENU=Project Company Name }
    { 50299;  ;_EXTENDED           ;Boolean        }
    { 50300;  ;Weekend Working Procedure;Text250   }
    { 50330;  ;Customer Demand Level;Option       ;CaptionML=ENU=Customer Demand Level;
                                                   OptionString=[ ,not relevant,minor,below average,average,demanding,high demanding];
                                                   Description=#deleted (Migration zu Vertag) }
    { 50340;  ;Monitoring Access Details;Text250  ;CaptionML=ENU=Monitoring Access Details;
                                                   Description=#delete }
    { 59999;  ;_OTHER              ;Boolean        }
    { 60000;  ;Responsibility Center;Code10       ;TableRelation="Responsibility Center";
                                                   CaptionML=[ENU=Responsibility Center;
                                                              DEA=Zust„ndigkeitseinheitencode] }
    { 70000;  ;CM Is Temporary     ;Boolean       ;CaptionML=[ENU=Is Temporary;
                                                              DEA=Ist Tempor„r] }
    { 70001;  ;Empty 1             ;Boolean       ;Description=Dont ask }
    { 70002;  ;Empty 2             ;Boolean        }
    { 70003;  ;Empty 3             ;Boolean        }
    { 70004;  ;Empty 4             ;Boolean        }
    { 80000;  ;_MANAGEMENTREPORTING;Boolean        }
    { 80010;  ;Customer No. Filter ;Code20        ;FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80020;  ;Customer Name Filter;Text50        ;FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80030;  ;Customer Company Chain Filter;Text50;
                                                   FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80110;  ;Contract No. Filter ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="CMMS Contract";
                                                   Description=Filter }
    { 80210;  ;User ID (Role) Filter;Code50       ;FieldClass=FlowFilter;
                                                   TableRelation="User Setup";
                                                   Description=Filter }
    { 80310;  ;Project No. Filter  ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Project));
                                                   Description=Filter }
    { 80320;  ;Project Name Filter ;Text50        ;FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80420;  ;Asset Name Filter   ;Text50        ;FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80430;  ;Asset Type Filter   ;Text50        ;FieldClass=FlowFilter;
                                                   Description=Filter }
    { 80510;  ;Contact No. Filter  ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Contact WHERE (CMMS Is CMMS Contact=CONST(Yes));
                                                   Description=Filter }
    { 80520;  ;Business Relation Filter;Text50    ;FieldClass=FlowFilter;
                                                   TableRelation="Business Relation";
                                                   Description=Filter }
    { 81000;  ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   Editable=No }
    { 89000;  ;No. of WOs (Due Date);Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count(Opportunity WHERE (CM Is Workorder=CONST(Yes),
                                                                                        CM Objecttype=FIELD(Objecttype),
                                                                                        CM Object No.=FIELD(No.),
                                                                                        CM Due Date=FIELD(Date Filter)));
                                                   Editable=No }
    { 89100;  ;No. of To-dos  (Due Date);Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count(To-do WHERE (CM Objecttype=FIELD(Objecttype),
                                                                                  CM Object No.=FIELD(No.),
                                                                                  Date=FIELD(Date Filter)));
                                                   Editable=No }
    { 89500;  ;Asset Time Tracking Qty.;Decimal   ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Date Filter),
                                                                                                            CM Asset No.=FIELD(No.)));
                                                   Editable=No }
    { 89600;  ;Project Time Tracking Qty.;Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Time Sheet Detail"."CM Quantity" WHERE (CM Is CMMS Timesheet=CONST(Yes),
                                                                                                            CM Entry Date=FIELD(Date Filter),
                                                                                                            CM Project No.=FIELD(No.)));
                                                   Editable=No }
    { 90000;  ;ShowAsset           ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("CMMS Additional Data" WHERE (Type=CONST(User),
                                                                                                   Key1=FIELD(No.),
                                                                                                   Key2=FIELD(User ID Filter))) }
    { 90010;  ;ShowAsset2          ;Boolean        }
    { 90100;  ;User ID Filter      ;Code50        ;FieldClass=FlowFilter;
                                                   CaptionML=[ENU=User ID Filter;
                                                              DEA=Benutzer-ID-Filter] }
    { 90200;  ;Block Dim.          ;Boolean        }
  }
  KEYS
  {
    {    ;Objecttype,No.                          ;Clustered=Yes }
    {    ;Country Code,Objecttype,No.              }
    {    ;Objecttype,Main Asset No.                }
    {    ;Objecttype,Main Asset No.,Asset Type     }
    {    ;Objecttype,Asset Type                    }
    {    ;Objecttype,Responsibility Center         }
    {    ;No.,Name                                 }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name,Field300,Country Code,Operational Status,Main Asset No. }
    { 2   ;Brick               ;No.,Name,Operational Status,Name 2,Empty 1,Country Code }
  }
  CODE
  {
    VAR
      PostCode@1000000000 : Record 225;
      CMUserAccMgt@1000000007 : Codeunit 70010;
      CMAssetMgt@1000000004 : Codeunit 70020;
      CMGenMgt@1000000002 : Codeunit 70000;
      LogEntry@1000000003 : Record 5065;
      Text001@1000000005 : TextConst 'ENU=Asset / Project "%1" created.';
      Text002@1000000006 : TextConst 'ENU=From "%1" to "%2"';

    BEGIN
    END.
  }
}

OBJECT Table 70021 CMMS Additional Data
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=16:24:33;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               CheckAssetInactive();

               ValidateSubAsset();
               ValidateProject();
               ValidateContract();
               ValidateToDo();
               SetNewAsset();
               ValidateCustomerNo();
               ValidateUserSubstitution();
               ValidateNotificationCopy();
               ValidateFieldsetRow();
               ValidateReportFieldsetSetup();
             END;

    OnModify=BEGIN
               CheckAssetInactive();
               UpdateYieldSum();
             END;

    OnDelete=BEGIN
               CheckAssetInactive();
               ClearOldAsset(Rec);
               DeleteToDo();
               DeleteRecurChecklist();
               DeleteFieldsetRows();

               IF Rec.Type = Rec.Type::Contract THEN
                 CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::"Contract Detached", (Rec.Key2 + ' | '  + FORMAT(Rec."Contract Start Date")), STRSUBSTNO(Text013, Rec.Key2, Rec.Key1, FORMAT(Rec."Contract Start Date")));
             END;

    OnRename=BEGIN
               CheckAssetInactive();

               IF Rec.Type = Rec.Type::Contract THEN
                 CMGenMgt.CreateLogEntry(xRec,LogEntry."CM Log Type"::"Contract Detached", (xRec.Key2 + ' | '  + FORMAT(xRec."Contract Start Date")), STRSUBSTNO(Text013, xRec.Key2, xRec.Key1, FORMAT(xRec."Contract Start Date")));

               ValidateContract();
               ValidateSubAsset();
               ValidateProject();
               ValidateUserSubstitution();
               ClearOldAsset(xRec);
               SetNewAsset();
               RenameFieldsetRows();
             END;

    CaptionML=ENU=CMMS Additional Data;
  }
  FIELDS
  {
    { 90  ;   ;Objecttype          ;Option        ;OptionString=Asset,Project,Contract,User,Tool,Contact,Workorder,Task }
    { 100 ;   ;Type                ;Option        ;OptionString=SubAsset,Customer,Contract,User,Project,YieldStudy,Tool,Skill,Relation,ContractPackage,RecurringToDo,GpmOperatorMapping,GpmPlantMapping,Substitue,Manufacturer,Model,Fieldset,FieldsetRow,ReportFieldsetSetup,NotificationCopy }
    { 110 ;   ;Key1                ;Code20        ;TableRelation=IF (Type=CONST(SubAsset),
                                                                     Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Asset))
                                                                     ELSE IF (Type=CONST(Customer),
                                                                              Objecttype=CONST(Asset)) "CMMS Object".No.
                                                                              ELSE IF (Type=CONST(User),
                                                                                       Objecttype=CONST(Asset)) "CMMS Object".No.
                                                                                       ELSE IF (Type=CONST(Project),
                                                                                                Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Asset))
                                                                                                ELSE IF (Type=CONST(Contract),
                                                                                                         Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Asset))
                                                                                                         ELSE IF (Type=CONST(YieldStudy),
                                                                                                                  Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Asset))
                                                                                                                  ELSE IF (Type=CONST(Relation),
                                                                                                                           Objecttype=CONST(Asset)) "CMMS Object".No.
                                                                                                                           ELSE IF (Type=CONST(Relation),
                                                                                                                                    Objecttype=CONST(Contract)) "CMMS Contract".No.
                                                                                                                                    ELSE IF (Type=CONST(ContractPackage),
                                                                                                                                             Objecttype=CONST(Contract)) "CMMS Contract".No.
                                                                                                                                             ELSE IF (Type=CONST(Substitue),
                                                                                                                                                      Objecttype=CONST(User)) "User Setup"."User ID"
                                                                                                                                                      ELSE IF (Type=CONST(FieldsetRow),
                                                                                                                                                               Objecttype=CONST(Asset)) "CMMS Additional Data".Key1 WHERE (Objecttype=CONST(Asset),
                                                                                                                                                                                                                           Type=CONST(Fieldset));
                                                   Description=Dont write code in OnLookup() trigger! }
    { 120 ;   ;Key2                ;Code50        ;TableRelation=IF (Type=CONST(User),
                                                                     Objecttype=CONST(Asset)) "User Setup"
                                                                     ELSE IF (Type=CONST(User),
                                                                              Objecttype=CONST(Project)) "User Setup"
                                                                              ELSE IF (Type=CONST(Project),
                                                                                       Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Project))
                                                                                       ELSE IF (Type=CONST(Contract),
                                                                                                Objecttype=CONST(Asset)) "CMMS Contract".No. WHERE (Template=CONST(No))
                                                                                                ELSE IF (Type=CONST(Relation)) Contact
                                                                                                ELSE IF (Type=CONST(SubAsset),
                                                                                                         Objecttype=CONST(Asset)) "CMMS Object".No. WHERE (Objecttype=CONST(Asset))
                                                                                                         ELSE IF (Type=CONST(ContractPackage),
                                                                                                                  Objecttype=CONST(Contract)) "CMMS Code Data".Code WHERE (TableID=CONST(70021),
                                                                                                                                                                           FieldID=CONST(120),
                                                                                                                                                                           Type=CONST(0))
                                                                                                                                                                           ELSE IF (Type=CONST(Substitue),
                                                                                                                                                                                    Objecttype=CONST(User)) "User Setup"."User ID"
                                                                                                                                                                                    ELSE IF (Type=CONST(Model)) "CMMS Additional Data".Key2 WHERE (Type=CONST(Manufacturer),
                                                                                                                                                                                                                                                   Line No.=FIELD(Line No.));
                                                   Description=Dont write code in OnLookup() trigger! }
    { 130 ;   ;Key3                ;Code50        ;OnValidate=BEGIN
                                                                ValidateCustomerNo();
                                                                ValidateYieldType();
                                                              END;

                                                   OnLookup=BEGIN
                                                              LookupCustomerNo();
                                                              LookupCustomerNoReportFieldsetSetup();
                                                              LookupYieldType();
                                                            END;
                                                             }
    { 140 ;   ;Line No.            ;Integer        }
    { 10000;  ;XXX SUB ASSET XXX   ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### SUB ASSET
                                                                Key1 = Main Asset No.
                                                                Key2 = Sub Asset No.
                                                                }
                                                              END;
                                                               }
    { 10010;  ;Asset Name          ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object".Name WHERE (No.=FIELD(Key2)));
                                                   CaptionML=[ENU=Asset Name;
                                                              DEA=Anlagenname];
                                                   Description=FF;
                                                   Editable=No }
    { 20000;  ;XXX CUSTOMER XXX    ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### CUSTOMER
                                                                Key1 = Asset No.
                                                                Key3 = Customer No.
                                                                }
                                                              END;
                                                               }
    { 20010;  ;Customer Name       ;Text50        ;OnValidate=VAR
                                                                Customer@1000000000 : Record 18;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Customer Name;
                                                              DEA=Debitorname];
                                                   Editable=No }
    { 20030;  ;Contact Person No.  ;Code20        ;TableRelation=Contact.No. WHERE (Type=CONST(Person));
                                                   CaptionML=[ENU=Contact Person No.;
                                                              DEA=Kontaktperson Nr.] }
    { 20040;  ;Customer No. Invalid;Boolean       ;CaptionML=[ENU=Customer No. Invalid;
                                                              DEA=Debitornr. Ungltig] }
    { 20050;  ;Customer Company Chain;Code20      ;Editable=No }
    { 20100;  ;Share               ;Integer       ;CaptionML=[ENU=Share;
                                                              DEA=Anteil];
                                                   MinValue=0 }
    { 30000;  ;XXX CONTRACT XXX    ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### CONTRACT
                                                                Key1 = Asset No.
                                                                Key2 = Contract Code.
                                                                Key3 = Contract Start Date (As String "2018-03-22")
                                                                }
                                                              END;
                                                               }
    { 30010;  ;Contract Name       ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Contract".Name WHERE (No.=FIELD(Key2),
                                                                                                  Template=CONST(No)));
                                                   CaptionML=[ENU=Contract Name;
                                                              DEA=Vertragsname];
                                                   Description=FF;
                                                   Editable=No }
    { 30011;  ;Asset NameX         ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object".Name WHERE (Objecttype=CONST(Asset),
                                                                                                No.=FIELD(Key1)));
                                                   CaptionML=ENU=Asset Name;
                                                   Description=FF;
                                                   Editable=No }
    { 30020;  ;Main Contract       ;Boolean       ;OnValidate=BEGIN
                                                                ValidateMainContract();
                                                              END;
                                                               }
    { 30100;  ;Contract Type       ;Code20        ;OnValidate=VAR
                                                                CMMSCodeData@1000000000 : Record 70006;
                                                              BEGIN
                                                                CMMSCodeData.ValidateCodeData(Rec.RECORDID.TABLENO, Rec.FIELDNO("Contract Type"), 0, Rec."Contract Type");
                                                              END;

                                                   OnLookup=VAR
                                                              CMMSCodeData@1000000000 : Record 70006;
                                                            BEGIN
                                                              CMMSCodeData.LookupCodeData(Rec.RECORDID.TABLENO, Rec.FIELDNO("Contract Type"), 0, Rec."Contract Type");
                                                            END;

                                                   CaptionML=[ENU=Type;
                                                              DEA=Art] }
    { 30110;  ;Contract Start Date ;Date          ;OnValidate=BEGIN
                                                                UpdateContractStartDate();

                                                                IF (Rec."Contract Start Date" <> 0D) AND (Rec."Start Date Invoicing" = 0D) THEN
                                                                    Rec."Start Date Invoicing" := Rec."Contract Start Date";

                                                                IF (Rec."Contract Start Date" <> 0D) AND
                                                                   (Rec."Contract End Date" <> 0D) AND
                                                                   (Rec."Contract Start Date" >= "Contract End Date") THEN
                                                                  ERROR(Text018, Rec.FIELDCAPTION("Contract Start Date"), Rec.FIELDCAPTION("Contract End Date"));
                                                              END;

                                                   CaptionML=[ENU=Start Date;
                                                              DEA=Startdatum] }
    { 30120;  ;Contract End Date   ;Date          ;OnValidate=BEGIN
                                                                IF (Rec."Contract End Date" <> 0D) AND (Rec."End Date Invoicing" = 0D) THEN
                                                                    Rec."End Date Invoicing" := Rec."Contract End Date";

                                                                IF (Rec."Contract Start Date" <> 0D) AND
                                                                   (Rec."Contract End Date" <> 0D) AND
                                                                   (Rec."Contract Start Date" >= "Contract End Date") THEN
                                                                  ERROR(Text018, Rec.FIELDCAPTION("Contract Start Date"), Rec.FIELDCAPTION("Contract End Date"));
                                                              END;

                                                   CaptionML=[ENU=End Date;
                                                              DEA=Enddatum] }
    { 30130;  ;Start Date Invoicing;Date          ;CaptionML=[ENU=Start Date Invoicing;
                                                              DEA=Startdatum Verrechnung] }
    { 30140;  ;End Date Invoicing  ;Date          ;CaptionML=[ENU=Enddate Invoicing;
                                                              DEA=Enddatum Verrechnung] }
    { 30150;  ;Invoicing Period    ;Option        ;CaptionML=[ENU=Invoicing Period;
                                                              DEA=Verrechnungsperiode];
                                                   OptionString=Month,Quarter,Half Year,Year }
    { 30160;  ;Invoicing Type      ;Option        ;CaptionML=[ENU=Invoicing Type;
                                                              DEA=Verrechnungsart];
                                                   OptionString=Pre,Post }
    { 30170;  ;Monthly Amount      ;Decimal       ;CaptionML=[ENU=Monthly Amount;
                                                              DEA=Monatlicher Betrag] }
    { 30180;  ;Currency Code       ;Code10        ;TableRelation=Currency.Code;
                                                   CaptionML=[ENU=Currency Code;
                                                              DEA=W„hrungscode] }
    { 30190;  ;Accounting Entity   ;Text30        ;TableRelation=Company.Name;
                                                   CaptionML=ENU=Accounting Entity }
    { 40000;  ;XXX USER XXX        ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### USER
                                                                Key1 = Asset No.
                                                                Key2 = User ID
                                                                }
                                                              END;
                                                               }
    { 40020;  ;Reporting Responsible;Boolean      ;CaptionML=[ENU=Reporting Responsible;
                                                              DEA=Verantwortlich Reporting] }
    { 40030;  ;Invoice Responsible ;Boolean       ;CaptionML=[ENU=Invoice Responsible;
                                                              DEA=Verantwortlich Rechnungsstellung] }
    { 40040;  ;Accounting Responsible;Boolean     ;CaptionML=[ENU=Accounting Responsible;
                                                              DEA=Verantwortlich Buchhaltung] }
    { 40050;  ;Plant Manager       ;Boolean       ;CaptionML=[ENU=Plant Manager;
                                                              DEA=Plant Manager] }
    { 40051;  ;Project Manager     ;Boolean       ;CaptionML=[ENU=Project Manager;
                                                              DEA=Projekt Manager] }
    { 40060;  ;Field Service       ;Boolean       ;CaptionML=[ENU=Field Service;
                                                              DEA=Field Service] }
    { 40070;  ;Customer            ;Boolean       ;CaptionML=[ENU=Customer;
                                                              DEA=Kunde] }
    { 40080;  ;Remote Monitoring Responsible;Boolean;
                                                   CaptionML=ENU=Remote Monitoring Responsible }
    { 40090;  ;Responsible OM supervisor;Boolean  ;CaptionML=ENU=Responsible O&M supervisor }
    { 45000;  ;XXX PROJECT XXX     ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### USER
                                                                Key1 = Asset No.
                                                                Key2 = Project No.
                                                                }
                                                              END;
                                                               }
    { 45010;  ;Asset NameXX        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object".Name WHERE (Objecttype=CONST(Asset),
                                                                                                No.=FIELD(Key1)));
                                                   OnLookup=BEGIN
                                                              ;
                                                            END;

                                                   CaptionML=ENU=Asset Name;
                                                   Description=FF;
                                                   Editable=No }
    { 45020;  ;Project NameXX      ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object".Name WHERE (Objecttype=CONST(Project),
                                                                                                No.=FIELD(Key2)));
                                                   OnLookup=BEGIN
                                                              ;
                                                            END;

                                                   CaptionML=ENU=Project Name;
                                                   Description=FF;
                                                   Editable=No }
    { 50000;  ;XXX ASSET PROJECT XXX;Boolean      ;OnValidate=BEGIN
                                                                {
                                                                ### ASSET PROJECT
                                                                Key1 = Asset No. (ASSET)
                                                                Key2 = Project No. (PROJECT)
                                                                }
                                                              END;
                                                               }
    { 60000;  ;XXX YIELD STUDY XXX ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### YIELD STUDY
                                                                Key1 = Asset No. (ASSET)
                                                                Key2 = Source
                                                                Key3 = Yield Type (Code Data link)
                                                                }
                                                              END;
                                                               }
    { 60030;  ;Yield Source Description;Text50     }
    { 60040;  ;Valid Source        ;Boolean       ;OnValidate=BEGIN
                                                                ValidateValidYield();
                                                              END;
                                                               }
    { 60041;  ;Degradation         ;Decimal       ;CaptionML=ENU=Degradation [%];
                                                   DecimalPlaces=2:2;
                                                   MinValue=0;
                                                   MaxValue=2 }
    { 60042;  ;Unit of Measure     ;Code10        ;TableRelation="Unit of Measure".Code }
    { 60043;  ;Degradation Start Date;Date         }
    { 60050;  ;January             ;Decimal        }
    { 60060;  ;February            ;Decimal        }
    { 60070;  ;March               ;Decimal        }
    { 60080;  ;April               ;Decimal        }
    { 60090;  ;May                 ;Decimal        }
    { 60100;  ;June                ;Decimal        }
    { 60110;  ;July                ;Decimal        }
    { 60120;  ;August              ;Decimal        }
    { 60130;  ;September           ;Decimal        }
    { 60140;  ;October             ;Decimal        }
    { 60150;  ;November            ;Decimal        }
    { 60160;  ;December            ;Decimal        }
    { 60200;  ;Yield Total         ;Decimal       ;Editable=No }
    { 60300;  ;Is Yield Type 1     ;Boolean        }
    { 60301;  ;Is Yield Type 2     ;Boolean        }
    { 70000;  ;CM Is Temporary     ;Boolean       ;CaptionML=[ENU=Is Temporary;
                                                              DEA=Ist Tempor„r] }
    { 90000;  ;XXX RELATION XXX    ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### RELATION
                                                                Key1 = Object No.
                                                                Key3 = Contact No.
                                                                }
                                                              END;
                                                               }
    { 90010;  ;Business Relation Code;Code20      ;TableRelation="Business Relation".Code;
                                                   OnValidate=BEGIN
                                                                ValidateBusinessRelation();
                                                              END;
                                                               }
    { 90011;  ;Relation Group Code ;Code20        ;TableRelation="CMMS Code Data".Code WHERE (TableID=CONST(70021),
                                                                                              FieldID=CONST(90011),
                                                                                              Type=CONST(0));
                                                   OnValidate=BEGIN
                                                                ValidateBusinessGroup();
                                                              END;
                                                               }
    { 90020;  ;Business Relation Description;Text50 }
    { 90021;  ;Relation Group Description;Text50   }
    { 90030;  ;Contact Name        ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.Name WHERE (No.=FIELD(Key2)));
                                                   CaptionML=[ENU=Contact Name;
                                                              DEA=Kontaktname];
                                                   Editable=No }
    { 90040;  ;Contact Phone No.   ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact."Phone No." WHERE (No.=FIELD(Key2)));
                                                   CaptionML=[ENU=Contact Phone No.;
                                                              DEA=Kontakt Telefonnr.];
                                                   Editable=No }
    { 90050;  ;Contact E-Mail      ;Text80        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Contact.E-Mail WHERE (No.=FIELD(Key2)));
                                                   CaptionML=[ENU=Contact E-Mail;
                                                              DEA=Kontakt E-Mail];
                                                   Editable=No }
    { 91000;  ;XXX CONTRACT PACKAGE XXX;Boolean   ;OnValidate=BEGIN
                                                                {
                                                                ### CONTRACT PACKAGE
                                                                Key1 = Contract No.
                                                                Key2 = Packackage Code
                                                                }
                                                              END;
                                                               }
    { 91020;  ;Package Description ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Code Data".Description WHERE (TableID=CONST(70021),
                                                                                                          FieldID=CONST(120),
                                                                                                          Type=CONST(0)));
                                                   Editable=No }
    { 91030;  ;Additional Package Info;Text250     }
    { 100000; ;XXX RECURRING TASK XXX;Boolean     ;OnValidate=BEGIN
                                                                {
                                                                ### RECURRING TASK
                                                                Key1 = Object No.
                                                                Line No = Line No.
                                                                }
                                                              END;
                                                               }
    { 100090; ;Inactive            ;Boolean       ;CaptionML=[ENU=Inactive;
                                                              DEA=Inaktiv] }
    { 100100; ;Start Date          ;Date          ;CaptionML=[ENU=Start Date;
                                                              DEA=Startdatum] }
    { 100105; ;Start Time          ;Time          ;CaptionML=[ENU=Starting Time;
                                                              DEA=Startzeit] }
    { 100110; ;Due Date            ;Date          ;CaptionML=[ENU=Due Date;
                                                              DEA=F„lligkeitsdatum] }
    { 100120; ;Expiration Date     ;Date          ;CaptionML=[ENU=Expiration Date;
                                                              DEA=Ablaufdatum] }
    { 100130; ;Recurring Date Interval;DateFormula;CaptionML=[ENU=Recurring Date Interval;
                                                              DEA=Wiederholungsrate] }
    { 100200; ;All Day Event       ;Boolean       ;CaptionML=[ENU=All Day Event;
                                                              DEA=Ganzt„giges Ereignis] }
    { 100300; ;Interaction Group Code;Code10      ;TableRelation="Interaction Group";
                                                   CaptionML=[ENU=Interaction Group Code;
                                                              DEA=Aktivit„tengruppencode] }
    { 100310; ;Interaction Template Code;Code10   ;TableRelation="Interaction Template" WHERE (Interaction Group Code=FIELD(Interaction Group Code));
                                                   OnValidate=VAR
                                                                TodoInteractionLanguage@1000 : Record 5196;
                                                                Attachment@1001 : Record 5062;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Interaction Template Code;
                                                              DEA=Aktivit„tenvorlagencode] }
    { 100320; ;Activity Code       ;Code10        ;TableRelation=Activity;
                                                   OnValidate=BEGIN
                                                                ValidateActivityCode();
                                                              END;

                                                   CaptionML=[ENU=Activity Code;
                                                              DEA=Aktionscode];
                                                   NotBlank=Yes }
    { 100330; ;Step No.            ;Integer       ;CaptionML=[ENU=Step No.;
                                                              DEA=Schrittnr.] }
    { 100400; ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 100430; ;Maintask Step No.   ;Integer       ;CaptionML=[ENU=Maintask Step No.;
                                                              DEA=Hauptaufg. Schrittnr.] }
    { 100440; ;Maintask Line No.   ;Integer       ;CaptionML=[ENU=Maintask Step No.;
                                                              DEA=Hauptaufg. Schrittnr.] }
    { 100450; ;Subtype             ;Option        ;CaptionML=[ENU=Subtype;
                                                              DEA=Subtyp];
                                                   OptionString=[ ,Checklist,Team] }
    { 100500; ;Priority            ;Option        ;CaptionML=[ENU=Priority;
                                                              DEA=Priorit„t];
                                                   OptionCaptionML=[ENU=Low,Normal,High;
                                                                    DEA=Niedrig,Normal,Hoch];
                                                   OptionString=Low,Normal,High }
    { 100600; ;Duration            ;Duration      ;CaptionML=[ENU=Duration;
                                                              DEA=Dauer] }
    { 100700; ;Clearable           ;Boolean       ;CaptionML=[ENU=Clearable;
                                                              DEA=Verrechenbar] }
    { 100710; ;Automated Posting   ;Boolean       ;CaptionML=[ENU=Automated Posting;
                                                              DEA=Automatische Buchung] }
    { 101000; ;Source Type         ;Option        ;CaptionML=[ENU=Source Type;
                                                              DEA=Herkunftsart];
                                                   OptionCaptionML=[ENU=Asset,Project,Contract,User,Tool,Contact,Workorder,Task;
                                                                    DEA=Anlage,Projekt,Vertrag,Benutzer,Werkzeug,Kontakt,Arbeitsauftrag,Aufgabe];
                                                   OptionString=Asset,Project,Contract,User,Tool,Contact,Workorder,Task }
    { 101010; ;Source No.          ;Code20        ;CaptionML=[ENU=Source No.;
                                                              DEA=Herkunftsnr.] }
    { 101015; ;Source Line No.     ;Integer       ;CaptionML=[ENU=Source No.;
                                                              DEA=Herkunftsnr.] }
    { 101020; ;Creation Date       ;Date          ;CaptionML=[ENU=Creation Date;
                                                              DEA=Errichtungsdatum] }
    { 101021; ;Created by          ;Code50        ;CaptionML=[ENU=Created by;
                                                              DEA=Errichtet von] }
    { 110000; ;XXX GPM Plant Mapping XXX;Boolean  ;OnValidate=BEGIN
                                                                {
                                                                ### GPM Plant Mapping
                                                                Key1 = GPM Plant ID
                                                                }
                                                              END;
                                                               }
    { 110100; ;Asset No.           ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Asset));
                                                   CaptionML=[ENU=CMMS Asset No.;
                                                              DEA=CMMS Anlagennr.] }
    { 110110; ;GPM Op. Mapping Comment;Text80     ;CaptionML=[ENU=Comment;
                                                              DEA=Kommentar] }
    { 120000; ;XXX GPM Operator Mapping XXX;Boolean;
                                                   OnValidate=BEGIN
                                                                {
                                                                ### GPM Operator Mapping
                                                                Key1 = GPM Operator ID
                                                                }
                                                              END;
                                                               }
    { 120100; ;User Id             ;Code50        ;TableRelation="User Setup"."User ID";
                                                   CaptionML=[ENU=CMMS User ID;
                                                              DEA=CMMS Benutzer ID] }
    { 120110; ;GPM Plant Mapping Comment;Text80   ;CaptionML=[ENU=Comment;
                                                              DEA=Kommentar] }
    { 120120; ;Ignore this Operator;Boolean        }
    { 130000; ;XXX SUBSTITUE XXX   ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### SUBSTITUTE
                                                                Key1 = Original User ID (the one who is away)
                                                                Key2 = Substite User ID (the one who substitutes him)
                                                                }
                                                              END;
                                                               }
    { 130010; ;From Date           ;Date          ;CaptionML=ENU=From Date }
    { 130020; ;To Date             ;Date          ;CaptionML=ENU=To Date }
    { 140000; ;XXX MANUFACTURER XXX;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### MANUFACTURER
                                                                Key2 = Manufacturer Code
                                                                Line No. = Component Type <Equipment Hierarchie>
                                                                }
                                                              END;
                                                               }
    { 140010; ;Manufacturer Name   ;Text80         }
    { 150000; ;XXX MODEL XXX       ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### MODEL
                                                                Key2 = Manufacturer Code
                                                                Key3 = Model Code
                                                                Line No. = Component Type <Equipment Hierarchie>
                                                                }
                                                              END;
                                                               }
    { 150010; ;Model Name          ;Text80         }
    { 150020; ;Manufacturer Name_  ;Text80        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Additional Data"."Manufacturer Name" WHERE (Type=CONST(Manufacturer),
                                                                                                                        Key2=FIELD(Key2),
                                                                                                                        Line No.=FIELD(Line No.)));
                                                   CaptionML=ENU=Manufacturer Name;
                                                   Description=FF;
                                                   Editable=No }
    { 150030; ;Component Type      ;Option        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Asset Component"."Component Type" WHERE (Component Type Integer=FIELD(Line No.)));
                                                   CaptionML=ENU=Component Type;
                                                   OptionString=Modules,Inverter,Combiner Box,Sensor,Monitoring Hardware,Internet Connection HW,Security System,Meters,Transformer,Switchgear,Cables,Remote Access Details,,,,,,,Others;
                                                   Description=FF;
                                                   Editable=No }
    { 160000; ;XXX FIELDSET XXX    ;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### FIELDSET
                                                                Key1 = Fieldset Code
                                                                }
                                                              END;
                                                               }
    { 160010; ;Fieldset Name       ;Text50        ;CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 160020; ;No. of Rows         ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(FieldsetRow),
                                                                                                   Key1=FIELD(Key1)));
                                                   CaptionML=[ENU=No. of Rows;
                                                              DEA=Anzahl Zeilen];
                                                   Description=FF;
                                                   Editable=No }
    { 180000; ;XXX FIELDSET ROW XXX;Boolean       ;OnValidate=BEGIN
                                                                {
                                                                ### FIELDSET
                                                                Key1 = Fieldset Code
                                                                Line No. = Line Number (Row)
                                                                }
                                                              END;
                                                               }
    { 180006; ;Default Fieldset    ;Boolean       ;OnValidate=VAR
                                                                Rec2@1000000000 : Record 70021;
                                                              BEGIN
                                                                IF NOT "Default Fieldset" THEN
                                                                  EXIT;

                                                                Rec2.RESET;
                                                                Rec2.SETRANGE(Objecttype, Rec.Objecttype::Asset);
                                                                Rec2.SETRANGE(Type, Rec.Type::Fieldset);
                                                                Rec2.SETFILTER(Key1, '<>%1',Rec.Key1);
                                                                Rec2.SETRANGE("Default Fieldset", TRUE);
                                                                IF Rec2.FINDFIRST() THEN
                                                                  ERROR(Text019, Rec2.Key1);
                                                              END;
                                                               }
    { 180007; ;Style               ;Option        ;CaptionML=[ENU=Style;
                                                              DEA=Style];
                                                   OptionString=Normal,Short Caption,Short Value,Value Only,Caption Only }
    { 180008; ;Area                ;Option        ;CaptionML=[ENU=Area;
                                                              DEA=Bereich];
                                                   OptionString=Workorder,Task }
    { 180009; ;Position            ;Option        ;CaptionML=[ENU=Position;
                                                              DEA=Position];
                                                   OptionString=left,right }
    { 180010; ;Order               ;Integer       ;CaptionML=[ENU=Order;
                                                              DEA=Sortierung] }
    { 180100; ;Caption Type        ;Option        ;InitValue=Caption;
                                                   CaptionML=[ENU=Caption Type;
                                                              DEA=Beschreibung Typ];
                                                   OptionString=Caption,Value,Text }
    { 180110; ;Caption Table       ;Option        ;OnValidate=BEGIN
                                                                Rec."Caption Table Id" := GetCaptionTableId();
                                                              END;

                                                   CaptionML=[ENU=Caption Table;
                                                              DEA=Beschreibung Tabelle];
                                                   OptionString=Workorder,Task,Asset }
    { 180111; ;Caption Table Id    ;Integer       ;CaptionML=[ENU=Caption Table Id;
                                                              DEA=Beschreibung Tabelle Id] }
    { 180120; ;Caption Field Id    ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Caption Table Id));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Caption Fieldname");
                                                              END;

                                                   CaptionML=[ENU=Caption Field Id;
                                                              DEA=Beschreibung Feldnr.] }
    { 180121; ;Caption Fieldname   ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field."Field Caption" WHERE (TableNo=FIELD(Caption Table Id),
                                                                                                   No.=FIELD(Caption Field Id)));
                                                   CaptionML=[ENU=Caption Fieldname;
                                                              DEA=Beschreibung Feldname];
                                                   Description=FF;
                                                   Editable=No }
    { 180130; ;Caption Text        ;Text80        ;CaptionML=[ENU=Caption Text;
                                                              DEA=Beschreibung Text] }
    { 180500; ;Value Type          ;Option        ;InitValue=Value;
                                                   CaptionML=[ENU=Value Type;
                                                              DEA=Wert Type];
                                                   OptionString=Caption,Value,Text }
    { 180510; ;Value Table         ;Option        ;OnValidate=BEGIN
                                                                Rec."Value Table Id" := GetValueTableId();
                                                              END;

                                                   CaptionML=[ENU=Value Table;
                                                              DEA=Wert Tabelle];
                                                   OptionString=Workorder,Task,Asset }
    { 180511; ;Value Table Id      ;Integer       ;CaptionML=[ENU=Value Table Id;
                                                              DEA=Wert Tabellennr.] }
    { 180520; ;Value Field Id      ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Value Table Id));
                                                   OnValidate=BEGIN
                                                                CALCFIELDS("Value Fieldname");
                                                              END;

                                                   CaptionML=[ENU=Value Field Id;
                                                              DEA=Wert Feldnr.] }
    { 180521; ;Value Fieldname     ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Field."Field Caption" WHERE (TableNo=FIELD(Value Table Id),
                                                                                                   No.=FIELD(Value Field Id)));
                                                   CaptionML=[ENU=Value Fieldname;
                                                              DEA=Wert Feldname];
                                                   Description=FF;
                                                   Editable=No }
    { 180530; ;Value Text          ;Text80        ;CaptionML=[ENU=Value Text;
                                                              DEA=Wert Text] }
    { 200000; ;XXX REPORT FIELDSET SETUP XXX;Boolean;
                                                   OnValidate=BEGIN
                                                                {
                                                                ### FIELDSET
                                                                Key1 = ''
                                                                Key2 = Asset No. OR Cluster/Portfolio (UPPERCASE)
                                                                Key3 = Customer No.
                                                                }
                                                              END;
                                                               }
    { 200110; ;Portfolio / Cluster ;Text50        ;OnValidate=BEGIN
                                                                Key2 := UPPERCASE("Portfolio / Cluster");
                                                              END;
                                                               }
    { 200120; ;Asset No._          ;Code20        ;TableRelation="CMMS Object".No. WHERE (Objecttype=CONST(Asset));
                                                   OnValidate=BEGIN
                                                                Key2 := "Asset No._";
                                                              END;

                                                   CaptionML=[ENU=Asset No.;
                                                              DEA=Asset No.] }
    { 200200; ;Customer Company    ;Text30        ;TableRelation=Company.Name }
    { 200500; ;Fieldset Code       ;Code20        ;TableRelation="CMMS Additional Data".Key1 WHERE (Objecttype=CONST(Asset),
                                                                                                    Type=CONST(Fieldset),
                                                                                                    Default Fieldset=CONST(No));
                                                   NotBlank=Yes }
    { 210000; ;XXX NOTIFICATION COPY XXX;Boolean  ;OnValidate=BEGIN
                                                                {
                                                                ### SUBSTITUTE
                                                                Key1 = Original User ID
                                                                Key2 = Send Copy To User ID
                                                                }
                                                              END;
                                                               }
    { 210010; ;Not. Copy From Date ;Date          ;CaptionML=ENU=From Date }
    { 210020; ;Not. Copy To Date   ;Date          ;CaptionML=ENU=To Date }
  }
  KEYS
  {
    {    ;Objecttype,Type,Key1,Key2,Key3,Line No. ;Clustered=Yes }
    {    ;Objecttype,Type,Key2,Key1                }
    {    ;Objecttype,Type,Key3,Key1                }
    {    ;Objecttype,Type,Key1,Inactive,Start Date,Due Date,Interaction Group Code }
    {    ;Objecttype,Type,Key1,Area,Position,Order }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=%1 mustnot be the same as %2!;DEA=%1 darf nicht gleich %2 sein!';
      Text002@1000000001 : TextConst 'ENU=%1 is a Main Asset!;DEA=%1 ist eine Hauptanlage!';
      Text003@1000000002 : TextConst 'ENU=%1 is a Sub Asset!;DEA=%1 ist eine Unteranlage!';
      Text004@1000000003 : TextConst 'ENU=%1 is already a Sub Asset from Main Asset %2!;DEA=%1 ist bereits eine Unteranlage von Main Asset %2!';
      Text005@1000000004 : TextConst 'ENU=Main Asset No.;DEA=Hauptanlagennr.';
      Text006@1000000005 : TextConst 'ENU=Sub Asset No.;DEA=Unteranlagennr.';
      Text007@1000000006 : TextConst 'ENU=The Projct %1 already belongs to Asset %2!;DEA=Das Projekt %1 geh”rt schon zur Anlage %2!';
      Text008@1000000007 : TextConst 'ENU=Invalid Input.;DEA=Ungltige Eingabe.';
      Text009@1000000008 : TextConst 'ENU=Invalid Input. %1 is a Project.;DEA=Ungltige Eingabe. %1 ist ein Projekt!';
      Text010@1000000009 : TextConst 'ENU=Contract "%1" is a template!;DEA=Vertrag "%1" ist eine Vorlage!';
      Text011@1000000010 : TextConst 'ENU=Only one valid Source per Type allowed!;DEA=Es darf nur eine gltige Source pro Typ geben!';
      error004@1000000011 : TextConst 'ENU=Execution terminated!;DEA=Die Verarbeitung wurde abgebrochen!';
      CMGenMgt@1000000012 : Codeunit 70000;
      LogEntry@1000000013 : Record 5065;
      Text012@1000000014 : TextConst 'ENU=Contract "%1" was assigned to Object "%2".';
      Text013@1000000015 : TextConst 'ENU=Contract "%1" was detached from Object "%2" (Start Date %3).';
      Text014@1000000016 : TextConst 'ENU=User ID cannot be the same as Substitution!;DEA=Benutzer ID darf nicht die selbe wie Vertreter sein!';
      Text015@1000000017 : TextConst 'ENU=Please enter correct dates!;DEA=Bitte korrekte Datumswerte eingeben!';
      Text016@1000000018 : TextConst 'ENU=The associated %1 %2 is inactive!;DEA=Das zugeh”rige Asset %1 %2 ist inaktiv!';
      Text017@1000000019 : TextConst 'ENU=There can be only one Main Contract per Asset.;DEA=Es kann nur ein Hauptvertrag pro Anlage hinterlegt werden.';
      Text018@1000000020 : TextConst 'ENU=" ""%1"" has to be before ""%2"".";DEA=" ""%1"" muss vor ""%2"" liegen."';
      Text019@1000000021 : TextConst 'ENU=There is only one Default Fieldset allowe. Current Default Fieldset: %1.;DEA=Es darf nur ein Default Fieldset geben. Aktuelles Default Fieldset: %1.';
      Text020@1000000022 : TextConst 'ENU=Please provide %1 or %2.;DEA=Geben Sie entweder %1 oder %2 an.';
      Text021@1000000023 : TextConst 'ENU=Please provide Customer or Asset Information.;DEA=Geben Sie entweder Kunden oder Anlageninformationen an.';
      Text022@1000000024 : TextConst 'ENU=User ID cannot be the same as Send Copy to!;DEA=Benutzer ID darf nicht die selbe wie Copie senden an sein!';

    LOCAL PROCEDURE ValidateSubAsset@1000000000();
    VAR
      SubAsset@1000000000 : Record 70021;
      Asset@1000000001 : Record 70020;
    BEGIN
      //### SUB ASSET
      IF Rec.Type <> Rec.Type::SubAsset THEN
        EXIT;

      Asset.GET(Asset.Objecttype::Asset, Rec.Key1);
      IF Asset.Objecttype = Asset.Objecttype::Project THEN
        ERROR(STRSUBSTNO(Text009, Asset."No."));

      Asset.GET(Asset.Objecttype::Asset, Rec.Key2);
      IF Asset.Objecttype = Asset.Objecttype::Project THEN
        ERROR(STRSUBSTNO(Text009, Asset."No."));
      IF Asset."Asset Type" = Asset."Asset Type"::"Main Asset" THEN
        ERROR(STRSUBSTNO(Text002, Rec.Key2));

      IF Rec.Key1 = Rec.Key2 THEN
        ERROR(STRSUBSTNO(Text001,Text005, Text006));

      SubAsset.RESET;
      SubAsset.SETRANGE(Objecttype, Rec.Objecttype::Asset);
      SubAsset.SETRANGE(Type,Rec.Type::SubAsset);
      SubAsset.SETRANGE(Key1, Rec.Key2);
      IF SubAsset.FINDFIRST() THEN
        ERROR(STRSUBSTNO(Text002, Rec.Key2));

      SubAsset.RESET;
      SubAsset.SETCURRENTKEY(Objecttype,Type,Key2,Key1);
      SubAsset.SETRANGE(Objecttype, Rec.Objecttype::Asset);
      SubAsset.SETRANGE(Type,Rec.Type::SubAsset);
      SubAsset.SETRANGE(Key2, Rec.Key2);
      IF SubAsset.FINDFIRST() THEN
        ERROR(STRSUBSTNO(Text004, Rec.Key2, SubAsset.Key1));
    END;

    LOCAL PROCEDURE SetNewAsset@1000000004();
    VAR
      Asset@1000000000 : Record 70020;
    BEGIN
      //### SUB ASSET
      IF Rec.Type <> Rec.Type::SubAsset THEN
        EXIT;

      Asset.GET(Asset.Objecttype::Asset, Rec.Key1);
      Asset."Main Asset No." := Rec.Key1;
      Asset."Asset Type" := Asset."Asset Type"::"Main Asset";
      Asset.MODIFY(FALSE);

      Asset.GET(Asset.Objecttype::Asset, Rec.Key2);
      Asset."Main Asset No." := Rec.Key1;
      Asset."Asset Type" := Asset."Asset Type"::"Sub Asset";
      Asset.MODIFY(FALSE);
    END;

    LOCAL PROCEDURE ClearOldAsset@1000000006(Record@1000000002 : Record 70021);
    VAR
      Asset@1000000000 : Record 70020;
      SubAsset@1000000001 : Record 70021;
    BEGIN
      //### SUB ASSET
      IF Rec.Type <> Rec.Type::SubAsset THEN
        EXIT;

      SubAsset.RESET;
      SubAsset.SETRANGE(Objecttype, SubAsset.Objecttype::Asset);
      SubAsset.SETRANGE(Type,SubAsset.Type::SubAsset);
      SubAsset.SETRANGE(Key1, Record.Key1);
      SubAsset.SETFILTER(Key2,'<>%1', Record.Key2);
      IF NOT SubAsset.FINDFIRST() THEN BEGIN
        Asset.GET(Asset.Objecttype::Asset, Record.Key1);
        Asset."Asset Type" := Asset."Asset Type"::Asset;
        Asset."Main Asset No." := '';
        Asset.MODIFY(FALSE);
      END;

      Asset.GET(Asset.Objecttype::Asset, Record.Key2);
      Asset."Main Asset No." := '';
      Asset."Asset Type" := Asset."Asset Type"::Asset;
      Asset.MODIFY(FALSE);
    END;

    LOCAL PROCEDURE LookupCustomerNo@1000000002();
    VAR
      Customer@1000000000 : Record 18;
      CustomerList@1000000001 : Page 22;
      CompName@1000000002 : Text[30];
    BEGIN
      //### CUSTOMER
      IF Rec.Type <> Rec.Type::Customer THEN
        EXIT;

      CLEAR(Customer);
      CompName := GetObjectCompanyName();
      IF CompName <> '' THEN
        Customer.CHANGECOMPANY(CompName);

      CustomerList.LOOKUPMODE(TRUE);
      IF CompName <> '' THEN
        CustomerList.CMSetCompany(CompName);
      IF CustomerList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        CustomerList.GETRECORD(Customer);
        Rec.VALIDATE(Key3, Customer."No.");
      END;
    END;

    LOCAL PROCEDURE LookupCustomerNoReportFieldsetSetup@1000000031();
    VAR
      Customer@1000000000 : Record 18;
      CustomerList@1000000001 : Page 22;
    BEGIN
      //### REPORT FIELDSET SETUP
      IF Rec.Type <> Rec.Type::ReportFieldsetSetup THEN
        EXIT;

      CLEAR(Customer);
      IF "Customer Company" <> '' THEN
        Customer.CHANGECOMPANY("Customer Company");

      CustomerList.LOOKUPMODE(TRUE);
      IF "Customer Company" <> '' THEN
        CustomerList.CMSetCompany("Customer Company");
      IF CustomerList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        CustomerList.GETRECORD(Customer);
        Rec.VALIDATE(Key3, Customer."No.");
      END;
    END;

    LOCAL PROCEDURE LookupYieldType@1000000009();
    VAR
      CMCodeData@1000000000 : Record 70006;
    BEGIN
      IF Type <> Type::YieldStudy THEN
        EXIT;

      CMCodeData.LookupCodeData(Rec.RECORDID.TABLENO, Rec.FIELDNO(Key3), Rec.Type, Rec.Key3);

      Rec.VALIDATE(Key3);
    END;

    LOCAL PROCEDURE ValidateCustomerNo@1000000001();
    VAR
      Customer@1000000000 : Record 18;
      CompName@1000000001 : Text[30];
    BEGIN
      //### CUSTOMER
      IF Rec.Type <> Rec.Type::Customer THEN
        EXIT;

      CLEAR(Customer);
      CompName := GetObjectCompanyName();
      IF CompName <> '' THEN
        Customer.CHANGECOMPANY(CompName);

      Customer.GET(Key3);
      "Customer Name" := Customer.Name;
      "Customer Company Chain" := Customer."Chain Name";

      Rec.Share := 1;
    END;

    LOCAL PROCEDURE ValidateProject@1000000003();
    VAR
      Asset@1000000000 : Record 70020;
      Project@1000000001 : Record 70020;
      AssetProject@1000000002 : Record 70021;
    BEGIN
      IF Rec.Type <> Rec.Type::Project THEN
        EXIT;

      Asset.GET(Asset.Objecttype::Asset, Rec.Key1);
      Project.GET(Project.Objecttype::Project, Rec.Key2);

      IF(Asset.Objecttype <> Asset.Objecttype::Asset) OR (Project.Objecttype <> Project.Objecttype::Project) THEN
        ERROR(Text008);

      AssetProject.RESET;
      AssetProject.SETCURRENTKEY(Objecttype,Type,Key2,Key1);
      AssetProject.SETRANGE(Objecttype, AssetProject.Objecttype::Asset);
      AssetProject.SETRANGE(Type, Rec.Type::Project);
      AssetProject.SETRANGE(Key2, Rec.Key2);
      AssetProject.SETFILTER(Key1, '<>%1', Rec.Key1);
      IF AssetProject.FINDFIRST() THEN
        ERROR(STRSUBSTNO(Text007, AssetProject.Key2, AssetProject.Key1));

      Project.MODIFY(FALSE);
    END;

    LOCAL PROCEDURE ValidateContract@1000000005();
    VAR
      Contract@1000000000 : Record 70050;
      Asset@1000000002 : Record 70020;
      CMContractMgmt@1000000001 : Codeunit 70021;
      FromRecRef@1000000003 : RecordRef;
      ToRecRef@1000000004 : RecordRef;
    BEGIN
      IF Type <> Type::Contract THEN
        EXIT;

      ValidateMainContract();

      Contract.GET(Key2);
      IF Contract.Template THEN
        ERROR(STRSUBSTNO(Text010, Key2));

      {Update Contract Start Date}
      UpdateContractStartDate();
      Rec.TESTFIELD("Contract Start Date");
      Rec.TESTFIELD(Key3);

      {Update Contract Data}
      UpdateContractData();

      {Copy Recurring ToDos}
      Asset.GET(Asset.Objecttype::Asset, Key1);
      FromRecRef.GETTABLE(Contract);
      ToRecRef.GETTABLE(Asset);
      CMContractMgmt.CopyRelatedToDos(FromRecRef,ToRecRef);

      CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::"Contract Assigned", (Rec.Key2 + ' '  + FORMAT(Rec."Contract Start Date")), STRSUBSTNO(Text012, Rec.Key2, Rec.Key1, FORMAT(Rec."Contract Start Date")));
    END;

    LOCAL PROCEDURE ValidateMainContract@1000000018();
    VAR
      CMAddData@1000000000 : Record 70021;
    BEGIN
      //Only one Main Contract
      IF Rec."Main Contract" THEN BEGIN
        CMAddData.SETRANGE(Objecttype, Rec.Objecttype);
        CMAddData.SETRANGE(Key1, Rec.Key1);
        CMAddData.SETFILTER(Key2, '<>%1', Rec.Key2);
        CMAddData.SETRANGE("Main Contract", TRUE);
        IF CMAddData.FINDFIRST() THEN
          ERROR(Text017);
      END;
    END;

    LOCAL PROCEDURE UpdateContractStartDate@1000000020();
    BEGIN
      IF Rec."Contract Start Date" <> 0D THEN BEGIN
        Rec.Key3 := DateToString(Rec."Contract Start Date");
        EXIT;
      END;

      IF Rec.Key3 <> '' THEN
        Rec."Contract Start Date" := StringToDate(Rec.Key3);
    END;

    LOCAL PROCEDURE UpdateContractData@1000000021();
    VAR
      CmmsContract@1000000000 : Record 70050;
    BEGIN
      IF NOT CmmsContract.GET(Rec.Key2) THEN CmmsContract.INIT();

      IF Rec."Currency Code" = '' THEN
        Rec.VALIDATE("Currency Code", CmmsContract."Currency Code");
      IF Rec."Accounting Entity" = '' THEN
        Rec.VALIDATE("Accounting Entity", CmmsContract."Accounting Entity");
    END;

    LOCAL PROCEDURE ValidateYieldType@1000000008();
    VAR
      CMCodeData@1000000000 : Record 70006;
      CMGenSetup@1000000001 : Record 70000;
      ENCGenMgt@1000000002 : Codeunit 50003;
    BEGIN
      IF Type <> Type::YieldStudy THEN
        EXIT;

      CMCodeData.ValidateCodeData(Rec.RECORDID.TABLENO, Rec.FIELDNO(Key3), Rec.Type, Rec.Key3);

      CMGenSetup.GET();
      CMGenSetup.TESTFIELD("Yield Type 1 (Starts with)");
      CMGenSetup.TESTFIELD("Yield Type 2 (Starts with)");

      IF ENCGenMgt.TextStartsWith(Rec.Key3, CMGenSetup."Yield Type 1 (Starts with)") THEN
        Rec."Unit of Measure" := CMGenSetup."Yield Unit 1";

      IF ENCGenMgt.TextStartsWith(Rec.Key3, CMGenSetup."Yield Type 2 (Starts with)") THEN
        Rec."Unit of Measure" := CMGenSetup."Yield Unit 2";
    END;

    LOCAL PROCEDURE ValidateValidYield@1000000007();
    VAR
      Rec2@1000000000 : Record 70021;
    BEGIN
      IF Type <> Type::YieldStudy THEN
        EXIT;

      IF NOT Rec."Valid Source" THEN
        EXIT;

      Rec2.SETRANGE(Objecttype, Rec.Objecttype);
      Rec2.SETRANGE(Type, Rec.Type);
      Rec2.SETRANGE(Key1, Rec.Key1);
      Rec2.SETFILTER(Key2, '<>%1', Rec.Key2); //Source
      Rec2.SETRANGE(Key3, Rec.Key3);
      Rec2.SETRANGE("Valid Source", TRUE);
      IF Rec2.FINDFIRST() THEN
        ERROR(Text011);
    END;

    LOCAL PROCEDURE ValidateActivityCode@1000000012();
    VAR
      Rec2@1000000000 : Record 70021;
      LText001@1000000001 : TextConst 'ENU=Durch diese Žnderung werden verbundene Zeilen gel”scht und neu Zeilen erstellt! Wollen Sie fortfahren?';
      Rec3@1000000005 : Record 70021;
      ActivityStep@1000000002 : Record 5082;
      NextLineNo@1000000003 : Integer;
      LineSpacing@1000000004 : Integer;
      LText002@1000000006 : TextConst 'ENU=There is not enough space to insert all activity lines.;DEA=Es gibt nicht gengend Platz, um alle Aufgabenzeilen einzufgen.';
      TempRec@1000000007 : TEMPORARY Record 70021;
    BEGIN
      IF Type <> Type::RecurringToDo THEN
        EXIT;

      IF ("Activity Code" = xRec."Activity Code") OR (Rec."Activity Code" = '') THEN
        EXIT;

      IF NOT MODIFY THEN INSERT;

      NextLineNo := Rec."Line No.";

      IF ("Activity Code" <> xRec."Activity Code") AND
        (xRec."Activity Code" <> '') THEN BEGIN
        Rec2.SETRANGE(Objecttype, Rec.Objecttype);
        Rec2.SETRANGE(Type, Rec.Type);
        Rec2.SETRANGE(Key1, Rec.Key1);
        Rec2.SETRANGE(Key2, Rec.Key2);
        Rec2.SETRANGE(Key3, Rec.Key3);
        Rec2.SETFILTER("Line No.", '<>%1', Rec."Line No.");
        Rec2.SETRANGE("Activity Code", xRec."Activity Code");
        IF Rec2.FINDFIRST() THEN
          IF CONFIRM(LText001,TRUE) THEN BEGIN
            {Delete Related Activities}
            Rec2.DELETEALL(TRUE);
          END ELSE BEGIN
            ERROR(error004);
          END;
      END;

      {Create New Activities}
      ActivityStep.SETRANGE("Activity Code", Rec."Activity Code");
      Rec3.SETRANGE(Objecttype, Rec.Objecttype);
      Rec3.SETRANGE(Type, Rec.Type);
      Rec3.SETRANGE(Key1, Rec.Key1);
      Rec3.SETRANGE(Key2, Rec.Key2);
      Rec3.SETRANGE(Key3, Rec.Key3);

      Rec3 := Rec;
      TempRec := Rec;

      IF Rec3.FIND('>') THEN BEGIN
        LineSpacing :=
          (Rec3."Line No." - Rec."Line No.") DIV
          (ActivityStep.COUNT);
        IF LineSpacing = 0 THEN
          ERROR(LText002);
      END ELSE
        LineSpacing := 10000;

      ActivityStep.SETRANGE("Activity Code", Rec."Activity Code");
      ActivityStep.SETFILTER("CM Subtype", '%1|%2', ActivityStep."CM Subtype"::" ", ActivityStep."CM Subtype"::Checklist);
      ActivityStep.SETCURRENTKEY("Activity Code","CM Subtype");
      IF ActivityStep.FIND('-') THEN BEGIN
        Rec.DELETE;
        REPEAT
          Rec2.INIT;
          Rec2 := TempRec;
          Rec2."Line No." := NextLineNo;
          Rec2."Step No." := ActivityStep."Step No.";
          Rec2.Description := ActivityStep.Description;
          Rec2.Priority := ActivityStep.Priority;
          Rec2."Interaction Group Code" := ActivityStep."CM Interaction Group Code";
          Rec2."Interaction Template Code" := ActivityStep."CM Interaction Template Code";
          Rec2."Activity Code" := ActivityStep."Activity Code";
          Rec2."Maintask Step No." := ActivityStep."CM Maintask Step No.";
          Rec2.Subtype := ActivityStep."CM Subtype";
          Rec2."Maintask Line No." := 0;

          //We need to find parent lineno when we have a subtype
          IF Rec2.Subtype = Rec2.Subtype::Checklist THEN BEGIN
            Rec3.SETRANGE(Objecttype, Rec2.Objecttype);
            Rec3.SETRANGE(Type, Rec2.Type);
            Rec3.SETRANGE(Key1, Rec2.Key1);
            Rec3.SETRANGE(Key2, Rec2.Key2);
            Rec3.SETRANGE(Key3, Rec2.Key3);
            Rec3.SETRANGE("Step No.", Rec2."Maintask Step No.");
            Rec3.SETRANGE(Subtype, Rec3.Subtype::" ");
            IF Rec3.FINDFIRST() THEN
              Rec2."Maintask Line No." := Rec3."Line No.";
          END;
          Rec2.INSERT;
          NextLineNo += LineSpacing;
        UNTIL ActivityStep.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE ValidateToDo@1000000010();
    VAR
      LText001@1000000001 : TextConst 'ENU=Durch diese Žnderung werden verbundene Zeilen gel”scht und neu Zeilen erstellt! Wollen Sie fortfahren?';
      LText002@1000000006 : TextConst 'ENU=There is not enough space to insert all activity lines.;DEA=Es gibt nicht gengend Platz, um alle Aufgabenzeilen einzufgen.';
      CMObject@1000000000 : Record 70020;
    BEGIN
      IF Type <> Type::RecurringToDo THEN
        EXIT;

      "Source Type" := "Source Type"::User;
      "Creation Date" := TODAY;
      "Created by" := USERID;
    END;

    LOCAL PROCEDURE ValidateBusinessRelation@1000000013();
    VAR
      LText001@1000000001 : TextConst 'ENU=Durch diese Žnderung werden verbundene Zeilen gel”scht und neu Zeilen erstellt! Wollen Sie fortfahren?';
      LText002@1000000006 : TextConst 'ENU=There is not enough space to insert all activity lines.;DEA=Es gibt nicht gengend Platz, um alle Aufgabenzeilen einzufgen.';
      BusinessRelation@1000000000 : Record 5053;
      CMObject@1000000002 : Record 70020;
    BEGIN
      IF Type <> Type::Relation THEN
        EXIT;

      IF "Business Relation Code" <> xRec."Business Relation Code" THEN
        IF "Business Relation Code" = '' THEN
          "Business Relation Description" := ''
        ELSE
          IF BusinessRelation.GET("Business Relation Code") THEN
            "Business Relation Description" := BusinessRelation.Description;
    END;

    LOCAL PROCEDURE ValidateBusinessGroup@1000000016();
    VAR
      LText001@1000000001 : TextConst 'ENU=Durch diese Žnderung werden verbundene Zeilen gel”scht und neu Zeilen erstellt! Wollen Sie fortfahren?';
      LText002@1000000006 : TextConst 'ENU=There is not enough space to insert all activity lines.;DEA=Es gibt nicht gengend Platz, um alle Aufgabenzeilen einzufgen.';
      CMMSCodeDate@1000000000 : Record 70006;
    BEGIN
      IF Type <> Type::Relation THEN
        EXIT;

      IF "Relation Group Code" <> xRec."Relation Group Code" THEN BEGIN
        IF CMMSCodeDate.GET(Rec.RECORDID.TABLENO, FIELDNO("Relation Group Code"), 0, Rec."Relation Group Code") THEN
          Rec."Relation Group Description" := CMMSCodeDate.Description;
      END;
    END;

    LOCAL PROCEDURE ValidateUserSubstitution@1000000017();
    BEGIN
      IF Type <> Type::Substitue THEN
        EXIT;

      IF Key1 = Key2 THEN
        ERROR(Text014);

      IF ("From Date" < "To Date") THEN
        ERROR(Text015);
    END;

    LOCAL PROCEDURE ValidateNotificationCopy@1000000030();
    BEGIN
      IF Type <> Type::NotificationCopy THEN
        EXIT;

      IF Key1 = Key2 THEN
        ERROR(Text022);

      IF ("From Date" < "To Date") THEN
        ERROR(Text015);
    END;

    LOCAL PROCEDURE ValidateFieldsetRow@1000000027();
    VAR
      Rec2@1000000000 : Record 70021;
    BEGIN
      IF (Type <> Type::FieldsetRow) OR ("Line No." > 0) THEN
        EXIT;

      Rec."Line No." := 10000;

      Rec2.RESET;
      Rec2.SETRANGE(Objecttype, Rec.Objecttype::Asset);
      Rec2.SETRANGE(Type, Rec.Type::FieldsetRow);
      Rec2.SETRANGE(Key1, Rec.Key1);
      IF Rec2.FINDLAST() THEN
        Rec."Line No." := Rec2."Line No." + 10000;
    END;

    LOCAL PROCEDURE ValidateReportFieldsetSetup@1000000029();
    BEGIN
      IF Type <> Type::ReportFieldsetSetup THEN
        EXIT;

      IF (("Asset No._" <> '') AND ("Portfolio / Cluster" <> '')) THEN
        ERROR(Text020, FIELDCAPTION("Asset No._"), FIELDCAPTION("Portfolio / Cluster"));

      IF (Key2 = '') AND (Key3 = '') THEN
        ERROR(Text021);
    END;

    LOCAL PROCEDURE DeleteToDo@1000000014();
    VAR
      Rec2@1000000000 : Record 70021;
      LText001@1000000001 : TextConst 'ENU=Durch diese Žnderung werden verbundene Zeilen gel”scht und neu Zeilen erstellt! Wollen Sie fortfahren?';
      Rec3@1000000005 : Record 70021;
      ActivityStep@1000000002 : Record 5082;
      NextLineNo@1000000003 : Integer;
      LineSpacing@1000000004 : Integer;
      LText002@1000000006 : TextConst 'ENU=There is not enough space to insert all activity lines.;DEA=Es gibt nicht gengend Platz, um alle Aufgabenzeilen einzufgen.';
      TempRec@1000000007 : TEMPORARY Record 70021;
    BEGIN
      IF Type <> Type::RecurringToDo THEN
        EXIT;
    END;

    LOCAL PROCEDURE DeleteRecurChecklist@1000000011();
    VAR
      Rec2@1000000000 : Record 70021;
    BEGIN
      IF Type <> Type::RecurringToDo THEN
        EXIT;

      Rec2.RESET;
      Rec2.SETRANGE(Objecttype, Rec.Objecttype);
      Rec2.SETRANGE(Type, Rec.Type);
      Rec2.SETRANGE(Key1, Rec.Key1);
      Rec2.SETRANGE(Key2, Rec.Key2);
      Rec2.SETRANGE(Key3, Rec.Key3);
      Rec2.SETRANGE("Maintask Step No.", Rec."Step No.");
      Rec2.SETRANGE(Subtype, Rec.Subtype::Checklist);
      Rec2.DELETEALL(FALSE);
    END;

    LOCAL PROCEDURE DeleteFieldsetRows@1000000024();
    VAR
      Rec2@1000000000 : Record 70021;
    BEGIN
      IF Type <> Type::Fieldset THEN
        EXIT;

      Rec2.RESET;
      Rec2.SETRANGE(Objecttype, Rec.Objecttype::Asset);
      Rec2.SETRANGE(Type, Rec.Type::FieldsetRow);
      Rec2.SETRANGE(Key1, Rec.Key1);
      Rec2.DELETEALL(FALSE);
    END;

    LOCAL PROCEDURE RenameFieldsetRows@1000000026();
    VAR
      Rec2@1000000000 : Record 70021;
    BEGIN
      IF (Type <> Type::Fieldset) OR (xRec.Key1 = Rec.Key1) THEN
        EXIT;

      Rec2.RESET;
      Rec2.SETRANGE(Objecttype, Rec.Objecttype::Asset);
      Rec2.SETRANGE(Type, Rec.Type::FieldsetRow);
      Rec2.SETRANGE(Key1, xRec.Key1);
      WHILE(Rec2.FINDFIRST()) DO
        Rec2.RENAME(Rec2.Objecttype, Rec2.Type, Rec.Key1, Rec2.Key2, Rec2.Key3, Rec2."Line No.");
    END;

    LOCAL PROCEDURE UpdateYieldSum@1000000015();
    BEGIN
      IF Type <> Type::YieldStudy THEN
        EXIT;

      "Yield Total" :=
      (
        January +
        February +
        March +
        April +
        May +
        June +
        July +
        August +
        September +
        October +
        November +
        December
      );
    END;

    LOCAL PROCEDURE CheckAssetInactive@1000000028();
    VAR
      CMObject@1000000000 : Record 70020;
    BEGIN
      IF CMObject.GET(Rec.Objecttype, Rec.Key1) THEN BEGIN
        IF CMObject."Operational Status" = CMObject."Operational Status"::Inactive THEN
          ERROR(STRSUBSTNO(Text016, CMObject.Objecttype, CMObject."No."));
      END;
    END;

    PROCEDURE StringToDate@1000000019(value@1000000000 : Text) : Date;
    VAR
      DotNetDateTime@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
      DotNetCultureInfo@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Globalization.CultureInfo" SUPPRESSDISPOSE;
      LocDateTime@1000000003 : DateTime;
    BEGIN
      IF value = '' THEN
        EXIT(0D);

      DotNetDateTime := 0DT;
      LocDateTime := DotNetDateTime.ParseExact(value, 'yyyy-MM-dd', DotNetCultureInfo.InvariantCulture);
      EXIT(DT2DATE(LocDateTime));
    END;

    PROCEDURE DateToString@1000000022(value@1000000002 : Date) : Text;
    VAR
      DotNetDateTime@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
    BEGIN
      IF value = 0D THEN
        EXIT('');

      DotNetDateTime := DotNetDateTime.DateTime(DATE2DMY(value, 3), DATE2DMY(value, 2), DATE2DMY(value, 1));
      EXIT(DotNetDateTime.ToString('yyyy-MM-dd'));
    END;

    PROCEDURE GetCaptionTableId@1000000023() : Integer;
    BEGIN
      CASE Rec."Caption Table" OF
        Rec."Caption Table"::Asset     : EXIT(DATABASE::"CMMS Object");
        Rec."Caption Table"::Workorder : EXIT(DATABASE::Opportunity);
        Rec."Caption Table"::Task      : EXIT(DATABASE::"To-do");
      END;
      EXIT(0);
    END;

    PROCEDURE GetValueTableId@1000000025() : Integer;
    BEGIN
      CASE Rec."Value Table" OF
        Rec."Value Table"::Asset     : EXIT(DATABASE::"CMMS Object");
        Rec."Value Table"::Workorder : EXIT(DATABASE::Opportunity);
        Rec."Value Table"::Task      : EXIT(DATABASE::"To-do");
      END;
      EXIT(0);
    END;

    PROCEDURE GetObjectCompanyName@1000000032() : Text[30];
    VAR
      CMObject@1000000000 : Record 70020;
    BEGIN
      IF Rec.Type <> Rec.Type::Customer THEN
        EXIT('');

      IF NOT CMObject.GET(Rec.Objecttype, Rec.Key1) THEN
        EXIT('');

      IF CMObject.Objecttype = CMObject.Objecttype::Project THEN
        EXIT(CMObject."Project Company Name");

      CMObject.CALCFIELDS("Company Name");
      EXIT(CMObject."Company Name");
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70022 CMMS Asset Customer
{
  OBJECT-PROPERTIES
  {
    Date=15.09.16;
    Time=11:09:46;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnInsert=VAR
               Customer@1000000000 : Record 18;
             BEGIN
             END;

    OnRename=VAR
               Customer@1000000000 : Record 18;
             BEGIN
             END;

    CaptionML=[ENU=Anlage Debitor;
               DEA=Asset Customer];
  }
  FIELDS
  {
    { 100 ;   ;Asset No.           ;Code30        ;TableRelation="CMMS Object".No.;
                                                   CaptionML=[ENU=Asset No.;
                                                              DEA=Anlage Nr.];
                                                   NotBlank=Yes }
    { 200 ;   ;Customer No.        ;Code20        ;OnValidate=VAR
                                                                Customer@1000000000 : Record 18;
                                                              BEGIN
                                                                CALCFIELDS("Asset Company Name");
                                                                CLEAR(Customer);
                                                                IF "Asset Company Name" <> '' THEN
                                                                  Customer.CHANGECOMPANY("Asset Company Name");

                                                                Customer.GET("Customer No.");
                                                                "Customer Name" := Customer.Name;
                                                              END;

                                                   OnLookup=VAR
                                                              CustomerList@1000000000 : Page 22;
                                                              Customer@1000000001 : Record 18;
                                                            BEGIN
                                                              CALCFIELDS("Asset Company Name");
                                                              CLEAR(Customer);
                                                              IF "Asset Company Name" <> '' THEN
                                                                Customer.CHANGECOMPANY("Asset Company Name");

                                                              CustomerList.LOOKUPMODE := TRUE;
                                                              IF "Asset Company Name" <> '' THEN
                                                                CustomerList.CMSetCompany("Asset Company Name");
                                                              IF CustomerList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                                                CustomerList.GETRECORD(Customer);
                                                                Rec."Customer No." := Customer."No.";
                                                                Rec."Customer Name" := Customer.Name;
                                                              END;
                                                            END;

                                                   CaptionML=[ENU=Customer No.;
                                                              DEA=Debitornr.];
                                                   NotBlank=Yes }
    { 210 ;   ;Customer Name       ;Text50        ;OnValidate=VAR
                                                                Customer@1000000000 : Record 18;
                                                              BEGIN
                                                              END;

                                                   CaptionML=[ENU=Customer Name;
                                                              DEA=Debitorname];
                                                   Editable=No }
    { 220 ;   ;Asset Company Name  ;Text30        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("CMMS Object"."Company Name" WHERE (No.=FIELD(Asset No.)));
                                                   CaptionML=[ENU=Asset Companyname;
                                                              DEA=Anlage Firmenname];
                                                   Description=FF;
                                                   Editable=No }
    { 230 ;   ;Contact Person No.  ;Code20        ;TableRelation=Contact.No. WHERE (Type=CONST(Person));
                                                   CaptionML=[ENU=Contact Person No.;
                                                              DEA=Kontaktperson Nr.] }
    { 300 ;   ;Share               ;Integer       ;CaptionML=[ENU=Share;
                                                              DEA=Anteil];
                                                   MinValue=0 }
  }
  KEYS
  {
    {    ;Asset No.,Customer No.                  ;Clustered=Yes }
  }
  FIELDGROUPS
  {
  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Table 70025 CMMS Asset Component
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=11:53:42;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    DataCaptionFields=Component Type,Description;
    OnInsert=BEGIN
               CheckAssetInactive();
               "Component Type Integer" := "Component Type";
             END;

    OnModify=BEGIN
               CheckAssetInactive();
             END;

    OnDelete=BEGIN
               CheckAssetInactive();
             END;

    OnRename=BEGIN
               CheckAssetInactive();
             END;

  }
  FIELDS
  {
    { 10  ;   ;Objecttype          ;Option        ;CaptionML=[ENU=Objecttype;
                                                              DEA=Objekttyp];
                                                   OptionString=Asset }
    { 20  ;   ;Type                ;Option        ;CaptionML=ENU=Type;
                                                   OptionString=Equipment,Spare Part }
    { 30  ;   ;Component Type      ;Option        ;OnValidate=BEGIN
                                                                "Component Type Integer" := "Component Type";
                                                              END;

                                                   CaptionML=ENU=Component Type;
                                                   OptionString=Modules,Inverter,Combiner Box,Sensor,Monitoring Hardware,Internet Connection HW,Security System,Meters,Transformer,Switchgear,Cables,Remote Access Details,,,,,,,Others }
    { 40  ;   ;Key1                ;Code20        ;CaptionML=ENU=Key1 }
    { 50  ;   ;Entry No.           ;Integer       ;CaptionML=ENU=Entry No. }
    { 60  ;   ;Line Type           ;Option        ;CaptionML=[ENU=Line Type;
                                                              DEA=Zeilenart];
                                                   OptionCaptionML=[ENU=Header,Line;
                                                                    DEA=Kopf,Zeile];
                                                   OptionString=Header,Line }
    { 200 ;   ;Replaced with Entry No.;Integer    ;CaptionML=[ENU=Replaced with Entry No.;
                                                              DEA=Ausgetauscht durch Eintragnr.] }
    { 900 ;   ;Asset Tag           ;Text50        ;CaptionML=ENU=Asset Tag }
    { 1000;   ;Item No.            ;Code20        ;TableRelation=Item;
                                                   CaptionML=[ENU=Item No.;
                                                              DEA=Artikelnr.] }
    { 1100;   ;Description         ;Text50        ;CaptionML=[ENU=Description;
                                                              DEA=Beschreibung] }
    { 1110;   ;Description 2       ;Text50        ;CaptionML=[ENU=Description 2;
                                                              DEA=Beschreibung 2] }
    { 1201;   ;Manufacturer        ;Code50        ;TableRelation="CMMS Additional Data".Key2 WHERE (Type=CONST(Manufacturer),
                                                                                                    Line No.=FIELD(Component Type Integer),
                                                                                                    Component Type=FIELD(Component Type));
                                                   CaptionML=ENU=Manufacturer, Brand, Make }
    { 1211;   ;Model               ;Code50        ;TableRelation="CMMS Additional Data".Key3 WHERE (Type=CONST(Model),
                                                                                                    Key2=FIELD(Manufacturer),
                                                                                                    Line No.=FIELD(Component Type Integer));
                                                   CaptionML=ENU=Model, Type }
    { 1220;   ;Warranty End Date   ;Date          ;CaptionML=ENU=Warranty End Date }
    { 1230;   ;Serial Number       ;Text50        ;CaptionML=ENU=Serial Number }
    { 1500;   ;Location on Site    ;Text50        ;CaptionML=ENU=Location on Site }
    { 1600;   ;Quantity            ;Decimal       ;CaptionML=ENU=Quantity;
                                                   BlankZero=Yes }
    { 1700;   ;IP-Address          ;Text80        ;CaptionML=ENU=IP-Address }
    { 1710;   ;Type of Equipment   ;Code10        ;OnValidate=BEGIN
                                                                CMCodeData.ValidateCodeData(Rec.RECORDID.TABLENO,FIELDNO("Type of Equipment"),Objecttype,"Type of Equipment");
                                                              END;

                                                   OnLookup=BEGIN
                                                              CMCodeData.LookupCodeData(Rec.RECORDID.TABLENO,FIELDNO("Type of Equipment"),Objecttype,"Type of Equipment");
                                                            END;

                                                   CaptionML=ENU=Type of Equipment }
    { 1720;   ;Type of Equipment (Details);Text80  }
    { 1900;   ;Data Source ID      ;Text50        ;CaptionML=[ENU=Data Source ID;
                                                              DEA=Datenherkunfts-ID] }
    { 2000;   ;MODULES             ;Boolean        }
    { 2010;   ;Nominal DC Capacity ;Decimal       ;CaptionML=ENU=Nominal DC Capacity [kWp];
                                                   BlankZero=Yes }
    { 2020;   ;Azimut              ;Decimal       ;CaptionML=[ENU=Azimut;
                                                              DEA=Azimut] }
    { 2030;   ;Tilt                ;Decimal       ;CaptionML=[ENU=Tilt;
                                                              DEA=Tilt] }
    { 3000;   ;INVERTER            ;Boolean        }
    { 3010;   ;AC Capacity         ;Decimal       ;CaptionML=ENU=AC Capacity [kW];
                                                   BlankZero=Yes }
    { 4000;   ;COMBINER BOX        ;Boolean        }
    { 5000;   ;SENSOR              ;Boolean        }
    { 6000;   ;MONITORING HARDWARE ;Boolean        }
    { 7000;   ;INTERNET CONNECTION HW;Boolean      }
    { 8000;   ;SECURITY SYSTEM     ;Boolean        }
    { 9000;   ;METERS              ;Boolean        }
    { 10000;  ;TRANSFORMERS        ;Boolean        }
    { 11000;  ;SWITCHGEAR          ;Boolean        }
    { 12000;  ;CABLES              ;Boolean        }
    { 13000;  ;REMOTE ACCESS DETAILS;Boolean       }
    { 13010;  ;IP Address Local    ;Text80        ;CaptionML=ENU=IP Address Local }
    { 13020;  ;IP Address Remote/VPN;Text80       ;CaptionML=ENU=IP Address Remote/VPN }
    { 13030;  ;Username            ;Text50        ;CaptionML=ENU=Username }
    { 13040;  ;Password            ;Text50        ;CaptionML=ENU=Password }
    { 20000;  ;OTHERS              ;Boolean        }
    { 20010;  ;Detail 1            ;Text50        ;CaptionML=[ENU=Detail 1;
                                                              DEA=Detail 1] }
    { 20020;  ;Detail 2            ;Text50        ;CaptionML=[ENU=Detail 2;
                                                              DEA=Detail 2] }
    { 20030;  ;Detail 3            ;Text50        ;CaptionML=[ENU=Detail 3;
                                                              DEA=Detail 3] }
    { 50000;  ;Component Type Integer;Integer      }
  }
  KEYS
  {
    {    ;Objecttype,Type,Component Type,Key1,Entry No.;
                                                   Clustered=Yes }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;Serial Number,Description,Quantity,Description 2,Asset Tag }
  }
  CODE
  {
    VAR
      CMCodeData@1000000000 : Record 70006;
      Text001@1000000002 : TextConst 'ENU=The associated %1 %2 is inactive!;DEA=Das zugeh”rige Asset %1 %2 ist inaktiv!';

    LOCAL PROCEDURE CheckAssetInactive@1000000028();
    VAR
      CMObject@1000000000 : Record 70020;
    BEGIN
      IF CMObject.GET(Rec.Objecttype, Rec.Key1) THEN BEGIN
        IF CMObject."Operational Status" = CMObject."Operational Status"::Inactive THEN
          ERROR(STRSUBSTNO(Text001, CMObject.Objecttype, CMObject."No."));
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 70050 CMMS Contract
{
  OBJECT-PROPERTIES
  {
    Date=15.05.18;
    Time=14:23:24;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnInsert=BEGIN
               CMGenMgt.GetContractNo(Rec);
               CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::Created, Rec."No.", STRSUBSTNO(Text002, Rec."No."));
             END;

    CaptionML=ENU=CMMS Contract;
    LookupPageID=Page70024;
  }
  FIELDS
  {
    { 10  ;   ;No.                 ;Code20        ;CaptionML=[ENU=No.;
                                                              DEA=Nr.] }
    { 20  ;   ;Name                ;Text80        ;CaptionML=[ENU=Name;
                                                              DEA=Name] }
    { 30  ;   ;Template            ;Boolean       ;OnValidate=VAR
                                                                AssetContract@1000000000 : Record 70021;
                                                              BEGIN
                                                                CMGenMgt.ValidateTemplate(Rec);
                                                              END;
                                                               }
    { 40  ;   ;No. of linked Assets;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Objecttype=CONST(Asset),
                                                                                                   Type=CONST(Contract),
                                                                                                   Key2=FIELD(No.)));
                                                   CaptionML=ENU=No. of linked Assets;
                                                   Description=FF;
                                                   Editable=No }
    { 100 ;   ;Status              ;Option        ;OnValidate=BEGIN
                                                                CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::"Status Change", FORMAT(Rec.Status), STRSUBSTNO(Text003, xRec.Status, Rec.Status));
                                                              END;

                                                   CaptionML=[ENU=Status;
                                                              DEA=Status];
                                                   OptionString=New,Released,Inactive }
    { 110 ;   ;Comment             ;Text250       ;Description=#delete }
    { 210 ;   ;Type of Service     ;Option        ;OnValidate=BEGIN
                                                                CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::Modified, FIELDCAPTION("Type of Service"), STRSUBSTNO(Text003, xRec."Type of Service", Rec."Type of Service"));
                                                              END;

                                                   CaptionML=[ENU=Type of Service;
                                                              DEA=Serviceart];
                                                   OptionCaptionML=[ENU=" ,Full O&M,TAM,Monitoring,Portal Only,Individual,Support";
                                                                    DEA=" ,Full O&M,TAM,Monitoring,Portal Only,Individual,Support"];
                                                   OptionString=[ ,Full O&M,TAM,Monitoring,Portal Only,Individual,Support] }
    { 220 ;   ;Start Date          ;Date          ;OnValidate=BEGIN
                                                                IF (Rec."Start Date" <> 0D) AND
                                                                   (Rec."End Date" <> 0D) AND
                                                                   (Rec."Start Date" >= "End Date") THEN
                                                                  ERROR(Text004, Rec.FIELDCAPTION("Start Date"), Rec.FIELDCAPTION("End Date"));
                                                              END;

                                                   Description=Forecast }
    { 230 ;   ;End Date            ;Date          ;OnValidate=BEGIN
                                                                IF (Rec."Start Date" <> 0D) AND
                                                                   (Rec."End Date" <> 0D) AND
                                                                   (Rec."Start Date" >= "End Date") THEN
                                                                  ERROR(Text004, Rec.FIELDCAPTION("Start Date"), Rec.FIELDCAPTION("End Date"));
                                                              END;

                                                   Description=Forecast }
    { 240 ;   ;Contract Manager    ;Code50        ;TableRelation="User Setup"."User ID" }
    { 300 ;   ;Energy Monitor Access;Boolean       }
    { 305 ;   ;Energy Monitor Accounts;Text150    ;Description=#delete }
    { 310 ;   ;PVPlus Integration  ;Boolean       ;Description=#delete }
    { 325 ;   ;Accounting Entity   ;Text30        ;TableRelation=Company }
    { 400 ;   ;Responsible Sales User;Code50      ;TableRelation="User Setup"."User ID" }
    { 500 ;   ;Service Included    ;Text250       ;Description=#delete;
                                                   Editable=No }
    { 510 ;   ;Practical Customer Agreements;Text250;
                                                   Description=NEW2;
                                                   Editable=No }
    { 600 ;   ;Min. Reaction Time  ;Decimal       ;CaptionML=ENU=Min. Reaction Time [h] }
    { 601 ;   ;Reaction Time Details;Text250      ;Description=NEW2 }
    { 610 ;   ;Weekend Reaction    ;Boolean        }
    { 700 ;   ;Reporting Interval  ;Option        ;OptionString=[ ,Single Weekly,Single monthly,Single quarterly,Single Yearly,Portfolio Weekly,Portfolio Monthly,Portfolio Quarterly,Portfolio Yearly] }
    { 710 ;   ;Reporting Requirements;Text160     ;Description=#delete }
    { 720 ;   ;Reporting Format    ;Code20        ;TableRelation="CMMS Code Data".Code WHERE (TableID=CONST(70050),
                                                                                              FieldID=CONST(720),
                                                                                              Type=CONST(0)) }
    { 800 ;   ;Additional Services ;Text250       ;Description=#delete;
                                                   Editable=No }
    { 900 ;   ;Penalty Payments    ;Boolean        }
    { 910 ;   ;Penalty Payment Details;Text250    ;Description=#delete }
    { 920 ;   ;Penalty Risk Class  ;Code20        ;TableRelation="CMMS Code Data".Code WHERE (TableID=CONST(70050),
                                                                                              FieldID=CONST(920),
                                                                                              Type=CONST(0));
                                                   Description=NEW }
    { 1000;   ;Bonusagreement      ;Boolean        }
    { 1010;   ;Bonus Terms         ;Text250       ;Description=#delete }
    { 1020;   ;Extension Type      ;Code20        ;TableRelation="CMMS Code Data".Code WHERE (TableID=CONST(70050),
                                                                                              FieldID=CONST(1020),
                                                                                              Type=CONST(0));
                                                   Description=NEW }
    { 1100;   ;Invoice Receiver    ;Option        ;OptionString=[ ,SPV,Company Chain,Other];
                                                   Description=#delete }
    { 1200;   ;Currency Code       ;Code10        ;TableRelation=Currency.Code }
    { 1300;   ;Annual Fee          ;Decimal       ;OnValidate=BEGIN
                                                                CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::Modified, FIELDCAPTION(Rec."Annual Fee"), STRSUBSTNO(Text003, xRec."Annual Fee", Rec."Annual Fee"));
                                                              END;

                                                   Description=#delete }
    { 1310;   ;Annual Fee incl. Adaption;Decimal  ;OnValidate=BEGIN
                                                                CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::Modified, FIELDCAPTION(Rec."Annual Fee incl. Adaption"), STRSUBSTNO(Text003, xRec."Annual Fee incl. Adaption", Rec."Annual Fee incl. Adaption"));
                                                              END;

                                                   Description=#delete }
    { 1400;   ;Payment Terms Code  ;Code20        ;TableRelation="Payment Terms".Code }
    { 1410;   ;Other Info          ;Text250       ;Description=#delete }
    { 1420;   ;Cancellation External (Months);Integer }
    { 1430;   ;Indexation          ;Boolean        }
    { 1431;   ;Indexation Details  ;Text250       ;Description=#delete }
    { 1432;   ;Indexation Rate     ;Decimal        }
    { 1440;   ;Indexation Start Date;Date          }
    { 1450;   ;Indexation Cycle    ;Option        ;OptionString=[ ,Yearly,Other] }
    { 1500;   ;Extension Options   ;Text250       ;Description=NEW2;
                                                   Editable=No }
    { 2000;   ;Invoicing Period    ;Option        ;CaptionML=[ENU=Invoicing Period;
                                                              DEA=Verrechnungsperiode];
                                                   OptionString=Month,Quarter,Half Year,Year;
                                                   Description=Forecast }
    { 2010;   ;Invoicing Type      ;Option        ;CaptionML=[ENU=Invoicing Type;
                                                              DEA=Verrechnungsart];
                                                   OptionString=Pre,Post;
                                                   Description=Forecast }
    { 10000;  ;Import Site Nos.    ;BLOB           }
    { 20620;  ;Activities          ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (CM Is CMMS Log Entry=CONST(Yes),
                                                                                                    CM Source No.=FIELD(No.)));
                                                   CaptionML=[ENU=Activities;
                                                              DEA=Aktivit„ten];
                                                   Description=FF;
                                                   Editable=No }
    { 20660;  ;Relations           ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Type=CONST(Relation),
                                                                                                   Key1=FIELD(No.)));
                                                   CaptionML=[ENU=Relations;
                                                              DEA=Verbindungen];
                                                   Description=FF;
                                                   Editable=No }
    { 20670;  ;Contract Entities   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("CMMS Additional Data" WHERE (Objecttype=CONST(Asset),
                                                                                                   Type=CONST(Contract),
                                                                                                   Key2=FIELD(No.)));
                                                   CaptionML=ENU=Contract Entities;
                                                   Description=FF;
                                                   Editable=No }
    { 70000;  ;CM Is Temporary     ;Boolean       ;CaptionML=[ENU=Is Temporary;
                                                              DEA=Ist Tempor„r] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Template                                 }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Name                                 }
  }
  CODE
  {
    VAR
      CMGenMgt@1000000000 : Codeunit 70000;
      Text001@1000000001 : TextConst 'ENU=This Contract is linked to an Asset an can therefore no be set as Template!;DEA=Dieser Vertrag ist einer Anlage zugewiesen und kann nicht als Vorlage definiert werden!';
      LogEntry@1000000002 : Record 5065;
      Text002@1000000003 : TextConst 'ENU=Contract "%1" created.';
      Text003@1000000004 : TextConst 'ENU=From "%1" to "%2"';
      Text004@1000000005 : TextConst 'ENU=" ""%1"" has to be before ""%2"".";DEA=" ""%1"" muss vor ""%2"" liegen."';

    BEGIN
    END.
  }
}

OBJECT Report 70000 CMMS Create Recuring Tasks
{
  OBJECT-PROPERTIES
  {
    Date=22.03.17;
    Time=11:54:34;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=CMMS - Create Recuring Tasks;
               DEA=CMMS - Erstelle wiederkehrende Aufgaben];
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   MESSAGE
                   (
                     FORMAT(c1) + ' Workorder(s) created.\' +
                     FORMAT(c2) + ' Task(s) created.\' +
                     FORMAT(c3) + ' Task(s) automatically closed.\'
                   );
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;RecuringTask      ;
               DataItemTable=Table70021;
               OnPreDataItem=BEGIN
                               IF NOT CMGenSetup.GET() THEN
                                 CMGenSetup.INIT;

                               c1 := 0;
                               c2 := 0;
                               c3 := 0;

                               RecuringTask.RESET;
                               RecuringTask.SETCURRENTKEY(Objecttype,Type,Key1,Inactive,"Start Date","Due Date","Interaction Group Code");
                               RecuringTask.SETRANGE(Objecttype, RecuringTask.Objecttype::Asset);
                               RecuringTask.SETRANGE(Type, RecuringTask.Type::RecurringToDo);
                               RecuringTask.SETRANGE(Subtype, RecuringTask.Subtype::" ");
                               RecuringTask.SETFILTER(Key1, '<>%1', '');
                               RecuringTask.SETRANGE(Inactive, FALSE);
                               RecuringTask.SETFILTER("Start Date", '<=%1', WORKDATE);

                               LastDueDate := 0D;
                               LastStartDate := 0D;
                               LastInteractionGroupCode := '';
                               counter1 := 1;

                               TempTask.RESET;
                               TempTask.DELETEALL;
                               TempWo.RESET;
                               TempWo.DELETEALL;

                               Workorder.SETCURRENTKEY("CM Is Workorder","CM Objecttype","CM Object No.","CM Source","CM Source Description","Creation Date");
                               Task.SETCURRENTKEY("CM Type","CM Objecttype","CM Object No.","CM Source","CM Source No.");
                             END;

               OnAfterGetRecord=BEGIN
                                  IF (RecuringTask."Expiration Date" < WORKDATE) AND (RecuringTask."Expiration Date" <> 0D) THEN BEGIN
                                    RecuringTask.Inactive := TRUE;
                                    RecuringTask.MODIFY(FALSE);
                                    CurrReport.SKIP();
                                  END;

                                  //New WO
                                  IF ((LastDueDate <> RecuringTask."Due Date") AND (LastStartDate <> RecuringTask."Start Date")) OR (LastObjNo <> RecuringTask.Key1)THEN BEGIN
                                   TempWo.INIT;
                                   TempWo."No." := '#$NEW-WO$#' + FORMAT(counter1);
                                   TempWo.Description := CMGenSetup."Recurring Workorder Name";
                                   TempWo."CM Is Workorder" := TRUE;
                                   TempWo."CM Is Temporary" := TRUE;
                                   TempWo."CM Source" := Workorder."CM Source"::Recuring;
                                   TempWo."CM Source Description" := FORMAT(WORKDATE) + ', ' + FORMAT(TIME);
                                   TempWo."CM Objecttype" := TempWo."CM Objecttype"::Asset;
                                   TempWo."CM Object No." := RecuringTask.Key1;
                                   TempWo."CM Due Date" := RecuringTask."Due Date";
                                   TempWo.INSERT(FALSE);
                                  END;

                                  //Check last Task
                                  Task.SETCURRENTKEY("CM Type","CM Objecttype","CM Object No.","CM Source","CM Source No.",Date);
                                  Task.SETRANGE("CM Type", Task."CM Type"::Task);
                                  Task.SETRANGE("CM Objecttype", Task."CM Objecttype");
                                  Task.SETRANGE("CM Object No.", RecuringTask.Key1);
                                  Task.SETRANGE("CM Source", Task."CM Source"::Recuring);
                                  Task.SETRANGE("CM Source No.", RecuringTask."Line No.");
                                  IF Task.FINDLAST() THEN BEGIN
                                    IF CALCDATE(RecuringTask."Recurring Date Interval", Task.Date) <= WORKDATE THEN BEGIN
                                      AddTempTask();
                                    END;
                                  END
                                  ELSE BEGIN
                                    Task.INIT;
                                    Task."No." := '';
                                    AddTempTask();
                                  END;

                                  LastDueDate := RecuringTask."Due Date";
                                  LastStartDate := RecuringTask."Start Date";
                                  LastInteractionGroupCode := RecuringTask."Interaction Group Code";
                                  LastObjNo := RecuringTask.Key1;
                                  counter1 += 1;
                                END;
                                 }

    { 1000000001;0;DataItem;TempWo           ;
               DataItemTable=Table5092;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               TempWo.RESET;
                               TempTask.RESET;
                               TempTask.SETCURRENTKEY("Opportunity No.","CM Type","CM Assigned User ID","CM Status");
                             END;

               OnAfterGetRecord=VAR
                                  LogEntry@1000000000 : Record 5065;
                                BEGIN
                                  TempTask.SETRANGE("Opportunity No.", TempWo."No.");
                                  IF NOT TempTask.FIND('-') THEN
                                    CurrReport.SKIP();

                                  //### Create Workorder ###:
                                  Workorder.RESET;
                                  Workorder.INIT;
                                  Workorder.TRANSFERFIELDS(TempWo,FALSE);
                                  Workorder."CM Is Temporary" := FALSE;
                                  Workorder."No." := '';
                                  Workorder.INSERT(TRUE);
                                  c1 += 1;

                                  REPEAT //### Create Task ###
                                    //Close existing Task
                                    IF (Task.GET(TempTask."No.")) AND (Task."CM Status" = Task."CM Status"::Open) THEN BEGIN
                                      Task."CM Status" := Task."CM Status"::Closed;
                                      Task.MODIFY(FALSE);
                                      c3 += 1;

                                      LogEntry.GET(CMGenMgt.CreateLogEntry(Task,LogEntry."CM Log Type"::"Status Change",FORMAT(Task."CM Status"), Text001));
                                      LogEntry."User ID" := CMGenSetup."System User ID";
                                      LogEntry."Salesperson Code" := CMGenSetup."System Salesperson";
                                      LogEntry."Contact No." := CMGenSetup."System Contact";
                                      LogEntry.MODIFY(FALSE);
                                    END;

                                    Task.INIT;
                                    Task.TRANSFERFIELDS(TempTask);
                                    Task."Opportunity No." := Workorder."No.";
                                    Task."No." := '';
                                    Task."CM Status" := 0;
                                    Task.INSERT(TRUE);
                                    c2 += 1;

                                    InsertSubTasks();

                                  UNTIL TempTask.NEXT = 0;
                                END;

               Temporary=Yes }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      TempTask@1000000005 : TEMPORARY Record 5080;
      LastDueDate@1000000001 : Date;
      LastStartDate@1000000007 : Date;
      LastInteractionGroupCode@1000000000 : Code[20];
      LastObjNo@1000000008 : Code[20];
      Workorder@1000000002 : Record 5092;
      Task@1000000006 : Record 5080;
      counter1@1000000003 : Integer;
      counter2@1000000012 : Integer;
      counter3@1000000013 : Integer;
      CMWoMgt@1000000004 : Codeunit 70030;
      CMTaskMgt@1000000009 : Codeunit 70031;
      CMGenMgt@1000000010 : Codeunit 70000;
      CMGenSetup@1000000011 : Record 70000;
      LogEntry@1000000014 : Record 5065;
      Text001@1000000015 : TextConst 'ENU=Task was automatically closed, and recreated by the system (recurring Task).';
      c1@1000000016 : Integer;
      c2@1000000017 : Integer;
      c3@1000000018 : Integer;

    LOCAL PROCEDURE AddTempTask@1000000000();
    VAR
      InteractionTemplate@1000000000 : Record 5064;
    BEGIN
      TempTask.RESET;
      TempTask.INIT;
      TempTask.TRANSFERFIELDS(Task);
      TempTask."CM Status" := TempTask."CM Status"::Open;
      IF TempTask."No." = '' THEN
        TempTask."No." := '#$NEW-TASK$#' + FORMAT(counter1);

      IF InteractionTemplate.GET(RecuringTask."Interaction Template Code") THEN BEGIN
        TempTask."CM Wizard Action" := InteractionTemplate."Wizard Action";
        TempTask."CM Information Type" := InteractionTemplate."IG Information Type";
      END;

      TempTask."CM Type" := TempTask."CM Type"::Task;
      TempTask."CM Subtype" := TempTask."CM Subtype"::" ";
      TempTask."CM Assigned User ID" := '';
      TempTask.Date := WORKDATE;
      TempTask."Opportunity No." := TempWo."No.";

      TempTask."CM Source" := TempTask."CM Source"::Recuring;
      TempTask."CM Source No." := RecuringTask."Line No.";
      TempTask."CM Scheduled Date" := RecuringTask."Due Date";
      TempTask.Description := RecuringTask.Description;
      TempTask."CM Interaction Group Code" := RecuringTask."Interaction Group Code";
      TempTask."CM Interaction Template Code" := RecuringTask."Interaction Template Code";

      TempTask.INSERT(FALSE);
    END;

    LOCAL PROCEDURE InsertSubTasks@1000000005();
    VAR
      RecSubTask@1000000000 : Record 70021;
      SubTask@1000000001 : Record 5080;
    BEGIN
      RecSubTask.RESET;
      RecSubTask.SETRANGE(Objecttype, RecSubTask.Objecttype::Asset);
      RecSubTask.SETRANGE(Type, RecSubTask.Type::RecurringToDo);
      RecSubTask.SETRANGE(Key1, Task."CM Object No.");
      RecSubTask.SETRANGE(Subtype, RecSubTask.Subtype::Checklist);
      RecSubTask.SETRANGE("Maintask Line No.", Task."CM Source No.");
      IF RecSubTask.FIND('-') THEN BEGIN
        REPEAT
          SubTask.INIT;
          SubTask."No." := '';
          SubTask."CM Maintask No." := Task."No.";
          SubTask."CM Subtype" := RecSubTask.Subtype;
          SubTask.Description := RecSubTask.Description;
          SubTask."CM Type" := SubTask."CM Type"::Task;
          SubTask."CM Source" := SubTask."CM Source"::Recuring;
          SubTask."CM Source No." := Task."CM Source No.";
          SubTask.INSERT(TRUE);
        UNTIL RecSubTask.NEXT = 0;
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 70001 CMMS Site Visiting Report
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=13:18:33;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnInitReport=BEGIN
                   ScaleImageSizeMinWidth := 400; //px
                 END;

    PDFFontEmbedding=Yes;
  }
  DATASET
  {
    { 1000000069;;DataItem;HEAD              ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=CONST(1)) }

    { 1000000070;1;Column;HEAD_Date          ;
               SourceExpr=TODAY }

    { 1000000071;1;Column;HEAD_UserID        ;
               SourceExpr=USERID }

    { 1000000000;1;DataItem;WO               ;
               DataItemTable=Table5092;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               //Workorder
                               Num1 := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  Num1 += 1;

                                  IF WO."CM Object No." = '' THEN
                                    ERROR(Text002, WO."No.");

                                  //Load Customer
                                  CMAddData.RESET;
                                  CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::Asset);
                                  CMAddData.SETRANGE(Type, CMAddData.Type::Customer);
                                  CMAddData.SETRANGE(Key1, WO."CM Object No.");
                                  IF NOT CMAddData.FINDFIRST() THEN
                                    CMAddData.INIT;
                                    //ERROR(Text001, WO."CM Object No.", WO."No.");

                                  WO.CALCFIELDS("CM Assigned User Name");
                                END;

               ReqFilterFields=No. }

    { 1000000007;2;Column;WO_                ;
               SourceExpr=TRUE }

    { 1000000081;2;Column;WO_Number          ;
               SourceExpr=Num1 }

    { 1000000008;2;Column;WO_No              ;
               SourceExpr=WO."No." }

    { 1000000009;2;Column;WO_Description     ;
               SourceExpr=WO.Description }

    { 1000000074;2;Column;WO_Status          ;
               SourceExpr=WO."CM Status" }

    { 1000000072;2;Column;WO_AssignedUserID  ;
               SourceExpr=WO."CM Assigned User ID" }

    { 1000000073;2;Column;WO_AssignedUserName;
               SourceExpr=WO."CM Assigned User Name" }

    { 1000000097;2;Column;WO_AssignedUserNameUserID;
               SourceExpr=STRSUBSTNO('%1 (%2)', WO."CM Assigned User Name", WO."CM Assigned User ID") }

    { 1000000010;2;Column;WO_CreatedDatetime ;
               SourceExpr=WO."CM Created Datetime" }

    { 1000000013;2;Column;WO_ObjectNo        ;
               SourceExpr=WO."CM Object No." }

    { 1000000014;2;Column;WO_ObjectName      ;
               SourceExpr=WO."CM Object Name" }

    { 1000000067;2;Column;WO_CustomerName    ;
               SourceExpr=CMAddData."Customer Name" }

    { 1000000068;2;Column;WO_CustomerNo      ;
               SourceExpr=CMAddData.Key3 }

    { 1000000001;2;DataItem;WOC              ;
               DataItemTable=Table5065;
               DataItemTableView=SORTING(CM Is CMMS Log Entry,CM Source,CM Source No.,CM Log Type)
                                 WHERE(CM Source=CONST(Workorder),
                                       CM Log Type=CONST(Comment),
                                       CM Deleted=CONST(No),
                                       CM Internal=CONST(No));
               OnPreDataItem=BEGIN
                               //Workorder Comment
                               WOC.CALCFIELDS("CM User Name");
                               Num2 := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  Num2 += 1;
                                END;

               DataItemLink=CM Source No.=FIELD(No.) }

    { 1000000025;3;Column;WOC_               ;
               SourceExpr=TRUE }

    { 1000000080;3;Column;WOC_Number         ;
               SourceExpr=Num2 }

    { 1000000032;3;Column;WOC_EntryNo        ;
               SourceExpr=WOC."Entry No." }

    { 1000000011;3;Column;WOC_UserID         ;
               SourceExpr=WOC."User ID" }

    { 1000000016;3;Column;WOC_UserName       ;
               SourceExpr=WOC."CM User Name" }

    { 1000000012;3;Column;WOC_Comment        ;
               SourceExpr=WOC."CM Comment" }

    { 1000000015;3;Column;WOC_CreatedDatetime;
               SourceExpr=WOC."CM Created Datetime" }

    { 1000000096;3;Column;WOC_UserNameUserID ;
               SourceExpr=STRSUBSTNO('%1 (%2)', WOC."CM User Name", WOC."User ID") }

    { 1000000002;2;DataItem;T                ;
               DataItemTable=Table5080;
               DataItemTableView=SORTING(CM Type,CM Subtype,Opportunity No.,No.)
                                 WHERE(CM Type=CONST(Task),
                                       CM Subtype=CONST(" "));
               OnPreDataItem=BEGIN
                               //Task
                               Num2 := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  Num2 += 1;
                                END;

               DataItemLink=Opportunity No.=FIELD(No.) }

    { 1000000024;3;Column;T_                 ;
               SourceExpr=TRUE }

    { 1000000079;3;Column;T_Number           ;
               SourceExpr=Num2 }

    { 1000000017;3;Column;T_No               ;
               SourceExpr=T."No." }

    { 1000000018;3;Column;T_Description      ;
               SourceExpr=T.Description }

    { 1000000023;3;Column;T_ExtendedDescription;
               SourceExpr=T."CM Extended Description" }

    { 1000000020;3;Column;T_Status           ;
               SourceExpr=T."CM Status" }

    { 1000000021;3;Column;T_AssignedUserID   ;
               SourceExpr=T."CM Assigned User ID" }

    { 1000000022;3;Column;T_AssignedUserName ;
               SourceExpr=T."CM Assigned User Name" }

    { 1000000019;3;Column;T_CreatedDatetime  ;
               SourceExpr=T."CM Created Datetime" }

    { 1000000085;3;Column;T_UserNameUserID   ;
               SourceExpr=STRSUBSTNO('%1 (%2)', T."CM Assigned User Name", T."CM Assigned User ID") }

    { 1000000006;3;DataItem;TP               ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               OnPreDataItem=VAR
                               c@1000000000 : Integer;
                               PicturesPerRow@1000000001 : Integer;
                             BEGIN
                               //Task Picture
                               Num3 := 0;
                               PicturesPerRow := 2;
                               TP1.RESET;
                               TP1.DELETEALL;
                               TP2.RESET;
                               TP2.DELETEALL;

                               TaskPicture.RESET();
                               TaskPicture.CLEARMARKS();
                               TaskPicture.SETCURRENTKEY("CM Is CMMS Log Entry","CM Source","CM Source No.","CM Log Type");
                               TaskPicture.SETRANGE("CM Is CMMS Log Entry", TRUE);
                               TaskPicture.SETRANGE("CM Source", TaskPicture."CM Source"::Task);
                               TaskPicture.SETRANGE("CM Source No.", T."No.");
                               TaskPicture.SETFILTER("CM Log Type", '%1|%2', TaskPicture."CM Log Type"::Picture, TaskPicture."CM Log Type"::Attachment);
                               TaskPicture.SETRANGE("CM Deleted", FALSE);
                               TaskPicture.SETRANGE("CM Internal", FALSE);
                               IF TaskPicture.FIND('-') THEN BEGIN
                                 REPEAT
                                   IF (TaskPicture."CM Log Type" = TaskPicture."CM Log Type"::Attachment) AND
                                      (NOT TextEndsWithImage(TaskPicture."CM Comment")) THEN BEGIN
                                     TaskPicture.MARK(FALSE)
                                   END
                                   ELSE BEGIN
                                     TaskPicture.MARK(TRUE);
                                     c += 1;
                                   END;
                                 UNTIL TaskPicture.NEXT = 0;
                               END;
                               TaskPicture.MARKEDONLY(TRUE);

                               IF c MOD PicturesPerRow = 0 THEN
                                 c := c DIV PicturesPerRow
                               ELSE
                                 c := (c DIV PicturesPerRow) + 1;

                               IF c = 0 THEN
                                 CurrReport.BREAK;

                               TaskPicture.FIND('-');
                               TP.SETFILTER(Number, '1..%1', c);
                             END;

               OnAfterGetRecord=VAR
                                  HasNext@1000000000 : Boolean;
                                BEGIN
                                  Num3 += 1;

                                  TP1.INIT;
                                  TP1."Entry No." := Num3;
                                  TP1.Text1 := TaskPicture.Description;
                                  CopyAttachment(TP1, TaskPicture."Attachment No.");
                                  HasNext := TaskPicture.NEXT() <> 0;
                                  TP1.OK1 := HasNext;
                                  TP1.INSERT(FALSE);

                                  TP2.INIT;
                                  IF HasNext THEN BEGIN
                                    TP2."Entry No." := Num3;
                                    TP2.Text1 := TaskPicture.Description;
                                    CopyAttachment(TP2, TaskPicture."Attachment No.");
                                    HasNext := TaskPicture.NEXT() <> 0;
                                    TP2.OK1 := HasNext;
                                    TP2.INSERT(FALSE);
                                  END;
                                END;
                                 }

    { 1000000033;4;Column;TP_                ;
               SourceExpr=TRUE }

    { 1000000027;4;Column;TP_Number          ;
               SourceExpr=Num3 }

    { 1000000031;4;Column;TP_Show1           ;
               SourceExpr=TP1.OK1 }

    { 1000000029;4;Column;TP_Comment1        ;
               SourceExpr=TP1.Text1 }

    { 1000000030;4;Column;TP_Picture1        ;
               SourceExpr=TP1.blob1 }

    { 1000000091;4;Column;TP_Show2           ;
               SourceExpr=TP2.OK1 }

    { 1000000090;4;Column;TP_Comment2        ;
               SourceExpr=TP2.Text1 }

    { 1000000089;4;Column;TP_Picture2        ;
               SourceExpr=TP2.blob1 }

    { 1000000092;3;DataItem;THS              ;
               DataItemTable=Table5065;
               DataItemTableView=SORTING(CM Is CMMS Log Entry,CM Source,CM Source No.,CM Log Type)
                                 WHERE(CM Source=CONST(Task),
                                       CM Log Type=CONST(Attachment),
                                       CM Deleted=CONST(No),
                                       CM Internal=CONST(No),
                                       CM Health And Safety Document=CONST(Yes));
               OnPreDataItem=BEGIN
                               //Task Health and Safety
                             END;

               OnAfterGetRecord=VAR
                                  DotNetGhostscriptRasterizer@1000000000 : DotNet "'Ghostscript.NET, Version=1.2.1.0, Culture=neutral, PublicKeyToken=f85051de34525b59'.Ghostscript.NET.Rasterizer.GhostscriptRasterizer" SUPPRESSDISPOSE;
                                  DotNetImage@1000000001 : DotNet "'System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.System.Drawing.Image" SUPPRESSDISPOSE;
                                  DotNetImageFormat@1000000006 : DotNet "'System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.System.Drawing.Imaging.ImageFormat" SUPPRESSDISPOSE;
                                  OutStream@1000000002 : OutStream;
                                  Attachment@1000000003 : Record 5062;
                                  FileMgt@1000000004 : Codeunit 419;
                                  TempPdfFile@1000000005 : Text;
                                BEGIN
                                  Attachment.GET(THS."Attachment No.");
                                  Attachment.CALCFIELDS(Attachment);
                                  TempPdfFile := FileMgt.ServerTempFileName('pdf');
                                  Attachment.Attachment.EXPORT(TempPdfFile);

                                  DotNetGhostscriptRasterizer := DotNetGhostscriptRasterizer.GhostscriptRasterizer();
                                  DotNetGhostscriptRasterizer.Open(TempPdfFile);
                                  DotNetImage := DotNetGhostscriptRasterizer.GetPage(100, 100, 1);
                                  DotNetGhostscriptRasterizer.Close();
                                  FileMgt.DeleteServerFile(TempPdfFile);

                                  TempBlob.INIT;
                                  CLEAR(TempBlob.Blob);
                                  TempBlob.Blob.CREATEOUTSTREAM(OutStream);
                                  DotNetImage.Save(OutStream, DotNetImageFormat.Png);
                                END;

               DataItemLink=CM Source No.=FIELD(No.) }

    { 1000000093;4;Column;THS_               ;
               SourceExpr=TRUE }

    { 1000000026;4;Column;THS_Number         ;
               SourceExpr=Num3 }

    { 1000000094;4;Column;THS_PDFImage       ;
               SourceExpr=TempBlob.Blob }

    { 1000000095;4;Column;THS_Description    ;
               SourceExpr=THS.Description }

    { 1000000003;3;DataItem;TC               ;
               DataItemTable=Table5065;
               DataItemTableView=SORTING(CM Is CMMS Log Entry,CM Source,CM Source No.,CM Log Type)
                                 WHERE(CM Source=CONST(Task),
                                       CM Log Type=CONST(Comment),
                                       CM Deleted=CONST(No),
                                       CM Internal=CONST(No));
               OnPreDataItem=BEGIN
                               //Task Comment
                               Num3 := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  Num3 += 1;
                                END;

               DataItemLink=CM Source No.=FIELD(No.) }

    { 1000000039;4;Column;TC_                ;
               SourceExpr=TRUE }

    { 1000000077;4;Column;TC_Number          ;
               SourceExpr=Num3 }

    { 1000000038;4;Column;TC_EntryNo         ;
               SourceExpr=TC."Entry No." }

    { 1000000037;4;Column;TC_UserID          ;
               SourceExpr=TC."User ID" }

    { 1000000036;4;Column;TC_UserName        ;
               SourceExpr=TC."CM User Name" }

    { 1000000035;4;Column;TC_Comment         ;
               SourceExpr=TC."CM Comment" }

    { 1000000028;4;Column;TC_CreatedDatetime ;
               SourceExpr=TC."CM Created Datetime" }

    { 1000000083;4;Column;TC_UserNameUserID  ;
               SourceExpr=STRSUBSTNO('%1 (%2)', TC."CM User Name", TC."User ID") }

    { 1000000004;3;DataItem;TCLI             ;
               DataItemTable=Table5080;
               DataItemTableView=SORTING(CM Type,CM Subtype,CM Maintask No.,No.)
                                 WHERE(CM Type=CONST(Task),
                                       CM Subtype=CONST(Checklist));
               OnPreDataItem=BEGIN
                               //Task Checklist Item
                               Num3 := 0;
                               TCLI."CM Checklist Status (Helper)" := TCLI."CM Status";
                             END;

               OnAfterGetRecord=BEGIN
                                  Num3 += 1;
                                END;

               DataItemLink=CM Maintask No.=FIELD(No.) }

    { 1000000043;4;Column;TCLI_              ;
               SourceExpr=TRUE }

    { 1000000076;4;Column;TCLI_Number        ;
               SourceExpr=Num3 }

    { 1000000040;4;Column;TCLI_No            ;
               SourceExpr=TCLI."No." }

    { 1000000041;4;Column;TCLI_Description   ;
               SourceExpr=TCLI.Description }

    { 1000000042;4;Column;TCLI_Status        ;
               SourceExpr=TCLI."CM Checklist Status (Helper)" }

    { 1000000005;3;DataItem;TT               ;
               DataItemTable=Table5080;
               DataItemTableView=SORTING(CM Type,CM Subtype,CM Maintask No.,No.)
                                 WHERE(CM Type=CONST(Task),
                                       CM Subtype=CONST(Team));
               OnPreDataItem=BEGIN
                               //Task Team
                               Num3 := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  Num3 += 1;
                                END;

               DataItemLink=CM Maintask No.=FIELD(No.) }

    { 1000000047;4;Column;TT_                ;
               SourceExpr=TRUE }

    { 1000000075;4;Column;TT_Number          ;
               SourceExpr=Num3 }

    { 1000000044;4;Column;TT_No              ;
               SourceExpr=TT."No." }

    { 1000000045;4;Column;TT_UserId          ;
               SourceExpr=TT."CM Assigned User ID" }

    { 1000000046;4;Column;TT_UserName        ;
               SourceExpr=TT."CM Assigned User Name" }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
    { 1000000054;SiteVisitionReport_CAP;
                                CaptionML=ENU=Site Visiting Report }
    { 1000000055;Date_CAP      ;CaptionML=ENU=Date }
    { 1000000053;Page_CAP      ;CaptionML=ENU=Page }
    { 1000000048;GeneralInformation_CAP;
                                CaptionML=ENU=General Information }
    { 1000000064;DetailedInformation_CAP;
                                CaptionML=ENU=Detailed Information }
    { 1000000049;WorkorderNo_CAP;
                                CaptionML=ENU=Workorder No. }
    { 1000000050;Description_CAP;
                                CaptionML=ENU=Description }
    { 1000000051;SiteNo_CAP    ;CaptionML=ENU=Site No. }
    { 1000000052;SiteName_CAP  ;CaptionML=ENU=Site Name }
    { 1000000056;Status_CAP    ;CaptionML=ENU=Status }
    { 1000000087;No_CAP        ;CaptionML=ENU=No. }
    { 1000000060;Workorder_CAP ;CaptionML=ENU=Workorder }
    { 1000000063;Comments_CAP  ;CaptionML=ENU=Comments }
    { 1000000057;Tasks_CAP     ;CaptionML=ENU=Tasks }
    { 1000000082;Task_CAP      ;CaptionML=ENU=Task }
    { 1000000062;ChecklistItems_CAP;
                                CaptionML=ENU=Checklist Items }
    { 1000000086;ChecklistItem_CAP;
                                CaptionML=ENU=Checklist Items }
    { 1000000058;Pictures_CAP  ;CaptionML=ENU=Pictures }
    { 1000000061;TaskHealthAndSafetyDocuments_CAP;
                                CaptionML=ENU=Health and Safety Documents }
    { 1000000059;HealthAndSafetyDocumentExists;
                                CaptionML=ENU=Health and Safety Documents have been added. }
    { 1000000065;ResponsiblePerson_CAP;
                                CaptionML=ENU=Responsible Person }
    { 1000000066;PlantManager_CAP;
                                CaptionML=ENU=Plant Manager }
    { 1000000084;EndOfDocument_CAP;
                                CaptionML=ENU=*** End of Document *** }
  }
  CODE
  {
    VAR
      Text001@1000000002 : TextConst 'ENU=Cannot find a Customer for Asset %1 (Workorder %2).';
      Text002@1000000003 : TextConst 'ENU=Workorder %1 is not linked to an Asset.';
      CMAddData@1000000000 : Record 70021;
      Num1@1000000004 : Integer;
      Num2@1000000005 : Integer;
      Num3@1000000006 : Integer;
      TaskPicture@1000000010 : Record 5065;
      TP1@1000000007 : TEMPORARY Record 50002;
      TP2@1000000008 : TEMPORARY Record 50002;
      TempBlob@1000000001 : TEMPORARY Record 99008535;
      ScaleImageSizeMinWidth@1000000012 : Integer;

    LOCAL PROCEDURE CopyAttachment@1000000002(VAR TempTP@1000000000 : TEMPORARY Record 50002;AttachmentNo@1000000001 : Integer);
    VAR
      Attachment@1000000002 : Record 5062;
      TempBlob@1000000003 : TEMPORARY Record 99008535;
    BEGIN
      IF Attachment.GET(AttachmentNo) THEN BEGIN
        Attachment.CALCFIELDS(Attachment);
        TempBlob.INIT;
        TempBlob.Blob := Attachment.Attachment;
        ScaleImage(TempBlob, ScaleImageSizeMinWidth);
        TempTP.blob1 := TempBlob.Blob;
      END;
    END;

    LOCAL PROCEDURE ScaleImage@1000000000(VAR TempBlob@1000000004 : TEMPORARY Record 99008535;ToWidth@1000000001 : Integer) : Boolean;
    VAR
      DotNetImage@1000000002 : DotNet "'System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.System.Drawing.Image" SUPPRESSDISPOSE;
      DotNetBitmap@1000000000 : DotNet "'System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.System.Drawing.Bitmap" SUPPRESSDISPOSE;
      DotNetImageFormat@1000000007 : DotNet "'System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.System.Drawing.Imaging.ImageFormat" SUPPRESSDISPOSE;
      ToHeight@1000000003 : Integer;
      InStr@1000000005 : InStream;
      OutStr@1000000006 : OutStream;
    BEGIN
      IF ToWidth <= 0 THEN
        EXIT(FALSE);

      //Read
      TempBlob.Blob.CREATEINSTREAM(InStr);
      DotNetImage := DotNetImage.FromStream(InStr);
      IF ToWidth >= DotNetImage.Width THEN
        EXIT(FALSE);

      //Resize
      ToHeight := ROUND((DotNetImage.Height * (ToWidth / DotNetImage.Width)), 1 , '=');
      DotNetImage := DotNetBitmap.Bitmap(DotNetImage, ToWidth, ToHeight);

      //Write
      TempBlob.Blob.CREATEOUTSTREAM(OutStr);
      DotNetImage.Save(OutStr, DotNetImageFormat.Png);

      EXIT(TRUE);
    END;

    PROCEDURE TextEndsWith@1000000005(Input@1000000000 : Text;EndsWith@1000000001 : Text) : Boolean;
    VAR
      DotNetString@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.String" SUPPRESSDISPOSE;
    BEGIN
      DotNetString := Input;
      EXIT(DotNetString.EndsWith(EndsWith));
    END;

    LOCAL PROCEDURE TextEndsWithImage@1000000006(val@1000000000 : Text) : Boolean;
    BEGIN
      EXIT
      (
        (TextEndsWith(LOWERCASE(val), '.jpg')) OR
        (TextEndsWith(LOWERCASE(val), '.jpeg')) OR
        (TextEndsWith(LOWERCASE(val), '.png')) OR
        (TextEndsWith(LOWERCASE(val), '.gif')) OR
        (TextEndsWith(LOWERCASE(val), '.bmp'))
      );
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>441dc3eb-beb3-4a02-9958-d3bcc2679f22</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="HEAD_Date">
          <DataField>HEAD_Date</DataField>
        </Field>
        <Field Name="HEAD_UserID">
          <DataField>HEAD_UserID</DataField>
        </Field>
        <Field Name="WO_">
          <DataField>WO_</DataField>
        </Field>
        <Field Name="WO_Number">
          <DataField>WO_Number</DataField>
        </Field>
        <Field Name="WO_No">
          <DataField>WO_No</DataField>
        </Field>
        <Field Name="WO_Description">
          <DataField>WO_Description</DataField>
        </Field>
        <Field Name="WO_Status">
          <DataField>WO_Status</DataField>
        </Field>
        <Field Name="WO_AssignedUserID">
          <DataField>WO_AssignedUserID</DataField>
        </Field>
        <Field Name="WO_AssignedUserName">
          <DataField>WO_AssignedUserName</DataField>
        </Field>
        <Field Name="WO_AssignedUserNameUserID">
          <DataField>WO_AssignedUserNameUserID</DataField>
        </Field>
        <Field Name="WO_CreatedDatetime">
          <DataField>WO_CreatedDatetime</DataField>
        </Field>
        <Field Name="WO_ObjectNo">
          <DataField>WO_ObjectNo</DataField>
        </Field>
        <Field Name="WO_ObjectName">
          <DataField>WO_ObjectName</DataField>
        </Field>
        <Field Name="WO_CustomerName">
          <DataField>WO_CustomerName</DataField>
        </Field>
        <Field Name="WO_CustomerNo">
          <DataField>WO_CustomerNo</DataField>
        </Field>
        <Field Name="WOC_">
          <DataField>WOC_</DataField>
        </Field>
        <Field Name="WOC_Number">
          <DataField>WOC_Number</DataField>
        </Field>
        <Field Name="WOC_EntryNo">
          <DataField>WOC_EntryNo</DataField>
        </Field>
        <Field Name="WOC_UserID">
          <DataField>WOC_UserID</DataField>
        </Field>
        <Field Name="WOC_UserName">
          <DataField>WOC_UserName</DataField>
        </Field>
        <Field Name="WOC_Comment">
          <DataField>WOC_Comment</DataField>
        </Field>
        <Field Name="WOC_CreatedDatetime">
          <DataField>WOC_CreatedDatetime</DataField>
        </Field>
        <Field Name="WOC_UserNameUserID">
          <DataField>WOC_UserNameUserID</DataField>
        </Field>
        <Field Name="T_">
          <DataField>T_</DataField>
        </Field>
        <Field Name="T_Number">
          <DataField>T_Number</DataField>
        </Field>
        <Field Name="T_No">
          <DataField>T_No</DataField>
        </Field>
        <Field Name="T_Description">
          <DataField>T_Description</DataField>
        </Field>
        <Field Name="T_ExtendedDescription">
          <DataField>T_ExtendedDescription</DataField>
        </Field>
        <Field Name="T_Status">
          <DataField>T_Status</DataField>
        </Field>
        <Field Name="T_AssignedUserID">
          <DataField>T_AssignedUserID</DataField>
        </Field>
        <Field Name="T_AssignedUserName">
          <DataField>T_AssignedUserName</DataField>
        </Field>
        <Field Name="T_CreatedDatetime">
          <DataField>T_CreatedDatetime</DataField>
        </Field>
        <Field Name="T_UserNameUserID">
          <DataField>T_UserNameUserID</DataField>
        </Field>
        <Field Name="TP_">
          <DataField>TP_</DataField>
        </Field>
        <Field Name="TP_Number">
          <DataField>TP_Number</DataField>
        </Field>
        <Field Name="TP_Show1">
          <DataField>TP_Show1</DataField>
        </Field>
        <Field Name="TP_Comment1">
          <DataField>TP_Comment1</DataField>
        </Field>
        <Field Name="TP_Picture1">
          <DataField>TP_Picture1</DataField>
        </Field>
        <Field Name="TP_Show2">
          <DataField>TP_Show2</DataField>
        </Field>
        <Field Name="TP_Comment2">
          <DataField>TP_Comment2</DataField>
        </Field>
        <Field Name="TP_Picture2">
          <DataField>TP_Picture2</DataField>
        </Field>
        <Field Name="THS_">
          <DataField>THS_</DataField>
        </Field>
        <Field Name="THS_Number">
          <DataField>THS_Number</DataField>
        </Field>
        <Field Name="THS_PDFImage">
          <DataField>THS_PDFImage</DataField>
        </Field>
        <Field Name="THS_Description">
          <DataField>THS_Description</DataField>
        </Field>
        <Field Name="TC_">
          <DataField>TC_</DataField>
        </Field>
        <Field Name="TC_Number">
          <DataField>TC_Number</DataField>
        </Field>
        <Field Name="TC_EntryNo">
          <DataField>TC_EntryNo</DataField>
        </Field>
        <Field Name="TC_UserID">
          <DataField>TC_UserID</DataField>
        </Field>
        <Field Name="TC_UserName">
          <DataField>TC_UserName</DataField>
        </Field>
        <Field Name="TC_Comment">
          <DataField>TC_Comment</DataField>
        </Field>
        <Field Name="TC_CreatedDatetime">
          <DataField>TC_CreatedDatetime</DataField>
        </Field>
        <Field Name="TC_UserNameUserID">
          <DataField>TC_UserNameUserID</DataField>
        </Field>
        <Field Name="TCLI_">
          <DataField>TCLI_</DataField>
        </Field>
        <Field Name="TCLI_Number">
          <DataField>TCLI_Number</DataField>
        </Field>
        <Field Name="TCLI_No">
          <DataField>TCLI_No</DataField>
        </Field>
        <Field Name="TCLI_Description">
          <DataField>TCLI_Description</DataField>
        </Field>
        <Field Name="TCLI_Status">
          <DataField>TCLI_Status</DataField>
        </Field>
        <Field Name="TT_">
          <DataField>TT_</DataField>
        </Field>
        <Field Name="TT_Number">
          <DataField>TT_Number</DataField>
        </Field>
        <Field Name="TT_No">
          <DataField>TT_No</DataField>
        </Field>
        <Field Name="TT_UserId">
          <DataField>TT_UserId</DataField>
        </Field>
        <Field Name="TT_UserName">
          <DataField>TT_UserName</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>1.4015in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1.22931in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.5335in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.70712in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.80524in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1.01321in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.76207in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.82754in</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>3.93701in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox32">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox32</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.3937in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_CustomerName">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_CustomerName.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>18pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_CustomerName</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.3937in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_ObjectName">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_ObjectName.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>18pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_ObjectName</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.3937in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_Description">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_Description.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>14pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_Description</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>3.93701in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox50">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox50</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox90">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!SiteName_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox90</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_ObjectName1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_ObjectName.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_ObjectName1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox114">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!SiteNo_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox114</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_ObjectNo">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_ObjectNo.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_ObjectNo</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox106">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!WorkorderNo_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox106</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_No">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_No.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_No</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox98">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!PlantManager_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox98</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_AssignedUserName">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_AssignedUserName.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_AssignedUserName</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox82">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox82</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox83">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox83</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox84">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox84</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox85">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox85</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox86">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox86</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox87">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox87</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox88">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox88</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox89">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox89</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.31496in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox2">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!GeneralInformation_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>14pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>Underline</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox2</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#2f5496</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.03937in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox172">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox172</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox48">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!WorkorderNo_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox48</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_No1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_No.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_No1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox65">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!Description_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox65</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_Description1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_Description.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_Description1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox74">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!Status_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox57</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_Status">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_Status.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_Status</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox68">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!SiteNo_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox62</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_ObjectNo1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_ObjectNo.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_ObjectNo1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox70">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!SiteName_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox70</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_ObjectName4">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_ObjectName.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_ObjectName2</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox72">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!Date_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox54</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_CreatedDatetime">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_CreatedDatetime.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <Format>d</Format>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_CreatedDatetime</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox73">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!PlantManager_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox73</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_AssignedUserName1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_AssignedUserNameUserID.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_AssignedUserName1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox157">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox157</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox158">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox158</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox159">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox159</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox160">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox160</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox161">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox161</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox162">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox162</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox163">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox163</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox164">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox164</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox173">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!Tasks_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox173</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#5f84c6</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.03937in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox92">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox92</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox93">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox93</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox94">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox94</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox96">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox96</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox97">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox97</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox99">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox99</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox100">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox100</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox101">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox101</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_Number">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_No.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_Number</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_Description">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_Description.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_Description</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>6</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_Status">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_Status.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_Status</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox30">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox30</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox31">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox31</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox33">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox33</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox34">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox34</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox35">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox35</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox36">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox36</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox37">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox37</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox38">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox38</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!Comments_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#5f84c6</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.03937in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox61">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox61</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox63">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox63</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox64">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox64</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox67">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox67</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox77">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox77</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox79">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox79</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox81">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox81</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox91">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox91</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox130">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WOC_UserID.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox130</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox5">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WOC_UserName.Value + ", " + FormatDateTime(Fields!WOC_CreatedDatetime.Value, DateFormat.ShortDate) + " " + FormatDateTime(Fields!WOC_CreatedDatetime.Value, DateFormat.ShortTime)</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox3</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox23">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WOC_Comment.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox23</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.07874in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox107">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox107</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox108">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox108</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox109">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox109</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox110">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox110</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox111">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox111</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox116">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox116</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox117">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox117</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox118">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox118</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox10">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox10</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox11">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox11</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox12">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox12</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox13">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox13</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox18">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox18</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox19">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox19</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox20">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox20</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox21">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox21</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.31496in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox42">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!DetailedInformation_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>14pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>Underline</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox42</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#2f5496</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox24">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox24</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox25">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox25</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox26">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox26</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox27">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox27</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox28">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox28</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox29">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox29</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox39">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox39</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox40">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox40</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox105">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!Task_CAP.Value + " " + Fields!T_No.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox105</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#5f84c6</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_Description1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_Description.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_Description1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#5f84c6</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_Status2">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_Status.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_Status2</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#5f84c6</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.03937in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox102">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox102</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox103">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox103</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox104">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox104</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox119">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox119</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox127">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox127</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox128">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox128</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox129">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox129</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox131">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox131</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox271">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!Description_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox126</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_Description4">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_Description.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_Description2</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox188">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!ResponsiblePerson_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox188</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox1780">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_UserNameUserID.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox1780</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox356">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox356</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox358">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox358</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox120">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox120</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox121">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox121</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox122">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox122</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox123">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox123</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox124">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox124</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox125">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox125</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox7">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!ChecklistItems_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox7</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BottomBorder>
                              <Color>DimGray</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </BottomBorder>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.03937in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox140">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox140</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox141">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox141</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox142">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox142</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox143">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox143</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox144">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox144</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox145">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox145</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox146">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox146</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox147">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox147</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="TCLI_Description">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!TCLI_Description.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <ListStyle>Bulleted</ListStyle>
                              <ListLevel>1</ListLevel>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>TCLI_Description</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>6</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="TCLI_Status">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!TCLI_Status.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>TCLI_Status</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox228">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox228</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox229">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox229</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox230">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox230</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox231">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox231</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox232">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox232</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox233">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox233</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox234">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox234</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox235">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox235</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox95">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!Comments_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox6</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BottomBorder>
                              <Color>DimGray</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </BottomBorder>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.03937in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox212">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox212</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox213">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox213</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox214">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox214</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox215">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox215</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox216">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox216</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox217">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox217</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox218">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox218</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox219">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox219</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="TC_UserID2">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!TC_UserID.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>TC_UserID</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox4">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!TC_UserName.Value + ", " + Microsoft.VisualBasic.Strings.FormatDateTime(Fields!TC_CreatedDatetime.Value, Microsoft.VisualBasic.DateFormat.ShortDate) + " " + Microsoft.VisualBasic.Strings.FormatDateTime(Fields!TC_CreatedDatetime.Value, Microsoft.VisualBasic.DateFormat.ShortTime)</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox3</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="TC_Comment2">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!TC_Comment.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>TC_Comment</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.07874in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox237">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox237</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox238">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox238</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox239">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox239</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox240">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox240</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox241">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox241</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox242">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox242</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox243">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox243</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox244">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox244</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox420">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox420</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox421">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox421</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox422">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox422</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox423">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox423</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox424">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox424</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox425">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox425</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox426">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox426</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox427">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox427</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox9">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!Pictures_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox9</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BottomBorder>
                              <Color>DimGray</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </BottomBorder>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.03937in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox22">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox22</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox41">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox41</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox53">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox53</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox55">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox55</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox56">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox56</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox58">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox58</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox59">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox59</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox60">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox60</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>2.32283in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Tablix Name="Tablix3">
                          <TablixBody>
                            <TablixColumns>
                              <TablixColumn>
                                <Width>3.63975in</Width>
                              </TablixColumn>
                              <TablixColumn>
                                <Width>3.63975in</Width>
                              </TablixColumn>
                            </TablixColumns>
                            <TablixRows>
                              <TablixRow>
                                <Height>2.00787in</Height>
                                <TablixCells>
                                  <TablixCell>
                                    <CellContents>
                                      <Rectangle Name="Rectangle1">
                                        <ReportItems>
                                          <Image Name="Image2">
                                            <Source>Database</Source>
                                            <Value>=Fields!TP_Picture1.Value</Value>
                                            <MIMEType>image/bmp</MIMEType>
                                            <Sizing>FitProportional</Sizing>
                                            <Top>0in</Top>
                                            <Left>0in</Left>
                                            <Height>5.1cm</Height>
                                            <Width>3.63975in</Width>
                                            <Style>
                                              <Border>
                                                <Style>None</Style>
                                              </Border>
                                            </Style>
                                          </Image>
                                        </ReportItems>
                                        <KeepTogether>true</KeepTogether>
                                        <Style>
                                          <Border>
                                            <Style>None</Style>
                                          </Border>
                                        </Style>
                                      </Rectangle>
                                    </CellContents>
                                  </TablixCell>
                                  <TablixCell>
                                    <CellContents>
                                      <Image Name="Image3">
                                        <Source>Database</Source>
                                        <Value>=Fields!TP_Picture2.Value</Value>
                                        <MIMEType>image/bmp</MIMEType>
                                        <Sizing>FitProportional</Sizing>
                                        <Style>
                                          <Border>
                                            <Style>None</Style>
                                          </Border>
                                        </Style>
                                      </Image>
                                    </CellContents>
                                  </TablixCell>
                                </TablixCells>
                              </TablixRow>
                              <TablixRow>
                                <Height>0.15748in</Height>
                                <TablixCells>
                                  <TablixCell>
                                    <CellContents>
                                      <Textbox Name="TP_Comment1">
                                        <CanGrow>true</CanGrow>
                                        <KeepTogether>true</KeepTogether>
                                        <Paragraphs>
                                          <Paragraph>
                                            <TextRuns>
                                              <TextRun>
                                                <Value EvaluationMode="Auto">=Fields!TP_Comment1.Value</Value>
                                                <Style>
                                                  <FontFamily>Segoe UI</FontFamily>
                                                  <FontSize>8pt</FontSize>
                                                </Style>
                                              </TextRun>
                                            </TextRuns>
                                            <Style>
                                              <TextAlign>Center</TextAlign>
                                            </Style>
                                          </Paragraph>
                                        </Paragraphs>
                                        <rd:DefaultName>TP_Comment1</rd:DefaultName>
                                        <Style>
                                          <Border>
                                            <Style>None</Style>
                                          </Border>
                                          <PaddingLeft>2pt</PaddingLeft>
                                          <PaddingRight>2pt</PaddingRight>
                                        </Style>
                                      </Textbox>
                                    </CellContents>
                                  </TablixCell>
                                  <TablixCell>
                                    <CellContents>
                                      <Textbox Name="TP_Comment2">
                                        <CanGrow>true</CanGrow>
                                        <KeepTogether>true</KeepTogether>
                                        <Paragraphs>
                                          <Paragraph>
                                            <TextRuns>
                                              <TextRun>
                                                <Value EvaluationMode="Auto">=Fields!TP_Comment2.Value</Value>
                                                <Style>
                                                  <FontFamily>Segoe UI</FontFamily>
                                                  <FontSize>8pt</FontSize>
                                                </Style>
                                              </TextRun>
                                            </TextRuns>
                                            <Style>
                                              <TextAlign>Center</TextAlign>
                                            </Style>
                                          </Paragraph>
                                        </Paragraphs>
                                        <rd:DefaultName>TP_Comment2</rd:DefaultName>
                                        <Style>
                                          <Border>
                                            <Style>None</Style>
                                          </Border>
                                          <PaddingLeft>2pt</PaddingLeft>
                                          <PaddingRight>2pt</PaddingRight>
                                        </Style>
                                      </Textbox>
                                    </CellContents>
                                  </TablixCell>
                                </TablixCells>
                              </TablixRow>
                              <TablixRow>
                                <Height>0.15748in</Height>
                                <TablixCells>
                                  <TablixCell>
                                    <CellContents>
                                      <Textbox Name="Textbox112">
                                        <CanGrow>true</CanGrow>
                                        <KeepTogether>true</KeepTogether>
                                        <Paragraphs>
                                          <Paragraph>
                                            <TextRuns>
                                              <TextRun>
                                                <Value EvaluationMode="Auto" />
                                                <Style>
                                                  <FontFamily>Segoe UI</FontFamily>
                                                  <FontSize>8pt</FontSize>
                                                </Style>
                                              </TextRun>
                                            </TextRuns>
                                            <Style>
                                              <TextAlign>Center</TextAlign>
                                            </Style>
                                          </Paragraph>
                                        </Paragraphs>
                                        <rd:DefaultName>Textbox112</rd:DefaultName>
                                        <Style>
                                          <Border>
                                            <Style>None</Style>
                                          </Border>
                                          <PaddingLeft>2pt</PaddingLeft>
                                          <PaddingRight>2pt</PaddingRight>
                                        </Style>
                                      </Textbox>
                                    </CellContents>
                                  </TablixCell>
                                  <TablixCell>
                                    <CellContents>
                                      <Textbox Name="Textbox113">
                                        <CanGrow>true</CanGrow>
                                        <KeepTogether>true</KeepTogether>
                                        <Paragraphs>
                                          <Paragraph>
                                            <TextRuns>
                                              <TextRun>
                                                <Value EvaluationMode="Auto" />
                                                <Style>
                                                  <FontFamily>Segoe UI</FontFamily>
                                                  <FontSize>8pt</FontSize>
                                                </Style>
                                              </TextRun>
                                            </TextRuns>
                                            <Style>
                                              <TextAlign>Center</TextAlign>
                                            </Style>
                                          </Paragraph>
                                        </Paragraphs>
                                        <rd:DefaultName>Textbox113</rd:DefaultName>
                                        <Style>
                                          <Border>
                                            <Style>None</Style>
                                          </Border>
                                          <PaddingLeft>2pt</PaddingLeft>
                                          <PaddingRight>2pt</PaddingRight>
                                        </Style>
                                      </Textbox>
                                    </CellContents>
                                  </TablixCell>
                                </TablixCells>
                              </TablixRow>
                            </TablixRows>
                          </TablixBody>
                          <TablixColumnHierarchy>
                            <TablixMembers>
                              <TablixMember />
                              <TablixMember />
                            </TablixMembers>
                          </TablixColumnHierarchy>
                          <TablixRowHierarchy>
                            <TablixMembers>
                              <TablixMember>
                                <Group Name="TP__">
                                  <Filters>
                                    <Filter>
                                      <FilterExpression>=Fields!TP_.Value</FilterExpression>
                                      <Operator>Equal</Operator>
                                      <FilterValues>
                                        <FilterValue DataType="Boolean">true</FilterValue>
                                      </FilterValues>
                                    </Filter>
                                  </Filters>
                                </Group>
                                <TablixMembers>
                                  <TablixMember />
                                  <TablixMember />
                                  <TablixMember />
                                </TablixMembers>
                              </TablixMember>
                            </TablixMembers>
                          </TablixRowHierarchy>
                          <DataSetName>DataSet_Result</DataSetName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                          </Style>
                        </Tablix>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox43">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox43</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox44">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox44</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox45">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox45</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox46">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox46</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox166">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox166</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox49">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox49</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox51">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox51</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox52">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox52</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox8">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!TaskHealthAndSafetyDocuments_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>#2f5496</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox8</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BottomBorder>
                              <Color>DimGray</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </BottomBorder>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.03937in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox148">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox148</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox149">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox149</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox150">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox150</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox151">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox151</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox152">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox152</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox154">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox154</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox156">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox156</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox165">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox165</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox78">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!HealthAndSafetyDocumentExists.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox78</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox370">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox370</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox371">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox371</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox372">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox372</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox373">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox373</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox374">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox374</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox375">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox375</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox376">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox376</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox377">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox377</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.15748in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox136">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Parameters!EndOfDocument_CAP.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>DimGray</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox136</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Top</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="WO">
                    <GroupExpressions>
                      <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                    </GroupExpressions>
                    <Filters>
                      <Filter>
                        <FilterExpression>=Fields!WO_.Value</FilterExpression>
                        <Operator>Equal</Operator>
                        <FilterValues>
                          <FilterValue DataType="Boolean">true</FilterValue>
                        </FilterValues>
                      </Filter>
                    </Filters>
                  </Group>
                  <TablixMembers>
                    <TablixMember>
                      <Group Name="WO_TitleSheet">
                        <GroupExpressions>
                          <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                        </GroupExpressions>
                        <PageBreak>
                          <BreakLocation>End</BreakLocation>
                        </PageBreak>
                      </Group>
                      <SortExpressions>
                        <SortExpression>
                          <Value>=Fields!WO_No.Value</Value>
                        </SortExpression>
                      </SortExpressions>
                      <TablixMembers>
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                      </TablixMembers>
                    </TablixMember>
                    <TablixMember>
                      <Group Name="WO_General">
                        <GroupExpressions>
                          <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                        </GroupExpressions>
                        <PageBreak>
                          <BreakLocation>End</BreakLocation>
                        </PageBreak>
                      </Group>
                      <SortExpressions>
                        <SortExpression>
                          <Value>=Fields!WO_No.Value</Value>
                        </SortExpression>
                      </SortExpressions>
                      <TablixMembers>
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember />
                        <TablixMember>
                          <Visibility>
                            <Hidden>=(CStr(MAX(Fields!T_Number.Value)) = "")</Hidden>
                          </Visibility>
                        </TablixMember>
                        <TablixMember>
                          <Visibility>
                            <Hidden>=(CStr(MAX(Fields!T_Number.Value)) = "")</Hidden>
                          </Visibility>
                        </TablixMember>
                        <TablixMember>
                          <TablixMembers>
                            <TablixMember>
                              <Group Name="T_">
                                <GroupExpressions>
                                  <GroupExpression>=Fields!T_No.Value</GroupExpression>
                                </GroupExpressions>
                                <Filters>
                                  <Filter>
                                    <FilterExpression>=Fields!T_.Value</FilterExpression>
                                    <Operator>Equal</Operator>
                                    <FilterValues>
                                      <FilterValue DataType="Boolean">true</FilterValue>
                                    </FilterValues>
                                  </Filter>
                                </Filters>
                              </Group>
                              <SortExpressions>
                                <SortExpression>
                                  <Value>=Fields!WO_No.Value</Value>
                                </SortExpression>
                              </SortExpressions>
                            </TablixMember>
                            <TablixMember>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(CStr(MAX(Fields!WOC_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Group Name="WOC_">
                                <GroupExpressions>
                                  <GroupExpression>=Fields!WOC_EntryNo.Value</GroupExpression>
                                </GroupExpressions>
                                <Filters>
                                  <Filter>
                                    <FilterExpression>=Fields!WOC_.Value</FilterExpression>
                                    <Operator>Equal</Operator>
                                    <FilterValues>
                                      <FilterValue DataType="Boolean">true</FilterValue>
                                    </FilterValues>
                                  </Filter>
                                </Filters>
                              </Group>
                              <SortExpressions>
                                <SortExpression>
                                  <Value>=Fields!TC_EntryNo.Value</Value>
                                </SortExpression>
                              </SortExpressions>
                              <TablixMembers>
                                <TablixMember />
                                <TablixMember />
                                <TablixMember />
                              </TablixMembers>
                            </TablixMember>
                          </TablixMembers>
                        </TablixMember>
                        <TablixMember />
                      </TablixMembers>
                    </TablixMember>
                    <TablixMember>
                      <Group Name="WO_Detail">
                        <GroupExpressions>
                          <GroupExpression>=Fields!WO_Number.Value</GroupExpression>
                        </GroupExpressions>
                        <Filters>
                          <Filter>
                            <FilterExpression>=Fields!WO_.Value</FilterExpression>
                            <Operator>Equal</Operator>
                            <FilterValues>
                              <FilterValue DataType="Boolean">true</FilterValue>
                            </FilterValues>
                          </Filter>
                        </Filters>
                      </Group>
                      <SortExpressions>
                        <SortExpression>
                          <Value>=Fields!WO_Number.Value</Value>
                        </SortExpression>
                      </SortExpressions>
                      <TablixMembers>
                        <TablixMember />
                        <TablixMember />
                        <TablixMember>
                          <Group Name="T__">
                            <GroupExpressions>
                              <GroupExpression>=Fields!T_No.Value</GroupExpression>
                            </GroupExpressions>
                            <Filters>
                              <Filter>
                                <FilterExpression>=Fields!T_.Value</FilterExpression>
                                <Operator>Equal</Operator>
                                <FilterValues>
                                  <FilterValue DataType="Boolean">true</FilterValue>
                                </FilterValues>
                              </Filter>
                            </Filters>
                          </Group>
                          <SortExpressions>
                            <SortExpression>
                              <Value>=Fields!T_No.Value</Value>
                            </SortExpression>
                          </SortExpressions>
                          <TablixMembers>
                            <TablixMember />
                            <TablixMember />
                            <TablixMember />
                            <TablixMember />
                            <TablixMember />
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(CStr(MAX(Fields!TCLI_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(CStr(MAX(Fields!TCLI_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Group Name="TCLI_">
                                <GroupExpressions>
                                  <GroupExpression>=Fields!TCLI_No.Value</GroupExpression>
                                </GroupExpressions>
                                <Filters>
                                  <Filter>
                                    <FilterExpression>=Fields!TCLI_.Value</FilterExpression>
                                    <Operator>Equal</Operator>
                                    <FilterValues>
                                      <FilterValue DataType="Boolean">true</FilterValue>
                                    </FilterValues>
                                  </Filter>
                                </Filters>
                              </Group>
                              <SortExpressions>
                                <SortExpression>
                                  <Value>=Fields!TCLI_No.Value</Value>
                                </SortExpression>
                              </SortExpressions>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(CStr(MAX(Fields!TCLI_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(CStr(MAX(Fields!TC_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(CStr(MAX(Fields!TC_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Group Name="TC_">
                                <GroupExpressions>
                                  <GroupExpression>=Fields!TC_Number.Value</GroupExpression>
                                </GroupExpressions>
                                <Filters>
                                  <Filter>
                                    <FilterExpression>=Fields!TC_.Value</FilterExpression>
                                    <Operator>Equal</Operator>
                                    <FilterValues>
                                      <FilterValue DataType="Boolean">true</FilterValue>
                                    </FilterValues>
                                  </Filter>
                                </Filters>
                              </Group>
                              <SortExpressions>
                                <SortExpression>
                                  <Value>=Fields!TC_Number.Value</Value>
                                </SortExpression>
                              </SortExpressions>
                              <TablixMembers>
                                <TablixMember />
                                <TablixMember />
                                <TablixMember />
                              </TablixMembers>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(CStr(MAX(Fields!TC_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(CStr(MAX(Fields!TP_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(CStr(MAX(Fields!TP_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Group Name="TP_">
                                <GroupExpressions>
                                  <GroupExpression>=Fields!TP_Number.Value</GroupExpression>
                                </GroupExpressions>
                                <Filters>
                                  <Filter>
                                    <FilterExpression>=Fields!TP_.Value</FilterExpression>
                                    <Operator>Equal</Operator>
                                    <FilterValues>
                                      <FilterValue DataType="Boolean">true</FilterValue>
                                    </FilterValues>
                                  </Filter>
                                </Filters>
                              </Group>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(CStr(MAX(Fields!TP_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(Cstr(MAX(Fields!THS_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(CStr(MAX(Fields!THS_Number.Value)) = "")</Hidden>
                              </Visibility>
                              <KeepWithGroup>After</KeepWithGroup>
                            </TablixMember>
                            <TablixMember>
                              <Group Name="THS_">
                                <GroupExpressions>
                                  <GroupExpression>=Fields!THS_Number.Value</GroupExpression>
                                </GroupExpressions>
                                <Filters>
                                  <Filter>
                                    <FilterExpression>=Fields!THS_.Value</FilterExpression>
                                    <Operator>Equal</Operator>
                                    <FilterValues>
                                      <FilterValue DataType="Boolean">true</FilterValue>
                                    </FilterValues>
                                  </Filter>
                                </Filters>
                              </Group>
                              <SortExpressions>
                                <SortExpression>
                                  <Value>=Fields!THS_Number.Value</Value>
                                </SortExpression>
                              </SortExpressions>
                              <TablixMembers>
                                <TablixMember />
                              </TablixMembers>
                            </TablixMember>
                            <TablixMember>
                              <Visibility>
                                <Hidden>=(Cstr(MAX(Fields!THS_Number.Value)) = "")</Hidden>
                              </Visibility>
                            </TablixMember>
                          </TablixMembers>
                        </TablixMember>
                      </TablixMembers>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
                <TablixMember>
                  <KeepWithGroup>Before</KeepWithGroup>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>DataSet_Result</DataSetName>
            <Height>19.02951in</Height>
            <Width>7.27949in</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
        </ReportItems>
        <Height>19.02951in</Height>
        <Style />
      </Body>
      <Width>18.49cm</Width>
      <Page>
        <PageHeader>
          <Height>1.8cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Image Name="Image1">
              <Source>Embedded</Source>
              <Value>encome</Value>
              <Sizing>FitProportional</Sizing>
              <Top>0in</Top>
              <Left>5.22869in</Left>
              <Height>1.5cm</Height>
              <Width>2.05083in</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
              </Style>
            </Image>
            <Textbox Name="Textbox14">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!SiteVisitionReport_CAP.Value</Value>
                      <Style>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>24pt</FontSize>
                        <Color>DimGray</Color>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox14</rd:DefaultName>
              <Height>1.5cm</Height>
              <Width>12.8685cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Bottom</VerticalAlign>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageHeader>
        <PageFooter>
          <Height>0.4cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="Textbox15">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=First(Fields!HEAD_Date.Value, "DataSet_Result")</Value>
                      <Style>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Format>d</Format>
                        <Color>DimGray</Color>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Left</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox14</rd:DefaultName>
              <Height>0.4cm</Height>
              <Width>5.20175cm</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Top</VerticalAlign>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
              </Style>
            </Textbox>
            <Textbox Name="Textbox16">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!Page_CAP.Value + " " + Cstr(Globals!PageNumber) + "/" + Cstr(Globals!TotalPages)</Value>
                      <Style>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Format>d</Format>
                        <Color>DimGray</Color>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox14</rd:DefaultName>
              <Left>13.28825cm</Left>
              <Height>0.4cm</Height>
              <Width>5.20175cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Top</VerticalAlign>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
              </Style>
            </Textbox>
            <Textbox Name="Textbox17">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">=Parameters!SiteVisitionReport_CAP.Value</Value>
                      <Style>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Format>d</Format>
                        <Color>DimGray</Color>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox14</rd:DefaultName>
              <Left>5.20175cm</Left>
              <Height>0.4cm</Height>
              <Width>8.0865cm</Width>
              <ZIndex>2</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Top</VerticalAlign>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageFooter>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>21cm</PageWidth>
        <InteractiveHeight>29.7cm</InteractiveHeight>
        <InteractiveWidth>21cm</InteractiveWidth>
        <LeftMargin>2cm</LeftMargin>
        <RightMargin>0.5cm</RightMargin>
        <TopMargin>0.5cm</TopMargin>
        <BottomMargin>0.5cm</BottomMargin>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="SiteVisitionReport_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>SiteVisitionReport_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>SiteVisitionReport_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="Date_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Date_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>Date_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="Page_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Page_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>Page_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="GeneralInformation_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>GeneralInformation_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>GeneralInformation_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="DetailedInformation_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>DetailedInformation_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>DetailedInformation_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="WorkorderNo_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>WorkorderNo_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>WorkorderNo_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="Description_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Description_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>Description_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="SiteNo_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>SiteNo_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>SiteNo_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="SiteName_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>SiteName_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>SiteName_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="Status_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Status_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>Status_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="No_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>No_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>No_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="Workorder_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Workorder_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>Workorder_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="Comments_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Comments_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>Comments_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="Tasks_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Tasks_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>Tasks_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="Task_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Task_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>Task_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="ChecklistItems_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ChecklistItems_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>ChecklistItems_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="ChecklistItem_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ChecklistItem_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>ChecklistItem_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="Pictures_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>Pictures_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>Pictures_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="TaskHealthAndSafetyDocuments_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>TaskHealthAndSafetyDocuments_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>TaskHealthAndSafetyDocuments_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="HealthAndSafetyDocumentExists">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>HealthAndSafetyDocumentExists</Value>
        </Values>
      </DefaultValue>
      <Prompt>HealthAndSafetyDocumentExists</Prompt>
    </ReportParameter>
    <ReportParameter Name="ResponsiblePerson_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ResponsiblePerson_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>ResponsiblePerson_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="PlantManager_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>PlantManager_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>PlantManager_CAP</Prompt>
    </ReportParameter>
    <ReportParameter Name="EndOfDocument_CAP">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>EndOfDocument_CAP</Value>
        </Values>
      </DefaultValue>
      <Prompt>EndOfDocument_CAP</Prompt>
    </ReportParameter>
  </ReportParameters>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function
</Code>
  <EmbeddedImages>
    <EmbeddedImage Name="encome">
      <MIMEType>image/jpeg</MIMEType>
      <ImageData>/9j/4AAQSkZJRgABAQEBLAEsAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCADTAlgDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/K+N/wDgo5/wWo+Ff/BPMy6HcPJ40+IXlh08OabMFNsCMq11OQVgBHO3DSEEHZtOao/8FuP+Clr/APBPT9mhIfDs8P8AwsjxyZbHQAyh/wCzo1A8++ZTwfKDKqBuDJIhIZVcV/Nr4h8RX/i7Xb3VNUvbrUtS1Kd7m7urmZpZ
rmV2LO7uxJZmYkkkkkkkmv1HgTgKOaQ+v4+6pXsktHK2+vSK201bvZq2vxPE/FDwUvquF/idX/L/AMH1Pt79pP8A4OIv2kfjzeTxaP4i0/4b6LKcLZeHLRUm29i11Lvm3epRowf7o6V8l+Pf2l/iP8VJ3l8T+P8Axp4ikkPzNqet3N2T1/56Of7zD8T6muJrrvhn+z34++Ncm3wb4H8YeLmUkEaNo9zf4I7fukbpX7nhcpy3L4fuaUKaXWyX3vf72fmNbH4zFy/eTlJ9rt/h/kcjRXvkH/BLD9pG4hjkX4H/ABO2yAMA3h+4VhnpkFQR9Dginf8ADqn9pL/oh/xM/wDBBP8A/E1t/bGA/wCf0P8AwKP+Zn/Z+K/59y/8Bf8AkeA1sR/EfxDDt2a9rS7fu4vZRjH/AAKvZv8Ah1T+0l/0Q/4mf+CCf/4mj/h1T+0l/wBEP+Jn/ggn/wDiaUs1y+XxVof+BR/zKjgcWtqcvuZ57pP7VPxQ0CdpLH4kePLKRxtZoPEF3EzDrjKyD2OK/oD/AODeL48eMP2gP+Ce66n428R6x4q1bTfEl9psN/qly91dtAqQyKryuS77WlcAsSQMDOAAPw+/4dU/tJf9EP8AiZ/4IJ//AImv3K/4N+P2c/G37M37Ah0Px54d1DwvrOoeJL3Uo7C+QJcJA6QRqzp1QkxOdrYOMHGCK/NvEyvl1TKP3EoOfPHZxv1vtrY+x4Np4uGP/eKSjyve9unfQ+5KKKK/n8/VT8Q/+Dgv/gqV8Xvhh+1zdfCfwH4s1bwL4e8Oadaz3U+jXJtb3Uri4h80u06YkRFSRVVFIGVZiSSoX89P+HjH7Q3/AEXb4z/+FrqX/wAer37/AIOLf+UrXjj/ALB2k/8ApBDXw5X9WcJZTgo5NhpKlG8oRbfKm22k2235s/C8+zDEvMKy9o7KTS1eiTskfTnwU/4LG/tJfBTxlperQ/Frxl4ih0+dXl0/X9Sk1S2vY92XikE5Y4YZ
XcpDKD8pBAI/pM/ZY/aK0P8Aaz/Z78I/Ebw43/Er8V6el4sRcO1rJyssDkcF4pFeNscZQ44r+Rev1q/4NhP28x4M+ImtfAbxBeMun+KXfV/DJkf5YL1Iybm3GTx5sSB1AwA0L9TJXzPiRwnQrYD69hKajOlq+VJXj1vbtv6X7ntcH57Up4r6tXk3Geiu72fT79vWx+4VFFFfzyfrQUUUUAFcb+0F49uvhR8BfG/imxihmvvDegX2q28cv+reSC3klUNjnBKDOK7KvM/21P8Akzj4s/8AYm6x/wCkU1dGDip4iEZbNr8zHEScaUpLez/I/mT8U/8ABT39ozxh4hutSuvjl8Vobi8kMskdj4nvLG3Uk9EhhkWONf8AZVQAOgr1D9gf/gp38ftC/bI+GsN38XPiD4i03VvEun6bfadrmvXWp2d3bz3McUiNHO7KCUdsMuGU4IIIFfHdemfsWf8AJ4/wl/7HPR//AEuhr+ucdlOB+qVI+xhblf2V29D8EwuYYn28H7SV7rq+5/XBRRRX8fH9AhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB/NT/wcCftFz/H7/gpd4xs1naTSfAMcXhiwQMdqGEb7gkdN32iSYZHJCqD0FfFNeg/tb+IZvF37VfxO1a6ybjVPFmq3cpJzl5LyV25+pPJrz6v7IyXBxwuAo4eG0YxX4K/3vU/nnMsRKviqlaX2pN/ifsL/wAG/P8AwR38IfFv4ZwfHH4q6Pb+I7a/unj8LaHeR77ExwyFJLueM8TZkVkRGygEbMQ+5dn7N6TpFroGmQWdjbQWdnaoI4YIIxHHEo4Cqq8AD0HArx3/AIJveCYfh5+wB8FtKijSM2/grSZJgn3TNJaRyykcDrI7nOM8+te3V/LfFWdY
jMsxq1K0m4qTUV0STsrL037s/bsjy6lhMJCFONm0m31bau9fy8gooor5s9gKKKKACiiigAooooA/m2/4OLf+UrXjj/sHaT/6QQ18OV9x/wDBxb/yla8cf9g7Sf8A0ghr4cr+veFf+RLhP+vcP/SUfgGef8jGv/jl+bCtr4bfEXWPhF8QtE8U+Hb6XTdd8O30Wo2F1HjdbzxOHRsHg/MBwcgjIIIJFe8fHj9hu48D/wDBPL4HfHfR4ZZNI8arqWka+wYt9m1CDU75IH/2Vlt4lUAcBrdiTlxn5tr08PiqGMpy5NUnKLXnFuMk/u+a9TjrUamHnHm0bSkvRpNP+up/Wf8AsO/tY6P+2z+y74R+I+jNCn9vWa/b7VG3f2dep8txbnv8kgYAnll2t0YV67X4K/8ABs1+3j/wpv4/ah8F9eutnh74jubrR2kfCWmrRx/cHYfaIU25JyXhhUDLGv3qr+VeLsheUZnPDL4H70P8L2+7VfK5+45Bmix+DjWfxLSXqv8APf5hRRRXzJ7QV5n+2p/yZx8Wf+xN1j/0imr0yvM/21P+TOPiz/2Jusf+kU1dWB/3qn/iX5owxX8Gfo/yP5H69M/Ys/5PH+Ev/Y56P/6XQ15nXpn7Fn/J4/wl/wCxz0f/ANLoa/sjHf7tU/wv8j+ecL/Gh6r8z+uCiiiv4tP6NCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+Oz4ksz/ETX2Y7mbUbgkk9f3jVjVs/Eb/AJKJr3/YRuP/AEa1Y1f2xS+Bei/I/m+p8TP64P2K/wDkzj4Tf9ibo/8A6RQ16ZXmf7Ff/JnHwm/7E3R//SKGvTK/jHHf7zU/xP8AM/onC/wYei/IKKKK5TcKKKKACiiigAooooA/m2/4OLf+UrXj
j/sHaT/6QQ18OV9x/wDBxb/yla8cf9g7Sf8A0ghr4cr+veFf+RLhP+vcP/SUfgGef8jGv/jl+bP6Ev8Agl1+zFof7ZP/AAb7+Efhv4hXbY+JbLWoY7gLuawuF1q+eC4T/ajlVHx0O0joSK/BD4vfCjXPgZ8UfEHg3xLZvp+veGb+XTr6Bs/JLGxU7TxuU43Kw4ZSCMgg1/R7/wAG/P8AyiJ+Ef8A3GP/AE9X9fEH/B0H+wb/AGP4g0T4/wDh+1/0fVDFoPilI0+7OqkWl0x6/MimFicAGOEclq/MuEuIvq3EmMy2s/cq1ajj5TUn/wClLT1SR9nn2U+2yfD4ymvehCN/8Nl+T/Bs/Ivw14kv/BviTT9Y0q8uNP1TSrmK8s7mB9stvNGwdHQ9mVgCD2Ir+qb/AIJuftnaf+3n+yD4V+IFq0KapcQ/YddtY+llqUIUTx47KxIkQdfLlQnk4r+Uyv0Y/wCDcP8Abwb9m39rBvhrrt8sPhD4qMlrEZWxHZ6sgItnGenmgmAgfeZoSThK+o8SOHv7Qy14ikv3lG8l5x+0vu1XpbqeLwfm31TGeym/cqaPyfR/p8/I/oUooor+Zz9mCvM/21P+TOPiz/2Jusf+kU1emV5n+2p/yZx8Wf8AsTdY/wDSKaurA/71T/xL80YYr+DP0f5H8j9emfsWf8nj/CX/ALHPR/8A0uhrzOvTP2LP+Tx/hL/2Oej/APpdDX9kY7/dqn+F/kfzzhf40PVfmf1wUUUV/Fp/RoUUVzPxd+LHh/4F/DPW/GHivUrfR/Dvh21e9vruZsLFGvoOrMxwqqMlmZQASQKqEZTkoQV29El1fYmUlFOUtka3iDxFp/hPRLrUtVvrTTdNsYmnubq7mWGC3jUZZ3diFVR1JJAAr84f2vf+Dmj4PfBDUbrSPhzpGqfFTV7dihvIZv7P0cNyDtndWklKnn5ItjDpJzmvzD/4Kp/8FfvGv/BRfx3c6daz3nhz4WafcZ0rw8km
03O0/Lc3hU4kmOMheUizhcnc7/HtfufDPhXRVNV84bcnryJ2S8pNat+jVu7PzPOeOKnO6WX6L+Z6t+i6L1/A/Rz4n/8ABz5+0R4yu5hoOn+AfB9qxPki20uS7nQc/eeeR0ZvcRqOBx1zw3/ERb+1b/0PGjf+E3Yf/Gq+HKK/RKXCGSU48scLD5xT/F3Z8jPiDMpO7ry+Ta/I+9fD3/Byb+1Josoa517wnqy7w2278PQICB/D+68s4P5+hFem+A/+Dqz40aTJGviLwF8N9chXAJs47ywmf1yxmlXJ9QgA9DX5e0VnW4LyOqrSwsPkrflYqnxHmcNVWl83f87n9GP/AAS6/wCC7Xh3/goz8WZvAN54G1HwR4qXT5NRttuorqNlepEVEi7/AC43jfDBgpQghWywIAb77r+c/wD4NplLf8FP9LwD8vh3UyeOnyJX9GFfgHH+S4TK80+r4KPLBxTtduzba3d307n6twrmNfG4L2uId5KTV7Jdu2nUKKK/EX/gtd/wXj1jxJ4p1j4R/BDWn0zQ9PdrPXfFdjKVuNSlGQ9vZyKf3cKnKtKvzSEEKQgJk8fh7h3F5xivq2FW2spPaK7v9Fu/S7PQzbNqGX0fbVvkurf9bs++v23P+C3HwJ/Ye1O80TVNcuPF3jCzJSXQfDqJdT2z9Cs8pZYYSD1Vn8wDnYeM/nP8a/8Ag6u+J2v3k0fgD4d+D/DFizYWXWJp9VuioPDDY0CKT3BVgMkAk4NflWzGRizEszHJJPWiv3zKfDPJsJBe2j7WXeW3yina3rf1PyzHcZZjXl+7fJHst/vev3W9D7ovf+Djf9qq7u5JI/GGg2qN0ii8OWZVPpuRm/Mmrfhz/g5J/al0O+8658ReF9Yj/wCeF34et1jP/fkRt+tfBlFfRf6p5K1b6rT/APAI/wCR5H9vZje/t5/+BM/YH4A/8HXusW11b2/xS+FunXluxAmv/C149vJGPVba4Lhz7ecoz3r9Mv2Nf+Ck
Xwf/AG9NHeX4eeLLe81S3jEl3ot4htNUsx3LQtyyjgF4y6ZON2eK/lMrU8EeOdZ+Gni/T9e8O6rqGh65pM63Fnf2M7QXFrIOjo6kFSPUfSvlM68L8qxUHLB3oz6WbcX6p/o18z3st42x1GSWI/eR89H8mv1uf2MUV+bX/BEj/gtfH+2taQfDL4mXFrZ/FSxty1jfKqww+KIUXLMFGAt0qgsyLgMoZ1AAZV/SWvwLOMnxWWYqWExcbSX3NdGn1T/rU/U8vzCjjKKr0HdP70+z8/62CiiivLO0K5X4ufGfwn8BfAt14l8a+ItI8L6DZ/62+1K6S3hDEEhAWI3OcHCLlmPABPFcf+2n+194W/Ya/Z1174ieLJGax0lBHaWUbhZ9Uu3yIraLP8TkHJwQqqzHhTX8y37cP7e/xE/b9+LVx4o8davNLbpI40vR4JGXTtGiJ4jhjzjOMBpDl3IBYnAA+44P4Jr53J1ZPkoxdnLq32j593089j5niDiSllsVBLmqPZdl3f8Al1P2H/aG/wCDpH4OfDu+uLPwD4V8VfEaaEkLduy6Np8/OPkeRXn9/mgHBHXnHzH4v/4OuvirfPJ/YHwx+H2mKQfLGoT3d8VPuUkhzj0AGfUV+VdFfteD8Ochw8bOjzvvKTf4JpfgfnGI4wzSq7qpyrskl/m/xP00tP8Ag6p+P6XMbTeC/g7JCD86x6ZqSMw9mN8QPxB+lelfDD/g7I162vIo/Gfwe0m8t2GJJtF1qS1eP3Ecscgb0wXXrnPGD+QNFdVbgLIai5XhkvRtfk0YU+Kc0g7qs/mk/wA0f02fsaf8Fv8A4A/toana6PpfiKfwj4ouiI4tF8TIljPcucALDKGaGVieAiybz/cFfYFfxp19LeJv+Cunx68Wfsm2fwbvPHGoN4ZtmeOW7V2GqXtqQoWzlus72t1wcLwSHKsWQKi/BZx4RxdWMstq2i3qpa2XdNb+j+8+py/jxqm1jIXaWjjpd9munqvu
P3E/a6/4Lz/s9fslandaS3iK68eeI7UlJdN8LRpeiB+mJLhmWBSDkMqyM64OVzgH4i+Jn/B2Rr1zeSp4N+Duj2MC8Rzazrcl08nuY4o4wvbgO3154/IKivqMt8Mckw0V7aLqy7ybX4RaX339TxMZxpmVaX7tqC7JL83f9D9Nb3/g6r+Pz3Ttb+Cfg9FCTlEl03UZGUe7C+XP1AH0rd8Hf8HXPxXsZY/7f+Gfw91SNR+8GnzXlizHPUF5JsccY555z2r8raK9iXAuQyXK8NH8V+Kdzz48T5ondVn+H+R+/P7Nn/B0J8F/ilqVtp/j7w74l+Gd1cMF+1sRq2mwn/aliVZhzxkQEY5JFfon8N/iV4d+L/g+z8ReFNc0rxHoeorvttQ066S5t5x7OhI4PBGcg5Bwa/jzr6M/4Jxf8FLfHn/BOP4uRax4euJtS8K38yjXvDc05W01WPoWHURzqPuSgEgjBDKSp+J4g8KcNKk6uUtxmvst3T8k3qn6trvbc+kynjmspqGOSlH+ZKzXqtmvSx/VBRXE/s9fHrw3+0/8FfDvj7wjfLqHh/xNZrd2svAdOoeNxk7ZI3DI69mRh2rtq/CalOdObp1FZp2ae6a3R+oQnGcVOLunqgooorMoK+Uf23f+CynwN/YUu7rSfEXiKTX/ABdbghvD2gIt5fRN6THcsUHUHEjq2DkKa+D/APgtl/wXk1TTvFGsfB/4G6w2nx6fI1p4h8W2cuJpJRlZLWzcfcVT8rzKdxYEIQBuf8c7m5kvLiSaZ3lmmYu7uxZnYnJJPqevPWv17hPwxli6UcXmjcYS1UFpJru30XlvbsfA59xmqE3QwSUpLRyey9O/rt6n6vfG7/g62+IWt3Mkfw9+GfhPw7a5KrPrl1Pqk7L/AHtsZgRT3wd4HTJ614Vqf/Bx5+1Tf3rSQ+LfD9jG3SGDw5aMi/TejN78k18KUV+rYbgrI6EeWGGg/wDEuZ/fK58LW4kzOq7yrSXo7flY
+7tD/wCDkD9qfStQSafxR4a1KNesFz4dtVjbkHny1Ru2OGHB9cEe+/Av/g648ZaRPDD8SPhf4d1yDISS78PXkunTIvd/Km85Xb2DxgnuBxX5KUUsVwTkdePLPDRX+Fcr/wDJbBR4kzOk7xrSfrr+dz+pT9ib/grR8E/29DFZeDfE32HxMyb28O6ygs9TAAydiZKTYGcmF3AA5xX0xX8bek6tdaFqdve2NzcWd5ZyLNBPbyGOWB1OVZWXBUggYIwQea/cL/gh3/wXKu/j1rem/B34yaisvi64xb+HPEc5C/20QMC1uTx/pJx8kn/LU/Kf3mDJ+ScXeGs8BSljctbnTWri/iS7rul10ut9dWffZDxjHEzWHxiUZPZrZ+Xk/wAGfrFRRRX5OfdH8dnxG/5KJr3/AGEbj/0a1Y1bPxG/5KJr3/YRuP8A0a1Y1f2xT+Bei/I/m+p8TP64P2K/+TOPhN/2Juj/APpFDXplfyt+GP8AgrV+0h4L8Nafo+lfF7xdY6XpNtHZWdtHMmyCGNAiIvy9FUADnoK0P+HyH7UH/RavGf8A3+j/APiK/BsR4S5jUqyqKtDVt/a6v0P1Cjx3hIQjB05aJLp/mf1KUV/LX/w+Q/ag/wCi1eM/+/0f/wARR/w+Q/ag/wCi1eM/+/0f/wARWP8AxCHMv+f0P/Jv8jT/AF+wf/PuX4f5n9SlFfy1/wDD5D9qD/otXjP/AL/R/wDxFH/D5D9qD/otXjP/AL/R/wDxFH/EIcy/5/Q/8m/yD/X7B/8APuX4f5n9SlFfy1/8PkP2oP8AotXjP/v9H/8AEV+6H/BD39sXxh+23+wpY+KPHlzBqHiXS9YutFuL+OJYW1BYlikSV0QBFfbKFO0AHZnAJNeBxJwDjcnwqxdacZRulpe6vtul2PWyfinDZhW9hTi4u19bfo2fYlFFFfCn0x/Nt/wcW/8AKVrxx/2DtJ/9IIa+HK+4/wDg4t/5SteOP+wdpP8A6QQ18OV/
XvCv/Ilwn/XuH/pKPwDPP+RjX/xy/Nn9MH/Bvz/yiJ+Ef/cY/wDT1f19K/tE/AjQv2mvgd4o8A+JYftGieKtPksLjCgtFuHySpnpJG4V1PZkU9q+av8Ag35/5RE/CP8A7jH/AKer+vsyv5g4gqTp53ialN2aqzafZqbsz9qymEZ5bRhJXThFP/wFH8hP7SPwC179lr47eKvh94mh8jW/Cl+9jPtB2TgcxypnnZIhSRSeSrqa42yvZtNvYri3llt7i3dZIpY3KvE4OQykcgg4II5B5FftN/wdBfsGjW/DGh/H7w9Zs15pfl6J4pES/ft2JFrdNj+45MLMckiSEcBK/FWv6c4XzyGb5bTxa+Jq0l2kt16PdeTR+MZ3lssBjJUHtun3T2/yfmmf1Jf8EmP25If2+/2MvDvi64lj/wCEp00f2N4khUj5L+FV3SAcYWZCkoA4AkK5O019NV/OD/wb9/t5r+x/+2Za+G9cvzbeB/icY9HvzI37m0vdx+x3J9MSMYmYkALOzH7gx/R9X868ccP/ANk5nKnBfu5+9D0e6/7denpZ9T9c4Zzb69glKT9+OkvXv81r63CvM/21P+TOPiz/ANibrH/pFNXpleZ/tqf8mcfFn/sTdY/9Ipq+ZwP+9U/8S/NHs4r+DP0f5H8j9emfsWf8nj/CX/sc9H/9Loa8zr0z9iz/AJPH+Ev/AGOej/8ApdDX9kY7/dqn+F/kfzzhf40PVfmf1wUUUV/Fp/RoV+G//Bzl+35deM/inp3wE8P3jJovhURan4lMT8Xl/IgeCBsfwwxMHxnBeYZAMYNftl428XWPgDwdq2vanJ5Gm6JZTX93J/zzhiRpHb8FUmv5Evjj8WtT+Pfxk8U+NtaZn1TxZqtzq1zlywR5pGfYD/dXdtUDAAAAAAAr9U8KcljisfPHVVdUUrf4pbP5JP0bTPh+OMylRwscNB61N/Rf5tr5XOWr6y/4JVf8EofFf/BS34k3AiuJfDvw/wDD
8irrevtDvIYjcLW2U8POwwTk7Y1IZskoj/LPh3QLzxXr9jpenW8l5qGp3EdrbQRj555HYKiD3LED6mv6wP2F/wBk7R/2J/2WPCPw50eOHdolmh1G5jXH9oXzgNcTnud8hbGeQoVeiiv0rj/iqeT4OMMP/FqXS8kt366pLzd+lj43hXI45hiHKt8ELX829l/n/wAE5H9mP/gk78Af2TdGtoPDHw38P3mowAbtY1q2TU9SlbHL+dMCY89SIgi56KK+hrCwt9LtEt7WGG3t4+EjjUKqd+AOnfpViiv5rxWNxGKn7TEzc5d22/zP2TD4alQjyUYqK8lYx9S8B6HrU0kl5ouk3cs3EjTWkcjSDGOSQc8cc1xXij9jP4P+NU2618Kfhrqy4C4vfDFlccA5A+aI9Dk/WvTaKzp4itT1pza9G0VOjTn8UU/keZ/Bb9jz4Vfs461eal4D+Hfg3whqGoReRc3Wk6TDazSx5DbC6qDs3AHbnGQDjgV6ZRRU1q1SrLnqycn3bu/vYU6cKceWmkl5aH59/wDBwt+37cfsi/slp4R8N6g1n43+KBl06CSFys2n6coH2q4Ug5Vm3pEp4P712U5j4/nXr7Q/4L8ftHzftC/8FLvGtuly02keAvL8LaenaE24zcj0z9qe4GeuAoPQAfF9f1JwDkkcuyinp79RKcn11V0vkrL1v3PxPirMpYvHz192Hur5bv5v9Duv2a/2b/F37Wnxo0TwF4H01tU8Q65L5cSFtkVuijc80r9EjRQWZjnAGACSAf3q/YY/4N3fgv8As1+HLG++IGmW3xV8aMivczarGW0m2k6mOC0PyOg6bpw5bGcJkqOd/wCDaz9h+z+B37JknxX1SxX/AIS34oFmt5ZF/eWmkxSFYo1/u+bIjTMQcMvk5Hyiv0qr8v4+44xdXFzy/AzcKcHZuLs5Nb6rWyellvq3fS323C/DNCFCOLxUVKctUnqkumnd736HP+Cfhf4Z+Gtmtv4d8O6F
4ft408tYtN0+K1RV44AjUDHyjj2HpWL8T/2a/h78bNOms/GHgXwj4nt7jJddT0mC6OW6sC6khu+4EEHnINd1RX5ZGvVjP2kZPm73d/vPtpUoOPI0rdrH5K/8FIv+Darwt4r8Maj4s/Z/Enh3xFaxtcP4UuLhpbDU8DJS3lkJeCU84V2aMkqP3Qya/EjX9BvvCuuXul6pZ3Wn6lps8lrd2txE0U1tKjFXjdGwVZWBUqQCCCCM1/ZDX4Y/8HQX7ENj8NPin4a+NmgWa21l44kOkeIFjQLH/aMce+Gb/fmhSQN0ybbdyWJr9p8OuNsTWxCyvMJ83N8EnvdK/K31ur2b1vp1Vvzvi3hujTovG4WPLb4ktrPql08+ltT8t/AvjrWPhl400rxFoGoXWla3od3Ff2F5A22W1njYOjqfUMAecj1BFf1P/wDBN/8AbJsf28f2QfCfxEtxHDqV5AbPW7ROlnqMOEnQDJwrNiRMnPlyITgkiv5Sq/XD/g1Q/aSm0j4p/Eb4TXdwxstbsI/EumxM2EiuIGSC4Cj+9JHLCT7W3sc/SeJ+RwxeVvGRXv0db9XF6SX6/J9zxuC8ylQxv1dv3amnz6P9Pmft5RRRX82n7Cfgj/wdCftX3HxH/av0P4UWN439i/DrTo7u+gU4D6jdoJMsP4tlsYNpOcGWQcZOfzBr3T/gp14/k+J3/BQ/41avJIZlfxjqVrC5z80MFw8EXBAP+riTjGR07V4XX9fcL5fDBZVQw8FtFN+rV3+LZ+AZ3ipYjHVasusnb0Wi/BH0F/wTo/4Jz+Nv+Cj3xp/4RnwuF03R9NVZ9d125jL2ukQMSFyBjzJX2kJGCCxBJIVWYfvd+yN/wRH/AGe/2SdDtRD4J07xt4hjCmbW/FEEeozySDndHE6+TDg5x5aBgMAsxGab/wAEPv2WLH9lz/gnV4BSO1ji1zxvZR+KdXnKbZJpLtBJCrdx5duYY9vYqxwCTX19X4PxtxtjMbjKmFw0
3CjBuNk7c1tG21q03strW0ufqHDfDeHw+HjXrRUqkknqr2v0X6ve/kcjqfwJ8Ea5pC6de+DfCt5YKuxbafSbeSFRjGAhQjGCRj0OK+Hf+Chf/BvV8Jv2lPBmpar8MtH034Z/ECONpbT+z0MGj6g4yRFPbL8kSsePMhVSuQSrhQtfohRXxuW53jsBWVbC1XFrzdn5NbNep9DjMtwuKpunXgmvTVej3R/HP468E6t8NPGmreHdesLjS9b0K7lsL+znG2W1nicpJG3bKsCOMjjisuv0S/4OaPgTafCz/goZb+JLC3WC3+IPh+21S5KIVVruJntpMdsmOKFiRyS5JGTk/nbX9aZJmSzDAUsalbninbs+q+Tuj8HzPBvCYqeHf2W18un4F7wx4Y1Lxt4k0/R9IsbrUtW1S4jtLO0t4zJNczSMFSNFHLMzEAAcknFfuP8A8E5f+DbDwX8OvDml+KPjwjeLvFVwiT/8I3FcFNJ0skAhJmjIa4kXgNhhFnIxIMMfmr/g13/ZXsfit+1L4s+JWrWsd1b/AA00+GHTVlTKpf3pkVZVJ4JjhhmHqDKh4IBr97K/JfEjjLFUMT/ZeBk4cqXPJaO7V0k+itZu2utumv3vB/DtCrR+vYmPNd+6ntppdrrrscN4I/Zq+HXwy0ddP8OeA/Bug2Krt8jT9GtrePHuEQDufzNeYftIf8Er/gH+1N4euLPxN8M/DMN1Im2PVNIs003UYDgYKzwhWbbgYV9ydipBIP0RRX47RzHF0avtqVWSl3Td/vufoFTB0KkPZzgmuzSsfy8f8FW/+CY+u/8ABNH45W+jy3k2ueC/Ekcl14d1l49jzohAkglA4E8W5N235WV0YAbii/LVf0g/8HE/wKtPjD/wTL8Uaq1usuqeAb2016ykCZdAJVt5hkc7fJnkYjplFJ6Aj+b6v6d4D4gqZtlarV/4kW4yfdqzT+aav0vex+L8UZXDAY106XwyV15X6fJr7j9kv+DVb9q6
6nuviB8F9Ru5JLaGFfFOiRu5PkYdILyNc8YYvbOFGMHzGwSxI/Zqv5n/APg398ezeBv+CrXw1VZCtvri6hpdyAfvrJYzsg6j/lqkR79MAZxX9MFfjXihl8MNnbqQVlUipfPWL+/lv8z9D4KxUq2WqEvsNr5aNfnYK+FP+C+X7f1x+xT+x8+keHb9rPx58SWl0nSpon2zWFsFBu7tSCCGVHWNWHKvMjD7pr7rr+cL/g4t/aNm+OP/AAUk13RIZvM0j4b2Nv4ftVVvlMu3z7lsf3xLM0ZPcQr6Vw+H+SwzLOIRqq8Ka52u9rWX3tXXVXOrirMpYPASlB2lL3V89391/mfCFdx+zh+zl4u/ay+Mmi+A/A+lyat4i1yYxwx52xwIBl5ZX6JGi5ZmPQDgEkA8PX76f8GzP7Ftj8I/2U7n4ualZqfFHxKmkhsppE+e10uCUxqi9x5sySOx43KsRxgAn+gOLuII5Nl0sXa8m+WK7yffySTb72t1PynIMpeYYtUNo7t+S/z2Os/Yb/4N1vgv+zf4dsdQ+IWnW/xU8abRJcS6krf2RbORykNr92RRyN04cnqAmcD7o8EfCbwr8NLZIPDnhnw/4fhjBCR6bp0Nqi5ABwI1AHQD8BXSUV/LuZZ1jswqOpi6rk33ei9Fsl6I/bMHluGwsFDDwUflr83uzmfHXwd8I/E+0kg8TeFfDniKCbAkj1PTYbtHwMDIkUg+nPavg39vT/g3O+EP7RHhm81L4X2Nr8LfGygyQLab/wCxr5gOI5bfJEIOAN8AXbySjniv0Yop5ZnmPy+oqmEqyi10vo/VbNeoYzLcLi4OFeCfy1+T3R/H38afgv4m/Z5+Ket+C/GGlz6L4k8PXLWt7aS4JRhyCGGQyMpDKykhlYEEgg1zunajc6RqNveWdxNa3drIs0E8LmOSF1OVdWGCrAgEEYIIzX7Q/wDB07+x/Z3fhHwb8btLtRHqFncr4Z11o0/18Lh5bWV8f3GWWMsc
kiWMZAUCvxYr+p+GM7jm+WwxlrN6SXaS0a9Oq8mfiGdZbLAYuWH3S1T8nt/l6n9Q/wDwSB/bn/4b5/Yr0DxRqE0L+LtFY6J4ljX5f9NhVT52PSaNo5eAAGd1H3TRX5ff8Gsn7Qsngv8Aaw8ZfDm4mZdP8c6GL+3jJyDeWT5GB2zBNOSR18tQc4GCv5t42yaOW5vVoUlaD96PpLW3yd0vQ/X+G8weMwEKs9ZLR+q/zVn8z80viN/yUTXv+wjcf+jWrGrZ+I3/ACUTXv8AsI3H/o1qxq/q6n8C9F+R+G1PiZrQfD/XrmFJI9E1iSOQBlZbORlYHkEHHTvkU/8A4Vz4i/6AOs/+AUv/AMTX9Y/7Ff8AyZx8Jv8AsTdH/wDSKGvTK/F63i9OnVlT+qp2bXx9v+3T9GpcAxnBT9vuk/h/+2P47P8AhXPiL/oA6z/4BS//ABNH/CufEX/QB1n/AMApf/ia/sTorH/iMU/+gRf+B/8A2pp/xD2P/P8A/wDJf/tj+Oz/AIVz4i/6AOs/+AUv/wATR/wrnxF/0AdZ/wDAKX/4mv7E6KP+IxT/AOgRf+B//ah/xD2P/P8A/wDJf/tj+Oxfht4idwq6BrTM2AALGTn/AMdr+iX/AIN3vgb4s+BP/BOq1s/F2h6h4fvtc8QXmr21pewtBcC2kSGNHeNgGTcYmYBgCVKt0YV93UV81xV4g1M5wawfsVBXTb5ubb5K34nsZHwnDLsR9Y9o5O1trb/NhRRRX50fXH823/Bxb/yla8cf9g7Sf/SCGvhyvuP/AIOLf+UrXjj/ALB2k/8ApBDXw5X9e8K/8iXCf9e4f+ko/AM8/wCRjX/xy/Nn9MH/AAb8/wDKIn4R/wDcY/8AT1f19mV8Z/8ABvz/AMoifhH/ANxj/wBPV/X2ZX8ucS/8jjF/9fan/pTP23Jf+RfQ/wAEf/SUc18Wvhbovxu+F/iDwf4jtVvtB8TafNpt9B0LxSoUbB7MAchhyCARyBX8
o37ZH7L2tfsZ/tMeLvhvrpaa78M3zQw3OzYt/bMA8Fwo5wJImR8ZOCSCcg1/W9X5U/8ABzf+wX/wtH4L6V8bvD1ira54EAsPEHlJ+8utLkf93Ke7eRM3QdEnkJOEFfYeGXEH1HMPqdV/u61l6S+y/nt812Pn+M8p+s4T6xTXvU9fWPX7t/v7n4UqxjYMpKspyCD0r+m//gip+3gf27v2J9G1LVrpbjxt4RI0HxGC2ZJ5o1HlXRB5/fRbXLcAyCUDha/mQr7G/wCCH37eK/sM/tr6XNrF41v4I8cqmg6+WbEduruPIu27YhkI3N1Eby4BJAr9a8QOHv7UyyXs1+8p3lHu+6+a/FI+D4Vzb6ljUpv3J6P9H8n+DZ/TNXmf7an/ACZx8Wf+xN1j/wBIpq9MrzP9tT/kzj4s/wDYm6x/6RTV/MuB/wB6p/4l+aP2fFfwZ+j/ACP5H69M/Ys/5PH+Ev8A2Oej/wDpdDXmdemfsWf8nj/CX/sc9H/9Loa/sjHf7tU/wv8AI/nnC/xoeq/M/rgooor+LT+jT5h/4LNfEFvhl/wS7+NGpRuEa40A6SSTjIvZo7Mj8ROR75r+XGv6TP8Ag4j1KWy/4JO/EKONgqXd5pMMvy5yo1K2f8PmRTn2xX82df0R4R0kspq1OrqP8Ix/zZ+ScfVG8dCHaC/Fs+nP+CMnwyh+Lf8AwVC+DOk3Cq8MGu/2sVYAgmxglvR16824/wAD0r+pCv5tf+DdFQ3/AAVb8DEgfLp2rEcdP9Amr+kqvi/FytJ5tTp9FTX4yl/kj6PgKmlgJy6ub/BIKKKK/Kz7gKKKKACoridLWFpJGWOONSzuxwFA5JJ9KlrmfjLq66B8IPFd86NItno95OyjqwSF2I/SqhHmko99CZS5Ytn8jXxd8fzfFX4r+JvFFwXNx4k1a71WUuPmLzzPKc8nnLn1+prAtLSS+uo4YY2lmmcJGijLOxOAB+gxTa679n21jv8A49eCYZo1lhm1
+wjkRhlWU3EYIP6jFf2pK1Kl7q0ivyR/Ocb1J67t/mf1p/BL4ZWvwW+DfhPwfYpGln4W0e00mJY/u7YIUjGP++evWuroor+K6lSU5Oct27s/oyMVGKjHZBRRRUlBXxv/AMF6/hLH8Wf+CWnxKUxeZeeHY7XXrRtu7ymt7mMyNj/rgZlz2DZ5xg/ZFeH/APBSzTItV/4J3/HWObcVXwDrkwwcfNHYTOv/AI8or1Mjryo5jh6sd4zi/wDyZHDmdNVMHVg+sZfkz+UOvr3/AIIO/ECX4e/8FVfhVKsjiDVLi80qdF/5arPZzooPsJCjfVB2r5Cr37/glQxX/gpL8D8EjPjLThx7zrX9ZZ9SVTLcRTls4TX/AJKz8JyubhjKUl0lH80f1XUUUV/HJ/Qh/I/+2n/yeP8AFr/sc9Y/9Lpq8zr0z9tP/k8f4tf9jnrH/pdNXmdf2lgf92p/4V+SP5yxX8afq/zP69P2abaOz/Zz+H8MMaQwxeHNORERdqootYwAB2AruK4v9nL/AJN68B/9i7p//pNHXaV/GeK/jT9X+Z/RFD+HH0QUUUVian4a/wDB2H/ycN8Jf+xdu/8A0pFfk7X6xf8AB2H/AMnDfCX/ALF27/8ASkV+Ttf1ZwD/AMiDDej/APSmfhnFX/I1req/JH7h/wDBp3bRr8BPi3MI185/EFmjOANzKLZiAT1wNzYB6ZPrX601+Tf/AAad/wDJvfxa/wCxitP/AEmNfrJX4Hx9/wAj/E+q/wDSYn6nwr/yKqPo/wA2FFFFfHn0B8y/8Fkf+UX/AMaP+xek/wDRiV/LbX9SX/BZH/lF/wDGj/sXpP8A0Ylfy21/QXhD/wAi2t/j/wDbUfk/H/8AvlP/AA/qz6Y/4I3/APKUD4K/9jFH/wCi3r+pSv5a/wDgjf8A8pQPgr/2MUf/AKLev6lK+V8Xf+RlR/wf+3M9zgH/AHOp/i/RBX8i/wC1748f4oftXfEzxJJJ5ja94r1O/wB2
7cMS3crjBwOACAOAMAYAHFf10V/HZ8Rv+Sia9/2Ebj/0a1eh4O006uKn1Sgvvcv8jn8QZP2dCPnJ/db/ADMav65P2QvhvD8H/wBlT4a+FYVVF8PeGNNsDtAG5o7aNWbgnlmBYnJySTk9a/kbr+hC3/4OeP2abWFY49P+JUccYCqi6HbqqgdAB9o/lXveKWV4/HU8PSwVJzScm7K9vhSv+J5PBGOwuGnWniZqLailfrvf9D9HKK/Oj/iKA/Zt/wCfH4mf+CSD/wCSKP8AiKA/Zt/58fiZ/wCCSD/5Ir8f/wBTc8/6BZ/cfoH+sWWf8/4/efovRX50f8RQH7Nv/Pj8TP8AwSQf/JFH/EUB+zb/AM+PxM/8EkH/AMkUf6m55/0Cz+4P9Yss/wCf8fvPZ/8Agt98P4/iJ/wSx+L9m0bSSWOmRarGQu5kNrdQ3GR6fLGwJ9Ce1fzB1+4H7b3/AAcNfAX9oX9kL4leBdBs/iAmteLPD15pdi11pMMcAmliZF3sJyVXJGSASPQ1+H9ftnhjluNwOAq0cbTcHz3Sem8Un+R+b8aYzDYnFQqYeal7tnb1f+Z9Sf8ABFHx43w7/wCCpfwbvkkMf2rWX0tv9oXdvNbYPB/57Dr0ODkYyCuZ/wCCVP8Aykk+B/8A2OWm/wDo9aK+G8Xqa/tGhNbuFvuk/wDM+m4Bk/qdSP8Ae/RHjXxG/wCSia9/2Ebj/wBGtWNWz8Rv+Sia9/2Ebj/0a1Y1fv8AT+Bei/I/K6nxM/rg/Yr/AOTOPhN/2Juj/wDpFDXpleZ/sV/8mcfCb/sTdH/9Ioa9Mr+Mcd/vNT/E/wAz+icL/Bh6L8gooorlNwooooAKKKKACiiigD+bb/g4t/5SteOP+wdpP/pBDXw5X3H/AMHFv/KVrxx/2DtJ/wDSCGvhyv694V/5EuE/69w/9JR+AZ5/yMa/+OX5s/pg/wCDfn/lET8I/wDuMf8Ap6v6+zK+M/8Ag35/5RE/CP8A7jH/
AKer+vsyv5c4l/5HGL/6+1P/AEpn7bkv/Ivof4I/+koKx/G/gzS/iN4N1bw/rVnDqGj67ZzaffWsoylxBKhSRGHoysR+NbFFeNGTi1KO6PRlFNWZ/J7/AMFCf2PtT/YX/a28XfDu/W4ay025Nxo93Kv/ACENOlJa3mz0J2fK23IEiOucqa8Vr+gD/g5O/YM/4aA/Zht/ivodr5nij4WRvJfLGmZLzSXYGbP/AFwb98M8BDMepFfz/wBf1jwbn6zfLIYiT9+Puz/xLr81Z/O3Q/CeIsreAxkqS+F6x9H/AJbH9Iv/AAQN/bz/AOGy/wBi6z0fWr/7V46+Gvl6Nq3mPma6t8H7JdHud8amNmJJLwSE9RX03+2p/wAmcfFn/sTdY/8ASKav5v8A/gkH+3TL+wR+2n4f8S3k7R+EdcI0TxLHu+UWUzr+/wAf3oZAkvAyQjrkbzX9HX7ZNzHefsY/FaaGRZYZfBerujo25XBsZiCD6HrxX4nxpw9/ZmewnTVqdWSlHyd1zL5PVeTR+k8O5t9cyyUZv34Jp+ato/mvxTP5Ja9M/Ys/5PH+Ev8A2Oej/wDpdDXmdemfsWf8nj/CX/sc9H/9Loa/ozHf7tU/wv8AI/IML/Gh6r8z+uCiiiv4tP6NPhn/AIOMP+UUvjj/ALCOlf8ApfBX83Nf0lf8HE9nLdf8En/H7xxsy299pMkhH8C/2jbrn/vpgPxr+bWv6M8Jf+RLP/r5L/0mB+Q8ef8AIwj/AIF+cj7j/wCDdL/lK14H/wCwdq3/AKQTV/STX823/Bul/wApWvA//YO1b/0gmr+kmvgvFr/kcw/69x/9KkfU8B/8i6X+N/lEKKKK/MD7UKKKKACuL/aN/wCTevHn/Yu6h/6TSV2lct8bNIPiD4M+LrBZBC15o15AHIzs3wOuce2c1th5JVYt91+ZnW1g15M/j8rsv2c/+ThvAf8A2MWn/wDpTHXG12H7PU6W/wAfvA8sjrHHH4gsGZmO
1VAuYyST7dcmv7QxP8GXo/yP51w/8SPqj+vyiiiv4pP6OCiiigArxf8A4KMf8o9/jt/2TvxB/wCm24r2ivEf+ClF9Hp//BPD46STOqK3w/12IE92fT50UfizAfjXdln++0f8UfzRy43/AHep/hf5H8oNe/f8Eqf+UknwP/7HLTf/AEeteA179/wSp/5SSfA//sctN/8AR61/Xmcf7jW/wS/9JZ+A5d/vVP8AxR/NH9V1FFFfxqf0QfyP/tp/8nj/ABa/7HPWP/S6avM69M/bT/5PH+LX/Y56x/6XTV5nX9pYH/dqf+Ffkj+csV/Gn6v8z+vj9nL/AJN68B/9i7p//pNHXaVxf7OX/JvXgP8A7F3T/wD0mjrtK/jPE/xper/M/oih/Dj6IKKKKxNT8Nf+DsP/AJOG+Ev/AGLt3/6Uivydr9Yv+DsP/k4b4S/9i7d/+lIr8na/qzgH/kQYb0f/AKUz8M4q/wCRrW9V+SP3I/4NO/8Ak3v4tf8AYxWn/pMa/WSvyb/4NO/+Te/i1/2MVp/6TGv1kr8D4+/5H+J9V/6Sj9T4V/5FVH0f5sKKKK+PPoD5l/4LI/8AKL/40f8AYvSf+jEr+W2v6kv+CyP/ACi/+NH/AGL0n/oxK/ltr+gvCH/kW1v8f/tqPyfj/wD3yn/h/Vn0x/wRv/5SgfBX/sYo/wD0W9f1KV/LX/wRv/5SgfBX/sYo/wD0W9f1KV8r4u/8jKj/AIP/AG5nucA/7nU/xfogr+Oz4jf8lE17/sI3H/o1q/sTr+Oz4jf8lE17/sI3H/o1q9Lwd+PF+kPzkcviF8ND/t7/ANtMaiiv6j4P+CO37Ll1CskfwZ8FSRyAMrLE7KwPIIO/8civ0biji/DZH7L6xCUvac1uW2nLbe7Xc+PyPh+tmfP7KSjy2ve/W/ZeR/LhRX9SX/Dm79l//oi/g3/vxJ/8VR/w5u/Zf/6Iv4N/78Sf/FV8l/xF7Lf+fNT/AMl/+SPe/wBQMZ/z
8j+P+R/LbRX9SX/Dm79l/wD6Iv4N/wC/En/xVH/Dm79l/wD6Iv4N/wC/En/xVH/EXst/581P/Jf/AJIP9QMZ/wA/I/j/AJH8ttFf1Jf8Obv2X/8Aoi/g3/vxJ/8AFUf8Obv2X/8Aoi/g3/vxJ/8AFUf8Rey3/nzU/wDJf/kg/wBQMZ/z8j+P+R/Pf/wShs5b3/gpR8EEhjkldfGFhIVRSxCrKGY8dgoJJ6AAk8Civ6QPgf8A8E8/gj+zX4zXxF4F+GPhPw7ryRtDHqFvZhrmFGBVgjuSU3KSDtIJBIORxRX5hxxxTRzvFU61CDjGMba2u9b9GfbcNZLUy2hKnVkpOTvpe34n8rfxWsptL+KPiS1uEMc9vql1FIhP3GWVwR+eelYNeo/tweB5vhn+2Z8WPD827zNI8X6rbAsc+Yq3cuxs4HDLhs4GQc4HSvLq/qDC1FUoQqLqk/vR+J4iLhUlF9G0f1wfsV/8mcfCb/sTdH/9Ioa9Mr55/wCCUnxNtfi5/wAE3vgrrFrObgQ+E7HS53aTzGM9nGLObcf73mQPnPOetfQ1fxzmdOVPGVact1KSfybP6EwU1PD05LZxX5BRRRXCdQUUUUAFFFFABRRRQB/Nt/wcW/8AKVrxx/2DtJ/9IIa+HK+4/wDg4t/5SteOP+wdpP8A6QQ18OV/XvCv/Ilwn/XuH/pKPwDPP+RjX/xy/Nn9MH/Bvz/yiJ+Ef/cY/wDT1f19mV8Z/wDBvz/yiJ+Ef/cY/wDT1f19mV/LnEv/ACOMX/19qf8ApTP23Jf+RfQ/wR/9JQUUUV4p6RT1fSLXXtKubG+t4byzvImgngmQPHPGw2srKeGBBIIPBBxX8s//AAVN/YivP2B/2yvE3goRS/8ACPXMn9reG53JPn6dM7eUMn7zRlXhYnq0THoRX9Ulfn5/wcM/sGD9q/8AY7m8ZaHp7XHjb4WiTU7byVLS3unsB9rgwPvbVVZl6kGFguC5z994dcQ/2bmao1X+
7q2i/J/Zf36Pyb7HyvF2U/XMH7SC9+nqvTqv19UfzrV+6H/BKT9vL/hp/wD4I/8AxY+H+uXjTeMvhT4K1OwJlbMl5pbWM4tJAepMYUwN6COMk5evwvr0v9lj9p7XP2VvHeravo5Mlv4i0HUPDeq2pbat3Z3kDROp90YpKvbdEueM1+88VZDHNMGqa+OElKL809vmrr7n0Py/I80eCxDm/hkmn6Pr8nr+HU80r0z9iz/k8f4S/wDY56P/AOl0NeZ16Z+xZ/yeP8Jf+xz0f/0uhr28d/u1T/C/yPMwv8aHqvzP64KKKK/i0/o0+Wv+C1fgOT4k/wDBLX4z6dFE0zW2iJqpVc/ds7mG8Zuo+6sBP0HQ9D/LxX9h3xK8BWPxU+HHiDwvqgZ9N8SabcaXdgdTDPE0Tgf8Bc1/Ij8WPhrqfwb+KHiPwjrUXk6x4X1O50m9j7LNBI0b49tyn6jmv3jwfx0XhsRhOqkpferP/wBJR+X+IGFarUsR0aa+53/U+hv+CJnxHh+Fv/BUz4OahPKsUV5rEmj5c/KzXttNZoPqXnXHviv6hq/jl8G+LNQ8BeLtL13SbiSz1TRbyG/s50+9BNE4dHHuGUH8K/rP/ZF/aT0X9rz9m7wf8RtBkjax8UadHcyQq+82VxjbPbsf70UodD7pkZBBrzfF7L5qvQx6XutODfZptr77v7js4AxkXTq4V7p8y+ej+6y+89Looor8ZP0QKKKKACobu0jv7SWGaNZYZkKSI3KspGCD7HmpqKAP46/iJ4MuPhz8QNd8PXe5brQtRuNPmDLtYPDI0bZHY5U8dqzdN1GbSNRgurdvLntpFlibAbaynIODkcEDg5FfXP8AwXa/Z5m/Z6/4KZ/EKNbfydN8ZTr4qsHAwJkuwXmP4XQuF4z93PfA+QK/szK8ZHGYOliY7Tin96P53x2Hlh8ROi94tr7mf2FfCn4g2fxa+F/hvxVp/wA2n+JtLtdVtiDnMc8SSpz3+VxXRV+e
P/BuT+2jZ/tD/sSWngG/u1Piz4Ut/ZskTyZkuNOcs1rMB/dRSYMDgeShONwr9Dq/kfOstnl+Oq4Oovgk0vNdH81Zn71luMjisLDEQ+0l9/VfJhRRRXlncFfIf/BdP4pw/Cr/AIJa/FSd5hHca3ZwaJbJuw0z3VxHE6jn/nkZWPsp4PSvryvxO/4Olf21bXxL4o8J/AvRbpZv+EekXxF4j2NkR3LxFLSA9wywySSMDkETxHscfVcF5ZPHZzQpxWkZKT8lF3/F2Xqzw+IsZHDZdVm92uVer0/4PyPyEr60/wCCF/gKT4hf8FU/hJbqjNHp99c6pK3aNba0nmBPB/iRV+rAZHUfJdfq9/waq/s7TeJPj98QPihdW7Gw8L6QmhWUjr8rXV1Isjsp/vJDBtI7C4HHIr+juMMbHC5Liar/AJGl6y91fiz8g4fw7r5jRgv5k/ktX+R+51FFFfyOfvZ/I/8Atp/8nj/Fr/sc9Y/9Lpq8zr0z9tP/AJPH+LX/AGOesf8ApdNXmdf2lgf92p/4V+SP5yxX8afq/wAz+vj9nL/k3rwH/wBi7p//AKTR12lcX+zl/wAm9eA/+xd0/wD9Jo67Sv4zxP8AGl6v8z+iKH8OPogooorE1Pw1/wCDsP8A5OG+Ev8A2Lt3/wClIr8na/WL/g7D/wCThvhL/wBi7d/+lIr8na/qzgH/AJEGG9H/AOlM/DOKv+RrW9V+SP3I/wCDTv8A5N7+LX/YxWn/AKTGv1kr8m/+DTv/AJN7+LX/AGMVp/6TGv1kr8D4+/5H+J9V/wCko/U+Ff8AkVUfR/mwooor48+gPmX/AILI/wDKL/40f9i9J/6MSv5ba/qS/wCCyP8Ayi/+NH/YvSf+jEr+W2v6C8If+RbW/wAf/tqPyfj/AP3yn/h/Vn0x/wAEb/8AlKB8Ff8AsYo//Rb1/UpX8tf/AARv/wCUoHwV/wCxij/9FvX9SlfK+Lv/ACMqP+D/ANuZ7nAP+51P8X6I
K/kV/a58EP8ADP8Aar+JnhySPym0HxXqmn7MbdvlXcqDAyePlHQkY6Ejmv66q/mv/wCDhL4ByfA//gpx4wvEh8rTPHltbeJbM4+8ZY/KnyemftEMzY6gMv1NeEWMjDMK2Gf243XrF/5Nv5Bx9h3LC06y+zK33r/gHxHX9dX7Kfj6H4sfsw/DnxRbyLJD4g8M6dqKsowP3trG547Y3YwRkEY4xX8itf0Lf8G2n7YFn8cv2Ho/h9eXiN4n+Flw9k0LsPMm0+Z3ltpQP7qlpIeOghTPLDP1Xi3l862XUsXBX9nLXyUtL/ekvmeDwFi408XOhL7a09V/wGz9FqKKK/ns/WgooooAKKKKACiiigD+eL/g5T/ZYuvgr+3tJ45gtWXw/wDFSxj1CKZVxGl7bxpBcxf72FhlJ7m49jj88K/qr/4KRfsD+H/+CiX7NOpeBtYkTT9Whf7doOreXvfSr1QQr46tGwLI691YkYYKR/Mh+0n+zP42/ZI+LOoeCfH2h3Wg69ppBMcmGiuIznbNDIMrJG3OHUkZBBwQQP6W8OeJaWPy6GDm/wB7SVmuritE18rJ+fqj8b4uyaeFxcsRFe5N3v2b3T+eqPsr/gi//wAFrG/4J6RXngTxzp+oa38M9YvDeRSWWHvdAuXCq8iIxAkhfapaPIIILLkllf8AaX4N/wDBU79nf48aZFc+HfjD4GLTAbbXUdSTS7z/AL8XPly/kpH5iv5VKK14h8OcuzSu8UpOnUlu1Zpvu0+vo1566meU8X4vBU1QaU4ra+68k+3qmf2DaR8Y/COvQtJY+KvDd5Gh2s0GpQyKp64yGP5Vc/4WP4f/AOg9ov8A4Gx//FV/HbRXyz8HKd9MW/8AwD/7Y9z/AIiFLrQX/gX/ANqf2Jf8LH8P/wDQe0X/AMDY/wD4qj/hY/h//oPaL/4Gx/8AxVfx20Uv+INw/wCgt/8AgH/24f8AEQpf8+P/ACb/AO1P7Ev+Fj+H/wDoPaL/AOBs
f/xVaVhf2+qWiXFrNDcW8nKSRsGV+3BHXv0r+Nuv6GP+DYq/uLz/AIJrTRyTzSR2vi/UYoVdiwhQxWz7VHRV3OzYHGWY9STXzHFnh6smwP1yNfn95K3Lbe/XmfY9rIeLHmOJ+ruly6N3vfb5I/RSiiivzU+yP5tv+Di3/lK144/7B2k/+kENfDlfcf8AwcW/8pWvHH/YO0n/ANIIa+HK/r3hX/kS4T/r3D/0lH4Bnn/Ixr/45fmz+mD/AIN+f+URPwj/AO4x/wCnq/r7Mr4z/wCDfn/lET8I/wDuMf8Ap6v6+zK/lziX/kcYv/r7U/8ASmftuS/8i+h/gj/6SgooorxT0gpkkazxsjqrKw2srDIINPooA/mA/wCCyf7CX/DBX7a+uaHptu0Xg3xLnXfDbBfkitZXbfbD3gkDxgHJ2CNj96vlKv6Vv+C637Bp/bb/AGKtRuNHs1uPHHw98zXdE2rmW6RU/wBJtBxn95GMqo6yRRDIGTX81Nf1PwHxD/auWRlUd6lP3Zd9Nn81+Nz8P4oyn6jjWor3Jax/VfJ/hYK9M/Ys/wCTx/hL/wBjno//AKXQ15nXpn7Fn/J4/wAJf+xz0f8A9Loa+rx3+7VP8L/I8LC/xoeq/M/rgooor+LT+jQr8Hf+Dmj9g66+Fvx9svjdodmzeG/H2yz1oxx/JY6pEm1XYjgLPCgI7l4ZST8wFfvFXF/tA/Afwv8AtOfB3X/AnjLTY9V8O+IrY211ATtZe6yI3VZEYK6sOVZVPavpOFeIJ5PmMcWtY7SXeL3+a0a80ePnmVRzDCSoPR7p9mv89n6n8g9fbn/BHj/gsPq3/BN/xbdaBr9re+Ivhb4iuRPf2EDD7VpdxgKbu2DEKxKgB4yQHCoQwI+bgP8Agpl/wS58c/8ABN/4qyWWqwXGseCNTnb+wvEkMJFveJ1EUuMiK4VQdyHrgspZeR8xV/T1Wll+eZfyu1SlUXT+rpp+jT3PxWnPF5Zirq8Zxf8A
Xqn+J/Wx+zd+2n8K/wBrvw5BqXw78caB4lWWMSvaQXKpfWoPaa2bE0R4PDqOmRkc16pX8atpdy2NzHNBJJDNEdySRsVZCO4I/mK66P8AaJ+IEMaonjrxgqqMKo1q5AA9Pv1+W4rweTnfD4m0e0o3a+aaT+5H3FDxAfLatR18np9zT/Nn9flZviLxZpfhK0+0arqWn6Xb4J827uUhTA5JyxA4/Sv5DtU+OvjbXLXyb3xl4qvIc7vLn1a4kUEd8Fz6nmuYu7uW+uZJp5JJppTueSRizOT3JP8AM1nT8HZN/vMV90P/ALYqfiCvs0Pvl/8Aan9g3gj4u+FfibPeReG/E/h/xFLpzBLtNN1KG7a1Y9A4jY7CcHhsdK6Sv51f+DaG+ntP+CnFjFFNNFHdeG9SjmRHKrKoVGAYD7w3KDg8AqD1Ar+iqvzvi7h2OS4/6nGfOuVSva299N32PrshzZ5jhfrEo8ru1a99rf5n5sf8HIn7BF1+0j+zJY/Ezw3Zm58U/C0SzXkMS/vb3SZMGfH94wsqygHgJ52MkgH+fqv7J7iBLqFo5FWSORSrowyGB4II9K/A7/gtZ/wQ51b9mjxJqvxR+Euk3GqfDW+ke71PSbSLfN4VdjliqLy1pySrAHygCGwoDH9E8MeLqVOn/ZGMlbX3G9tdXH79V3u12PkONOH5zl9fw6v/ADJeXX7tH9/c+Gf2Pf2v/Gn7D3xz0vx94FvltdUsMxXFvKC1tqdsxBktp0BG6Nto6YKkKykMoI/oU/YZ/wCC3vwQ/bS8P2UMviKx8A+NJFC3Hh7X7pLdjJ3+zzttjuFPONpD4GWRa/mbor9A4n4LwOdJTrXjUWikt7dmuq+5roz5TJeJMTlzcafvQe8X+a7P+rH9k9vOl1CskbLJHIoZHU5DA8gg+lU/EvijTfBujzahq+oWOl6fbjMtzeTpBDGP9p2IA/E1/IJ4Y+LXirwRY/ZtF8TeINIt858my1Ga3jPJP3UYDuT9
SfWqvizx/rnjueOXXNa1bWJIRiN767kuGjHsXJI+gr89j4Oy5/exS5f8Gv8A6UfWS8Qly6UNf8Wn/pJ+9X/BST/g4o+Hf7Pfhq+8O/B2/wBO+Inj2UGFNQgBm0PSD3kaUEC5fGNqREpnJZxt2N+CfjjxvrHxL8Yap4h8QahdavrmtXMl5fXtzIZJrqZ2LPI7HqSSTWXU2nadc6vqNvZ2dvNdXd1IsMEEKGSSZ2OFRVGSzEkAAZJJxX6Zw7wtgckouGGV5P4pPd/5LyWnfufG5tnmJzGopVtlslsv83/WhL4f0G+8Va7ZaXptpcX+palPHa2ttAhkluJXYKkaKOWZmIAA5JIAr+pL/glX+xNH+wR+xb4X8D3AhbxFcBtW8RSxncs2ozhTIoPdY1WOFTxlYQcZJr42/wCCF/8AwRDvP2ctSs/jF8X9Nhj8aNF5nhzQJRubw+GBBubgdPtJU4VBnygST+8IEX6sV+P+JXF1LHzWXYOV6cHeTW0pdl3S77N+iZ+gcHZDPCxeLxCtOSsl1S8/N/ggooor8pPuj+R/9tP/AJPH+LX/AGOesf8ApdNXmdemftp/8nj/ABa/7HPWP/S6avM6/tLA/wC7U/8ACvyR/OWK/jT9X+Z/Xx+zl/yb14D/AOxd0/8A9Jo67SuL/Zy/5N68B/8AYu6f/wCk0ddpX8Z4n+NL1f5n9EUP4cfRBRRRWJqfhr/wdh/8nDfCX/sXbv8A9KRX5O1+sX/B2H/ycN8Jf+xdu/8A0pFfk7X9WcA/8iDDej/9KZ+GcVf8jWt6r8kfuR/wad/8m9/Fr/sYrT/0mNfrJX5N/wDBp3/yb38Wv+xitP8A0mNfrJX4Hx9/yP8AE+q/9JR+p8K/8iqj6P8ANhRRRXx59AfMv/BZH/lF/wDGj/sXpP8A0Ylfy21/Ul/wWR/5Rf8Axo/7F6T/ANGJX8ttf0F4Q/8AItrf4/8A21H5Px//AL5T/wAP6s+mP+CN/wDylA+Cv/Yx
R/8Aot6/qUr+Wv8A4I3/APKUD4K/9jFH/wCi3r+pSvlfF3/kZUf8H/tzPc4B/wBzqf4v0QV+df8AwcZ/sIz/ALUP7I8Pjzw/YvdeLfhSZb8xxLmS70xwPtaAdzHsSYZ6LHIACWr9FKayiRSrAMrDGCOtfnOT5pVy7G08bR+KDvbuuq+auj7DMMDDF4eeHqbSX3dn8nqfxq16v+xb+2P4y/YT+Pul/EDwTdJHqFiDBd2c5Y2urWrkeZbTKCNyNhTxyrKjAhlBH3j/AMFrv+CF+rfArxHrHxX+Dujyal4AvHe81fQbKItP4bc/M8kUY5a0yScLzCCRjyxlfy3r+rctzPAZ5gfaUrThJWlF9L7xkuj/AOHWmp+F4zB4rLMTyzvGUXdNdezTP6ZP2Jv+C4fwK/bJ8P2MM3iew8A+MJFAuNA8RXKWjCTpiC4fEU6k52hSJCOSi9K+w7a5jvoI5oZEmhlUOjo25XU8gg9CK/jYrc8L/E/xL4HhaPRfEWu6PHJ95bK/lt1PfojD61+c5l4Q4apUc8FXcE/syXN9zunb1u/M+vwfH1aMOXE0lJ907fhZ/hY/sQor+QX/AIaM+If/AEPnjL/wd3P/AMXWbqnxc8Wa1c+deeKPEF1Mwx5k2pTSOQPct+ledHwdq9cUv/AH/wDJHZ/xEGHSg/8AwL/gH9fPiHxZpfhS387VNT0/TIdrOHurlIFwvLHLEcDjPpXnHjT9vH4I/DtW/tz4vfDPS5FODFceJrNZc8cBPM3E4IOADwc9K/ktorso+DtFfxcU36QS/OTOWp4hVH8FBL1lf9Ef14fAf9pXwD+074Xm1r4feMNB8X6bbS+RPPpl2s32eTG7ZIo+ZGwQcMAcHPSivyk/4NIHJH7QC7vlB8OkD3/4mv8A9aivynijJ4ZVmlXAU5OSjaze+sVL9bH3OS5hPG4KGKkrOV9F5Nr9D9l68r/ao/Y0+Gv7angH/hHfiT4VsfEVlDua1mfMV5p7sBl4
J0IeM8DO04bADAjivVKK8ahiKtGoqtGTjJbNOzXo0elVpQqQcKiTT3T1R+MP7R//AAaj3AvJrv4R/E2FoWJMWmeLLYq0fp/pdup3fjAMY6nPHyb8QP8Ag3g/ar8DzuLXwHpviS3jJzcaTr9kynBABCTSRyHPoEJGDkCv6UKK+/wPifnmHiozlGp/ijr98XH8T5bE8F5bVd4pw9H/AJ3P5b73/gjH+1FYXUkMnwX8XM0ZwTGsMin6MrkH6gkVH/w5v/ag/wCiK+M/+/Mf/wAXX9SlFer/AMRezLrRp/8Ak3/yRwf6g4PpUl+H+R/Lnpn/AARb/ak1a68mL4MeK1bG7MzQQrx/tPIB+GcmtL/hxn+1d/0R3Wv/AAY2H/x+v6eqKmXi7mnSlT+6X/yRX+oOC61J/h/kfzS6b/wb2ftb31z5cvwvt7JcZ82bxPpLL9PkuWP6Yr9oP+CKn7FXi79g79imHwd44bT18RX2tXWsT29nN58dmsqxIsZkHys22IMSuQC2ATjJ+uqK+c4g48zHOMN9VxMYRjdP3U1qvWTPWynhfCZfW9vRcm7W1a6+iQUUUV8WfSH5D/8ABXr/AIIVfGD9tb9tbWfiR4H1TwSdH1yxs4jBqV9NbXNvJBAkLAgQurKdgYMGzyQQMAn5jj/4Nff2knkUHUPhigY4LHWrjC/lbH9Mmv6FKK+9wPiRnGEw8MLSceWCSV462Wi6ny+K4Py+vWlWnzXk23r1fyPE/wDgnl+yhJ+xD+xr4F+F9xqcesXfhi2m+1XkSFYpZ7i5luZdgPOwSTMqkgEqoJAJIr2yiivicViamIrTxFV3lNuTfm3d/ifR0aMaNONKntFJL0WiCiiisDUKKKKACvxf/b9/4NmfFfjz48a54r+C+u+ErXw74hunvpND1eaazfSpZDueOB445EeHcWKg7CgIUBgM1+0FFe5kXEWOyis62ClbmVmmrp+q8uj3+883NMpw2PpqniFtqmtGj+en/iF+
/aS/5/vhn/4O5/8A5Hr3T/gnp/wbYePvhX+0x4X8bfFjxF4Th0PwfqMGrwabotzNd3OpXEDiSJHZ4o0ji8xVLEbmYKVAGd4/aKivpMV4l53XoyouUUpKzajrZ9tWePh+DctpVFUSbs76vTQKKKK/Pz6oKKKKAOf+JXwz8O/GPwTqHhvxXomm+ItB1SPyruw1C3WeCdeoyrDGQcEHqCARggGvy3/a/wD+DWrwl40vrzV/gz4wm8H3MzNIuh64r3mnKT0WO4XM0SD/AGhMfcV+tFFe1k/EOYZXLmwVVxvut0/VO6+e/medmGU4TGx5cTBPz2a9HufzY/E7/g3d/ao+Hd4y2fgjSvFlspI+1aLrtoyHnAwk7xS89fucDrivOW/4I1/tQIxH/Cl/GXB7RRn/ANnr+pSivuqPi5msY2qU6bfe0l/7d/kfMVOAsC3eM5L5p/ofzE6F/wAEJv2sPEPl/Z/g/qkfmR+YPtOrada4Hv5twuG5+6cHrxwa9N8E/wDBs9+054rlVb+z8DeGd3VtS14SBPr9mSb9M1/RTRWdbxZziStCFOPopP8AOTX4F0+BMvjrKUn81+iPzb/4JHf8EH7/AP4J9fHCb4keLfHFj4i16PTptOs9P0q0eO1t/N275XlkIaQ7VIChFAySSeAP0koor4PN84xeZ4h4rGS5pWS2S0XSyPqMvy+hgqXsMOrR376/MKayiRSrAMrDGCOtOoryztPgH9t//g3i+Cv7WGo3mu+GRcfCzxZdbnkuNGtkk025kOTvlsiVXJJ58p4s8k5JzX5z/Gj/AINj/wBoj4e3Mz+F5vBvj6zXcYfsWp/YbpwOgdLkRxqx9BKwHrX9C1Ffa5T4gZ1gIKlCpzxWymr/AI6S+V7HzmO4Uy7FS55Q5X3i7fht+B/Lvr3/AARP/am8O3Xk3HwZ8SyPkjNtNa3ScHH3opWH68jkZFXfCn/BDL9qzxlKq2vwf1i3DEqWvtQsbILjufOnX9M57ZNf
090V9C/F3NOXSlTv6S/+S/U8lcA4K+tSdvl/kfgr8Af+DWX4veNLuC4+IXjDwj4H01iDJBZGTVtQA7jYojhGR0IlbHXHHP6gfsI/8EePgv8AsByQ6l4b0WbX/GATDeJNcKXN9GSCGEACiO3U5I/dqGKnDM4FfVVFfK5zxtm+ZwdKvVtB/ZiuVfO2rXk20e3l/DeX4N89KF5d3q/l0XyQUUUV8me8FFFFAH4E/trf8G8/7Q3if9qrx7rvg3StB8UeG/Emu3msWN2NYgtJEjuZnmEckczKQ6b9pxlSRkHnA8+8I/8ABtz+1Fr/AIksrPUPDvhvQrG4lVJ7+5162litUJ5dkhZ5GwMnCqSelf0b0V+kUfFLOadFUkoaK1+V30Vr/Fa/yt5Hx9TgnL51HUblq72urflf8TF+H3hNPAXgTRdCjma4j0XT4LBJWXa0oijWMMR2J25x2raoor84lJyfM9z6+MUlZBRRRSGfmz/wXy/4JTeP/wBv6XwJ4o+Gv9m3+t+FobnTr3TLy7W1NxBKyOkkUj4TKsrhlYjIdSDwQfzc/wCIdL9q3/oR9G/8KSw/+O1/STRX3eS+ImaZZhI4KgoOMb25k76u/SSPl8w4SwOMryxFVyUpb2at26pnw3/wQt/4J1eMv+Cef7O/iOx8ez6aviTxdq66g9jZT/aI7CKOIRorSAbWkY7yduVA28k5A+5KKK+TzTMq2PxU8ZiLc83d20XbT5HvYLB08LQjh6Xwx2CiiiuA6jzH9sb9n/8A4as/Zc8efDr7culyeL9Hn0+G7ZN620rLmN2UEFlDhSQCCRkAg1+Buq/8G4n7VOnanNBD4S8P38MLlUuIPEdosc4H8SiR1fB/2lB9QK/pAor6zh3jLMMlpzpYTlcZO7Uk3rtdWaPCzbh3C5jOM69046aO2nzTPxJ/4JR/8EFPjZ8Ef20fCPxC+JFvonhjQfBdydREMOpxXl1qMojdY40ERZVXcwLMxBwCACTkfttR
RXDxBxFi84xCxGLtdKyUVZJb92933OnKspoZfSdGhezd3d3d/wAAooorwT1Ar4X/AG3v+CAPwO/bB1K813TbO4+Gvi+8Jkk1HQI0W0upD/HNZnEbHqSYzEzEksxNfdFFd+XZpi8BV9tg6jhLy6+q2a8ndHLjMDh8VD2eIgpLz/Tt8j+f342f8GvPx28CX8j+Dtd8F+PNP3ERYun0y9YerxTAxr24WZufQcnwHxH/AMEPf2q/Csu26+DevTENtzZ3tneDOM9YZmGPfpnjOeK/qAor7/C+LGc048tWMJ+bTT/BpfgfK1uBcvm7wco+jTX4pv8AE/ltg/4I0ftQ3EyRr8F/GAaQhQWjjVRnpklwB9TgDvXSaL/wQV/az12YxxfCK8hCkbmudc0yBRnv89yN3r8uSPTpX9N1FdE/F3NH8NKn90n/AO3IxjwDgvtVJ/h/kfzt+Cv+DZf9prxWV+3Q+AfDW7qdS10ybevX7NFN6Dpn7w98e4/DL/g038SXksb+MvjFomnIoy8OjaLLelj6B5ZIsfUofTHOR+2dFeXifE/PqqtCcYf4Yr/27mO6jwXlkPii5erf6WPm/wD4Jy/8EzfAn/BNP4eatovhC61fWNR8STRXGr6rqTp5920SssaKqKqpGm+QqvJzI2WPGCvpCivhcbjK+LrSxGJk5Tlu31/paH02Hw9OhTVKjFKK2QUUUVzmwUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFfHv7XP8AwVs0P4B+Nr7wt4Y0X/hKtb0uQwX1xJc+TZWko+9GCAWkdeQwG0KeMkggeLJ/wWZ+Kk0asvgHw4ysMqwtrwgg
+/mUAfpXRXxL+x5/wUv8dftA/H/Q/B+veC9N02x1f7RvvLaO4jNv5VtLKMhywO5kVe2N3c4r7S1S+XS9MuLllLLbxNKVHfaCcfpQBYor89/hj/wW3utd+JOl2XiTwjpeleH766WC5u4Lx3kskc4EpyAGC5BYAAkA45wK/QZHWRAykMrDII6EUAOorif2jPivL8Dfgd4m8Ww2ceoTaDZNcpbu5RZWGAASAcDkdO1eZ/8ABP39snUf2yPBWv6lqWi2eizaNepbKttM0iyq0YbJ3DII56E5BHAxyAfQVFR3NzHZwSTTSLFDEpd3c7VRRyST2A9a+Dvjt/wWvtNB8U3Ol/D/AMMQ65b28hiXVNQnaOO5YHGY4UAbb6FmBI/hFAH3rRX5rf8AD5X4rf8ARP8Aw9/4C3n/AMcr6A/YC/bw8WftXeNta0fxJ4Ts9DXTbAXsd1bLMqufMVNhEmefmzkH+E8egB9U0VxH7RXxXl+BnwP8TeLobOPUJtBsmuUtnkMaykEAAsAcdfT/ABr4Kj/4LVfEbV5HfTvAnhuSFSAQEupip92Vx/IUAfpZRX5sWf8AwWz8eaJfxnWvAGgtbsM+XG9xayP9GcuP/HTX1X+yH/wUK8F/tb3EmmWMdzoPiaGPzX0q9ZWaZR95oXHEgXuMKwHO3AzQB75RRXlf7Un7Xvg/9knwpFqHiS5mlvL0MLDTbUBrm9ZcZwCQFUZGWYgDOOSQCAeqUV+buq/8FtvG2uarJ/wj/wAP9FS1XkRzyz3kwHbLR7B/47TbX/gtZ4+0UiXWfh5orW7NtBR7m1zweAzbxnv06A/gAfpJRXK/BD4lf8Lk+D/hrxV9j/s//hIdOhv/ALN5vm+R5iBtu/A3YzjOBn0FfNX7YH/BSbxB+yZ+0Tb+Gb7wfY3nhu4itruK/wDtLi4uLd+JSq42hlZZFCnOdqkkbsAA+v6Kq6Tqtvrml2t9ZzR3FpeRLPDKhysqMAysD6EEGs/4h+ONP+Gf
gTWPEWqSeTp2iWct7cNnnZGpYgDuxxgDqSQOpoA2qK+U/wBgf9v3xR+2T8QtbsbrwjpukaJotmJ5byC6kkZJXcCKM7lwdyiQ54+4fofqygAoorzD9sH9oKT9l/4A614yh01NWudPaGKG2eUxxu8sqR5ZgCcLuJwOSQBkZyAD0+ivzd03/gsZ8VvFKyT6P8ONFvLVW27oba8uNhx0LKwGe+MDirVn/wAFovHXhDVI18WfDXT44JDkRxyXFjKR3IMgcH8h9aAP0YoryP8AZU/bN8G/tc+Hp7jw7PPa6nYqpvtKvAFurXJwG4JDoezKTjgEKTivXKACivkH9r//AIKzaH+z345vPCvhvRf+Eq1zTZDDfzSXPk2dnKOseQGaR16MBtCnIySCB4jD/wAFmvincRLJH4B8OPHIAystteFWB5yD5nOeuaAP0sor4d/ZN/4Kd+Pfjp8etB8Ja54H0yxsdalkje6tY7iNrcJDJJn5ywIygHbjP4fcVABRX5q3P/Bbbx3rN6y6P4D8P7Ruby2e4uZAueOVK9MgE4wT2HSkb/gtN8StKZJtQ8BeHEtd2GzHdQ5PoGZyM/gaAP0ror5O/ZV/4Kx+D/2gvE9n4d1zTpvBuv37CO1825FxZXch4CLLhSrt2VlAJ+UMSQD9Y0AFFcD+0d+0X4c/Zf8Ahnc+KPEk0q20cggtraEBp76ZgSsUYJA3EAnJIACkngV8N63/AMFtvGWuaxIvhv4f6OlquSsdzNPeTbc4BJj2AfTB5OM+oB+kVFfmv/w+V+KoPPw+8P47/wCjXn/xyvuT9lP4yX/7QPwC8P8Ai/UtJ/sO+1hZzLZAsREY55IhjcAcMIw3PZu/WgD0Siud+KPxR0H4M+B77xJ4m1GHS9H01N808mT1OAqqMlmY4AUAkk9K+FfiR/wW/vrvX3tfA3gaGW0D7Yp9WnZprgf9cYvu/QO3r7UAfoZRX5z+EP8Agt94g0nXFh8XeAdPa23Df/Z9xJbz
xKe+2XcGPsSufUV9yfAn4+eF/wBo7wBb+JPCuoC8sZm8uRHGye0kGMxSp1VhwccggggkEEgHaUUV+eXxX/4LI+MvDPxQ1/w9ovgnQpho+p3NjG00s88kqxSMmcIV5O3PoOnvQB+htFfmo/8AwWg+J+nr5114B8Ox28ZBkJgu4+M8/MXIHpk557GvXf2cv+CyXhP4neILbR/GWjyeDbu6YRxXy3IuLBmP99iqtFkkAEhlHUsBzQB9nUUgO8ZHIPQ+teA/t/ftlX37G3gbQ9S0/RLXWrrWr5rXbcTtHHEqpuJ+UZJJwO2OetAHv9FfNX7AP/BQCP8AbIXXtP1LS7XQ/EGi7LhbeCdpEurZvlLruGcq+A3b509Tj6VoAKK8Q/bq/bCt/wBjr4W2mrR2MOra1q12LXT7KWUxo+BukkYgE7VXAwOSzqOmSOK/4J+f8FA9T/bI8TeItM1Pw7Y6NJottFdRyWtw8iyBnKkEMOvTnPrxQB9SUUVh/Ejx/p/wr8Aax4k1aRotN0O0kvLgqMsURSxCjuxxgDuSBQBuUV+b5/4LheJz4ma6XwHo/wDwjYn2eX9pl+07OoHnfc34BP3Me3evv74VfErTfjF8OdF8UaOztpuu2kd3BvGHQMOVbqNytlSBkZB5NAHRUUV8x/8ABQb9vXUv2Mr/AMMWumeH7HWpPEEdxK73Vw8awiIxjACjknf1JGMdDngA+nKK8N/YV/bNtf2yPhve6g1jDpGu6Nc/Z9QsY5TIqqwzFKhIB2uAw55DIw5GCfcqACivkn9qH/gpBqv7Pv7VemfD+38M6fqGn3RsvOu5Ll0mHnvhtoAxwCMA5yR15wPragAori/jt8fPC/7OPgC48SeKtQFnYwt5caIN893Ic4iiTqzHk44AAJJABI+GfF//AAW98RatrzQ+EfAOnLa5PljULiW5uJQO+2LaF9cAtj1NAH6NUV+bdj/wW18caHcJ/bnw90Vo3OQsU1xZsw9i+/25x+Ff
fnwX+JC/GL4SeGvFS2b6eviHToNQ+ytJ5hg8xA23dgbsZxuwMjnAzigDqKK8H/bQ/b18NfscafZ295Z3GueI9Uiaaz0yCURfuwceZLIQfLQsCAQrElWwMAkfJp/4LUfEbV5ZJtN8BeHmtN+1QVuZ2TjoXVlBPfoOD0oA/Sqivzas/wDgsv8AFBLlTcfDvQ5Ic/MscF3Gx+hLNj8jRQBxX/BIDwzY/E39sTU9Q162h1W60/RbrV4XuUEm26Nzbp5uCPvYlcg9QTkYIFfq1X4sfsK/tX2/7Hnxb1DxNc6LNrsd9pEmli3iuRbspeaCXeWKt08kjGP4s545+r/+H6uk/wDRONQ/8HCf/GqAPvis/wAXf8ipqn/XpL/6Aa+Vf2Xv+Cr2m/tLfHHRfBMPgu+0ibWhP5d0+opMsZigkmOVEanBEZGQeCRxX1V4u/5FTVP+vSX/ANANAH4W/Df4P6j8T/CvjDUdNzJJ4P01dXuIQuWktxMkchHugcOT02o3fFfp7/wSk/afPx1/Z+j0HU7rzvEXgkJYy72/eXFpjEEp9cKDGTySYwSctXzN/wAES7KHUvjp4yt7iOOa3uPDbRSRuoZZFNxCCCPQjIweorBH27/glz/wUH587/hE71/dvtOk3D8e7PCy/i8HoaAPvn/goL/yZf8AET/sEt/6EtfPf/BDP/klPjr/ALC0H/ok179+3veQ6l+xJ4+uLeSOaC40YyxyI25ZFLKQQe4I5yOorwH/AIIZ/wDJKfHX/YWg/wDRJoA+jf269ZuNB/Y9+ItxayGOb+xJ4twPIWQeW347WPNfLP8AwQ68BaVcaD438Ry2VvNrEN3b2MFxJGGkt4tjMwQ9V3EjdjGdq56V9O/8FBf+TL/iJ/2CW/8AQlr88P2C/wDgoPZ/sZ+Ede0268L3OvtrV5HcrJFfLb+UFTbjBRs+ueKAP1yor4H/AOH6uk/9E41D/wAHCf8AxqvZv2K/+Cidj+2V421fRLfwveaD
LpViL7zZLxbhZR5ioV4Rdp+YHvkZ6Y5AOv8A+Cgv/Jl/xE/7BLf+hLXhn/BDz/k37xb/ANjCf/SaGvc/+Cgv/Jl/xE/7BLf+hLXx5/wSv/bI+G/7N/we8RaX408Sf2Lf32sm7gi/s+6uN8fkRLuzDG4HzKRgkHjOMYoA/RrXNBsfE+lzWOpWdrqFlcLtlt7mFZYpB6MrAgj2NflH+134As/2MP8AgoPo914LVtOtVnstbtbVGKpbb5CskI/6ZtscbegV9vQYr7S8Tf8ABWv4H6FpUlxaeJdQ1qZAStrZ6RdJK59AZkjT82FfHPg228Qf8FP/ANu+HxF/Zc1j4Z0+e3ku8ndHp9hAcrEz4wZZSG4H8UjEDapIAP1cr8nPE1jd/wDBRD/gpXcaTeXU39grqMtmjRt/x76XaFydnXa0m0nPIEk+cYr9Y6/Kn/gjheNqf7ZuoXMm3zJtCvJWwOAxmhJx+ZoA/Tn4f/DfQfhV4ZttG8N6TY6NpdqoWO3tYhGv1OOWY9SzZJOSSSSa3aK4n4yftD+C/wBnywsbrxlr1rocOpSNFamVJHMzKAWwEVjxkc9BkeooA7avkf8A4LA/s+f8LT/Z5j8VWNv5mreB5TcsVHzPZSYWZf8AgJEcnPQI+OTz9TeEvFWneOvDOn61pN1HfaXqkCXVrcJnbNG4BVhnB5BHBAI+tT61o1t4i0e70++hW4sr6F7e4hcZWWN1Ksp9ipI/GgD5d/4JF/tAD4s/s0x+HbybzNW8DSjT2BbLNaNlrdvYAB4wPSIetcj/AMFo/wBoH/hEPhRpPw/sZgt94ql+2X6g8pZwsCoP+/NjHUEQuO9eBfs/+J3/AOCcH/BQjVPD+u3Ulr4YuJZNMu7iUHa9nLiS2uTgHlf3ZYjOAZB60/wvC3/BST/gpTJeyLJc+ErK5+0EOpCrpdqQEUjHy+c23IPIM7c8UAfaH/BM39nr/hQP7Luk/a7fydc8UY1jUNww6eYo8qM9/lj2
/LxhmfgEmvoWkA2DA4A6D0paACvmv/grZ/yY74k/6+7H/wBKo6+lK+a/+Ctn/JjviT/r7sf/AEqjoA53/gi//wAmg3X/AGMN1/6Kgr6i8W+ENL8eeH7nSda06z1XTbxDHNbXUIlikB9VPH49q+Lf+CSn7QHgX4c/sxXWk+IvGXhfQdS/tu4uPs+panDayGNo4QGAkYcHBHHoa97+Jn/BQ34P/DDQ5ryfxxoesSxqWjtdGuV1CadscKPKJVSfVyoHcigD4P8Ag3obfsmf8FXbfw1oc8w0wa6dJEZbO+0ulBSNz/Fs8yM5PVowetfq3X5Y/sU6FrX7Z/8AwURufiNNYzW2k6bqL67dvkslrgEWtvvxhnyIxjglY3IAAxX6nUAflP8A8EkfDtj8Xv20tV1bxBawaldWWk3etxecgkUXTXECeZhs8jznIJyQcHOQDX6sV+LH7Cv7V9v+x58W9Q8TXOiza7HfaRJpYt4rkW7KXmgl3lirdPJIxj+LOeOfq/8A4fq6T/0TjUP/AAcJ/wDGqAPviivj/wDZt/4K16Z+0R8bdD8Gx+Cb/SpNckkjS6OopMsRSJ5OU8tcg7MZB4znnGK+wKAPy1/4Ii/8nWeIP+xTuf8A0ssq/UaaFbiJo5FV43BVlYZDA8EH61+Q/wDwS1+P/hH9nL9oHWNb8Z6t/Y2l3Xh+axim+yzXG+Zrm2cLtiR25WNzkgDjGckA/eV//wAFWvgTZ2kkkfjSa6dRkRRaNfB3PoN0Kr+ZAoA+U/8Agsf+zn4a+Enirwn4p8M6fa6LL4iNxDfW1pGIYXli8tlmVRwrEOQ2MAlVOMkk/fP7L/jS9+Iv7OPgXXNSkabUNU0K0nupCcmWUxLvf/gTZOO2cc1+bn7XH7Q2sf8ABTT47+GPC3gTQ7/+zdNMsVhHOAJZXlK+bczbSVjjVUQYJO0BjnLYH6ffCbwBD8KPhh4d8M2r+ZBoGnW+npIRjzfKjVN31bBP1NAHwn/wXU1q
4/tD4b6f5jC08u/uSgPDPmBQT9BnHpuPrX2F+yB4D0n4efsz+B7LSbO3tIpdEs7mYxxhWuJpIUeSR8feZmYkk+vpXxn/AMF1f+Rr+HH/AF6X/wD6HBU3w2/4LUaX4C+HWg6G/wAP7+5bRdOt7AzLqyKJTFEqbseUcZ25xzjPWgD9EqK+B/8Ah+rpP/RONQ/8HCf/ABqvrz9mr44QftIfBHQ/G1tp8+lQ62srC0mk8xojHNJCfmAGcmMkHA4IoA+D/wDgs98WtS8Z/Grw38OdPeaS10u3ju5LZD/x8XlwxVMjuVjC7T281x3r7U/ZM/ZM8N/sr/DbT9L03T7N9caBDquqeWDcX05A3/ORuEYbIVBwB2JJJ/P/APbRuWvP+CtscUu144dd0CJVIHCmGzbH5seueuOlfqxQBw/x4/Z98L/tHeBrrQfE+mW95DNGywXGwfaLFyOJIn6qwOOnBHBBBIP53/8ABM7xlqn7NP7dWrfDfUrh/serT3ei3cfSI3VsXaKYD32OikZyJvTkfqRX5T67cPZ/8Fko2ibYzeNIEJA6higb8wSPxoA/Vivy1/Yc/wCUserf9hbXv5XFfqVX5Ifs8fF/w78C/wDgpV4g8SeKtQ/svRbPWdajmuPIln2M7TqvyRqzcsQOAcdTgUAfrcRvGDyD1HrXwB/wWY/Zn8M+HPh/ovxA0XSrPS9WfVV03UfssSwpeJJFI6yOowC6tEFyBkiQ5JCjHvE3/BVX4DxQsy+OHlZRkIui3+5vpmAD9a+Of28v20pP29fEHhvwD8PND1e60+G/8+JZYgLjU7oqY0KoCdiIryHLHJDksFC8gH3B/wAE5/G198RP2LPAOpalM092tnLZGRm3MyW9xLbpk9zsiXJPJPOSea8G/wCC5n/JKfAv/YWn/wDRIr6i/ZP+C7/s9fs7+FfB8ssc1zo9oRdOmShnkdppdp7r5kjgHjIxwOlfLv8AwXM/5JT4F/7C0/8A6JFAHyn8HdV1
j9hf4x/DL4gMJrjQfE+nR3zlV/19rITFdQ+7oRvUe8Z71+xOk6rb65pdrfWc0dxaXkSzwyocrKjAMrA+hBBr4b8bfs2t+0L/AMEmvBM1hB5viDwnpQ1awCjLzKu/zoR/vR5YAclo0FecfBb/AIKQt4F/4J5a54Zl1Ax+ONE26JoZ3fvXtZw2yVfTyEWRcjIXbADy1AHOfteeK9Q/b3/bevPD+jXLN4d8JW9zbwzJ80ccFsjSXVx6Zd0Kq3QgRDNdf/wQz/5Kt46/7BMH/o412/8AwTH/AGbV8Afsl+M/iBqEGNV8YaVdw2W4fNDYxo4+o8yRS2OhWOMjrXEf8EM/+SreOv8AsEwf+jjQB+lNfJH/AAWR+Kn/AAhP7K8egwybbrxfqUVqyg4YwQnzpD/30kSn1D4r63r8xf8Agrl4quvjL+2F4W+H2mP5s2lW9vYpHn7t5eyK36obb3/SgDe079lvzv8AgjZcXZtx/a73TeM1ymCFR/Kzn0NmC3plvTJr1z/gjD8VP+Ex/ZlvvDcsm648Iam8aL6W9xmZD+MnnjHtX1BZfDXS7P4Ww+D/ACS+ixaUNH8r1txD5O3/AL44r84P+CVHiS6+Av7bfiP4f6pJtbVI7rSpEI2hru0dnVv++UmAHfeKAP0/r85/+C6v/I1/Dj/r0v8A/wBDgr9GK/Of/gur/wAjX8OP+vS//wDQ4KAPKP2dvGOqf8E6v2zNNt9YuHHhvXba3S9lK7Y57C6VXjuMesTEFiMkGORR1NfrXDMtxEskbK8cgDKynIYHkEfWvif/AIKO/swH4u/sd+FfGWl26vrngjR7eafaPnuLAwoZR7+WQJBngKJMcmuy/wCCTn7T3/C8PgCvhvUpvM8QeBxHZPubLXFoQRBJ6/KFMZ6/6tSTlsUAfL//AAUr/wCUk2jf9wj/ANDFfqVX5a/8FK/+Uk2jf9wj/wBDFfqVQB+XP/BTjxdq37SH7dOk/DbTrhvs2ky2mjWceT5S
3V1seSYj28yNWPAAh+pP6G/AX9nrwv8As4+A7PQfDOm29rHBEq3FzsH2i/kA5klfqzE5PoBwAAAB+drIr/8ABZ75gG/4q3PI7+Xn/wCvX6l0AMkjWeNlZVZWGGBGQQaSGFbeJY41VI0AVVUYCgcAD6VJRQB+V/7a1hD8Sv8AgrXZeH9YT7TpU2t6DpTwk9beWO1Mifj50nT1r9SNM0u10TTobOzt4LO1tkEcUMMYjjiUdFVRgAewr8nf28PHSfC7/gqdqXiaS3a9j8O6vomqNbq+xpxBa2cuwNg7SduMkHGc4Ne5f8P1dJ/6JxqH/g4T/wCNUAffFFfBC/8ABdPSS43fDnUgueSNXQ4/8hUUAeP/APBGLw7p/ib9qHXoNSsbPUIE8LXEix3MCzKGF3ZjOGB5wSM9cE+tfpt/wqTwp/0LHh7/AMF0P/xNflh+wZ8VtM/Ya/bH1218e/aNNgjtLrw9dziFpPskgnicSFVBYofJxlQeHBGRzX6Fp/wUG+C7qrf8LE8P/MM8u4P/AKDQB6bpHw/0Hw9erdafomkWNyoIEtvZxxSAHr8ygGrHi7/kVNU/69Jf/QDXCeAP2wfhj8VPF1roPh3xno2raxfb/s9pA7eZLsRnbGQOiqx+gNd34u/5FTVP+vSX/wBANAH5q/8ABDz/AJOB8W/9i8f/AEphr6U/4Kt/swf8Lz/Z/k1/TbXzvEngkPew7FzJcWhH7+L3woEgHJzGQOWOfmv/AIIef8nA+Lf+xeP/AKUw1+nDosiFWAZWGCCOCKAPzd+Av7To+K3/AATF+JHgnU7lpNc8FaQVg3n5riwaRfLPv5bZjOOi+X3Nd7/wQz/5JT46/wCwtB/6JNfLH7cfwT1D9jP9ozxBpuiNJa+HfFdlLJYgD929nOfntz/1zkXAzyAkbHkivqf/AIIZ/wDJKfHX/YWg/wDRJoA+hP8AgoL/AMmX/ET/ALBLf+hLXzR/wRR8G6P4o+F3jaTU9J03UZI9
VhVGubVJmQGHOBuBx64r6y/a88B3nxO/Zg8daHpsbzahf6POLaFB800irvRB7syhfxr4L/4JNftgeDf2eIvFHhvxpqB0NdYuIbq0vJYnaHeqsjxuVBKH7pBIx94Eg4BAP0b/AOFSeFP+hY8Pf+C6H/4mrug+DdI8LyyPpulabpzzACRrW2SEuB0ztAzXmH/DwX4L/wDRRPD3/fxv/ia6n4VftK+A/jfqtzY+E/FOla7d2cQnmhtpCXjQnbuwQOMkDPbI9RQBy3/BQX/ky/4if9glv/Qlr4t/4Jk/sP8Aw/8A2pfg54g1TxZY6hNqGn6ybWGW2vXhKx+RG23A+X7zE5xn3xX2l/wUF/5Mv+In/YJb/wBCWvDP+CHn/Jv3i3/sYT/6TQ0AfO//AAUq/YHsf2VbrRfEXhGO9k8J6gfslwtzJ57WV2MsMsRykigkZzgowJwQK+7v+CfXxU8LfFv9mfRb7wzpOk6C1qPsmqadp8Cwx214oG87VA+/w4JySHGSSDXo3xo+Emk/HX4X614T1uLzNP1q3MLsAC0LcFJF/wBpGCsD6qK/Mn9jz4s6x/wTv/bF1Twb4uk+zaJfXK6Vq5JPkpzm3vV/2cMGyefLlbIyAAAfrBX5V/8ABIu3j8Kftyahpk8nlzJpV/Zxq4+Z3SSMkfUKjH8DX6pg7xkcg9D61+WX7ZPgjxB+wV+3XbfErQ7PzNH1jUZNYsXOVhleTP2u0Yj7ud8gwBwkikcggAH6nV8D/wDBdX/kVPhx/wBfd/8A+gQV7t8NP+Cm/wAHPiH4Xgv5vFlr4fumQGew1NHhmt2xkrnG1/qhIPseB8p/8FfP2jvA/wAdNA8C2/hHxJp+vTabcXklyLUs3kq6whSSR32njrxQB9ufsQ/8mg/Db/sXrP8A9FCvUq8t/Yh/5NB+G3/YvWf/AKKFepUAfC3/AAW7+FuhyfCrw142FmE8RRavFopuVOPNtXhuZtjDvteMFT1G5h3473/gkP8A
CDQfCH7KGleK7Oz2694ue4OoXTHczrBdzwxov91QqA4HViSewGL/AMFuv+TU/D//AGNlt/6R3tehf8Erf+TC/Af/AHEP/TjdUAfQlFFFABXzX/wVs/5Md8Sf9fdj/wClUdfSlfNf/BWz/kx3xJ/192P/AKVR0AfKv7BX/BNrwf8AtY/AWTxRrOteJdN1KPVZrEpZSQeQY0SNh8rRlt2XPO7GAOB1r37wl/wRY+FOhXqTajqXi7W9rZME15FDC49D5cSv+IcVa/4Iv/8AJoN1/wBjDdf+ioK+tqAOd+Gfwp8OfBrwpDofhbR7HRNLhO4QW0e0MxGCzn7zscDLMSTgZJxXRUUUAflR/wAEYvDun+Jv2odeg1Kxs9QgTwtcSLHcwLMoYXdmM4YHnBIz1wT61+m3/CpPCn/QseHv/BdD/wDE1+WH7EXxP0/9g/8AbW12x8cefY2cUN34evLjyWkNsfOjkSbao3Mh8leVByrggEV+haf8FBvgu6q3/CxPD/zDPLuD/wCg0Ael6T8PdA0K/S6sdD0eyuY8hJoLOOORcjBwygHkZH0NbVeY+BP2yPhf8TvFdpoeg+NtE1TVr4stvawynzJiqliBkDnapOOvFenUAfj3/wAEyv2c/C/7Tnx11rw/4ttbm60618PzX0QguHgeOZbi2jDZU/3ZHGDkc5xwK9r/AG/v+CXHh74Q/BWTxd8PYdU36C5l1a1uLk3BktSMGVOMgxnBIHBUsTjbzx3/AARF/wCTrPEH/Yp3P/pZZV+od9ZQ6nZzW1xFHcW9wjRSxSKGWRWGCpB6gjIweMUAfGf/AARo+K/hfxR8I9Q8N2+k6Tpfi7QXDXk9vAsc+rWzsTHM7Y3MVbKMOQPkPBfFfadfkr8W/C2tf8EvP24bTV9Fjnl8PSSm8sFZztvtPkbbLas395OVyckFY3xyBX6peAvG+m/EzwXpfiDR7hbzS9Ytku7aUfxowyMjsR0IPIIIPIoA/P8A/wCC6v8A
yNfw4/69L/8A9Dgr7H/Z++Fnhm8+A/gmaXw5oMssug2Du76fEzMxt4ySTt5J9e9fHH/BdX/ka/hx/wBel/8A+hwV9zfs7f8AJv3gX/sXtP8A/SaOgDR/4VJ4U/6Fjw9/4Lof/ia2dO0u30exjtbO3htbaEYjihQJGg9lHA/CrFFAH5Uftzwr4a/4Ktw6heSCG1m1fQ7wuwOEjWK1Rj+Hlt0r9V6+Af8AgtD+zPqGtDR/ido9rJcRabbDTNZESktBGHLwznH8IZ3RmOMZj6jp3f7JH/BWHwP42+Hun6f4/wBWHhvxVYQJBcT3MTta6iVGPNWRQQrNjLK2OScEjoAfYdflPLEPFP8AwWS22bCbyvGoZiATjyDmQfh5bDPQYz05r6z/AGg/+Cr3wz+GXgu8k8L6vD4v8RyREWVraxSfZ0c8BpZSAoUdSFJY4xgZyPn7/gkL8A9a+I3xu1T4va9HO1nYm4FpdTJg6hfT7lmkU/xBVaQMRxukAByCAAfpNX5F/AT4MeH/AI//APBSLxB4X8TWst5o97rOtSSxRzvCxZGndTuUg8MAfev10r8tf2HP+Userf8AYW17+VxQB6p+2F/wSV8J+E/gXq2tfDu31ceINEH21ree7NwLy3QEyooI++F+dcZJKbcEkYof8EU/ix4Ylt9b8Hz6TpFn4uhzeWupLbqt1qVqSN8TPjcTGxBAzgq/A+Qk/oLX5S/ty/BjVf2Cf2utK8d+DlNlo+pXZ1XSigPlW0wP+kWjYx8h3H5eAY5doztNAH6tV8Mf8FzP+SU+Bf8AsLT/APokV9a/AX4z6V+0F8JdF8XaM3+h6xAHaMnL20o4kib/AGkcFfQ4yMggn5K/4Lmf8kp8C/8AYWn/APRIoA+hP+CfX/Jl/wAO/wDsEr/6E1eJ+L/+CK3gXxN46v8AVIPEniDS9PvrtrkafBFEVt1ZtxjRyMhRyFJBIGM5xk+2f8E+v+TL/h3/ANglf/Qmr2OgDkPG/h6z
8I/AjWNK063jtdP03QZ7W2gQYWKJLdlRR9AAK+Bf+CGf/JVvHX/YJg/9HGv0I+Ln/JKfE/8A2Cbr/wBEvX57/wDBDP8A5Kt46/7BMH/o40AfpLPPHaQPJI6xxxqWd2OFUDkkn9a/GXTB8QP2t/2wvEnib4cWdzeeJG1CfXLNknht2s7dJVSJt0zKo2K0SjPOccZr9Nf+Cg/xX/4U/wDsheNNSjk8u8vLM6VaYOGMlwRDlfdVd3z/ALH4V85f8EOvhX9j8J+NPGs0fzX1zFo9qxHIWJfNlx7FpIufVCOoOADjP+FZftxf8/PiH/wf6Z/8erwbxZbfEf8AZR/ax8O+KfiNZ3Vr4nW+t9enZ7iG4a+hEu1yXhZkywSRCMg884yCf2ir4V/4LgfCn+1fhx4R8ZQx/vdHvZNMuWA5MU670J9leIj6y+9AH3JY3sOo2kNxbyLNBcIskbqcq6kZBHsRivzt/wCC6v8AyNfw4/69L/8A9Dgr6l/4JyfFX/hbf7Hfg28kkMl5pdqdHusnLBrY+WuT6mMRtk8ndzzXy1/wXV/5Gv4cf9el/wD+hwUAfePwxs4dS+Dvh63uI45oLjRraOSN13LIpgUEEdwRxg9RX5mX8F5/wS8/4KFLKq3K+D7yXcuNz/adJuGwR6u0LDp1LQA9Dz+nPwj/AOSU+GP+wTa/+iUr5+/4Krfsw/8AC9/2e5tc0+38zxF4IEmoW4VctcW2AbiL/vlQ46kmPA+8aAPlH/govqNvq/8AwUV8P3drNHcWt1Ho8sMsbblkRmUqwPcEEHI6iv1Qr8JfBvjTUvGnxW8D/wBpXDXLaVcWGnQM33hBHMPLU/7oIUegVR2r92qAPyy1W4XQv+Czitdt5KyeLokXPcyxqE/76LL+dfqbX5t/8FfvgFrXw++NOk/F7QY51tLz7Ol5dQglrC+gwIZWP8IZFjVSeA0RBILKD77+zx/wVe+GvxM8E2beKtYh8I+JIolW9trqJ/s8kgHz
PFIoK7T1CsQwzjBAyQD6norxW+/4KJfBOwiDyfELRGUnb+6Esp/JUJ/E8V6t4R8X6d4+8L6frWj3SX2l6pAl1a3CKQs0bjKsAQDyD0IBoA/MX9qa1h1H/gsrY29xFHNDN4p8ORyRyKGWRTDYAgg9QRkYPBFfpb/wqTwp/wBCx4e/8F0P/wATX5qf8FFoLz4Df8FKdN8eX1nLPps13pOv22wf69bQQRvGDwN263PBIwHUnAINfbmhf8FHfgr4g0mG7Tx7pVqJ1DGK6SSGaI9wysucjpxkehI5oA9PHwl8Kg5Hhnw+COhGnQ8f+O0V56P+CgnwXJx/wsTw96f61v8A4migDyz/AIKn/s/+DvEfwnufGV3oNq3ia1CQJqCO8UjpjgPtYCTHQFwSBwMV+UtFFAH0Z/wSggWb9unwgzLloob91PofsUw/kT+dfrxrca3Gj3kb/MkkDqw9QVOaKKAPhn/gkb4B0nw78R/F15Z2nk3P9mww7/NdvkaXJGCSOSi89eK+8qKKAPl//gqv8ONE8Z/APT77UtPjurzS9URbSbcyPCsiNvAKkcNtXIPHyj0qH/gk54I0vwn8B9am0+1+zy32suJ28xm37Iowv3icY3Hp60UUAfU1fnl/wV7/AGefBfgqxtfFGkeH7PTdc1iV3vJ7ZnjW4bIJYxhvL3EkksFyxOSSaKKAPz8r7m/4Ia2MUnxa8dXDL++i0mGJGyeFabLD8Si/lRRQB9xfte6Tb69+zB46tbuPzreTR5yy7iucDI5GD1Arxv8A4JJ+GrLw18EPEUdjD5KSa4WYb2bJ+zw+pNFFAH1ZXwn/AMFdfhZ4f1jxh4S1i402NtTubWa2luFd0aWONlKBtpAOC7YJ55x0AoooA+sf2Yd3/DOfgXdJLIRoVmN0khkY4hXqzEk/ia3/AIgfDvQ/ir4VutD8R6XZ6xpN4oEttcxh0PXBHdWHUMMEHkEUUUAfi3+2J8OtG+Ffx/1zRNBs/sGl2cu2
GHzXl2De4+87Mx4A6ntVD9nTwRpfjzxh9l1a1+1W+U+XzHj67s8qQewoooA/a34TeFrHwR8MvDuj6Xb/AGXTtO06GC3h3s/loqKAMsST9SSa6KiigD5p/wCCqfhWw8Wfsz2seoW/2hLXXLeeIb2Xa/lTLn5SM/K7DB45rtP2AtCtfDf7IfgyzsovJt44bh1TcWwWuZmbkknlmJ/GiigD2KiiigArxL/gof4fs/E37H/iu3vofPhX7JIF3FcMLuHByCD3oooAwv8Agl94ZsfC/wCy3HDYw+RHNqt1K43s2W+Vc/MT2UflX0VRRQAUUUUAfK//AAU4/Z38F+LfhNe+L77w/ZyeJrNo4Y9QRnhmZMHhyjASYwAN4OBwMV+S9FFAH0H/AMEtLKO9/bl8F+au7yvtUqckYYWs2DX7G0UUAfBP/BKz4c6N4T/aA8XXGn2f2eaHSpLZG8132xm5jJX5ie8ac9ePrX3tRRQB8y/8FVPh9o3jP9nezutSsY7q50vVIjaylmV4d6sHAKkHDADIPB2g9QKvf8Eu9Pj0j9l6Ozt/NW2t9VuVijaVpBEDsYhdxOAWZjgcZYnqTRRQB5h/wV+8FaZ4lufAdxfWvnSxrfRq3mOuF/cHGAQOtfXfwp0+HSfhd4btbdPLgtdKtoolyTtVYkAGTzwB3oooA6CiiigCO7tIdQtZre4ijmgnQxyRyKGSRSMEEHggjgg1+Wv/AAVb/Z18F/BDxdp83hPQbfQ21P8Ae3CW8knlEnrtjLFUHsgAHYUUUAcf/wAE1/gZ4V+OHxfjsfFWkpq1pG24RPPLGpIUkZ2MuRkdDkGv1x0Dw9Y+FNHtdN0uztdP0+zjEUFtbRCOKFB0VVHAH0oooAu18E/smfDjRdL/AOCkvii+t7Py7q3vNXljfznO1mlZScFschmHTvRRQB97V4h/wUP8B6R49/ZR8Rpq9jHerpphvLUsSrQTCRUDqQQQdrsPcMaKKAPO/wDgkho1v4f+
Evii1tFkjt/7VSQRmV3VWMK5IDE4zgZx1wKT/grf4S0/xP8ACDwu19b+ebfVyI/3jLt3Qvn7pHoOvpRRQB7f+yRotr4d/Zm8C2dnH5NvHotsypuLYLRhm5JJ5Yk/jXotFFAGf4osYtU8M6ha3CeZBcW8sUiE43KUYEflXxX/AMEjfAuleGfGvjqextfJl+y2sW7zHb5S8hIwSR1A/KiigD0b/gq/oNr4j/Zv0uG8jM0S+Irdwu9l5+z3I/hIz1PFdt/wT78Kaf4P/ZK8J2+m2y2sMyzzyAMW3u08mWJJJ7D8qKKAPaK8d/b78MWPiz9kjxja6hbrcwLBFMqklSrpPGykEEEYI7HkZB4JFFFAHm//AASU0C18N/ArxBb2UbQwtrzyFPMZhuNvACfmJxwB09BXD/8ABXzwhp3ibWvAcl9b+c8UF8qnzGXA3QehFFFAH2d4Qso9M8JaVbwL5cNvaQxRrknaoRQBk89K02XcMEZB4I9aKKAPy40P4B+EbT9u230uLRo49Ph8XeXHbpNKqIq3PCgbug9K/UiiigCnruhWPijSLjTtSs7XUNPvYzFcW1zEssM6HqrKwIYH0Nfkb/wUw+BnhX4FfG7+zvCekpo9jMvmNCk8si5KhjjezYGSeBgDtRRQB4r8HfDln4r+IFnY6hD9otZj86b2XP4qQa/cD4K+GrLwd8HvC+l6bD9nsbHSraKCLez7FES4GWJJ/EmiigDC/ac+CXhT43fCnUrXxVolnrEWn2011atJuSW2kWMsGSRCHXJUZAIDAYORxX4ofEvR7fw/451Kzs4/Jt7ebZGm4ttH1JJoooAydNiW41O3jYbkklRWHqD1ooooA//Z</ImageData>
    </EmbeddedImage>
  </EmbeddedImages>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportID>0eeb6585-38ae-40f1-885b-8d50088d51b4</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70002 CMMS Incident Report Wrapper
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=17:06:18;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=CMMS Incident Report;
               DEA=CMMS Incident Report];
    ProcessingOnly=Yes;
    EnableHyperlinks=Yes;
    OnPreReport=BEGIN
                  IF (StartDate = 0D) OR (EndDate = 0D) THEN
                    ERROR(Text001);

                  IF (StartDate > EndDate) THEN
                    ERROR(Text001);
                END;

  }
  DATASET
  {
    { 1000000000;;DataItem;OB                ;
               DataItemTable=Table70020;
               DataItemTableView=SORTING(Objecttype,No.)
                                 WHERE(Objecttype=CONST(Asset));
               ReqFilterHeadingML=[ENU=Asset;
                                   DEA=Anlage];
               OnPreDataItem=BEGIN
                               Buffer.RESET;
                               Buffer.DELETEALL;

                               IF AssetNoFilter <> '' THEN
                                 OB.SETFILTER("No.", AssetNoFilter);
                               IF PortfolioFilter <> '' THEN
                                 OB.SETFILTER(Portfolio, PortfolioFilter);
                             END;

               OnAfterGetRecord=VAR
                                  CMAddData@1000000000 : Record 70021;
                                  SubAsset@1000000001 : Record 70020;
                                  NoFilter@1000000002 : Text;
                                BEGIN

                                  //Customer No. & Chain Name
                                  IF (CustomerCompanyChain <> '') OR (CustomerNo <> '') THEN BEGIN
                                    CMAddData.RESET;
                                    CMAddData.SETRANGE(Type, CMAddData.Type::Customer);
                                    CMAddData.SETRANGE(Key1, OB."No.");
                                    CMAddData.SETFILTER(Key3, '<>%1', '');
                                    IF CMAddData.FIND('-') THEN BEGIN
                                      REPEAT
                                        IF (CustomerCompanyChain <> '') AND (CustomerCompanyChain <> CMAddData."Customer Company Chain") THEN
                                          CurrReport.SKIP;
                                        IF (CustomerNo <> '') AND (CustomerNo <> CMAddData.Key3) THEN
                                          CurrReport.SKIP;
                                      UNTIL CMAddData.NEXT = 0;
                                    END;
                                  END;

                                  IF ReportType = ReportType::"Main Asset" THEN
                                    AddEntryMainAsset(OB."No.", OB."No.", OB.Name);

                                  IF ReportType = ReportType::Asset THEN
                                    AddEntry(OB."No.", OB."No.", OB.Name); //Add Entry
                                END;

               OnPostDataItem=VAR
                                CMMSMonthlyReport@1000000000 : Report 70004;
                                FileMgt@1000000001 : Codeunit 419;
                                TempFilename@1000000002 : Text;
                                FilenameServer@1000000004 : Text;
                                FilenameClient@1000000006 : Text;
                                FilenameForSave@1000000007 : Text;
                                SingleFile@1000000003 : Boolean;
                                Extension@1000000005 : Text;
                                Dlg@1000000008 : Dialog;
                                Total@1000000009 : Integer;
                                Counter@1000000010 : Integer;
                              BEGIN
                                Buffer.RESET;
                                IF NOT CONFIRM(STRSUBSTNO(Text002, Buffer.COUNT)) THEN
                                  CurrReport.BREAK;

                                Total := Buffer.COUNT;
                                IF Total <= 0 THEN
                                  CurrReport.BREAK;

                                IF Total = 1 THEN
                                  SingleFile := TRUE;

                                IF NOT SingleFile THEN
                                  FilenameServer := FileMgt.CreateZipArchiveObject();

                                CASE ExportType OF
                                  ExportType::Excel : Extension := 'xlsx';
                                  ExportType::PDF : Extension := 'pdf';
                                END;

                                Dlg.OPEN(Text003);
                                Counter := 0;

                                IF Buffer.FIND('-') THEN BEGIN
                                  REPEAT
                                    Counter += 1;
                                    IF Counter MOD 10 = 0 THEN
                                      Dlg.UPDATE(1, (Counter / Total * 10000) DIV 1);

                                    CLEAR(CMMSMonthlyReport);
                                    CMMSMonthlyReport.SetData(StartDate, EndDate, Buffer.Int1, Buffer.Text1, Buffer.OK1);
                                    CMMSMonthlyReport.USEREQUESTPAGE(FALSE);

                                    IF (ExportType = ExportType::Preview) THEN
                                      CMMSMonthlyReport.EXECUTE('');

                                    IF (ExportType = ExportType::Excel) OR (ExportType = ExportType::PDF) THEN BEGIN
                                      //Filename :=
                                      TempFilename := FileMgt.ServerTempFileName(Extension);
                                      FilenameForSave := GetFilenameToSave(Extension, FALSE);

                                      //Run Report
                                      IF ExportType = ExportType::Excel THEN
                                        CMMSMonthlyReport.SAVEASEXCEL(TempFilename);
                                      IF ExportType = ExportType::PDF THEN
                                        CMMSMonthlyReport.SAVEASPDF(TempFilename);

                                      IF NOT SingleFile THEN BEGIN
                                        FileMgt.AddFileToZipArchive(TempFilename, FilenameForSave);
                                        FileMgt.DeleteServerFile(TempFilename);
                                      END
                                      ELSE BEGIN
                                        FilenameServer := TempFilename;
                                      END;
                                    END;
                                  UNTIL Buffer.NEXT = 0;
                                END;

                                IF (ExportType = ExportType::Excel) OR (ExportType = ExportType::PDF) THEN BEGIN
                                  IF NOT SingleFile THEN BEGIN
                                    FileMgt.CloseZipArchive();
                                    Extension := 'zip';
                                    FilenameForSave := GetFilenameToSave(Extension, TRUE);
                                  END;

                                  Dlg.CLOSE;

                                  FilenameClient := FileMgt.SaveFileDialog('Save as',FilenameForSave , '*.'+Extension+'|*.'+Extension+'');
                                  Dlg.OPEN(Text005);
                                  FileMgt.DownloadToFile(FilenameServer, FilenameClient);
                                  Dlg.CLOSE;
                                  FileMgt.DeleteServerFile(FilenameServer);
                                END;
                              END;
                               }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1000000000;;Container;
                  ContainerType=ContentArea }

      { 1000000001;1;Group  ;
                  Name=Options;
                  CaptionML=[ENU=Options;
                             DEA=Optionen];
                  GroupType=Group }

      { 1000000008;2;Field  ;
                  Name=ReportType;
                  CaptionML=[ENU=Report Type;
                             DEA=Reportart];
                  SourceExpr=ReportType }

      { 1000000004;2;Field  ;
                  Name=ExportType;
                  CaptionML=[ENU=Export Type;
                             DEA=Exporttyp];
                  OptionCaptionML=[ENU=Excel,PDF,Preview;
                                   DEA=Excel,PDF,Vorschau];
                  SourceExpr=ExportType }

      { 1000000002;2;Field  ;
                  Name=StartDate;
                  CaptionML=[ENU=Start Date;
                             DEA=Startdatum];
                  SourceExpr=StartDate;
                  OnValidate=BEGIN
                               EndDate := CALCDATE('<+CM>', StartDate);
                             END;
                              }

      { 1000000003;2;Field  ;
                  Name=EndDate;
                  CaptionML=[ENU=End Date;
                             DEA=Enddatum];
                  SourceExpr=EndDate }

      { 1000000009;1;Group  ;
                  Name=Filter;
                  GroupType=Group }

      { 1000000005;2;Field  ;
                  Name=CustomerNo;
                  CaptionML=[ENU=Customer No.;
                             DEA=Debitor Nr.];
                  SourceExpr=CustomerNo }

      { 1000000006;2;Field  ;
                  Name=CustomerCompanyChain;
                  CaptionML=[ENU=Company Chain;
                             DEA=Unternehmenskette];
                  SourceExpr=CustomerCompanyChain }

      { 1000000007;2;Field  ;
                  Name=AssetNoFilter;
                  CaptionML=[ENU=Asset No. Filter;
                             DEA=Anlagennr. Filter];
                  SourceExpr=AssetNoFilter;
                  OnLookup=VAR
                             AssetList@1000000000 : Page 70021;
                             Asset@1000000001 : Record 70020;
                           BEGIN
                             Asset.SETRANGE(Objecttype, Asset.Objecttype::Asset);
                             IF ReportType = ReportType::"Main Asset" THEN
                               Asset.SETRANGE("Asset Type", Asset."Asset Type"::"Main Asset");

                             AssetList.SETTABLEVIEW(Asset);
                             AssetList.LOOKUPMODE(TRUE);
                             IF AssetList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               AssetList.GETRECORD(Asset);
                               AssetNoFilter := Text + Asset."No.";
                             END;
                           END;
                            }

      { 1000000010;2;Field  ;
                  Name=PortfolioFilter;
                  CaptionML=[ENU=Portfolio Filter;
                             DEA=Portfolio Filter];
                  SourceExpr=PortfolioFilter }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ReportType@1000000015 : 'Asset,Main Asset';
      ExportType@1000000008 : 'Excel,PDF,Preview';
      StartDate@1000000000 : Date;
      EndDate@1000000001 : Date;
      Text001@1000000002 : TextConst 'ENU=Invalid Start/End Date.;DEA=Ungltiges Start/Enddatum.';
      CustomerNo@1000000003 : Code[20];
      CustomerCompanyChain@1000000004 : Code[20];
      AssetNoFilter@1000000009 : Text;
      PortfolioFilter@1000000016 : Text;
      Buffer@1000000005 : TEMPORARY Record 50002;
      EntryNo@1000000006 : Integer;
      Text002@1000000007 : TextConst 'ENU="Based on your selection %1 document(s) will be created. Continue? ";DEA=Anhand der Auswahl werden %1 Dokument(e) erstellt. Fortfahren?';
      Text003@1000000010 : TextConst 'ENU=Verarbeite Daten... @1@@@@@@@@@@;DEA=Processing data... @1@@@@@@@@@@';
      Text005@1000000011 : TextConst 'ENU=Downloading file...;DEA=Lade Datei herunter...';
      Text006@1000000012 : TextConst 'ENU=CMMS_Monthly_Report_%1_-_%2.%3;DEA=CMMS_Monatsbericht_%1_-_%2.%3';
      Text007@1000000013 : TextConst 'ENU=CMMS_Monthly_Report_%1_-_%2_%3.%4;DEA=CMMS_Monatsbericht_%1_-_%2_%3.%4';
      Text008@1000000014 : TextConst 'ENU=MainAsset;DEA=Hauptanlage';
      Text009@1000000017 : TextConst 'ENU=Portfolio_;DEA=Portfolio_';

    LOCAL PROCEDURE toint@1000000007(val@1000000000 : Integer) : Integer;
    BEGIN
      EXIT(val);
    END;

    LOCAL PROCEDURE GetFilenameToSave@1000000001(Extension@1000000000 : Text;IsArchive@1000000001 : Boolean) : Text;
    BEGIN
      //CMMS_Monatsbericht_%1_-_%2.%4
      IF IsArchive THEN
        EXIT(STRSUBSTNO(Text006, DateFormat(StartDate), DateFormat(EndDate), Extension));

      //CMMS_Monatsbericht_%1_-_%2_%3.%4
      EXIT(STRSUBSTNO(Text007, DateFormat(StartDate), DateFormat(EndDate), Buffer.Text2, Extension));
    END;

    LOCAL PROCEDURE DateFormat@1000000002(RefDate@1000000000 : Date) : Text;
    VAR
      c@1000000003 : Integer;
      Int@1000000001 : Integer;
      Result@1000000002 : Text;
    BEGIN
      IF RefDate = 0D THEN
        EXIT('');

      Result := '';

      c := 3;
      WHILE(c > 0) DO BEGIN
        Int := DATE2DMY(RefDate, c);
        IF Int < 10 THEN
          Result += '0';
        Result += FORMAT(Int);
        c -= 1;
      END;

      EXIT(Result);
    END;

    LOCAL PROCEDURE AddEntry@1000000000(ObjectNoFilter@1000000001 : Text;AssetNo@1000000003 : Text;AssetName@1000000004 : Text);
    BEGIN
      Buffer.INIT;
      Buffer."Entry No." := EntryNo;
      Buffer.OK1 := FALSE;
      Buffer.Text1 := ObjectNoFilter;
      Buffer.Int1 := OB.Objecttype::Asset;
      Buffer.Text2 := STRSUBSTNO('%1_%2',AssetNo,AssetName);
      Buffer.INSERT;
      EntryNo += 1;
    END;

    LOCAL PROCEDURE AddEntryMainAsset@1000000003(MainAssetNoFilter@1000000001 : Text;AssetNo@1000000003 : Text;AssetName@1000000004 : Text);
    BEGIN
      Buffer.INIT;
      Buffer."Entry No." := EntryNo;
      Buffer.OK1 := TRUE;
      Buffer.Text1 := MainAssetNoFilter;
      Buffer.Int1 := OB.Objecttype::Asset;
      Buffer.Text2 := STRSUBSTNO('%1_%2_%3',Text008,AssetNo,AssetName);
      Buffer.INSERT;
      EntryNo += 1;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 70003 CMMS Close Workorders
{
  OBJECT-PROPERTIES
  {
    Date=21.03.17;
    Time=10:00:12;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPostReport=BEGIN
                   MESSAGE(Text003);
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Workorder         ;
               DataItemTable=Table5092;
               DataItemTableView=SORTING(No.);
               OnPreDataItem=BEGIN
                               Workorder.SETRANGE("CM Is Workorder", TRUE);
                               Workorder.SETFILTER("CM Status", '<>4&<>5');

                               IF NOT CONFIRM(STRSUBSTNO(Text001, Workorder.COUNT)) THEN
                                 ERROR(Text002);
                             END;

               OnAfterGetRecord=BEGIN
                                  CMGenMgt.CreateLogEntry(Workorder, LogEntry."CM Log Type"::"Status Change",
                                                          FORMAT(Workorder."CM Status"::Discarded), '###Automatically closed via Batch.###');

                                  Workorder."CM Status" := Workorder."CM Status"::Discarded;
                                  Workorder.MODIFY(FALSE);
                                END;

               ReqFilterFields=No.,CM Status }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      CMGenMgt@1000000000 : Codeunit 70000;
      LogEntry@1000000001 : Record 5065;
      Text001@1000000002 : TextConst 'DEA=Do you really want to set %1 Work Orders to status "Closed"? This Action will be logged.';
      Text002@1000000003 : TextConst 'DEA=Canceled.';
      Text003@1000000004 : TextConst 'DEA=Done!';

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 70004 CMMS Incident Report
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=17:05:45;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=CMMS Incident Report;
               DEA=CMMS Incident Report];
    EnableHyperlinks=Yes;
    OnInitReport=BEGIN
                   MaxReactionTimeInDays := 14;
                 END;

    OnPreReport=BEGIN
                  IF (StartDate = 0D) OR (EndDate = 0D) THEN
                    ERROR(Text001);

                  IF (StartDate > EndDate) THEN
                    ERROR(Text001);

                  IF ObjectNoFilter = '' THEN
                    ERROR(Text002);
                END;

  }
  DATASET
  {
    { 1000000000;;DataItem;OB                ;
               DataItemTable=Table70020;
               DataItemTableView=SORTING(Objecttype,No.)
                                 WHERE(Objecttype=CONST(Asset));
               OnPreDataItem=BEGIN
                               OB.RESET;

                               IF IsMainAssetFilter THEN BEGIN
                                 OB.SETCURRENTKEY(Objecttype,"Main Asset No.");
                                 OB.SETRANGE(Objecttype, ObjType);
                                 OB.SETFILTER("Main Asset No.", ObjectNoFilter);
                               END
                               ELSE BEGIN
                                 OB.SETRANGE(Objecttype, ObjType);
                                 OB.SETFILTER("No.", ObjectNoFilter);
                               END;
                             END;

               OnAfterGetRecord=VAR
                                  CMAddData@1000000000 : Record 70021;
                                BEGIN
                                  UserSetup1.RESET;
                                  UserSetup1.INIT;
                                  UserSetup2.RESET;
                                  UserSetup2.INIT;

                                  CMAddData.RESET;
                                  CMAddData.SETRANGE(Type, CMAddData.Type::User);
                                  CMAddData.SETRANGE(Objecttype, OB.Objecttype);
                                  CMAddData.SETRANGE(Key1, OB."No.");
                                  CMAddData.SETFILTER(Key2, '<>%1', '');

                                  //Plant Manager
                                  CMAddData.SETRANGE("Plant Manager", TRUE);
                                  IF CMAddData.FINDFIRST() THEN BEGIN
                                    IF UserSetup1.GET(CMAddData.Key2) THEN
                                      ;
                                    UserSetup1.CALCFIELDS("CM Name");
                                  END;

                                  //Operations Supervisor
                                  CMAddData.SETRANGE("Plant Manager");
                                  CMAddData.SETRANGE("Responsible OM supervisor" , TRUE);
                                  IF CMAddData.FINDFIRST() THEN BEGIN
                                    IF UserSetup2.GET(CMAddData.Key2) THEN
                                      ;
                                    UserSetup2.CALCFIELDS("CM Name");
                                  END;
                                END;
                                 }

    { 1000000014;1;Column;GEN_StartDate      ;
               SourceExpr=StartDate }

    { 1000000015;1;Column;GEN_EndDate        ;
               SourceExpr=EndDate }

    { 1000000045;1;Column;GEN_DocumentDate   ;
               SourceExpr=TODAY }

    { 1000000016;1;Column;OB_                ;
               SourceExpr=TRUE }

    { 1000000002;1;Column;OB_Objecttype      ;
               SourceExpr=OB.Objecttype }

    { 1000000003;1;Column;OB_No              ;
               SourceExpr=OB."No." }

    { 1000000004;1;Column;OB_Name            ;
               SourceExpr=OB.Name }

    { 1000000005;1;Column;OB_CapacityDCkWp   ;
               SourceExpr=OB."Capacity DC kWp" }

    { 1000000006;1;Column;OB_PlantManager_UserId;
               SourceExpr=UserSetup1."User ID" }

    { 1000000007;1;Column;OB_PlantManager_Name;
               SourceExpr=UserSetup1."CM Name" }

    { 1000000008;1;Column;OB_PlantManager_PhoneNo;
               SourceExpr=UserSetup1."IG Phone No." }

    { 1000000009;1;Column;OB_PlantManager_Email;
               SourceExpr=UserSetup1."E-Mail" }

    { 1000000013;1;Column;OB_OperationsResp_UserId;
               SourceExpr=UserSetup2."User ID" }

    { 1000000012;1;Column;OB_OperationsResp_Name;
               SourceExpr=UserSetup2."CM Name" }

    { 1000000011;1;Column;OB_OperationsResp_PhoneNo;
               SourceExpr=UserSetup2."IG Phone No." }

    { 1000000010;1;Column;OB_OperationsResp_Email;
               SourceExpr=UserSetup2."E-Mail" }

    { 1000000001;1;DataItem;WO               ;
               DataItemTable=Table5092;
               DataItemTableView=SORTING(CM Is Workorder,CM Object No.)
                                 WHERE(CM Is Workorder=CONST(Yes),
                                       CM Status=FILTER(<>Discarded));
               OnPreDataItem=BEGIN
                               SUM_Alarms := 0;
                               SUM_HoursBookedAlarms := 0;
                             END;

               OnAfterGetRecord=VAR
                                  LogEntry@1000000000 : Record 5065;
                                  TimeSheetDetail@1000000002 : Record 952;
                                  LocReactionTime@1000000001 : Duration;
                                  LocDownTime@1000000005 : Duration;
                                  CreationDatetime@1000000003 : DateTime;
                                  FinishedDatetime@1000000004 : DateTime;
                                BEGIN
                                  ActivationDate := 0D;
                                  LocReactionTime := 0;
                                  ReactionTime := '';
                                  FinishedDate := 0D;
                                  FinishedDatetime := 0DT;
                                  CreationDate := 0D;
                                  CreationDatetime := 0DT;
                                  Grouping := GetGrouping();

                                  //Creation
                                  IF GetCreatedLogEnty(LogEntry) THEN BEGIN
                                    CreationDate := LogEntry.Date;
                                    CreationDatetime := CREATEDATETIME(LogEntry.Date, LogEntry."Time of Interaction");
                                  END;

                                  //Finished
                                  IF NOT IsOpen(WO) THEN BEGIN
                                    IF GetFinishedLogEntry(LogEntry) THEN BEGIN
                                      FinishedDate := LogEntry.Date;
                                      FinishedDatetime := CREATEDATETIME(LogEntry.Date, LogEntry."Time of Interaction");
                                    END;
                                  END;

                                  //Activation Date
                                  IF WO."CM GPM Activated Date" <> 0D THEN
                                    ActivationDate := WO."CM GPM Activated Date"
                                  ELSE
                                    ActivationDate := CreationDate;

                                  //Workorder Details (Fieldsets)
                                  CMRepMgt.BuildFieldsetBuffer(WOD, WOD.Area::Workorder, OB, WO, T);

                                  //SUMS
                                  IF (WO."CM Source" = WO."CM Source"::Alarm) OR (WO."CM Source" = WO."CM Source"::"Manual Alarm") THEN BEGIN
                                    SUM_Alarms += 1;

                                    TimeSheetDetail.RESET;
                                    TimeSheetDetail.SETCURRENTKEY("CM Is CMMS Timesheet","CM Workorder No.");
                                    TimeSheetDetail.SETRANGE("CM Is CMMS Timesheet", TRUE);
                                    TimeSheetDetail.SETRANGE("CM Workorder No.", WO."No.");
                                    IF TimeSheetDetail.FIND('-') THEN BEGIN
                                      REPEAT
                                        SUM_HoursBookedAlarms += TimeSheetDetail."CM Quantity";
                                      UNTIL TimeSheetDetail.NEXT = 0;
                                    END;
                                  END;

                                  //Reaction Time
                                  IF (WO."CM GPM Notified DateTime" <> 0DT) AND (WO."CM GPM Activated DateTime" <> 0DT) THEN BEGIN
                                    LocReactionTime := WO."CM GPM Notified DateTime" - WO."CM GPM Activated DateTime";

                                    IF LocReactionTime > (MaxReactionTimeInDays * (1000 * 3600 * 24)) THEN BEGIN
                                      LocReactionTime := MaxReactionTimeInDays * (1000 * 3600 * 24);
                                      ReactionTime := STRSUBSTNO('%1+', LocReactionTime);
                                    END
                                    ELSE BEGIN
                                      ReactionTime := STRSUBSTNO('%1', LocReactionTime);
                                    END;
                                  END;

                                  //In Period
                                  IF NOT InPeriod() THEN
                                    CurrReport.SKIP;
                                END;

               DataItemLink=CM Objecttype=FIELD(Objecttype),
                            CM Object No.=FIELD(No.) }

    { 1000000017;2;Column;WO_                ;
               SourceExpr=TRUE }

    { 1000000018;2;Column;WO_No              ;
               SourceExpr=WO."No." }

    { 1000000029;2;Column;WO_Grouping        ;
               SourceExpr=Grouping }

    { 1000000062;2;Column;WO_Priority        ;
               SourceExpr=WO.Priority }

    { 1000000060;2;Column;WO_Status          ;
               SourceExpr=WO."CM Status" }

    { 1000000020;2;Column;WO_ActivationDate  ;
               SourceExpr=ActivationDate }

    { 1000000022;2;Column;WO_ReactionTime    ;
               SourceExpr=ReactionTime }

    { 1000000024;2;Column;WO_DueDate         ;
               SourceExpr=WO."CM Due Date" }

    { 1000000021;2;Column;WO_Status_INT      ;
               SourceExpr=toint(WO."CM Status") }

    { 1000000023;2;Column;WO_FinishedDate    ;
               SourceExpr=FinishedDate }

    { 1000000030;2;Column;WO_CreationDate    ;
               SourceExpr=CreationDate }

    { 1000000019;2;Column;WO_Description     ;
               SourceExpr=WO.Description }

    { 1000000061;2;Column;WO_FinishedTasks   ;
               SourceExpr=WO."CM Finished Tasks" }

    { 1000000026;2;Column;WO_OpenTasks       ;
               SourceExpr=WO."CM Open Tasks" }

    { 1000000025;2;Column;WO_ReferenceElementName;
               SourceExpr=WO."CM GPM Reference Element Name" }

    { 1000000027;2;Column;WO_SUM_HoursBookedAlarms;
               SourceExpr=SUM_HoursBookedAlarms }

    { 1000000028;2;Column;WO_SUM_Alarms      ;
               SourceExpr=SUM_Alarms }

    { 1000000046;2;DataItem;WOD              ;
               DataItemTable=Table70021;
               DataItemTableView=SORTING(Objecttype,Type,Key1,Area,Position,Order);
               Temporary=Yes }

    { 1000000052;3;Column;WOD_               ;
               SourceExpr=TRUE }

    { 1000000047;3;Column;WOD_Style          ;
               SourceExpr=WOD.Style }

    { 1000000048;3;Column;WOD_Position       ;
               SourceExpr=toint(WOD.Position) }

    { 1000000049;3;Column;WOD_Order          ;
               SourceExpr=WOD.Order }

    { 1000000050;3;Column;WOD_CaptionText    ;
               SourceExpr=WOD."Caption Text" }

    { 1000000051;3;Column;WOD_ValueText      ;
               SourceExpr=WOD."Value Text" }

    { 1000000031;2;DataItem;T                ;
               DataItemTable=Table5080;
               DataItemTableView=SORTING(CM Type,Opportunity No.,No.)
                                 WHERE(CM Type=CONST(Task),
                                       CM Subtype=CONST(" "));
               OnPreDataItem=BEGIN
                               Num := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  Num += 1;
                                  CMRepMgt.BuildFieldsetBuffer(TD, TD.Area::Task, OB, WO, T);
                                END;

               DataItemLink=Opportunity No.=FIELD(No.) }

    { 1000000033;3;Column;T_                 ;
               SourceExpr=TRUE }

    { 1000000043;3;Column;T_Even             ;
               SourceExpr=Num MOD 2 = 0 }

    { 1000000041;3;Column;T_Number           ;
               SourceExpr=Num }

    { 1000000035;3;Column;T_No               ;
               SourceExpr=T."No." }

    { 1000000036;3;Column;T_Status           ;
               SourceExpr=T."CM Status" }

    { 1000000037;3;Column;T_Description      ;
               SourceExpr=T.Description }

    { 1000000059;3;DataItem;TD               ;
               DataItemTable=Table70021;
               DataItemTableView=SORTING(Objecttype,Type,Key1,Area,Position,Order);
               Temporary=Yes }

    { 1000000058;4;Column;TD_                ;
               SourceExpr=TRUE }

    { 1000000057;4;Column;TD_Style           ;
               SourceExpr=TD.Style }

    { 1000000056;4;Column;TD_Position        ;
               SourceExpr=toint(TD.Position) }

    { 1000000055;4;Column;TD_Order           ;
               SourceExpr=TD.Order }

    { 1000000054;4;Column;TD_CaptionText     ;
               SourceExpr=TD."Caption Text" }

    { 1000000053;4;Column;TD_ValueText       ;
               SourceExpr=TD."Value Text" }

    { 1000000032;2;DataItem;COM              ;
               DataItemTable=Table5065;
               DataItemTableView=SORTING(CM Is CMMS Log Entry,Opportunity No.)
                                 WHERE(CM Is CMMS Log Entry=CONST(Yes),
                                       CM Log Type=CONST(Comment),
                                       CM Internal=CONST(No));
               OnPreDataItem=BEGIN
                               Num := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  Num += 1;
                                END;

               DataItemLink=Opportunity No.=FIELD(No.) }

    { 1000000034;3;Column;COM_               ;
               SourceExpr=TRUE }

    { 1000000044;3;Column;COM_Even           ;
               SourceExpr=Num MOD 2 = 0 }

    { 1000000042;3;Column;COM_Number         ;
               SourceExpr=Num }

    { 1000000038;3;Column;COM_EntryNo        ;
               SourceExpr=COM."Entry No." }

    { 1000000039;3;Column;COM_Datetime       ;
               SourceExpr=COM."CM Created Datetime" }

    { 1000000040;3;Column;COM_Comment        ;
               SourceExpr=COM."CM Comment" }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=No;
    }
    CONTROLS
    {
    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      StartDate@1000000000 : Date;
      EndDate@1000000001 : Date;
      Text001@1000000002 : TextConst 'ENU=Invalid Start/End Date.;DEA=Ungltiges Start/Enddatum.';
      ObjType@1000000013 : Integer;
      ObjectNoFilter@1000000014 : Text;
      IsMainAssetFilter@1000000018 : Boolean;
      UserSetup1@1000000003 : Record 91;
      UserSetup2@1000000004 : Record 91;
      ActivationDate@1000000005 : Date;
      ReactionTime@1000000006 : Text;
      FinishedDate@1000000007 : Date;
      CreationDate@1000000011 : Date;
      Grouping@1000000010 : Text;
      SUM_HoursBookedAlarms@1000000008 : Decimal;
      SUM_Alarms@1000000009 : Integer;
      Num@1000000012 : Integer;
      Text002@1000000015 : TextConst 'ENU=Object No. Filter required!;DEA=Objektnr. Filter erforderlich!';
      MaxReactionTimeInDays@1000000016 : Integer;
      CMRepMgt@1000000017 : Codeunit 70027;

    LOCAL PROCEDURE toint@1000000007(val@1000000000 : Integer) : Integer;
    BEGIN
      EXIT(val);
    END;

    LOCAL PROCEDURE GetFinishedLogEntry@1000000001(VAR LogEntry@1000000000 : Record 5065) : Boolean;
    BEGIN
      LogEntry.RESET;
      LogEntry.SETCURRENTKEY("CM Is CMMS Log Entry","CM Source","CM Source No.","CM Log Type");
      LogEntry.SETRANGE("CM Is CMMS Log Entry", TRUE);
      LogEntry.SETRANGE("CM Source", LogEntry."CM Source"::Workorder);
      LogEntry.SETRANGE("CM Source No.", WO."No.");
      LogEntry.SETRANGE("CM Log Type", LogEntry."CM Log Type"::"Status Change");
      LogEntry.SETFILTER(Description,'%1|%2', FORMAT(WO."CM Status"::Done), FORMAT(WO."CM Status"::Completed));
      EXIT(LogEntry.FINDFIRST());
    END;

    LOCAL PROCEDURE GetCreatedLogEnty@1000000002(VAR LogEntry@1000000000 : Record 5065) : Boolean;
    BEGIN
      LogEntry.RESET;
      LogEntry.SETCURRENTKEY("CM Is CMMS Log Entry","CM Source","CM Source No.","CM Log Type");
      LogEntry.SETRANGE("CM Is CMMS Log Entry", TRUE);
      LogEntry.SETRANGE("CM Source", LogEntry."CM Source"::Workorder);
      LogEntry.SETRANGE("CM Source No.", WO."No.");
      LogEntry.SETRANGE("CM Log Type", LogEntry."CM Log Type"::Created);
      EXIT(LogEntry.FINDFIRST());
    END;

    LOCAL PROCEDURE InPeriod@1000000000() : Boolean;
    VAR
      LogEntry@1000000000 : Record 5065;
    BEGIN

      IF Grouping = 'alarm' THEN BEGIN
        //All open workorders
        IF IsOpen(WO) THEN
          EXIT(TRUE);

        //All workorders finished in period
        IF (FinishedDate >= StartDate) AND (FinishedDate <= EndDate) THEN
          EXIT(TRUE);
      END;

      IF (Grouping = 'standard') OR (Grouping = 'healthandsafety') THEN BEGIN
        //All open workorders, with due date in or before period
        IF IsOpen(WO) AND (WO."CM Due Date" <= EndDate) THEN BEGIN
          EXIT(TRUE);
        END;

        //All workorders finished in period
        IF (FinishedDate >= StartDate) AND (FinishedDate <= EndDate) THEN
          EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    LOCAL PROCEDURE GetGrouping@1000000003() : Text;
    BEGIN
      IF WO."CM Work Order Type Code" = 'WHSINCIDEN' THEN
        EXIT('healthandsafety');

      IF (WO."CM Source" = WO."CM Source"::Alarm) OR (WO."CM Source" = WO."CM Source"::"Manual Alarm") THEN
        EXIT('alarm');

      EXIT('standard');
    END;

    PROCEDURE SetData@1000000004(StartDate_@1000000000 : Date;EndDate_@1000000001 : Date;ObjType_@1000000002 : Integer;ObjectNoFilter_@1000000003 : Text;IsMainAssetFilter_@1000000004 : Boolean);
    BEGIN
      ObjType := ObjType_;
      ObjectNoFilter := ObjectNoFilter_;
      IsMainAssetFilter := IsMainAssetFilter_;

      StartDate := StartDate_;
      EndDate := EndDate_;
    END;

    LOCAL PROCEDURE IsOpen@1000000009(Workorder@1000000000 : Record 5092) : Boolean;
    BEGIN
      EXIT(Workorder."CM Status" IN [WO."CM Status"::New, WO."CM Status"::Open, WO."CM Status"::"In Process", WO."CM Status"::Completed]);
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>b1273a05-4b32-4d9d-aa09-e8b5394da6d0</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="GEN_StartDate">
          <DataField>GEN_StartDate</DataField>
        </Field>
        <Field Name="GEN_EndDate">
          <DataField>GEN_EndDate</DataField>
        </Field>
        <Field Name="GEN_DocumentDate">
          <DataField>GEN_DocumentDate</DataField>
        </Field>
        <Field Name="OB_">
          <DataField>OB_</DataField>
        </Field>
        <Field Name="OB_Objecttype">
          <DataField>OB_Objecttype</DataField>
        </Field>
        <Field Name="OB_No">
          <DataField>OB_No</DataField>
        </Field>
        <Field Name="OB_Name">
          <DataField>OB_Name</DataField>
        </Field>
        <Field Name="OB_CapacityDCkWp">
          <DataField>OB_CapacityDCkWp</DataField>
        </Field>
        <Field Name="OB_CapacityDCkWpFormat">
          <DataField>OB_CapacityDCkWpFormat</DataField>
        </Field>
        <Field Name="OB_PlantManager_UserId">
          <DataField>OB_PlantManager_UserId</DataField>
        </Field>
        <Field Name="OB_PlantManager_Name">
          <DataField>OB_PlantManager_Name</DataField>
        </Field>
        <Field Name="OB_PlantManager_PhoneNo">
          <DataField>OB_PlantManager_PhoneNo</DataField>
        </Field>
        <Field Name="OB_PlantManager_Email">
          <DataField>OB_PlantManager_Email</DataField>
        </Field>
        <Field Name="OB_OperationsResp_UserId">
          <DataField>OB_OperationsResp_UserId</DataField>
        </Field>
        <Field Name="OB_OperationsResp_Name">
          <DataField>OB_OperationsResp_Name</DataField>
        </Field>
        <Field Name="OB_OperationsResp_PhoneNo">
          <DataField>OB_OperationsResp_PhoneNo</DataField>
        </Field>
        <Field Name="OB_OperationsResp_Email">
          <DataField>OB_OperationsResp_Email</DataField>
        </Field>
        <Field Name="WO_">
          <DataField>WO_</DataField>
        </Field>
        <Field Name="WO_No">
          <DataField>WO_No</DataField>
        </Field>
        <Field Name="WO_Grouping">
          <DataField>WO_Grouping</DataField>
        </Field>
        <Field Name="WO_Priority">
          <DataField>WO_Priority</DataField>
        </Field>
        <Field Name="WO_Status">
          <DataField>WO_Status</DataField>
        </Field>
        <Field Name="WO_ActivationDate">
          <DataField>WO_ActivationDate</DataField>
        </Field>
        <Field Name="WO_ReactionTime">
          <DataField>WO_ReactionTime</DataField>
        </Field>
        <Field Name="WO_DueDate">
          <DataField>WO_DueDate</DataField>
        </Field>
        <Field Name="WO_Status_INT">
          <DataField>WO_Status_INT</DataField>
        </Field>
        <Field Name="WO_FinishedDate">
          <DataField>WO_FinishedDate</DataField>
        </Field>
        <Field Name="WO_CreationDate">
          <DataField>WO_CreationDate</DataField>
        </Field>
        <Field Name="WO_Description">
          <DataField>WO_Description</DataField>
        </Field>
        <Field Name="WO_FinishedTasks">
          <DataField>WO_FinishedTasks</DataField>
        </Field>
        <Field Name="WO_OpenTasks">
          <DataField>WO_OpenTasks</DataField>
        </Field>
        <Field Name="WO_ReferenceElementName">
          <DataField>WO_ReferenceElementName</DataField>
        </Field>
        <Field Name="WO_SUM_HoursBookedAlarms">
          <DataField>WO_SUM_HoursBookedAlarms</DataField>
        </Field>
        <Field Name="WO_SUM_HoursBookedAlarmsFormat">
          <DataField>WO_SUM_HoursBookedAlarmsFormat</DataField>
        </Field>
        <Field Name="WO_SUM_Alarms">
          <DataField>WO_SUM_Alarms</DataField>
        </Field>
        <Field Name="WOD_">
          <DataField>WOD_</DataField>
        </Field>
        <Field Name="WOD_Style">
          <DataField>WOD_Style</DataField>
        </Field>
        <Field Name="WOD_Position">
          <DataField>WOD_Position</DataField>
        </Field>
        <Field Name="WOD_Order">
          <DataField>WOD_Order</DataField>
        </Field>
        <Field Name="WOD_CaptionText">
          <DataField>WOD_CaptionText</DataField>
        </Field>
        <Field Name="WOD_ValueText">
          <DataField>WOD_ValueText</DataField>
        </Field>
        <Field Name="T_">
          <DataField>T_</DataField>
        </Field>
        <Field Name="T_Even">
          <DataField>T_Even</DataField>
        </Field>
        <Field Name="T_Number">
          <DataField>T_Number</DataField>
        </Field>
        <Field Name="T_No">
          <DataField>T_No</DataField>
        </Field>
        <Field Name="T_Status">
          <DataField>T_Status</DataField>
        </Field>
        <Field Name="T_Description">
          <DataField>T_Description</DataField>
        </Field>
        <Field Name="TD_">
          <DataField>TD_</DataField>
        </Field>
        <Field Name="TD_Style">
          <DataField>TD_Style</DataField>
        </Field>
        <Field Name="TD_Position">
          <DataField>TD_Position</DataField>
        </Field>
        <Field Name="TD_Order">
          <DataField>TD_Order</DataField>
        </Field>
        <Field Name="TD_CaptionText">
          <DataField>TD_CaptionText</DataField>
        </Field>
        <Field Name="TD_ValueText">
          <DataField>TD_ValueText</DataField>
        </Field>
        <Field Name="COM_">
          <DataField>COM_</DataField>
        </Field>
        <Field Name="COM_Even">
          <DataField>COM_Even</DataField>
        </Field>
        <Field Name="COM_Number">
          <DataField>COM_Number</DataField>
        </Field>
        <Field Name="COM_EntryNo">
          <DataField>COM_EntryNo</DataField>
        </Field>
        <Field Name="COM_Datetime">
          <DataField>COM_Datetime</DataField>
        </Field>
        <Field Name="COM_Comment">
          <DataField>COM_Comment</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>0.98425in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.98425in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1.37795in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.98425in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.98425in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>2.55907in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.98425in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>0.98425in</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.31496in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OB_">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!OB_No.Value + " " + Fields!OB_Name.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>12pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>Underline</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#2f5496</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox113">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Plant Name</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox10</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OB_Name">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!OB_Name.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OB_Name</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox99">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Plant Size [kWp]</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox12</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OB_CapacityDCkWp">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!OB_CapacityDCkWp.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OB_CapacityDCkWp</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox26">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox26</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox28">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox28</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox117">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">From </Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox33</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="GEN_StartDate">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!GEN_StartDate.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>GEN_StartDate</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox93">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">To</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox35</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="GEN_EndDate">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!GEN_EndDate.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>GEN_EndDate</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox4">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Document Date</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox4</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="GEN_DocumentDate">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!GEN_DocumentDate.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>GEN_DocumentDate</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox65">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox65</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox66">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox66</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox50">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox50</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox51">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox51</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox52">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox52</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox53">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox53</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox54">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox54</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox55">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox55</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox56">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox56</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox57">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox57</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox589">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox589</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox328">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox328</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox31">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Name</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox30</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox37">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Email</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox36</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox35">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Phone</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox35</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox29">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Plant Manager</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox29</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OB_PlantManager_Name">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!OB_PlantManager_Name.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OB_PlantManager_Name</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OB_PlantManager_Email">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!OB_PlantManager_Email.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OB_PlantManager_Email</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OB_PlantManager_PhoneNo">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!OB_PlantManager_PhoneNo.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OB_PlantManager_PhoneNo</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox573">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Operations Supervisor</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox573</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OB_OperationsResp_Name">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!OB_OperationsResp_Name.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OB_OperationsResp_Name</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OB_OperationsResp_Email">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!OB_OperationsResp_Email.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OB_OperationsResp_Email</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OB_OperationsResp_PhoneNo">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!OB_OperationsResp_PhoneNo.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OB_OperationsResp_PhoneNo</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox565">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox565</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox566">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox566</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox567">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox567</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox568">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox568</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox569">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox569</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox570">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox570</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox571">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox571</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox572">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox572</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="ALARM">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Alarms</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#2f5496</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox598">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Number of Alarms</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox598</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox599">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=LAST(Fields!WO_SUM_Alarms.Value)</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox599</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox601">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Hours booked</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox601</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox602">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Last(Fields!WO_SUM_HoursBookedAlarms.Value)</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox602</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox92">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox92</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox94">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox94</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox95">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox95</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox96">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox96</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox97">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox97</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox98">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox98</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox100">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox100</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox101">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox101</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox102">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox102</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox103">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox103</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox630">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Workorder No.</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox622</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox631">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Activation Date</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox623</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox632">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Reaction Time</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox624</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox633">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Due Date</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox625</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox642">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Finished Date</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox626</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox643">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Description</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox627</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <rd:Selected>true</rd:Selected>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox3">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Priority</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox3</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox5">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Status</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox5</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_No">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_No.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_ActivationDate">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_ActivationDate.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_ActivationDate</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_ReactionTime">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_ReactionTime.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <Format>T</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_ReactionTime</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_DueDate">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_DueDate.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_DueDate</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_FinishedDate">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_FinishedDate.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_FinishedDate</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_Description">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_Description.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_Description</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_Priority">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_Priority.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_Priority</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_Status">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_Status.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_Status</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox2">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontStyle>Italic</FontStyle>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox2</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>16pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WOD_">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Workorder Details</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#5f84c6</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox200">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontStyle>Italic</FontStyle>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox200</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>16pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Tablix Name="Tablix2">
                          <TablixBody>
                            <TablixColumns>
                              <TablixColumn>
                                <Width>4.42913in</Width>
                              </TablixColumn>
                              <TablixColumn>
                                <Width>4.42913in</Width>
                              </TablixColumn>
                            </TablixColumns>
                            <TablixRows>
                              <TablixRow>
                                <Height>0.23622in</Height>
                                <TablixCells>
                                  <TablixCell>
                                    <CellContents>
                                      <Tablix Name="WOD_Left">
                                        <TablixBody>
                                          <TablixColumns>
                                            <TablixColumn>
                                              <Width>2.21457in</Width>
                                            </TablixColumn>
                                            <TablixColumn>
                                              <Width>2.21457in</Width>
                                            </TablixColumn>
                                          </TablixColumns>
                                          <TablixRows>
                                            <TablixRow>
                                              <Height>0.23622in</Height>
                                              <TablixCells>
                                                <TablixCell>
                                                  <CellContents>
                                                    <Textbox Name="WO_No3">
                                                      <KeepTogether>true</KeepTogether>
                                                      <Paragraphs>
                                                        <Paragraph>
                                                          <TextRuns>
                                                            <TextRun>
                                                              <Value EvaluationMode="Auto">=Fields!WOD_CaptionText.Value</Value>
                                                              <Style>
                                                                <FontFamily>Segoe UI</FontFamily>
                                                                <FontSize>8pt</FontSize>
                                                                <FontWeight>Bold</FontWeight>
                                                              </Style>
                                                            </TextRun>
                                                          </TextRuns>
                                                          <Style>
                                                            <TextAlign>Left</TextAlign>
                                                          </Style>
                                                        </Paragraph>
                                                      </Paragraphs>
                                                      <Style>
                                                        <Border>
                                                          <Style>None</Style>
                                                        </Border>
                                                        <VerticalAlign>Middle</VerticalAlign>
                                                        <PaddingLeft>2pt</PaddingLeft>
                                                        <PaddingRight>2pt</PaddingRight>
                                                      </Style>
                                                    </Textbox>
                                                  </CellContents>
                                                </TablixCell>
                                                <TablixCell>
                                                  <CellContents>
                                                    <Textbox Name="WO_No5">
                                                      <KeepTogether>true</KeepTogether>
                                                      <Paragraphs>
                                                        <Paragraph>
                                                          <TextRuns>
                                                            <TextRun>
                                                              <Value EvaluationMode="Auto">=Fields!WOD_ValueText.Value</Value>
                                                              <Style>
                                                                <FontFamily>Segoe UI</FontFamily>
                                                                <FontSize>8pt</FontSize>
                                                              </Style>
                                                            </TextRun>
                                                          </TextRuns>
                                                          <Style>
                                                            <TextAlign>Left</TextAlign>
                                                          </Style>
                                                        </Paragraph>
                                                      </Paragraphs>
                                                      <Style>
                                                        <Border>
                                                          <Style>None</Style>
                                                        </Border>
                                                        <VerticalAlign>Middle</VerticalAlign>
                                                        <PaddingLeft>2pt</PaddingLeft>
                                                        <PaddingRight>2pt</PaddingRight>
                                                      </Style>
                                                    </Textbox>
                                                  </CellContents>
                                                </TablixCell>
                                              </TablixCells>
                                            </TablixRow>
                                          </TablixRows>
                                        </TablixBody>
                                        <TablixColumnHierarchy>
                                          <TablixMembers>
                                            <TablixMember />
                                            <TablixMember />
                                          </TablixMembers>
                                        </TablixColumnHierarchy>
                                        <TablixRowHierarchy>
                                          <TablixMembers>
                                            <TablixMember>
                                              <Group Name="Details" />
                                            </TablixMember>
                                          </TablixMembers>
                                        </TablixRowHierarchy>
                                        <DataSetName>DataSet_Result</DataSetName>
                                        <Filters>
                                          <Filter>
                                            <FilterExpression>=Fields!WOD_Position.Value</FilterExpression>
                                            <Operator>Equal</Operator>
                                            <FilterValues>
                                              <FilterValue DataType="Integer">0</FilterValue>
                                            </FilterValues>
                                          </Filter>
                                        </Filters>
                                        <Style>
                                          <Border>
                                            <Style>None</Style>
                                          </Border>
                                        </Style>
                                      </Tablix>
                                    </CellContents>
                                  </TablixCell>
                                  <TablixCell>
                                    <CellContents>
                                      <Tablix Name="WOD_Right">
                                        <TablixBody>
                                          <TablixColumns>
                                            <TablixColumn>
                                              <Width>2.21457in</Width>
                                            </TablixColumn>
                                            <TablixColumn>
                                              <Width>2.21457in</Width>
                                            </TablixColumn>
                                          </TablixColumns>
                                          <TablixRows>
                                            <TablixRow>
                                              <Height>0.23622in</Height>
                                              <TablixCells>
                                                <TablixCell>
                                                  <CellContents>
                                                    <Textbox Name="WO_No6">
                                                      <KeepTogether>true</KeepTogether>
                                                      <Paragraphs>
                                                        <Paragraph>
                                                          <TextRuns>
                                                            <TextRun>
                                                              <Value EvaluationMode="Auto">=Fields!WOD_CaptionText.Value</Value>
                                                              <Style>
                                                                <FontFamily>Segoe UI</FontFamily>
                                                                <FontSize>8pt</FontSize>
                                                                <FontWeight>Bold</FontWeight>
                                                              </Style>
                                                            </TextRun>
                                                          </TextRuns>
                                                          <Style>
                                                            <TextAlign>Left</TextAlign>
                                                          </Style>
                                                        </Paragraph>
                                                      </Paragraphs>
                                                      <Style>
                                                        <Border>
                                                          <Style>None</Style>
                                                        </Border>
                                                        <VerticalAlign>Middle</VerticalAlign>
                                                        <PaddingLeft>2pt</PaddingLeft>
                                                        <PaddingRight>2pt</PaddingRight>
                                                      </Style>
                                                    </Textbox>
                                                  </CellContents>
                                                </TablixCell>
                                                <TablixCell>
                                                  <CellContents>
                                                    <Textbox Name="WO_No7">
                                                      <KeepTogether>true</KeepTogether>
                                                      <Paragraphs>
                                                        <Paragraph>
                                                          <TextRuns>
                                                            <TextRun>
                                                              <Value EvaluationMode="Auto">=Fields!WOD_ValueText.Value</Value>
                                                              <Style>
                                                                <FontFamily>Segoe UI</FontFamily>
                                                                <FontSize>8pt</FontSize>
                                                              </Style>
                                                            </TextRun>
                                                          </TextRuns>
                                                          <Style>
                                                            <TextAlign>Left</TextAlign>
                                                          </Style>
                                                        </Paragraph>
                                                      </Paragraphs>
                                                      <Style>
                                                        <Border>
                                                          <Style>None</Style>
                                                        </Border>
                                                        <VerticalAlign>Middle</VerticalAlign>
                                                        <PaddingLeft>2pt</PaddingLeft>
                                                        <PaddingRight>2pt</PaddingRight>
                                                      </Style>
                                                    </Textbox>
                                                  </CellContents>
                                                </TablixCell>
                                              </TablixCells>
                                            </TablixRow>
                                          </TablixRows>
                                        </TablixBody>
                                        <TablixColumnHierarchy>
                                          <TablixMembers>
                                            <TablixMember />
                                            <TablixMember />
                                          </TablixMembers>
                                        </TablixColumnHierarchy>
                                        <TablixRowHierarchy>
                                          <TablixMembers>
                                            <TablixMember>
                                              <Group Name="Details1" />
                                            </TablixMember>
                                          </TablixMembers>
                                        </TablixRowHierarchy>
                                        <DataSetName>DataSet_Result</DataSetName>
                                        <Filters>
                                          <Filter>
                                            <FilterExpression>=Fields!WOD_Position.Value</FilterExpression>
                                            <Operator>Equal</Operator>
                                            <FilterValues>
                                              <FilterValue DataType="Integer">1</FilterValue>
                                            </FilterValues>
                                          </Filter>
                                        </Filters>
                                        <Style>
                                          <Border>
                                            <Style>None</Style>
                                          </Border>
                                        </Style>
                                      </Tablix>
                                    </CellContents>
                                  </TablixCell>
                                </TablixCells>
                              </TablixRow>
                            </TablixRows>
                          </TablixBody>
                          <TablixColumnHierarchy>
                            <TablixMembers>
                              <TablixMember />
                              <TablixMember />
                            </TablixMembers>
                          </TablixColumnHierarchy>
                          <TablixRowHierarchy>
                            <TablixMembers>
                              <TablixMember />
                            </TablixMembers>
                          </TablixRowHierarchy>
                          <DataSetName>DataSet_Result</DataSetName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                          </Style>
                        </Tablix>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox306">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontStyle>Italic</FontStyle>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox306</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>16pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Tasks</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#5f84c6</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox109">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox109</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_No3">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_No.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_No</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>=IIF(Fields!T_Even.Value, "WhiteSmoke", "Transparent")</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_Description3">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_Description.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_Description</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>=IIF(Fields!T_Even.Value, "WhiteSmoke", "Transparent")</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_Status3">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_Status.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_Status</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>=IIF(Fields!T_Even.Value, "WhiteSmoke", "Transparent")</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox1">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="COM_">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Comments</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#5f84c6</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox62">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox62</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="COM_Comment">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!COM_Comment.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>COM_Comment</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>=IIF(Fields!COM_Even.Value, "WhiteSmoke", "Transparent")</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OTHER">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Other Activities</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#2f5496</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox662">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Workorder No.</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox622</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox665">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Due Date</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox625</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox666">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Finished Date</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox626</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox672">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Description</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox627</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox668">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Completed Tasks</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox628</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox669">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Open Tasks</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox629</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_No2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_No.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_No</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_DueDate3">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_DueDate.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_DueDate</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_FinishedDate3">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_FinishedDate.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_FinishedDate</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_Description3">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_Description.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_Description</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_FinishedTasks2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_FinishedTasks.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_FinishedTasks</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_OpenTasks2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_OpenTasks.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_OpenTasks</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox112">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox112</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Tasks</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#5f84c6</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox230">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox230</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_No4">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_No.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_No</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>=IIF(Fields!T_Even.Value, "WhiteSmoke", "Transparent")</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_Description4">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_Description.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_Description</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>=IIF(Fields!T_Even.Value, "WhiteSmoke", "Transparent")</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>5</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="T_Status4">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!T_Status.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>T_Status</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>=IIF(Fields!T_Even.Value, "WhiteSmoke", "Transparent")</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox148">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox148</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="COM_2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Comments</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#5f84c6</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox269">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto" />
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox269</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="COM_Comment2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!COM_Comment.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>COM_Comment</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>=IIF(Fields!COM_Even.Value, "WhiteSmoke", "Transparent")</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>7</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="HEALTH">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Health and Safety Incidents</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <BackgroundColor>#2f5496</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>8</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox670">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Workorder No.</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox622</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox808">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Date</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox808</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox801">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">Description</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox801</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>6</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.23622in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_No4">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_No.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_No</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_CreationDate">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_CreationDate.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                    <Format>d</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_CreationDate</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="WO_Description1">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value EvaluationMode="Auto">=Fields!WO_Description.Value</Value>
                                  <Style>
                                    <FontFamily>Segoe UI</FontFamily>
                                    <FontSize>8pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>WO_Description1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Style>None</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                          </Style>
                        </Textbox>
                        <ColSpan>6</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="OB">
                    <GroupExpressions>
                      <GroupExpression>=Fields!OB_Objecttype.Value</GroupExpression>
                      <GroupExpression>=Fields!OB_No.Value</GroupExpression>
                    </GroupExpressions>
                    <PageBreak>
                      <BreakLocation>Between</BreakLocation>
                    </PageBreak>
                    <Filters>
                      <Filter>
                        <FilterExpression>=Fields!OB_.Value</FilterExpression>
                        <Operator>Equal</Operator>
                        <FilterValues>
                          <FilterValue DataType="Boolean">true</FilterValue>
                        </FilterValues>
                      </Filter>
                    </Filters>
                  </Group>
                  <TablixMembers>
                    <TablixMember />
                    <TablixMember />
                    <TablixMember />
                    <TablixMember />
                    <TablixMember />
                    <TablixMember />
                    <TablixMember />
                    <TablixMember />
                    <TablixMember>
                      <TablixMembers>
                        <TablixMember />
                        <TablixMember>
                          <Group Name="CLICK_WO">
                            <GroupExpressions>
                              <GroupExpression>=Fields!OB_No.Value</GroupExpression>
                              <GroupExpression>=Fields!OB_Objecttype.Value</GroupExpression>
                            </GroupExpressions>
                          </Group>
                          <SortExpressions>
                            <SortExpression>
                              <Value>=Fields!OB_No.Value</Value>
                            </SortExpression>
                          </SortExpressions>
                          <TablixMembers>
                            <TablixMember />
                            <TablixMember />
                            <TablixMember />
                            <TablixMember>
                              <Group Name="WO_Alarm">
                                <GroupExpressions>
                                  <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                </GroupExpressions>
                                <Filters>
                                  <Filter>
                                    <FilterExpression>=Fields!WO_Grouping.Value</FilterExpression>
                                    <Operator>Equal</Operator>
                                    <FilterValues>
                                      <FilterValue>alarm</FilterValue>
                                    </FilterValues>
                                  </Filter>
                                </Filters>
                              </Group>
                              <SortExpressions>
                                <SortExpression>
                                  <Value>=Fields!WO_ActivationDate.Value</Value>
                                </SortExpression>
                              </SortExpressions>
                              <TablixMembers>
                                <TablixMember />
                                <TablixMember>
                                  <Group Name="Wrapper">
                                    <GroupExpressions>
                                      <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                    </GroupExpressions>
                                    <Filters>
                                      <Filter>
                                        <FilterExpression>=Fields!WO_Grouping.Value</FilterExpression>
                                        <Operator>Equal</Operator>
                                        <FilterValues>
                                          <FilterValue>alarm</FilterValue>
                                        </FilterValues>
                                      </Filter>
                                    </Filters>
                                  </Group>
                                  <SortExpressions>
                                    <SortExpression>
                                      <Value>=Fields!WO_No.Value</Value>
                                    </SortExpression>
                                  </SortExpressions>
                                  <TablixMembers>
                                    <TablixMember>
                                      <Group Name="WOD_Wrapper">
                                        <GroupExpressions>
                                          <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                        </GroupExpressions>
                                      </Group>
                                      <SortExpressions>
                                        <SortExpression>
                                          <Value>=Fields!WO_No.Value</Value>
                                        </SortExpression>
                                      </SortExpressions>
                                      <TablixMembers>
                                        <TablixMember />
                                        <TablixMember>
                                          <Group Name="CLICK_WOD_">
                                            <GroupExpressions>
                                              <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                            </GroupExpressions>
                                          </Group>
                                          <SortExpressions>
                                            <SortExpression>
                                              <Value>=Fields!WO_No.Value</Value>
                                            </SortExpression>
                                          </SortExpressions>
                                          <TablixMembers>
                                            <TablixMember />
                                          </TablixMembers>
                                          <Visibility>
                                            <ToggleItem>WOD_</ToggleItem>
                                          </Visibility>
                                        </TablixMember>
                                      </TablixMembers>
                                      <Visibility>
                                        <Hidden>=IIF(MAX(Fields!WOD_.Value), FALSE, TRUE)</Hidden>
                                      </Visibility>
                                    </TablixMember>
                                    <TablixMember>
                                      <Group Name="T_Wrapper">
                                        <GroupExpressions>
                                          <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                        </GroupExpressions>
                                      </Group>
                                      <SortExpressions>
                                        <SortExpression>
                                          <Value>=Fields!WO_No.Value</Value>
                                        </SortExpression>
                                      </SortExpressions>
                                      <TablixMembers>
                                        <TablixMember />
                                        <TablixMember>
                                          <Group Name="CLICK_T_">
                                            <GroupExpressions>
                                              <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                            </GroupExpressions>
                                          </Group>
                                          <SortExpressions>
                                            <SortExpression>
                                              <Value>=Fields!WO_No.Value</Value>
                                            </SortExpression>
                                          </SortExpressions>
                                          <TablixMembers>
                                            <TablixMember>
                                              <Group Name="T_">
                                                <Filters>
                                                  <Filter>
                                                    <FilterExpression>=Fields!T_.Value</FilterExpression>
                                                    <Operator>Equal</Operator>
                                                    <FilterValues>
                                                      <FilterValue DataType="Boolean">true</FilterValue>
                                                    </FilterValues>
                                                  </Filter>
                                                </Filters>
                                              </Group>
                                            </TablixMember>
                                          </TablixMembers>
                                          <Visibility>
                                            <ToggleItem>T_</ToggleItem>
                                          </Visibility>
                                        </TablixMember>
                                      </TablixMembers>
                                      <Visibility>
                                        <Hidden>=IIF(MAX(Fields!T_.Value), FALSE, TRUE)</Hidden>
                                      </Visibility>
                                    </TablixMember>
                                    <TablixMember>
                                      <Group Name="COM_Wrapper">
                                        <GroupExpressions>
                                          <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                        </GroupExpressions>
                                      </Group>
                                      <SortExpressions>
                                        <SortExpression>
                                          <Value>=Fields!WO_No.Value</Value>
                                        </SortExpression>
                                      </SortExpressions>
                                      <TablixMembers>
                                        <TablixMember />
                                        <TablixMember>
                                          <Group Name="CLICK_COM">
                                            <GroupExpressions>
                                              <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                            </GroupExpressions>
                                          </Group>
                                          <SortExpressions>
                                            <SortExpression>
                                              <Value>=Fields!WO_No.Value</Value>
                                            </SortExpression>
                                          </SortExpressions>
                                          <TablixMembers>
                                            <TablixMember>
                                              <Group Name="COM_">
                                                <Filters>
                                                  <Filter>
                                                    <FilterExpression>=Fields!COM_.Value</FilterExpression>
                                                    <Operator>Equal</Operator>
                                                    <FilterValues>
                                                      <FilterValue DataType="Boolean">true</FilterValue>
                                                    </FilterValues>
                                                  </Filter>
                                                </Filters>
                                              </Group>
                                            </TablixMember>
                                          </TablixMembers>
                                          <Visibility>
                                            <ToggleItem>COM_</ToggleItem>
                                          </Visibility>
                                        </TablixMember>
                                      </TablixMembers>
                                      <Visibility>
                                        <Hidden>=IIF(MAX(Fields!COM_.Value), FALSE, TRUE)</Hidden>
                                      </Visibility>
                                    </TablixMember>
                                  </TablixMembers>
                                  <Visibility>
                                    <Hidden>=IIF(Fields!WO_Grouping.Value = "alarm", FALSE, TRUE)</Hidden>
                                    <ToggleItem>WO_No</ToggleItem>
                                  </Visibility>
                                </TablixMember>
                              </TablixMembers>
                              <Visibility>
                                <Hidden>=IIF(Fields!WO_Grouping.Value = "alarm", FALSE, TRUE)</Hidden>
                              </Visibility>
                            </TablixMember>
                          </TablixMembers>
                          <Visibility>
                            <ToggleItem>ALARM</ToggleItem>
                          </Visibility>
                        </TablixMember>
                        <TablixMember />
                        <TablixMember>
                          <Group Name="CLICK_WO_2">
                            <GroupExpressions>
                              <GroupExpression>=Fields!OB_No.Value</GroupExpression>
                              <GroupExpression>=Fields!OB_Objecttype.Value</GroupExpression>
                            </GroupExpressions>
                          </Group>
                          <SortExpressions>
                            <SortExpression>
                              <Value>=Fields!OB_No.Value</Value>
                            </SortExpression>
                          </SortExpressions>
                          <TablixMembers>
                            <TablixMember />
                            <TablixMember>
                              <Group Name="WO_Standard">
                                <GroupExpressions>
                                  <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                </GroupExpressions>
                                <Filters>
                                  <Filter>
                                    <FilterExpression>=Fields!WO_Grouping.Value</FilterExpression>
                                    <Operator>Equal</Operator>
                                    <FilterValues>
                                      <FilterValue>standard</FilterValue>
                                    </FilterValues>
                                  </Filter>
                                </Filters>
                              </Group>
                              <SortExpressions>
                                <SortExpression>
                                  <Value>=Fields!WO_DueDate.Value</Value>
                                </SortExpression>
                              </SortExpressions>
                              <TablixMembers>
                                <TablixMember>
                                  <KeepWithGroup>After</KeepWithGroup>
                                </TablixMember>
                                <TablixMember>
                                  <Group Name="Wrapper2">
                                    <GroupExpressions>
                                      <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                    </GroupExpressions>
                                    <Filters>
                                      <Filter>
                                        <FilterExpression>=Fields!WO_Grouping.Value</FilterExpression>
                                        <Operator>Equal</Operator>
                                        <FilterValues>
                                          <FilterValue>standard</FilterValue>
                                        </FilterValues>
                                      </Filter>
                                    </Filters>
                                  </Group>
                                  <SortExpressions>
                                    <SortExpression>
                                      <Value>=Fields!WO_No.Value</Value>
                                    </SortExpression>
                                  </SortExpressions>
                                  <TablixMembers>
                                    <TablixMember>
                                      <Group Name="T_Wrapper2">
                                        <GroupExpressions>
                                          <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                        </GroupExpressions>
                                      </Group>
                                      <SortExpressions>
                                        <SortExpression>
                                          <Value>=Fields!WO_No.Value</Value>
                                        </SortExpression>
                                      </SortExpressions>
                                      <TablixMembers>
                                        <TablixMember />
                                        <TablixMember>
                                          <Group Name="CLICK_T_2">
                                            <GroupExpressions>
                                              <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                            </GroupExpressions>
                                          </Group>
                                          <SortExpressions>
                                            <SortExpression>
                                              <Value>=Fields!OB_No.Value</Value>
                                            </SortExpression>
                                          </SortExpressions>
                                          <TablixMembers>
                                            <TablixMember>
                                              <Group Name="T_2">
                                                <Filters>
                                                  <Filter>
                                                    <FilterExpression>=Fields!T_.Value</FilterExpression>
                                                    <Operator>Equal</Operator>
                                                    <FilterValues>
                                                      <FilterValue DataType="Boolean">true</FilterValue>
                                                    </FilterValues>
                                                  </Filter>
                                                </Filters>
                                              </Group>
                                            </TablixMember>
                                          </TablixMembers>
                                          <Visibility>
                                            <ToggleItem>T_2</ToggleItem>
                                          </Visibility>
                                        </TablixMember>
                                      </TablixMembers>
                                      <Visibility>
                                        <Hidden>=IIF(MAX(Fields!T_.Value), FALSE, TRUE)</Hidden>
                                      </Visibility>
                                    </TablixMember>
                                    <TablixMember>
                                      <Group Name="COM_Wrapper2">
                                        <GroupExpressions>
                                          <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                        </GroupExpressions>
                                      </Group>
                                      <SortExpressions>
                                        <SortExpression>
                                          <Value>=Fields!WO_No.Value</Value>
                                        </SortExpression>
                                      </SortExpressions>
                                      <TablixMembers>
                                        <TablixMember />
                                        <TablixMember>
                                          <Group Name="CLICK_COM_2">
                                            <GroupExpressions>
                                              <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                            </GroupExpressions>
                                          </Group>
                                          <SortExpressions>
                                            <SortExpression>
                                              <Value>CLICK_COM_2</Value>
                                            </SortExpression>
                                          </SortExpressions>
                                          <TablixMembers>
                                            <TablixMember>
                                              <Group Name="COM_2">
                                                <Filters>
                                                  <Filter>
                                                    <FilterExpression>=Fields!COM_.Value</FilterExpression>
                                                    <Operator>Equal</Operator>
                                                    <FilterValues>
                                                      <FilterValue DataType="Boolean">true</FilterValue>
                                                    </FilterValues>
                                                  </Filter>
                                                </Filters>
                                              </Group>
                                            </TablixMember>
                                          </TablixMembers>
                                          <Visibility>
                                            <ToggleItem>COM_2</ToggleItem>
                                          </Visibility>
                                        </TablixMember>
                                      </TablixMembers>
                                      <Visibility>
                                        <Hidden>=IIF(MAX(Fields!COM_.Value), FALSE, TRUE)</Hidden>
                                      </Visibility>
                                    </TablixMember>
                                  </TablixMembers>
                                  <Visibility>
                                    <Hidden>=IIF(Fields!WO_Grouping.Value = "standard", FALSE, TRUE)</Hidden>
                                    <ToggleItem>WO_No2</ToggleItem>
                                  </Visibility>
                                </TablixMember>
                              </TablixMembers>
                              <Visibility>
                                <Hidden>=IIF(Fields!WO_Grouping.Value = "standard", FALSE, TRUE)</Hidden>
                              </Visibility>
                            </TablixMember>
                          </TablixMembers>
                          <Visibility>
                            <ToggleItem>OTHER</ToggleItem>
                          </Visibility>
                        </TablixMember>
                        <TablixMember />
                        <TablixMember>
                          <Group Name="CLICK_WO_3">
                            <GroupExpressions>
                              <GroupExpression>=Fields!OB_No.Value</GroupExpression>
                              <GroupExpression>=Fields!OB_Objecttype.Value</GroupExpression>
                            </GroupExpressions>
                          </Group>
                          <SortExpressions>
                            <SortExpression>
                              <Value>=Fields!WO_No.Value</Value>
                            </SortExpression>
                          </SortExpressions>
                          <TablixMembers>
                            <TablixMember />
                            <TablixMember>
                              <Group Name="WO_healthandsafety_">
                                <GroupExpressions>
                                  <GroupExpression>=Fields!WO_No.Value</GroupExpression>
                                </GroupExpressions>
                                <Filters>
                                  <Filter>
                                    <FilterExpression>=Fields!WO_Grouping.Value</FilterExpression>
                                    <Operator>Equal</Operator>
                                    <FilterValues>
                                      <FilterValue>healthandsafety</FilterValue>
                                    </FilterValues>
                                  </Filter>
                                </Filters>
                              </Group>
                              <SortExpressions>
                                <SortExpression>
                                  <Value>=Fields!WO_No.Value</Value>
                                </SortExpression>
                              </SortExpressions>
                              <TablixMembers>
                                <TablixMember />
                              </TablixMembers>
                            </TablixMember>
                          </TablixMembers>
                          <Visibility>
                            <ToggleItem>HEALTH</ToggleItem>
                          </Visibility>
                        </TablixMember>
                      </TablixMembers>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>DataSet_Result</DataSetName>
            <Top>0in</Top>
            <Left>0in</Left>
            <Height>7.17716in</Height>
            <Width>9.84252in</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
        </ReportItems>
        <Height>18.82999cm</Height>
        <Style />
      </Body>
      <Width>25cm</Width>
      <Page>
        <PageHeader>
          <Height>1.905cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Image Name="Logo">
              <Source>Embedded</Source>
              <Value>encome</Value>
              <Sizing>FitProportional</Sizing>
              <Top>0.2cm</Top>
              <Left>20.53667cm</Left>
              <Height>1.5cm</Height>
              <Width>4.46333cm</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
              </Style>
            </Image>
            <Textbox Name="Textbox14">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">CMMS Incident Report</Value>
                      <Style>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>24pt</FontSize>
                        <Color>DimGray</Color>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Left</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox14</rd:DefaultName>
              <Height>1.905cm</Height>
              <Width>18.98037cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <VerticalAlign>Middle</VerticalAlign>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageHeader>
        <PageFooter>
          <Height>0.7175cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="Textbox9">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">="From: " + First(Fields!GEN_StartDate.Value, "DataSet_Result") + " To: " + First(Fields!GEN_EndDate.Value, "DataSet_Result")</Value>
                      <Style>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Color>DimGray</Color>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style />
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox9</rd:DefaultName>
              <Top>0.3175cm</Top>
              <Height>0.4cm</Height>
              <Width>8.33cm</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
              </Style>
            </Textbox>
            <Textbox Name="Textbox10">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">="Document Date: " + First(Fields!GEN_DocumentDate.Value, "DataSet_Result")</Value>
                      <Style>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Color>DimGray</Color>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox9</rd:DefaultName>
              <Top>0.3175cm</Top>
              <Left>16.67cm</Left>
              <Height>0.4cm</Height>
              <Width>8.33cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
              </Style>
            </Textbox>
            <Textbox Name="Textbox11">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value EvaluationMode="Auto">CMMS Incident Report</Value>
                      <Style>
                        <FontFamily>Segoe UI</FontFamily>
                        <FontSize>8pt</FontSize>
                        <Color>DimGray</Color>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox9</rd:DefaultName>
              <Top>0.3175cm</Top>
              <Left>8.335cm</Left>
              <Height>0.4cm</Height>
              <Width>8.33cm</Width>
              <ZIndex>2</ZIndex>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageFooter>
        <PageHeight>21cm</PageHeight>
        <PageWidth>29.7cm</PageWidth>
        <InteractiveHeight>21cm</InteractiveHeight>
        <InteractiveWidth>29.7cm</InteractiveWidth>
        <LeftMargin>2.1cm</LeftMargin>
        <RightMargin>0.5cm</RightMargin>
        <TopMargin>0.5cm</TopMargin>
        <BottomMargin>0.5cm</BottomMargin>
        <ColumnSpacing>1.27cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function
</Code>
  <EmbeddedImages>
    <EmbeddedImage Name="encome">
      <MIMEType>image/jpeg</MIMEType>
      <ImageData>/9j/4AAQSkZJRgABAQEBLAEsAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCADTAlgDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/K+N/wDgo5/wWo+Ff/BPMy6HcPJ40+IXlh08OabMFNsCMq11OQVgBHO3DSEEHZtOao/8FuP+Clr/APBPT9mhIfDs8P8AwsjxyZbHQAyh/wCzo1A8++ZTwfKDKqBuDJIhIZVcV/Nr4h8RX/i7Xb3VNUvbrUtS1Kd7m7urmZpZ
rmV2LO7uxJZmYkkkkkkkmv1HgTgKOaQ+v4+6pXsktHK2+vSK201bvZq2vxPE/FDwUvquF/idX/L/AMH1Pt79pP8A4OIv2kfjzeTxaP4i0/4b6LKcLZeHLRUm29i11Lvm3epRowf7o6V8l+Pf2l/iP8VJ3l8T+P8Axp4ikkPzNqet3N2T1/56Of7zD8T6muJrrvhn+z34++Ncm3wb4H8YeLmUkEaNo9zf4I7fukbpX7nhcpy3L4fuaUKaXWyX3vf72fmNbH4zFy/eTlJ9rt/h/kcjRXvkH/BLD9pG4hjkX4H/ABO2yAMA3h+4VhnpkFQR9Dginf8ADqn9pL/oh/xM/wDBBP8A/E1t/bGA/wCf0P8AwKP+Zn/Z+K/59y/8Bf8AkeA1sR/EfxDDt2a9rS7fu4vZRjH/AAKvZv8Ah1T+0l/0Q/4mf+CCf/4mj/h1T+0l/wBEP+Jn/ggn/wDiaUs1y+XxVof+BR/zKjgcWtqcvuZ57pP7VPxQ0CdpLH4kePLKRxtZoPEF3EzDrjKyD2OK/oD/AODeL48eMP2gP+Ce66n428R6x4q1bTfEl9psN/qly91dtAqQyKryuS77WlcAsSQMDOAAPw+/4dU/tJf9EP8AiZ/4IJ//AImv3K/4N+P2c/G37M37Ah0Px54d1DwvrOoeJL3Uo7C+QJcJA6QRqzp1QkxOdrYOMHGCK/NvEyvl1TKP3EoOfPHZxv1vtrY+x4Np4uGP/eKSjyve9unfQ+5KKKK/n8/VT8Q/+Dgv/gqV8Xvhh+1zdfCfwH4s1bwL4e8Oadaz3U+jXJtb3Uri4h80u06YkRFSRVVFIGVZiSSoX89P+HjH7Q3/AEXb4z/+FrqX/wAer37/AIOLf+UrXjj/ALB2k/8ApBDXw5X9WcJZTgo5NhpKlG8oRbfKm22k2235s/C8+zDEvMKy9o7KTS1eiTskfTnwU/4LG/tJfBTxlperQ/Frxl4ih0+dXl0/X9Sk1S2vY92XikE5Y4YZ
XcpDKD8pBAI/pM/ZY/aK0P8Aaz/Z78I/Ebw43/Er8V6el4sRcO1rJyssDkcF4pFeNscZQ44r+Rev1q/4NhP28x4M+ImtfAbxBeMun+KXfV/DJkf5YL1Iybm3GTx5sSB1AwA0L9TJXzPiRwnQrYD69hKajOlq+VJXj1vbtv6X7ntcH57Up4r6tXk3Geiu72fT79vWx+4VFFFfzyfrQUUUUAFcb+0F49uvhR8BfG/imxihmvvDegX2q28cv+reSC3klUNjnBKDOK7KvM/21P8Akzj4s/8AYm6x/wCkU1dGDip4iEZbNr8zHEScaUpLez/I/mT8U/8ABT39ozxh4hutSuvjl8Vobi8kMskdj4nvLG3Uk9EhhkWONf8AZVQAOgr1D9gf/gp38ftC/bI+GsN38XPiD4i03VvEun6bfadrmvXWp2d3bz3McUiNHO7KCUdsMuGU4IIIFfHdemfsWf8AJ4/wl/7HPR//AEuhr+ucdlOB+qVI+xhblf2V29D8EwuYYn28H7SV7rq+5/XBRRRX8fH9AhRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB/NT/wcCftFz/H7/gpd4xs1naTSfAMcXhiwQMdqGEb7gkdN32iSYZHJCqD0FfFNeg/tb+IZvF37VfxO1a6ybjVPFmq3cpJzl5LyV25+pPJrz6v7IyXBxwuAo4eG0YxX4K/3vU/nnMsRKviqlaX2pN/ifsL/wAG/P8AwR38IfFv4ZwfHH4q6Pb+I7a/unj8LaHeR77ExwyFJLueM8TZkVkRGygEbMQ+5dn7N6TpFroGmQWdjbQWdnaoI4YIIxHHEo4Cqq8AD0HArx3/AIJveCYfh5+wB8FtKijSM2/grSZJgn3TNJaRyykcDrI7nOM8+te3V/LfFWdY
jMsxq1K0m4qTUV0STsrL037s/bsjy6lhMJCFONm0m31bau9fy8gooor5s9gKKKKACiiigAooooA/m2/4OLf+UrXjj/sHaT/6QQ18OV9x/wDBxb/yla8cf9g7Sf8A0ghr4cr+veFf+RLhP+vcP/SUfgGef8jGv/jl+bCtr4bfEXWPhF8QtE8U+Hb6XTdd8O30Wo2F1HjdbzxOHRsHg/MBwcgjIIIJFe8fHj9hu48D/wDBPL4HfHfR4ZZNI8arqWka+wYt9m1CDU75IH/2Vlt4lUAcBrdiTlxn5tr08PiqGMpy5NUnKLXnFuMk/u+a9TjrUamHnHm0bSkvRpNP+up/Wf8AsO/tY6P+2z+y74R+I+jNCn9vWa/b7VG3f2dep8txbnv8kgYAnll2t0YV67X4K/8ABs1+3j/wpv4/ah8F9eutnh74jubrR2kfCWmrRx/cHYfaIU25JyXhhUDLGv3qr+VeLsheUZnPDL4H70P8L2+7VfK5+45Bmix+DjWfxLSXqv8APf5hRRRXzJ7QV5n+2p/yZx8Wf+xN1j/0imr0yvM/21P+TOPiz/2Jusf+kU1dWB/3qn/iX5owxX8Gfo/yP5H69M/Ys/5PH+Ev/Y56P/6XQ15nXpn7Fn/J4/wl/wCxz0f/ANLoa/sjHf7tU/wv8j+ecL/Gh6r8z+uCiiiv4tP6NCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+Oz4ksz/ETX2Y7mbUbgkk9f3jVjVs/Eb/AJKJr3/YRuP/AEa1Y1f2xS+Bei/I/m+p8TP64P2K/wDkzj4Tf9ibo/8A6RQ16ZXmf7Ff/JnHwm/7E3R//SKGvTK/jHHf7zU/xP8AM/onC/wYei/IKKKK5TcKKKKACiiigAooooA/m2/4OLf+UrXj
j/sHaT/6QQ18OV9x/wDBxb/yla8cf9g7Sf8A0ghr4cr+veFf+RLhP+vcP/SUfgGef8jGv/jl+bP6Ev8Agl1+zFof7ZP/AAb7+Efhv4hXbY+JbLWoY7gLuawuF1q+eC4T/ajlVHx0O0joSK/BD4vfCjXPgZ8UfEHg3xLZvp+veGb+XTr6Bs/JLGxU7TxuU43Kw4ZSCMgg1/R7/wAG/P8AyiJ+Ef8A3GP/AE9X9fEH/B0H+wb/AGP4g0T4/wDh+1/0fVDFoPilI0+7OqkWl0x6/MimFicAGOEclq/MuEuIvq3EmMy2s/cq1ajj5TUn/wClLT1SR9nn2U+2yfD4ymvehCN/8Nl+T/Bs/Ivw14kv/BviTT9Y0q8uNP1TSrmK8s7mB9stvNGwdHQ9mVgCD2Ir+qb/AIJuftnaf+3n+yD4V+IFq0KapcQ/YddtY+llqUIUTx47KxIkQdfLlQnk4r+Uyv0Y/wCDcP8Abwb9m39rBvhrrt8sPhD4qMlrEZWxHZ6sgItnGenmgmAgfeZoSThK+o8SOHv7Qy14ikv3lG8l5x+0vu1XpbqeLwfm31TGeym/cqaPyfR/p8/I/oUooor+Zz9mCvM/21P+TOPiz/2Jusf+kU1emV5n+2p/yZx8Wf8AsTdY/wDSKaurA/71T/xL80YYr+DP0f5H8j9emfsWf8nj/CX/ALHPR/8A0uhrzOvTP2LP+Tx/hL/2Oej/APpdDX9kY7/dqn+F/kfzzhf40PVfmf1wUUUV/Fp/RoUUVzPxd+LHh/4F/DPW/GHivUrfR/Dvh21e9vruZsLFGvoOrMxwqqMlmZQASQKqEZTkoQV29El1fYmUlFOUtka3iDxFp/hPRLrUtVvrTTdNsYmnubq7mWGC3jUZZ3diFVR1JJAAr84f2vf+Dmj4PfBDUbrSPhzpGqfFTV7dihvIZv7P0cNyDtndWklKnn5ItjDpJzmvzD/4Kp/8FfvGv/BRfx3c6daz3nhz4WafcZ0rw8km
03O0/Lc3hU4kmOMheUizhcnc7/HtfufDPhXRVNV84bcnryJ2S8pNat+jVu7PzPOeOKnO6WX6L+Z6t+i6L1/A/Rz4n/8ABz5+0R4yu5hoOn+AfB9qxPki20uS7nQc/eeeR0ZvcRqOBx1zw3/ERb+1b/0PGjf+E3Yf/Gq+HKK/RKXCGSU48scLD5xT/F3Z8jPiDMpO7ry+Ta/I+9fD3/Byb+1Josoa517wnqy7w2278PQICB/D+68s4P5+hFem+A/+Dqz40aTJGviLwF8N9chXAJs47ywmf1yxmlXJ9QgA9DX5e0VnW4LyOqrSwsPkrflYqnxHmcNVWl83f87n9GP/AAS6/wCC7Xh3/goz8WZvAN54G1HwR4qXT5NRttuorqNlepEVEi7/AC43jfDBgpQghWywIAb77r+c/wD4NplLf8FP9LwD8vh3UyeOnyJX9GFfgHH+S4TK80+r4KPLBxTtduzba3d307n6twrmNfG4L2uId5KTV7Jdu2nUKKK/EX/gtd/wXj1jxJ4p1j4R/BDWn0zQ9PdrPXfFdjKVuNSlGQ9vZyKf3cKnKtKvzSEEKQgJk8fh7h3F5xivq2FW2spPaK7v9Fu/S7PQzbNqGX0fbVvkurf9bs++v23P+C3HwJ/Ye1O80TVNcuPF3jCzJSXQfDqJdT2z9Cs8pZYYSD1Vn8wDnYeM/nP8a/8Ag6u+J2v3k0fgD4d+D/DFizYWXWJp9VuioPDDY0CKT3BVgMkAk4NflWzGRizEszHJJPWiv3zKfDPJsJBe2j7WXeW3yina3rf1PyzHcZZjXl+7fJHst/vev3W9D7ovf+Djf9qq7u5JI/GGg2qN0ii8OWZVPpuRm/Mmrfhz/g5J/al0O+8658ReF9Yj/wCeF34et1jP/fkRt+tfBlFfRf6p5K1b6rT/APAI/wCR5H9vZje/t5/+BM/YH4A/8HXusW11b2/xS+FunXluxAmv/C149vJGPVba4Lhz7ecoz3r9Mv2Nf+Ck
Xwf/AG9NHeX4eeLLe81S3jEl3ot4htNUsx3LQtyyjgF4y6ZON2eK/lMrU8EeOdZ+Gni/T9e8O6rqGh65pM63Fnf2M7QXFrIOjo6kFSPUfSvlM68L8qxUHLB3oz6WbcX6p/o18z3st42x1GSWI/eR89H8mv1uf2MUV+bX/BEj/gtfH+2taQfDL4mXFrZ/FSxty1jfKqww+KIUXLMFGAt0qgsyLgMoZ1AAZV/SWvwLOMnxWWYqWExcbSX3NdGn1T/rU/U8vzCjjKKr0HdP70+z8/62CiiivLO0K5X4ufGfwn8BfAt14l8a+ItI8L6DZ/62+1K6S3hDEEhAWI3OcHCLlmPABPFcf+2n+194W/Ya/Z1174ieLJGax0lBHaWUbhZ9Uu3yIraLP8TkHJwQqqzHhTX8y37cP7e/xE/b9+LVx4o8davNLbpI40vR4JGXTtGiJ4jhjzjOMBpDl3IBYnAA+44P4Jr53J1ZPkoxdnLq32j593089j5niDiSllsVBLmqPZdl3f8Al1P2H/aG/wCDpH4OfDu+uLPwD4V8VfEaaEkLduy6Np8/OPkeRXn9/mgHBHXnHzH4v/4OuvirfPJ/YHwx+H2mKQfLGoT3d8VPuUkhzj0AGfUV+VdFfteD8Ochw8bOjzvvKTf4JpfgfnGI4wzSq7qpyrskl/m/xP00tP8Ag6p+P6XMbTeC/g7JCD86x6ZqSMw9mN8QPxB+lelfDD/g7I162vIo/Gfwe0m8t2GJJtF1qS1eP3Ecscgb0wXXrnPGD+QNFdVbgLIai5XhkvRtfk0YU+Kc0g7qs/mk/wA0f02fsaf8Fv8A4A/toana6PpfiKfwj4ouiI4tF8TIljPcucALDKGaGVieAiybz/cFfYFfxp19LeJv+Cunx68Wfsm2fwbvPHGoN4ZtmeOW7V2GqXtqQoWzlus72t1wcLwSHKsWQKi/BZx4RxdWMstq2i3qpa2XdNb+j+8+py/jxqm1jIXaWjjpd9munqvu
P3E/a6/4Lz/s9fslandaS3iK68eeI7UlJdN8LRpeiB+mJLhmWBSDkMqyM64OVzgH4i+Jn/B2Rr1zeSp4N+Duj2MC8Rzazrcl08nuY4o4wvbgO3154/IKivqMt8Mckw0V7aLqy7ybX4RaX339TxMZxpmVaX7tqC7JL83f9D9Nb3/g6r+Pz3Ttb+Cfg9FCTlEl03UZGUe7C+XP1AH0rd8Hf8HXPxXsZY/7f+Gfw91SNR+8GnzXlizHPUF5JsccY555z2r8raK9iXAuQyXK8NH8V+Kdzz48T5ondVn+H+R+/P7Nn/B0J8F/ilqVtp/j7w74l+Gd1cMF+1sRq2mwn/aliVZhzxkQEY5JFfon8N/iV4d+L/g+z8ReFNc0rxHoeorvttQ066S5t5x7OhI4PBGcg5Bwa/jzr6M/4Jxf8FLfHn/BOP4uRax4euJtS8K38yjXvDc05W01WPoWHURzqPuSgEgjBDKSp+J4g8KcNKk6uUtxmvst3T8k3qn6trvbc+kynjmspqGOSlH+ZKzXqtmvSx/VBRXE/s9fHrw3+0/8FfDvj7wjfLqHh/xNZrd2svAdOoeNxk7ZI3DI69mRh2rtq/CalOdObp1FZp2ae6a3R+oQnGcVOLunqgooorMoK+Uf23f+CynwN/YUu7rSfEXiKTX/ABdbghvD2gIt5fRN6THcsUHUHEjq2DkKa+D/APgtl/wXk1TTvFGsfB/4G6w2nx6fI1p4h8W2cuJpJRlZLWzcfcVT8rzKdxYEIQBuf8c7m5kvLiSaZ3lmmYu7uxZnYnJJPqevPWv17hPwxli6UcXmjcYS1UFpJru30XlvbsfA59xmqE3QwSUpLRyey9O/rt6n6vfG7/g62+IWt3Mkfw9+GfhPw7a5KrPrl1Pqk7L/AHtsZgRT3wd4HTJ614Vqf/Bx5+1Tf3rSQ+LfD9jG3SGDw5aMi/TejN78k18KUV+rYbgrI6EeWGGg/wDEuZ/fK58LW4kzOq7yrSXo7flY
+7tD/wCDkD9qfStQSafxR4a1KNesFz4dtVjbkHny1Ru2OGHB9cEe+/Av/g648ZaRPDD8SPhf4d1yDISS78PXkunTIvd/Km85Xb2DxgnuBxX5KUUsVwTkdePLPDRX+Fcr/wDJbBR4kzOk7xrSfrr+dz+pT9ib/grR8E/29DFZeDfE32HxMyb28O6ygs9TAAydiZKTYGcmF3AA5xX0xX8bek6tdaFqdve2NzcWd5ZyLNBPbyGOWB1OVZWXBUggYIwQea/cL/gh3/wXKu/j1rem/B34yaisvi64xb+HPEc5C/20QMC1uTx/pJx8kn/LU/Kf3mDJ+ScXeGs8BSljctbnTWri/iS7rul10ut9dWffZDxjHEzWHxiUZPZrZ+Xk/wAGfrFRRRX5OfdH8dnxG/5KJr3/AGEbj/0a1Y1bPxG/5KJr3/YRuP8A0a1Y1f2xT+Bei/I/m+p8TP64P2K/+TOPhN/2Juj/APpFDXplfyt+GP8AgrV+0h4L8Nafo+lfF7xdY6XpNtHZWdtHMmyCGNAiIvy9FUADnoK0P+HyH7UH/RavGf8A3+j/APiK/BsR4S5jUqyqKtDVt/a6v0P1Cjx3hIQjB05aJLp/mf1KUV/LX/w+Q/ag/wCi1eM/+/0f/wARR/w+Q/ag/wCi1eM/+/0f/wARWP8AxCHMv+f0P/Jv8jT/AF+wf/PuX4f5n9SlFfy1/wDD5D9qD/otXjP/AL/R/wDxFH/D5D9qD/otXjP/AL/R/wDxFH/EIcy/5/Q/8m/yD/X7B/8APuX4f5n9SlFfy1/8PkP2oP8AotXjP/v9H/8AEV+6H/BD39sXxh+23+wpY+KPHlzBqHiXS9YutFuL+OJYW1BYlikSV0QBFfbKFO0AHZnAJNeBxJwDjcnwqxdacZRulpe6vtul2PWyfinDZhW9hTi4u19bfo2fYlFFFfCn0x/Nt/wcW/8AKVrxx/2DtJ/9IIa+HK+4/wDg4t/5SteOP+wdpP8A6QQ18OV/
XvCv/Ilwn/XuH/pKPwDPP+RjX/xy/Nn9MH/Bvz/yiJ+Ef/cY/wDT1f19K/tE/AjQv2mvgd4o8A+JYftGieKtPksLjCgtFuHySpnpJG4V1PZkU9q+av8Ag35/5RE/CP8A7jH/AKer+vsyv5g4gqTp53ialN2aqzafZqbsz9qymEZ5bRhJXThFP/wFH8hP7SPwC179lr47eKvh94mh8jW/Cl+9jPtB2TgcxypnnZIhSRSeSrqa42yvZtNvYri3llt7i3dZIpY3KvE4OQykcgg4II5B5FftN/wdBfsGjW/DGh/H7w9Zs15pfl6J4pES/ft2JFrdNj+45MLMckiSEcBK/FWv6c4XzyGb5bTxa+Jq0l2kt16PdeTR+MZ3lssBjJUHtun3T2/yfmmf1Jf8EmP25If2+/2MvDvi64lj/wCEp00f2N4khUj5L+FV3SAcYWZCkoA4AkK5O019NV/OD/wb9/t5r+x/+2Za+G9cvzbeB/icY9HvzI37m0vdx+x3J9MSMYmYkALOzH7gx/R9X868ccP/ANk5nKnBfu5+9D0e6/7denpZ9T9c4Zzb69glKT9+OkvXv81r63CvM/21P+TOPiz/ANibrH/pFNXpleZ/tqf8mcfFn/sTdY/9Ipq+ZwP+9U/8S/NHs4r+DP0f5H8j9emfsWf8nj/CX/sc9H/9Loa8zr0z9iz/AJPH+Ev/AGOej/8ApdDX9kY7/dqn+F/kfzzhf40PVfmf1wUUUV/Fp/RoV+G//Bzl+35deM/inp3wE8P3jJovhURan4lMT8Xl/IgeCBsfwwxMHxnBeYZAMYNftl428XWPgDwdq2vanJ5Gm6JZTX93J/zzhiRpHb8FUmv5Evjj8WtT+Pfxk8U+NtaZn1TxZqtzq1zlywR5pGfYD/dXdtUDAAAAAAAr9U8KcljisfPHVVdUUrf4pbP5JP0bTPh+OMylRwscNB61N/Rf5tr5XOWr6y/4JVf8EofFf/BS34k3AiuJfDvw/wDD
8irrevtDvIYjcLW2U8POwwTk7Y1IZskoj/LPh3QLzxXr9jpenW8l5qGp3EdrbQRj555HYKiD3LED6mv6wP2F/wBk7R/2J/2WPCPw50eOHdolmh1G5jXH9oXzgNcTnud8hbGeQoVeiiv0rj/iqeT4OMMP/FqXS8kt366pLzd+lj43hXI45hiHKt8ELX829l/n/wAE5H9mP/gk78Af2TdGtoPDHw38P3mowAbtY1q2TU9SlbHL+dMCY89SIgi56KK+hrCwt9LtEt7WGG3t4+EjjUKqd+AOnfpViiv5rxWNxGKn7TEzc5d22/zP2TD4alQjyUYqK8lYx9S8B6HrU0kl5ouk3cs3EjTWkcjSDGOSQc8cc1xXij9jP4P+NU2618Kfhrqy4C4vfDFlccA5A+aI9Dk/WvTaKzp4itT1pza9G0VOjTn8UU/keZ/Bb9jz4Vfs461eal4D+Hfg3whqGoReRc3Wk6TDazSx5DbC6qDs3AHbnGQDjgV6ZRRU1q1SrLnqycn3bu/vYU6cKceWmkl5aH59/wDBwt+37cfsi/slp4R8N6g1n43+KBl06CSFys2n6coH2q4Ug5Vm3pEp4P712U5j4/nXr7Q/4L8ftHzftC/8FLvGtuly02keAvL8LaenaE24zcj0z9qe4GeuAoPQAfF9f1JwDkkcuyinp79RKcn11V0vkrL1v3PxPirMpYvHz192Hur5bv5v9Duv2a/2b/F37Wnxo0TwF4H01tU8Q65L5cSFtkVuijc80r9EjRQWZjnAGACSAf3q/YY/4N3fgv8As1+HLG++IGmW3xV8aMivczarGW0m2k6mOC0PyOg6bpw5bGcJkqOd/wCDaz9h+z+B37JknxX1SxX/AIS34oFmt5ZF/eWmkxSFYo1/u+bIjTMQcMvk5Hyiv0qr8v4+44xdXFzy/AzcKcHZuLs5Nb6rWyellvq3fS323C/DNCFCOLxUVKctUnqkumnd736HP+Cfhf4Z+Gtmtv4d8O6F
4ft408tYtN0+K1RV44AjUDHyjj2HpWL8T/2a/h78bNOms/GHgXwj4nt7jJddT0mC6OW6sC6khu+4EEHnINd1RX5ZGvVjP2kZPm73d/vPtpUoOPI0rdrH5K/8FIv+Darwt4r8Maj4s/Z/Enh3xFaxtcP4UuLhpbDU8DJS3lkJeCU84V2aMkqP3Qya/EjX9BvvCuuXul6pZ3Wn6lps8lrd2txE0U1tKjFXjdGwVZWBUqQCCCCM1/ZDX4Y/8HQX7ENj8NPin4a+NmgWa21l44kOkeIFjQLH/aMce+Gb/fmhSQN0ybbdyWJr9p8OuNsTWxCyvMJ83N8EnvdK/K31ur2b1vp1Vvzvi3hujTovG4WPLb4ktrPql08+ltT8t/AvjrWPhl400rxFoGoXWla3od3Ff2F5A22W1njYOjqfUMAecj1BFf1P/wDBN/8AbJsf28f2QfCfxEtxHDqV5AbPW7ROlnqMOEnQDJwrNiRMnPlyITgkiv5Sq/XD/g1Q/aSm0j4p/Eb4TXdwxstbsI/EumxM2EiuIGSC4Cj+9JHLCT7W3sc/SeJ+RwxeVvGRXv0db9XF6SX6/J9zxuC8ylQxv1dv3amnz6P9Pmft5RRRX82n7Cfgj/wdCftX3HxH/av0P4UWN439i/DrTo7u+gU4D6jdoJMsP4tlsYNpOcGWQcZOfzBr3T/gp14/k+J3/BQ/41avJIZlfxjqVrC5z80MFw8EXBAP+riTjGR07V4XX9fcL5fDBZVQw8FtFN+rV3+LZ+AZ3ipYjHVasusnb0Wi/BH0F/wTo/4Jz+Nv+Cj3xp/4RnwuF03R9NVZ9d125jL2ukQMSFyBjzJX2kJGCCxBJIVWYfvd+yN/wRH/AGe/2SdDtRD4J07xt4hjCmbW/FEEeozySDndHE6+TDg5x5aBgMAsxGab/wAEPv2WLH9lz/gnV4BSO1ji1zxvZR+KdXnKbZJpLtBJCrdx5duYY9vYqxwCTX19X4PxtxtjMbjKmFw0
3CjBuNk7c1tG21q03strW0ufqHDfDeHw+HjXrRUqkknqr2v0X6ve/kcjqfwJ8Ea5pC6de+DfCt5YKuxbafSbeSFRjGAhQjGCRj0OK+Hf+Chf/BvV8Jv2lPBmpar8MtH034Z/ECONpbT+z0MGj6g4yRFPbL8kSsePMhVSuQSrhQtfohRXxuW53jsBWVbC1XFrzdn5NbNep9DjMtwuKpunXgmvTVej3R/HP468E6t8NPGmreHdesLjS9b0K7lsL+znG2W1nicpJG3bKsCOMjjisuv0S/4OaPgTafCz/goZb+JLC3WC3+IPh+21S5KIVVruJntpMdsmOKFiRyS5JGTk/nbX9aZJmSzDAUsalbninbs+q+Tuj8HzPBvCYqeHf2W18un4F7wx4Y1Lxt4k0/R9IsbrUtW1S4jtLO0t4zJNczSMFSNFHLMzEAAcknFfuP8A8E5f+DbDwX8OvDml+KPjwjeLvFVwiT/8I3FcFNJ0skAhJmjIa4kXgNhhFnIxIMMfmr/g13/ZXsfit+1L4s+JWrWsd1b/AA00+GHTVlTKpf3pkVZVJ4JjhhmHqDKh4IBr97K/JfEjjLFUMT/ZeBk4cqXPJaO7V0k+itZu2utumv3vB/DtCrR+vYmPNd+6ntppdrrrscN4I/Zq+HXwy0ddP8OeA/Bug2Krt8jT9GtrePHuEQDufzNeYftIf8Er/gH+1N4euLPxN8M/DMN1Im2PVNIs003UYDgYKzwhWbbgYV9ydipBIP0RRX47RzHF0avtqVWSl3Td/vufoFTB0KkPZzgmuzSsfy8f8FW/+CY+u/8ABNH45W+jy3k2ueC/Ekcl14d1l49jzohAkglA4E8W5N235WV0YAbii/LVf0g/8HE/wKtPjD/wTL8Uaq1usuqeAb2016ykCZdAJVt5hkc7fJnkYjplFJ6Aj+b6v6d4D4gqZtlarV/4kW4yfdqzT+aav0vex+L8UZXDAY106XwyV15X6fJr7j9kv+DVb9q6
6nuviB8F9Ru5JLaGFfFOiRu5PkYdILyNc8YYvbOFGMHzGwSxI/Zqv5n/APg398ezeBv+CrXw1VZCtvri6hpdyAfvrJYzsg6j/lqkR79MAZxX9MFfjXihl8MNnbqQVlUipfPWL+/lv8z9D4KxUq2WqEvsNr5aNfnYK+FP+C+X7f1x+xT+x8+keHb9rPx58SWl0nSpon2zWFsFBu7tSCCGVHWNWHKvMjD7pr7rr+cL/g4t/aNm+OP/AAUk13RIZvM0j4b2Nv4ftVVvlMu3z7lsf3xLM0ZPcQr6Vw+H+SwzLOIRqq8Ka52u9rWX3tXXVXOrirMpYPASlB2lL3V89391/mfCFdx+zh+zl4u/ay+Mmi+A/A+lyat4i1yYxwx52xwIBl5ZX6JGi5ZmPQDgEkA8PX76f8GzP7Ftj8I/2U7n4ualZqfFHxKmkhsppE+e10uCUxqi9x5sySOx43KsRxgAn+gOLuII5Nl0sXa8m+WK7yffySTb72t1PynIMpeYYtUNo7t+S/z2Os/Yb/4N1vgv+zf4dsdQ+IWnW/xU8abRJcS6krf2RbORykNr92RRyN04cnqAmcD7o8EfCbwr8NLZIPDnhnw/4fhjBCR6bp0Nqi5ABwI1AHQD8BXSUV/LuZZ1jswqOpi6rk33ei9Fsl6I/bMHluGwsFDDwUflr83uzmfHXwd8I/E+0kg8TeFfDniKCbAkj1PTYbtHwMDIkUg+nPavg39vT/g3O+EP7RHhm81L4X2Nr8LfGygyQLab/wCxr5gOI5bfJEIOAN8AXbySjniv0Yop5ZnmPy+oqmEqyi10vo/VbNeoYzLcLi4OFeCfy1+T3R/H38afgv4m/Z5+Ket+C/GGlz6L4k8PXLWt7aS4JRhyCGGQyMpDKykhlYEEgg1zunajc6RqNveWdxNa3drIs0E8LmOSF1OVdWGCrAgEEYIIzX7Q/wDB07+x/Z3fhHwb8btLtRHqFncr4Z11o0/18Lh5bWV8f3GWWMsc
kiWMZAUCvxYr+p+GM7jm+WwxlrN6SXaS0a9Oq8mfiGdZbLAYuWH3S1T8nt/l6n9Q/wDwSB/bn/4b5/Yr0DxRqE0L+LtFY6J4ljX5f9NhVT52PSaNo5eAAGd1H3TRX5ff8Gsn7Qsngv8Aaw8ZfDm4mZdP8c6GL+3jJyDeWT5GB2zBNOSR18tQc4GCv5t42yaOW5vVoUlaD96PpLW3yd0vQ/X+G8weMwEKs9ZLR+q/zVn8z80viN/yUTXv+wjcf+jWrGrZ+I3/ACUTXv8AsI3H/o1qxq/q6n8C9F+R+G1PiZrQfD/XrmFJI9E1iSOQBlZbORlYHkEHHTvkU/8A4Vz4i/6AOs/+AUv/AMTX9Y/7Ff8AyZx8Jv8AsTdH/wDSKGvTK/F63i9OnVlT+qp2bXx9v+3T9GpcAxnBT9vuk/h/+2P47P8AhXPiL/oA6z/4BS//ABNH/CufEX/QB1n/AMApf/ia/sTorH/iMU/+gRf+B/8A2pp/xD2P/P8A/wDJf/tj+Oz/AIVz4i/6AOs/+AUv/wATR/wrnxF/0AdZ/wDAKX/4mv7E6KP+IxT/AOgRf+B//ah/xD2P/P8A/wDJf/tj+Oxfht4idwq6BrTM2AALGTn/AMdr+iX/AIN3vgb4s+BP/BOq1s/F2h6h4fvtc8QXmr21pewtBcC2kSGNHeNgGTcYmYBgCVKt0YV93UV81xV4g1M5wawfsVBXTb5ubb5K34nsZHwnDLsR9Y9o5O1trb/NhRRRX50fXH823/Bxb/yla8cf9g7Sf/SCGvhyvuP/AIOLf+UrXjj/ALB2k/8ApBDXw5X9e8K/8iXCf9e4f+ko/AM8/wCRjX/xy/Nn9MH/AAb8/wDKIn4R/wDcY/8AT1f19mV8Z/8ABvz/AMoifhH/ANxj/wBPV/X2ZX8ucS/8jjF/9fan/pTP23Jf+RfQ/wAEf/SUc18Wvhbovxu+F/iDwf4jtVvtB8TafNpt9B0LxSoUbB7MAchhyCARyBX8
o37ZH7L2tfsZ/tMeLvhvrpaa78M3zQw3OzYt/bMA8Fwo5wJImR8ZOCSCcg1/W9X5U/8ABzf+wX/wtH4L6V8bvD1ira54EAsPEHlJ+8utLkf93Ke7eRM3QdEnkJOEFfYeGXEH1HMPqdV/u61l6S+y/nt812Pn+M8p+s4T6xTXvU9fWPX7t/v7n4UqxjYMpKspyCD0r+m//gip+3gf27v2J9G1LVrpbjxt4RI0HxGC2ZJ5o1HlXRB5/fRbXLcAyCUDha/mQr7G/wCCH37eK/sM/tr6XNrF41v4I8cqmg6+WbEduruPIu27YhkI3N1Eby4BJAr9a8QOHv7UyyXs1+8p3lHu+6+a/FI+D4Vzb6ljUpv3J6P9H8n+DZ/TNXmf7an/ACZx8Wf+xN1j/wBIpq9MrzP9tT/kzj4s/wDYm6x/6RTV/MuB/wB6p/4l+aP2fFfwZ+j/ACP5H69M/Ys/5PH+Ev8A2Oej/wDpdDXmdemfsWf8nj/CX/sc9H/9Loa/sjHf7tU/wv8AI/nnC/xoeq/M/rgooor+LT+jT5h/4LNfEFvhl/wS7+NGpRuEa40A6SSTjIvZo7Mj8ROR75r+XGv6TP8Ag4j1KWy/4JO/EKONgqXd5pMMvy5yo1K2f8PmRTn2xX82df0R4R0kspq1OrqP8Ix/zZ+ScfVG8dCHaC/Fs+nP+CMnwyh+Lf8AwVC+DOk3Cq8MGu/2sVYAgmxglvR16824/wAD0r+pCv5tf+DdFQ3/AAVb8DEgfLp2rEcdP9Amr+kqvi/FytJ5tTp9FTX4yl/kj6PgKmlgJy6ub/BIKKKK/Kz7gKKKKACoridLWFpJGWOONSzuxwFA5JJ9KlrmfjLq66B8IPFd86NItno95OyjqwSF2I/SqhHmko99CZS5Ytn8jXxd8fzfFX4r+JvFFwXNx4k1a71WUuPmLzzPKc8nnLn1+prAtLSS+uo4YY2lmmcJGijLOxOAB+gxTa679n21jv8A49eCYZo1lhm1
+wjkRhlWU3EYIP6jFf2pK1Kl7q0ivyR/Ocb1J67t/mf1p/BL4ZWvwW+DfhPwfYpGln4W0e00mJY/u7YIUjGP++evWuroor+K6lSU5Oct27s/oyMVGKjHZBRRRUlBXxv/AMF6/hLH8Wf+CWnxKUxeZeeHY7XXrRtu7ymt7mMyNj/rgZlz2DZ5xg/ZFeH/APBSzTItV/4J3/HWObcVXwDrkwwcfNHYTOv/AI8or1Mjryo5jh6sd4zi/wDyZHDmdNVMHVg+sZfkz+UOvr3/AIIO/ECX4e/8FVfhVKsjiDVLi80qdF/5arPZzooPsJCjfVB2r5Cr37/glQxX/gpL8D8EjPjLThx7zrX9ZZ9SVTLcRTls4TX/AJKz8JyubhjKUl0lH80f1XUUUV/HJ/Qh/I/+2n/yeP8AFr/sc9Y/9Lpq8zr0z9tP/k8f4tf9jnrH/pdNXmdf2lgf92p/4V+SP5yxX8afq/zP69P2abaOz/Zz+H8MMaQwxeHNORERdqootYwAB2AruK4v9nL/AJN68B/9i7p//pNHXaV/GeK/jT9X+Z/RFD+HH0QUUUVian4a/wDB2H/ycN8Jf+xdu/8A0pFfk7X6xf8AB2H/AMnDfCX/ALF27/8ASkV+Ttf1ZwD/AMiDDej/APSmfhnFX/I1req/JH7h/wDBp3bRr8BPi3MI185/EFmjOANzKLZiAT1wNzYB6ZPrX601+Tf/AAad/wDJvfxa/wCxitP/AEmNfrJX4Hx9/wAj/E+q/wDSYn6nwr/yKqPo/wA2FFFFfHn0B8y/8Fkf+UX/AMaP+xek/wDRiV/LbX9SX/BZH/lF/wDGj/sXpP8A0Ylfy21/QXhD/wAi2t/j/wDbUfk/H/8AvlP/AA/qz6Y/4I3/APKUD4K/9jFH/wCi3r+pSv5a/wDgjf8A8pQPgr/2MUf/AKLev6lK+V8Xf+RlR/wf+3M9zgH/AHOp/i/RBX8i/wC1748f4oftXfEzxJJJ5ja94r1O/wB2
7cMS3crjBwOACAOAMAYAHFf10V/HZ8Rv+Sia9/2Ebj/0a1eh4O006uKn1Sgvvcv8jn8QZP2dCPnJ/db/ADMav65P2QvhvD8H/wBlT4a+FYVVF8PeGNNsDtAG5o7aNWbgnlmBYnJySTk9a/kbr+hC3/4OeP2abWFY49P+JUccYCqi6HbqqgdAB9o/lXveKWV4/HU8PSwVJzScm7K9vhSv+J5PBGOwuGnWniZqLailfrvf9D9HKK/Oj/iKA/Zt/wCfH4mf+CSD/wCSKP8AiKA/Zt/58fiZ/wCCSD/5Ir8f/wBTc8/6BZ/cfoH+sWWf8/4/efovRX50f8RQH7Nv/Pj8TP8AwSQf/JFH/EUB+zb/AM+PxM/8EkH/AMkUf6m55/0Cz+4P9Yss/wCf8fvPZ/8Agt98P4/iJ/wSx+L9m0bSSWOmRarGQu5kNrdQ3GR6fLGwJ9Ce1fzB1+4H7b3/AAcNfAX9oX9kL4leBdBs/iAmteLPD15pdi11pMMcAmliZF3sJyVXJGSASPQ1+H9ftnhjluNwOAq0cbTcHz3Sem8Un+R+b8aYzDYnFQqYeal7tnb1f+Z9Sf8ABFHx43w7/wCCpfwbvkkMf2rWX0tv9oXdvNbYPB/57Dr0ODkYyCuZ/wCCVP8Aykk+B/8A2OWm/wDo9aK+G8Xqa/tGhNbuFvuk/wDM+m4Bk/qdSP8Ae/RHjXxG/wCSia9/2Ebj/wBGtWNWz8Rv+Sia9/2Ebj/0a1Y1fv8AT+Bei/I/K6nxM/rg/Yr/AOTOPhN/2Juj/wDpFDXpleZ/sV/8mcfCb/sTdH/9Ioa9Mr+Mcd/vNT/E/wAz+icL/Bh6L8gooorlNwooooAKKKKACiiigD+bb/g4t/5SteOP+wdpP/pBDXw5X3H/AMHFv/KVrxx/2DtJ/wDSCGvhyv694V/5EuE/69w/9JR+AZ5/yMa/+OX5s/pg/wCDfn/lET8I/wDuMf8Ap6v6+zK+M/8Ag35/5RE/CP8A7jH/
AKer+vsyv5c4l/5HGL/6+1P/AEpn7bkv/Ivof4I/+koKx/G/gzS/iN4N1bw/rVnDqGj67ZzaffWsoylxBKhSRGHoysR+NbFFeNGTi1KO6PRlFNWZ/J7/AMFCf2PtT/YX/a28XfDu/W4ay025Nxo93Kv/ACENOlJa3mz0J2fK23IEiOucqa8Vr+gD/g5O/YM/4aA/Zht/ivodr5nij4WRvJfLGmZLzSXYGbP/AFwb98M8BDMepFfz/wBf1jwbn6zfLIYiT9+Puz/xLr81Z/O3Q/CeIsreAxkqS+F6x9H/AJbH9Iv/AAQN/bz/AOGy/wBi6z0fWr/7V46+Gvl6Nq3mPma6t8H7JdHud8amNmJJLwSE9RX03+2p/wAmcfFn/sTdY/8ASKav5v8A/gkH+3TL+wR+2n4f8S3k7R+EdcI0TxLHu+UWUzr+/wAf3oZAkvAyQjrkbzX9HX7ZNzHefsY/FaaGRZYZfBerujo25XBsZiCD6HrxX4nxpw9/ZmewnTVqdWSlHyd1zL5PVeTR+k8O5t9cyyUZv34Jp+ato/mvxTP5Ja9M/Ys/5PH+Ev8A2Oej/wDpdDXmdemfsWf8nj/CX/sc9H/9Loa/ozHf7tU/wv8AI/IML/Gh6r8z+uCiiiv4tP6NPhn/AIOMP+UUvjj/ALCOlf8ApfBX83Nf0lf8HE9nLdf8En/H7xxsy299pMkhH8C/2jbrn/vpgPxr+bWv6M8Jf+RLP/r5L/0mB+Q8ef8AIwj/AIF+cj7j/wCDdL/lK14H/wCwdq3/AKQTV/STX823/Bul/wApWvA//YO1b/0gmr+kmvgvFr/kcw/69x/9KkfU8B/8i6X+N/lEKKKK/MD7UKKKKACuL/aN/wCTevHn/Yu6h/6TSV2lct8bNIPiD4M+LrBZBC15o15AHIzs3wOuce2c1th5JVYt91+ZnW1g15M/j8rsv2c/+ThvAf8A2MWn/wDpTHXG12H7PU6W/wAfvA8sjrHHH4gsGZmO
1VAuYyST7dcmv7QxP8GXo/yP51w/8SPqj+vyiiiv4pP6OCiiigArxf8A4KMf8o9/jt/2TvxB/wCm24r2ivEf+ClF9Hp//BPD46STOqK3w/12IE92fT50UfizAfjXdln++0f8UfzRy43/AHep/hf5H8oNe/f8Eqf+UknwP/7HLTf/AEeteA179/wSp/5SSfA//sctN/8AR61/Xmcf7jW/wS/9JZ+A5d/vVP8AxR/NH9V1FFFfxqf0QfyP/tp/8nj/ABa/7HPWP/S6avM69M/bT/5PH+LX/Y56x/6XTV5nX9pYH/dqf+Ffkj+csV/Gn6v8z+vj9nL/AJN68B/9i7p//pNHXaVxf7OX/JvXgP8A7F3T/wD0mjrtK/jPE/xper/M/oih/Dj6IKKKKxNT8Nf+DsP/AJOG+Ev/AGLt3/6Uivydr9Yv+DsP/k4b4S/9i7d/+lIr8na/qzgH/kQYb0f/AKUz8M4q/wCRrW9V+SP3I/4NO/8Ak3v4tf8AYxWn/pMa/WSvyb/4NO/+Te/i1/2MVp/6TGv1kr8D4+/5H+J9V/6Sj9T4V/5FVH0f5sKKKK+PPoD5l/4LI/8AKL/40f8AYvSf+jEr+W2v6kv+CyP/ACi/+NH/AGL0n/oxK/ltr+gvCH/kW1v8f/tqPyfj/wD3yn/h/Vn0x/wRv/5SgfBX/sYo/wD0W9f1KV/LX/wRv/5SgfBX/sYo/wD0W9f1KV8r4u/8jKj/AIP/AG5nucA/7nU/xfogr+Oz4jf8lE17/sI3H/o1q/sTr+Oz4jf8lE17/sI3H/o1q9Lwd+PF+kPzkcviF8ND/t7/ANtMaiiv6j4P+CO37Ll1CskfwZ8FSRyAMrLE7KwPIIO/8civ0biji/DZH7L6xCUvac1uW2nLbe7Xc+PyPh+tmfP7KSjy2ve/W/ZeR/LhRX9SX/Dm79l//oi/g3/vxJ/8VR/w5u/Zf/6Iv4N/78Sf/FV8l/xF7Lf+fNT/AMl/+SPe/wBQMZ/z
8j+P+R/LbRX9SX/Dm79l/wD6Iv4N/wC/En/xVH/Dm79l/wD6Iv4N/wC/En/xVH/EXst/581P/Jf/AJIP9QMZ/wA/I/j/AJH8ttFf1Jf8Obv2X/8Aoi/g3/vxJ/8AFUf8Obv2X/8Aoi/g3/vxJ/8AFUf8Rey3/nzU/wDJf/kg/wBQMZ/z8j+P+R/Pf/wShs5b3/gpR8EEhjkldfGFhIVRSxCrKGY8dgoJJ6AAk8Civ6QPgf8A8E8/gj+zX4zXxF4F+GPhPw7ryRtDHqFvZhrmFGBVgjuSU3KSDtIJBIORxRX5hxxxTRzvFU61CDjGMba2u9b9GfbcNZLUy2hKnVkpOTvpe34n8rfxWsptL+KPiS1uEMc9vql1FIhP3GWVwR+eelYNeo/tweB5vhn+2Z8WPD827zNI8X6rbAsc+Yq3cuxs4HDLhs4GQc4HSvLq/qDC1FUoQqLqk/vR+J4iLhUlF9G0f1wfsV/8mcfCb/sTdH/9Ioa9Mr55/wCCUnxNtfi5/wAE3vgrrFrObgQ+E7HS53aTzGM9nGLObcf73mQPnPOetfQ1fxzmdOVPGVact1KSfybP6EwU1PD05LZxX5BRRRXCdQUUUUAFFFFABRRRQB/Nt/wcW/8AKVrxx/2DtJ/9IIa+HK+4/wDg4t/5SteOP+wdpP8A6QQ18OV/XvCv/Ilwn/XuH/pKPwDPP+RjX/xy/Nn9MH/Bvz/yiJ+Ef/cY/wDT1f19mV8Z/wDBvz/yiJ+Ef/cY/wDT1f19mV/LnEv/ACOMX/19qf8ApTP23Jf+RfQ/wR/9JQUUUV4p6RT1fSLXXtKubG+t4byzvImgngmQPHPGw2srKeGBBIIPBBxX8s//AAVN/YivP2B/2yvE3goRS/8ACPXMn9reG53JPn6dM7eUMn7zRlXhYnq0THoRX9Ulfn5/wcM/sGD9q/8AY7m8ZaHp7XHjb4WiTU7byVLS3unsB9rgwPvbVVZl6kGFguC5z994dcQ/2bmao1X+
7q2i/J/Zf36Pyb7HyvF2U/XMH7SC9+nqvTqv19UfzrV+6H/BKT9vL/hp/wD4I/8AxY+H+uXjTeMvhT4K1OwJlbMl5pbWM4tJAepMYUwN6COMk5evwvr0v9lj9p7XP2VvHeravo5Mlv4i0HUPDeq2pbat3Z3kDROp90YpKvbdEueM1+88VZDHNMGqa+OElKL809vmrr7n0Py/I80eCxDm/hkmn6Pr8nr+HU80r0z9iz/k8f4S/wDY56P/AOl0NeZ16Z+xZ/yeP8Jf+xz0f/0uhr28d/u1T/C/yPMwv8aHqvzP64KKKK/i0/o0+Wv+C1fgOT4k/wDBLX4z6dFE0zW2iJqpVc/ds7mG8Zuo+6sBP0HQ9D/LxX9h3xK8BWPxU+HHiDwvqgZ9N8SabcaXdgdTDPE0Tgf8Bc1/Ij8WPhrqfwb+KHiPwjrUXk6x4X1O50m9j7LNBI0b49tyn6jmv3jwfx0XhsRhOqkpferP/wBJR+X+IGFarUsR0aa+53/U+hv+CJnxHh+Fv/BUz4OahPKsUV5rEmj5c/KzXttNZoPqXnXHviv6hq/jl8G+LNQ8BeLtL13SbiSz1TRbyG/s50+9BNE4dHHuGUH8K/rP/ZF/aT0X9rz9m7wf8RtBkjax8UadHcyQq+82VxjbPbsf70UodD7pkZBBrzfF7L5qvQx6XutODfZptr77v7js4AxkXTq4V7p8y+ej+6y+89Looor8ZP0QKKKKACobu0jv7SWGaNZYZkKSI3KspGCD7HmpqKAP46/iJ4MuPhz8QNd8PXe5brQtRuNPmDLtYPDI0bZHY5U8dqzdN1GbSNRgurdvLntpFlibAbaynIODkcEDg5FfXP8AwXa/Z5m/Z6/4KZ/EKNbfydN8ZTr4qsHAwJkuwXmP4XQuF4z93PfA+QK/szK8ZHGYOliY7Tin96P53x2Hlh8ROi94tr7mf2FfCn4g2fxa+F/hvxVp/wA2n+JtLtdVtiDnMc8SSpz3+VxXRV+e
P/BuT+2jZ/tD/sSWngG/u1Piz4Ut/ZskTyZkuNOcs1rMB/dRSYMDgeShONwr9Dq/kfOstnl+Oq4Oovgk0vNdH81Zn71luMjisLDEQ+0l9/VfJhRRRXlncFfIf/BdP4pw/Cr/AIJa/FSd5hHca3ZwaJbJuw0z3VxHE6jn/nkZWPsp4PSvryvxO/4Olf21bXxL4o8J/AvRbpZv+EekXxF4j2NkR3LxFLSA9wywySSMDkETxHscfVcF5ZPHZzQpxWkZKT8lF3/F2Xqzw+IsZHDZdVm92uVer0/4PyPyEr60/wCCF/gKT4hf8FU/hJbqjNHp99c6pK3aNba0nmBPB/iRV+rAZHUfJdfq9/waq/s7TeJPj98QPihdW7Gw8L6QmhWUjr8rXV1Isjsp/vJDBtI7C4HHIr+juMMbHC5Liar/AJGl6y91fiz8g4fw7r5jRgv5k/ktX+R+51FFFfyOfvZ/I/8Atp/8nj/Fr/sc9Y/9Lpq8zr0z9tP/AJPH+LX/AGOesf8ApdNXmdf2lgf92p/4V+SP5yxX8afq/wAz+vj9nL/k3rwH/wBi7p//AKTR12lcX+zl/wAm9eA/+xd0/wD9Jo67Sv4zxP8AGl6v8z+iKH8OPogooorE1Pw1/wCDsP8A5OG+Ev8A2Lt3/wClIr8na/WL/g7D/wCThvhL/wBi7d/+lIr8na/qzgH/AJEGG9H/AOlM/DOKv+RrW9V+SP3I/wCDTv8A5N7+LX/YxWn/AKTGv1kr8m/+DTv/AJN7+LX/AGMVp/6TGv1kr8D4+/5H+J9V/wCko/U+Ff8AkVUfR/mwooor48+gPmX/AILI/wDKL/40f9i9J/6MSv5ba/qS/wCCyP8Ayi/+NH/YvSf+jEr+W2v6C8If+RbW/wAf/tqPyfj/AP3yn/h/Vn0x/wAEb/8AlKB8Ff8AsYo//Rb1/UpX8tf/AARv/wCUoHwV/wCxij/9FvX9SlfK+Lv/ACMqP+D/ANuZ7nAP+51P8X6I
K/kV/a58EP8ADP8Aar+JnhySPym0HxXqmn7MbdvlXcqDAyePlHQkY6Ejmv66q/mv/wCDhL4ByfA//gpx4wvEh8rTPHltbeJbM4+8ZY/KnyemftEMzY6gMv1NeEWMjDMK2Gf243XrF/5Nv5Bx9h3LC06y+zK33r/gHxHX9dX7Kfj6H4sfsw/DnxRbyLJD4g8M6dqKsowP3trG547Y3YwRkEY4xX8itf0Lf8G2n7YFn8cv2Ho/h9eXiN4n+Flw9k0LsPMm0+Z3ltpQP7qlpIeOghTPLDP1Xi3l862XUsXBX9nLXyUtL/ekvmeDwFi408XOhL7a09V/wGz9FqKKK/ns/WgooooAKKKKACiiigD+eL/g5T/ZYuvgr+3tJ45gtWXw/wDFSxj1CKZVxGl7bxpBcxf72FhlJ7m49jj88K/qr/4KRfsD+H/+CiX7NOpeBtYkTT9Whf7doOreXvfSr1QQr46tGwLI691YkYYKR/Mh+0n+zP42/ZI+LOoeCfH2h3Wg69ppBMcmGiuIznbNDIMrJG3OHUkZBBwQQP6W8OeJaWPy6GDm/wB7SVmuritE18rJ+fqj8b4uyaeFxcsRFe5N3v2b3T+eqPsr/gi//wAFrG/4J6RXngTxzp+oa38M9YvDeRSWWHvdAuXCq8iIxAkhfapaPIIILLkllf8AaX4N/wDBU79nf48aZFc+HfjD4GLTAbbXUdSTS7z/AL8XPly/kpH5iv5VKK14h8OcuzSu8UpOnUlu1Zpvu0+vo1566meU8X4vBU1QaU4ra+68k+3qmf2DaR8Y/COvQtJY+KvDd5Gh2s0GpQyKp64yGP5Vc/4WP4f/AOg9ov8A4Gx//FV/HbRXyz8HKd9MW/8AwD/7Y9z/AIiFLrQX/gX/ANqf2Jf8LH8P/wDQe0X/AMDY/wD4qj/hY/h//oPaL/4Gx/8AxVfx20Uv+INw/wCgt/8AgH/24f8AEQpf8+P/ACb/AO1P7Ev+Fj+H/wDoPaL/AOBs
f/xVaVhf2+qWiXFrNDcW8nKSRsGV+3BHXv0r+Nuv6GP+DYq/uLz/AIJrTRyTzSR2vi/UYoVdiwhQxWz7VHRV3OzYHGWY9STXzHFnh6smwP1yNfn95K3Lbe/XmfY9rIeLHmOJ+ruly6N3vfb5I/RSiiivzU+yP5tv+Di3/lK144/7B2k/+kENfDlfcf8AwcW/8pWvHH/YO0n/ANIIa+HK/r3hX/kS4T/r3D/0lH4Bnn/Ixr/45fmz+mD/AIN+f+URPwj/AO4x/wCnq/r7Mr4z/wCDfn/lET8I/wDuMf8Ap6v6+zK/lziX/kcYv/r7U/8ASmftuS/8i+h/gj/6SgooorxT0gpkkazxsjqrKw2srDIINPooA/mA/wCCyf7CX/DBX7a+uaHptu0Xg3xLnXfDbBfkitZXbfbD3gkDxgHJ2CNj96vlKv6Vv+C637Bp/bb/AGKtRuNHs1uPHHw98zXdE2rmW6RU/wBJtBxn95GMqo6yRRDIGTX81Nf1PwHxD/auWRlUd6lP3Zd9Nn81+Nz8P4oyn6jjWor3Jax/VfJ/hYK9M/Ys/wCTx/hL/wBjno//AKXQ15nXpn7Fn/J4/wAJf+xz0f8A9Loa+rx3+7VP8L/I8LC/xoeq/M/rgooor+LT+jQr8Hf+Dmj9g66+Fvx9svjdodmzeG/H2yz1oxx/JY6pEm1XYjgLPCgI7l4ZST8wFfvFXF/tA/Afwv8AtOfB3X/AnjLTY9V8O+IrY211ATtZe6yI3VZEYK6sOVZVPavpOFeIJ5PmMcWtY7SXeL3+a0a80ePnmVRzDCSoPR7p9mv89n6n8g9fbn/BHj/gsPq3/BN/xbdaBr9re+Ivhb4iuRPf2EDD7VpdxgKbu2DEKxKgB4yQHCoQwI+bgP8Agpl/wS58c/8ABN/4qyWWqwXGseCNTnb+wvEkMJFveJ1EUuMiK4VQdyHrgspZeR8xV/T1Wll+eZfyu1SlUXT+rpp+jT3PxWnPF5Zirq8Zxf8A
Xqn+J/Wx+zd+2n8K/wBrvw5BqXw78caB4lWWMSvaQXKpfWoPaa2bE0R4PDqOmRkc16pX8atpdy2NzHNBJJDNEdySRsVZCO4I/mK66P8AaJ+IEMaonjrxgqqMKo1q5AA9Pv1+W4rweTnfD4m0e0o3a+aaT+5H3FDxAfLatR18np9zT/Nn9flZviLxZpfhK0+0arqWn6Xb4J827uUhTA5JyxA4/Sv5DtU+OvjbXLXyb3xl4qvIc7vLn1a4kUEd8Fz6nmuYu7uW+uZJp5JJppTueSRizOT3JP8AM1nT8HZN/vMV90P/ALYqfiCvs0Pvl/8Aan9g3gj4u+FfibPeReG/E/h/xFLpzBLtNN1KG7a1Y9A4jY7CcHhsdK6Sv51f+DaG+ntP+CnFjFFNNFHdeG9SjmRHKrKoVGAYD7w3KDg8AqD1Ar+iqvzvi7h2OS4/6nGfOuVSva299N32PrshzZ5jhfrEo8ru1a99rf5n5sf8HIn7BF1+0j+zJY/Ezw3Zm58U/C0SzXkMS/vb3SZMGfH94wsqygHgJ52MkgH+fqv7J7iBLqFo5FWSORSrowyGB4II9K/A7/gtZ/wQ51b9mjxJqvxR+Euk3GqfDW+ke71PSbSLfN4VdjliqLy1pySrAHygCGwoDH9E8MeLqVOn/ZGMlbX3G9tdXH79V3u12PkONOH5zl9fw6v/ADJeXX7tH9/c+Gf2Pf2v/Gn7D3xz0vx94FvltdUsMxXFvKC1tqdsxBktp0BG6Nto6YKkKykMoI/oU/YZ/wCC3vwQ/bS8P2UMviKx8A+NJFC3Hh7X7pLdjJ3+zzttjuFPONpD4GWRa/mbor9A4n4LwOdJTrXjUWikt7dmuq+5roz5TJeJMTlzcafvQe8X+a7P+rH9k9vOl1CskbLJHIoZHU5DA8gg+lU/EvijTfBujzahq+oWOl6fbjMtzeTpBDGP9p2IA/E1/IJ4Y+LXirwRY/ZtF8TeINIt858my1Ga3jPJP3UYDuT9
SfWqvizx/rnjueOXXNa1bWJIRiN767kuGjHsXJI+gr89j4Oy5/exS5f8Gv8A6UfWS8Qly6UNf8Wn/pJ+9X/BST/g4o+Hf7Pfhq+8O/B2/wBO+Inj2UGFNQgBm0PSD3kaUEC5fGNqREpnJZxt2N+CfjjxvrHxL8Yap4h8QahdavrmtXMl5fXtzIZJrqZ2LPI7HqSSTWXU2nadc6vqNvZ2dvNdXd1IsMEEKGSSZ2OFRVGSzEkAAZJJxX6Zw7wtgckouGGV5P4pPd/5LyWnfufG5tnmJzGopVtlslsv83/WhL4f0G+8Va7ZaXptpcX+palPHa2ttAhkluJXYKkaKOWZmIAA5JIAr+pL/glX+xNH+wR+xb4X8D3AhbxFcBtW8RSxncs2ozhTIoPdY1WOFTxlYQcZJr42/wCCF/8AwRDvP2ctSs/jF8X9Nhj8aNF5nhzQJRubw+GBBubgdPtJU4VBnygST+8IEX6sV+P+JXF1LHzWXYOV6cHeTW0pdl3S77N+iZ+gcHZDPCxeLxCtOSsl1S8/N/ggooor8pPuj+R/9tP/AJPH+LX/AGOesf8ApdNXmdemftp/8nj/ABa/7HPWP/S6avM6/tLA/wC7U/8ACvyR/OWK/jT9X+Z/Xx+zl/yb14D/AOxd0/8A9Jo67SuL/Zy/5N68B/8AYu6f/wCk0ddpX8Z4n+NL1f5n9EUP4cfRBRRRWJqfhr/wdh/8nDfCX/sXbv8A9KRX5O1+sX/B2H/ycN8Jf+xdu/8A0pFfk7X9WcA/8iDDej/9KZ+GcVf8jWt6r8kfuR/wad/8m9/Fr/sYrT/0mNfrJX5N/wDBp3/yb38Wv+xitP8A0mNfrJX4Hx9/yP8AE+q/9JR+p8K/8iqj6P8ANhRRRXx59AfMv/BZH/lF/wDGj/sXpP8A0Ylfy21/Ul/wWR/5Rf8Axo/7F6T/ANGJX8ttf0F4Q/8AItrf4/8A21H5Px//AL5T/wAP6s+mP+CN/wDylA+Cv/Yx
R/8Aot6/qUr+Wv8A4I3/APKUD4K/9jFH/wCi3r+pSvlfF3/kZUf8H/tzPc4B/wBzqf4v0QV+df8AwcZ/sIz/ALUP7I8Pjzw/YvdeLfhSZb8xxLmS70xwPtaAdzHsSYZ6LHIACWr9FKayiRSrAMrDGCOtfnOT5pVy7G08bR+KDvbuuq+auj7DMMDDF4eeHqbSX3dn8nqfxq16v+xb+2P4y/YT+Pul/EDwTdJHqFiDBd2c5Y2urWrkeZbTKCNyNhTxyrKjAhlBH3j/AMFrv+CF+rfArxHrHxX+Dujyal4AvHe81fQbKItP4bc/M8kUY5a0yScLzCCRjyxlfy3r+rctzPAZ5gfaUrThJWlF9L7xkuj/AOHWmp+F4zB4rLMTyzvGUXdNdezTP6ZP2Jv+C4fwK/bJ8P2MM3iew8A+MJFAuNA8RXKWjCTpiC4fEU6k52hSJCOSi9K+w7a5jvoI5oZEmhlUOjo25XU8gg9CK/jYrc8L/E/xL4HhaPRfEWu6PHJ95bK/lt1PfojD61+c5l4Q4apUc8FXcE/syXN9zunb1u/M+vwfH1aMOXE0lJ907fhZ/hY/sQor+QX/AIaM+If/AEPnjL/wd3P/AMXWbqnxc8Wa1c+deeKPEF1Mwx5k2pTSOQPct+ledHwdq9cUv/AH/wDJHZ/xEGHSg/8AwL/gH9fPiHxZpfhS387VNT0/TIdrOHurlIFwvLHLEcDjPpXnHjT9vH4I/DtW/tz4vfDPS5FODFceJrNZc8cBPM3E4IOADwc9K/ktorso+DtFfxcU36QS/OTOWp4hVH8FBL1lf9Ef14fAf9pXwD+074Xm1r4feMNB8X6bbS+RPPpl2s32eTG7ZIo+ZGwQcMAcHPSivyk/4NIHJH7QC7vlB8OkD3/4mv8A9aivynijJ4ZVmlXAU5OSjaze+sVL9bH3OS5hPG4KGKkrOV9F5Nr9D9l68r/ao/Y0+Gv7angH/hHfiT4VsfEVlDua1mfMV5p7sBl4
J0IeM8DO04bADAjivVKK8ahiKtGoqtGTjJbNOzXo0elVpQqQcKiTT3T1R+MP7R//AAaj3AvJrv4R/E2FoWJMWmeLLYq0fp/pdup3fjAMY6nPHyb8QP8Ag3g/ar8DzuLXwHpviS3jJzcaTr9kynBABCTSRyHPoEJGDkCv6UKK+/wPifnmHiozlGp/ijr98XH8T5bE8F5bVd4pw9H/AJ3P5b73/gjH+1FYXUkMnwX8XM0ZwTGsMin6MrkH6gkVH/w5v/ag/wCiK+M/+/Mf/wAXX9SlFer/AMRezLrRp/8Ak3/yRwf6g4PpUl+H+R/Lnpn/AARb/ak1a68mL4MeK1bG7MzQQrx/tPIB+GcmtL/hxn+1d/0R3Wv/AAY2H/x+v6eqKmXi7mnSlT+6X/yRX+oOC61J/h/kfzS6b/wb2ftb31z5cvwvt7JcZ82bxPpLL9PkuWP6Yr9oP+CKn7FXi79g79imHwd44bT18RX2tXWsT29nN58dmsqxIsZkHys22IMSuQC2ATjJ+uqK+c4g48zHOMN9VxMYRjdP3U1qvWTPWynhfCZfW9vRcm7W1a6+iQUUUV8WfSH5D/8ABXr/AIIVfGD9tb9tbWfiR4H1TwSdH1yxs4jBqV9NbXNvJBAkLAgQurKdgYMGzyQQMAn5jj/4Nff2knkUHUPhigY4LHWrjC/lbH9Mmv6FKK+9wPiRnGEw8MLSceWCSV462Wi6ny+K4Py+vWlWnzXk23r1fyPE/wDgnl+yhJ+xD+xr4F+F9xqcesXfhi2m+1XkSFYpZ7i5luZdgPOwSTMqkgEqoJAJIr2yiivicViamIrTxFV3lNuTfm3d/ifR0aMaNONKntFJL0WiCiiisDUKKKKACvxf/b9/4NmfFfjz48a54r+C+u+ErXw74hunvpND1eaazfSpZDueOB445EeHcWKg7CgIUBgM1+0FFe5kXEWOyis62ClbmVmmrp+q8uj3+883NMpw2PpqniFtqmtGj+en/iF+
/aS/5/vhn/4O5/8A5Hr3T/gnp/wbYePvhX+0x4X8bfFjxF4Th0PwfqMGrwabotzNd3OpXEDiSJHZ4o0ji8xVLEbmYKVAGd4/aKivpMV4l53XoyouUUpKzajrZ9tWePh+DctpVFUSbs76vTQKKKK/Pz6oKKKKAOf+JXwz8O/GPwTqHhvxXomm+ItB1SPyruw1C3WeCdeoyrDGQcEHqCARggGvy3/a/wD+DWrwl40vrzV/gz4wm8H3MzNIuh64r3mnKT0WO4XM0SD/AGhMfcV+tFFe1k/EOYZXLmwVVxvut0/VO6+e/medmGU4TGx5cTBPz2a9HufzY/E7/g3d/ao+Hd4y2fgjSvFlspI+1aLrtoyHnAwk7xS89fucDrivOW/4I1/tQIxH/Cl/GXB7RRn/ANnr+pSivuqPi5msY2qU6bfe0l/7d/kfMVOAsC3eM5L5p/ofzE6F/wAEJv2sPEPl/Z/g/qkfmR+YPtOrada4Hv5twuG5+6cHrxwa9N8E/wDBs9+054rlVb+z8DeGd3VtS14SBPr9mSb9M1/RTRWdbxZziStCFOPopP8AOTX4F0+BMvjrKUn81+iPzb/4JHf8EH7/AP4J9fHCb4keLfHFj4i16PTptOs9P0q0eO1t/N275XlkIaQ7VIChFAySSeAP0koor4PN84xeZ4h4rGS5pWS2S0XSyPqMvy+hgqXsMOrR376/MKayiRSrAMrDGCOtOoryztPgH9t//g3i+Cv7WGo3mu+GRcfCzxZdbnkuNGtkk025kOTvlsiVXJJ58p4s8k5JzX5z/Gj/AINj/wBoj4e3Mz+F5vBvj6zXcYfsWp/YbpwOgdLkRxqx9BKwHrX9C1Ffa5T4gZ1gIKlCpzxWymr/AI6S+V7HzmO4Uy7FS55Q5X3i7fht+B/Lvr3/AARP/am8O3Xk3HwZ8SyPkjNtNa3ScHH3opWH68jkZFXfCn/BDL9qzxlKq2vwf1i3DEqWvtQsbILjufOnX9M57ZNf
090V9C/F3NOXSlTv6S/+S/U8lcA4K+tSdvl/kfgr8Af+DWX4veNLuC4+IXjDwj4H01iDJBZGTVtQA7jYojhGR0IlbHXHHP6gfsI/8EePgv8AsByQ6l4b0WbX/GATDeJNcKXN9GSCGEACiO3U5I/dqGKnDM4FfVVFfK5zxtm+ZwdKvVtB/ZiuVfO2rXk20e3l/DeX4N89KF5d3q/l0XyQUUUV8me8FFFFAH4E/trf8G8/7Q3if9qrx7rvg3StB8UeG/Emu3msWN2NYgtJEjuZnmEckczKQ6b9pxlSRkHnA8+8I/8ABtz+1Fr/AIksrPUPDvhvQrG4lVJ7+5162litUJ5dkhZ5GwMnCqSelf0b0V+kUfFLOadFUkoaK1+V30Vr/Fa/yt5Hx9TgnL51HUblq72urflf8TF+H3hNPAXgTRdCjma4j0XT4LBJWXa0oijWMMR2J25x2raoor84lJyfM9z6+MUlZBRRRSGfmz/wXy/4JTeP/wBv6XwJ4o+Gv9m3+t+FobnTr3TLy7W1NxBKyOkkUj4TKsrhlYjIdSDwQfzc/wCIdL9q3/oR9G/8KSw/+O1/STRX3eS+ImaZZhI4KgoOMb25k76u/SSPl8w4SwOMryxFVyUpb2at26pnw3/wQt/4J1eMv+Cef7O/iOx8ez6aviTxdq66g9jZT/aI7CKOIRorSAbWkY7yduVA28k5A+5KKK+TzTMq2PxU8ZiLc83d20XbT5HvYLB08LQjh6Xwx2CiiiuA6jzH9sb9n/8A4as/Zc8efDr7culyeL9Hn0+G7ZN620rLmN2UEFlDhSQCCRkAg1+Buq/8G4n7VOnanNBD4S8P38MLlUuIPEdosc4H8SiR1fB/2lB9QK/pAor6zh3jLMMlpzpYTlcZO7Uk3rtdWaPCzbh3C5jOM69046aO2nzTPxJ/4JR/8EFPjZ8Ef20fCPxC+JFvonhjQfBdydREMOpxXl1qMojdY40ERZVXcwLMxBwCACTkfttR
RXDxBxFi84xCxGLtdKyUVZJb92933OnKspoZfSdGhezd3d3d/wAAooorwT1Ar4X/AG3v+CAPwO/bB1K813TbO4+Gvi+8Jkk1HQI0W0upD/HNZnEbHqSYzEzEksxNfdFFd+XZpi8BV9tg6jhLy6+q2a8ndHLjMDh8VD2eIgpLz/Tt8j+f342f8GvPx28CX8j+Dtd8F+PNP3ERYun0y9YerxTAxr24WZufQcnwHxH/AMEPf2q/Csu26+DevTENtzZ3tneDOM9YZmGPfpnjOeK/qAor7/C+LGc048tWMJ+bTT/BpfgfK1uBcvm7wco+jTX4pv8AE/ltg/4I0ftQ3EyRr8F/GAaQhQWjjVRnpklwB9TgDvXSaL/wQV/az12YxxfCK8hCkbmudc0yBRnv89yN3r8uSPTpX9N1FdE/F3NH8NKn90n/AO3IxjwDgvtVJ/h/kfzt+Cv+DZf9prxWV+3Q+AfDW7qdS10ybevX7NFN6Dpn7w98e4/DL/g038SXksb+MvjFomnIoy8OjaLLelj6B5ZIsfUofTHOR+2dFeXifE/PqqtCcYf4Yr/27mO6jwXlkPii5erf6WPm/wD4Jy/8EzfAn/BNP4eatovhC61fWNR8STRXGr6rqTp5920SssaKqKqpGm+QqvJzI2WPGCvpCivhcbjK+LrSxGJk5Tlu31/paH02Hw9OhTVKjFKK2QUUUVzmwUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFfHv7XP8AwVs0P4B+Nr7wt4Y0X/hKtb0uQwX1xJc+TZWko+9GCAWkdeQwG0KeMkggeLJ/wWZ+Kk0asvgHw4ysMqwtrwgg
+/mUAfpXRXxL+x5/wUv8dftA/H/Q/B+veC9N02x1f7RvvLaO4jNv5VtLKMhywO5kVe2N3c4r7S1S+XS9MuLllLLbxNKVHfaCcfpQBYor89/hj/wW3utd+JOl2XiTwjpeleH766WC5u4Lx3kskc4EpyAGC5BYAAkA45wK/QZHWRAykMrDII6EUAOorif2jPivL8Dfgd4m8Ww2ceoTaDZNcpbu5RZWGAASAcDkdO1eZ/8ABP39snUf2yPBWv6lqWi2eizaNepbKttM0iyq0YbJ3DII56E5BHAxyAfQVFR3NzHZwSTTSLFDEpd3c7VRRyST2A9a+Dvjt/wWvtNB8U3Ol/D/AMMQ65b28hiXVNQnaOO5YHGY4UAbb6FmBI/hFAH3rRX5rf8AD5X4rf8ARP8Aw9/4C3n/AMcr6A/YC/bw8WftXeNta0fxJ4Ts9DXTbAXsd1bLMqufMVNhEmefmzkH+E8egB9U0VxH7RXxXl+BnwP8TeLobOPUJtBsmuUtnkMaykEAAsAcdfT/ABr4Kj/4LVfEbV5HfTvAnhuSFSAQEupip92Vx/IUAfpZRX5sWf8AwWz8eaJfxnWvAGgtbsM+XG9xayP9GcuP/HTX1X+yH/wUK8F/tb3EmmWMdzoPiaGPzX0q9ZWaZR95oXHEgXuMKwHO3AzQB75RRXlf7Un7Xvg/9knwpFqHiS5mlvL0MLDTbUBrm9ZcZwCQFUZGWYgDOOSQCAeqUV+buq/8FtvG2uarJ/wj/wAP9FS1XkRzyz3kwHbLR7B/47TbX/gtZ4+0UiXWfh5orW7NtBR7m1zweAzbxnv06A/gAfpJRXK/BD4lf8Lk+D/hrxV9j/s//hIdOhv/ALN5vm+R5iBtu/A3YzjOBn0FfNX7YH/BSbxB+yZ+0Tb+Gb7wfY3nhu4itruK/wDtLi4uLd+JSq42hlZZFCnOdqkkbsAA+v6Kq6Tqtvrml2t9ZzR3FpeRLPDKhysqMAysD6EEGs/4h+ONP+Gf
gTWPEWqSeTp2iWct7cNnnZGpYgDuxxgDqSQOpoA2qK+U/wBgf9v3xR+2T8QtbsbrwjpukaJotmJ5byC6kkZJXcCKM7lwdyiQ54+4fofqygAoorzD9sH9oKT9l/4A614yh01NWudPaGKG2eUxxu8sqR5ZgCcLuJwOSQBkZyAD0+ivzd03/gsZ8VvFKyT6P8ONFvLVW27oba8uNhx0LKwGe+MDirVn/wAFovHXhDVI18WfDXT44JDkRxyXFjKR3IMgcH8h9aAP0YoryP8AZU/bN8G/tc+Hp7jw7PPa6nYqpvtKvAFurXJwG4JDoezKTjgEKTivXKACivkH9r//AIKzaH+z345vPCvhvRf+Eq1zTZDDfzSXPk2dnKOseQGaR16MBtCnIySCB4jD/wAFmvincRLJH4B8OPHIAystteFWB5yD5nOeuaAP0sor4d/ZN/4Kd+Pfjp8etB8Ja54H0yxsdalkje6tY7iNrcJDJJn5ywIygHbjP4fcVABRX5q3P/Bbbx3rN6y6P4D8P7Ruby2e4uZAueOVK9MgE4wT2HSkb/gtN8StKZJtQ8BeHEtd2GzHdQ5PoGZyM/gaAP0ror5O/ZV/4Kx+D/2gvE9n4d1zTpvBuv37CO1825FxZXch4CLLhSrt2VlAJ+UMSQD9Y0AFFcD+0d+0X4c/Zf8Ahnc+KPEk0q20cggtraEBp76ZgSsUYJA3EAnJIACkngV8N63/AMFtvGWuaxIvhv4f6OlquSsdzNPeTbc4BJj2AfTB5OM+oB+kVFfmv/w+V+KoPPw+8P47/wCjXn/xyvuT9lP4yX/7QPwC8P8Ai/UtJ/sO+1hZzLZAsREY55IhjcAcMIw3PZu/WgD0Siud+KPxR0H4M+B77xJ4m1GHS9H01N808mT1OAqqMlmY4AUAkk9K+FfiR/wW/vrvX3tfA3gaGW0D7Yp9WnZprgf9cYvu/QO3r7UAfoZRX5z+EP8Agt94g0nXFh8XeAdPa23Df/Z9xJbz
xKe+2XcGPsSufUV9yfAn4+eF/wBo7wBb+JPCuoC8sZm8uRHGye0kGMxSp1VhwccggggkEEgHaUUV+eXxX/4LI+MvDPxQ1/w9ovgnQpho+p3NjG00s88kqxSMmcIV5O3PoOnvQB+htFfmo/8AwWg+J+nr5114B8Ox28ZBkJgu4+M8/MXIHpk557GvXf2cv+CyXhP4neILbR/GWjyeDbu6YRxXy3IuLBmP99iqtFkkAEhlHUsBzQB9nUUgO8ZHIPQ+teA/t/ftlX37G3gbQ9S0/RLXWrrWr5rXbcTtHHEqpuJ+UZJJwO2OetAHv9FfNX7AP/BQCP8AbIXXtP1LS7XQ/EGi7LhbeCdpEurZvlLruGcq+A3b509Tj6VoAKK8Q/bq/bCt/wBjr4W2mrR2MOra1q12LXT7KWUxo+BukkYgE7VXAwOSzqOmSOK/4J+f8FA9T/bI8TeItM1Pw7Y6NJottFdRyWtw8iyBnKkEMOvTnPrxQB9SUUVh/Ejx/p/wr8Aax4k1aRotN0O0kvLgqMsURSxCjuxxgDuSBQBuUV+b5/4LheJz4ma6XwHo/wDwjYn2eX9pl+07OoHnfc34BP3Me3evv74VfErTfjF8OdF8UaOztpuu2kd3BvGHQMOVbqNytlSBkZB5NAHRUUV8x/8ABQb9vXUv2Mr/AMMWumeH7HWpPEEdxK73Vw8awiIxjACjknf1JGMdDngA+nKK8N/YV/bNtf2yPhve6g1jDpGu6Nc/Z9QsY5TIqqwzFKhIB2uAw55DIw5GCfcqACivkn9qH/gpBqv7Pv7VemfD+38M6fqGn3RsvOu5Ll0mHnvhtoAxwCMA5yR15wPragAori/jt8fPC/7OPgC48SeKtQFnYwt5caIN893Ic4iiTqzHk44AAJJABI+GfF//AAW98RatrzQ+EfAOnLa5PljULiW5uJQO+2LaF9cAtj1NAH6NUV+bdj/wW18caHcJ/bnw90Vo3OQsU1xZsw9i+/25x+Ff
fnwX+JC/GL4SeGvFS2b6eviHToNQ+ytJ5hg8xA23dgbsZxuwMjnAzigDqKK8H/bQ/b18NfscafZ295Z3GueI9Uiaaz0yCURfuwceZLIQfLQsCAQrElWwMAkfJp/4LUfEbV5ZJtN8BeHmtN+1QVuZ2TjoXVlBPfoOD0oA/Sqivzas/wDgsv8AFBLlTcfDvQ5Ic/MscF3Gx+hLNj8jRQBxX/BIDwzY/E39sTU9Q162h1W60/RbrV4XuUEm26Nzbp5uCPvYlcg9QTkYIFfq1X4sfsK/tX2/7Hnxb1DxNc6LNrsd9pEmli3iuRbspeaCXeWKt08kjGP4s545+r/+H6uk/wDRONQ/8HCf/GqAPvis/wAXf8ipqn/XpL/6Aa+Vf2Xv+Cr2m/tLfHHRfBMPgu+0ibWhP5d0+opMsZigkmOVEanBEZGQeCRxX1V4u/5FTVP+vSX/ANANAH4W/Df4P6j8T/CvjDUdNzJJ4P01dXuIQuWktxMkchHugcOT02o3fFfp7/wSk/afPx1/Z+j0HU7rzvEXgkJYy72/eXFpjEEp9cKDGTySYwSctXzN/wAES7KHUvjp4yt7iOOa3uPDbRSRuoZZFNxCCCPQjIweorBH27/glz/wUH587/hE71/dvtOk3D8e7PCy/i8HoaAPvn/goL/yZf8AET/sEt/6EtfPf/BDP/klPjr/ALC0H/ok179+3veQ6l+xJ4+uLeSOaC40YyxyI25ZFLKQQe4I5yOorwH/AIIZ/wDJKfHX/YWg/wDRJoA+jf269ZuNB/Y9+ItxayGOb+xJ4twPIWQeW347WPNfLP8AwQ68BaVcaD438Ry2VvNrEN3b2MFxJGGkt4tjMwQ9V3EjdjGdq56V9O/8FBf+TL/iJ/2CW/8AQlr88P2C/wDgoPZ/sZ+Ede0268L3OvtrV5HcrJFfLb+UFTbjBRs+ueKAP1yor4H/AOH6uk/9E41D/wAHCf8AxqvZv2K/+Cidj+2V421fRLfwveaD
LpViL7zZLxbhZR5ioV4Rdp+YHvkZ6Y5AOv8A+Cgv/Jl/xE/7BLf+hLXhn/BDz/k37xb/ANjCf/SaGvc/+Cgv/Jl/xE/7BLf+hLXx5/wSv/bI+G/7N/we8RaX408Sf2Lf32sm7gi/s+6uN8fkRLuzDG4HzKRgkHjOMYoA/RrXNBsfE+lzWOpWdrqFlcLtlt7mFZYpB6MrAgj2NflH+134As/2MP8AgoPo914LVtOtVnstbtbVGKpbb5CskI/6ZtscbegV9vQYr7S8Tf8ABWv4H6FpUlxaeJdQ1qZAStrZ6RdJK59AZkjT82FfHPg228Qf8FP/ANu+HxF/Zc1j4Z0+e3ku8ndHp9hAcrEz4wZZSG4H8UjEDapIAP1cr8nPE1jd/wDBRD/gpXcaTeXU39grqMtmjRt/x76XaFydnXa0m0nPIEk+cYr9Y6/Kn/gjheNqf7ZuoXMm3zJtCvJWwOAxmhJx+ZoA/Tn4f/DfQfhV4ZttG8N6TY6NpdqoWO3tYhGv1OOWY9SzZJOSSSSa3aK4n4yftD+C/wBnywsbrxlr1rocOpSNFamVJHMzKAWwEVjxkc9BkeooA7avkf8A4LA/s+f8LT/Z5j8VWNv5mreB5TcsVHzPZSYWZf8AgJEcnPQI+OTz9TeEvFWneOvDOn61pN1HfaXqkCXVrcJnbNG4BVhnB5BHBAI+tT61o1t4i0e70++hW4sr6F7e4hcZWWN1Ksp9ipI/GgD5d/4JF/tAD4s/s0x+HbybzNW8DSjT2BbLNaNlrdvYAB4wPSIetcj/AMFo/wBoH/hEPhRpPw/sZgt94ql+2X6g8pZwsCoP+/NjHUEQuO9eBfs/+J3/AOCcH/BQjVPD+u3Ulr4YuJZNMu7iUHa9nLiS2uTgHlf3ZYjOAZB60/wvC3/BST/gpTJeyLJc+ErK5+0EOpCrpdqQEUjHy+c23IPIM7c8UAfaH/BM39nr/hQP7Luk/a7fydc8UY1jUNww6eYo8qM9/lj2
/LxhmfgEmvoWkA2DA4A6D0paACvmv/grZ/yY74k/6+7H/wBKo6+lK+a/+Ctn/JjviT/r7sf/AEqjoA53/gi//wAmg3X/AGMN1/6Kgr6i8W+ENL8eeH7nSda06z1XTbxDHNbXUIlikB9VPH49q+Lf+CSn7QHgX4c/sxXWk+IvGXhfQdS/tu4uPs+panDayGNo4QGAkYcHBHHoa97+Jn/BQ34P/DDQ5ryfxxoesSxqWjtdGuV1CadscKPKJVSfVyoHcigD4P8Ag3obfsmf8FXbfw1oc8w0wa6dJEZbO+0ulBSNz/Fs8yM5PVowetfq3X5Y/sU6FrX7Z/8AwURufiNNYzW2k6bqL67dvkslrgEWtvvxhnyIxjglY3IAAxX6nUAflP8A8EkfDtj8Xv20tV1bxBawaldWWk3etxecgkUXTXECeZhs8jznIJyQcHOQDX6sV+LH7Cv7V9v+x58W9Q8TXOiza7HfaRJpYt4rkW7KXmgl3lirdPJIxj+LOeOfq/8A4fq6T/0TjUP/AAcJ/wDGqAPviivj/wDZt/4K16Z+0R8bdD8Gx+Cb/SpNckkjS6OopMsRSJ5OU8tcg7MZB4znnGK+wKAPy1/4Ii/8nWeIP+xTuf8A0ssq/UaaFbiJo5FV43BVlYZDA8EH61+Q/wDwS1+P/hH9nL9oHWNb8Z6t/Y2l3Xh+axim+yzXG+Zrm2cLtiR25WNzkgDjGckA/eV//wAFWvgTZ2kkkfjSa6dRkRRaNfB3PoN0Kr+ZAoA+U/8Agsf+zn4a+Enirwn4p8M6fa6LL4iNxDfW1pGIYXli8tlmVRwrEOQ2MAlVOMkk/fP7L/jS9+Iv7OPgXXNSkabUNU0K0nupCcmWUxLvf/gTZOO2cc1+bn7XH7Q2sf8ABTT47+GPC3gTQ7/+zdNMsVhHOAJZXlK+bczbSVjjVUQYJO0BjnLYH6ffCbwBD8KPhh4d8M2r+ZBoGnW+npIRjzfKjVN31bBP1NAHwn/wXU1q
4/tD4b6f5jC08u/uSgPDPmBQT9BnHpuPrX2F+yB4D0n4efsz+B7LSbO3tIpdEs7mYxxhWuJpIUeSR8feZmYkk+vpXxn/AMF1f+Rr+HH/AF6X/wD6HBU3w2/4LUaX4C+HWg6G/wAP7+5bRdOt7AzLqyKJTFEqbseUcZ25xzjPWgD9EqK+B/8Ah+rpP/RONQ/8HCf/ABqvrz9mr44QftIfBHQ/G1tp8+lQ62srC0mk8xojHNJCfmAGcmMkHA4IoA+D/wDgs98WtS8Z/Grw38OdPeaS10u3ju5LZD/x8XlwxVMjuVjC7T281x3r7U/ZM/ZM8N/sr/DbT9L03T7N9caBDquqeWDcX05A3/ORuEYbIVBwB2JJJ/P/APbRuWvP+CtscUu144dd0CJVIHCmGzbH5seueuOlfqxQBw/x4/Z98L/tHeBrrQfE+mW95DNGywXGwfaLFyOJIn6qwOOnBHBBBIP53/8ABM7xlqn7NP7dWrfDfUrh/serT3ei3cfSI3VsXaKYD32OikZyJvTkfqRX5T67cPZ/8Fko2ibYzeNIEJA6higb8wSPxoA/Vivy1/Yc/wCUserf9hbXv5XFfqVX5Ifs8fF/w78C/wDgpV4g8SeKtQ/svRbPWdajmuPIln2M7TqvyRqzcsQOAcdTgUAfrcRvGDyD1HrXwB/wWY/Zn8M+HPh/ovxA0XSrPS9WfVV03UfssSwpeJJFI6yOowC6tEFyBkiQ5JCjHvE3/BVX4DxQsy+OHlZRkIui3+5vpmAD9a+Of28v20pP29fEHhvwD8PND1e60+G/8+JZYgLjU7oqY0KoCdiIryHLHJDksFC8gH3B/wAE5/G198RP2LPAOpalM092tnLZGRm3MyW9xLbpk9zsiXJPJPOSea8G/wCC5n/JKfAv/YWn/wDRIr6i/ZP+C7/s9fs7+FfB8ssc1zo9oRdOmShnkdppdp7r5kjgHjIxwOlfLv8AwXM/5JT4F/7C0/8A6JFAHyn8HdV1
j9hf4x/DL4gMJrjQfE+nR3zlV/19rITFdQ+7oRvUe8Z71+xOk6rb65pdrfWc0dxaXkSzwyocrKjAMrA+hBBr4b8bfs2t+0L/AMEmvBM1hB5viDwnpQ1awCjLzKu/zoR/vR5YAclo0FecfBb/AIKQt4F/4J5a54Zl1Ax+ONE26JoZ3fvXtZw2yVfTyEWRcjIXbADy1AHOfteeK9Q/b3/bevPD+jXLN4d8JW9zbwzJ80ccFsjSXVx6Zd0Kq3QgRDNdf/wQz/5Kt46/7BMH/o412/8AwTH/AGbV8Afsl+M/iBqEGNV8YaVdw2W4fNDYxo4+o8yRS2OhWOMjrXEf8EM/+SreOv8AsEwf+jjQB+lNfJH/AAWR+Kn/AAhP7K8egwybbrxfqUVqyg4YwQnzpD/30kSn1D4r63r8xf8Agrl4quvjL+2F4W+H2mP5s2lW9vYpHn7t5eyK36obb3/SgDe079lvzv8AgjZcXZtx/a73TeM1ymCFR/Kzn0NmC3plvTJr1z/gjD8VP+Ex/ZlvvDcsm648Iam8aL6W9xmZD+MnnjHtX1BZfDXS7P4Ww+D/ACS+ixaUNH8r1txD5O3/AL44r84P+CVHiS6+Av7bfiP4f6pJtbVI7rSpEI2hru0dnVv++UmAHfeKAP0/r85/+C6v/I1/Dj/r0v8A/wBDgr9GK/Of/gur/wAjX8OP+vS//wDQ4KAPKP2dvGOqf8E6v2zNNt9YuHHhvXba3S9lK7Y57C6VXjuMesTEFiMkGORR1NfrXDMtxEskbK8cgDKynIYHkEfWvif/AIKO/swH4u/sd+FfGWl26vrngjR7eafaPnuLAwoZR7+WQJBngKJMcmuy/wCCTn7T3/C8PgCvhvUpvM8QeBxHZPubLXFoQRBJ6/KFMZ6/6tSTlsUAfL//AAUr/wCUk2jf9wj/ANDFfqVX5a/8FK/+Uk2jf9wj/wBDFfqVQB+XP/BTjxdq37SH7dOk/DbTrhvs2ky2mjWceT5S
3V1seSYj28yNWPAAh+pP6G/AX9nrwv8As4+A7PQfDOm29rHBEq3FzsH2i/kA5klfqzE5PoBwAAAB+drIr/8ABZ75gG/4q3PI7+Xn/wCvX6l0AMkjWeNlZVZWGGBGQQaSGFbeJY41VI0AVVUYCgcAD6VJRQB+V/7a1hD8Sv8AgrXZeH9YT7TpU2t6DpTwk9beWO1Mifj50nT1r9SNM0u10TTobOzt4LO1tkEcUMMYjjiUdFVRgAewr8nf28PHSfC7/gqdqXiaS3a9j8O6vomqNbq+xpxBa2cuwNg7SduMkHGc4Ne5f8P1dJ/6JxqH/g4T/wCNUAffFFfBC/8ABdPSS43fDnUgueSNXQ4/8hUUAeP/APBGLw7p/ib9qHXoNSsbPUIE8LXEix3MCzKGF3ZjOGB5wSM9cE+tfpt/wqTwp/0LHh7/AMF0P/xNflh+wZ8VtM/Ya/bH1218e/aNNgjtLrw9dziFpPskgnicSFVBYofJxlQeHBGRzX6Fp/wUG+C7qrf8LE8P/MM8u4P/AKDQB6bpHw/0Hw9erdafomkWNyoIEtvZxxSAHr8ygGrHi7/kVNU/69Jf/QDXCeAP2wfhj8VPF1roPh3xno2raxfb/s9pA7eZLsRnbGQOiqx+gNd34u/5FTVP+vSX/wBANAH5q/8ABDz/AJOB8W/9i8f/AEphr6U/4Kt/swf8Lz/Z/k1/TbXzvEngkPew7FzJcWhH7+L3woEgHJzGQOWOfmv/AIIef8nA+Lf+xeP/AKUw1+nDosiFWAZWGCCOCKAPzd+Av7To+K3/AATF+JHgnU7lpNc8FaQVg3n5riwaRfLPv5bZjOOi+X3Nd7/wQz/5JT46/wCwtB/6JNfLH7cfwT1D9jP9ozxBpuiNJa+HfFdlLJYgD929nOfntz/1zkXAzyAkbHkivqf/AIIZ/wDJKfHX/YWg/wDRJoA+hP8AgoL/AMmX/ET/ALBLf+hLXzR/wRR8G6P4o+F3jaTU9J03UZI9
VhVGubVJmQGHOBuBx64r6y/a88B3nxO/Zg8daHpsbzahf6POLaFB800irvRB7syhfxr4L/4JNftgeDf2eIvFHhvxpqB0NdYuIbq0vJYnaHeqsjxuVBKH7pBIx94Eg4BAP0b/AOFSeFP+hY8Pf+C6H/4mrug+DdI8LyyPpulabpzzACRrW2SEuB0ztAzXmH/DwX4L/wDRRPD3/fxv/ia6n4VftK+A/jfqtzY+E/FOla7d2cQnmhtpCXjQnbuwQOMkDPbI9RQBy3/BQX/ky/4if9glv/Qlr4t/4Jk/sP8Aw/8A2pfg54g1TxZY6hNqGn6ybWGW2vXhKx+RG23A+X7zE5xn3xX2l/wUF/5Mv+In/YJb/wBCWvDP+CHn/Jv3i3/sYT/6TQ0AfO//AAUq/YHsf2VbrRfEXhGO9k8J6gfslwtzJ57WV2MsMsRykigkZzgowJwQK+7v+CfXxU8LfFv9mfRb7wzpOk6C1qPsmqadp8Cwx214oG87VA+/w4JySHGSSDXo3xo+Emk/HX4X614T1uLzNP1q3MLsAC0LcFJF/wBpGCsD6qK/Mn9jz4s6x/wTv/bF1Twb4uk+zaJfXK6Vq5JPkpzm3vV/2cMGyefLlbIyAAAfrBX5V/8ABIu3j8Kftyahpk8nlzJpV/Zxq4+Z3SSMkfUKjH8DX6pg7xkcg9D61+WX7ZPgjxB+wV+3XbfErQ7PzNH1jUZNYsXOVhleTP2u0Yj7ud8gwBwkikcggAH6nV8D/wDBdX/kVPhx/wBfd/8A+gQV7t8NP+Cm/wAHPiH4Xgv5vFlr4fumQGew1NHhmt2xkrnG1/qhIPseB8p/8FfP2jvA/wAdNA8C2/hHxJp+vTabcXklyLUs3kq6whSSR32njrxQB9ufsQ/8mg/Db/sXrP8A9FCvUq8t/Yh/5NB+G3/YvWf/AKKFepUAfC3/AAW7+FuhyfCrw142FmE8RRavFopuVOPNtXhuZtjDvteMFT1G5h3473/gkP8A
CDQfCH7KGleK7Oz2694ue4OoXTHczrBdzwxov91QqA4HViSewGL/AMFuv+TU/D//AGNlt/6R3tehf8Erf+TC/Af/AHEP/TjdUAfQlFFFABXzX/wVs/5Md8Sf9fdj/wClUdfSlfNf/BWz/kx3xJ/192P/AKVR0AfKv7BX/BNrwf8AtY/AWTxRrOteJdN1KPVZrEpZSQeQY0SNh8rRlt2XPO7GAOB1r37wl/wRY+FOhXqTajqXi7W9rZME15FDC49D5cSv+IcVa/4Iv/8AJoN1/wBjDdf+ioK+tqAOd+Gfwp8OfBrwpDofhbR7HRNLhO4QW0e0MxGCzn7zscDLMSTgZJxXRUUUAflR/wAEYvDun+Jv2odeg1Kxs9QgTwtcSLHcwLMoYXdmM4YHnBIz1wT61+m3/CpPCn/QseHv/BdD/wDE1+WH7EXxP0/9g/8AbW12x8cefY2cUN34evLjyWkNsfOjkSbao3Mh8leVByrggEV+haf8FBvgu6q3/CxPD/zDPLuD/wCg0Ael6T8PdA0K/S6sdD0eyuY8hJoLOOORcjBwygHkZH0NbVeY+BP2yPhf8TvFdpoeg+NtE1TVr4stvawynzJiqliBkDnapOOvFenUAfj3/wAEyv2c/C/7Tnx11rw/4ttbm60618PzX0QguHgeOZbi2jDZU/3ZHGDkc5xwK9r/AG/v+CXHh74Q/BWTxd8PYdU36C5l1a1uLk3BktSMGVOMgxnBIHBUsTjbzx3/AARF/wCTrPEH/Yp3P/pZZV+od9ZQ6nZzW1xFHcW9wjRSxSKGWRWGCpB6gjIweMUAfGf/AARo+K/hfxR8I9Q8N2+k6Tpfi7QXDXk9vAsc+rWzsTHM7Y3MVbKMOQPkPBfFfadfkr8W/C2tf8EvP24bTV9Fjnl8PSSm8sFZztvtPkbbLas395OVyckFY3xyBX6peAvG+m/EzwXpfiDR7hbzS9Ytku7aUfxowyMjsR0IPIIIPIoA/P8A/wCC6v8A
yNfw4/69L/8A9Dgr7H/Z++Fnhm8+A/gmaXw5oMssug2Du76fEzMxt4ySTt5J9e9fHH/BdX/ka/hx/wBel/8A+hwV9zfs7f8AJv3gX/sXtP8A/SaOgDR/4VJ4U/6Fjw9/4Lof/ia2dO0u30exjtbO3htbaEYjihQJGg9lHA/CrFFAH5Uftzwr4a/4Ktw6heSCG1m1fQ7wuwOEjWK1Rj+Hlt0r9V6+Af8AgtD+zPqGtDR/ido9rJcRabbDTNZESktBGHLwznH8IZ3RmOMZj6jp3f7JH/BWHwP42+Hun6f4/wBWHhvxVYQJBcT3MTta6iVGPNWRQQrNjLK2OScEjoAfYdflPLEPFP8AwWS22bCbyvGoZiATjyDmQfh5bDPQYz05r6z/AGg/+Cr3wz+GXgu8k8L6vD4v8RyREWVraxSfZ0c8BpZSAoUdSFJY4xgZyPn7/gkL8A9a+I3xu1T4va9HO1nYm4FpdTJg6hfT7lmkU/xBVaQMRxukAByCAAfpNX5F/AT4MeH/AI//APBSLxB4X8TWst5o97rOtSSxRzvCxZGndTuUg8MAfev10r8tf2HP+Userf8AYW17+VxQB6p+2F/wSV8J+E/gXq2tfDu31ceINEH21ree7NwLy3QEyooI++F+dcZJKbcEkYof8EU/ix4Ylt9b8Hz6TpFn4uhzeWupLbqt1qVqSN8TPjcTGxBAzgq/A+Qk/oLX5S/ty/BjVf2Cf2utK8d+DlNlo+pXZ1XSigPlW0wP+kWjYx8h3H5eAY5doztNAH6tV8Mf8FzP+SU+Bf8AsLT/APokV9a/AX4z6V+0F8JdF8XaM3+h6xAHaMnL20o4kib/AGkcFfQ4yMggn5K/4Lmf8kp8C/8AYWn/APRIoA+hP+CfX/Jl/wAO/wDsEr/6E1eJ+L/+CK3gXxN46v8AVIPEniDS9PvrtrkafBFEVt1ZtxjRyMhRyFJBIGM5xk+2f8E+v+TL/h3/ANglf/Qmr2OgDkPG/h6z
8I/AjWNK063jtdP03QZ7W2gQYWKJLdlRR9AAK+Bf+CGf/JVvHX/YJg/9HGv0I+Ln/JKfE/8A2Cbr/wBEvX57/wDBDP8A5Kt46/7BMH/o40AfpLPPHaQPJI6xxxqWd2OFUDkkn9a/GXTB8QP2t/2wvEnib4cWdzeeJG1CfXLNknht2s7dJVSJt0zKo2K0SjPOccZr9Nf+Cg/xX/4U/wDsheNNSjk8u8vLM6VaYOGMlwRDlfdVd3z/ALH4V85f8EOvhX9j8J+NPGs0fzX1zFo9qxHIWJfNlx7FpIufVCOoOADjP+FZftxf8/PiH/wf6Z/8erwbxZbfEf8AZR/ax8O+KfiNZ3Vr4nW+t9enZ7iG4a+hEu1yXhZkywSRCMg884yCf2ir4V/4LgfCn+1fhx4R8ZQx/vdHvZNMuWA5MU670J9leIj6y+9AH3JY3sOo2kNxbyLNBcIskbqcq6kZBHsRivzt/wCC6v8AyNfw4/69L/8A9Dgr6l/4JyfFX/hbf7Hfg28kkMl5pdqdHusnLBrY+WuT6mMRtk8ndzzXy1/wXV/5Gv4cf9el/wD+hwUAfePwxs4dS+Dvh63uI45oLjRraOSN13LIpgUEEdwRxg9RX5mX8F5/wS8/4KFLKq3K+D7yXcuNz/adJuGwR6u0LDp1LQA9Dz+nPwj/AOSU+GP+wTa/+iUr5+/4Krfsw/8AC9/2e5tc0+38zxF4IEmoW4VctcW2AbiL/vlQ46kmPA+8aAPlH/govqNvq/8AwUV8P3drNHcWt1Ho8sMsbblkRmUqwPcEEHI6iv1Qr8JfBvjTUvGnxW8D/wBpXDXLaVcWGnQM33hBHMPLU/7oIUegVR2r92qAPyy1W4XQv+Czitdt5KyeLokXPcyxqE/76LL+dfqbX5t/8FfvgFrXw++NOk/F7QY51tLz7Ol5dQglrC+gwIZWP8IZFjVSeA0RBILKD77+zx/wVe+GvxM8E2beKtYh8I+JIolW9trqJ/s8kgHz
PFIoK7T1CsQwzjBAyQD6norxW+/4KJfBOwiDyfELRGUnb+6Esp/JUJ/E8V6t4R8X6d4+8L6frWj3SX2l6pAl1a3CKQs0bjKsAQDyD0IBoA/MX9qa1h1H/gsrY29xFHNDN4p8ORyRyKGWRTDYAgg9QRkYPBFfpb/wqTwp/wBCx4e/8F0P/wATX5qf8FFoLz4Df8FKdN8eX1nLPps13pOv22wf69bQQRvGDwN263PBIwHUnAINfbmhf8FHfgr4g0mG7Tx7pVqJ1DGK6SSGaI9wysucjpxkehI5oA9PHwl8Kg5Hhnw+COhGnQ8f+O0V56P+CgnwXJx/wsTw96f61v8A4migDyz/AIKn/s/+DvEfwnufGV3oNq3ia1CQJqCO8UjpjgPtYCTHQFwSBwMV+UtFFAH0Z/wSggWb9unwgzLloob91PofsUw/kT+dfrxrca3Gj3kb/MkkDqw9QVOaKKAPhn/gkb4B0nw78R/F15Z2nk3P9mww7/NdvkaXJGCSOSi89eK+8qKKAPl//gqv8ONE8Z/APT77UtPjurzS9URbSbcyPCsiNvAKkcNtXIPHyj0qH/gk54I0vwn8B9am0+1+zy32suJ28xm37Iowv3icY3Hp60UUAfU1fnl/wV7/AGefBfgqxtfFGkeH7PTdc1iV3vJ7ZnjW4bIJYxhvL3EkksFyxOSSaKKAPz8r7m/4Ia2MUnxa8dXDL++i0mGJGyeFabLD8Si/lRRQB9xfte6Tb69+zB46tbuPzreTR5yy7iucDI5GD1Arxv8A4JJ+GrLw18EPEUdjD5KSa4WYb2bJ+zw+pNFFAH1ZXwn/AMFdfhZ4f1jxh4S1i402NtTubWa2luFd0aWONlKBtpAOC7YJ55x0AoooA+sf2Yd3/DOfgXdJLIRoVmN0khkY4hXqzEk/ia3/AIgfDvQ/ir4VutD8R6XZ6xpN4oEttcxh0PXBHdWHUMMEHkEUUUAfi3+2J8OtG+Ffx/1zRNBs/sGl2cu2
GHzXl2De4+87Mx4A6ntVD9nTwRpfjzxh9l1a1+1W+U+XzHj67s8qQewoooA/a34TeFrHwR8MvDuj6Xb/AGXTtO06GC3h3s/loqKAMsST9SSa6KiigD5p/wCCqfhWw8Wfsz2seoW/2hLXXLeeIb2Xa/lTLn5SM/K7DB45rtP2AtCtfDf7IfgyzsovJt44bh1TcWwWuZmbkknlmJ/GiigD2KiiigArxL/gof4fs/E37H/iu3vofPhX7JIF3FcMLuHByCD3oooAwv8Agl94ZsfC/wCy3HDYw+RHNqt1K43s2W+Vc/MT2UflX0VRRQAUUUUAfK//AAU4/Z38F+LfhNe+L77w/ZyeJrNo4Y9QRnhmZMHhyjASYwAN4OBwMV+S9FFAH0H/AMEtLKO9/bl8F+au7yvtUqckYYWs2DX7G0UUAfBP/BKz4c6N4T/aA8XXGn2f2eaHSpLZG8132xm5jJX5ie8ac9ePrX3tRRQB8y/8FVPh9o3jP9nezutSsY7q50vVIjaylmV4d6sHAKkHDADIPB2g9QKvf8Eu9Pj0j9l6Ozt/NW2t9VuVijaVpBEDsYhdxOAWZjgcZYnqTRRQB5h/wV+8FaZ4lufAdxfWvnSxrfRq3mOuF/cHGAQOtfXfwp0+HSfhd4btbdPLgtdKtoolyTtVYkAGTzwB3oooA6CiiigCO7tIdQtZre4ijmgnQxyRyKGSRSMEEHggjgg1+Wv/AAVb/Z18F/BDxdp83hPQbfQ21P8Ae3CW8knlEnrtjLFUHsgAHYUUUAcf/wAE1/gZ4V+OHxfjsfFWkpq1pG24RPPLGpIUkZ2MuRkdDkGv1x0Dw9Y+FNHtdN0uztdP0+zjEUFtbRCOKFB0VVHAH0oooAu18E/smfDjRdL/AOCkvii+t7Py7q3vNXljfznO1mlZScFschmHTvRRQB97V4h/wUP8B6R49/ZR8Rpq9jHerpphvLUsSrQTCRUDqQQQdrsPcMaKKAPO/wDgkho1v4f+
Evii1tFkjt/7VSQRmV3VWMK5IDE4zgZx1wKT/grf4S0/xP8ACDwu19b+ebfVyI/3jLt3Qvn7pHoOvpRRQB7f+yRotr4d/Zm8C2dnH5NvHotsypuLYLRhm5JJ5Yk/jXotFFAGf4osYtU8M6ha3CeZBcW8sUiE43KUYEflXxX/AMEjfAuleGfGvjqextfJl+y2sW7zHb5S8hIwSR1A/KiigD0b/gq/oNr4j/Zv0uG8jM0S+Irdwu9l5+z3I/hIz1PFdt/wT78Kaf4P/ZK8J2+m2y2sMyzzyAMW3u08mWJJJ7D8qKKAPaK8d/b78MWPiz9kjxja6hbrcwLBFMqklSrpPGykEEEYI7HkZB4JFFFAHm//AASU0C18N/ArxBb2UbQwtrzyFPMZhuNvACfmJxwB09BXD/8ABXzwhp3ibWvAcl9b+c8UF8qnzGXA3QehFFFAH2d4Qso9M8JaVbwL5cNvaQxRrknaoRQBk89K02XcMEZB4I9aKKAPy40P4B+EbT9u230uLRo49Ph8XeXHbpNKqIq3PCgbug9K/UiiigCnruhWPijSLjTtSs7XUNPvYzFcW1zEssM6HqrKwIYH0Nfkb/wUw+BnhX4FfG7+zvCekpo9jMvmNCk8si5KhjjezYGSeBgDtRRQB4r8HfDln4r+IFnY6hD9otZj86b2XP4qQa/cD4K+GrLwd8HvC+l6bD9nsbHSraKCLez7FES4GWJJ/EmiigDC/ac+CXhT43fCnUrXxVolnrEWn2011atJuSW2kWMsGSRCHXJUZAIDAYORxX4ofEvR7fw/451Kzs4/Jt7ebZGm4ttH1JJoooAydNiW41O3jYbkklRWHqD1ooooA//Z</ImageData>
    </EmbeddedImage>
  </EmbeddedImages>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>0eeb6585-38ae-40f1-885b-8d50088d51b4</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

OBJECT Report 70005 CMMS Asset MD Statistic
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=15:27:21;
    Modified=Yes;
    Version List=CMMS,CMMSREP;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Asset MD Export;
               DEA=Anlagen Stammdaten Export];
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  CLEAR(OptionSelected);
                  CalcMD;

                  IF ShowRelated[1] THEN
                    CalcProjects;

                  IF ShowRelated[2] THEN
                    CalcContracts;

                  IF ShowRelated[3] THEN
                    CalcCustomer;

                  IF ShowRelated[4] THEN
                    CalcRelations;

                  IF ShowRelated[5] THEN
                    CalcUser;

                  IF ShowRelated[6] THEN
                    CalcEQPT;
                END;

    OnPostReport=BEGIN
                   CreateInfoSheet;

                   IF ShowMD THEN
                     ExportMD;

                   IF ShowRelated[1] THEN
                     ExportProjects;

                   IF ShowRelated[2] THEN
                     ExportContracts;

                   IF ShowRelated[3] THEN
                     ExportCustomer;

                   IF ShowRelated[4] THEN
                     ExportRelations;

                   IF ShowRelated[5] THEN
                     ExportUser;

                   IF ShowRelated[6] THEN
                     ExportEQPT;

                   //Close Excel
                   IF OptionSelected <> 0 THEN
                     IGExcelExport.CloseBook;
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;SourceRec         ;
               DataItemTable=Table70020;
               DataItemTableView=SORTING(Objecttype,No.)
                                 WHERE(Objecttype=CONST(Asset));
               ReqFilterFields=No.,Name,Country Code,Responsibility Center,Capacity DC kWp,Customer No. Filter,Customer Name Filter,Customer Company Chain Filter,Project No. Filter,Project Name Filter,Contract No. Filter,Contact No. Filter,Business Relation Filter,User ID (Role) Filter }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1000000000;;Container;
                  ContainerType=ContentArea }

      { 1000000001;1;Field  ;
                  Name=ShowMD;
                  CaptionML=[ENU=Show Master Data;
                             DEA=Zeige Stammdaten];
                  SourceExpr=ShowMD }

      { 1000000002;1;Field  ;
                  Name=ShowRelated[1];
                  CaptionML=[ENU=Projects;
                             DEA=Projekte];
                  SourceExpr=ShowRelated[1] }

      { 1000000003;1;Field  ;
                  Name=ShowRelated[2];
                  CaptionML=[ENU=Contracts;
                             DEA=Vertr„ge];
                  SourceExpr=ShowRelated[2] }

      { 1000000004;1;Field  ;
                  Name=ShowRelated[3];
                  CaptionML=[ENU=Customers;
                             DEA=Debitoren];
                  SourceExpr=ShowRelated[3] }

      { 1000000005;1;Field  ;
                  Name=ShowRelated[4];
                  CaptionML=[ENU=Relations;
                             DEA=Beziehungen];
                  SourceExpr=ShowRelated[4] }

      { 1000000006;1;Field  ;
                  Name=ShowRelated[5];
                  CaptionML=[ENU=Users;
                             DEA=Benutzer];
                  SourceExpr=ShowRelated[5] }

      { 1000000007;1;Field  ;
                  Name=ShowRelated[6];
                  CaptionML=[ENU=Equipment;
                             DEA=Equipment];
                  SourceExpr=ShowRelated[6] }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      ShowMD@1000000000 : Boolean;
      ShowRelated@1000000001 : ARRAY [10] OF Boolean;
      i@1000000006 : Integer;
      j@1000000005 : Integer;
      IGExcelExport@1000000004 : Codeunit 70028;
      Window@1000000003 : Dialog;
      OptionSelected@1000000002 : Integer;
      CMMSReportingMgmt@1000000011 : Codeunit 70027;
      TempMDBuffer@1000000007 : TEMPORARY Record 70007;
      WText001@1000000009 : TextConst 'ENU=Calculation in Progress:\\;DEA=Berechnung in Bearbeitung:\ \';
      WText002@1000000008 : TextConst 'ENU=No.:          #1#######\\;DEA=Nummer.:         #1#######\\';
      SheetHeader@1000000010 : TextConst 'DEA=Reportname';
      TempProjectBuffer@1000000012 : TEMPORARY Record 70007;
      TempContBuffer@1000000013 : TEMPORARY Record 70007;
      TempCustBuffer@1000000014 : TEMPORARY Record 70007;
      TempRelBuffer@1000000015 : TEMPORARY Record 70007;
      TempUserBuffer@1000000016 : TEMPORARY Record 70007;
      TempEQPTBuffer@1000000017 : TEMPORARY Record 70007;

    LOCAL PROCEDURE CreateInfoSheet@1000000023();
    VAR
      SheetName@1000000003 : TextConst 'ENU=Information;DEA=Information';
      Caption001@1000000000 : TextConst 'ENU=Master Data;DEA=Stammdaten';
      Caption002@1000000001 : TextConst 'ENU=Projects;DEA=Projekte';
      Caption003@1000000002 : TextConst 'ENU=Contracts;DEA=Vertr„ge';
      Caption004@1000000004 : TextConst 'ENU=Customer;DEA=Debitoren';
      Caption005@1000000005 : TextConst 'ENU=Relations;DEA=Beziehungen';
      Caption006@1000000006 : TextConst 'ENU=User;DEA=Benutzer';
      Caption007@1000000007 : TextConst 'ENU=Equipment;DEA=Equipment';
    BEGIN
      i := 0;
      IGExcelExport.EnterHeader(FORMAT(SheetHeader),'',i);
      i += 1;
      IGExcelExport.EnterCell(IGExcelExport.IncInt(i),1,FORMAT(Caption001),TRUE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
      IGExcelExport.EnterCell(i,2,FORMAT(ShowMD),FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}

      IGExcelExport.EnterCell(IGExcelExport.IncInt(i),1,FORMAT(Caption002),TRUE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
      IGExcelExport.EnterCell(i,2,FORMAT(ShowRelated[1]),FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}

      IGExcelExport.EnterCell(IGExcelExport.IncInt(i),1,FORMAT(Caption003),TRUE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
      IGExcelExport.EnterCell(i,2,FORMAT(ShowRelated[2]),FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}

      IGExcelExport.EnterCell(IGExcelExport.IncInt(i),1,FORMAT(Caption004),TRUE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
      IGExcelExport.EnterCell(i,2,FORMAT(ShowRelated[3]),FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}

      IGExcelExport.EnterCell(IGExcelExport.IncInt(i),1,FORMAT(Caption005),TRUE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
      IGExcelExport.EnterCell(i,2,FORMAT(ShowRelated[4]),FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}

      IGExcelExport.EnterCell(IGExcelExport.IncInt(i),1,FORMAT(Caption006),TRUE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
      IGExcelExport.EnterCell(i,2,FORMAT(ShowRelated[5]),FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}

      IGExcelExport.EnterCell(IGExcelExport.IncInt(i),1,FORMAT(Caption007),TRUE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
      IGExcelExport.EnterCell(i,2,FORMAT(ShowRelated[6]),FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}

      i += 1;
      IF SourceRec.GETFILTERS() <> '' THEN IGExcelExport.EnterCell(IGExcelExport.IncInt(i),1,SourceRec.GETFILTERS(),FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}

      OptionSelected += 1;

      IGExcelExport.CreateBook(FORMAT(SheetName),FORMAT(SheetHeader));
    END;

    PROCEDURE Open@1000000000();
    BEGIN
      Window.OPEN(WText001 + WText002);
    END;

    PROCEDURE Update@1000000001(DialogValue@1000000000 : Text);
    BEGIN
      Window.UPDATE(1,DialogValue);
    END;

    PROCEDURE Close@1000000002();
    BEGIN
      Window.CLOSE;
    END;

    LOCAL PROCEDURE CheckMD@1000000009(SourceNo@1000000000 : Code[20]) : Boolean;
    BEGIN
      TempMDBuffer.RESET;
      TempMDBuffer.SETRANGE(AssetNo1,SourceNo);

      IF TempMDBuffer.FINDFIRST THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    LOCAL PROCEDURE CalcMD@1000000012();
    VAR
      Rec@1000000000 : Record 70020;
      Show@1000000001 : Boolean;
      RecRef@1000000002 : RecordRef;
    BEGIN
      //Calculate Masterdata
      Show := TRUE;

      IF SourceRec.GETFILTERS <> '' THEN
        Rec.COPYFILTERS(SourceRec);

      IF Rec.FINDFIRST THEN BEGIN
        Open;
        REPEAT
          Update(Rec."No.");
          Show := TRUE;
          //Customer No.
          RecRef.GETTABLE(Rec);

          IF Show THEN Show := CMMSReportingMgmt.MDCustNoSearch(RecRef,SourceRec.GETFILTER("Customer No. Filter"));
          IF Show THEN Show := CMMSReportingMgmt.MDCustNameSearch(RecRef,SourceRec.GETFILTER("Customer Name Filter"));
          IF Show THEN Show := CMMSReportingMgmt.MDCustChainSearch(RecRef,SourceRec.GETFILTER("Customer Company Chain Filter"));
          IF Show THEN Show := CMMSReportingMgmt.MDProjectNoSearch(RecRef,SourceRec.GETFILTER("Project No. Filter"));
          IF Show THEN Show := CMMSReportingMgmt.MDProjectNameSearch(RecRef,SourceRec.GETFILTER("Project Name Filter"));
          IF Show THEN Show := CMMSReportingMgmt.MDContractNoSearch(RecRef,SourceRec.GETFILTER("Contract No. Filter"));
          IF Show THEN Show := CMMSReportingMgmt.MDContactNoSearch(RecRef,SourceRec.GETFILTER("Contact No. Filter"));
          IF Show THEN Show := CMMSReportingMgmt.MDBusRelationSearch(RecRef,SourceRec.GETFILTER("Business Relation Filter"));
          IF Show THEN Show := CMMSReportingMgmt.MDUserIDSearch(RecRef,SourceRec.GETFILTER("User ID (Role) Filter"));
          IF Show THEN BEGIN
            i += 1;
            TempMDBuffer.INIT;
            TempMDBuffer."Entry No." := i;
            TempMDBuffer.AssetNo1 := Rec."No.";
            TempMDBuffer.INSERT;
          END;
        UNTIL Rec.NEXT = 0;
        Close;
      END;
    END;

    LOCAL PROCEDURE ExportMD@1000000025();
    VAR
      Column001@1000000000 : TextConst 'DEA=Text';
      SheetName@1000000001 : TextConst 'ENU=Master Data;DEA=Stammdaten';
      Rec@1000000002 : Record 70020;
    BEGIN
      //Export To Excel
      i := 0;
      TempMDBuffer.RESET;
      IF TempMDBuffer.FINDFIRST THEN BEGIN
        OptionSelected += 1;
        //Header
        j := 0;
        i += 1;

        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("No."),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Name),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Name 2"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION(City),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Country Code"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Responsibility Center"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Company Name"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Capacity DC kWp"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        //++AD - All Fields...
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Objecttype),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Address),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Extended Address"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Post Code"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Coordinates Latitude"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Coordinates Longitude"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Country/Region Name"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Contact No."),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Portfolio),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Country Specific ID"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Other General Information"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Operational Status"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Commercial Status"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Inactive at Date"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Main Asset No."),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Asset Type"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Is Project of Asset"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Asset No. Filter"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Dimension Set ID"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("New Workorders"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Open Workorders"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("In Proc. Workorders"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Completed Workorders"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Done Workorders"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Discarded Workorders"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Users),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Customers),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Activities),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Subassets),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Projects),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Contracts),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Relations),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Assets),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Inverter Type"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Mounting),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Surroundings),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Commissioning Date"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("PAC Date"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("FAC Date"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Additional Technical Info"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Export PPA Price"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Export PPA Currency"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Irradiation Yield Study"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Anticipated Annual Yield"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Subsidy Tariff Details"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Subsidy Tariff Currency"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Available in PV Plus"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Available in EEM"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("EEM Identification"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Direct Marketer Interface"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("External Portal Available"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Monitoring Type of Internet"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Monitoring Internet Details"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Security Internet Details"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("On Site Maintanance"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Security Center Handling"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Site Entry Specifics"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Health and Safety Requirements"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Project Order No."),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Project Quote No"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Project Start Date"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Project End Date"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Project Trigger"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Project Goals"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Project Summary"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Project Documentation"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Project Prority"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Weekend Working Procedure"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Customer Demand Level"),TRUE,FALSE,FALSE,FALSE,'',1);
        IGExcelExport.EnterCell(i, IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Monitoring Access Details"),TRUE,FALSE,FALSE,FALSE,'',1);
        //--AD
        REPEAT
          j := 0;
          i += 1;
          IF NOT Rec.GET(Rec.Objecttype::Asset,TempMDBuffer.AssetNo1) THEN Rec.INIT;
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempMDBuffer.AssetNo1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.Name,FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec."Name 2",FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.City,FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec."Country Code",FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec."Responsibility Center",FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec."Company Name",FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Capacity DC kWp"),FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          //++AD All Fields
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Objecttype),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Address),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Extended Address"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Post Code"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Coordinates Latitude"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Coordinates Longitude"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Country/Region Name"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Contact No."),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Portfolio),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Country Specific ID"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Other General Information"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Operational Status"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Commercial Status"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Inactive at Date"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Main Asset No."),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Asset Type"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Is Project of Asset"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Asset No. Filter"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Dimension Set ID"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."New Workorders"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Open Workorders"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."In Proc. Workorders"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Completed Workorders"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Done Workorders"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Discarded Workorders"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Users),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Customers),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Activities),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Subassets),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Projects),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Contracts),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Relations),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Assets),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Inverter Type"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Mounting),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec.Surroundings),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Commissioning Date"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."PAC Date"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."FAC Date"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Additional Technical Info"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Export PPA Price"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Export PPA Currency"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Irradiation Yield Study"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Anticipated Annual Yield"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Subsidy Tariff Details"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Subsidy Tariff Currency"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Available in PV Plus"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Available in EEM"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."EEM Identification"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Direct Marketer Interface"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."External Portal Available"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Monitoring Type of Internet"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Monitoring Internet Details"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Security Internet Details"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."On Site Maintanance"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Security Center Handling"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Site Entry Specifics"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Health and Safety Requirements"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Project Order No."),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Project Quote No"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Project Start Date"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Project End Date"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Project Trigger"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Project Goals"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Project Summary"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Project Documentation"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Project Prority"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Weekend Working Procedure"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Customer Demand Level"),FALSE,FALSE,FALSE,FALSE,'',1);
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Rec."Monitoring Access Details"),FALSE,FALSE,FALSE,FALSE,'',1);
          //--AD
        UNTIL TempMDBuffer.NEXT = 0;

        //Create Excel
        IF OptionSelected = 1 THEN
          IGExcelExport.CreateBook(FORMAT(SheetName),FORMAT(SheetHeader))
        ELSE
          IGExcelExport.Create2ndWorksheet(FORMAT(SheetName),FORMAT(SheetHeader));
      END;
    END;

    LOCAL PROCEDURE CalcProjects@1000000006();
    VAR
      Rec@1000000000 : Record 70021;
      Show@1000000001 : Boolean;
    BEGIN
      //Calculate Projects
      Show := TRUE;

      Rec.RESET;
      Rec.SETRANGE(Type,Rec.Type::Project);
      Rec.CALCFIELDS("Project NameXX");

      IF SourceRec.GETFILTER("Project No. Filter") <> '' THEN
        Rec.SETFILTER(Key2,SourceRec."Project No. Filter");

      IF SourceRec.GETFILTER("Project Name Filter") <> '' THEN
        Rec.SETFILTER("Project NameXX",SourceRec."Project No. Filter");

      IF Rec.FINDFIRST THEN BEGIN
        Open;
        REPEAT
          Update(Rec.Key2);
          Show := TRUE;

          IF Show THEN Show := CheckMD(Rec.Key1);

          IF Show THEN BEGIN
            i += 1;
            TempProjectBuffer.INIT;
            TempProjectBuffer."Entry No." := i;
            TempProjectBuffer.AssetNo1 := Rec.Key1;
            TempProjectBuffer.ProjectNo1 := Rec.Key2;
            TempProjectBuffer.INSERT;
          END;
        UNTIL Rec.NEXT = 0;
        Close;
      END;
    END;

    LOCAL PROCEDURE ExportProjects@1000000005();
    VAR
      Column001@1000000000 : TextConst 'ENU=Asset No.;DEA=Anlagennr.';
      Column002@1000000003 : TextConst 'ENU=Project No.;DEA=Projektnr.';
      SheetName@1000000001 : TextConst 'DEA=Projects';
      Rec@1000000002 : Record 70020;
    BEGIN
      //Export To Excel
      i := 0;
      TempProjectBuffer.RESET;
      IF TempProjectBuffer.FINDFIRST THEN BEGIN
        OptionSelected += 1;
        //Header
        j := 0;
        i += 1;

        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column001),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column002),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Name),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Name 2"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION(City),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Country Code"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Responsibility Center"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Company Name"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}

        REPEAT
          j := 0;
          i += 1;
          IF NOT Rec.GET(Rec.Objecttype::Project,TempMDBuffer.ProjectNo1) THEN Rec.INIT;
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempProjectBuffer.AssetNo1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempProjectBuffer.ProjectNo1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.Name,FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec."Name 2",FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.City,FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec."Country Code",FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec."Responsibility Center",FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec."Company Name",FALSE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        UNTIL TempProjectBuffer.NEXT = 0;

        //Create Excel
        IF OptionSelected = 1 THEN
          IGExcelExport.CreateBook(FORMAT(SheetName),FORMAT(SheetHeader))
        ELSE
          IGExcelExport.Create2ndWorksheet(FORMAT(SheetName),FORMAT(SheetHeader));
      END;
    END;

    LOCAL PROCEDURE CalcContracts@1000000028();
    VAR
      Rec@1000000000 : Record 70021;
      Show@1000000001 : Boolean;
    BEGIN
      //Calculate Projects
      Show := TRUE;

      Rec.RESET;
      Rec.SETRANGE(Type,Rec.Type::Contract);

      IF SourceRec.GETFILTER("Contract No. Filter") <> '' THEN
        Rec.SETFILTER(Key2,SourceRec."Contract No. Filter");

      IF Rec.FINDFIRST THEN BEGIN
        Open;
        REPEAT
          Update(Rec.Key2);
          Show := TRUE;

          IF Show THEN Show := CheckMD(Rec.Key1);

          IF Show THEN BEGIN
            i += 1;
            TempContBuffer.INIT;
            TempContBuffer."Entry No." := i;
            TempContBuffer.AssetNo1 := Rec.Key1;
            TempContBuffer.ContractNo1 := Rec.Key2;
            TempContBuffer.INSERT;
          END;
        UNTIL Rec.NEXT = 0;
        Close;
      END;
    END;

    LOCAL PROCEDURE ExportContracts@1000000027();
    VAR
      Column001@1000000002 : TextConst 'ENU=Asset No.;DEA=Anlagennr.';
      Column002@1000000000 : TextConst 'ENU=Contract No.;DEA=Vertragnr.';
      SheetName@1000000001 : TextConst 'DEA=Contracts';
    BEGIN
      //Export To Excel
      i := 0;
      TempContBuffer.RESET;
      IF TempContBuffer.FINDFIRST THEN BEGIN
        OptionSelected += 1;
        //Header
        j := 0;
        i += 1;

        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column001),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column002),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}

        REPEAT
          j := 0;
          i += 1;
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempContBuffer.AssetNo1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempContBuffer.ContractNo1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
        UNTIL TempContBuffer.NEXT = 0;

        //Create Excel
        IF OptionSelected = 1 THEN
          IGExcelExport.CreateBook(FORMAT(SheetName),FORMAT(SheetHeader))
        ELSE
          IGExcelExport.Create2ndWorksheet(FORMAT(SheetName),FORMAT(SheetHeader));
      END;
    END;

    LOCAL PROCEDURE CalcCustomer@1000000040();
    VAR
      Rec@1000000000 : Record 70021;
      Show@1000000001 : Boolean;
      ObjectCompanyName@1000000002 : Text[30];
    BEGIN
      //Calculate Projects
      Show := TRUE;

      Rec.RESET;
      Rec.SETRANGE(Type,Rec.Type::Customer);

      IF SourceRec.GETFILTER("Customer No. Filter") <> '' THEN
        Rec.SETFILTER(Key2,SourceRec."Customer No. Filter");

      IF SourceRec.GETFILTER("Customer Name Filter") <> '' THEN
        Rec.SETFILTER("Customer Name",SourceRec."Customer Name Filter");

      IF SourceRec.GETFILTER("Customer No. Filter") <> '' THEN
        Rec.SETFILTER("Customer Company Chain",SourceRec."Customer No. Filter");

      IF Rec.FINDFIRST THEN BEGIN
        Open;
        REPEAT
          Update(Rec.Key2);
          Show := TRUE;
          ObjectCompanyName := Rec.GetObjectCompanyName();

          IF Show THEN Show := CheckMD(Rec.Key1);

          IF Show THEN BEGIN
            i += 1;
            TempCustBuffer.INIT;
            TempCustBuffer."Entry No." := i;
            TempCustBuffer.AssetNo1 := Rec.Key1;
            TempCustBuffer.CustomerNo1 := Rec.Key3;
            TempCustBuffer.Name1 := ObjectCompanyName;
            TempCustBuffer.Name2 := Rec."Customer Name";
            TempCustBuffer.Name3 := Rec."Customer Company Chain";
            TempCustBuffer.INSERT;
          END;
        UNTIL Rec.NEXT = 0;
        Close;
      END;
    END;

    LOCAL PROCEDURE ExportCustomer@1000000039();
    VAR
      Column001@1000000000 : TextConst 'ENU=Asset No.;DEA=Anlagennr.';
      Column002@1000000003 : TextConst 'ENU=Customer No.;DEA=Debitorennr.';
      SheetName@1000000001 : TextConst 'DEA=Customer';
      Rec@1000000002 : Record 70021;
    BEGIN
      //Export To Excel
      i := 0;
      TempCustBuffer.RESET;
      IF TempCustBuffer.FINDFIRST THEN BEGIN
        OptionSelected += 1;
        //Header
        j := 0;
        i += 1;

        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column001),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column002),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),SourceRec.FIELDCAPTION("Company Name"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Customer Name"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Customer Company Chain"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}

        REPEAT
          j := 0;
          i += 1;
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempCustBuffer.AssetNo1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempCustBuffer.CustomerNo1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempCustBuffer.Name1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempCustBuffer.Name2,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempCustBuffer.Name3,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
        UNTIL TempCustBuffer.NEXT = 0;

        //Create Excel
        IF OptionSelected = 1 THEN
          IGExcelExport.CreateBook(FORMAT(SheetName),FORMAT(SheetHeader))
        ELSE
          IGExcelExport.Create2ndWorksheet(FORMAT(SheetName),FORMAT(SheetHeader));
      END;
    END;

    LOCAL PROCEDURE CalcRelations@1000000014();
    VAR
      Rec@1000000000 : Record 70021;
      Show@1000000001 : Boolean;
    BEGIN
      //Calculate Projects
      Show := TRUE;

      Rec.RESET;
      Rec.SETRANGE(Type,Rec.Type::Relation);

      IF SourceRec.GETFILTER("Contact No. Filter") <> '' THEN
        Rec.SETFILTER(Key2,SourceRec.GETFILTER("Contact No. Filter"));

      IF SourceRec.GETFILTER("Business Relation Filter") <> '' THEN
        Rec.SETFILTER("Business Relation Code",SourceRec.GETFILTER("Business Relation Filter"));

      IF Rec.FINDFIRST THEN BEGIN
        Open;
        REPEAT
          Update(Rec.Key2);
          Show := TRUE;
          Rec.CALCFIELDS("Contact Name","Contact Phone No.","Contact E-Mail");
          IF Show THEN Show := CheckMD(Rec.Key1);

          IF Show THEN BEGIN
            i += 1;
            TempRelBuffer.INIT;
            TempRelBuffer."Entry No." := i;
            TempRelBuffer.AssetNo1 := Rec.Key1;
            TempRelBuffer.ContactNo1 := Rec.Key2;
            TempRelBuffer.BusRelCode1 := Rec."Business Relation Code";
            TempRelBuffer.Name1 := Rec."Contact Name";
            TempRelBuffer.Name2 := Rec."Contact Phone No.";
            TempRelBuffer.Name3 := Rec."Contact E-Mail";
            TempRelBuffer.INSERT;
          END;
        UNTIL Rec.NEXT = 0;
        Close;
      END;
    END;

    LOCAL PROCEDURE ExportRelations@1000000013();
    VAR
      Column001@1000000003 : TextConst 'ENU=Asset No.;DEA=Anlagennr.';
      Column002@1000000004 : TextConst 'ENU=Contact No.;DEA=Kontaktnr.';
      Column003@1000000005 : TextConst 'ENU=Bus. Relation;DEA=Gesch„ftsbeziehung';
      SheetName@1000000001 : TextConst 'DEA=Relations';
      Rec@1000000002 : Record 70021;
    BEGIN
      //Export To Excel
      i := 0;
      TempRelBuffer.RESET;
      IF TempRelBuffer.FINDFIRST THEN BEGIN
        OptionSelected += 1;
        //Header
        j := 0;
        i += 1;

        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column001),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column002),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column003),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Contact Name"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Contact Phone No."),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Contact E-Mail"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}

        REPEAT
          j := 0;
          i += 1;
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempRelBuffer.AssetNo1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempRelBuffer.ContactNo1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempRelBuffer.BusRelCode1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempRelBuffer.Name1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempRelBuffer.Name2,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempRelBuffer.Name3,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}

        UNTIL TempRelBuffer.NEXT = 0;

        //Create Excel
        IF OptionSelected = 1 THEN
          IGExcelExport.CreateBook(FORMAT(SheetName),FORMAT(SheetHeader))
        ELSE
          IGExcelExport.Create2ndWorksheet(FORMAT(SheetName),FORMAT(SheetHeader));
      END;
    END;

    LOCAL PROCEDURE CalcUser@1000000004();
    VAR
      Rec@1000000000 : Record 70021;
      Show@1000000001 : Boolean;
    BEGIN
      //Calculate User
      Show := TRUE;

      Rec.RESET;
      Rec.SETRANGE(Type,Rec.Type::User);

      IF SourceRec.GETFILTER("User ID (Role) Filter") <> '' THEN
        Rec.SETFILTER(Key2,SourceRec."User ID (Role) Filter");

      {
      IF SourceRec.GETFILTER("User Type (Role) Filter") <> '' THEN
        Rec.SETFILTER("Customer Company Chain",SourceRec."User Type (Role) Filter");
      }

      IF Rec.FINDFIRST THEN BEGIN
        Open;
        REPEAT
          Update(Rec.Key2);
          Show := TRUE;

          IF Show THEN Show := CheckMD(Rec.Key1);

          IF Show THEN BEGIN
            i += 1;
            TempUserBuffer.INIT;
            TempUserBuffer."Entry No." := i;
            TempUserBuffer.AssetNo1 := Rec.Key1;
            TempUserBuffer.UserID1 := Rec.Key2;
            IF Rec."Reporting Responsible" THEN TempUserBuffer.TypeText1 := 'X';
            IF Rec."Invoice Responsible" THEN TempUserBuffer.TypeText2 := 'X';
            IF Rec."Accounting Responsible" THEN TempUserBuffer.TypeText3 := 'X';
            IF Rec."Plant Manager" THEN TempUserBuffer.TypeText4 := 'X';
            IF Rec."Field Service" THEN TempUserBuffer.TypeText5 := 'X';
            IF Rec.Customer THEN TempUserBuffer.TypeText6 := 'X';
            IF Rec."Remote Monitoring Responsible" THEN TempUserBuffer.TypeText7 := 'X';
            IF Rec."Responsible OM supervisor" THEN TempUserBuffer.TypeText8 := 'X';
            TempUserBuffer.INSERT;
          END;
        UNTIL Rec.NEXT = 0;
        Close;
      END;
    END;

    LOCAL PROCEDURE ExportUser@1000000003();
    VAR
      Column001@1000000003 : TextConst 'ENU=Asset No.;DEA=Anlagennr.';
      Column002@1000000004 : TextConst 'ENU=User ID;DEA=Benutzer-ID';
      SheetName@1000000001 : TextConst 'DEA=Roles';
      Rec@1000000002 : Record 70021;
    BEGIN
      //Export To Excel
      i := 0;
      TempUserBuffer.RESET;
      IF TempUserBuffer.FINDFIRST THEN BEGIN
        OptionSelected += 1;
        //Header
        j := 0;
        i += 1;

        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column001),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column002),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Reporting Responsible"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Invoice Responsible"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Accounting Responsible"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Plant Manager"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Field Service"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Customer),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Remote Monitoring Responsible"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Responsible OM supervisor"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}

        REPEAT
          j := 0;
          i += 1;
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempUserBuffer.AssetNo1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempUserBuffer.UserID1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempUserBuffer.TypeText1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempUserBuffer.TypeText2,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempUserBuffer.TypeText3,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempUserBuffer.TypeText4,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempUserBuffer.TypeText5,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempUserBuffer.TypeText6,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempUserBuffer.TypeText7,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempUserBuffer.TypeText8,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}

        UNTIL TempUserBuffer.NEXT = 0;

        //Create Excel
        IF OptionSelected = 1 THEN
          IGExcelExport.CreateBook(FORMAT(SheetName),FORMAT(SheetHeader))
        ELSE
          IGExcelExport.Create2ndWorksheet(FORMAT(SheetName),FORMAT(SheetHeader));
      END;
    END;

    LOCAL PROCEDURE CalcEQPT@1000000008();
    VAR
      Rec@1000000000 : Record 70025;
      Show@1000000001 : Boolean;
    BEGIN
      //Calculate Projects
      Show := TRUE;

      Rec.RESET;
      //"Objecttype","Type","Component Type","Key1","Entry No."
      Rec.SETRANGE(Objecttype,Rec.Objecttype::Asset);
      Rec.SETRANGE(Type,Rec.Type::Equipment);
      Rec.SETRANGE("Line Type",Rec."Line Type"::Line);

      IF Rec.FINDFIRST THEN BEGIN
        Open;
        REPEAT
          Update(STRSUBSTNO('%1',Rec.Type));
          Show := TRUE;

          IF Show THEN Show := CheckMD(Rec.Key1);

          IF Show THEN BEGIN
            i += 1;
            TempEQPTBuffer.INIT;
            TempEQPTBuffer."Entry No." := i;
            TempEQPTBuffer.AssetNo1 := Rec.Key1;
            TempEQPTBuffer.LineNo1 := Rec."Entry No.";
            TempEQPTBuffer.TypeInt1 := Rec."Component Type";
            TempEQPTBuffer.TypeText1 := FORMAT(Rec."Component Type");
            TempEQPTBuffer.INSERT;
          END;
        UNTIL Rec.NEXT = 0;
        Close;
      END;
    END;

    LOCAL PROCEDURE ExportEQPT@1000000007();
    VAR
      Column001@1000000003 : TextConst 'ENU=Asset No.;DEA=Anlagennr.';
      SheetName@1000000001 : TextConst 'DEA=Equipment';
      Rec@1000000002 : Record 70025;
    BEGIN
      //Export To Excel
      i := 0;
      TempEQPTBuffer.RESET;
      IF TempEQPTBuffer.FINDFIRST THEN BEGIN
        OptionSelected += 1;
        //Header
        j := 0;
        i += 1;

        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),FORMAT(Column001),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Component Type"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION(Description),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}
        IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.FIELDCAPTION("Description 2"),TRUE,FALSE,FALSE,FALSE,'',1); {Number,Text,Date,Time}

        REPEAT
          j := 0;
          i += 1;
          //"Objecttype","Type","Component Type","Key1","Entry No."
          IF NOT Rec.GET(
                  Rec.Objecttype::Asset,Rec.Type::Equipment,TempEQPTBuffer.TypeInt1,TempEQPTBuffer.AssetNo1,TempEQPTBuffer.LineNo1) THEN
                  Rec.INIT;
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempEQPTBuffer.AssetNo1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),TempEQPTBuffer.TypeText1,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec.Description,FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}
          IGExcelExport.EnterCell(i,IGExcelExport.IncInt(j),Rec."Description 2",FALSE,FALSE,FALSE,FALSE,'',1);  {Number,Text,Date,Time}


        UNTIL TempEQPTBuffer.NEXT = 0;

        //Create Excel
        IF OptionSelected = 1 THEN
          IGExcelExport.CreateBook(FORMAT(SheetName),FORMAT(SheetHeader))
        ELSE
          IGExcelExport.Create2ndWorksheet(FORMAT(SheetName),FORMAT(SheetHeader));
      END;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 70006 CMMS Forecast
{
  OBJECT-PROPERTIES
  {
    Date=15.05.18;
    Time=17:02:34;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnInitReport=BEGIN
                   DaysPerMonth := 30;
                   Row := 1;
                 END;

    OnPreReport=VAR
                  c@1000000000 : Integer;
                BEGIN
                  IF (StartDate = 0D) OR (EndDate = 0D) OR (StartDate > EndDate) THEN
                    ERROR(Text001);

                  StartMonth := DATE2DMY(StartDate, 2);
                  StartYear := DATE2DMY(StartDate, 3);
                  EndMonth := DATE2DMY(EndDate, 2);
                  EndYear := DATE2DMY(EndDate, 3);

                  NoOfMonths := 0;
                  NoOfMonths += (EndYear - StartYear) * 12;
                  NoOfMonths += (EndMonth - StartMonth) + 1;

                  ExcelExport.EnterCellMinBold(Row, 1, Text004);
                  Row += 1;
                  ExcelExport.EnterCellMin(Row, 1, STRSUBSTNO(Text005, USERID, CURRENTDATETIME));
                  Row += 1;
                  ExcelExport.EnterCellMin(Row, 1, STRSUBSTNO(Text006, StartDate, EndDate));
                  Row += 2;

                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Object Type');
                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Object No.');
                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Contract No.');
                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Accounting Entity');
                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Invoicing Start Date');
                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Invoicing End Date');
                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Invoicing Type');
                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Forecast Type');
                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Month');
                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Year');
                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Amount');
                  ExcelExport.EnterCellMinBold(Row, ExcelExport.IncInt(c), 'Currency Code');
                  Row += 1;
                END;

    OnPostReport=BEGIN

                   ExcelExport.CreateBook(Text004, Text004);
                   ExcelExport.CloseBook();
                 END;

  }
  DATASET
  {
    { 1000000000;;DataItem;OB                ;
               DataItemTable=Table70020;
               DataItemTableView=SORTING(Objecttype,No.);
               PrintOnlyIfDetail=Yes;
               ReqFilterFields=Objecttype,No. }

    { 1000000001;1;DataItem;OC               ;
               DataItemTable=Table70021;
               DataItemTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                                 WHERE(Type=CONST(Contract));
               OnAfterGetRecord=VAR
                                  CMContract@1000000000 : Record 70050;
                                BEGIN
                                  //Startdate
                                  IF OC."Start Date Invoicing" = 0D THEN
                                    OC."Start Date Invoicing" := OC."Contract Start Date";

                                  //Enddate
                                  EndDateInvoicingFrom := 'Entity (End Date Invoicing)';
                                  IF OC."End Date Invoicing" = 0D THEN BEGIN
                                    OC."End Date Invoicing" := OC."Contract End Date";
                                    EndDateInvoicingFrom := 'Entity (Contract End Date)';
                                  END;
                                  IF OC."End Date Invoicing" = 0D THEN BEGIN
                                    IF NOT CMContract.GET(OC.Key2) THEN CMContract.INIT;
                                    OC."End Date Invoicing" := CMContract."End Date";
                                    EndDateInvoicingFrom := 'Contract End Date';
                                  END;


                                  IF OC."Start Date Invoicing" = 0D THEN
                                    CurrReport.SKIP;

                                  //Contract Year, Month
                                  ContractStartMonth := DATE2DMY(OC."Start Date Invoicing", 2);
                                  ContractStartYear := DATE2DMY(OC."Start Date Invoicing", 3);
                                  ContractEndMonth := 999999;
                                  ContractEndYear := 999999;
                                  IF OC."End Date Invoicing" <> 0D THEN BEGIN
                                    ContractEndMonth := DATE2DMY(OC."End Date Invoicing", 2);
                                    ContractEndYear := DATE2DMY(OC."End Date Invoicing", 3);
                                  END;

                                  //Contract Day
                                  ContractStartDay := DATE2DMY(OC."Start Date Invoicing", 1);
                                  IF OC."End Date Invoicing" <> 0D THEN
                                    ContractEndDay := DATE2DMY(OC."End Date Invoicing", 1);
                                  IF ContractStartDay > 30 THEN ContractStartDay := 30;
                                  IF (ContractEndDay > 30) OR (ContractEndDay = 0) THEN ContractEndDay := 30;

                                  CASE OC."Invoicing Period" OF
                                    OC."Invoicing Period"::Month        : InvPeriodInMonths := 1;
                                    OC."Invoicing Period"::Quarter      : InvPeriodInMonths := 3;
                                    OC."Invoicing Period"::"Half Year"  : InvPeriodInMonths := 6;
                                    OC."Invoicing Period"::Year         : InvPeriodInMonths := 12;
                                  END;

                                  InvPeriodCounter := 0;
                                  TotalAmt := 0;
                                END;

               DataItemLink=Objecttype=FIELD(Objecttype),
                            Key1=FIELD(No.) }

    { 1000000002;2;DataItem;Period           ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number);
               OnPreDataItem=BEGIN
                               Period.SETRANGE(Number, 1, NoOfMonths);
                             END;

               OnAfterGetRecord=VAR
                                  LocDate@1000000001 : Date;
                                BEGIN
                                  LocDate := DMY2DATE(1, StartMonth, StartYear);
                                  LocDate := CALCDATE(STRSUBSTNO('<+%1M>', Period.Number - 1), LocDate);
                                  Month := DATE2DMY(LocDate, 2);
                                  Year := DATE2DMY(LocDate, 3);

                                  IF ShowDistribution THEN
                                    CalculateDistribution();
                                  IF ShowInvoicing THEN
                                    CalculateInvoicing();
                                END;
                                 }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
    }
    CONTROLS
    {
      { 1000000000;;Container;
                  ContainerType=ContentArea }

      { 1000000001;1;Group  ;
                  Name=Options;
                  CaptionML=[ENU=Options;
                             DEA=Optionen];
                  GroupType=Group }

      { 1000000002;2;Field  ;
                  Name=StartDate;
                  CaptionML=[ENU=Start Date;
                             DEA=Startdatum];
                  SourceExpr=StartDate;
                  OnValidate=BEGIN
                               StartDate := CALCDATE('<-CM>', StartDate);
                             END;
                              }

      { 1000000003;2;Field  ;
                  Name=EndDate;
                  CaptionML=[ENU=End Date;
                             DEA=Enddatum];
                  SourceExpr=EndDate;
                  OnValidate=BEGIN
                               EndDate := CALCDATE('<+CM>', EndDate);
                             END;
                              }

      { 1000000004;2;Field  ;
                  Name=ShowInvoicing;
                  CaptionML=[ENU=Verrechnung;
                             DEA=Invoicing];
                  SourceExpr=ShowInvoicing }

      { 1000000005;2;Field  ;
                  Name=ShowDistribution;
                  CaptionML=[ENU=Distribution;
                             DEA=Verteilung];
                  SourceExpr=ShowDistribution }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      StartDate@1000000000 : Date;
      EndDate@1000000001 : Date;
      StartMonth@1000000009 : Integer;
      StartYear@1000000008 : Integer;
      EndMonth@1000000007 : Integer;
      EndYear@1000000006 : Integer;
      ContractStartMonth@1000000020 : Integer;
      ContractStartYear@1000000019 : Integer;
      ContractEndMonth@1000000018 : Integer;
      ContractEndYear@1000000017 : Integer;
      ContractStartDay@1000000024 : Integer;
      ContractEndDay@1000000023 : Integer;
      NoOfMonths@1000000010 : Integer;
      Year@1000000011 : Integer;
      Month@1000000012 : Integer;
      TotalAmt@1000000025 : Decimal;
      InvPeriodCounter@1000000026 : Integer;
      InvPeriodInMonths@1000000022 : Integer;
      EndDateInvoicingFrom@1000000030 : Text;
      ShowInvoicing@1000000002 : Boolean;
      ShowDistribution@1000000003 : Boolean;
      Text001@1000000004 : TextConst 'ENU=Please provide valid Startdate and Enddate.;DEA=Bitte geben sie ein gltiges Start- und Enddatum an.';
      DaysPerMonth@1000000005 : Integer;
      ExcelExport@1000000013 : Codeunit 50002;
      Row@1000000014 : Integer;
      Text002@1000000015 : TextConst 'ENU=Distribution;DEA=Verteilung';
      Xlb@1000000016 : Record 370;
      Text003@1000000021 : TextConst 'ENU=Invoicing;DEA=Verrechnung';
      Text004@1000000027 : TextConst 'ENU=CMMS Forecast;DEA=CMMS Forecast';
      Text005@1000000028 : TextConst 'ENU=User: %1, Datetime: %2;DEA=Benutzer: %1, Datum/Zeit: %2';
      Text006@1000000029 : TextConst 'ENU=Period: %1 - %2;DEA=Periode: %1 - %2';

    LOCAL PROCEDURE CalculateDistribution@1000000001();
    VAR
      Ok@1000000000 : Boolean;
      Amt@1000000001 : Decimal;
      c@1000000002 : Integer;
    BEGIN
      IF NOT ContractInCurrentPeriod() THEN
        EXIT;

      Amt := CalculateAmt();

      ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(OB.Objecttype));
      ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), OB."No.");
      ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), OC.Key2);
      ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), OC."Accounting Entity");
      ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(OC."Start Date Invoicing"));
      ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(OC."End Date Invoicing"));
      ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(OC."Invoicing Type"));
      ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), Text002);
      ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(Month));
      ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(Year));
      ExcelExport.EnterCell(Row, ExcelExport.IncInt(c), FORMAT(Amt), FALSE, FALSE, FALSE, FALSE, '#,##0.00', Xlb."Cell Type"::Number);
      ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), OC."Currency Code");
      Row += 1;
    END;

    LOCAL PROCEDURE CalculateInvoicing@1000000026();
    VAR
      Amt@1000000000 : Decimal;
      c@1000000001 : Integer;
    BEGIN
      IF NOT ContractInCurrentPeriod() THEN
        EXIT;

      Amt := CalculateAmt();
      TotalAmt += Amt;

      InvPeriodCounter += 1;
      IF InvPeriodCounter = InvPeriodInMonths THEN BEGIN
        ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(OB.Objecttype));
        ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), OB."No.");
        ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), OC.Key2);
        ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), OC."Accounting Entity");
        ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(OC."Start Date Invoicing"));
        ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(OC."End Date Invoicing"));
        ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(OC."Invoicing Type"));
        ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), Text003);
        ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(Month));
        ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), FORMAT(Year));
        ExcelExport.EnterCell(Row, ExcelExport.IncInt(c), FORMAT(TotalAmt), FALSE, FALSE, FALSE, FALSE, '#,##0.00', Xlb."Cell Type"::Number);
        ExcelExport.EnterCellMin(Row, ExcelExport.IncInt(c), OC."Currency Code");
        Row += 1;

        TotalAmt := 0;
        InvPeriodCounter := 0;
      END
    END;

    LOCAL PROCEDURE ContractInCurrentPeriod@1000000013() : Boolean;
    VAR
      Ok@1000000000 : Boolean;
    BEGIN
      IF (ContractStartYear < Year) AND (ContractEndYear > Year) THEN Ok := TRUE;
      IF (ContractStartYear < Year) AND (ContractEndYear = Year) AND (ContractEndMonth >= Month) THEN Ok := TRUE;
      IF (ContractStartYear = Year) AND (ContractEndYear > Year) AND (ContractStartMonth <= Month) THEN Ok := TRUE;
      IF (ContractStartYear = Year) AND (ContractEndYear = Year) AND (ContractStartMonth <= Month)  AND (ContractEndMonth >= Month) THEN Ok := TRUE;

      EXIT(Ok);
    END;

    LOCAL PROCEDURE CalculateAmt@1000000027() Amt : Decimal;
    BEGIN
      Amt := OC."Monthly Amount";
      IF (ContractStartYear = Year) AND (ContractStartMonth = Month) THEN
        Amt := Amt * ((DaysPerMonth - (ContractStartDay - 1)) / DaysPerMonth);
      IF (ContractEndYear = Year) AND (ContractEndMonth = Month) THEN
        Amt := Amt * (ContractEndDay / DaysPerMonth);
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Report 70007 CMMS Workoder Excel Export
{
  OBJECT-PROPERTIES
  {
    Date=17.11.17;
    Time=11:36:15;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    ProcessingOnly=Yes;
    OnPreReport=BEGIN
                  // ### Config
                  MaxTasks := 46; //Maximum Number of Tasks to be Exported
                  MaxComments := 15;

                  TemplateSheetName := 'Input';
                  TemplateSheetNo := 5;
                END;

  }
  DATASET
  {
    { 1000000000;;DataItem;Workorder         ;
               DataItemTable=Table5092;
               DataItemTableView=SORTING(CM Is Workorder)
                                 WHERE(CM Is Workorder=CONST(Yes));
               OnPreDataItem=BEGIN
                               IF Workorder.COUNT <> 1 THEN
                                 ERROR(Text001);
                             END;

               OnAfterGetRecord=VAR
                                  AssignedUserSetup@1000000000 : Record 91;
                                  Subcontractor@1000000001 : Record 5050;
                                  CMObject@1000000002 : Record 70020;
                                  CMContract@1000000003 : Record 70050;
                                  CMAddData@1000000004 : Record 70021;
                                  CMAssetMgt@1000000005 : Codeunit 70020;
                                BEGIN
                                  //### Fill in Workoder Data:
                                  IF NOT AssignedUserSetup.GET(Workorder."CM Assigned User ID") THEN
                                    AssignedUserSetup.INIT;
                                  AssignedUserSetup.CALCFIELDS("CM Name");

                                  IF NOT Subcontractor.GET(Workorder."CM Subcontractor No.") THEN
                                    Subcontractor.INIT;

                                  IF NOT CMObject.GET(Workorder."CM Objecttype", Workorder."CM Object No.") THEN
                                    CMObject.INIT;

                                  CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::Asset);
                                  CMAddData.SETRANGE(Type, CMAddData.Type::Contract);
                                  CMAddData.SETRANGE(Key1, CMObject."No.");
                                  CMAddData.SETRANGE("Main Contract", TRUE);
                                  IF CMAddData.FINDFIRST() THEN BEGIN
                                    IF NOT CMContract.GET(CMAddData.Key2) THEN
                                      CMContract.INIT;
                                  END;

                                  // ### Workorder
                                  IGExcelExp.EnterCellMinChar(2, 'B', Workorder."No.");
                                  IF Workorder."CM Objecttype" = Workorder."CM Objecttype"::Project THEN BEGIN
                                    IGExcelExp.EnterCellMinChar(3, 'B', Workorder."CM Object No.");
                                    IGExcelExp.EnterCellMinChar(4, 'B', '');
                                  END
                                  ELSE BEGIN
                                    IGExcelExp.EnterCellMinChar(3, 'B', '');
                                    IGExcelExp.EnterCellMinChar(4, 'B', Workorder."CM Object No.");
                                  END;
                                  IGExcelExp.EnterCellMinChar(5, 'B', FORMAT(CMObject."Coordinates Latitude") + ' | ' + FORMAT(CMObject."Coordinates Longitude"));
                                  IGExcelExp.EnterCellMinChar(6, 'B', Workorder."CM Object Name");
                                  IGExcelExp.EnterCellMinChar(7, 'B', Workorder."CM Object Name 2");
                                  IGExcelExp.EnterCellMinChar(8, 'B', COPYSTR(CMObject.Address + ' ' + CMObject."Extended Address", 1, 250));
                                  IGExcelExp.EnterCellMinChar(9, 'B', CMObject."Post Code" + ' ' + CMObject.City);
                                  IGExcelExp.EnterCellMinChar(10, 'B', CMObject."Country Code");
                                  IGExcelExp.EnterCellMinChar(11, 'B', Workorder."CM Subcontractor No.");
                                  IGExcelExp.EnterCellMinChar(13, 'B', Workorder.Description);

                                  // ### Workorder - Assigned User
                                  IGExcelExp.EnterCellMinChar(2, 'D', AssignedUserSetup."CM Name");
                                  IGExcelExp.EnterCellMinChar(3, 'D', AssignedUserSetup."IG Phone No.");
                                  IGExcelExp.EnterCellMinChar(4, 'D', AssignedUserSetup."E-Mail");

                                  IGExcelExp.EnterCellMinChar(2, 'F', Subcontractor.Name);
                                  IGExcelExp.EnterCellMinChar(3, 'F', Subcontractor."Phone No.");
                                  IGExcelExp.EnterCellMinChar(4, 'F', Subcontractor."E-Mail");
                                END;

               OnPostDataItem=BEGIN
                                IGExcelExp.UseTemplate(1, TemplateSheetNo);
                                IGExcelExp.IGSetBackgroundColor('99CCDD');
                                IGExcelExp.CreateBook(TemplateSheetName, STRSUBSTNO(Text002, Workorder."No."));
                                IGExcelExp.CloseBook();
                              END;

               ReqFilterFields=No. }

    { 1000000001;1;DataItem;Task             ;
               DataItemTable=Table5080;
               DataItemTableView=SORTING(Opportunity No.,CM Type,CM Assigned User ID,CM Status)
                                 WHERE(CM Type=CONST(Task));
               OnPreDataItem=BEGIN
                               Counter := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF (Counter + 1) >= MaxTasks THEN
                                    CurrReport.BREAK();

                                  // ### Tasks
                                  IGExcelExp.EnterCellMinChar(2 + (Counter * 4), 'N', Task."No.");
                                  IGExcelExp.EnterCellMinChar(2 + (Counter * 4) + 1, 'N', Task."CM Assigned User ID");
                                  IGExcelExp.EnterCellMinChar(2 + (Counter * 4) + 2, 'N', Task.Description);
                                  IGExcelExp.EnterCellMinChar(2 + (Counter * 4) + 3, 'N', FORMAT(Task."CM Status"));

                                  Counter += 1;
                                END;

               ReqFilterFields=No.;
               DataItemLink=Opportunity No.=FIELD(No.) }

    { 1000000002;1;DataItem;_Comment         ;
               DataItemTable=Table5065;
               DataItemTableView=SORTING(CM Is CMMS Log Entry,CM Source,CM Source No.)
                                 WHERE(CM Is CMMS Log Entry=CONST(Yes),
                                       CM Log Type=CONST(Comment),
                                       CM Source=CONST(Workorder));
               OnPreDataItem=BEGIN
                               _Comment.SETRANGE("CM Internal", FALSE);

                               IF ShowInternalComments THEN
                                 _Comment.SETRANGE("CM Internal");

                               Counter := 0;
                             END;

               OnAfterGetRecord=BEGIN
                                  IF (Counter + 1) >= MaxComments THEN
                                    CurrReport.BREAK();

                                  // ### Workorder Comments
                                  IGExcelExp.EnterCellMinChar(2 + (Counter * 4), 'P', _Comment."User ID");
                                  IGExcelExp.EnterCellMinChar(2 + (Counter * 4) + 1, 'P', FORMAT(_Comment.Date));
                                  IGExcelExp.EnterCellMinChar(2 + (Counter * 4) + 2, 'P', _Comment."CM Comment");
                                  IGExcelExp.EnterCellMinChar(2 + (Counter * 4) + 3, 'P', FORMAT(_Comment."CM Production Effect"));

                                  Counter += 1;
                                END;

               DataItemLink=CM Source No.=FIELD(No.) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
      { 1000000000;;Container;
                  ContainerType=ContentArea }

      { 1000000001;1;Group  ;
                  Name=Options;
                  GroupType=Group }

      { 1000000002;2;Field  ;
                  Name=ShowInternalComments;
                  CaptionML=[ENU=Internal Comments;
                             DEA=Interne Kommentare];
                  SourceExpr=ShowInternalComments }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=You can export only one Workorder at a Time!;DEA=Sie k”nnen nur eine Workoder auf einmal exportieren!';
      IGExcelExp@1000000001 : Codeunit 70028;
      Text002@1000000002 : TextConst 'ENU=Workorder %1;DEA=Arbeitsauftrag %1';
      ShowInternalComments@1000000008 : Boolean;
      Counter@1000000003 : Integer;
      MaxTasks@1000000004 : Integer;
      MaxComments@1000000005 : Integer;
      TemplateSheetNo@1000000006 : Integer;
      TemplateSheetName@1000000007 : Text;

    BEGIN
    END.
  }
  RDLDATA
  {
  }
}

OBJECT Codeunit 9801 Identity Management
{
  OBJECT-PROPERTIES
  {
    Date=25.08.16;
    Time=15:03:46;
    Modified=Yes;
    Version List=NAVW19.00,ENC,CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      UserAccountHelper@1003 : DotNet "'Microsoft.Dynamics.Nav.NavUserAccount, Version=9.0.*.*, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.NavUserAccount.NavUserAccountHelper";

    PROCEDURE SetAuthenticationKey@1(UserSecurityID@1000 : GUID;Key@1001 : Text[80]);
    BEGIN
      IF NOT UserAccountHelper.TrySetAuthenticationKey(UserSecurityID,Key) THEN
        ERROR(GETLASTERRORTEXT);
    END;

    PROCEDURE GetAuthenticationKey@14(UserSecurityID@1000 : GUID) Key : Text[80];
    BEGIN
      IF NOT UserAccountHelper.TryGetAuthenticationKey(UserSecurityID,Key) THEN
        Key := FORMAT(GETLASTERRORTEXT,80);
    END;

    PROCEDURE GetNameIdentifier@2(UserSecurityID@1000 : GUID) NameID : Text[250];
    BEGIN
      IF NOT UserAccountHelper.TryGetNameIdentifier(UserSecurityID,NameID) THEN
        NameID := FORMAT(GETLASTERRORTEXT,250);
    END;

    PROCEDURE CreateWebServicesKey@8(UserSecurityID@1000 : GUID;ExpiryDate@1001 : DateTime) Key : Text[80];
    BEGIN
      IF NOT UserAccountHelper.TryCreateWebServicesKey(UserSecurityID,ExpiryDate,Key) THEN
        ERROR(GETLASTERRORTEXT);
    END;

    PROCEDURE CreateWebServicesKeyNoExpiry@13(UserSecurityID@1000 : GUID) Key : Text[80];
    VAR
      ExpiryDate@1001 : DateTime;
    BEGIN
      IF NOT UserAccountHelper.TryCreateWebServicesKey(UserSecurityID,ExpiryDate,Key) THEN
        ERROR(GETLASTERRORTEXT);
    END;

    PROCEDURE GetWebServicesKey@4(UserSecurityID@1000 : GUID) Key : Text[80];
    VAR
      ExpiryDate@1001 : DateTime;
    BEGIN
      IF NOT UserAccountHelper.TryGetWebServicesKey(UserSecurityID,Key,ExpiryDate) THEN
        Key := FORMAT(GETLASTERRORTEXT,80);
    END;

    PROCEDURE IsAzure@5() Ok : Boolean;
    BEGIN
      Ok := UserAccountHelper.IsAzure;
    END;

    LOCAL PROCEDURE CreateAuthenticationKey@3(UserSecurityID@1000 : GUID) Key : Text[80];
    BEGIN
      // Generates a crypt random code, with high enough entropy
      IF NOT UserAccountHelper.TrySetAuthenticationKey(UserSecurityID,Key) THEN
        ERROR(GETLASTERRORTEXT);
    END;

    PROCEDURE GetWebServiceExpiryDate@6(UserSecurityID@1000 : GUID) ExpiryDate : DateTime;
    VAR
      Key@1001 : Text[80];
    BEGIN
      IF NOT UserAccountHelper.TryGetWebServicesKey(UserSecurityID,Key,ExpiryDate) THEN
        ERROR(GETLASTERRORTEXT);
    END;

    PROCEDURE GetACSStatus@7(UserSecurityID@1001 : GUID) ACSStatus : Integer;
    VAR
      ACSStatusOption@1000 : 'Disabled,Pending,Registered,Unknown';
      Key@1002 : Text[80];
      NameID@1003 : Text[250];
    BEGIN
      // Determines the status as follows:
      // If neither Nameidentifier, nor authentication key then Disabled
      // If authentiation key then Pending
      // If NameIdentifier then Registered
      // If no permission: Unknown

      IF NOT UserAccountHelper.TryGetAuthenticationKey(UserSecurityID,Key) THEN BEGIN
        ACSStatusOption := ACSStatusOption::Unknown;
        ACSStatus := ACSStatusOption;
        EXIT;
      END;

      IF NOT UserAccountHelper.TryGetNameIdentifier(UserSecurityID,NameID) THEN BEGIN
        ACSStatusOption := ACSStatusOption::Unknown;
        ACSStatus := ACSStatusOption;
        EXIT;
      END;

      IF NameID = '' THEN BEGIN
        IF Key = '' THEN
          ACSStatusOption := ACSStatusOption::Disabled
        ELSE
          ACSStatusOption := ACSStatusOption::Pending;
      END ELSE
        ACSStatusOption := ACSStatusOption::Registered;

      ACSStatus := ACSStatusOption;
    END;

    LOCAL PROCEDURE ValidateKeyStrength@9(Key@1001 : Text[250]) : Boolean;
    VAR
      i@1000 : Integer;
      KeyLen@1002 : Integer;
      HasUpper@1003 : Boolean;
      HasLower@1004 : Boolean;
      HasNumeric@1005 : Boolean;
    BEGIN
      EXIT(TRUE); //ENC
      {KeyLen := STRLEN(Key);

      IF KeyLen < 8 THEN
        EXIT(FALSE);

      FOR i := 1 TO STRLEN(Key) DO BEGIN
        CASE Key[i] OF
          'A'..'Z':
            HasUpper := TRUE;
          'a'..'z':
            HasLower := TRUE;
          '0'..'9':
            HasNumeric := TRUE;
        END;

        IF HasUpper AND HasLower AND HasNumeric THEN
          EXIT(TRUE);
      END;

      EXIT(FALSE);}
    END;

    PROCEDURE ValidatePasswordStrength@10(Password@1000 : Text[250]) IsValid : Boolean;
    BEGIN
      IsValid := ValidateKeyStrength(Password);
    END;

    PROCEDURE ValidateAuthKeyStrength@11(AuthKey@1000 : Text[250]) IsValid : Boolean;
    BEGIN
      IsValid := ValidateKeyStrength(AuthKey);
    END;

    PROCEDURE GetMaskedNavPassword@15(UserSecurityID@1000 : GUID) MaskedPassword : Text[80];
    BEGIN
      IF UserAccountHelper.IsPasswordSet(UserSecurityID) THEN
        MaskedPassword := '********'
      ELSE
        MaskedPassword := '';
    END;

    PROCEDURE IsWindowsAuthentication@16() Ok : Boolean;
    BEGIN
      Ok := UserAccountHelper.IsWindowsAuthentication();
    END;

    PROCEDURE IsUserNamePasswordAuthentication@17() Ok : Boolean;
    BEGIN
      Ok := UserAccountHelper.IsUserNamePasswordAuthentication();
    END;

    PROCEDURE IsAccessControlServiceAuthentication@18() Ok : Boolean;
    BEGIN
      Ok := UserAccountHelper.IsAccessControlServiceAuthentication();
    END;

    PROCEDURE UserName@19(Sid@1000 : Text) : Text[208];
    BEGIN
      IF Sid = '' THEN
        EXIT('');

      EXIT(UserAccountHelper.UserName(Sid));
    END;

    LOCAL PROCEDURE GetAuthenticationEmail@20(UserSecurityID@1000 : GUID) authenticationEmail : Text[250];
    BEGIN
      IF NOT UserAccountHelper.TryGetAuthenticationEmail(UserSecurityID,authenticationEmail) THEN
        authenticationEmail := FORMAT(GETLASTERRORTEXT,250);
    END;

    PROCEDURE SetAuthenticationEmail@12(UserSecurityId@1000 : GUID;AuthenticationEmail@1001 : Text[250]);
    BEGIN
      CLEARLASTERROR;
      IF NOT UserAccountHelper.TrySetAuthenticationEmail(UserSecurityId,AuthenticationEmail) THEN
        ERROR(GETLASTERRORTEXT);
    END;

    PROCEDURE GetAuthenticationStatus@21(UserSecurityId@1001 : GUID) O365AuthStatus : Integer;
    BEGIN
      O365AuthStatus := UserAccountHelper.GetAuthenticationStatus(UserSecurityId);
    END;

    BEGIN
    {
      ENC
        Edited Function ValidateKeyStrength();
    }
    END.
  }
}

OBJECT Codeunit 70000 CMMS General Management
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=11:11:42;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=%1 not configured!;DEA=%1 fehlt nicht eingerichtet!';
      CMGSetup@1000000002 : Record 70000;
      CMTTMgt@1000000018 : Codeunit 70040;
      NosMgt@1000000001 : Codeunit 396;
      Text002@1000000003 : TextConst 'ENU=Invalid Call for Log Entry!;DEA=Ungltiger Aufruf fr Logeintrag!';
      Text003@1000000004 : TextConst 'ENU=This is no CMMS Record!;DEA=Dies ist kein CMMS Record!';
      LogEntry@1000000005 : Record 5065;
      Text004@1000000006 : TextConst 'ENU=Contract "%1" is not template!;DEA=Vertrag "%1" ist keine Vorlage!';
      Text005@1000000007 : TextConst 'ENU=This Contract is linked to an Asset an can therefore no be set as Template!;DEA=Dieser Vertrag ist einer Anlage zugewiesen und kann nicht als Vorlage definiert werden!';
      Text006@1000000009 : TextConst 'ENU=Asset;DEA=Anlage';
      Text007@1000000010 : TextConst 'ENU=Project;DEA=Project';
      Text008@1000000011 : TextConst 'ENU=Invalid Call!;DEA=Ungltiger Aufruf!';
      TempAttachment@1000000008 : TEMPORARY Record 5062;
      Text009@1000000012 : TextConst 'ENU=Attachment Required! Use Function SetAttachment()!;DEA=Dateianhang erforderlich! Benutzen Sie die Funktion SetAttachment()!';
      Text011@1000000014 : TextConst 'ENU=Nothing found under this Search Term!;DEA=Unter dem Suchbegriff wurde nichts gefunden!';
      Text012@1000000015 : TextConst 'ENU=Main Asset;DEA=Hauptanlage';
      IsEditable@1000000016 : Boolean;
      Text013@1000000017 : TextConst 'ENU=From "%1" to "%2"';
      Text014@1000000019 : TextConst 'ENU=Do you really want to delete this entry?;DEA=Wollen Sie diesen Eintrag wirklich l”schen?';
      Text015@1000000020 : TextConst 'ENU=Canceled!;DEA=Abgebrochen!';
      Text016@1000000021 : TextConst 'ENU=Do you really want to delete this comment? A copy of this comment will be created, which you are to edit.;DEA=Wollen Sie diesen Kommentar wirklich l”schen? Es wird eine Kopie davon erstellt, die Sie anschlieáend bearbeiten k”nnen.';
      FileMgt@1000000013 : Codeunit 419;
      Text017@1000000022 : TextConst 'ENU=Save File;DEA=Datei speichern';
      DisableKeyOptimization@1000000023 : Boolean;
      Text018@1000000024 : TextConst 'ENU=Vendor No. "%1" was not found in Company "%2".;DEA=Kreditor Nr. "%1" wurde im Mandanten "%2" nicht gefunden.';
      Text019@1000000025 : TextConst 'ENU=The field "CMMS Template Vendor No." must not be emtpy.;DEA=Das Feld "CMMS Vorlage Kreditor Nr." darf nicht leer sein.';
      Text009ST@1000000027 : TextConst 'ENU=Status change form "%1" to "%2" not allowed! (Status Sequence: "%3");DEA=Status„nderung von "%1" auf "%2" nicht erlaubt! (Statusablaufcode: "%3")';
      Text010ST@1000000026 : TextConst 'ENU=Invalid Status Code "%1"!;DEA=Ungltiger Status Code "%1"!';
      Starttime@1000000028 : Time;
      DummyWorkorder@1000000030 : Record 5092;
      DummyTask@1000000029 : Record 5080;

    PROCEDURE "### Nos. Management ###"@1000000004();
    BEGIN
    END;

    PROCEDURE GetNo@1000000014(VAR Rec@1000000000 : Record 70020);
    BEGIN
      IF Rec.Objecttype = Rec.Objecttype::Asset THEN
        GetAssetNo(Rec);

      IF Rec.Objecttype = Rec.Objecttype::Project THEN
        GetProjectNo(Rec);
    END;

    LOCAL PROCEDURE GetAssetNo@1000000001(VAR Rec@1000000002 : Record 70020);
    BEGIN
      IF Rec."No." <> '' THEN
        EXIT;

      IF (NOT CMGSetup.GET()) OR (CMGSetup."Asset Nos. Code" = '') THEN
        ERROR(STRSUBSTNO(Text001,CMGSetup.FIELDCAPTION("Asset Nos. Code")));

      Rec."No." := NosMgt.GetNextNo(CMGSetup."Asset Nos. Code",0D,TRUE);
    END;

    LOCAL PROCEDURE GetProjectNo@1000000006(VAR Rec@1000000002 : Record 70020);
    BEGIN
      IF (Rec."No." <> '') OR (Rec.Objecttype <> Rec.Objecttype::Project) THEN
        EXIT;

      IF (NOT CMGSetup.GET()) OR (CMGSetup."Asset Nos. Code" = '') THEN
        ERROR(STRSUBSTNO(Text001,CMGSetup.FIELDCAPTION("Project Nos. Code")));

      Rec."No." := NosMgt.GetNextNo(CMGSetup."Project Nos. Code",0D,TRUE);
    END;

    PROCEDURE GetWorkorderNo@1000000000(VAR Rec@1000000002 : Record 5092);
    BEGIN
      IF Rec."No." <> '' THEN
        EXIT;

      IF (NOT CMGSetup.GET()) OR (CMGSetup."Workorder Nos. Code" = '') THEN
        ERROR(STRSUBSTNO(Text001,CMGSetup.FIELDCAPTION("Workorder Nos. Code")));

      Rec."No." := NosMgt.GetNextNo(CMGSetup."Workorder Nos. Code",0D,TRUE);
    END;

    PROCEDURE GetTaskNo@1000000002(VAR Rec@1000000002 : Record 5080);
    BEGIN
      IF Rec."No." <> '' THEN
        EXIT;

      IF Rec."CM Subtype" = Rec."CM Subtype"::" " THEN BEGIN
        IF (NOT CMGSetup.GET()) OR (CMGSetup."Task Nos. Code" = '') THEN
          ERROR(STRSUBSTNO(Text001,CMGSetup.FIELDCAPTION("Task Nos. Code")));

        Rec."No." := NosMgt.GetNextNo(CMGSetup."Task Nos. Code",0D,TRUE);
      END;

      //Checklist
      IF Rec."CM Subtype" = Rec."CM Subtype"::Checklist THEN BEGIN
        IF (NOT CMGSetup.GET()) OR (CMGSetup."Checklist Nos. Code" = '') THEN
          ERROR(STRSUBSTNO(Text001,CMGSetup.FIELDCAPTION("Checklist Nos. Code")));

        Rec."No." := NosMgt.GetNextNo(CMGSetup."Checklist Nos. Code",0D,TRUE);
      END;

      //Team
      IF Rec."CM Subtype" = Rec."CM Subtype"::Team THEN BEGIN
        IF (NOT CMGSetup.GET()) OR (CMGSetup."Team Nos. Code" = '') THEN
          ERROR(STRSUBSTNO(Text001,CMGSetup.FIELDCAPTION("Team Nos. Code")));

        Rec."No." := NosMgt.GetNextNo(CMGSetup."Team Nos. Code",0D,TRUE);
      END;
    END;

    PROCEDURE GetContractNo@1000000023(VAR Rec@1000000002 : Record 70050);
    BEGIN
      IF Rec."No." <> '' THEN
        EXIT;

      IF (NOT CMGSetup.GET()) OR (CMGSetup."Contract Nos. Code" = '') THEN
        ERROR(STRSUBSTNO(Text001,CMGSetup.FIELDCAPTION("Contract Nos. Code")));

      Rec."No." := NosMgt.GetNextNo(CMGSetup."Contract Nos. Code",0D,TRUE);
    END;

    PROCEDURE "### Log Management ###"@1000000012();
    BEGIN
    END;

    PROCEDURE CreateLogEntry@1000000008(SourceRecVar@1000000006 : Variant;LogType@1000000005 : Integer;Description@1000000000 : Text[50];CommentTextLong@1000000001 : Text) : Integer;
    BEGIN
      EXIT(CreateLogEntryFull(SourceRecVar,LogType,Description,CommentTextLong,TRUE));
    END;

    PROCEDURE CreateLogEntryComment@1000000009(SourceRecVar@1000000006 : Variant;Internal@1000000000 : Boolean;CommentTextLong@1000000001 : Text) : Integer;
    BEGIN
      EXIT(CreateLogEntryFull(SourceRecVar,LogEntry."CM Log Type"::Comment,'',CommentTextLong,Internal));
    END;

    PROCEDURE CreateLogEntryPhoto@1000000036(SourceRecVar@1000000006 : Variant;Description@1000000000 : Text) : Integer;
    BEGIN
      IF TempAttachment."No." = 0 THEN
        ERROR(Text009);

      EXIT(CreateLogEntryFull(SourceRecVar,LogEntry."CM Log Type"::Picture,Description,Description,FALSE));
    END;

    PROCEDURE CreateLogEntryAttachment@1000000007(SourceRecVar@1000000006 : Variant;Description@1000000000 : Text) : Integer;
    BEGIN
      IF TempAttachment."No." = 0 THEN
        ERROR(Text009);

      EXIT(CreateLogEntryFull(SourceRecVar,LogEntry."CM Log Type"::Attachment,Description,Description,FALSE));
    END;

    PROCEDURE CreateLogEntryFull@1000000003(SourceRecVar@1000000003 : Variant;LogType@1000000006 : Integer;Description@1000000004 : Text[50];LongText@1000000011 : Text;Internal@1000000014 : Boolean) : Integer;
    VAR
      LocalLogEntry@1000000001 : Record 5065;
      Source@1000000002 : Integer;
      SourceNo@1000000013 : Code[20];
      TaskSubtype@1000000018 : Integer;
      RecRef@1000000007 : RecordRef;
      Task@1000000008 : Record 5080;
      Workorder@1000000009 : Record 5092;
      Asset@1000000010 : Record 70020;
      OutStream@1000000012 : OutStream;
      TaskNo@1000000015 : Code[20];
      WorkorderNo@1000000016 : Code[20];
      ObjectNo@1000000017 : Code[20];
      ObjectType@1000000021 : Integer;
      ContactNo@1000000020 : Code[20];
      InteractionTplCode@1000000019 : Code[20];
      InteractionGroupCode@1000000000 : Code[20];
      AdditionalData@1000000005 : Record 70021;
    BEGIN
      //Validateion

      IF NOT SourceRecVar.ISRECORD THEN
        ERROR(Text002);

      RecRef.GETTABLE(SourceRecVar);

      IF NOT (RecRef.NUMBER IN [5080,5092,70020,70021,70050]) THEN
        ERROR(Text002);

      IF GetBOOLValueFR(RecRef,70000) THEN//CM Is Temporary
        EXIT;

      IF (RecRef.NUMBER = DATABASE::"To-do") OR (RecRef.NUMBER = DATABASE::Opportunity) THEN BEGIN
        IF NOT GetBOOLValueFR(RecRef,50000) THEN//Is CM Record
          ERROR(Text003);
      END;

      //Load Data
      Task.RESET;
      Workorder.RESET;
      Asset.RESET;
      //### TASK ###
      IF RecRef.NUMBER = 5080 THEN BEGIN
        TaskSubtype := GetINTValueFR(RecRef, 50090); //CM Subtype
        IF NOT (TaskSubtype IN [0,1]) THEN
          ERROR(Text002);

        IF TaskSubtype = 0 THEN BEGIN
          TaskNo := GetTXTValueFR(RecRef,1);//No.
          Source := LogEntry."CM Source"::Task;
          SourceNo := TaskNo;
        END;
        IF TaskSubtype = 1 THEN BEGIN
          TaskNo := GetTXTValueFR(RecRef,50210); //MainTask No.
          Source := LogEntry."CM Source"::Checklist;
          SourceNo := GetTXTValueFR(RecRef,1); //No
        END;

        WorkorderNo := GetTXTValueFR(RecRef,6); //Opportunity No.
        IF Workorder.GET(WorkorderNo) THEN BEGIN
          ObjectType := Workorder."CM Objecttype";
          ObjectNo := Workorder."CM Object No.";
        END;

        InteractionGroupCode := GetTXTValueFR(RecRef,51030); //CM Interaction Group Code
        InteractionTplCode := GetTXTValueFR(RecRef,37); //Interaction template Code
      END;

      //### WORKORDER ###
      IF RecRef.NUMBER = 5092 THEN BEGIN
        WorkorderNo := GetTXTValueFR(RecRef,1);
        ObjectType := GetINTValueFR(RecRef,50090);
        ObjectNo := GetTXTValueFR(RecRef,50100);
        Source := LogEntry."CM Source"::Workorder;
        SourceNo := WorkorderNo;
      END;

      //### OBJECT ###
      IF RecRef.NUMBER = 70020 THEN BEGIN
        ObjectType := GetINTValueFR(RecRef,90);
        ObjectNo := GetTXTValueFR(RecRef,100);
        ContactNo := GetTXTValueFR(RecRef,266);
        Source := LogEntry."CM Source"::"Asset/Project";
        SourceNo := ObjectNo;
      END;

      //### ADD. DATA ###
      IF RecRef.NUMBER = 70021 THEN BEGIN
        IF GetINTValueFR(RecRef,100) <> AdditionalData.Type::Contract THEN
          ERROR(Text002);

        Source := LogEntry."CM Source"::Contract;
        SourceNo := GetTXTValueFR(RecRef,120);
        ObjectType := GetINTValueFR(RecRef,90);
        ObjectNo := GetTXTValueFR(RecRef,110);
      END;

      //### CONTRACT ###
      IF RecRef.NUMBER = 70050 THEN BEGIN
        Source := LogEntry."CM Source"::Contract;
        SourceNo := GetTXTValueFR(RecRef,10);
      END;

      LocalLogEntry.RESET;
      LocalLogEntry.INIT;
      CreateStdLogEntry(LocalLogEntry,ObjectType,ObjectNo,WorkorderNo,TaskNo,ContactNo,InteractionTplCode,InteractionGroupCode);

      //Add Data
      LocalLogEntry."CM Is CMMS Log Entry" := TRUE;
      LocalLogEntry.Description := COPYSTR(Description,1,50);

      LocalLogEntry.Date := TODAY;
      LocalLogEntry."Time of Interaction" := TIME;
      LocalLogEntry."CM Created Datetime" := CURRENTDATETIME;
      LocalLogEntry."User ID" := USERID;

      LocalLogEntry."CM Source" := Source;
      LocalLogEntry."CM Source No." := SourceNo;
      LocalLogEntry."CM Objecttype" := ObjectType;
      LocalLogEntry."CM Object No." := ObjectNo;
      LocalLogEntry."Opportunity No." := WorkorderNo;
      LocalLogEntry."To-do No." := TaskNo;

      LocalLogEntry."CM Log Type" := LogType;
      LocalLogEntry."CM Internal" := Internal;

      LocalLogEntry."CM Comment" := LongText;

      LocalLogEntry.MODIFY(FALSE);
      EXIT(LocalLogEntry."Entry No.");
    END;

    LOCAL PROCEDURE CreateStdLogEntry@1000000035(VAR ResultLogEntry@1000000007 : Record 5065;ObjectType@1000000011 : Integer;ObjectNo@1000000010 : Code[20];WorkorderNo@1000000013 : Code[20];TaskNo@1000000014 : Code[20];ContactNo@1000000004 : Code[20];InteractionTplCode@1000000002 : Code[20];InteractionGroupCode@1000000001 : Code[20]);
    VAR
      Obj@1000000006 : Record 70020;
      TempSegLine@1000000003 : TEMPORARY Record 5077;
      SegMgt@1000000005 : Codeunit 5051;
      UserSetup@1000000008 : Record 91;
      CMGSetup@1000000009 : Record 70000;
      TempIntLogCommentLine@1000000000 : TEMPORARY Record 5123;
      SalespersonCode@1000000012 : Code[20];
    BEGIN
      TempIntLogCommentLine.RESET;
      TempIntLogCommentLine.DELETEALL;
      IF NOT CMGSetup.GET() THEN
        CMGSetup.INIT();

      IF ContactNo = '' THEN BEGIN
        IF Obj.GET(ObjectType, ObjectNo) THEN
          ContactNo := Obj."Contact No."
        ELSE
          ContactNo := CMGSetup."System Contact";
      END;

      IF NOT UserSetup.GET(USERID) THEN
        UserSetup.INIT;

      SalespersonCode := UserSetup."CM Salesperson Code";
      IF SalespersonCode = '' THEN
        SalespersonCode := CMGSetup."System Salesperson";

      TempSegLine.RESET;
      TempSegLine.DELETEALL;

      TempSegLine.INIT;
      TempSegLine.Date := WORKDATE;
      TempSegLine."Time of Interaction" := TIME;
      TempSegLine.VALIDATE("Contact No.", ContactNo);
      TempSegLine.VALIDATE("Salesperson Code", UserSetup."CM Salesperson Code");
      TempSegLine."Correspondence Type" := TempSegLine."Correspondence Type"::" ";
      TempSegLine."Interaction Group Code" := InteractionGroupCode;
      IF InteractionTplCode = '' THEN
        TempSegLine."Interaction Template Code" := CMGSetup."Default Interact. Tpl. Code"
      ELSE
        TempSegLine."Interaction Template Code" := InteractionTplCode;
      TempSegLine."Campaign Target" := FALSE;
      TempSegLine.Description := '';
      TempSegLine."Attachment No." := TempAttachment."No.";
      TempSegLine."To-do No." := TaskNo;
      TempSegLine.VALIDATE("Contact Company No.", ContactNo);
      TempSegLine.Subject := '';
      TempSegLine."Interaction Successful" := TRUE;
      TempSegLine.INSERT(TRUE);

      SegMgt.LogInteraction(TempSegLine,TempAttachment,TempIntLogCommentLine,FALSE,FALSE);
      ResultLogEntry.FINDLAST();
      UnsetAttachment();
    END;

    PROCEDURE OpenAttachment@1000000033(Rec@1000000000 : Record 5065);
    VAR
      LocAttachment@1000000001 : Record 5062;
      ServerFilename@1000000002 : Text;
      FileNameDefault@1000000003 : Text;
      TempBlob@1000000004 : TEMPORARY Record 99008535;
      FilenameFilter@1000000005 : Text;
    BEGIN
      IF NOT LocAttachment.GET(Rec."Attachment No.") THEN
        ERROR(Text008);

      LocAttachment.CALCFIELDS(Attachment);
      IF NOT LocAttachment.Attachment.HASVALUE THEN
        ERROR(Text008);

      TempBlob.INIT;
      TempBlob.Blob := LocAttachment.Attachment;

      ServerFilename := FileMgt.ServerTempFileName(LocAttachment."File Extension");
      FileMgt.BLOBExportToServerFile(TempBlob, ServerFilename);

      IF Rec.Description <> '' THEN
        FileNameDefault := Rec.Description + '.' + LocAttachment."File Extension"
      ELSE
        FileNameDefault := ServerFilename + '.' + LocAttachment."File Extension";

      FilenameFilter := STRSUBSTNO('.%1|*.%1', LocAttachment."File Extension");
      DOWNLOAD(ServerFilename, Text017, '', FilenameFilter, FileNameDefault);

      FileMgt.DeleteServerFile(ServerFilename);
    END;

    PROCEDURE DeleteLogEntry@1000000042(VAR Rec@1000000000 : Record 5065;DoConfirm@1000000001 : Boolean);
    BEGIN
      IF (NOT Rec."CM Is CMMS Log Entry") OR
         (NOT(Rec."CM Log Type" IN [Rec."CM Log Type"::Comment, Rec."CM Log Type"::Picture, Rec."CM Log Type"::Attachment])) OR
         (Rec."CM Deleted") THEN
        ERROR(Text008);

      IF DoConfirm THEN BEGIN
        IF NOT CONFIRM(Text014) THEN
          ERROR(Text015);
      END;

      Rec."CM Deleted" := TRUE;
      Rec."CM Deleted By User ID" := USERID;
      Rec."CM Deleted Date" := TODAY;
      Rec."CM Deleted Time" := TIME;
      Rec.MODIFY(FALSE);
    END;

    PROCEDURE CopyAndDeleteComment@1000000046(VAR Rec@1000000001 : Record 5065);
    VAR
      CMWoMgt@1000000000 : Codeunit 70030;
      CMWo@1000000002 : Record 5092;
      LocLogEntry@1000000003 : Record 5065;
      EntryNo@1000000004 : Integer;
    BEGIN
      IF NOT CONFIRM(Text016) THEN
        ERROR(Text015);

      IF (NOT CMWo.GET(Rec."CM Source No.")) OR (NOT CMWo."CM Is Workorder") THEN
        ERROR(Text008);

      EntryNo := CMWoMgt.AddCommentUI(CMWo, Rec."Entry No.");
      DeleteLogEntry(Rec, FALSE);

      LocLogEntry.GET(EntryNo);
      LocLogEntry."CM Comment Copied f. Entry No." := Rec."Entry No.";
      LocLogEntry.Date := Rec.Date;
      LocLogEntry."Time of Interaction" := Rec."Time of Interaction";
      LocLogEntry."User ID" := Rec."User ID";
      LocLogEntry."CM Created Datetime" := Rec."CM Created Datetime";
      LocLogEntry.MODIFY(FALSE);
    END;

    PROCEDURE SetAttachment@1000000043(TemporaryAttachment@1000000000 : TEMPORARY Record 5062);
    BEGIN
      UnsetAttachment();
      TempAttachment.COPY(TemporaryAttachment);
    END;

    PROCEDURE UnsetAttachment@1000000028();
    BEGIN
      CLEAR(TempAttachment);
      TempAttachment.RESET;
      TempAttachment.DELETEALL;
    END;

    LOCAL PROCEDURE "### Contract Management ###"@1000000026();
    BEGIN
    END;

    PROCEDURE ValidateTemplate@1000000027(VAR Rec@1000000000 : Record 70050);
    VAR
      AssetContract@1000000001 : Record 70021;
    BEGIN
      IF Rec.Template THEN BEGIN
        AssetContract.SETCURRENTKEY(Objecttype,Type,Key2,Key1);
        AssetContract.SETRANGE(Objecttype, AssetContract.Objecttype::Asset);
        AssetContract.SETRANGE(Type, AssetContract.Type::Contract);
        AssetContract.SETRANGE(Key2, Rec."No.");
        IF AssetContract.FINDFIRST() THEN
          ERROR(Text005);
      END;
    END;

    PROCEDURE ContractTemplateToContract@1000000024(ContractTemplate@1000000000 : Record 70050;RunCardPage@1000000002 : Boolean);
    VAR
      NewContract@1000000001 : Record 70050;
      ContractCardPage@1000000003 : Page 70025;
    BEGIN
      IF NOT ContractTemplate.Template THEN
        ERROR(STRSUBSTNO(Text001, ContractTemplate."No."));

      NewContract.RESET;
      NewContract.INIT;
      NewContract.TRANSFERFIELDS(ContractTemplate,FALSE);
      NewContract."No." := '';
      NewContract.Template := FALSE;
      GetContractNo(NewContract);
      NewContract.INSERT(FALSE);

      IF RunCardPage THEN BEGIN
        NewContract.SETRECFILTER();
        ContractCardPage.SETRECORD(NewContract);
        ContractCardPage.RUN();
      END;
    END;

    PROCEDURE "### Helper Functions ###"@1000000005();
    BEGIN
    END;

    PROCEDURE GetDECValueFR@1000000010(VAR RecRef@1000000000 : RecordRef;FieldNo@1000000001 : Integer) Value : Decimal;
    VAR
      FieldRef@1000000002 : FieldRef;
    BEGIN
      FieldRef := RecRef.FIELD(FieldNo);
      Value := FieldRef.VALUE();
    END;

    PROCEDURE GetINTValueFR@1000000015(VAR RecRef@1000000000 : RecordRef;FieldNo@1000000001 : Integer) Value : Integer;
    VAR
      FieldRef@1000000002 : FieldRef;
    BEGIN
      FieldRef := RecRef.FIELD(FieldNo);
      Value := FieldRef.VALUE();
    END;

    PROCEDURE GetTXTValueFR@1000000016(VAR RecRef@1000000000 : RecordRef;FieldNo@1000000001 : Integer) Value : Text;
    VAR
      FieldRef@1000000002 : FieldRef;
    BEGIN
      FieldRef := RecRef.FIELD(FieldNo);
      Value := FieldRef.VALUE();
    END;

    PROCEDURE GetDATEValueFR@1000000017(VAR RecRef@1000000000 : RecordRef;FieldNo@1000000001 : Integer) Value : Date;
    VAR
      FieldRef@1000000002 : FieldRef;
    BEGIN
      FieldRef := RecRef.FIELD(FieldNo);
      Value := FieldRef.VALUE();
    END;

    PROCEDURE GetBOOLValueFR@1000000018(VAR RecRef@1000000000 : RecordRef;FieldNo@1000000001 : Integer) Value : Boolean;
    VAR
      FieldRef@1000000002 : FieldRef;
    BEGIN
      FieldRef := RecRef.FIELD(FieldNo);
      Value := FieldRef.VALUE();
    END;

    PROCEDURE "### Misc. Funtions ###"@1000000013();
    BEGIN
    END;

    PROCEDURE DeleteWoAndTaskByAsset@1000000019(Rec@1000000000 : Record 70020;DeleteLogs@1000000001 : Boolean);
    VAR
      Wo@1000000002 : Record 5092;
      CMLog@1000000003 : Record 5065;
    BEGIN
      IF DeleteLogs THEN BEGIN
        CMLog.RESET;
        CMLog.SETCURRENTKEY("CM Is CMMS Log Entry","CM Object No.");
        CMLog.SETRANGE("CM Is CMMS Log Entry");
        CMLog.SETRANGE("CM Object No.", Rec."No.");
        CMLog.DELETEALL(FALSE);
      END;

      Wo.RESET;
      Wo.SETCURRENTKEY("CM Is Workorder","CM Object No.");
      Wo.SETRANGE("CM Is Workorder",TRUE);
      Wo.SETRANGE("CM Object No.", Rec."No.");
      IF Wo.FIND('-') THEN BEGIN
        REPEAT
          IF DeleteLogs THEN BEGIN
            CMLog.RESET;
            CMLog.SETCURRENTKEY("CM Is CMMS Log Entry","Opportunity No.");
            CMLog.SETRANGE("CM Is CMMS Log Entry");
            CMLog.SETRANGE("Opportunity No.", Wo."No.");
            CMLog.DELETEALL(FALSE);
          END;

          DeleteTasksByWo(Wo,DeleteLogs);//


        UNTIL Wo.NEXT = 0;
      END;
      Wo.DELETEALL(FALSE);
    END;

    PROCEDURE DeleteAssetAddData@1000000038(Rec@1000000000 : Record 70020);
    VAR
      AddData@1000000001 : Record 70021;
    BEGIN
      AddData.SETRANGE(Objecttype, Rec.Objecttype);
      AddData.FILTERGROUP(-1);
      AddData.SETFILTER(Key1, Rec."No.");
      AddData.SETFILTER(Key2, Rec."No.");
      AddData.FILTERGROUP(0);
      AddData.DELETEALL(TRUE);
    END;

    PROCEDURE DeleteTasksByWo@1000000020(Rec@1000000000 : Record 5092;DeleteLogs@1000000001 : Boolean);
    VAR
      CMLog@1000000002 : Record 5065;
      Task@1000000003 : Record 5080;
    BEGIN
      Task.RESET;
      Task.SETCURRENTKEY("Opportunity No.","CM Type");
      Task.SETRANGE("Opportunity No.", Rec."No.");
      Task.SETRANGE("CM Type", Task."CM Type"::Task);
      IF Task.FIND('-') THEN BEGIN
        REPEAT
          IF DeleteLogs THEN BEGIN
            CMLog.RESET;
            CMLog.SETCURRENTKEY("CM Is CMMS Log Entry","To-do No.");
            CMLog.SETRANGE("CM Is CMMS Log Entry");
            CMLog.SETRANGE("To-do No.", Task."No.");
            CMLog.DELETEALL(FALSE);
          END;
        UNTIL Task.NEXT = 0;
      END;
      Task.DELETEALL(FALSE);
    END;

    PROCEDURE VisibleOnPhone@1000000021() : Boolean;
    BEGIN
      EXIT
      (
           NOT ((SESSION.CURRENTCLIENTTYPE = CLIENTTYPE::Phone) OR
           (SESSION.CURRENTCLIENTTYPE = CLIENTTYPE::Tablet))
      );
    END;

    PROCEDURE Instream2Text@1000000022(VAR InStream@1000000000 : InStream) : Text;
    VAR
      CR@1000000001 : Char;
      LF@1000000002 : Char;
      FirstLoop@1000000003 : Boolean;
      Txt@1000000004 : Text;
      Result@1000000005 : Text;
    BEGIN
      CR := 13;
      LF := 10;

      FirstLoop := TRUE;

      WHILE (NOT InStream.EOS) DO BEGIN
        IF NOT FirstLoop THEN
          Result += FORMAT(CR) + FORMAT(LF);
        InStream.READTEXT(Txt);
        Result += Txt;
        FirstLoop := FALSE;
      END;
      EXIT(Result);
    END;

    PROCEDURE DoUniversalLookup@1000000025(SetupType@1000000001 : '0,1,2,3,4,5,6,7,8,9,10';SourceNo@1000000002 : Code[20];StatusFilter@1000000011 : Text;SearchString@1000000003 : Text[50];NoFilter@1000000012 : Text) : Code[20];
    VAR
      CMAsset@1000000004 : Record 70020;
      AssetList@1000000006 : Page 70021;
      ProjectList@1000000007 : Page 70023;
      CMUserAccessMgmt@1000000005 : Codeunit 70010;
      LookupList@1000000000 : Page 70118;
      UserSetup@1000000008 : Record 91;
      RespCenterFilter@1000000009 : Text;
      ShowAssetBool@1000000010 : Boolean;
    BEGIN
      {
        0 = Asset, 1 = Project, 2 = Only Main Asset, 3 = All except Main Assets
      }
      SetFilterUniversalLookup(SetupType,SourceNo,StatusFilter,SearchString,NoFilter,CMAsset);

      //Return Single Result instantly, when searching
      IF (SearchString <> '') AND (CMAsset.COUNT = 1) THEN BEGIN
        CMAsset.FINDFIRST();
        EXIT(CMAsset."No.");
      END;

      //Show Page without Search String:
      IF (SearchString <> '') AND (CMAsset.COUNT = 0) THEN BEGIN
        EXIT(DoUniversalLookup(SetupType,SourceNo,StatusFilter,NoFilter,''));
      END;

      //Open Lookup Pages
      CASE SetupType OF
        SetupType::"0" : LookupList.SetCaption(Text006);
        SetupType::"1" : LookupList.SetCaption(Text007);
        SetupType::"2" : LookupList.SetCaption(Text012);
        SetupType::"3" : LookupList.SetCaption(Text006);
      END;

      IF NOT IsEditable THEN BEGIN
        {View}
        LookupList.LOOKUPMODE(TRUE);
        LookupList.SETTABLEVIEW(CMAsset);
        IF LookupList.RUNMODAL = ACTION::LookupOK THEN
          EXIT(LookupList.GetNo());
      END ELSE BEGIN
        {Editable}
        CASE SetupType OF
        SetupType::"0" :
          BEGIN
          AssetList.SETTABLEVIEW(CMAsset);
          AssetList.RUN;
          END;
        SetupType::"1" :
          BEGIN
          ProjectList.SETTABLEVIEW(CMAsset);
          ProjectList.RUN;
          END;
        SetupType::"2" :
          BEGIN
          AssetList.SETTABLEVIEW(CMAsset);
          AssetList.RUN;
          END;
        SetupType::"3" :
          BEGIN
          AssetList.SETTABLEVIEW(CMAsset);
          AssetList.RUN;
          END;
      END;
      END;

      EXIT('');
    END;

    PROCEDURE CountUniversalLookup@1000000040(SetupType@1000000001 : '0,1,2,3,4,5,6,7,8,9,10';SourceNo@1000000002 : Code[20];StatusFilter@1000000011 : Text;SearchString@1000000003 : Text[50];NoFilter@1000000012 : Text) : Integer;
    VAR
      CMAsset@1000000004 : Record 70020;
      AssetList@1000000006 : Page 70021;
      ProjectList@1000000007 : Page 70023;
      CMUserAccessMgmt@1000000005 : Codeunit 70010;
      LookupList@1000000000 : Page 70118;
      UserSetup@1000000008 : Record 91;
      RespCenterFilter@1000000009 : Text;
      ShowAssetBool@1000000010 : Boolean;
    BEGIN
      {
        0 = Asset, 1 = Project, 2 = Only Main Asset, 3 = All except Main Assets
      }

      SetFilterUniversalLookup(SetupType,SourceNo,StatusFilter,SearchString,NoFilter,CMAsset);

      EXIT(CMAsset.COUNT);
    END;

    PROCEDURE SetFilterUniversalLookup@1000000041(SetupType@1000000001 : '0,1,2,3,4,5,6,7,8,9,10';SourceNo@1000000002 : Code[20];StatusFilter@1000000004 : Text;SearchString@1000000003 : Text[50];NoFilter@1000000012 : Text;VAR CMAsset@1000000011 : Record 70020);
    VAR
      AssetList@1000000006 : Page 70021;
      ProjectList@1000000007 : Page 70023;
      CMUserAccessMgmt@1000000005 : Codeunit 70010;
      LookupList@1000000000 : Page 70118;
      UserSetup@1000000008 : Record 91;
      RespCenterFilter@1000000009 : Text;
      ShowAssetBool@1000000010 : Boolean;
    BEGIN
      {
        0 = Asset, 1 = Project, 2 = Only Main Asset, 3 = All except Main Assets
      }
      CLEAR(RespCenterFilter);
      IF NOT UserSetup.GET(USERID) THEN EXIT;
      RespCenterFilter := CMUserAccessMgmt.GetAssetRespFilter;

      //General Filtering:
      OpimizeKeys(SetupType, SourceNo, StatusFilter, NoFilter, SearchString, CMAsset);

      CMAsset.SETRANGE(Objecttype, GetObjectTypeFromSetupType(SetupType));
      IF NoFilter <> '' THEN
        CMAsset.SETFILTER("No.", NoFilter);
      CMAsset.SETRANGE("User ID Filter",USERID);
      IF StatusFilter <> '' THEN
        CMAsset.SETFILTER("Operational Status", StatusFilter);

      //Main/Sub Filtering
      IF (SourceNo <> '') AND ((SetupType = 0) OR (SetupType = 3)) THEN
        CMAsset.SETRANGE("Main Asset No.", SourceNo);
      IF (SourceNo <> '') AND (SetupType = 1) THEN BEGIN
        CMAsset.SETRANGE("Asset No. Filter", SourceNo);
        CMAsset.SETRANGE("Is Project of Asset", TRUE);
      END;
      IF SetupType = 2 THEN
        CMAsset.SETRANGE("Asset Type", CMAsset."Asset Type"::"Main Asset");
      IF SetupType = 3 THEN
        CMAsset.SETFILTER("Asset Type", '%1|%2',CMAsset."Asset Type"::Asset, CMAsset."Asset Type"::"Sub Asset");

      IF SearchString <> '' THEN BEGIN
        CMAsset.FILTERGROUP := -1;
        SearchString := '@*' + SearchString + '*';
        CMAsset.SETFILTER("No.", SearchString);
        CMAsset.SETFILTER(Name, SearchString);
        CMAsset.SETFILTER("Name 2", SearchString);
        IF CMAsset.FINDFIRST THEN
        REPEAT
          {Check Rights}
          IF NOT (((UserSetup."IG Asset Administrator") AND ((SetupType = 0) OR (SetupType = 2) OR (SetupType = 3))) OR
                 ((UserSetup."IG Project Administrator") AND (SetupType = 1))) THEN BEGIN
            IF CMAsset.FIND('-') THEN
              REPEAT
                ShowAssetBool := FALSE;
                {User}
                CMAsset.CALCFIELDS(ShowAsset);
                IF CMAsset.ShowAsset THEN
                  ShowAssetBool := TRUE;
                {No Responsibility Center}
                IF RespCenterFilter = '' THEN
                  ShowAssetBool := FALSE;
                {Responsibility Center}
                IF (RespCenterFilter <> '') AND (STRPOS(RespCenterFilter,CMAsset."Responsibility Center") <> 0) THEN
                  ShowAssetBool := TRUE;
                IF ShowAssetBool THEN
                  CMAsset.MARK(TRUE);
              UNTIL CMAsset.NEXT = 0;
          END ELSE
            CMAsset.MARK(TRUE);
        UNTIL CMAsset.NEXT = 0;
      END ELSE BEGIN
        IF CMAsset.FIND('-') THEN
        REPEAT
          {Check Rights}
          IF NOT (((UserSetup."IG Asset Administrator") AND ((SetupType = 0) OR (SetupType = 2) OR (SetupType = 3))) OR
                 ((UserSetup."IG Project Administrator") AND (SetupType = 1))) THEN BEGIN
            ShowAssetBool := FALSE;
            {User}
            CMAsset.CALCFIELDS(ShowAsset);
            IF CMAsset.ShowAsset THEN
              ShowAssetBool := TRUE;
            {No Responsibility Center}
            IF RespCenterFilter = '' THEN
              ShowAssetBool := FALSE;
            {Responsibility Center}
            IF (RespCenterFilter <> '') AND (STRPOS(RespCenterFilter,CMAsset."Responsibility Center") <> 0) THEN
              ShowAssetBool := TRUE;
            IF ShowAssetBool THEN
              CMAsset.MARK(TRUE);
          END ELSE
            CMAsset.MARK(TRUE);
        UNTIL CMAsset.NEXT = 0;
      END;

      CMAsset.MARKEDONLY(TRUE);
    END;

    LOCAL PROCEDURE OpimizeKeys@1000000049(SetupType@1000000004 : '0,1,2,3,4,5,6,7,8,9,10';SourceNo@1000000003 : Code[20];StatusFilter@1000000002 : Text;NoFilter@1000000005 : Text;SearchString@1000000001 : Text[50];VAR CMAsset@1000000000 : Record 70020);
    BEGIN
      //Selects a performant key for DoUniversalLookup()

      IF DisableKeyOptimization THEN
        EXIT;

      IF NoFilter <> '' THEN BEGIN
        CMAsset.SETCURRENTKEY(Objecttype,"No.");
        EXIT;
      END;

      IF (SourceNo <> '') AND (SetupType IN [0,3]) THEN BEGIN
        CMAsset.SETCURRENTKEY(Objecttype, "Main Asset No.", "Asset Type", "Responsibility Center");
        EXIT;
      END;

      IF (SetupType IN [2,3]) THEN BEGIN
        CMAsset.SETCURRENTKEY(Objecttype, "Asset Type", "Responsibility Center");
        EXIT;
      END;

      //Default
      CMAsset.SETCURRENTKEY(Objecttype,"No.");
    END;

    PROCEDURE SetEditable@1000000039(lSetEditable@1000000000 : Boolean);
    BEGIN
      IsEditable := lSetEditable;
    END;

    LOCAL PROCEDURE GetObjectTypeFromSetupType@1000000037(SetupType@1000000000 : '0,1,2,3,4,5,6,7,8,9,10') : Integer;
    VAR
      CMMSAsset@1000000001 : Record 70020;
    BEGIN
      CASE SetupType OF
        SetupType::"0" : EXIT(CMMSAsset.Objecttype::Asset);
        SetupType::"1" : EXIT(CMMSAsset.Objecttype::Project);
        SetupType::"2" : EXIT(CMMSAsset.Objecttype::Asset);
        SetupType::"3" : EXIT(CMMSAsset.Objecttype::Asset);
      END;
      EXIT(0);
    END;

    PROCEDURE CalcCueFieldValues@6(VAR Rec@1000000000 : Record 70011);
    VAR
      CMMSGeneralMgmt@1000000001 : Codeunit 70000;
      CMMSWoMgmt@1000000002 : Codeunit 70030;
      SubstitutionUserFilter@1000000003 : Text[250];
    BEGIN
      SetManagementCueFilter(Rec);
      CalcfieldsCue(Rec); //Set FlowFilter and do Calcfields
      SubstitutionUserFilter := GetSubstitutionUserFilter2(USERID);

      //MASTERDATA
      Rec.Assets := CMMSGeneralMgmt.CountUniversalLookup(3,'','','','');
      Rec."Main Assets" := CMMSGeneralMgmt.CountUniversalLookup(2,'','','','');
      Rec.Projects := CMMSGeneralMgmt.CountUniversalLookup(1,'','','','');

      //WORK ORDERS:
      CMMSWoMgmt.SetKeyOpimization(NOT DisableKeyOptimization);
      Rec."My Work Orders" := CMMSWoMgmt.CountWorkorders('','',USERID,'','0|1|2|3','','');
      Rec."My Planned Work. (Due)" := CMMSWoMgmt.CountWorkorders('','',USERID,'','0|1|2|3', Rec.GETFILTER("Due Date Filter (Planned)"),'');
      Rec."My Planned Work. (Overdue)" := CMMSWoMgmt.CountWorkorders('','',USERID,Rec.GETFILTER("Overdue Date Filter (Planned)"),'0|1|2|3', '','');
      IF SubstitutionUserFilter <> '' THEN BEGIN
        Rec."My Sub. Work Orders" := CMMSWoMgmt.CountWorkorders('','',SubstitutionUserFilter,'','0|1|2|3','','');
        Rec."My Planned Sub. WO (Due)" := CMMSWoMgmt.CountWorkorders('','',SubstitutionUserFilter,'','0|1|2|3', Rec.GETFILTER("Due Date Filter (Planned)"),'');
        Rec."My Planned Sub. WO (Overdue)" := CMMSWoMgmt.CountWorkorders('','',SubstitutionUserFilter,Rec.GETFILTER("Overdue Date Filter (Planned)"),'0|1|2|3', '','');
      END;
      Rec."New Work Orders (Resp.)" := CMMSWoMgmt.CountWorkorders('',USERID,USERID,'','0','','<>1&<>4');
      Rec."New Alarm Work Orders (Resp.)" := CMMSWoMgmt.CountWorkorders('',USERID,USERID,'','0','','1|4');
      Rec."Open Work Orders (Resp.)" := CMMSWoMgmt.CountWorkorders('',USERID,USERID,'','1','','');
      Rec."Work Orders In Process (Resp.)" := CMMSWoMgmt.CountWorkorders('',USERID,USERID,'','2','','');
      Rec."Completed Work Orders (Resp.)" := CMMSWoMgmt.CountWorkorders('',USERID,USERID,'','3','','');
    END;

    PROCEDURE CalcfieldsCue@1000000045(VAR Rec@1000000000 : Record 70011);
    BEGIN
      SetManagementCueFilter(Rec);

      //MASTERDATA
      Rec.CALCFIELDS
      (
        Rec.Contracts
      );

      //ALARMS
      Rec.CALCFIELDS
      (
        "New Alarms",
        "Open Alarms",
        "Alarms In Process",
        "Completed Alarms"
      );

      //TIME RECORDS
      Rec.CALCFIELDS
      (
        "Time Records",
        "Time Records (Today)",
        "Time Records (Week)",
        "My Time Records",
        "My Time Records (Today)",
        "My Time Records (Week)",
        "My Time Records (Month)"
      );

      //REQUEST
      Rec.CALCFIELDS
      (
        Requests,
        "My Requests"
      );
    END;

    LOCAL PROCEDURE SetManagementCueFilter@1000000011(VAR Rec@1000000000 : Record 70011);
    VAR
      StartDate@1000000001 : Date;
      EndDate@1000000002 : Date;
    BEGIN
      StartDate:= CALCDATE('<-CW>',WORKDATE);
      EndDate:= CALCDATE('<+CW>',WORKDATE);

      Rec.SetRespCenterFilter;
      Rec.SETRANGE("User ID Filter",USERID);
      Rec.SETRANGE("Due Date Filter",StartDate, EndDate);
      Rec.SETFILTER("Due Date Filter (Planned)", '>=%1', WORKDATE);
      Rec.SETFILTER("Overdue Date Filter",'<%1',StartDate);
      Rec.SETFILTER("Overdue Date Filter (Planned)", '<%1', WORKDATE);
      Rec.SETFILTER("Undue Date Filter",'>=%1',WORKDATE);
      Rec.SETRANGE("Today Date Filter", WORKDATE);
      Rec.SETFILTER("Week Date Filter", CMTTMgt.GetThisWeekDatefilter(WORKDATE));
      Rec.SETFILTER("Month Date Filter", CMTTMgt.GetThisMonthDatefilter(WORKDATE));
    END;

    PROCEDURE GetSubstitutionUserFilter@1000000047(ForUserID@1000000000 : Code[50]) : Text[250];
    VAR
      Result@1000000001 : Text;
      CMAddData@1000000002 : Record 70021;
    BEGIN
      //Param: The User ID of the User TO Substitute
      Result := '';
      CMAddData.RESET;
      CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::User);
      CMAddData.SETRANGE(Type, CMAddData.Type::Substitue);
      CMAddData.SETRANGE(Key1, ForUserID);
      IF CMAddData.FIND('-') THEN BEGIN
        REPEAT
          IF ((CMAddData."From Date" <= TODAY) OR (CMAddData."From Date" = 0D)) AND
             ((CMAddData."To Date" >= TODAY) OR (CMAddData."To Date" = 0D)) THEN
            Result += '|' + CMAddData.Key2;
        UNTIL CMAddData.NEXT = 0;
        Result := COPYSTR(Result, 2);
      END;

      EXIT(Result);
    END;

    PROCEDURE GetSubstitutionUserFilter2@1000000072(SubstitutionUserId@1000000000 : Code[50]) : Text[250];
    VAR
      Result@1000000001 : Text;
      CMAddData@1000000002 : Record 70021;
    BEGIN
      //Param: The User ID of the Substitution User
      Result := '';
      CMAddData.RESET;
      CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::User);
      CMAddData.SETRANGE(Type, CMAddData.Type::Substitue);
      CMAddData.SETRANGE(Key2, SubstitutionUserId);
      IF CMAddData.FIND('-') THEN BEGIN
        REPEAT
          IF ((CMAddData."From Date" <= TODAY) OR (CMAddData."From Date" = 0D)) AND
             ((CMAddData."To Date" >= TODAY) OR (CMAddData."To Date" = 0D)) THEN
            Result += '|' + CMAddData.Key1;
        UNTIL CMAddData.NEXT = 0;
        Result := COPYSTR(Result, 2);
      END;

      EXIT(Result);
    END;

    PROCEDURE GetNotificationCopyUserFilter@1000000074(ForUserID@1000000000 : Code[50]) : Text[250];
    VAR
      Result@1000000001 : Text;
      CMAddData@1000000002 : Record 70021;
    BEGIN
      Result := '';
      CMAddData.RESET;
      CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::User);
      CMAddData.SETRANGE(Type, CMAddData.Type::NotificationCopy);
      CMAddData.SETRANGE(Key1, ForUserID);
      IF CMAddData.FIND('-') THEN BEGIN
        REPEAT
          IF ((CMAddData."From Date" <= TODAY) OR (CMAddData."From Date" = 0D)) AND
             ((CMAddData."To Date" >= TODAY) OR (CMAddData."To Date" = 0D)) THEN
            Result += '|' + CMAddData.Key2;
        UNTIL CMAddData.NEXT = 0;
        Result := COPYSTR(Result, 2);
      END;

      EXIT(Result);
    END;

    PROCEDURE GetUoMTranslated@1000000044(UoMCode@1000000000 : Code[20]) : Text;
    VAR
      UoM@1000000003 : Record 204;
      UoMTrans@1000000001 : Record 5402;
      Lang@1000000002 : Record 8;
    BEGIN
      IF NOT UoM.GET(UoMCode) THEN
        EXIT('');

      IF NOT UoMTrans.GET(UoMCode, Lang.GetUserLanguage()) THEN
        EXIT(UoM.Description);

      EXIT(UoMTrans.Description);
    END;

    PROCEDURE "### User Setup ###"@1000000029();
    BEGIN
    END;

    PROCEDURE UserSetupOnInsert@1000000030(VAR Rec@1000000000 : Record 91);
    BEGIN
      CreateUpdateUserSetupSalesperson(Rec);
    END;

    PROCEDURE UserSetupOnRename@1000000032(VAR Rec@1000000000 : Record 91;VAR xRec@1000000001 : Record 91);
    BEGIN
      CreateUpdateUserSetupSalesperson(Rec);
    END;

    PROCEDURE CreateUpdateUserSetupSalesperson@1000000031(VAR Rec@1000000000 : Record 91);
    VAR
      Salesperson@1000000001 : Record 13;
    BEGIN
      Rec.CALCFIELDS("CM Name");

      IF Rec."CM Salesperson Code" = '' THEN BEGIN
        Salesperson.INIT;
        Salesperson.Code := COPYSTR(Rec."User ID",1,10);
        Salesperson.Name := Rec."CM Name";
        Salesperson.INSERT(TRUE);

        Rec."CM Salesperson Code" := Salesperson.Code;
      END
      ELSE BEGIN
        IF Salesperson.GET(Rec."CM Salesperson Code") THEN BEGIN
          Salesperson.Name := Rec."CM Name";
          Salesperson.MODIFY(FALSE);
        END;
      END;
    END;

    PROCEDURE "### NOTIFICATIONS ###"@1000000060();
    BEGIN
    END;

    PROCEDURE CreateFlowNotification@1000000061(VAR NotificationEntry@1000000003 : Record 1511;UserSetup@1000000002 : Record 91;Workorder@1000000005 : Record 5092;Task@1000000006 : Record 5080;UrlFor@1000000001 : 'Workorder,Task');
    VAR
      CMObject@1000000000 : Record 70020;
      Url1@1000000004 : Text;
      Url2@1000000007 : Text;
      ConnectorId@1000000008 : Text[80];
      RecId@1000000009 : RecordID;
      CurrentUserSetup@1000000010 : Record 91;
    BEGIN
      NotificationEntry.ID := 0;
      Task.SETRANGE("No.", Task."No.");
      Workorder.SETRANGE("No.", Workorder."No.");

      //Connector
      ConnectorId := UserSetup."E-Mail";
      IF UserSetup."CM Connector Id" <> '' THEN
        ConnectorId := UserSetup."CM Connector Id";
      IF ConnectorId = '' THEN
        EXIT;
      IF UserSetup."CM Connector" = UserSetup."CM Connector"::" " THEN
        EXIT;

      IF NOT CurrentUserSetup.GET(USERID) THEN CurrentUserSetup.INIT;
      CurrentUserSetup.CALCFIELDS("CM Name");

      IF NOT CMObject.GET(Workorder."CM Objecttype", Workorder."CM Object No.") THEN CMObject.INIT;

      IF UrlFor = UrlFor::Workorder THEN BEGIN
        RecId := Workorder.RECORDID;
        Url1 := GETURL(CLIENTTYPE::Windows, COMPANYNAME, OBJECTTYPE::Page, PAGE::"CMMS Workorder Card", Workorder, TRUE);
        Url2 := GETURL(CLIENTTYPE::Web, COMPANYNAME, OBJECTTYPE::Page, PAGE::"CMMS Workorder Card", Workorder, TRUE);
      END;
      IF UrlFor = UrlFor::Task THEN BEGIN
        RecId := Task.RECORDID;
        Url1 := GETURL(CLIENTTYPE::Windows, COMPANYNAME, OBJECTTYPE::Page, PAGE::"CMMS Task Card", Task, TRUE);
        Url2 := GETURL(CLIENTTYPE::Web, COMPANYNAME, OBJECTTYPE::Page, PAGE::"CMMS Task Card", Task, TRUE);
      END;

      //General Info
      NotificationEntry."Triggered By Record" := RecId;
      NotificationEntry."CM To Connector" := UserSetup."CM Connector";
      NotificationEntry."CM To UserID" := UserSetup."User ID";
      NotificationEntry."CM To Connector ID" := ConnectorId;

      //Specific Info
      NotificationEntry."CM Key Data 1" := Workorder."No.";
      NotificationEntry."CM Key Data 2" := Task."No.";
      NotificationEntry."CM Key Data 3" := CMObject."No.";

      //Misc:
      NotificationEntry."CM Data Medium 8" := CMObject.Name;
      IF CurrentUserSetup."User ID" <> '' THEN
        NotificationEntry."CM Data Long 2" := CurrentUserSetup."CM Name" + ' (' + USERID + ')'
      ELSE
        NotificationEntry."CM Data Long 2" := USERID;

      //Workorder
      NotificationEntry."CM Data Medium 1" := Workorder.Description;
      NotificationEntry."CM Data Long 3" := Workorder."CM GPM Reference Element Name";
      NotificationEntry."CM Data Medium 3" := FORMAT(Workorder."CM Due Date");
      NotificationEntry."CM Data Short 1" := FORMAT(Workorder."CM Status");

      //Task
      NotificationEntry."CM Data Medium 4" := Task.Description;
      NotificationEntry."CM Data Long 1" := Task."CM Extended Description";
      NotificationEntry."CM Data Medium 6" := FORMAT(Task."CM Due Date");
      NotificationEntry."CM Data Medium 7" := FORMAT(Task."CM Scheduled Date") + ' ' + FORMAT(Task."CM Scheduled Time");
      NotificationEntry."CM Data Short 2" := FORMAT(Task."CM Status");

      //Link
      NotificationEntry."CM NAV Link 1" := Url1;
      NotificationEntry."CM NAV Link 2" := Url2;

      NotificationEntry.INSERT(TRUE);
    END;

    LOCAL PROCEDURE CheckNotificationUserSetup@1000000068(Uid@1000000000 : Code[50];VAR UserSetup@1000000001 : Record 91) : Boolean;
    BEGIN
      IF (Uid = '') OR
         (NOT UserSetup.GET(Uid)) OR
         (NOT UserSetup."CM Notifications") OR
         (UserSetup."CM Connector" = UserSetup."CM Connector"::" ") OR
         ((UserSetup."E-Mail" = '') AND (UserSetup."CM Connector Id" = '')) THEN
         EXIT(FALSE);

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE NotificationPrecheck@1000000073(NotificationNo@1000000000 : Integer;UidReceiver@1000000003 : Code[50];SecondaryUid@1000000001 : Code[50];Type@1000000004 : 'normal,substitution,copy';VAR UserSetup@1000000002 : Record 91) : Boolean;
    BEGIN
      //Normal & Substitution
      IF (Type = Type::normal) OR (Type = Type::substitution) THEN BEGIN
        //Substitution
        IF Type = Type::substitution THEN
          UidReceiver := SecondaryUid;

        IF UidReceiver = USERID THEN
          EXIT(FALSE);
        IF NOT CheckNotificationUserSetup(UidReceiver, UserSetup) THEN
          EXIT(FALSE);

        CASE TRUE OF
          (NotificationNo = 1) AND (NOT UserSetup."CM Notification 1") : EXIT(FALSE);
          (NotificationNo = 2) AND (NOT UserSetup."CM Notification 2") : EXIT(FALSE);
          (NotificationNo = 3) AND (NOT UserSetup."CM Notification 3") : EXIT(FALSE);
          (NotificationNo = 4) AND (NOT UserSetup."CM Notification 4") : EXIT(FALSE);
          (NotificationNo = 5) AND (NOT UserSetup."CM Notification 5") : EXIT(FALSE);
          (NotificationNo = 6) AND (NOT UserSetup."CM Notification 6") : EXIT(FALSE);
        END;
      END;

      //Copy
      IF Type = Type::copy THEN BEGIN
        IF NOT UserSetup.GET(SecondaryUid) THEN
          UserSetup.INIT;
        IF (UserSetup."E-Mail" = '') AND (UserSetup."CM Connector Id" = '') THEN
          EXIT(FALSE);
        IF UserSetup."CM Connector" = UserSetup."CM Connector"::" " THEN
          EXIT(FALSE);
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CheckNotificationSubstitutionAndCopy@1000000070(NotificationNo@1000000005 : Integer;ReceiverUid@1000000000 : Code[50];Workorder@1000000001 : Record 5092;Task@1000000002 : Record 5080;CallDepth@1000000007 : Integer);
    VAR
      UserFilter@1000000004 : Text;
      UserSetup@1000000003 : Record 91;
    BEGIN
      IF (ReceiverUid = '') THEN
        EXIT;

      IF CallDepth < 0 THEN
        CallDepth := 0;

      CallDepth += 1;
      IF CallDepth > 4 THEN
        EXIT;

      //Check Substitution
      UserFilter := GetSubstitutionUserFilter(ReceiverUid);
      IF UserFilter <> '' THEN BEGIN
        UserSetup.SETFILTER("User ID", UserFilter);
        IF UserSetup.FIND('-') THEN BEGIN
          REPEAT
            CASE NotificationNo OF //Recursion
              1 : CheckNotification1(Workorder, 1, UserSetup."User ID", CallDepth);
              2 : CheckNotification2(Workorder, 1, UserSetup."User ID", CallDepth);
              3 : CheckNotification3(Workorder, 1, UserSetup."User ID", CallDepth);
              4 : CheckNotification4(Workorder, Task, 1, UserSetup."User ID", CallDepth);
              5 : CheckNotification5(Workorder, Task, 1, UserSetup."User ID", CallDepth);
              6 : CheckNotification6(Workorder, Task, 1, UserSetup."User ID", CallDepth);
            END;
          UNTIL UserSetup.NEXT() = 0;
        END;
      END;

      //Check Copy
      UserFilter := GetNotificationCopyUserFilter(ReceiverUid);
      IF UserFilter <> '' THEN BEGIN
        UserSetup.SETFILTER("User ID", UserFilter);
        IF UserSetup.FIND('-') THEN BEGIN
          REPEAT
            CASE NotificationNo OF //Recursion
              1 : CheckNotification1(Workorder, 2, UserSetup."User ID", CallDepth);
              2 : CheckNotification2(Workorder, 2, UserSetup."User ID", CallDepth);
              3 : CheckNotification3(Workorder, 2, UserSetup."User ID", CallDepth);
              4 : CheckNotification4(Workorder, Task, 2, UserSetup."User ID", CallDepth);
              5 : CheckNotification5(Workorder, Task, 2, UserSetup."User ID", CallDepth);
              6 : CheckNotification6(Workorder, Task, 2, UserSetup."User ID", CallDepth);
            END;
          UNTIL UserSetup.NEXT() = 0;
        END;
      END;
    END;

    PROCEDURE CheckNotification1@1000000062(NewWorkorder@1000000000 : Record 5092;Type@1000000005 : 'normal,substitution,copy';SecondaryUid@1000000003 : Code[50];CallDepth@1000000006 : Integer);
    VAR
      UserSetup@1000000002 : Record 91;
      NotEnty@1000000001 : Record 1511;
      UidReceiver@1000000004 : Code[50];
    BEGIN
      //New Workorder assigned to me
      UidReceiver := GetReceiverUid(NewWorkorder."CM Assigned User ID", SecondaryUid);
      CheckNotificationSubstitutionAndCopy(1, UidReceiver, NewWorkorder, DummyTask, CallDepth);
      IF NOT NotificationPrecheck(1, UidReceiver, SecondaryUid, Type, UserSetup) THEN
        EXIT;

      NotEnty.INIT;
      NotEnty."CM Type" := NotEnty."CM Type"::"New Workorder assigned to me";
      NotEnty."CM Subject 1" := 'A new Workorder has been created and has been assigned to you.';
      ModifySubject(NotEnty."CM Subject 1", Type);
      CreateFlowNotification(NotEnty, UserSetup, NewWorkorder, DummyTask, 0);
    END;

    PROCEDURE CheckNotification2@1000000063(Workorder@1000000000 : Record 5092;Type@1000000004 : 'normal,substitution,copy';SecondaryUid@1000000001 : Code[50];CallDepth@1000000006 : Integer);
    VAR
      UserSetup@1000000005 : Record 91;
      NotEnty@1000000003 : Record 1511;
      UidReceiver@1000000002 : Code[50];
    BEGIN
      //Workorder assigned to me
      //(Not if assigned by myself)
      UidReceiver := GetReceiverUid(Workorder."CM Assigned User ID", SecondaryUid);
      CheckNotificationSubstitutionAndCopy(2, UidReceiver, Workorder, DummyTask, CallDepth);
      IF NOT NotificationPrecheck(2, UidReceiver, SecondaryUid, Type, UserSetup) THEN
        EXIT;

      NotEnty.INIT;
      NotEnty."CM Type" := NotEnty."CM Type"::"Workorder assigned to me";
      NotEnty."CM Subject 1" := 'A Workorder has been assigned to you.';
      ModifySubject(NotEnty."CM Subject 1", Type);
      CreateFlowNotification(NotEnty, UserSetup, Workorder, DummyTask, 0);
    END;

    PROCEDURE CheckNotification3@1000000064(Workorder@1000000000 : Record 5092;Type@1000000005 : 'normal,substitution,copy';SecondaryUid@1000000003 : Code[50];CallDepth@1000000006 : Integer);
    VAR
      UserSetup@1000000002 : Record 91;
      NotEnty@1000000001 : Record 1511;
      UidReceiver@1000000004 : Code[50];
    BEGIN
      //My Workorder status changed
      //(Not if changed by myself)
      UidReceiver := GetReceiverUid(Workorder."CM Assigned User ID", SecondaryUid);
      CheckNotificationSubstitutionAndCopy(3, UidReceiver, Workorder, DummyTask, CallDepth);
      IF NOT NotificationPrecheck(3, UidReceiver, SecondaryUid, Type, UserSetup) THEN
        EXIT;

      NotEnty.INIT;
      NotEnty."CM Type" := NotEnty."CM Type"::"My Workorder - status changed";
      NotEnty."CM Subject 1" := 'Notification reason: Somone has changed the status of a Workorder that is assigned to you.';
      ModifySubject(NotEnty."CM Subject 1", Type);
      CreateFlowNotification(NotEnty, UserSetup, Workorder, DummyTask, 0);
    END;

    PROCEDURE CheckNotification4@1000000065(Workorder@1000000000 : Record 5092;NewTask@1000000003 : Record 5080;Type@1000000006 : 'normal,substitution,copy';SecondaryUid@1000000004 : Code[50];CallDepth@1000000007 : Integer);
    VAR
      UserSetup@1000000002 : Record 91;
      NotEnty@1000000001 : Record 1511;
      UidReceiver@1000000005 : Code[50];
    BEGIN
      //My Workorder - new Task
      //(Not if created by myself)
      UidReceiver := GetReceiverUid(Workorder."CM Assigned User ID", SecondaryUid);
      CheckNotificationSubstitutionAndCopy(4, UidReceiver, Workorder, NewTask, CallDepth);
      IF NOT NotificationPrecheck(4, UidReceiver, SecondaryUid, Type, UserSetup) THEN
        EXIT;

      NotEnty.INIT;
      NotEnty."CM Type" := NotEnty."CM Type"::"My Workorder - new Task";
      NotEnty."CM Subject 1" := 'Notification reason: A new Task has been added to a Workorder that is assigned to you.';
      ModifySubject(NotEnty."CM Subject 1", Type);
      CreateFlowNotification(NotEnty, UserSetup, Workorder, NewTask, 1);
    END;

    PROCEDURE CheckNotification5@1000000066(Workorder@1000000003 : Record 5092;Task@1000000000 : Record 5080;Type@1000000006 : 'normal,substitution,copy';SecondaryUid@1000000004 : Code[50];CallDepth@1000000007 : Integer);
    VAR
      UidReceiver@1000000005 : Code[50];
      UserSetup@1000000002 : Record 91;
      NotEnty@1000000001 : Record 1511;
    BEGIN
      //Task assigend to me
      //(Not if assigned by myself)
      UidReceiver := GetReceiverUid(Task."CM Assigned User ID", SecondaryUid);
      CheckNotificationSubstitutionAndCopy(5, UidReceiver, Workorder, Task, CallDepth);
      IF NOT NotificationPrecheck(5, UidReceiver, SecondaryUid, Type, UserSetup) THEN
        EXIT;

      NotEnty.INIT;
      NotEnty."CM Type" := NotEnty."CM Type"::"Task assigend to me";
      NotEnty."CM Subject 1" := 'A Task has been assigned to you.';
      ModifySubject(NotEnty."CM Subject 1", Type);
      CreateFlowNotification(NotEnty, UserSetup, Workorder, Task, 1);
    END;

    PROCEDURE CheckNotification6@1000000067(Workorder@1000000000 : Record 5092;Task@1000000003 : Record 5080;Type@1000000006 : 'normal,substitution,copy';SecondaryUid@1000000004 : Code[50];CallDepth@1000000007 : Integer);
    VAR
      UserSetup@1000000002 : Record 91;
      NotEnty@1000000001 : Record 1511;
      UidReceiver@1000000005 : Code[50];
    BEGIN
      //My Task - status changed
      //(Not if changed by myself)
      UidReceiver := GetReceiverUid(Task."CM Assigned User ID", SecondaryUid);
      CheckNotificationSubstitutionAndCopy(6, UidReceiver, Workorder, Task, CallDepth);
      IF NOT NotificationPrecheck(6, UidReceiver, SecondaryUid, Type, UserSetup) THEN
        EXIT;

      NotEnty.INIT;
      NotEnty."CM Type" := NotEnty."CM Type"::"My Task - status changed";
      NotEnty."CM Subject 1" := 'Someone has changed the Status of a Task that has been assigned to you.';
      ModifySubject(NotEnty."CM Subject 1", Type);
      CreateFlowNotification(NotEnty, UserSetup, Workorder, Task, 1);
    END;

    PROCEDURE CountNotifications@1000000069(Uid@1000000002 : Code[50]) : Integer;
    VAR
      UserSetup@1000000000 : Record 91;
      c@1000000001 : Integer;
    BEGIN
      IF NOT UserSetup.GET(Uid) THEN
        UserSetup.INIT;

      IF NOT UserSetup."CM Notifications" THEN
        EXIT(0);

      IF UserSetup."CM Notification 1" THEN c += 1;
      IF UserSetup."CM Notification 2" THEN c += 1;
      IF UserSetup."CM Notification 3" THEN c += 1;
      IF UserSetup."CM Notification 4" THEN c += 1;
      IF UserSetup."CM Notification 5" THEN c += 1;
      IF UserSetup."CM Notification 6" THEN c += 1;

      EXIT(c);
    END;

    LOCAL PROCEDURE GetReceiverUid@1000000071(Uid1@1000000000 : Code[50];Uid2@1000000001 : Code[50]) : Code[50];
    BEGIN
      IF Uid2 <> '' THEN
        EXIT(Uid2);
      EXIT(Uid1);
    END;

    LOCAL PROCEDURE ModifySubject@1000000075(VAR Subject@1000000000 : Text;Type@1000000001 : 'normal,substitution,copy');
    BEGIN
      IF Type = Type::substitution THEN
        Subject += ' (substitution)';
      IF Type = Type::copy THEN
        Subject += ' (copy)';
    END;

    PROCEDURE "### SPECIAL ###"@1000000034();
    BEGIN
    END;

    PROCEDURE SetKeyOpimization@1000000048(value@1000000000 : Boolean);
    BEGIN
      DisableKeyOptimization := NOT value;
    END;

    PROCEDURE xStart@1000000057();
    BEGIN
      Starttime := TIME;
    END;

    PROCEDURE xEnd@1000000058(Mode@1000000000 : 'Return,Message,Error') : Duration;
    VAR
      Dur@1000000001 : Duration;
    BEGIN
      Dur := TIME - Starttime;

      CASE Mode OF
        Mode::Message : MESSAGE('Execution duration: %1', Dur);
        Mode::Error : ERROR('Execution duration: %1', Dur);
      END;

      EXIT(Dur);
    END;

    PROCEDURE "### PURCH ORDER ###"@1000000050();
    BEGIN
    END;

    [EventSubscriber(Table,38,OnBeforeInsertEvent)]
    LOCAL PROCEDURE PurchOrderOnBeforeInsert@1000000055(VAR Rec@1000000000 : Record 38;RunTrigger@1000000001 : Boolean);
    VAR
      CMGenSetup@1000000002 : Record 70000;
    BEGIN
      IF (Rec."Document Type" <> Rec."Document Type"::Order) OR (NOT Rec."CM Is CMMS Purchase Order") THEN
        EXIT;

      CheckCMMSPurchOrderAllowed();

      CMGenSetup.GET();

      Rec."IG Status Code" := CMGenSetup."CMMS PO Initial Status";
      Rec.VALIDATE("Buy-from Vendor No.", CMGenSetup."CMMS PO Default Vendor");
      Rec."Buy-from Vendor Name" := '';
      Rec."Buy-from Vendor Name 2" := '';
      Rec."Buy-from Address" := '';
      Rec."Buy-from Address 2" := '';
      Rec."Buy-from City" := '';
      Rec."Buy-from Post Code" := '';
      Rec."Buy-from Country/Region Code" := '';
      Rec.VALIDATE("Assigned User ID", USERID);
    END;

    PROCEDURE CMVendorNoOnValidate@1000000051(VAR Rec@1000000002 : Record 38);
    VAR
      Vendor@1000000001 : Record 23;
      Comp@1000000000 : Text[30];
      PaymentTermsComp@1000000007 : Record 3;
      PaymentTerms@1000000006 : Record 3;
      GLSetupComp@1000000005 : Record 98;
      GLSetup@1000000004 : Record 98;
      CurrCode@1000000003 : Code[20];
    BEGIN
      IF Rec."CM Vendor No." = '' THEN
        EXIT;

      IF Rec."Buy-from Vendor No." = '' THEN
        ERROR(Text019);

      GetVendorCompany(Rec, Vendor, Comp);

      IF (NOT Vendor.GET(Rec."CM Vendor No."))THEN
        ERROR(STRSUBSTNO(Text018, Rec."CM Vendor No.", Comp));
      Vendor.TESTFIELD(Blocked, Vendor.Blocked::" ");

      Rec."Posting Description" := COPYSTR(Vendor."No." + ' ' + Vendor.Name , 1, 50);
      Rec."Buy-from Vendor Name" := Vendor.Name;
      Rec."Buy-from Vendor Name 2" := Vendor."Name 2";
      Rec."Buy-from Address" := Vendor.Address;
      Rec."Buy-from Address 2" := Vendor."Address 2";
      Rec."Buy-from City" := Vendor.City;
      Rec."Buy-from Post Code" := Vendor."Post Code";
      Rec."Buy-from Country/Region Code" := Vendor."Country/Region Code";
      Rec.VALIDATE("Gen. Bus. Posting Group", Vendor."Gen. Bus. Posting Group");
      Rec.VALIDATE("VAT Bus. Posting Group", Vendor."VAT Bus. Posting Group");

      //Payment Terms
      CLEAR(PaymentTermsComp);
      PaymentTermsComp.RESET;
      PaymentTermsComp.CHANGECOMPANY(Comp);
      IF NOT PaymentTermsComp.GET(Vendor."Payment Terms Code") THEN
        ;

      IF (PaymentTermsComp.Code <> '') AND (NOT PaymentTerms.GET(PaymentTermsComp.Code)) THEN BEGIN
        PaymentTerms.INIT;
        PaymentTerms.TRANSFERFIELDS(PaymentTermsComp, TRUE);
        PaymentTerms.INSERT(TRUE);
      END;

      Rec.VALIDATE("Payment Terms Code", PaymentTerms.Code);

      //Currency
      CurrCode := '';
      IF Vendor."Currency Code" = '' THEN BEGIN
        CLEAR(GLSetupComp);
        GLSetupComp.RESET;
        GLSetupComp.CHANGECOMPANY(Comp);
        IF NOT GLSetupComp.GET() THEN
          GLSetupComp.INIT;

        IF NOT GLSetup.GET() THEN
          GLSetup.INIT;

        IF (GLSetupComp."LCY Code" = GLSetup."LCY Code") THEN
          CurrCode := ''
        ELSE
          CurrCode := GLSetupComp."LCY Code";
      END
      ELSE BEGIN
        CurrCode := Vendor."Currency Code";
      END;

      Rec.VALIDATE("Currency Code", CurrCode);
    END;

    PROCEDURE CMVendorNoOnLookup@1000000052(VAR Rec@1000000000 : Record 38);
    VAR
      Vendor@1000000002 : Record 23;
      Comp@1000000001 : Text[30];
      VendorListPage@1000000003 : Page 27;
    BEGIN
      IF Rec."Buy-from Vendor No." = '' THEN
        ERROR(Text019);

      //Vendor No.
      GetVendorCompany(Rec, Vendor, Comp);
      Vendor.SETRANGE(Blocked, Vendor.Blocked::" ");

      VendorListPage.LOOKUPMODE(TRUE);
      VendorListPage.CMSetCompany(Comp);
      VendorListPage.SETTABLEVIEW(Vendor);
      IF VendorListPage.RUNMODAL() <> ACTION::LookupOK THEN
        EXIT;

      VendorListPage.GETRECORD(Vendor);
      Rec.VALIDATE("CM Vendor No.", Vendor."No.");
    END;

    PROCEDURE CMCompanyOnValidate@1000000059(VAR Rec@1000000000 : Record 38);
    VAR
      ENCGenSetup@1000000001 : Record 50001;
    BEGIN
      IF Rec."CM Company" = '' THEN
        EXIT;

      Rec.VALIDATE("CM Vendor No.", '');

      CLEAR(ENCGenSetup);
      ENCGenSetup.RESET;
      ENCGenSetup.CHANGECOMPANY(Rec."CM Company");
      IF NOT ENCGenSetup.GET() THEN
        ENCGenSetup.INIT;

      ENCGenSetup.TESTFIELD("Company Code");
      Rec.VALIDATE("Responsibility Center", ENCGenSetup."Company Code");
    END;

    LOCAL PROCEDURE GetVendorCompany@1000000053(Rec@1000000002 : Record 38;VAR Vendor@1000000001 : Record 23;VAR Comp@1000000000 : Text[30]);
    BEGIN
      IF Rec."CM Company" <> '' THEN
        Comp := Rec."CM Company"
      ELSE
        Comp := COMPANYNAME;

      CLEAR(Vendor);
      Vendor.RESET;
      Vendor.CHANGECOMPANY(Comp);
    END;

    PROCEDURE CheckCMMSPurchOrderAllowed@1000000054();
    VAR
      CMGenSetup@1000000000 : Record 70000;
    BEGIN
      IF NOT CMGenSetup.GET() THEN
        CMGenSetup.INIT();

      CMGenSetup.TESTFIELD("Allow CMMS Purch. Orders");
      CMGenSetup.TESTFIELD("CMMS PO Default Vendor");
    END;

    PROCEDURE SetRespCenterFilter@1000000056(VAR Rec@1000000000 : Record 38);
    VAR
      UserSetup@1000000001 : Record 91;
      RespFilter@1000000002 : Text;
    BEGIN
      IF NOT UserSetup.GET(USERID) THEN
        UserSetup.INIT;

      Rec.FILTERGROUP(-1);
      IF UserSetup."IG PO Resp. Ctr. Filter" <> '' THEN
        Rec.SETFILTER("Responsibility Center", UserSetup."IG PO Resp. Ctr. Filter");
      Rec.SETRANGE("Assigned User ID", USERID);
      IF Rec.FIND('-') THEN BEGIN
        REPEAT
          Rec.MARK(TRUE);
        UNTIL Rec.NEXT = 0;

      END;
      Rec.FILTERGROUP(0);
      Rec.MARKEDONLY(TRUE);
    END;

    PROCEDURE SetReleasedProcessingStatus@1000000076(VAR PurchaseHeader@1000000000 : Record 38);
    VAR
      CMGenSetup@1000000001 : Record 70000;
      IGStatusMgt@1000000002 : Codeunit 50007;
    BEGIN
      IF (NOT CMGenSetup.GET) OR
         (NOT CMGenSetup."Allow CMMS Purch. Orders") OR
         (CMGenSetup."CMMS PO Status Sequence" = '') OR
         (CMGenSetup."CMMS PO Released Status" = '') OR
         (NOT PurchaseHeader."CM Is CMMS Purchase Order")THEN
        EXIT;


      IGStatusMgt.ChangeStatus
      (
        PurchaseHeader."IG Status Code",
        CMGenSetup."CMMS PO Released Status",
        CMGenSetup."CMMS PO Status Sequence",
        PurchaseHeader."No.",
        PurchaseHeader.RECORDID,
        FALSE
      );

      PurchaseHeader.MODIFY(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70010 CMMS User Access Management
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=13:42:08;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      CMAssetComponent@1000000000 : Record 70025;
      Text001@1000000002 : TextConst 'ENU=The setup of Departments creates an infinate loop!;DEA=Die Einrichtung der Abteilungen bildet einen Endlosschleife!';
      Text002@1000000001 : TextConst 'ENU=You have no permission to perform this activity.;DEA=Sie haben keine Berechtigung zum Durchfhren dieser Aktion.';

    PROCEDURE UserAllAccess@1000000007(VAR Rec@1000000001 : Record 70020) : Boolean;
    VAR
      UserSetup@1000000000 : Record 91;
    BEGIN
      IF NOT UserSetup.GET(USERID) THEN UserSetup.INIT;

      IF (UserSetup."IG Asset Administrator") AND (Rec.Objecttype = Rec.Objecttype::Asset) THEN
        EXIT(TRUE);

      IF (UserSetup."IG Project Administrator") AND (Rec.Objecttype = Rec.Objecttype::Project) THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    PROCEDURE SetEditable@1000000000(RecRef@1000000000 : RecordRef;VAR FunctionArray@1000000002 : ARRAY [1000] OF Boolean;VAR GroupArray@1000000004 : ARRAY [1000] OF Boolean;VAR FieldArray@1000000001 : ARRAY [1000] OF Boolean);
    VAR
      i@1000000003 : Integer;
    BEGIN
      CASE RecRef.NUMBER OF
      70025: {CM EQPT Hierarchy}
        BEGIN
          {Set all rights to false}
          FOR i := 1 TO 1000 DO
            BEGIN
              //FunctionArray[i] := FALSE;
              //GroupArray[i] := FALSE;
              FieldArray[i] := FALSE;
            END;

          RecRef.SETTABLE(CMAssetComponent);
          IF CMAssetComponent."Line Type" = CMAssetComponent."Line Type"::Line THEN BEGIN
            //Defaults
            FieldArray[5] := TRUE;

            CASE CMAssetComponent."Component Type" OF
              CMAssetComponent."Component Type"::Modules:
                BEGIN
                  FieldArray[1] := TRUE;
                END;
              CMAssetComponent."Component Type"::Inverter:
                BEGIN
                  FieldArray[2] := TRUE;
                END;
              CMAssetComponent."Component Type"::"Combiner Box",
              CMAssetComponent."Component Type"::Sensor,
              CMAssetComponent."Component Type"::"Monitoring Hardware",
              CMAssetComponent."Component Type"::"Internet Connection HW",
              CMAssetComponent."Component Type"::"Security System",
              CMAssetComponent."Component Type"::Meters,
              CMAssetComponent."Component Type"::Transformer,
              CMAssetComponent."Component Type"::Switchgear:
                BEGIN
                  FieldArray[3] := TRUE;
                END;
              CMAssetComponent."Component Type"::Others:
                 BEGIN
                  FieldArray[4] := TRUE;
                END;
              CMAssetComponent."Component Type"::"Remote Access Details" :
                BEGIN
                  FieldArray[5] := FALSE;
                  FieldArray[6] := TRUE;
                END;
            END;
          END;
        END;
      END;
    END;

    PROCEDURE GetAssetRespFilter@6() : Text;
    VAR
      UserRespCenter@1000000001 : Text;
      HasGotUserSetup@1000000000 : Boolean;
      UserSetup@1000000002 : Record 91;
    BEGIN
      CLEAR(UserRespCenter);
      IF NOT HasGotUserSetup THEN BEGIN
        IF UserSetup.GET(USERID) AND (USERID <> '') THEN
          IF UserSetup."IG Asset Resp. Ctr. Filter" <> '' THEN
            UserRespCenter := UserSetup."IG Asset Resp. Ctr. Filter";
        HasGotUserSetup := TRUE;
      END;
      EXIT(UserRespCenter);
    END;

    PROCEDURE GetProjectRespFilter@1000000006() : Text;
    VAR
      UserRespCenter@1000000001 : Text;
      HasGotUserSetup@1000000000 : Boolean;
      UserSetup@1000000002 : Record 91;
    BEGIN
      CLEAR(UserRespCenter);
      IF NOT HasGotUserSetup THEN BEGIN
        IF UserSetup.GET(USERID) AND (USERID <> '') THEN
          IF UserSetup."IG Project Resp. Ctr. Filter" <> '' THEN
            UserRespCenter := UserSetup."IG Project Resp. Ctr. Filter";
        HasGotUserSetup := TRUE;
      END;
      EXIT(UserRespCenter);
    END;

    PROCEDURE ChangeOperationalStatusAllowed@1000000009(ShowError@1000000000 : Boolean) : Boolean;
    VAR
      UserSetup@1000000001 : Record 91;
    BEGIN
      IF NOT UserSetup.GET(USERID) THEN
        UserSetup.INIT();

      IF (ShowError) AND (NOT UserSetup."CM Change Oper. Status Allowed") THEN
        ERROR(Text002);

      EXIT(UserSetup."CM Change Oper. Status Allowed");
    END;

    PROCEDURE ___DEPARTMENT___@1000000001();
    BEGIN
    END;

    PROCEDURE GetSubordinatedUsers@1000000002(Uid@1000000000 : Code[50];Company@1000000003 : Text[30];GetInactiveUsers@1000000008 : Boolean;PerDepartment@1000000009 : Boolean;VAR TempDepartmentTeam@1000000001 : TEMPORARY Record 70010);
    VAR
      DepartmentTeam@1000000002 : Record 70010;
      DepartmentTeam2@1000000004 : Record 70010;
      UserSetup@1000000006 : Record 91;
      IsAdmin@1000000005 : Boolean;
      User@1000000007 : Record 2000000120;
    BEGIN
      {
        PARAMS:
          PerDepartment:
            TRUE: If a user is part of more departments, more records for this user (with department code) will be returned.
            FALSE: If a user is part of more departments, only one records for this user (with no departmetn code) will be returned.
      }
      IsAdmin := ((UserSetup.GET(Uid)) AND (UserSetup."CM User Admin"));

      CLEAR(TempDepartmentTeam);
      TempDepartmentTeam.RESET;
      TempDepartmentTeam.DELETEALL(FALSE);

      //Admin gets all Users
      IF IsAdmin THEN BEGIN
        User.RESET;
        IF NOT GetInactiveUsers THEN
          User.SETRANGE(State, User.State::Enabled);
        IF User.FIND('-') THEN BEGIN
          REPEAT
            TempDepartmentTeam.INIT;
            TempDepartmentTeam.Type := TempDepartmentTeam.Type::User;
            TempDepartmentTeam.Code := User."User Name";
            TempDepartmentTeam."Belongs To Department Code" := '';
            TempDepartmentTeam.INSERT(FALSE);
          UNTIL User.NEXT = 0;
        END;

        EXIT;
      END;

      //Always insert own user
      TempDepartmentTeam.INIT;
      TempDepartmentTeam.Type := TempDepartmentTeam.Type::User;
      TempDepartmentTeam.Code := Uid;
      TempDepartmentTeam."Belongs To Department Code" := '';
      TempDepartmentTeam.INSERT(FALSE);

      DepartmentTeam.RESET;
      DepartmentTeam.SETRANGE(Type, DepartmentTeam.Type::User);
      DepartmentTeam.SETRANGE(Code, Uid);
      IF DepartmentTeam.FIND('-') THEN BEGIN
        REPEAT
          IF DepartmentTeam."User Role" = DepartmentTeam."User Role"::Leader THEN
            GetDepartmentUsers(DepartmentTeam."Belongs To Department Code", Company, GetInactiveUsers, PerDepartment, TempDepartmentTeam);

          GetSubordinateUsersRecursive(DepartmentTeam."Belongs To Department Code", Company, GetInactiveUsers, PerDepartment, TempDepartmentTeam, 1);
        UNTIL DepartmentTeam.NEXT = 0;
      END;
    END;

    PROCEDURE GetSubordinatedUsersFilter@1000000003(Uid@1000000001 : Code[50];Company@1000000000 : Text[30];GetInactiveUsers@1000000006 : Boolean) : Text;
    VAR
      Result@1000000002 : Text;
      TempDepartmentTeam@1000000003 : TEMPORARY Record 70010;
      UserSetup@1000000004 : Record 91;
      IsAdmin@1000000005 : Boolean;
    BEGIN
      Result := '';
      IsAdmin := ((UserSetup.GET(Uid)) AND (UserSetup."CM User Admin"));

      IF IsAdmin THEN
        EXIT(''); //Exit Empty

      GetSubordinatedUsers(Uid, Company, GetInactiveUsers, FALSE, TempDepartmentTeam);
      IF TempDepartmentTeam.FIND('-') THEN BEGIN
        REPEAT
          Result += (TempDepartmentTeam.Code + '|');
        UNTIL TempDepartmentTeam.NEXT = 0;
        Result := COPYSTR(Result,1,STRLEN(Result) - 1);
      END;

      EXIT(Result);
    END;

    LOCAL PROCEDURE GetSubordinateUsersRecursive@1000000005(DepartmentCode@1000000001 : Code[20];Company@1000000003 : Text[30];GetInactiveUsers@1000000004 : Boolean;PerDepartment@1000000006 : Boolean;VAR TempDepartmentTeam@1000000000 : TEMPORARY Record 70010;Depth@1000000005 : Integer);
    VAR
      DepartmentTeam@1000000002 : Record 70010;
    BEGIN
      IF Depth >= 16 THEN
        ERROR(Text001);

      DepartmentTeam.SETRANGE(Type, DepartmentTeam.Type::Department);
      DepartmentTeam.SETRANGE("Belongs To Department Code", DepartmentCode);
      IF DepartmentTeam.FIND('-') THEN BEGIN
        REPEAT
          GetDepartmentUsers(DepartmentTeam.Code, Company, GetInactiveUsers, PerDepartment, TempDepartmentTeam);
          GetSubordinateUsersRecursive(DepartmentTeam.Code, Company, GetInactiveUsers, PerDepartment, TempDepartmentTeam, Depth + 1); //Recursion
        UNTIL DepartmentTeam.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetDepartmentUsers@1000000008(DepartmentCode@1000000001 : Code[20];Company@1000000003 : Text[30];GetInactiveUsers@1000000005 : Boolean;PerDepartment@1000000006 : Boolean;VAR TempDepartmentTeam@1000000000 : TEMPORARY Record 70010);
    VAR
      DepartmentTeam@1000000002 : Record 70010;
      User@1000000004 : Record 2000000120;
    BEGIN
      DepartmentTeam.SETRANGE(Type, DepartmentTeam.Type::User);
      DepartmentTeam.SETRANGE("Belongs To Department Code", DepartmentCode);
      IF DepartmentTeam.FIND('-') THEN BEGIN
        REPEAT
          DepartmentTeam.CALCFIELDS("Belongs To Department Comany");
          IF(DepartmentTeam."Belongs To Department Comany" = '') OR (Company = DepartmentTeam."Belongs To Department Comany") THEN BEGIN
              User.RESET;
              User.SETCURRENTKEY("User Name");
              User.SETRANGE("User Name", DepartmentTeam.Code);
              IF NOT GetInactiveUsers THEN
                User.SETRANGE(State, User.State::Enabled);
              User.FINDFIRST();

              TempDepartmentTeam.INIT;
              TempDepartmentTeam.Type := TempDepartmentTeam.Type::User;
              TempDepartmentTeam.Code := DepartmentTeam.Code;
              IF PerDepartment THEN
                TempDepartmentTeam."Belongs To Department Code" := DepartmentTeam."Belongs To Department Code" //++here
              ELSE
                TempDepartmentTeam."Belongs To Department Code" := '';
              TempDepartmentTeam."User Role" := 0;
              IF NOT TempDepartmentTeam.INSERT(FALSE) THEN
                ;
          END;
        UNTIL DepartmentTeam.NEXT = 0;
      END;
    END;

    PROCEDURE DepartmentTeamContains@1000000004(VAR TempDepartmentTeam@1000000000 : TEMPORARY Record 70010;Uid@1000000001 : Code[50]) : Boolean;
    BEGIN
      TempDepartmentTeam.SETRANGE(Type, TempDepartmentTeam.Type::User);
      TempDepartmentTeam.SETRANGE(Code, Uid);
      EXIT(TempDepartmentTeam.FINDFIRST());
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70020 CMMS Asset Management
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=15:28:27;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Permissions=TableData 349=rimd,
                TableData 5050=rimd;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Only Assets with Status "%1" can be released!;DEA=Nur Anlagen im Status "%1" k”nnen freigegeben werden!';
      Text002@1000000001 : TextConst 'ENU=Only Assets with Status "%1" or "%2" can be released!;DEA=Nur Anlagen im Status "%1" oder "%2" k”nnen freigegeben werden!';
      CMGenMgt@1000000002 : Codeunit 70000;
      LogEntry@1000000003 : Record 5065;
      Text003@1000000004 : TextConst 'ENU=%1 Record(s) updated, %2 invalid.;DEA=%1 Datens„tz(e) aktualisiert, %2 ungltig(e).';
      IsNew@1000000005 : Boolean;
      Text004@1000000006 : TextConst 'ENU=Please enter valid coordinates!;DEA=Bitte tragen Sie gltige Koordinaten ein!';
      Text005@1000000007 : TextConst 'ENU=Execution terminated!;DEA=Die Verarbeitung wurde abgebrochen!';
      Text006@1000000008 : TextConst 'ENU=From "%1" to "%2"';

    PROCEDURE SearchAsset@1000000000(VAR Rec@1000000004 : Record 70020);
    VAR
      Page@1000000001 : Page 70019;
      SearchInArray@1000000000 : ARRAY [16] OF Boolean;
    BEGIN
      Page.LOOKUPMODE := TRUE;
      IF Page.RUNMODAL() <> ACTION::LookupOK THEN
        EXIT;

      Page.GetSearchInArray(SearchInArray);
      SearchAssetByTerm(Rec,Page.GetSearchTerm(), SearchInArray);
    END;

    PROCEDURE ClearAssetSearch@1000000028(Type@1000000000 : '0,1';VAR Rec@1000000004 : Record 70020);
    VAR
      Page@1000000001 : Page 70019;
    BEGIN
      {0 = Asset, 1 = Project}
      Rec.CLEARMARKS();
      Rec.MARKEDONLY(FALSE);

      {Set Filter}
      CMGenMgt.SetFilterUniversalLookup(Type,'','','','',Rec);
      IF Rec.FINDFIRST() THEN;
    END;

    LOCAL PROCEDURE SearchAssetByTerm@1000000001(VAR Rec@1000000000 : Record 70020;SearchTerm@1000000001 : Text[30];SearchInArray@1000000005 : ARRAY [16] OF Boolean);
    VAR
      DotNetString@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.String" SUPPRESSDISPOSE;
      AssetCustomer@1000000003 : Record 70021;
      Text@1000000006 : Text;
      Rec2@1000000004 : Record 70020;
    BEGIN
      //Search In Array:
      //1 Address
      //2 No
      //3 MainAssetNo
      //4 NameName2
      //5 CustomerNo
      //6 CustomerName
      //7 CustomerCompChain
      //8 City

      IF SearchTerm = '' THEN
        EXIT;

      //IF RefreshCustomerNames THEN
        //ReloadCustomerNames(Rec,'',TRUE);

      SearchTerm := LOWERCASE(SearchTerm);
      //Rec.MARKEDONLY(FALSE);
      //Rec.CLEARMARKS;

      Rec2.COPY(Rec);
      CLEAR(Rec);
      IF Rec2.FIND('-') THEN BEGIN
        REPEAT
          Text := '';

          IF SearchInArray[1] THEN
            Text += Rec2.Address + Rec2."Extended Address";
          IF SearchInArray[2] THEN
            Text += Rec2."No.";
          IF SearchInArray[3] THEN
            Text += Rec2."Main Asset No.";
          IF SearchInArray[4] THEN
            Text += Rec2.Name + Rec2."Name 2";

          IF (SearchInArray[5]) OR (SearchInArray[6]) OR (SearchInArray[7]) THEN BEGIN
            AssetCustomer.SETRANGE(Objecttype, GetObjecttype(Rec2));
            AssetCustomer.SETRANGE(Type, AssetCustomer.Type::Customer);
            AssetCustomer.SETRANGE(Key1, Rec2."No.");
            AssetCustomer.SETFILTER(Key3, '<>%1', '');
            IF AssetCustomer.FIND('-') THEN BEGIN
              REPEAT
                IF SearchInArray[5] THEN
                  Text += AssetCustomer.Key3;
                IF SearchInArray[6] THEN
                  Text += AssetCustomer."Customer Name";
                IF SearchInArray[7] THEN
                  Text += AssetCustomer."Customer Company Chain";
              UNTIL AssetCustomer.NEXT = 0;
            END;
          END;

          IF SearchInArray[8] THEN
            Text += Rec2.City;

          DotNetString := LOWERCASE(Text);
          IF DotNetString.Contains(FORMAT(SearchTerm)) THEN BEGIN
            Rec.GET(Rec2.Objecttype, Rec2."No.");
            Rec.MARK(TRUE);
          END;

        UNTIL Rec2.NEXT = 0;
      END;

      Rec.MARKEDONLY(TRUE);
    END;

    PROCEDURE ChangeStatus@1000000026(VAR Rec@1000000000 : Record 70020);
    VAR
      ChangeStatusPage@1000000001 : Page 70003;
      OldStatusText@1000000004 : Text;
      OldStatus@1000000003 : Integer;
      CMUserAccMgt@1000000002 : Codeunit 70010;
    BEGIN
      CMUserAccMgt.ChangeOperationalStatusAllowed(TRUE);

      OldStatus := Rec."Operational Status";
      OldStatusText := FORMAT(Rec."Operational Status");

      ChangeStatusPage.Set(Rec);
      IF ChangeStatusPage.RUNMODAL = ACTION::Yes THEN BEGIN
        Rec."Operational Status" := ChangeStatusPage.GetStatus();
        Rec.MODIFY(FALSE);
      END;

      IF OldStatus <> Rec."Operational Status" THEN
        CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::"Status Change", FORMAT(Rec."Operational Status"), ChangeStatusPage.GetComment());
    END;

    LOCAL PROCEDURE URLEncode@10(InText@1000 : Text) : Text;
    VAR
      SystemWebHttpUtility@1001 : DotNet "'System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.System.Web.HttpUtility";
    BEGIN
      SystemWebHttpUtility := SystemWebHttpUtility.HttpUtility;
      EXIT(COPYSTR(SystemWebHttpUtility.UrlEncode(InText),1,MAXSTRLEN(InText)));
    END;

    LOCAL PROCEDURE SubstituteParameters@8(VAR url@1000 : Text;Parameters@1001 : ARRAY [12] OF Text[50]);
    VAR
      ParameterName@1004 : Text;
      parameterNumber@1002 : Integer;
      ParmPos@1003 : Integer;
    BEGIN
      FOR parameterNumber := 1 TO ARRAYLEN(Parameters) DO BEGIN
        ParameterName := STRSUBSTNO('{%1}',parameterNumber);
        ParmPos := STRPOS(url,ParameterName);

        IF ParmPos > 1 THEN
          url :=
            COPYSTR(
              COPYSTR(url,1,ParmPos - 1) + Parameters[parameterNumber] + COPYSTR(url,ParmPos + STRLEN(ParameterName)),
              1,MAXSTRLEN(url));
      END;
    END;

    LOCAL PROCEDURE GetCultureInfo@9() : Text[30];
    VAR
      CultureInfo@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Globalization.CultureInfo";
    BEGIN
      CultureInfo := CultureInfo.CultureInfo(WINDOWSLANGUAGE);
      EXIT(COPYSTR(CultureInfo.ToString,1,30));
    END;

    PROCEDURE ReloadCustomerNames@1000000008(VAR Rec@1000000006 : Record 70020;AssetNoFilter@1000000005 : Text;ShowResultMessage@1000000004 : Boolean);
    VAR
      AssetCustomer@1000000000 : Record 70021;
      Customer@1000000001 : Record 18;
      Updated@1000000002 : Integer;
      Invalid@1000000003 : Integer;
    BEGIN
      Updated := 0;
      Invalid := 0;

      AssetCustomer.RESET;
      AssetCustomer.SETCURRENTKEY(Objecttype,Type,Key3,Key1);
      AssetCustomer.SETRANGE(Objecttype, GetObjecttype(Rec));
      AssetCustomer.SETRANGE(Type, AssetCustomer.Type::Customer);
      AssetCustomer.SETFILTER(Key3, '<>%1', '');
      IF AssetNoFilter <> '' THEN
        AssetCustomer.SETFILTER(Key1, '%1', AssetNoFilter);
      IF AssetCustomer.FIND('-') THEN BEGIN
        REPEAT
          CLEAR(Customer);
          Customer.RESET;
          Customer.CHANGECOMPANY(AssetCustomer.GetObjectCompanyName());
          IF Customer.GET(AssetCustomer.Key3) THEN BEGIN
            IF Customer.Name <> AssetCustomer."Customer Name" THEN BEGIN
              AssetCustomer."Customer Name" := Customer.Name;
              AssetCustomer."Customer Company Chain" := Customer."Chain Name";
              Updated += 1;
            END;
            AssetCustomer."Customer No. Invalid" := FALSE;
          END
          ELSE BEGIN
            AssetCustomer."Customer No. Invalid" := TRUE;
            Invalid += 1;
          END;

          AssetCustomer.MODIFY(FALSE);
        UNTIL AssetCustomer.NEXT = 0;
      END;

      IF ShowResultMessage THEN
        MESSAGE(STRSUBSTNO(Text003, Updated, Invalid));
    END;

    PROCEDURE "### Show Pages ####"@1000000003();
    BEGIN
    END;

    PROCEDURE ShowMapByAddress@1000000004(Rec@1000000000 : Record 70020);
    VAR
      MapParamSetup@1000000002 : Record 801;
      MapMgt@1000000001 : Codeunit 802;
      ParametersArray12@1000000003 : ARRAY [12] OF Text[160];
      CMGSetup@1000000004 : Record 70000;
      Url@1000000005 : Text;
      i@1000000006 : Integer;
    BEGIN
      CMGSetup.GET();
      CMGSetup.TESTFIELD("Map Setup (Address)");
      MapParamSetup.GET(CMGSetup."Map Setup (Address)");
      Rec.CALCFIELDS("Country/Region Name");

      //Get Parameters
      CLEAR(ParametersArray12);
      ParametersArray12[1] := Rec.Address;
      ParametersArray12[2] := Rec.City;
      ParametersArray12[4] := Rec."Post Code";
      ParametersArray12[5] := Rec."Country Code";
      ParametersArray12[6] := Rec."Country/Region Name";
      ParametersArray12[7] := GetCultureInfo();

      //Url Encode
      IF MapParamSetup."URL Encode Non-ASCII Chars" THEN
        FOR i := 1 TO ARRAYLEN(ParametersArray12) DO
          ParametersArray12[i] := URLEncode(ParametersArray12[i]);

      Url := MapParamSetup."Map Service";
      SubstituteParameters(Url, ParametersArray12);

      HYPERLINK(Url);
    END;

    PROCEDURE ShowMapByCoordinates@1000000005(Rec@1000000000 : Record 70020);
    VAR
      MapParamSetup@1000000006 : Record 801;
      MapMgt@1000000005 : Codeunit 802;
      ParametersArray12@1000000004 : ARRAY [12] OF Text[50];
      CMGSetup@1000000003 : Record 70000;
      Url@1000000002 : Text;
      i@1000000001 : Integer;
    BEGIN
      IF (Rec."Coordinates Longitude" = 0) OR (Rec."Coordinates Latitude" = 0) THEN
        ERROR(Text004);

      IF NOT CMGSetup.GET() THEN
        CMGSetup.INIT;

      CMGSetup.TESTFIELD("Map Setup (Coordinates)");
      MapParamSetup.GET(CMGSetup."Map Setup (Coordinates)");

      ParametersArray12[1] := CONVERTSTR(FORMAT(Rec."Coordinates Latitude"),'.',',');
      ParametersArray12[2] := CONVERTSTR(FORMAT(Rec."Coordinates Longitude"),'.',',');
      ParametersArray12[3] := Rec.Name;

      //Url Encode
      IF MapParamSetup."URL Encode Non-ASCII Chars" THEN
        FOR i := 1 TO ARRAYLEN(ParametersArray12) DO
          ParametersArray12[i] := URLEncode(ParametersArray12[i]);

      Url := MapParamSetup."Map Service";
      SubstituteParameters(Url, ParametersArray12);

      HYPERLINK(Url);
    END;

    PROCEDURE ShowAddressCard@1000000027(Rec@1000000000 : Record 70020);
    VAR
      CardPage@1000000001 : Page 70057;
    BEGIN
      IF Rec."No." = '' THEN EXIT;

      CardPage.SETRECORD(Rec);
      CardPage.SETTABLEVIEW(Rec);
      CardPage.LOOKUPMODE := FALSE;
      CardPage.RUNMODAL();
    END;

    PROCEDURE ShowRelatedCustomers@1000000002(VAR Rec@1000000000 : Record 70020);
    VAR
      ListPage@1000000001 : Page 70051;
      Rec2@1000000002 : Record 70021;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, GetObjecttype(Rec));
      Rec2.SETRANGE(Type, Rec2.Type::Customer);
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE(Key1, Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedLogs@1000000007(VAR Rec@1000000000 : Record 70020;Type@1000000003 : 'All,Status,Read,Internal,External');
    VAR
      Rec2@1000000001 : Record 5065;
      ListPage@1000000002 : Page 70111;
    BEGIN
      { Type = All,Status,Read,Internal,External}

      Rec2.RESET;
      Rec2.SETCURRENTKEY("CM Is CMMS Log Entry","CM Objecttype","CM Object No.");
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE("CM Is CMMS Log Entry", TRUE);
      CASE Type OF
        Type::Status:
          BEGIN
          Rec2.SETRANGE("CM Log Type",Rec2."CM Log Type"::"Status Change");
          Rec2.SETRANGE("CM Source",Rec2."CM Source"::"Asset/Project");
          END;
        Type::Read:
          BEGIN
          Rec2.SETRANGE("CM Log Type",Rec2."CM Log Type"::Read);
          Rec2.SETRANGE("CM Source",Rec2."CM Source"::"Asset/Project");
          END;
        Type::Internal:
          BEGIN
            Rec2.SETFILTER("CM Log Type",'<>%1&<>%2',
              Rec2."CM Log Type"::"Status Change",
              Rec2."CM Log Type"::Read);
          END;
        Type::External:
          BEGIN
            Rec2.SETFILTER("CM Log Type",'<>%1&<>%2',
              Rec2."CM Log Type"::"Status Change",
              Rec2."CM Log Type"::Read);
            Rec2.SETRANGE("CM Internal",FALSE);
          END;
      END;
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE("CM Objecttype", Rec.Objecttype);
      Rec2.SETRANGE("CM Object No.", Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedUserroles@1000000010(VAR Rec@1000000000 : Record 70020);
    VAR
      Rec2@1000000001 : Record 70021;
      ListPage@1000000002 : Page 70053;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, GetObjecttype(Rec));
      Rec2.SETRANGE(Type, Rec2.Type::User);
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE(Key1, Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedSubAssets@1000000009(VAR Rec@1000000000 : Record 70020);
    VAR
      Rec2@1000000001 : Record 70021;
      ListPage@1000000002 : Page 70050;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, GetObjecttype(Rec));
      Rec2.SETRANGE(Type, Rec2.Type::SubAsset);
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE(Key1, Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedAssetsProjects@1000000011(VAR Rec@1000000000 : Record 70020);
    VAR
      Rec2@1000000001 : Record 70021;
      ListPage@1000000002 : Page 70054;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      //Rec2.SETRANGE(Objecttype, GetObjecttype(Rec));
      Rec2.SETRANGE(Type, Rec2.Type::Project);
      Rec2.FILTERGROUP(0);

      IF Rec.Objecttype = Rec.Objecttype::Asset THEN BEGIN
        Rec2.SETRANGE(Key1, Rec."No.");
        ListPage.Set(0);
      END;

      IF Rec.Objecttype = Rec.Objecttype::Project THEN BEGIN
        Rec2.SETRANGE(Key2, Rec."No.");
        ListPage.Set(1);
      END;

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedContracts@1000000012(VAR Rec@1000000000 : Record 70020);
    VAR
      Rec2@1000000001 : Record 70021;
      ListPage@1000000002 : Page 70052;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, GetObjecttype(Rec));
      Rec2.SETRANGE(Type, Rec2.Type::Contract);
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE(Key1, Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedToDos@1000000015(VAR Rec@1000000000 : Record 70020);
    VAR
      Rec2@1000000001 : Record 70021;
      ListPage@1000000002 : Page 70061;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, GetObjecttype(Rec));
      Rec2.SETRANGE(Type, Rec2.Type::RecurringToDo);
      Rec2.SETRANGE(Subtype, Rec2.Subtype::" ");
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE(Key1, Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedYieldStudy@1000000019(VAR Rec@1000000000 : Record 70020);
    VAR
      Rec2@1000000001 : Record 70021;
      ListPage@1000000002 : Page 70056;
    BEGIN
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, GetObjecttype(Rec));
      Rec2.SETRANGE(Type, Rec2.Type::YieldStudy);
      Rec2.SETRANGE(Key1, Rec."No.");
      Rec2.FILTERGROUP(0);

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedRelations@1000000022(VAR Rec@1000000000 : Record 70020);
    VAR
      Rec2@1000000001 : Record 70021;
      ListPage@1000000002 : Page 70055;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, GetObjecttype(Rec));
      Rec2.SETRANGE(Type, Rec2.Type::Relation);
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE(Key1, Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowAssetList@1000000013(FilterRespCenter@1000000001 : Boolean;FilterUser@1000000000 : Boolean);
    VAR
      Rec@1000000004 : Record 70020;
      ListPage@1000000003 : Page 70021;
      CMUserAccessMgmt@1000000002 : Codeunit 70010;
    BEGIN
      {Asset}
      Rec.FILTERGROUP(2);
      Rec.SETRANGE(Objecttype, Rec.Objecttype::Asset);
      Rec.FILTERGROUP(0);

      IF FilterRespCenter THEN BEGIN
        IF CMUserAccessMgmt.GetAssetRespFilter <> '' THEN BEGIN
          Rec.FILTERGROUP(2);
          Rec.SETFILTER("Responsibility Center",CMUserAccessMgmt.GetAssetRespFilter);
          Rec.FILTERGROUP(0);
      {
        END ELSE BEGIN
          Rec.FILTERGROUP(2);
          Rec.SETRANGE("Responsibility Center",'#######');
          Rec.FILTERGROUP(0);
      }
        END;
      END;

      IF FilterUser THEN BEGIN
        Rec.FILTERGROUP(2);
        Rec.SETRANGE("User ID Filter", USERID);
        Rec.SETRANGE(ShowAsset, TRUE);
        Rec.FILTERGROUP(0);
      END;

      ListPage.SETTABLEVIEW(Rec);
      ListPage.RUN();
    END;

    PROCEDURE ShowAssetCard@1000000016(VAR Rec@1000000005 : Record 70020);
    VAR
      Rec2@1000000004 : Record 70020;
      CardPage@1000000003 : Page 70020;
      CardMainPage@1000000000 : Page 70026;
      CMUserAccessMgmt@1000000002 : Codeunit 70010;
    BEGIN
      IF Rec."No." = '' THEN EXIT;

      {Asset}
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, Rec2.Objecttype::Asset);
      Rec2.SETRANGE("No.",Rec."No.");
      Rec.FILTERGROUP(0);

      CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::Read, Rec."No.", '');
      IF IsNew THEN
        COMMIT;

      CardPage.SETTABLEVIEW(Rec2);
      CardMainPage.SETTABLEVIEW(Rec2);

      IF IsNew THEN BEGIN
        IF Rec."Asset Type" = Rec."Asset Type"::"Main Asset" THEN
          CardMainPage.RUNMODAL()
        ELSE
          CardPage.RUNMODAL()
      END ELSE BEGIN
        IF Rec."Asset Type" = Rec."Asset Type"::"Main Asset" THEN
          CardMainPage.RUN()
        ELSE
          CardPage.RUN();
      END;
    END;

    PROCEDURE ShowProjectList@1000000014(FilterRespCenter@1000000003 : Boolean;FilterUser@1000000002 : Boolean);
    VAR
      Rec@1000000000 : Record 70020;
      ListPage@1000000001 : Page 70023;
      CMUserAccessMgmt@1000000004 : Codeunit 70010;
    BEGIN
      {Project}
      Rec.FILTERGROUP(2);
      Rec.SETRANGE(Objecttype, Rec.Objecttype::Project);
      Rec.FILTERGROUP(0);

      IF FilterRespCenter THEN BEGIN
        IF CMUserAccessMgmt.GetProjectRespFilter <> '' THEN BEGIN
          Rec.FILTERGROUP(2);
          Rec.SETFILTER("Responsibility Center",CMUserAccessMgmt.GetProjectRespFilter);
          Rec.FILTERGROUP(0);
      {
        END ELSE BEGIN
          Rec.FILTERGROUP(2);
          Rec.SETRANGE("Responsibility Center",'#######');
          Rec.FILTERGROUP(0);
      }
        END;
      END;

      IF FilterUser THEN BEGIN
        Rec.FILTERGROUP(2);
        Rec.SETRANGE("User ID Filter", USERID);
        Rec.SETRANGE(ShowAsset, TRUE);
        Rec.FILTERGROUP(0);
      END;

      ListPage.SETTABLEVIEW(Rec);
      ListPage.RUN();
    END;

    PROCEDURE ShowProjectCard@1000000018(VAR Rec@1000000005 : Record 70020);
    VAR
      Rec2@1000000000 : Record 70020;
      CardPage@1000000001 : Page 70022;
      CMUserAccessMgmt@1000000004 : Codeunit 70010;
    BEGIN
      IF Rec."No." = '' THEN EXIT;

      {Project}
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, Rec.Objecttype::Project);
      Rec2.SETRANGE("No.",Rec."No.");
      Rec2.FILTERGROUP(0);

      CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::Read, Rec."No.", '');
      IF IsNew THEN
        COMMIT;

      CardPage.SETTABLEVIEW(Rec2);
      IF IsNew THEN
        CardPage.RUNMODAL()
      ELSE
        CardPage.RUN();
    END;

    PROCEDURE ShowAssetProjectCard@1000000023(RecRef@1000000005 : RecordRef);
    VAR
      CMAdditionalData@1000000004 : Record 70021;
      AssetCardPage@1000000003 : Page 70020;
      ProjectCardPage@1000000000 : Page 70022;
      CMUserAccessMgmt@1000000002 : Codeunit 70010;
      CMAsset@1000000001 : Record 70020;
      Opportunity@1000000006 : Record 5092;
    BEGIN
      CASE RecRef.NUMBER OF
      70020: {CMMS Object}
        BEGIN
          RecRef.SETTABLE(CMAsset);

          CASE CMAsset.Objecttype OF
          CMAsset.Objecttype::Asset:
            BEGIN
            {Asset}
            CMAsset.FILTERGROUP(2);
            CMAsset.SETRANGE(Objecttype, CMAsset.Objecttype::Asset);
            CMAsset.SETRANGE("No.",CMAsset."No.");
            CMAsset.FILTERGROUP(0);

            AssetCardPage.SETTABLEVIEW(CMAsset);
            IF IsNew THEN
              AssetCardPage.RUNMODAL()
            ELSE
              AssetCardPage.RUN();
            END;
          CMAsset.Objecttype::Project:
            BEGIN
            {Project}
            CMAsset.FILTERGROUP(2);
            CMAsset.SETRANGE(Objecttype, CMAsset.Objecttype::Project);
            CMAsset.SETRANGE("No.",CMAsset."No.");
            CMAsset.FILTERGROUP(0);

            ProjectCardPage.SETTABLEVIEW(CMAsset);
            IF IsNew THEN
              ProjectCardPage.RUNMODAL()
            ELSE
              ProjectCardPage.RUN();
            END;
          END;
        END;
      70021: {Additional Data}
        BEGIN
          RecRef.SETTABLE(CMAdditionalData);

          IF CMAdditionalData.Key1 = '' THEN EXIT;

          CASE CMAdditionalData.Objecttype OF
          CMAdditionalData.Objecttype::Asset:
            BEGIN
            {Asset}
            CMAsset.FILTERGROUP(2);
            CMAsset.SETRANGE(Objecttype, CMAsset.Objecttype::Asset);
            CMAsset.SETRANGE("No.",CMAdditionalData.Key1);
            CMAsset.FILTERGROUP(0);

            AssetCardPage.SETTABLEVIEW(CMAsset);
            IF IsNew THEN
              AssetCardPage.RUNMODAL()
            ELSE
              AssetCardPage.RUN();
            END;
          CMAdditionalData.Objecttype::Project:
            BEGIN
            {Project}
            CMAsset.FILTERGROUP(2);
            CMAsset.SETRANGE(Objecttype, CMAsset.Objecttype::Project);
            CMAsset.SETRANGE("No.",CMAdditionalData.Key1);
            CMAsset.FILTERGROUP(0);

            ProjectCardPage.SETTABLEVIEW(CMAsset);
            IF IsNew THEN
              ProjectCardPage.RUNMODAL()
            ELSE
              ProjectCardPage.RUN();
            END;
          END;
        END;

      5092: {Opportunity}
        BEGIN
          RecRef.SETTABLE(Opportunity);

          IF Opportunity."CM Object No." = '' THEN EXIT;

          CASE Opportunity."CM Objecttype" OF
          Opportunity."CM Objecttype"::Asset:
            BEGIN
            {Asset}
            CMAsset.FILTERGROUP(2);
            CMAsset.SETRANGE(Objecttype, CMAsset.Objecttype::Asset);
            CMAsset.SETRANGE("No.",Opportunity."CM Object No.");
            CMAsset.FILTERGROUP(0);

            AssetCardPage.SETTABLEVIEW(CMAsset);
            IF IsNew THEN
              AssetCardPage.RUNMODAL()
            ELSE
              AssetCardPage.RUN();
            END;
          Opportunity."CM Objecttype"::Project:
            BEGIN
            {Project}
            CMAsset.FILTERGROUP(2);
            CMAsset.SETRANGE(Objecttype, CMAsset.Objecttype::Project);
            CMAsset.SETRANGE("No.",Opportunity."CM Object No.");
            CMAsset.FILTERGROUP(0);

            ProjectCardPage.SETTABLEVIEW(CMAsset);
            IF IsNew THEN
              ProjectCardPage.RUNMODAL()
            ELSE
              ProjectCardPage.RUN();
            END;
          END;
        END;



      END;
    END;

    PROCEDURE "### Get Data ###"@1000000006();
    BEGIN
    END;

    PROCEDURE GetMainContract@1000000029(CMObject@1000000000 : Record 70020;VAR CMContract@1000000001 : Record 70050) : Boolean;
    VAR
      CMAddData@1000000002 : Record 70021;
    BEGIN
      CMContract.RESET;
      CMContract.INIT;
      CMContract."No." := '';

      CMAddData.RESET;
      IF CMObject.Objecttype = CMObject.Objecttype::Asset THEN
        CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::Asset);
      IF CMObject.Objecttype = CMObject.Objecttype::Project THEN
        CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::Project);
      CMAddData.SETRANGE(Type, CMAddData.Type::Contract);
      CMAddData.SETRANGE(Key1, CMObject."No.");
      CMAddData.SETRANGE("Main Contract", TRUE);
      IF CMAddData.FINDFIRST() THEN BEGIN
        IF CMContract.GET(CMAddData.Key2) THEN
          EXIT(TRUE);

        EXIT(FALSE);
      END;

      EXIT(FALSE);
    END;

    PROCEDURE NewAssetProjectUI@1000000017(CreateType@1000000002 : 'Asset,Project,MainAsset');
    VAR
      Rec@1000000004 : Record 70020;
      Rec2@1000000001 : Record 70020;
      CMGeneralMgmt@1000000000 : Codeunit 70000;
      ConfPage@1000000003 : Page 70123;
    BEGIN
      IsNew := TRUE;
      Rec.INIT;
      CASE CreateType OF
        CreateType::Asset : Rec.Objecttype := Rec.Objecttype::Asset;
        CreateType::Project : Rec.Objecttype := Rec.Objecttype::Project;
        CreateType::MainAsset : Rec.Objecttype := Rec.Objecttype::Asset;
      END;

      ConfPage.LOOKUPMODE(TRUE);
      IF NOT (ConfPage.RUNMODAL() = ACTION::Yes) THEN
        ERROR(Text005);
      ConfPage.GETRECORD(Rec2);

      Rec.Name := Rec2.Name;
      Rec."Name 2" := Rec2."Name 2";
      CMGeneralMgmt.GetNo(Rec);
      IF CreateType = CreateType::MainAsset THEN BEGIN
        Rec."Asset Type" := Rec."Asset Type"::"Main Asset";
        Rec."Main Asset No." := Rec."No.";
      END;

      //Insert:
      Rec.INSERT(TRUE);
      COMMIT;

      CASE CreateType OF
        CreateType::Asset: ShowAssetCard(Rec);
        CreateType::Project: ShowProjectCard(Rec);
        CreateType::MainAsset: ShowAssetCard(Rec);
      END;
    END;

    LOCAL PROCEDURE GetObjecttype@1000000020(VAR Rec@1000000000 : Record 70020) : Integer;
    VAR
      CMAdditionalData@1000000001 : Record 70021;
    BEGIN
      IF Rec.Objecttype = Rec.Objecttype::Project THEN
        EXIT(CMAdditionalData.Objecttype::Project);

      EXIT(CMAdditionalData.Objecttype::Asset);
    END;

    PROCEDURE CreateUpdateContact@1000000021(VAR Rec@1000000000 : Record 70020);
    VAR
      Contact@1000000001 : Record 5050;
    BEGIN
      IF Rec."Contact No." = '' THEN BEGIN
        Contact.INIT;
        Contact.VALIDATE("No.", Rec."No.");
        Contact."CMMS Is CMMS Contact" := TRUE;
        Contact.VALIDATE(Type,Contact.Type::Company);
        Contact.Name := Rec.Name;
        Contact.INSERT(TRUE);

        Rec."Contact No." := Contact."No.";
      END
      ELSE BEGIN
        IF Contact.GET(Rec."Contact No.") THEN BEGIN
          Contact.Name := Rec.Name;
          Contact.MODIFY(FALSE);
        END;
      END;
    END;

    PROCEDURE CreateUpdateDimension@1000000024(VAR Rec@1000000000 : Record 70020);
    VAR
      CMGenSetup@1000000001 : Record 70000;
      DimValue@1000000002 : Record 349;
    BEGIN
      IF NOT CMGenSetup.GET() THEN
        CMGenSetup.INIT();

      IF (Rec.Objecttype = Rec.Objecttype::Asset) AND (CMGenSetup."Asset Dimension Code" <> '') THEN BEGIN
        DimValue.INIT;
        DimValue.VALIDATE("Dimension Code", CMGenSetup."Asset Dimension Code");
        DimValue.VALIDATE(Code, Rec."No.");
        DimValue.VALIDATE(Name, Rec.Name);
        IF NOT DimValue.INSERT(TRUE) THEN BEGIN
          DimValue.RESET;
          DimValue.GET(CMGenSetup."Asset Dimension Code", Rec."No.");
          IF DimValue.GET(CMGenSetup."Asset Dimension Code", Rec."No.") THEN BEGIN
            DimValue.VALIDATE(Name, Rec.Name);
            DimValue.MODIFY(TRUE);
          END;
        END;
      END;

      IF (Rec.Objecttype = Rec.Objecttype::Project) AND (CMGenSetup."Project Dimension Code" <> '') THEN BEGIN
        DimValue.INIT;
        DimValue.VALIDATE("Dimension Code", CMGenSetup."Project Dimension Code");
        DimValue.VALIDATE(Code, Rec."No.");
        DimValue.VALIDATE(Name, Rec.Name);
        IF NOT DimValue.INSERT(TRUE) THEN BEGIN
          DimValue.RESET;
          IF DimValue.GET(CMGenSetup."Project Dimension Code", Rec."No.") THEN BEGIN
            DimValue.VALIDATE(Name, Rec.Name);
            DimValue.MODIFY(TRUE);
          END;
        END;
      END;
    END;

    LOCAL PROCEDURE SetIsNew@1000000025(SetIsNew@1000000000 : Boolean);
    BEGIN
      IsNew := SetIsNew;
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70021 CMMS Contract Management
{
  OBJECT-PROPERTIES
  {
    Date=15.05.18;
    Time=14:24:23;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Ivalid call!;DEA=Ungltiger Aufruf!';
      Text002@1000000001 : TextConst 'ENU=Canceled.;DEA=Abgebrochen.';
      Text003@1000000002 : TextConst 'ENU=Date conflict with existing Contract "%1" for Asset "%2" (Start Date: %3, End Date: %4).;DEA=Datumskonflikt mit bestehendem Vertrag "%1" zu Anlage "%2" (Startdatum: %3, Enddatum: %4).';
      Text004@1000000003 : TextConst 'ENU=Date conflict with existing Contract "%1" for Asset "%2" (same Start Date).;DEA=Datumskonflikt mit bestehendem Vertrag "%1" zu Anlage "%2" (selbel Startdatum).';
      Text005@1000000004 : TextConst 'ENU=%1 Asset - Contracts will be modified, %2 new Asset - Contracts will be created. Do you want to do this?;DEA=%1 bestehende Anlagenvertr„ge werden angepasst, %2 neue Anlagenvert„ge werden erstellt. Wollen Sie diese Aktion durchfhren?';
      Text006@1000000005 : TextConst 'ENU=Please wait...;DEA=Bitte warten...';

    PROCEDURE NewContractUI@1000000017();
    VAR
      Rec@1000000004 : Record 70050;
      TempRec@1000000001 : TEMPORARY Record 70050;
      ConfPage@1000000003 : Page 70125;
      CMGenMgt@1000000000 : Codeunit 70000;
    BEGIN
      ConfPage.LOOKUPMODE(TRUE);
      IF NOT (ConfPage.RUNMODAL() = ACTION::Yes) THEN
        ERROR(Text002);
      ConfPage.GETRECORD(TempRec);

      Rec.INIT;
      Rec.TRANSFERFIELDS(TempRec, FALSE);
      CMGenMgt.GetContractNo(Rec);
      Rec.INSERT(TRUE);

      ShowContractCard(Rec);
    END;

    PROCEDURE ShowContractCard@1000000002(VAR Rec@1000000002 : Record 70050);
    VAR
      Rec2@1000000001 : Record 70050;
      CardPage@1000000000 : Page 70025;
    BEGIN
      IF Rec."No." = '' THEN EXIT;

      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE("No.", Rec."No.");
      Rec2.FILTERGROUP(0);

      CardPage.SETTABLEVIEW(Rec2);
      CardPage.RUN();
    END;

    PROCEDURE ShowContractList@1000000013();
    VAR
      Rec@1000000004 : Record 70050;
      ListPage@1000000003 : Page 70024;
    BEGIN
      ListPage.SETTABLEVIEW(Rec);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedContractEntites@1000000012(VAR Rec@1000000000 : Record 70050);
    VAR
      Rec2@1000000001 : Record 70021;
      ListPage@1000000002 : Page 70052;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, Rec2.Objecttype::Asset);
      Rec2.SETRANGE(Type, Rec2.Type::Contract);
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE(Key2, Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedToDos@1000000015(VAR Rec@1000000000 : Record 70050);
    VAR
      Rec2@1000000001 : Record 70021;
      ListPage@1000000002 : Page 70061;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, Rec2.Objecttype::Contract);
      Rec2.SETRANGE(Type, Rec2.Type::RecurringToDo);
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE(Key1, Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedLogs@1000000019(VAR Rec@1000000000 : Record 70050);
    VAR
      Rec2@1000000001 : Record 5065;
      ListPage@1000000002 : Page 70111;
    BEGIN
      Rec2.RESET;
      Rec2.SETCURRENTKEY("CM Is CMMS Log Entry","CM Source","CM Source No.");
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE("CM Is CMMS Log Entry", TRUE);
      Rec2.SETRANGE("CM Source", Rec2."CM Source"::Contract);
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE("CM Source No.", Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowRelatedRelations@1000000022(VAR Rec@1000000000 : Record 70050);
    VAR
      Rec2@1000000001 : Record 70021;
      ListPage@1000000002 : Page 70055;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, Rec2.Objecttype::Contract);
      Rec2.SETRANGE(Type, Rec2.Type::Relation);
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE(Key1, Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowContractPackages@1000000001(VAR Rec@1000000000 : Record 70050);
    VAR
      Rec2@1000000001 : Record 70021;
      ListPage@1000000002 : Page 70058;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, Rec2.Objecttype::Contract);
      Rec2.SETRANGE(Type, Rec2.Type::ContractPackage);
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE(Key1, Rec."No.");

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE CopyRelatedToDos@1000000000(FromRecRef@1000000000 : RecordRef;ToRecRef@1000000001 : RecordRef);
    VAR
      FromRec@1000000004 : Record 70021;
      ToRec@1000000005 : Record 70021;
      ToRec2@1000000002 : Record 70021;
      FromObjectType@1000000006 : 'Asset,Project,Contract,User,Tool,Subcontractor,Workorder,Task';
      FromKey1@1000000007 : Code[50];
      FromKey2@1000000008 : Code[50];
      FromKey3@1000000009 : Code[50];
      ToObjectType@1000000013 : 'Asset,Project,Contract,User,Tool,Subcontractor,Workorder,Task';
      ToKey1@1000000012 : Code[50];
      ToKey2@1000000011 : Code[50];
      ToKey3@1000000010 : Code[50];
    BEGIN
      CLEAR(FromObjectType);
      CLEAR(FromKey1);
      CLEAR(FromKey2);
      CLEAR(FromKey3);
      CLEAR(ToObjectType);
      CLEAR(ToKey1);
      CLEAR(ToKey2);
      CLEAR(ToKey3);

      GetRelatedDataKey(FromRecRef,FromObjectType,FromKey1,FromKey2,FromKey3);
      FromRec.SETRANGE(Objecttype,FromObjectType);
      FromRec.SETRANGE(Type,FromRec.Type::RecurringToDo);
      FromRec.SETRANGE(Key1,FromKey1);
      FromRec.SETRANGE(Key2,FromKey2);
      FromRec.SETRANGE(Key3,FromKey3);
      IF FromRec.FINDFIRST THEN BEGIN
        REPEAT
          GetRelatedDataKey(ToRecRef,ToObjectType,ToKey1,ToKey2,ToKey3);
          ToRec.INIT;
          ToRec := FromRec;
          ToRec.Objecttype := ToObjectType;
          ToRec.Key1 := ToKey1;
          ToRec.Key2 := ToKey2;
          ToRec.Key3 := ToKey3;
          ToRec."Line No." := GetNextLineNo(ToRec);
          ToRec."Source Type" := FromRec.Objecttype;
          ToRec."Source No." := FromRec.Key1;
          ToRec."Source Line No." := FromRec."Line No.";
          ToRec."Creation Date" := TODAY;
          ToRec."Created by" := USERID;
          IF FromRec."Maintask Line No." <> 0 THEN BEGIN
            ToRec2.RESET;
            ToRec2.SETRANGE(Objecttype,ToRec.Objecttype);
            ToRec2.SETRANGE(Type,ToRec.Type);
            ToRec2.SETRANGE(Key1,ToRec.Key1);
            ToRec2.SETRANGE("Source Line No.",FromRec."Maintask Line No.");
            IF ToRec2.FINDLAST THEN
              ToRec."Maintask Line No." := ToRec2."Line No.";
          END;
          ToRec.INSERT;
        UNTIL FromRec.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetRelatedDataKey@1000000007(RecRef@1000000000 : RecordRef;VAR ObjectType@1000000004 : 'Asset,Project,Contract,User,Tool,Subcontractor,Workorder,Task';VAR Key1@1000000003 : Code[50];VAR Key2@1000000002 : Code[50];VAR Key3@1000000001 : Code[50]) : Integer;
    VAR
      CMAsset@1000000006 : Record 70020;
      CMContract@1000000005 : Record 70050;
    BEGIN
      CLEAR(ObjectType);
      CLEAR(Key1);
      CLEAR(Key2);
      CLEAR(Key3);

      CASE RecRef.NUMBER OF
      70050: {Contract}
        BEGIN
          RecRef.SETTABLE(CMContract);
          ObjectType := ObjectType::Contract;
          Key1 := CMContract."No.";
        END;
      70020: {Asset}
        BEGIN
          RecRef.SETTABLE(CMAsset);
          ObjectType := ObjectType::Asset;
          Key1 := CMAsset."No.";
        END;
      END;
    END;

    LOCAL PROCEDURE GetNextLineNo@1000000008(ToRec@1000000005 : Record 70021) : Integer;
    VAR
      Rec@1000000000 : Record 70021;
    BEGIN
      Rec.SETRANGE(Objecttype,ToRec.Objecttype);
      Rec.SETRANGE(Type, ToRec.Type);
      Rec.SETRANGE(Key1, ToRec.Key1);
      Rec.SETRANGE(Key2, ToRec.Key2);
      Rec.SETRANGE(Key3, ToRec.Key3);

      IF Rec.FINDLAST THEN
        EXIT(Rec."Line No." + 10000)
      ELSE
       EXIT(10000);
    END;

    PROCEDURE "###INVOICING###"@1000000003();
    BEGIN
    END;

    PROCEDURE EditContractInvoicing@1000000004(Rec@1000000000 : Record 70050);
    VAR
      TempRec@1000000001 : TEMPORARY Record 70050;
      DlgPage@1000000002 : Page 70066;
      Dlg@1000000008 : Dialog;
      CMAddData@1000000003 : Record 70021;
      CMAddData2@1000000007 : Record 70021;
      CMObject@1000000006 : Record 70020;
      c1@1000000004 : Integer;
      c2@1000000005 : Integer;
    BEGIN
      TempRec.INIT;
      TempRec.TRANSFERFIELDS(Rec, TRUE);

      DlgPage.SetRec(TempRec);
      IF DlgPage.RUNMODAL <> ACTION::Yes THEN
        ERROR(Text002);

      Dlg.OPEN(Text006);
      DlgPage.GETRECORD(TempRec);


      c1 := 0;
      c2 := 0;

      //Edit existing entires
      CMAddData.RESET;
      CMAddData.SETCURRENTKEY(Objecttype,Type,Key2,Key1);
      CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::Asset);
      CMAddData.SETRANGE(Type, CMAddData.Type::Contract);
      CMAddData.SETRANGE(Key2, Rec."No.");
      IF CMAddData.FIND('-') THEN BEGIN
        REPEAT
          //Start Date is <
          IF CMAddData."Contract Start Date" < TempRec."Start Date" THEN BEGIN
            //End Date is '' | >
            IF (CMAddData."Contract End Date" = 0D) OR (CMAddData."Contract End Date" > TempRec."End Date") THEN BEGIN
              CMAddData."Contract End Date" := TempRec."Start Date";
              c1 += 1;
            END;
            IF CMAddData."Contract End Date" <= TempRec."End Date" THEN BEGIN
              //OK, do nothing
            END;
          END;

          //Start Date is >
          IF CMAddData."Contract Start Date" > TempRec."Start Date" THEN BEGIN
            IF (CMAddData."Contract Start Date" >= TempRec."End Date") AND (TempRec."End Date" <> 0D) THEN BEGIN
              //OK, do nothing
            END
            ELSE BEGIN
              ERROR(Text003, CMAddData.Key1, CMAddData.Key2, CMAddData."Contract Start Date", CMAddData."Contract End Date");
            END;
          END;

          //Start Date is =
          IF CMAddData."Contract Start Date" = TempRec."Start Date" THEN BEGIN
            ERROR(Text004, CMAddData.Key2, CMAddData.Key1);
          END;

          //Modify
          CMAddData.MODIFY(FALSE);
        UNTIL CMAddData.NEXT = 0;
      END;

      //Create New Entries
      CMAddData.RESET;

      CMObject.RESET;
      CMObject.SETRANGE(Objecttype, CMObject.Objecttype::Asset);
      IF CMObject.FIND('-') THEN BEGIN
        REPEAT
          CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::Asset);
          CMAddData.SETRANGE(Type, CMAddData.Type::Contract);
          CMAddData.SETRANGE(Key1, CMObject."No.");
          CMAddData.SETRANGE(Key2, TempRec."No.");
          IF CMAddData.FINDFIRST() THEN BEGIN
            CMAddData2.INIT;
            CMAddData2.TRANSFERFIELDS(CMAddData, TRUE);
            CMAddData2."Contract Start Date" := 0D;
            CMAddData2."Contract End Date" := 0D;
            CMAddData2.VALIDATE("Contract Start Date", TempRec."Start Date");
            CMAddData2.VALIDATE("Contract End Date", TempRec."End Date");
            CMAddData2."Invoicing Period" := TempRec."Invoicing Period";
            CMAddData2."Invoicing Type" := TempRec."Invoicing Type";
            CMAddData2.INSERT(TRUE);
            c2 += 1;
          END;
        UNTIL CMObject.NEXT = 0;
      END;

      //Modify Contract
      Rec."Start Date" := TempRec."Start Date";
      Rec."End Date" := TempRec."End Date";
      Rec."Invoicing Type" := TempRec."Invoicing Type";
      Rec."Invoicing Period" := TempRec."Invoicing Period";
      Rec.MODIFY(FALSE);

      Dlg.CLOSE();

      IF NOT CONFIRM(STRSUBSTNO(Text005, c1, c2)) THEN
        ERROR(Text002);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70022 CMMS EEM Interface Management
{
  OBJECT-PROPERTIES
  {
    Date=16.11.17;
    Time=11:22:44;
    Modified=Yes;
    Version List=CMMS,EEM;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Mapping Error. No CMMS Asset No. found for GPM Plant Id %1.';
      Text002@1000000001 : TextConst 'ENU=Mapping Error. CMMS Asset No. "%1" not found. Check mapping table for GPM Plant Id %2.';

    PROCEDURE GetDataV10@1000000000(SiteNo@1000000000 : Code[20];WorkorderOffset@1000000001 : Integer;WorkorderCount@1000000003 : Integer;VAR Data@1000000002 : XMLport 50000);
    BEGIN
      CheckOffsetAndCount(WorkorderOffset, WorkorderCount);
      Data.DoInit(SiteNo, WorkorderOffset, WorkorderCount);
    END;

    PROCEDURE GetDataV20@1000000001(GpmPlantId@1000000000 : Integer;WorkorderOffset@1000000001 : Integer;WorkorderCount@1000000003 : Integer;VAR Data@1000000002 : XMLport 50001);
    VAR
      CMObject@1000000004 : Record 70020;
    BEGIN
      CheckOffsetAndCount(WorkorderOffset, WorkorderCount);
      Data.DoInit(GetCmmsAssetNo(GpmPlantId), WorkorderOffset, WorkorderCount);
    END;

    LOCAL PROCEDURE GetCmmsAssetNo@1000000011(GpmPlantId@1000000000 : Integer) : Code[20];
    VAR
      CMAddData@1000000001 : Record 70021;
      CMObject@1000000002 : Record 70020;
    BEGIN
      //Mapping between GPM Plant Id and CMMS Asset No.

      CMAddData.RESET;
      CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::Asset);
      CMAddData.SETRANGE(Type, CMAddData.Type::GpmPlantMapping);
      CMAddData.SETRANGE(Key1, FORMAT(GpmPlantId));
      IF NOT CMAddData.FINDFIRST() THEN
        ERROR(Text001, GpmPlantId);

      IF NOT CMObject.GET(CMObject.Objecttype::Asset, CMAddData."Asset No.") THEN
        ERROR(Text002, CMAddData."Asset No.", GpmPlantId);

      EXIT(CMObject."No.");
    END;

    LOCAL PROCEDURE CheckOffsetAndCount@1000000002(VAR Offset@1000000000 : Integer;VAR Count_@1000000001 : Integer);
    BEGIN
      IF Offset < 1 THEN
        Offset := 1;

      IF Count_ < 1 THEN
        Count_ := 1;

      IF Count_ > 50 THEN
        Count_ := 50;
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70023 CMMS Offline App Mgmt.
{
  OBJECT-PROPERTIES
  {
    Date=15.03.18;
    Time=18:23:01;
    Modified=Yes;
    Version List=CMMS,OSR;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE CheckLogin@1000000002();
    BEGIN
    END;

    PROCEDURE GetWorkorders@1000000000(VAR Data@1000000001 : XMLport 50005);
    BEGIN
      Data.EXPORT();
    END;

    PROCEDURE SetWorkorders@1000000001(VAR Data@1000000000 : XMLport 50005) : Boolean;
    VAR
      ImportedWorkorders@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.Generic.List`1";
    BEGIN
      //Import
      Data.IMPORT();
      Data.GetData(ImportedWorkorders);

      //Export
      Data.SetData(TRUE, ImportedWorkorders);
      Data.EXPORT();
      EXIT(TRUE);
    END;

    PROCEDURE SetImageData@1000000003(Data@1000000000 : XMLport 50006) : Boolean;
    BEGIN
      Data.IMPORT();
      EXIT(TRUE)
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70024 CMMS Misc. Interface Mgmt.
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=10:30:44;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE GetAssets@1000000000(AssetNoFilter@1000000000 : Text;VAR Data@1000000001 : XMLport 50009);
    BEGIN
      Data.SetData(AssetNoFilter);
      Data.EXPORT();
    END;

    PROCEDURE GetAsset@1000000001(AssetNo@1000000000 : Code[20];VAR Name@1000000003 : Text;VAR CapacityDcKwp@1000000001 : Decimal);
    VAR
      Asset@1000000002 : Record 70020;
    BEGIN
      Asset.GET(Asset.Objecttype, AssetNo);
      Name := Asset.Name;
      CapacityDcKwp := Asset."Capacity DC kWp";
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70025 CMMS Equipment Management
{
  OBJECT-PROPERTIES
  {
    Date=18.11.16;
    Time=13:13:16;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    PROCEDURE InsertEQPT@1000000001(VAR Rec@1000000005 : Record 70025);
    VAR
      Rec2@1000000002 : Record 70025;
      Rec3@1000000001 : Record 70025;
      NextEntryNo@1000000004 : Integer;
      TempRec@1000000000 : TEMPORARY Record 70025;
    BEGIN
      IF Rec.Key1 = '' THEN EXIT;
      TempRec := Rec;

      NextEntryNo := 10000;
      Rec2.RESET;
      Rec2.SETRANGE(Objecttype,Rec.Objecttype);
      Rec2.SETRANGE(Type,Rec.Type);
      Rec2.SETRANGE("Component Type",Rec."Component Type");
      Rec2.SETRANGE(Key1,Rec.Key1);
      Rec2.SETRANGE("Line Type",Rec2."Line Type"::Line);

      IF Rec2.FINDLAST THEN
        NextEntryNo := Rec2."Entry No." + 10000;

      {CREATE New Line}
      Rec3.INIT;
      Rec3.VALIDATE(Objecttype,TempRec.Objecttype);
      Rec3.VALIDATE(Type,TempRec.Type);
      Rec3.VALIDATE("Component Type",TempRec."Component Type");
      Rec3.VALIDATE(Key1,TempRec.Key1);
      Rec3.VALIDATE("Entry No.",NextEntryNo);
      Rec3.VALIDATE("Line Type",Rec."Line Type"::Line);
      Rec3.INSERT;

      Rec.GET(Rec3.Objecttype,Rec3.Type,Rec3."Component Type",Rec3.Key1,Rec3."Entry No.");
    END;

    PROCEDURE CheckEQPTStructure@1000000010(ObjectType@1000000005 : Integer;Type@1000000001 : 'Equipment,Spare Part';Key@1000000000 : Code[20]);
    VAR
      Rec@1000000002 : Record 70025;
      i@1000000004 : Integer;
    BEGIN
      FOR i := 0 TO 18 DO
        BEGIN
          IF i IN [0,1,2,3,4,5,6,7,8,9,10,11,18] THEN
            IF NOT Rec.GET(ObjectType,Type,i,Key,0) THEN
              InsertEQPTStructure(ObjectType,Type,Key,i);
        END;
    END;

    PROCEDURE InsertEQPTStructure@1000000022(ObjectType@1000000006 : Integer;Type@1000000004 : 'Equipment,Spare Part';Key@1000000000 : Code[20];CompType@1000000001 : Integer);
    VAR
      Rec@1000000002 : Record 70025;
      Rec2@1000000003 : Record 70025;
    BEGIN
      CLEAR(Rec);

      Rec.INIT;
      Rec.VALIDATE(Objecttype,ObjectType);
      Rec.VALIDATE(Type,Type);
      Rec.VALIDATE("Component Type",CompType);
      Rec.VALIDATE(Key1,Key);
      Rec.VALIDATE("Entry No.",0);
      Rec.VALIDATE(Rec."Line Type",Rec."Line Type"::Header);
      Rec.VALIDATE(Description,STRSUBSTNO('%1',Rec."Component Type"));
      Rec.INSERT;
    END;

    PROCEDURE ShowEQPT@1000000017(ObjectType@1000000006 : Integer;TypeFilter@1000000003 : 'Equipment,Spare Part';Key@1000000000 : Code[20]);
    VAR
      Rec@1000000001 : Record 70025;
      RecListPage@1000000002 : Page 70080;
      RecListPage2@1000000004 : Page 70082;
    BEGIN
      {Check Structure}
      CheckEQPTStructure(ObjectType,TypeFilter,Key);

      {Show list}
      WITH Rec DO
      BEGIN
        FILTERGROUP(2);
        SETRANGE(Objecttype,Objecttype);
        SETRANGE(Type,TypeFilter);
        SETRANGE(Key1,Key);
        SETRANGE("Replaced with Entry No.", 0);
        FILTERGROUP(0);

        CASE TypeFilter OF
          TypeFilter::Equipment: BEGIN
            RecListPage.SETTABLEVIEW(Rec);
            RecListPage.SETRECORD(Rec);
            RecListPage.RUN;
          END;
          TypeFilter::"Spare Part": BEGIN
            RecListPage2.SETTABLEVIEW(Rec);
            RecListPage2.SETRECORD(Rec);
            RecListPage2.RUN;
          END;
        END;
      END;
    END;

    PROCEDURE ShowEQPTwithFilter@1000000002(ObjectType@1000000007 : Integer;TypeFilter@1000000004 : 'Equipment,Spare Part';Key@1000000000 : Code[20];CompType@1000000003 : Integer);
    VAR
      Rec@1000000001 : Record 70025;
      RecListPage@1000000002 : Page 70080;
      RecListPage2@1000000005 : Page 70082;
    BEGIN
      {Check Structure}
      CheckEQPTStructure(ObjectType,TypeFilter,Key);

      {Show list}
      WITH Rec DO
      BEGIN
        FILTERGROUP(2);
        SETRANGE(Objecttype,Objecttype);
        SETRANGE(Type,TypeFilter);
        SETRANGE(Key1,Key);
        SETRANGE("Replaced with Entry No.", 0);
        FILTERGROUP(0);

        SETRANGE("Component Type",CompType);
        SETRANGE("Line Type","Line Type"::Line);

        CASE TypeFilter OF
          TypeFilter::Equipment: BEGIN
            RecListPage.SETTABLEVIEW(Rec);
            RecListPage.SETRECORD(Rec);
            RecListPage.RUN;
          END;
          TypeFilter::"Spare Part": BEGIN
            RecListPage2.SETTABLEVIEW(Rec);
            RecListPage2.SETRECORD(Rec);
            RecListPage2.RUN;
          END;
        END;
      END;
    END;

    PROCEDURE ShowEQPTCard@1000000000(Rec@1000000000 : Record 70025);
    VAR
      RecCardPage@1000000002 : Page 70081;
    BEGIN
      IF Rec."Entry No." = Rec."Entry No."::"0" THEN EXIT;
      {Show card}
      WITH Rec DO
      BEGIN
        FILTERGROUP(2);
        SETRANGE(Objecttype,Rec.Objecttype);
        SETRANGE(Type,Rec.Type);
        SETRANGE("Component Type",Rec."Component Type");
        SETRANGE(Key1,Rec.Key1);
        SETRANGE("Entry No.",Rec."Entry No.");
        FILTERGROUP(0);

        RecCardPage.SETTABLEVIEW(Rec);
        RecCardPage.SETRECORD(Rec);
        RecCardPage.RUN;
      END;
    END;

    PROCEDURE CountEQPT@1000000003(ObjectType@1000000006 : Integer;TypeFilter@1000000003 : 'Equipment,Spare Part';Key@1000000000 : Code[20];CompType@1000000005 : Integer) : Integer;
    VAR
      Rec@1000000001 : Record 70025;
      RecListPage@1000000002 : Page 70080;
      RecListPage2@1000000004 : Page 70082;
    BEGIN
      WITH Rec DO
      BEGIN
        FILTERGROUP(2);
        SETRANGE(Objecttype,Objecttype);
        SETRANGE(Type,TypeFilter);
        SETRANGE(Key1,Key);
        SETRANGE("Component Type",CompType);
        SETRANGE("Line Type","Line Type"::Line);
        SETRANGE("Replaced with Entry No.", 0);
        FILTERGROUP(0);
        EXIT(Rec.COUNT);
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70026 CMMS GPM Interface Management
{
  OBJECT-PROPERTIES
  {
    Date=02.01.18;
    Time=11:49:06;
    Modified=Yes;
    Version List=CMMS,GPM;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text001@1000000001 : TextConst 'ENU=Workorder (%1) not found!';
      Text002@1000000000 : TextConst 'ENU=Automatically closed. Ticket was deleted in GPM.';
      Text003@1000000002 : TextConst 'ENU=Operator %1 was set to be ignored!';
      Text004@1000000003 : TextConst 'ENU=Workorder "%1" not updated! Because of GPM Ticket State is "%2"!';
      Text005@1000000004 : TextConst 'ENU=Workorder not created! Because of GPM Ticket State is "%1"!';
      Text006@1000000005 : TextConst 'ENU=Ignored because alert_type is %1.';
      Text007@1000000006 : TextConst 'ENU=Automatically closed. Ticket was "Deactivated and Assigned" in GPM.';

    PROCEDURE "###GPM###"@1000000001();
    BEGIN
    END;

    PROCEDURE ProcessRecord@1000000005(VAR Rec@1000000006 : Record 50005;ModifyRec@1000000003 : Boolean);
    VAR
      CMWorkorder@1000000000 : Record 5092;
      CMGPMTicketArch@1000000001 : Record 50005;
      CMWoMgt@1000000002 : Codeunit 70030;
      CMGenMgt@1000000004 : Codeunit 70000;
      LogEntry@1000000005 : Record 5065;
    BEGIN
      IF Rec.Processed THEN
        EXIT;

      Rec."Creation Date" := TODAY;
      Rec."Creation Time" := TIME;
      Rec."Creation Datetime" := CURRENTDATETIME;

      ConvertTimes(Rec); //NAV UTC Datetime problem

      IF CheckIngoreOperatorID(Rec.operator_id) THEN BEGIN
        Rec."Workorder Updated" := FALSE;
        Rec."Error Text" := STRSUBSTNO(Text003, Rec.operator_id);
        Rec."Is Error" := TRUE;
        EXIT;
      END;

      IF Rec.alert_type = 0 THEN BEGIN
        Rec."Workorder Updated" := FALSE;
        Rec."Error Text" := STRSUBSTNO(Text006, Rec.alert_type);
        Rec."Is Error" := TRUE;
        EXIT;
      END;

      {
        State
        0 : EXIT(CMWorkorder."CM GPM State"::Activated);
        1 : EXIT(CMWorkorder."CM GPM State"::Assigned);
        2 : EXIT(CMWorkorder."CM GPM State"::Deactivated);
        3 : EXIT(CMWorkorder."CM GPM State"::"Deactivated and Assigned");
      }

      CMGPMTicketArch.SETCURRENTKEY(ticket_id,"Workorder No.",id);
      CMGPMTicketArch.SETRANGE(ticket_id, Rec.ticket_id);
      CMGPMTicketArch.SETFILTER("Workorder No.", '<>%1', '');
      CMGPMTicketArch.SETFILTER(id, '<>%1', Rec.id);
      IF CMGPMTicketArch.FINDLAST() THEN BEGIN //UPDATE Existing Workorder
        IF NOT CMWorkorder.GET(CMGPMTicketArch."Workorder No.") THEN BEGIN
          Rec."Workorder Updated" := FALSE;
          Rec."Error Text" := STRSUBSTNO(Text001, CMGPMTicketArch."Workorder No.");
          Rec."Is Error" := TRUE;
          EXIT;
        END;

        Rec."Workorder No." := CMWorkorder."No.";

        IF (CMWorkorder."CM Status" IN [CMWorkorder."CM Status"::Completed, CMWorkorder."CM Status"::Done, CMWorkorder."CM Status"::Discarded]) THEN BEGIN
          Rec."Workorder Updated" := FALSE;
        END
        ELSE BEGIN
          IF Rec.state IN [1,3] THEN BEGIN
            AddDataToWorkorder(CMWorkorder, Rec);
            CMWorkorder.MODIFY(TRUE);
            Rec."Workorder Updated" := TRUE;
          END
          ELSE BEGIN
            Rec."Workorder Updated" := FALSE;
            Rec."Is Error" := TRUE;
            Rec."Error Text" := STRSUBSTNO(Text004, CMWorkorder."No.", Rec.state);
          END;
        END
      END
      ELSE BEGIN //CREATE New Workorder
        IF Rec.state IN [1,3] THEN BEGIN
          CMWorkorder.RESET;
          CMWorkorder.INIT;
          CMWorkorder."No." := '';
          CMWorkorder."CM Is Workorder" := TRUE;
          CMWorkorder."CM Is Temporary" := FALSE;
          AddDataToWorkorder(CMWorkorder, Rec);
          CMWorkorder.INSERT(TRUE);

          Rec."Workorder No." := CMWorkorder."No.";
          Rec."Workorder Updated" := TRUE;
        END
        ELSE BEGIN
          Rec."Workorder Updated" := FALSE;
          Rec."Is Error" := TRUE;
          Rec."Error Text" := STRSUBSTNO(Text005, Rec.state);
        END;
      END;

      //Delete Flag
      IF Rec.deleted THEN BEGIN
        CMWorkorder."CM Status" := CMWorkorder."CM Status"::Discarded;
        IF CMWorkorder.MODIFY(FALSE) THEN
          CMGenMgt.CreateLogEntry(CMWorkorder,LogEntry."CM Log Type"::"Status Change", FORMAT(CMWorkorder."CM Status"), Text002);
      END;

      Rec.Processed := TRUE;
      Rec."Processed Date" := TODAY;
      Rec."Processed Time" := TIME;
      Rec."Processed Datetime" := CURRENTDATETIME;
      IF ModifyRec THEN
        Rec.MODIFY(FALSE);
    END;

    LOCAL PROCEDURE AddDataToWorkorder@1000000000(VAR CMWorkorder@1000000000 : Record 5092;Rec@1000000001 : Record 50005);
    BEGIN
      CMWorkorder.Description := COPYSTR(Rec.name,1,50);

      CMWorkorder."CM Source" := CMWorkorder."CM Source"::Alarm;
      CMWorkorder."CM Assigned User ID" := MapOperatorId(Rec.operator_id);
      CMWorkorder."CM Objecttype" := CMWorkorder."CM Objecttype"::Asset;
      CMWorkorder."CM Object No." := MapPlantId(Rec.reference_plant_id);
      FillObjectName(CMWorkorder);
      CMWorkorder."CM GPM Ticket Id" := Rec.ticket_id;
      CMWorkorder."CM GPM Ticket Name" := Rec.name;
      CMWorkorder."CM GPM Grouping" := ConvertGrouping(Rec.grouping);
      CMWorkorder."CM GPM Activated DateTime" := Rec.activated_time;
      CMWorkorder."CM GPM Activated Date" := Rec.activated_time_DATE;
      CMWorkorder."CM GPM Activated Time" := Rec.activated_time_TIME;
      CMWorkorder."CM GPM Deactivated DateTime" := Rec.deactivated_time;
      CMWorkorder."CM GPM Deactivated Date" := Rec.deactivated_time_DATE;
      CMWorkorder."CM GPM Deactivated Time" := Rec.deactivated_time_TIME;
      CMWorkorder."CM GPM Reference Element ID" := Rec.reference_element_id;
      CMWorkorder."CM GPM Reference Element Name" := Rec.reference_element_name;
      CMWorkorder."CM GPM Prority" := Rec.priority;
      CMWorkorder."CM GPM State" := ConvertState(Rec.state);
      CMWorkorder."CM GPM Alert Type" := ConvertAlertType(Rec.alert_type);
      CMWorkorder."CM GPM Activation Description" := Rec.activation_description_BLOB;
      CMWorkorder."CM GPM Deactivation Descr." := Rec.deactivation_description_BLOB;
      CMWorkorder."CM GPM Activation Details" := Rec.activation_details_BLOB;
      CMWorkorder."CM GPM Deactivation Details" := Rec.deactivation_details_BLOB;
      CMWorkorder."CM GPM Plant ID" := Rec.reference_plant_id;
      CMWorkorder."CM GPM Affects Availibility" := Rec.affects_availibility;
      CMWorkorder."CM GPM Calculate Loss" := Rec.calculate_loss;
      CMWorkorder."CM GPM Problem Description" := Rec.problem_description_BLOB;
      CMWorkorder."CM GPM Company" := Rec.company;
      CMWorkorder."CM GPM Ticket Duration" := Rec.time_t;
      CMWorkorder."CM GPM Actions Performed" := Rec.actions_performed_BLOB;
      CMWorkorder."CM GPM Maintenance Type" := ConvertMaintenanceType(Rec.maintenance_type_id);
      CMWorkorder."CM GPM Notified DateTime" := Rec.notified_time;
      CMWorkorder."CM GPM Notified Date" := Rec.notified_time_DATE;
      CMWorkorder."CM GPM Notified Time" := Rec.notified_time_TIME;
    END;

    LOCAL PROCEDURE ConvertTimes@1000000012(VAR Rec@1000000000 : Record 50005);
    BEGIN
      DateTime2UTCDateAndTime(Rec.activated_time, Rec.activated_time_DATE, Rec.activated_time_TIME);
      DateTime2UTCDateAndTime(Rec.deactivated_time, Rec.deactivated_time_DATE, Rec.deactivated_time_TIME);
      DateTime2UTCDateAndTime(Rec.notified_time, Rec.notified_time_DATE, Rec.notified_time_TIME);
    END;

    PROCEDURE DateTime2UTCDateAndTime@1000000014(DateTimeValue@1000000000 : DateTime;VAR DateValue@1000000002 : Date;VAR TimeValue@1000000003 : Time);
    VAR
      DotNetDateTime@1000000004 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime";
      DotNetDateTimeKind@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTimeKind";
    BEGIN
      DotNetDateTime := DateTimeValue;

      DateValue := DT2DATE(DateTimeValue);

      TimeValue := DT2TIME(DotNetDateTime.DateTime(DotNetDateTime.Year, DotNetDateTime.Month, DotNetDateTime.Day,
                           DotNetDateTime.Hour, DotNetDateTime.Minute, DotNetDateTime.Second, DotNetDateTimeKind.Local));
    END;

    LOCAL PROCEDURE ConvertGrouping@1000000003(value@1000000000 : Integer) : Integer;
    VAR
      CMWorkorder@1000000001 : Record 5092;
    BEGIN
      {
        GPM says:
        1Communications
        2Production
        3Warnings
        4Manuals
        5Scheduled
      }

      CASE value OF
        1 : EXIT(CMWorkorder."CM GPM Grouping"::Communications);
        2 : EXIT(CMWorkorder."CM GPM Grouping"::Production);
        3 : EXIT(CMWorkorder."CM GPM Grouping"::Warnings);
        4 : EXIT(CMWorkorder."CM GPM Grouping"::Manuals);
        5 : EXIT(CMWorkorder."CM GPM Grouping"::Scheduled);
      END;

      EXIT(0);
    END;

    LOCAL PROCEDURE ConvertState@1000000004(value@1000000000 : Integer) : Integer;
    VAR
      CMWorkorder@1000000001 : Record 5092;
    BEGIN
      {
        GPM says:
        0Activated
        1Assigned
        2Deactivated
        3Deactivated and Assigned
      }

      CASE value OF
        0 : EXIT(CMWorkorder."CM GPM State"::Activated);
        1 : EXIT(CMWorkorder."CM GPM State"::Assigned);
        2 : EXIT(CMWorkorder."CM GPM State"::Deactivated);
        3 : EXIT(CMWorkorder."CM GPM State"::"Deactivated and Assigned");
      END;

      EXIT(0);
    END;

    LOCAL PROCEDURE ConvertAlertType@1000000006(value@1000000000 : Integer) : Integer;
    VAR
      CMWorkorder@1000000001 : Record 5092;
    BEGIN
      {
        GPM says:
        0Usual Alert
        1Alert with Ticket
      }

      CASE value OF
        0 : EXIT(CMWorkorder."CM GPM Alert Type"::"Usual Alert");
        1 : EXIT(CMWorkorder."CM GPM Alert Type"::"Alert with Ticket");
      END;

      EXIT(0);
    END;

    LOCAL PROCEDURE ConvertMaintenanceType@1000000007(value@1000000000 : Integer) : Integer;
    VAR
      CMWorkorder@1000000001 : Record 5092;
    BEGIN
      {
        GPM says:
       -1 Undefined Maintenance
        0NotSpecified Maintenance
        1Corrective Maintenance
        2Preventive Maintenance
        3Deductive Maintenance
      }

      CASE value OF
        -1 : EXIT(CMWorkorder."CM GPM Maintenance Type"::"Undefined Maintenance");
        0 : EXIT(CMWorkorder."CM GPM Maintenance Type"::"NotSpecified Maintenance");
        1 : EXIT(CMWorkorder."CM GPM Maintenance Type"::"Corrective Maintenance");
        2 : EXIT(CMWorkorder."CM GPM Maintenance Type"::"Preventive Maintenance");
        3 : EXIT(CMWorkorder."CM GPM Maintenance Type"::"Deductive Maintenance");
      END;

      EXIT(0);
    END;

    LOCAL PROCEDURE MapOperatorId@1000000010(GpmOperatorId@1000000000 : Integer) : Code[50];
    VAR
      CMAddData@1000000001 : Record 70021;
    BEGIN
      //Mapping between GPM Operator Id and CMMS User ID
      CMAddData.RESET;
      CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::Asset);
      CMAddData.SETRANGE(Type, CMAddData.Type::GpmOperatorMapping);
      CMAddData.SETRANGE(Key1, FORMAT(GpmOperatorId));
      IF CMAddData.FINDFIRST() THEN
        EXIT(CMAddData."User Id");

      EXIT('');
    END;

    LOCAL PROCEDURE MapPlantId@1000000011(GpmPlantId@1000000000 : Integer) : Code[20];
    VAR
      CMAddData@1000000001 : Record 70021;
    BEGIN
      //Mapping between GPM Plant Id and CMMS Asset No.

      CMAddData.RESET;
      CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::Asset);
      CMAddData.SETRANGE(Type, CMAddData.Type::GpmPlantMapping);
      CMAddData.SETRANGE(Key1, FORMAT(GpmPlantId));
      IF CMAddData.FINDFIRST() THEN
        EXIT(CMAddData."Asset No.");

      EXIT('');
    END;

    LOCAL PROCEDURE CheckIngoreOperatorID@1000000009(GpmOperatorId@1000000000 : Integer) : Boolean;
    VAR
      CMAddData@1000000001 : Record 70021;
    BEGIN
      CMAddData.RESET;
      CMAddData.SETRANGE(Objecttype, CMAddData.Objecttype::Asset);
      CMAddData.SETRANGE(Type, CMAddData.Type::GpmOperatorMapping);
      CMAddData.SETRANGE(Key1, FORMAT(GpmOperatorId));
      CMAddData.SETRANGE("Ignore this Operator", TRUE);
      EXIT(CMAddData.FINDFIRST());
    END;

    LOCAL PROCEDURE CloseWorkorder@1000000008();
    BEGIN
    END;

    LOCAL PROCEDURE FillObjectName@1000000031(VAR Rec@1000000000 : Record 5092);
    VAR
      CMObject@1000000001 : Record 70020;
    BEGIN
      IF Rec."CM Object No." <> '' THEN BEGIN
        IF NOT CMObject.GET(Rec."CM Objecttype", Rec."CM Object No.") THEN
          CMObject.INIT;

        Rec."CM Object Name" := CMObject.Name;
        Rec."CM Object Name 2" := CMObject."Name 2";
      END;
    END;

    PROCEDURE "###CMMS###"@1000000002();
    BEGIN
    END;

    PROCEDURE ShowAlarmArchive@1000000022();
    VAR
      Rec@1000000001 : Record 50005;
      ListPage@1000000000 : Page 70002;
    BEGIN
      Rec.RESET;
      //TicketArchive.ASCENDING(TRUE);

      ListPage.SETTABLEVIEW(Rec);
      ListPage.RUN();
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70027 CMMS Reporting Mgmt
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=15:28:01;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=No Fieldset found for Asset %1. (Customer: %2).;DEA=Kein Fieldset fr Anlage %1 gefunden. (Debitor: %2).';
      Text002@1000000001 : TextConst 'ENU=Invalid Call.;DEA=Ungltiger Aufruf.';
      Text003@1000000002 : TextConst 'ENU=Invalid Fieldset "%1". You cannot display Task Data in Workorder Area.;DEA=Ungltiges Fieldset "%1". Es k”nnen keine Task daten im Workorder Bereich angezeigt werden.';

    PROCEDURE "### MD ###"@1000000004();
    BEGIN
    END;

    PROCEDURE MDCustNoSearch@1000000001(VAR RecRef@1000000000 : RecordRef;SearchTerm@1000000001 : Text) : Boolean;
    VAR
      CMMSAdditionalData@1000000002 : Record 70021;
      CMMSObject@1000000003 : Record 70020;
    BEGIN
      IF SearchTerm = '' THEN EXIT(TRUE);
      SearchTerm := STRSUBSTNO('@*%1*',SearchTerm);
      CMMSAdditionalData.RESET;

      CASE RecRef.NUMBER OF
      70020: {CMMS Object = Asset + Project}
        BEGIN
          RecRef.SETTABLE(CMMSObject);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Asset THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Asset);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Project THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Project);
          CMMSAdditionalData.SETRANGE(Key1,CMMSObject."No.");
        END;
      END; {Case}

      CMMSAdditionalData.SETRANGE(Type,CMMSAdditionalData.Type::Customer);
      CMMSAdditionalData.SETFILTER(Key3,SearchTerm);

      IF CMMSAdditionalData.FINDFIRST THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE MDCustNameSearch@1000000012(VAR RecRef@1000000000 : RecordRef;SearchTerm@1000000001 : Text) : Boolean;
    VAR
      CMMSAdditionalData@1000000002 : Record 70021;
      CMMSObject@1000000003 : Record 70020;
    BEGIN
      IF SearchTerm = '' THEN EXIT(TRUE);
      SearchTerm := STRSUBSTNO('@*%1*',SearchTerm);
      CMMSAdditionalData.RESET;

      CASE RecRef.NUMBER OF
      70020: {CMMS Object = Asset + Project}
        BEGIN
          RecRef.SETTABLE(CMMSObject);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Asset THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Asset);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Project THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Project);
          CMMSAdditionalData.SETRANGE(Key1,CMMSObject."No.");
        END;
      END; {Case}

      CMMSAdditionalData.SETRANGE(Type,CMMSAdditionalData.Type::Customer);
      CMMSAdditionalData.SETFILTER("Customer Name",SearchTerm);

      IF CMMSAdditionalData.FINDFIRST THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE MDCustChainSearch@1000000013(VAR RecRef@1000000000 : RecordRef;SearchTerm@1000000001 : Text) : Boolean;
    VAR
      CMMSAdditionalData@1000000002 : Record 70021;
      CMMSObject@1000000003 : Record 70020;
    BEGIN
      IF SearchTerm = '' THEN EXIT(TRUE);
      SearchTerm := STRSUBSTNO('@*%1*',SearchTerm);
      CMMSAdditionalData.RESET;

      CASE RecRef.NUMBER OF
      70020: {CMMS Object = Asset + Project}
        BEGIN
          RecRef.SETTABLE(CMMSObject);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Asset THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Asset);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Project THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Project);
          CMMSAdditionalData.SETRANGE(Key1,CMMSObject."No.");
        END;
      END; {Case}

      CMMSAdditionalData.SETRANGE(Type,CMMSAdditionalData.Type::Customer);
      CMMSAdditionalData.SETFILTER("Customer Company Chain",SearchTerm);

      IF CMMSAdditionalData.FINDFIRST THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE MDProjectNoSearch@1000000000(VAR RecRef@1000000000 : RecordRef;SearchTerm@1000000001 : Text) : Boolean;
    VAR
      CMMSAdditionalData@1000000002 : Record 70021;
      CMMSObject@1000000003 : Record 70020;
    BEGIN
      IF SearchTerm = '' THEN EXIT(TRUE);
      SearchTerm := STRSUBSTNO('@*%1*',SearchTerm);
      CMMSAdditionalData.RESET;

      CASE RecRef.NUMBER OF
      70020: {CMMS Object = Asset + Project}
        BEGIN
          RecRef.SETTABLE(CMMSObject);
          {
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Asset THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Asset);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Project THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Project);
          }
          CMMSAdditionalData.SETRANGE(Key1,CMMSObject."No.");
        END;
      END; {Case}

      CMMSAdditionalData.SETRANGE(Type,CMMSAdditionalData.Type::Project);
      CMMSAdditionalData.SETFILTER(Key2,SearchTerm);

      IF CMMSAdditionalData.FINDFIRST THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE MDProjectNameSearch@1000000006(VAR RecRef@1000000000 : RecordRef;SearchTerm@1000000001 : Text) : Boolean;
    VAR
      CMMSAdditionalData@1000000002 : Record 70021;
      CMMSObject@1000000003 : Record 70020;
    BEGIN
      IF SearchTerm = '' THEN EXIT(TRUE);
      SearchTerm := STRSUBSTNO('@*%1*',SearchTerm);
      CMMSAdditionalData.RESET;
      CMMSAdditionalData.CALCFIELDS("Project NameXX");

      CASE RecRef.NUMBER OF
      70020: {CMMS Object = Asset + Project}
        BEGIN
          RecRef.SETTABLE(CMMSObject);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Asset THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Asset);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Project THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Project);
          CMMSAdditionalData.SETRANGE(Key1,CMMSObject."No.");
        END;
      END; {Case}

      CMMSAdditionalData.SETRANGE(Type,CMMSAdditionalData.Type::Project);
      CMMSAdditionalData.SETFILTER("Project NameXX",SearchTerm);

      IF CMMSAdditionalData.FINDFIRST THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE MDContractNoSearch@1000000008(VAR RecRef@1000000000 : RecordRef;SearchTerm@1000000001 : Text) : Boolean;
    VAR
      CMMSAdditionalData@1000000002 : Record 70021;
      CMMSObject@1000000003 : Record 70020;
    BEGIN
      IF SearchTerm = '' THEN EXIT(TRUE);
      SearchTerm := STRSUBSTNO('@*%1*',SearchTerm);
      CMMSAdditionalData.RESET;

      CASE RecRef.NUMBER OF
      70020: {CMMS Object = Asset + Project}
        BEGIN
          RecRef.SETTABLE(CMMSObject);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Asset THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Asset);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Project THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Project);
          CMMSAdditionalData.SETRANGE(Key1,CMMSObject."No.");
        END;
      END; {Case}

      CMMSAdditionalData.SETRANGE(Type,CMMSAdditionalData.Type::Contract);
      CMMSAdditionalData.SETFILTER(Key2,SearchTerm);

      IF CMMSAdditionalData.FINDFIRST THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE MDContactNoSearch@1000000009(VAR RecRef@1000000000 : RecordRef;SearchTerm@1000000001 : Text) : Boolean;
    VAR
      CMMSAdditionalData@1000000002 : Record 70021;
      CMMSObject@1000000003 : Record 70020;
    BEGIN
      IF SearchTerm = '' THEN EXIT(TRUE);
      SearchTerm := STRSUBSTNO('@*%1*',SearchTerm);
      CMMSAdditionalData.RESET;

      CASE RecRef.NUMBER OF
      70020: {CMMS Object = Asset + Project}
        BEGIN
          RecRef.SETTABLE(CMMSObject);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Asset THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Asset);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Project THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Project);
          CMMSAdditionalData.SETRANGE(Key1,CMMSObject."No.");
        END;
      END; {Case}

      CMMSAdditionalData.SETRANGE(Type,CMMSAdditionalData.Type::Relation);
      CMMSAdditionalData.SETFILTER(Key2,SearchTerm);

      IF CMMSAdditionalData.FINDFIRST THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE MDBusRelationSearch@1000000010(VAR RecRef@1000000000 : RecordRef;SearchTerm@1000000001 : Text) : Boolean;
    VAR
      CMMSAdditionalData@1000000002 : Record 70021;
      CMMSObject@1000000003 : Record 70020;
    BEGIN
      IF SearchTerm = '' THEN EXIT(TRUE);
      SearchTerm := STRSUBSTNO('@*%1*',SearchTerm);
      CMMSAdditionalData.RESET;

      CASE RecRef.NUMBER OF
      70020: {CMMS Object = Asset + Project}
        BEGIN
          RecRef.SETTABLE(CMMSObject);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Asset THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Asset);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Project THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Project);
          CMMSAdditionalData.SETRANGE(Key1,CMMSObject."No.");
        END;
      END; {Case}

      CMMSAdditionalData.SETRANGE(Type,CMMSAdditionalData.Type::Relation);
      CMMSAdditionalData.SETFILTER("Business Relation Code",SearchTerm);

      IF CMMSAdditionalData.FINDFIRST THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE MDUserIDSearch@1000000002(VAR RecRef@1000000000 : RecordRef;SearchTerm@1000000001 : Text) : Boolean;
    VAR
      CMMSAdditionalData@1000000002 : Record 70021;
      CMMSObject@1000000003 : Record 70020;
    BEGIN
      IF SearchTerm = '' THEN EXIT(TRUE);
      SearchTerm := STRSUBSTNO('@*%1*',SearchTerm);
      CMMSAdditionalData.RESET;

      CASE RecRef.NUMBER OF
      70020: {CMMS Object = Asset + Project}
        BEGIN
          RecRef.SETTABLE(CMMSObject);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Asset THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Asset);
          IF CMMSObject.Objecttype = CMMSObject.Objecttype::Project THEN
            CMMSAdditionalData.SETRANGE(Objecttype,CMMSAdditionalData.Objecttype::Project);
          CMMSAdditionalData.SETRANGE(Key1,CMMSObject."No.");
        END;
      END; {Case}

      CMMSAdditionalData.SETRANGE(Type,CMMSAdditionalData.Type::User);
      CMMSAdditionalData.SETFILTER(Key2,SearchTerm);

      IF CMMSAdditionalData.FINDFIRST THEN
        EXIT(TRUE)
      ELSE
        EXIT(FALSE);
    END;

    PROCEDURE MDSecuritySearch@1000000003(VAR RecRef@1000000001 : RecordRef;SearchTerm@1000000000 : Text) : Boolean;
    VAR
      CMMSObject@1000000002 : Record 70020;
      UserSetup@1000000003 : Record 91;
      CMMSObject2@1000000004 : Record 70020;
    BEGIN
      IF NOT UserSetup.GET(USERID) THEN
        EXIT(FALSE);

      CASE RecRef.NUMBER OF
      70020: {CMMS Object = Asset + Project}
        BEGIN
          RecRef.SETTABLE(CMMSObject);
          IF MDUserIDSearch(RecRef,USERID) THEN EXIT(TRUE);
          CMMSObject2.RESET;
          CMMSObject2.SETRANGE(Objecttype,CMMSObject.Objecttype);
          CMMSObject2.SETRANGE("No.",CMMSObject."No.");
          CASE CMMSObject.Objecttype OF
            CMMSObject.Objecttype:: Asset:
              BEGIN
                IF UserSetup."IG Asset Administrator" THEN EXIT(TRUE);
                IF UserSetup."IG Asset Resp. Ctr. Filter" = '' THEN EXIT(FALSE);
                CMMSObject2.SETFILTER("Responsibility Center",UserSetup."IG Asset Resp. Ctr. Filter");
              END;
            CMMSObject.Objecttype:: Project:
              BEGIN
                IF UserSetup."IG Project Administrator" THEN EXIT(TRUE);
                IF UserSetup."IG Project Resp. Ctr. Filter" = '' THEN EXIT(FALSE);
                CMMSObject2.SETFILTER("Responsibility Center",UserSetup."IG Project Resp. Ctr. Filter");
              END;
          END;
            IF CMMSObject2.COUNT = 0 THEN
              EXIT(FALSE)
            ELSE
              EXIT(TRUE);
        END;
      END; {Case}

      EXIT(FALSE);
    END;

    PROCEDURE "### Fieldsets ###"@1000000005();
    BEGIN
    END;

    PROCEDURE FindReportFieldsetSetup@1000000007(Asset@1000000000 : Record 70020;VAR CMReportFieldset@1000000004 : Record 70021;ShowError@1000000008 : Boolean) : Integer;
    VAR
      CMAssetCustomer@1000000001 : Record 70021;
      CustomerNo@1000000002 : Code[20];
      CustomerCompany@1000000003 : Text[30];
      CMReportFieldsetSetup@1000000005 : Record 70021;
      Result@1000000006 : Integer;
      FieldsetCode@1000000007 : Code[20];
    BEGIN
      //Find Customer
      Result := 0;
      CMAssetCustomer.RESET;
      CMAssetCustomer.SETRANGE(Objecttype, CMAssetCustomer.Objecttype::Asset);
      CMAssetCustomer.SETRANGE(Type, CMAssetCustomer.Type::Customer);
      CMAssetCustomer.SETRANGE(Key1, Asset."No.");
      CMAssetCustomer.SETFILTER(Key3, '<>%1', '');
      IF CMAssetCustomer.FINDFIRST() THEN BEGIN
        CustomerNo := CMAssetCustomer.Key3;
        CustomerCompany := CMAssetCustomer.GetObjectCompanyName();
      END;

      CMReportFieldsetSetup.RESET;
      CMReportFieldsetSetup.SETRANGE(Objecttype, CMReportFieldsetSetup.Objecttype::Asset);
      CMReportFieldsetSetup.SETRANGE(Type, CMReportFieldsetSetup.Type::ReportFieldsetSetup);
      //1: Asset Nr. + Customer No.
      CMReportFieldsetSetup.SETRANGE(Key2, Asset."No.");
      CMReportFieldsetSetup.SETRANGE(Key3, CustomerNo);
      IF (CMReportFieldsetSetup.FINDFIRST()) AND (Result = 0) THEN BEGIN
        FieldsetCode := CMReportFieldsetSetup."Fieldset Code";
        Result := 1;
      END;

      //2: Asset Nr.
      CMReportFieldsetSetup.SETRANGE(Key2, Asset."No.");
      CMReportFieldsetSetup.SETRANGE(Key3, '');
      IF (CMReportFieldsetSetup.FINDFIRST()) AND (Result = 0)  THEN BEGIN
        FieldsetCode := CMReportFieldsetSetup."Fieldset Code";
        Result := 2;
      END;

      //3: Cluster/Portfolio + Customer No.
      CMReportFieldsetSetup.SETRANGE(Key2, UPPERCASE(Asset.Portfolio));
      CMReportFieldsetSetup.SETRANGE(Key3, CustomerNo);
      IF (CMReportFieldsetSetup.FINDFIRST()) AND (Result = 0)  THEN BEGIN
        FieldsetCode := CMReportFieldsetSetup."Fieldset Code";
        Result := 3;
      END;

      //4: Cluster/Portfolio
      CMReportFieldsetSetup.SETRANGE(Key2, UPPERCASE(Asset.Portfolio));
      CMReportFieldsetSetup.SETRANGE(Key3, '');
      IF (CMReportFieldsetSetup.FINDFIRST()) AND (Result = 0)  THEN BEGIN
        FieldsetCode := CMReportFieldsetSetup."Fieldset Code";
        Result := 4;
      END;

      //5: DEFAULT
      CMReportFieldset.SETRANGE(CMReportFieldset.Objecttype, CMReportFieldset.Objecttype::Asset);
      CMReportFieldset.SETRANGE(Type, CMReportFieldset.Type::Fieldset);
      CMReportFieldset.SETRANGE("Default Fieldset", TRUE);
      IF (CMReportFieldset.FINDFIRST()) AND (Result = 0)  THEN BEGIN
        FieldsetCode := CMReportFieldset.Key1;
        Result := 5;
      END;

      CMReportFieldset.RESET;
      IF FieldsetCode <> '' THEN
        CMReportFieldset.GET(CMReportFieldset.Objecttype::Asset, CMReportFieldset.Type::Fieldset, FieldsetCode, '', '', 0);
      IF (Result = 0) AND (ShowError) THEN
        ERROR(Text001, Asset."No.", CustomerNo);
      EXIT(Result);
    END;

    PROCEDURE BuildFieldsetBuffer@1000000014(VAR Buffer@1000000006 : TEMPORARY Record 70021;Area@1000000003 : Integer;VAR Asset@1000000001 : Record 70020;VAR Workorder@1000000004 : Record 5092;VAR Task@1000000005 : Record 5080);
    VAR
      CMFieldset@1000000000 : Record 70021;
      CMFieldsetRow@1000000002 : Record 70021;
      EntryNo@1000000007 : Integer;
    BEGIN
      IF NOT Buffer.ISTEMPORARY THEN
        ERROR(Text002);

      Buffer.RESET;
      Buffer.DELETEALL;
      EntryNo := 0;
      FindReportFieldsetSetup(Asset, CMFieldset, TRUE);

      CMFieldsetRow.RESET;
      CMFieldsetRow.SETCURRENTKEY(Objecttype,Type,Key1,Area,Position,Order);
      CMFieldsetRow.SETRANGE(Objecttype, CMFieldsetRow.Objecttype::Asset);
      CMFieldsetRow.SETRANGE(Type, CMFieldsetRow.Type::FieldsetRow);
      CMFieldsetRow.SETRANGE(Key1, CMFieldset.Key1);
      CMFieldsetRow.SETRANGE(Area, Area);
      IF CMFieldsetRow.FIND('-') THEN BEGIN
        REPEAT
          AddBufferEntry(Buffer, CMFieldsetRow, Asset, Workorder, Task);
        UNTIL CMFieldsetRow.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE AddBufferEntry@1000000016(VAR Buffer@1000000001 : TEMPORARY Record 70021;Row@1000000000 : Record 70021;VAR Asset@1000000006 : Record 70020;VAR Workorder@1000000004 : Record 5092;VAR Task@1000000003 : Record 5080);
    VAR
      CaptionRefRef@1000000002 : RecordRef;
      ValueRefRef@1000000009 : RecordRef;
    BEGIN
      Buffer.INIT;
      Buffer.TRANSFERFIELDS(Row);

      IF (Row.Area = Row.Area::Workorder) AND
         ((Row."Caption Table" = Row."Caption Table"::Task) OR (Row."Value Table" = Row."Value Table"::Task)) THEN
          ERROR(Text003, Row.Key1);


      CASE Row."Caption Table" OF
        Row."Caption Table"::Task : CaptionRefRef.GETTABLE(Task);
        Row."Caption Table"::Workorder : CaptionRefRef.GETTABLE(Workorder);
        Row."Caption Table"::Asset : CaptionRefRef.GETTABLE(Asset);
      END;

      CASE Row."Value Table" OF
        Row."Value Table"::Task : ValueRefRef.GETTABLE(Task);
        Row."Value Table"::Workorder : ValueRefRef.GETTABLE(Workorder);
        Row."Value Table"::Asset : ValueRefRef.GETTABLE(Asset);
      END;

      Buffer."Caption Text" := GetValue(Row,CaptionRefRef,0);
      Buffer."Value Text" := GetValue(Row,ValueRefRef,1);

      Buffer.INSERT(FALSE);
    END;

    LOCAL PROCEDURE GetValue@1000000017(Row@1000000001 : Record 70021;VAR RefRef@1000000000 : RecordRef;which@1000000002 : 'caption,value') : Text;
    VAR
      FRef@1000000003 : FieldRef;
    BEGIN
      IF which = which::caption THEN BEGIN
        IF Row."Caption Type" IN [Row."Caption Type"::Caption, Row."Caption Type"::Value] THEN BEGIN
          Row.TESTFIELD("Caption Field Id");

          FRef := RefRef.FIELD(Row."Caption Field Id");
          IF Row."Caption Type" = Row."Caption Type"::Caption THEN
            EXIT(FRef.CAPTION);
          IF Row."Caption Type" = Row."Caption Type"::Value THEN
            EXIT(FORMAT(FRef));
        END;
        IF Row."Caption Type" = Row."Caption Type"::Text THEN
          EXIT(Row."Caption Text");
      END;

      IF which = which::value THEN BEGIN
        IF Row."Value Type" IN [Row."Value Type"::Caption, Row."Value Type"::Value] THEN BEGIN
          Row.TESTFIELD("Value Field Id");
          FRef := RefRef.FIELD(Row."Value Field Id");
          IF FORMAT(FRef.CLASS) = 'FlowField' THEN
            FRef.CALCFIELD();

          IF Row."Value Type" = Row."Value Type"::Caption THEN
            EXIT(FRef.CAPTION);
          IF Row."Value Type" = Row."Value Type"::Value THEN
            EXIT(FORMAT(FRef));
        END;
        IF Row."Value Type" = Row."Value Type"::Text THEN
          EXIT(Row."Value Text");
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70028 IG Excel Export
{
  OBJECT-PROPERTIES
  {
    Date=07.09.17;
    Time=15:10:16;
    Modified=Yes;
    Version List=IG,CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      TempExcelBuffer@1000000000 : TEMPORARY Record 370;
      TempIGReportBuffer@1000000001 : TEMPORARY Record 70007;
      IGTplExcelBuffer@1000000003 : TEMPORARY Record 370;
      IGTplInstanceFile@1000000002 : Text;
      IGSheetNo@1000000004 : Integer;
      IGTplNoOfSheets@1000000005 : Integer;
      Text001@1000000008 : TextConst 'ENU=Invalid Call;DEA=Ungltiger Aufruf';

    PROCEDURE "### Enter Data Fuctions ###"@1000000014();
    BEGIN
    END;

    PROCEDURE EnterHeader@1000000006(SheetHeader@1000000000 : Text[250];FilterText@1000000002 : Text[250];VAR RowNo@1000000001 : Integer);
    BEGIN
      RowNo +=1;
      EnterCell(RowNo,1,SheetHeader,TRUE,FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text); {Number,Text,Date,Time}
      RowNo +=1;
      EnterCell(RowNo,1,COMPANYNAME,FALSE,FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text); {Number,Text,Date,Time}
      RowNo +=1;
      EnterCell(RowNo,1,STRSUBSTNO('%1, %2',USERID,TODAY),FALSE,FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text); {Number,Text,Date,Time}
      IF FilterText <> '' THEN BEGIN
        RowNo +=1;
        EnterCell(RowNo,1,FilterText,FALSE,FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text); {Number,Text,Date,Time}
      END;
    END;

    PROCEDURE EnterCell@2(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Bold@1003 : Boolean;Italic@1004 : Boolean;UnderLine@1005 : Boolean;DoubleUnderLine@1008 : Boolean;Format@1006 : Text[30];CellType@1007 : Option);
    BEGIN
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := Bold;
      TempExcelBuffer.Italic := Italic;
      IF DoubleUnderLine = TRUE THEN BEGIN
        TempExcelBuffer."Double Underline" := TRUE;
        TempExcelBuffer.Underline := FALSE;
      END ELSE BEGIN
        TempExcelBuffer."Double Underline" := FALSE;
        TempExcelBuffer.Underline := UnderLine;
      END;
      TempExcelBuffer.NumberFormat := Format;
      TempExcelBuffer."Cell Type" := CellType;
      //TempExcelBuffer."IG Backgroundcolor HEX" := GetBgColor('');
      //TempExcelBuffer."IG Forecolor HEX" := GetForeColor('');
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE EnterCellMin@1000000009(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250]);
    BEGIN
      //IG AD
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := FALSE;
      TempExcelBuffer.Italic := FALSE;
      TempExcelBuffer."Double Underline" := FALSE;
      TempExcelBuffer.Underline := FALSE;
      TempExcelBuffer.NumberFormat := '';
      TempExcelBuffer."Cell Type" := 1; //Text
      //TempExcelBuffer."IG Backgroundcolor HEX" := GetBgColor('');
      //TempExcelBuffer."IG Forecolor HEX" := GetForeColor('');
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE EnterCellMinChar@1000000001(RowNo@1000 : Integer;ColumnChar@1001 : Text;CellValue@1002 : Text[250]);
    BEGIN
      EnterCellMin(RowNo, ColCharToNo(ColumnChar), CellValue);
    END;

    PROCEDURE EnterCellExt@1000000012(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Format@1000000001 : Text[30];CellType@1000000000 : Option);
    BEGIN
      //IG AD
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := FALSE;
      TempExcelBuffer.Italic := FALSE;
      TempExcelBuffer."Double Underline" := FALSE;
      TempExcelBuffer.Underline := FALSE;
      TempExcelBuffer.NumberFormat := Format;
      TempExcelBuffer."Cell Type" := CellType;
      //TempExcelBuffer."IG Backgroundcolor HEX" := GetBgColor('');
      //TempExcelBuffer."IG Forecolor HEX" := GetForeColor('');
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE EnterCellMinBold@1000000011(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250]);
    BEGIN
      //IG AD
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := TRUE;
      TempExcelBuffer.Italic := FALSE;
      TempExcelBuffer."Double Underline" := FALSE;
      TempExcelBuffer.Underline := FALSE;
      TempExcelBuffer.NumberFormat := '';
      TempExcelBuffer."Cell Type" := 1; //Text
      //TempExcelBuffer."IG Backgroundcolor HEX" := GetBgColor('');
      //TempExcelBuffer."IG Forecolor HEX" := GetForeColor('');
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE EnterCellExtBold@1000000010(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Format@1000000001 : Text[30];CellType@1000000000 : Option);
    BEGIN
      //IG AD
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := TRUE;
      TempExcelBuffer.Italic := FALSE;
      TempExcelBuffer."Double Underline" := FALSE;
      TempExcelBuffer.Underline := FALSE;
      TempExcelBuffer.NumberFormat := Format;
      TempExcelBuffer."Cell Type" := CellType;
      //TempExcelBuffer."IG Backgroundcolor HEX" := GetBgColor('');
      //TempExcelBuffer."IG Forecolor HEX" := GetForeColor('');
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE EnterCellColor@1000000020(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Bold@1003 : Boolean;Italic@1004 : Boolean;UnderLine@1005 : Boolean;DoubleUnderLine@1008 : Boolean;Format@1006 : Text[30];CellType@1007 : Option;BgColorHEX@1000000000 : Code[6];ForeColorHEX@1000000001 : Code[6]);
    BEGIN
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := Bold;
      TempExcelBuffer.Italic := Italic;
      IF DoubleUnderLine = TRUE THEN BEGIN
        TempExcelBuffer."Double Underline" := TRUE;
        TempExcelBuffer.Underline := FALSE;
      END ELSE BEGIN
        TempExcelBuffer."Double Underline" := FALSE;
        TempExcelBuffer.Underline := UnderLine;
      END;
      TempExcelBuffer.NumberFormat := Format;
      TempExcelBuffer."Cell Type" := CellType;
      //TempExcelBuffer."IG Backgroundcolor HEX" := GetBgColor(BgColorHEX);
      //TempExcelBuffer."IG Forecolor HEX" := GetForeColor(ForeColorHEX);
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE EnterCellMinColor@1000000019(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];BgColorHEX@1000000001 : Code[6];ForeColorHEX@1000000000 : Code[6]);
    BEGIN
      //IG AD
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := FALSE;
      TempExcelBuffer.Italic := FALSE;
      TempExcelBuffer."Double Underline" := FALSE;
      TempExcelBuffer.Underline := FALSE;
      TempExcelBuffer.NumberFormat := '';
      TempExcelBuffer."Cell Type" := 1; //Text
      //TempExcelBuffer."IG Backgroundcolor HEX" := GetBgColor(BgColorHEX);
      //TempExcelBuffer."IG Forecolor HEX" := GetForeColor(ForeColorHEX);
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE EnterCellExtColor@1000000018(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Format@1000000001 : Text[30];CellType@1000000000 : Option;BgColorHEX@1000000003 : Code[6];ForeColorHEX@1000000002 : Code[6]);
    BEGIN
      //IG AD
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := FALSE;
      TempExcelBuffer.Italic := FALSE;
      TempExcelBuffer."Double Underline" := FALSE;
      TempExcelBuffer.Underline := FALSE;
      TempExcelBuffer.NumberFormat := Format;
      TempExcelBuffer."Cell Type" := CellType;
      //TempExcelBuffer."IG Backgroundcolor HEX" := GetBgColor(BgColorHEX);
      //TempExcelBuffer."IG Forecolor HEX" := GetForeColor(ForeColorHEX);
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE EnterCellMinBoldColor@1000000017(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];BgColorHEX@1000000001 : Code[6];ForeColorHEX@1000000000 : Code[6]);
    BEGIN
      //IG AD
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := TRUE;
      TempExcelBuffer.Italic := FALSE;
      TempExcelBuffer."Double Underline" := FALSE;
      TempExcelBuffer.Underline := FALSE;
      TempExcelBuffer.NumberFormat := '';
      TempExcelBuffer."Cell Type" := 1; //Text
      //TempExcelBuffer."IG Backgroundcolor HEX" := GetBgColor(BgColorHEX);
      //TempExcelBuffer."IG Forecolor HEX" := GetForeColor(ForeColorHEX);
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE EnterCellExtBoldColor@1000000016(RowNo@1000 : Integer;ColumnNo@1001 : Integer;CellValue@1002 : Text[250];Format@1000000001 : Text[30];CellType@1000000000 : Option;BgColorHEX@1000000003 : Code[6];ForeColorHEX@1000000002 : Code[6]);
    BEGIN
      //IG AD
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := '';
      TempExcelBuffer.Bold := TRUE;
      TempExcelBuffer.Italic := FALSE;
      TempExcelBuffer."Double Underline" := FALSE;
      TempExcelBuffer.Underline := FALSE;
      TempExcelBuffer.NumberFormat := Format;
      TempExcelBuffer."Cell Type" := CellType;
      //TempExcelBuffer."IG Backgroundcolor HEX" := GetBgColor(BgColorHEX);
      //TempExcelBuffer."IG Forecolor HEX" := GetForeColor(ForeColorHEX);
      TempExcelBuffer.INSERT;
    END;

    PROCEDURE "### Workbook Functions ###"@1000000015();
    BEGIN
    END;

    PROCEDURE UseTemplate@1000000023(TemplateNo@1000000000 : Integer;SheetNo@1000000001 : Integer);
    VAR
      CMMSGenSetup@1000000002 : Record 70000;
      NoOfSheets@1000000003 : Integer;
      i@1000000004 : Integer;
      FileMgt@1000000005 : Codeunit 419;
      IGTplFile@1000000006 : Text[250];
    BEGIN
      //IG AD
      //Using Excel Template defined in IG General Setup. Call Function before CreateBook(); Create2ndWorksheet(); and CloseBook();
      //Supports up to 4 Sheets
      IGTplInstanceFile := '';

      IF (TemplateNo < 1) OR (TemplateNo > 3) THEN
        ERROR(Text001);

      IF NOT CMMSGenSetup.GET() THEN
        CMMSGenSetup.INIT;


      IF TemplateNo = 1 THEN IGTplFile := CMMSGenSetup."Excel Export Template 1 Path";
      IF TemplateNo = 2 THEN IGTplFile := CMMSGenSetup."Excel Export Template 2 Path";
      IF TemplateNo = 3 THEN IGTplFile := CMMSGenSetup."Excel Export Template 3 Path";

      FileMgt.ServerFileExists(IGTplFile);

      IGTplInstanceFile := FileMgt.ServerTempFileName(FileMgt.GetExtension(IGTplFile));
      //DotNetDateTime := DotNetDateTime.Now();
      //IGTplInstanceFile := FileMgt.GetDirectoryName(IGTplFile) + CONVERTSTR(USERID,'\','_') + '_' +
      //                     FORMAT(DotNetDateTime.Ticks()) + '.' + FileMgt.GetExtension(IGTplFile);



      FileMgt.CopyServerFile(IGTplFile,IGTplInstanceFile,TRUE);
      IGTplNoOfSheets := GetNoOfSheets(IGTplInstanceFile);
      IGSheetNo := SheetNo;
    END;

    PROCEDURE CreateBook@1000000004(SheetName@1000000000 : Text[250];SheetHeader@1000000001 : Text[250]);
    BEGIN
      //Tpl:
      IF IGTplInstanceFile <> '' THEN BEGIN
        //IGSheetNo := 0;

        TempExcelBuffer.UpdateBook(IGTplInstanceFile,GetSheetNameByNo(IGTplInstanceFile,IGSheetNo));
        TempExcelBuffer.IGSetCurrentSheetName(SheetName);
        TempExcelBuffer.WriteSheet(SheetHeader,COMPANYNAME,USERID);
        TempExcelBuffer.DELETEALL;

        IGSheetNo += 1;
        TempExcelBuffer.CloseBook();
        EXIT;
      END;

      TempExcelBuffer.CreateBook('',SheetName);
      TempExcelBuffer.WriteSheet(SheetHeader,COMPANYNAME,USERID);

      TempExcelBuffer.DELETEALL;
    END;

    PROCEDURE Create2ndWorksheet@1000000002(SheetName@1000000000 : Text[250];SheetHeader@1000000001 : Text[250]);
    BEGIN
      //Tpl:
      IF (IGTplInstanceFile <> '') AND ((IGSheetNo + 1) <= IGTplNoOfSheets) THEN BEGIN
        TempExcelBuffer.UpdateBook(IGTplInstanceFile,GetSheetNameByNo(IGTplInstanceFile,IGSheetNo));
        TempExcelBuffer.IGSetCurrentSheetName(SheetName);

        TempExcelBuffer.WriteSheet(SheetHeader,COMPANYNAME,USERID);
        TempExcelBuffer.DELETEALL;

        IGSheetNo += 1;
        TempExcelBuffer.CloseBook();
        EXIT;
      END;

      TempExcelBuffer.ENCCreateWorksheet(SheetName);
      TempExcelBuffer.ENCUpdateBook(SheetName);
      TempExcelBuffer.WriteSheet(SheetHeader,COMPANYNAME,USERID);

      TempExcelBuffer.DELETEALL;
    END;

    PROCEDURE CloseBook@1000000005();
    VAR
      FileMgt@1000000000 : Codeunit 419;
    BEGIN
      TempExcelBuffer.CloseBook;
      TempExcelBuffer.OpenExcel;
      TempExcelBuffer.GiveUserControl;

      //Tpl:
      IF IGTplInstanceFile <> '' THEN BEGIN
        FileMgt.DeleteServerFile(IGTplInstanceFile);
      END
    END;

    PROCEDURE GetFirstSheetName@1000000026(FileName@1000 : Text) : Text[250];
    BEGIN
      EXIT(GetSheetNameByNo(FileName,0));
    END;

    PROCEDURE GetSheetNameByNo@1000000024(FileName@1000 : Text;SheetNo@1000000000 : Integer) : Text[250];
    VAR
      TempNameValueBuffer@1009 : TEMPORARY Record 823;
      SheetNames@1008 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.ArrayList";
      SheetName@1002 : Text[250];
      SelectedSheetName@1007 : Text[250];
      i@1001 : Integer;
      XlWrkBkReader@1000000002 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorkbookReader";
    BEGIN
      //IG AD - Returns Sheet Name for given Sheet No - starting by 0

      XlWrkBkReader := XlWrkBkReader.Open(FileName);

      SelectedSheetName := '';
      SheetNames := SheetNames.ArrayList(XlWrkBkReader.SheetNames);
      IF (NOT ISNULL(SheetNames)) AND (NOT ISNULL(SheetNames.Item(SheetNo)))THEN BEGIN
        SelectedSheetName := SheetNames.Item(SheetNo);
      END;

      XlWrkBkReader.Close();
      CLEAR(XlWrkBkReader);

      EXIT(SelectedSheetName);
    END;

    PROCEDURE GetNoOfSheets@1000000022(FileName@1000 : Text) : Integer;
    VAR
      TempNameValueBuffer@1009 : TEMPORARY Record 823;
      SheetNames@1008 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.ArrayList";
      XlWrkBkReader@1000000000 : DotNet "'Microsoft.Dynamics.Nav.OpenXml, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.OpenXml.Spreadsheet.WorkbookReader";
    BEGIN
      //IG AD
      XlWrkBkReader := XlWrkBkReader.Open(FileName);

      SheetNames := SheetNames.ArrayList(XlWrkBkReader.SheetNames);

      XlWrkBkReader.Close();
      CLEAR(XlWrkBkReader);

      EXIT(SheetNames.Count);
    END;

    PROCEDURE "### Misc. Funtions ###"@1000000021();
    BEGIN
    END;

    PROCEDURE IncInt@1000000007(VAR i@1000000000 : Integer) : Integer;
    BEGIN
      i += 1;
      EXIT(i);
    END;

    PROCEDURE ColCharToNo@1000000000(value@1000000002 : Text) : Integer;
    VAR
      i@1000000001 : Integer;
      r@1000000003 : Integer;
      p@1000000004 : Integer;
    BEGIN
      IF value = '' THEN
        EXIT(0);

      value := UPPERCASE(value);

      r := 0;
      p := 0;
      i := STRLEN(value);
      WHILE i > 0 DO BEGIN
        r += (value[i] - 64) * POWER(26,p);
        i -= 1;
        p += 1;
      END;

      EXIT(r);
    END;

    PROCEDURE IGSetBackgroundColor@1000000003(HexColor@1000000012 : Code[6]);
    BEGIN
      TempExcelBuffer.IGSetBackgroundColor(HexColor);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70029 CMMS Scheduling Tool Mgmt.
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=13:45:43;
    Modified=Yes;
    Version List=CMMS,SCT;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Buffer@1000000002 : TEMPORARY Record 50002;
      DayBuffer@1000000004 : TEMPORARY Record 50002;
      PeriodBuffer@1000000003 : TEMPORARY Record 50002;
      EntryNo@1000000000 : Integer;
      EntryNoDay@1000000001 : Integer;
      EntryNoPeriod@1000000005 : Integer;
      Text001@1000000006 : TextConst 'ENU=User ID;DEA=Benutzer ID';
      Text002@1000000007 : TextConst 'ENU=Username;DEA=Benutzername';
      Text003@1000000008 : TextConst 'ENU=Object No.;DEA=Objektnr.';
      Text004@1000000009 : TextConst 'ENU=Objectname;DEA=Objektname';

    PROCEDURE "###MATRIX###"@1000000005();
    BEGIN
    END;

    PROCEDURE LoadRecordData@1000000001(TempRec@1000000000 : TEMPORARY Record 50002;VAR Values@1000000011 : ARRAY [31] OF Text;VAR Styles@1000000001 : ARRAY [31] OF Text;VAR MainStyle@1000000008 : Text;VAR Level@1000000009 : Integer;StartDate@1000000010 : Date;Mode@1000000003 : 'Week,Month');
    VAR
      TotalDays@1000000002 : Integer;
      DayNo@1000000004 : Integer;
      RefDate@1000000007 : Date;
    BEGIN
      TotalDays := GetTotalDays(StartDate, Mode);
      RefDate := StartDate;

      Buffer.RESET;
      Buffer.SETCURRENTKEY(SourceNo1, SourceNo2, PostingDate1,EntryNo1);
      DayBuffer.RESET;
      DayBuffer.SETCURRENTKEY(SourceNo1, SourceNo2, PostingDate1);

      IF TempRec.EntryNo1 = 0 THEN BEGIN //Headline
        Level := 0;
        MainStyle := 'Strong';
        FOR DayNo := 1 TO TotalDays DO BEGIN
          Values[DayNo] := '';
          Styles[DayNo] := '';

          //Get Day Buffer
          DayBuffer.SETRANGE(SourceNo1, TempRec.SourceNo1);
          DayBuffer.SETRANGE(SourceNo2, TempRec.SourceNo2);
          DayBuffer.SETRANGE(PostingDate1, RefDate);
          DayBuffer.FINDFIRST();

          IF DayBuffer.EntryNo1 > 0 THEN
            Values[DayNo] := FORMAT(DayBuffer.EntryNo1);

          Styles[DayNo] := GetStyle(DayBuffer.EntryNo1);
          RefDate := CALCDATE('<+1D>', RefDate);
        END;
      END
      ELSE BEGIN //Normal Line
        Level := 1;
        MainStyle := '';
        FOR DayNo := 1 TO TotalDays DO BEGIN
          Values[DayNo] := '';
          Styles[DayNo] := '';

          //Get Day Buffer
          DayBuffer.SETRANGE(SourceNo1, TempRec.SourceNo1);
          DayBuffer.SETRANGE(SourceNo2, TempRec.SourceNo2);
          DayBuffer.SETRANGE(PostingDate1, RefDate);
          DayBuffer.FINDFIRST();

          //Get Buffer
          Buffer.SETRANGE(SourceNo1, TempRec.SourceNo1);
          Buffer.SETRANGE(SourceNo2, TempRec.SourceNo2);
          Buffer.SETRANGE(PostingDate1, RefDate);
          Buffer.SETRANGE(EntryNo1, TempRec.EntryNo1);
          IF Buffer.FINDFIRST() THEN BEGIN
            Values[DayNo] := Buffer.Text1;
            Styles[DayNo] := GetStyle(DayBuffer.EntryNo1);
          END;
          RefDate := CALCDATE('<+1D>', RefDate);
        END;
      END;
    END;

    PROCEDURE LoadRecords@1000000000(VAR TempRec@1000000000 : TEMPORARY Record 50002;VAR Captions@1000000009 : ARRAY [31] OF Text;VAR MainCaptions@1000000014 : ARRAY [2] OF Text;VAR Visibles@1000000010 : ARRAY [31] OF Boolean;Mode@1000000007 : 'Week,Month';Mode2@1000000013 : 'User,Object';StartDate@1000000006 : Date;UserFilter@1000000005 : Text;ObjectTypeFilter@1000000004 : Integer;ObjectNoFilter@1000000003 : Text);
    VAR
      User@1000000001 : Record 2000000120;
      c@1000000002 : Integer;
      LocEntryNo@1000000008 : Integer;
      TotalDays@1000000011 : Integer;
      RefDate@1000000012 : Date;
    BEGIN
      CLEAR(TempRec);
      TempRec.RESET;
      TempRec.DELETEALL;

      //Captions and Visibles
      CLEAR(Captions);
      CLEAR(Visibles);
      TotalDays := GetTotalDays(StartDate, Mode);
      RefDate := StartDate;
      FOR c := 1 TO TotalDays DO BEGIN
        Captions[c] := FORMAT(RefDate,0,'<Weekday Text>') + ', ' + FORMAT(RefDate);
        Visibles[c] := TRUE;
        RefDate := CALCDATE('<+1D>', RefDate);
      END;

      //Main Captions
      IF Mode2 = Mode2::User THEN BEGIN
        MainCaptions[1] := Text001;
        MainCaptions[2] := Text002;
      END;
      IF Mode2 = Mode2::Object THEN BEGIN
        MainCaptions[1] := Text003;
        MainCaptions[2] := Text004;
      END;

      CreateGlobalBuffers(Mode, Mode2, StartDate, UserFilter, ObjectTypeFilter, ObjectNoFilter);

      LocEntryNo := 1;
      PeriodBuffer.RESET;
      PeriodBuffer.SETCURRENTKEY(SourceNo1, SourceNo2, PostingDate1);
      IF PeriodBuffer.FIND('-') THEN BEGIN
        REPEAT
          FOR c := 0 TO (PeriodBuffer.EntryNo1) DO BEGIN
            TempRec.INIT;
            TempRec.TRANSFERFIELDS(PeriodBuffer);
            TempRec."Entry No." := LocEntryNo;
            TempRec.EntryNo1 := c;
            TempRec.INSERT();
            LocEntryNo += 1;
          END;
        UNTIL PeriodBuffer.NEXT = 0;
      END;
    END;

    PROCEDURE CreateGlobalBuffers@1000000016(Mode@1000000013 : 'Week,Month';Mode2@1000000000 : 'User,Object';StartDate@1000000011 : Date;UserFilter@1000000010 : Text;ObjectTypeFilter@1000000009 : Integer;ObjectNoFilter@1000000002 : Text);
    VAR
      User@1000000001 : Record 2000000120;
      UserSetup@1000000005 : Record 91;
      CMObject@1000000004 : Record 70020;
      CMGenMgt@1000000003 : Codeunit 70000;
      CMUserAccMgt@1000000006 : Codeunit 70010;
      TempCMDepartmentTeam@1000000007 : TEMPORARY Record 70010;
    BEGIN
      CLEAR(Buffer);
      Buffer.RESET();
      Buffer.DELETEALL();

      CLEAR(DayBuffer);
      DayBuffer.RESET();
      DayBuffer.DELETEALL();

      CLEAR(PeriodBuffer);
      PeriodBuffer.RESET();
      PeriodBuffer.DELETEALL();

      IF Mode2 = Mode2::User THEN BEGIN
        CMUserAccMgt.GetSubordinatedUsers(USERID, COMPANYNAME, FALSE, TRUE, TempCMDepartmentTeam);

        IF UserFilter <> '' THEN
          User.SETFILTER("User Name", UserFilter);
        User.SETRANGE(State, User.State::Enabled);
        IF User.FIND('-') THEN BEGIN
          REPEAT
            IF (UserSetup.GET(User."User Name")) AND (CMUserAccMgt.DepartmentTeamContains(TempCMDepartmentTeam, User."User Name")) THEN BEGIN
              TempCMDepartmentTeam.CALCFIELDS("Dept. in Scheduling Tool");
              IF TempCMDepartmentTeam."Dept. in Scheduling Tool" THEN //++dpt
                CreateBufferEntriesByUser(User, Mode, StartDate, ObjectTypeFilter, ObjectNoFilter);
            END;
          UNTIL User.NEXT = 0;
        END;
      END;

      IF Mode2 = Mode2::Object THEN BEGIN
        CMGenMgt.SetFilterUniversalLookup(ObjectTypeFilter, '', '', '', ObjectNoFilter, CMObject);
        IF CMObject.FIND('-') THEN BEGIN
          REPEAT
            CreateBufferEntriesByObject(CMObject, Mode, StartDate, UserFilter);
          UNTIL CMObject.NEXT = 0;
        END;
      END;
    END;

    LOCAL PROCEDURE CreateBufferEntriesByUser@1000000013(User@1000000006 : Record 2000000120;Mode@1000000007 : 'Week,Month';StartDate@1000000008 : Date;ObjectTypeFilter@1000000010 : Integer;ObjectNoFilter@1000000009 : Text);
    VAR
      TotalDays@1000000013 : Integer;
      DayNo@1000000012 : Integer;
      RefDate@1000000011 : Date;
      Task@1000000005 : Record 5080;
      EmptyTask@1000000004 : Record 5080;
      TasksPerPeriod@1000000003 : Integer;
      TasksPerDay@1000000002 : Integer;
      TasksPerDayFilter@1000000001 : Text;
      MaxTasksPerDay@1000000000 : Integer;
    BEGIN
      TotalDays := GetTotalDays(StartDate, Mode);

      TasksPerPeriod := 0;
      MaxTasksPerDay := 0;
      RefDate := StartDate;

      FOR DayNo := 1 TO TotalDays DO BEGIN
        TasksPerDay := 0;
        TasksPerDayFilter := '';
        UpdateBuffer(EmptyTask, User."User Name", '', User."Full Name", '', RefDate, 0); //Update Buffer - Headline

        Task.RESET();
        Task.SETCURRENTKEY("CM Type","CM Subtype","CM Status","CM Due Date","CM Assigned User ID");
        Task.SETRANGE("CM Type", Task."CM Type"::Task);
        Task.SETRANGE("CM Subtype", Task."CM Subtype"::" ");
        Task.SETRANGE("CM Status", Task."CM Status"::Open);
        Task.SETRANGE("CM Scheduled Date", RefDate);
        //Task.SETRANGE("CM Assigned User ID", User."User Name");
        IF ObjectNoFilter <> '' THEN BEGIN
          Task.SETRANGE("CM Objecttype", ObjectTypeFilter);
          Task.SETFILTER("CM Object No.", ObjectNoFilter);
        END;
        IF Task.FIND('-') THEN BEGIN
          REPEAT
            Task.SETRANGE("CM User In Team Filter", User."User Name");
            Task.CALCFIELDS("CM User In Team"); //!!
            IF (Task."CM Assigned User ID" = User."User Name") OR (Task."CM User In Team") THEN BEGIN
              TasksPerDay += 1;
              TasksPerPeriod += 1;
              TasksPerDayFilter += ('|' + Task."No.");
              UpdateBuffer(Task, User."User Name", '', User."Full Name", '', RefDate, TasksPerDay); //Update Buffer
            END;
          UNTIL Task.NEXT = 0;
        END;
        TasksPerDayFilter := COPYSTR(TasksPerDayFilter, 2);
        UpdateDayBuffer(User."User Name", '', User."Full Name", '', RefDate, TasksPerDay, TasksPerDayFilter); //Update Buffer

        RefDate := CALCDATE('<+1D>', RefDate);
        IF TasksPerDay > MaxTasksPerDay THEN
          MaxTasksPerDay := TasksPerDay;
      END;
      UpdatePeriodBuffer(User."User Name", '', User."Full Name", '', MaxTasksPerDay, TasksPerPeriod); //Update Buffer
    END;

    LOCAL PROCEDURE CreateBufferEntriesByObject@1000000021(CMObject@1000000006 : Record 70020;Mode@1000000007 : 'Week,Month';StartDate@1000000008 : Date;UserIdFilter@1000000009 : Text);
    VAR
      TotalDays@1000000013 : Integer;
      DayNo@1000000012 : Integer;
      RefDate@1000000011 : Date;
      Task@1000000005 : Record 5080;
      EmptyTask@1000000004 : Record 5080;
      TasksPerPeriod@1000000003 : Integer;
      TasksPerDay@1000000002 : Integer;
      TasksPerDayFilter@1000000001 : Text;
      MaxTasksPerDay@1000000000 : Integer;
    BEGIN
      TotalDays := GetTotalDays(StartDate, Mode);

      TasksPerPeriod := 0;
      MaxTasksPerDay := 0;
      RefDate := StartDate;

      FOR DayNo := 1 TO TotalDays DO BEGIN
        TasksPerDay := 0;
        TasksPerDayFilter := '';
        UpdateBuffer(EmptyTask, CMObject."No.", '', CMObject.Name, CMObject."Name 2", RefDate, 0); //Update Buffer - Headline

        Task.RESET();
        Task.SETCURRENTKEY("CM Type","CM Subtype","CM Status","CM Due Date","CM Objecttype","CM Object No.");
        Task.SETRANGE("CM Type", Task."CM Type"::Task);
        Task.SETRANGE("CM Subtype", Task."CM Subtype"::" ");
        Task.SETRANGE("CM Status", Task."CM Status"::Open);
        Task.SETRANGE("CM Scheduled Date", RefDate);
        Task.SETRANGE("CM Objecttype", CMObject.Objecttype);
        Task.SETRANGE("CM Object No.", CMObject."No.");
        IF UserIdFilter <> '' THEN BEGIN
          Task.SETFILTER("CM Assigned User ID", UserIdFilter);
        END;
        IF Task.FIND('-') THEN BEGIN
          REPEAT
            TasksPerDay += 1;
            TasksPerPeriod += 1;
            TasksPerDayFilter += ('|' + Task."No.");
            UpdateBuffer(Task, CMObject."No.", '', CMObject.Name, CMObject."Name 2", RefDate, TasksPerDay); //Update Buffer
          UNTIL Task.NEXT = 0;
        END;
        TasksPerDayFilter := COPYSTR(TasksPerDayFilter, 2);
        UpdateDayBuffer(CMObject."No.", '', CMObject.Name, CMObject."Name 2", RefDate, TasksPerDay, TasksPerDayFilter); //Update Buffer

        RefDate := CALCDATE('<+1D>', RefDate);
        IF TasksPerDay > MaxTasksPerDay THEN
          MaxTasksPerDay := TasksPerDay;
      END;
      UpdatePeriodBuffer(CMObject."No.", '', CMObject.Name, CMObject."Name 2", MaxTasksPerDay, TasksPerPeriod); //Update Buffer
    END;

    LOCAL PROCEDURE UpdateBuffer@1000000004(Task@1000000004 : Record 5080;SourceNo1@1000000000 : Code[50];SourceNo2@1000000001 : Code[50];Text1@1000000006 : Text[250];Text2@1000000005 : Text[250];RefDate@1000000002 : Date;TaskPerDay@1000000003 : Integer);
    BEGIN
      //Buffer
      Buffer.INIT;
      Buffer."Entry No." := EntryNo;
      Buffer.SourceNo1 := SourceNo1;
      Buffer.SourceNo2 := SourceNo2;
      Buffer.Text1 := Text1;
      Buffer.Text2 := Text2;
      Buffer.PostingDate1 := RefDate;
      Buffer.EntryNo1 := TaskPerDay;
      Buffer.Text1 := COPYSTR(STRSUBSTNO('%1 %2 | %3 %4', Task."No.", Task.Description, Task."CM Object No.", Task."CM Object Name"), 1, 250);;
      Buffer.DocNo1 := Task."No.";
      Buffer.INSERT();
      EntryNo += 1;
    END;

    LOCAL PROCEDURE UpdateDayBuffer@1000000008(SourceNo1@1000000000 : Code[50];SourceNo2@1000000001 : Code[50];Text1@1000000004 : Text[250];Text2@1000000005 : Text[250];RefDate@1000000002 : Date;TasksPerDay@1000000003 : Integer;TasksPerDayFilter@1000000006 : Text[250]);
    BEGIN
      //Per Day Buffer
      DayBuffer.RESET;
      DayBuffer.INIT;
      DayBuffer."Entry No." := EntryNoDay;
      DayBuffer.SourceNo1 := SourceNo1;
      DayBuffer.SourceNo2 := SourceNo2;
      DayBuffer.Text1 := Text1;
      DayBuffer.Text2 := Text2;
      DayBuffer.Text3 := TasksPerDayFilter;
      DayBuffer.PostingDate1 := RefDate;
      DayBuffer.EntryNo1 := TasksPerDay;
      DayBuffer.INSERT();
      EntryNoDay += 1;
    END;

    LOCAL PROCEDURE UpdatePeriodBuffer@1000000002(SourceNo1@1000000000 : Code[50];SourceNo2@1000000001 : Code[50];Text1@1000000004 : Text[250];Text2@1000000002 : Text[250];MaxTasksPerDay@1000000003 : Integer;TasksPerPeriod@1000000005 : Integer);
    BEGIN
      //Period (Month/week) Buffer
      PeriodBuffer.INIT;
      PeriodBuffer."Entry No." := EntryNoPeriod;
      PeriodBuffer.SourceNo1 := SourceNo1;
      PeriodBuffer.SourceNo2 := SourceNo2;
      PeriodBuffer.Text1 := Text1;
      PeriodBuffer.Text2 := Text2;
      PeriodBuffer.PostingDate1 := 0D;
      PeriodBuffer.EntryNo1 := MaxTasksPerDay;
      PeriodBuffer.EntryNo2 := TasksPerPeriod;
      PeriodBuffer.INSERT();
      EntryNoPeriod += 1;
    END;

    LOCAL PROCEDURE GetTotalDays@1000000014(StartDate@1000000000 : Date;Mode@1000000001 : 'Week,Month') : Integer;
    BEGIN
      CASE Mode OF
        Mode::Week : EXIT(7);
        Mode::Month : EXIT(DATE2DMY(CALCDATE('<CM>',StartDate), 1));
      END;

      EXIT(0);
    END;

    LOCAL PROCEDURE GetStyle@1000000007(TaskCount@1000000000 : Integer) : Text;
    VAR
      WarningOffset@1000000002 : Integer;
      DangerOffset@1000000001 : Integer;
    BEGIN
      WarningOffset := 3;
      DangerOffset := 5;

      IF TaskCount < WarningOffset THEN
        EXIT('');
      IF (TaskCount >= WarningOffset) AND (TaskCount < DangerOffset) THEN
        EXIT('Ambiguous');
      IF TaskCount >= DangerOffset THEN
        EXIT('Unfavorable');
    END;

    PROCEDURE "###MISC###"@1000000006();
    BEGIN
    END;

    PROCEDURE GetUnscheduledTasks@1000000003(VAR Rec@1000000002 : Record 5080;VAR CMObject@1000000000 : Record 70020) : Integer;
    VAR
      CMUserAccMgt@1000000001 : Codeunit 70010;
      TempDapartmentTeam@1000000003 : TEMPORARY Record 70010;
      DoMark@1000000004 : Boolean;
    BEGIN
      CMUserAccMgt.GetSubordinatedUsers(USERID, COMPANYNAME, FALSE, TRUE, TempDapartmentTeam);

      CMObject.FILTERGROUP(0);
      CMObject.SETCURRENTKEY(Objecttype,"No.");

      Rec.CLEARMARKS();
      Rec.RESET();
      Rec.SETCURRENTKEY("CM Type","CM Subtype","CM Status","CM Due Date",Priority);
      Rec.SETRANGE("CM Type", Rec."CM Type"::Task);
      Rec.SETRANGE("CM Subtype", Rec."CM Subtype"::" ");
      Rec.SETRANGE("CM Status", Rec."CM Status"::Open);
      Rec.SETFILTER("CM Due Date", '..%1', CALCDATE('<+1M>', TODAY));
      Rec.FILTERGROUP(-1); //OR Filter
      Rec.SETRANGE("CM Scheduled Date", 0D);
      Rec.SETRANGE("CM Assigned User ID", '');
      Rec.FILTERGROUP(0);
      IF Rec.FIND('-') THEN BEGIN
        REPEAT
          //Asset has to exist or beeing emtpy
          //User has to be accessible for me over departments, or beeing empty
          CMObject.SETRANGE(Objecttype, Rec."CM Objecttype");
          CMObject.SETRANGE("No.", Rec."CM Object No.");
          IF ((Rec."CM Object No." = '') OR (CMObject.FINDFIRST())) AND
             ((Rec."CM Assigned User ID" = '') OR (CMUserAccMgt.DepartmentTeamContains(TempDapartmentTeam, Rec."CM Assigned User ID"))) THEN BEGIN
            TempDapartmentTeam.CALCFIELDS("Dept. in Scheduling Tool");
            IF TempDapartmentTeam."Dept. in Scheduling Tool" THEN //++dpt
              Rec.MARK(TRUE);
          END;
        UNTIL Rec.NEXT = 0;
      END;

      Rec.MARKEDONLY(TRUE);
    END;

    PROCEDURE ScheduleCalendarEntry@1000000010(VAR TempRec@1000000003 : TEMPORARY Record 50002;RefDate@1000000004 : Date;DayNo@1000000008 : Integer) : Boolean;
    VAR
      TaskPage@1000000002 : Page 70098;
      Task@1000000001 : Record 5080;
      TempTask@1000000000 : TEMPORARY Record 5080;
    BEGIN
      IF TempRec.EntryNo1 = 0 THEN BEGIN //Headline
        DayBuffer.RESET;
        DayBuffer.SETCURRENTKEY(SourceNo1, SourceNo2, PostingDate1);

        DayBuffer.SETRANGE(SourceNo1, TempRec.SourceNo1);
        DayBuffer.SETRANGE(SourceNo2, TempRec.SourceNo2);
        DayBuffer.SETRANGE(PostingDate1, RefDate);
        DayBuffer.FINDFIRST();

        IF DayBuffer.EntryNo1 > 0 THEN
          ShowTaskList(DayBuffer.Text3);

        EXIT(FALSE);
      END
      ELSE BEGIN //Normal line
        Buffer.RESET;
        Buffer.SETCURRENTKEY(SourceNo1, SourceNo2, PostingDate1,EntryNo1);
        Buffer.SETRANGE(SourceNo1, TempRec.SourceNo1);
        Buffer.SETRANGE(SourceNo2, TempRec.SourceNo2);
        Buffer.SETRANGE(PostingDate1, RefDate);
        Buffer.SETRANGE(EntryNo1, TempRec.EntryNo1);
        IF Buffer.FINDFIRST() THEN BEGIN//Task
          Task.GET(Buffer.DocNo1);
          TempTask := Task;
          TaskPage.DoInit(TempTask, 0);
        END
        ELSE BEGIN
          TempTask.INIT();
          TempTask."No." := '';
          TempTask."CM Assigned User ID" := TempRec.UserID1;
          TempTask."CM Scheduled Date" := RefDate;

          TaskPage.DoInit(TempTask, 1);
        END;

        //Run Page
        IF TaskPage.RUNMODAL() <> ACTION::OK THEN
          EXIT(FALSE);

        TaskPage.GetRec(TempTask);
        Task.GET(TempTask."No.");
        Task.VALIDATE("CM Assigned User ID", TempTask."CM Assigned User ID");
        Task.VALIDATE("CM Due Date", TempTask."CM Due Date");
        Task.VALIDATE("CM Scheduled Date", TempTask."CM Scheduled Date");
        Task.VALIDATE("CM Scheduled Time", TempTask."CM Scheduled Time");
        Task.MODIFY(TRUE);

        EXIT(TRUE);
      END;
    END;

    PROCEDURE ScheduleTask@1000000011(VAR Rec@1000000000 : Record 5080) : Boolean;
    VAR
      TempTask@1000000001 : TEMPORARY Record 5080;
      Page@1000000002 : Page 70098;
      Task@1000000003 : Record 5080;
    BEGIN
      TempTask := Rec;

      Page.DoInit(TempTask, 0);
      Page.LOOKUPMODE(FALSE);
      IF Page.RUNMODAL() <> ACTION::OK THEN
        EXIT(FALSE);

      Page.GetRec(TempTask);
      Task.GET(TempTask."No.");
      Task.VALIDATE("CM Assigned User ID", TempTask."CM Assigned User ID");
      Task.VALIDATE("CM Due Date", TempTask."CM Due Date");
      Task.VALIDATE("CM Scheduled Date", TempTask."CM Scheduled Date");
      Task.VALIDATE("CM Scheduled Time", TempTask."CM Scheduled Time");
      Task.MODIFY(TRUE);

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE ShowTaskList@1000000009(TaskNoFilter@1000000000 : Text);
    VAR
      Task@1000000002 : Record 5080;
      TaskList@1000000003 : Page 70112;
    BEGIN
      Task.RESET;
      Task.SETFILTER("No.", TaskNoFilter);

      TaskList.SETTABLEVIEW(Task);
      TaskList.RUNMODAL();
    END;

    BEGIN
    {

    }
    END.
  }
}

OBJECT Codeunit 70030 CMMS Workorder Management
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=14:33:40;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      CMGenMgt@1000000000 : Codeunit 70000;
      Text001@1000000001 : TextConst 'ENU=Status Change from "%1" to "%2" cannot be done manually.;DEA=Der Statusbergang von "%1" auf "%2" kann nicht manuell get„tigt werden.';
      CMTaskMgt@1000000004 : Codeunit 70031;
      CMWoMgt@1000000016 : Codeunit 70030;
      LogEntry@1000000002 : Record 5065;
      Text002@1000000003 : TextConst 'ENU=Invalid Status Value %1!;DEA=Ungltiger Statuswert %1!';
      CMUserAccessMgmt@1000000005 : Codeunit 70010;
      Text003@1000000006 : TextConst 'ENU=Canceled.;DEA=Abgebrochen.';
      Text004@1000000007 : TextConst 'ENU=From "%1" to "%2"';
      Text005@1000000008 : TextConst 'ENU=Workorder "%1" created.';
      Text006@1000000009 : TextConst 'ENU=%1 cannot be after %2!;DEA=%1 darf nicht nach %2 sein!';
      Text007@1000000010 : TextConst 'ENU=Canceled! ''%1'' must not be empty!;DEA=Abgebrochen. ''%1'' darf nicht leer sein!';
      Text008@1000000011 : TextConst 'ENU=No comment text entered!;DEA=Kein Kommentartext eingegeben!';
      Text009@1000000012 : TextConst 'ENU=Automatically closed by System. Workorder finished.';
      Text010@1000000013 : TextConst 'ENU=Warning! There are %1 open Tasks in this Workoder. Do you really want to change the Workorder Status to "%2"?;DEA=Achtung! %1 Aufgaben sind in diesem Arbeitsauftrag noch offen. Wollen sie den Status auf wirklich auf "%2" „ndern?';
      DisableKeyOptimization@1000000014 : Boolean;
      Text011@1000000015 : TextConst 'ENU=Do you want to set the status of your Alarm Workorder to "%1"?;DEA=Wollen Sie den Status ihrer Alarm Workorder auf "%1" setzen?';
      Text012@1000000017 : TextConst 'ENU=Cannot create Workorder Comment. Status of Workorder "%1" is "%2".;DEA=Arbeitsauftrag Kommentar kann nicht erstellt werden. Status von Arbeitsauftrag "%1" ist "%2".';
      Text013@1000000018 : TextConst 'ENU=Save File;DEA=Datei speichern';
      Text014@1000000019 : TextConst 'ENU=SiteVisitingReport_%1_%2_%3.%4';
      CMPublisher@1000000020 : Codeunit 70037;
      Text015@1000000021 : TextConst 'ENU=Comment text has to consist of at least %1 character(s).';

    PROCEDURE "###TRIGGER###"@1000000023();
    BEGIN
    END;

    PROCEDURE OnInsert@1000000001(VAR Rec@1000000000 : Record 5092);
    VAR
      CMObject@1000000001 : Record 70020;
    BEGIN
      IF (NOT Rec."CM Is Workorder") OR (Rec."CM Is Temporary") THEN
        EXIT;

      CMGenMgt.GetWorkorderNo(Rec);
      Rec."CM Created By User ID" := USERID;
      Rec."CM Created Datetime" := CURRENTDATETIME;

      IF Rec."CM Due Date" = 0D THEN
        Rec."CM Due Date" := WORKDATE;

      IF Rec."CM Scheduled Due Date" = 0D THEN
        Rec."CM Scheduled Due Date" := Rec."CM Due Date";

      FillObjectName(Rec);

      CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::Created,Rec."No.", STRSUBSTNO(Text005, Rec."No."));

      CMPublisher.OnAfterInsertWorkorder(Rec); //Publish
    END;

    PROCEDURE OnModify@1000000002(VAR Rec@1000000000 : Record 5092;VAR xRec@1000000001 : Record 5092);
    VAR
      StatusChangeOK@1000000002 : Boolean;
      Task@1000000003 : Record 5080;
    BEGIN
      IF (NOT Rec."CM Is Workorder") OR (Rec."CM Is Temporary") THEN
        EXIT;
    END;

    PROCEDURE OnDelete@1000000003(VAR Rec@1000000000 : Record 5092);
    BEGIN
      IF (NOT Rec."CM Is Workorder") THEN
        EXIT;

      CMGenMgt.DeleteTasksByWo(Rec,TRUE);
    END;

    PROCEDURE OnValidate_Description@1000000000(VAR Rec@1000000000 : Record 5092;VAR xRec@1000000001 : Record 5092);
    BEGIN
      IF (NOT Rec."CM Is Workorder") OR (Rec."CM Is Temporary") THEN
        EXIT;
    END;

    PROCEDURE OnValidate_CMObjectNo@1000000010(VAR Rec@1000000000 : Record 5092;VAR xRec@1000000001 : Record 5092);
    BEGIN
      IF (NOT Rec."CM Is Workorder") OR (Rec."CM Is Temporary") THEN
        EXIT;

      FillObjectName(Rec);
    END;

    PROCEDURE OnValidate_CMObjectType@1000000030(VAR Rec@1000000000 : Record 5092;VAR xRec@1000000001 : Record 5092);
    BEGIN
      IF (NOT Rec."CM Is Workorder") OR (Rec."CM Is Temporary") THEN
        EXIT;

      FillObjectName(Rec);
    END;

    PROCEDURE OnValidate_CMWorkorderTypeCode@1000000011(VAR Rec@1000000000 : Record 5092;VAR xRec@1000000001 : Record 5092);
    BEGIN
      IF (NOT Rec."CM Is Workorder") OR (Rec."CM Is Temporary") THEN
        EXIT;

      CMTaskMgt.CreateTasksToWorkorder(Rec);
    END;

    PROCEDURE OnValidate_CMAssignedUserID@1000000012(VAR Rec@1000000000 : Record 5092;VAR xRec@1000000001 : Record 5092);
    BEGIN
      IF (NOT Rec."CM Is Workorder") OR (Rec."CM Is Temporary") THEN
        EXIT;
    END;

    PROCEDURE OnValidate_Priority@1000000013(VAR Rec@1000000000 : Record 5092;VAR xRec@1000000001 : Record 5092);
    BEGIN
      IF (NOT Rec."CM Is Workorder") OR (Rec."CM Is Temporary") THEN
        EXIT;
    END;

    PROCEDURE OnValidate_DueDates@1000000021(VAR Rec@1000000001 : Record 5092;VAR xRec@1000000000 : Record 5092);
    BEGIN
      Rec.TESTFIELD("CM Due Date");

      IF Rec."CM Scheduled Due Date" > Rec."CM Due Date" THEN
        ERROR(Text006, Rec.FIELDCAPTION("CM Scheduled Due Date"), Rec.FIELDCAPTION("CM Due Date"));
    END;

    PROCEDURE "###WORKORDER###"@1000000025();
    BEGIN
    END;

    PROCEDURE NewWorkorder@1000000004(VAR Rec@1000000000 : Record 5092) : Code[20];
    VAR
      Workorder@1000000001 : Record 5092;
      WoCard@1000000002 : Page 70100;
    BEGIN
      Rec."No." := '';
      Rec."CM Is Workorder" := TRUE;
      Rec."CM Is Temporary" := FALSE;
      Rec.INSERT(TRUE);

      CMTaskMgt.CreateTasksToWorkorder(Rec);

      WoCard.SETRECORD(Rec);
      WoCard.RUN();

      EXIT(Rec."No.");
    END;

    PROCEDURE NewWorkorderToObjectUI@1000000014(VAR Rec@1000000003 : Record 70020;HideWorkorderTypeSelection@1000000004 : Boolean) : Code[20];
    VAR
      Page@1000000002 : Page 70105;
      Workorder@1000000001 : Record 5092;
      CMWoMgt@1000000000 : Codeunit 70030;
    BEGIN
      IF Rec."No." <> '' THEN
        Page.SetAsset(Rec);

      Page.HideWorkorderType(HideWorkorderTypeSelection);
      Workorder.INIT;
      IF Page.RUNMODAL() = ACTION::Yes THEN BEGIN
        Page.GETRECORD(Workorder);
        EXIT(NewWorkorder(Workorder));
      END;

      EXIT('');
    END;

    PROCEDURE NewWorkorderUI@1000000017() : Code[20];
    VAR
      EmptyObject@1000000000 : Record 70020;
    BEGIN
      EmptyObject.INIT;
      EmptyObject."No." := '';

      EXIT(NewWorkorderToObjectUI(EmptyObject,FALSE));
    END;

    PROCEDURE ChangeStatus@1000000037(VAR Rec@1000000000 : Record 5092;NewStatus@1000000001 : Integer;CommentText@1000000008 : Text[250];StatusChangeStdText@1000000009 : Integer;StatusChangeStdTextFormated@1000000005 : Text);
    VAR
      OldStatusText@1000000004 : Text;
      OldStatus@1000000003 : Integer;
      EntryNo@1000000006 : Integer;
      EntryNo2@1000000002 : Integer;
      EntryNo3@1000000010 : Integer;
      LocLogEntry@1000000007 : Record 5065;
      StdTextInternal@1000000011 : Boolean;
    BEGIN
      OldStatusText := FORMAT(Rec."CM Status");
      OldStatus := Rec."CM Status";
      EntryNo := -1;
      EntryNo2 := -1;

      //Change Status!!
      Rec."CM Status" := NewStatus;
      Rec."CM Status Change Standard Text" := StatusChangeStdText;
      Rec.MODIFY(TRUE);

      //Check Billing Info
      IF (Rec."CM Status" = Rec."CM Status"::Done) AND (Rec."CM Billing Info" = 0) THEN
        ERROR(STRSUBSTNO(Text007, Rec.FIELDCAPTION(Rec."CM Billing Info")));

      //Check Open Tasks
      Rec.CALCFIELDS("CM Open Tasks");
      IF (Rec."CM Status" IN [ Rec."CM Status"::Completed, Rec."CM Status"::Done, Rec."CM Status"::Discarded]) AND
          (Rec."CM Open Tasks" > 0) THEN BEGIN
          IF NOT CONFIRM(STRSUBSTNO(Text010, Rec."CM Open Tasks", Rec."CM Status")) THEN
            ERROR(Text003);
      END;

      //Close tasks!!!
      IF Rec."CM Status" IN [Rec."CM Status"::Done, Rec."CM Status"::Discarded] THEN
        CloseTasksAutomatically(Rec);

      //Create Log Entry | Write Comment
      IF OldStatus <> Rec."CM Status" THEN BEGIN
        EntryNo := CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::"Status Change", FORMAT(Rec."CM Status"), CommentText);

        //Comment
        IF CommentText <> '' THEN BEGIN
          CheckCommentLength(CommentText);
          EntryNo2 := CMGenMgt.CreateLogEntryComment(Rec, FALSE, CommentText);
        END;

        //Standard Texts
        IF StatusChangeStdTextFormated <> '' THEN BEGIN
          IF NewStatus = Rec."CM Status"::Completed THEN
            StdTextInternal := TRUE
          ELSE
            StdTextInternal := FALSE;
          EntryNo2 := CMGenMgt.CreateLogEntryComment(Rec, StdTextInternal, StatusChangeStdTextFormated);
        END;
      END;

      //Modify Log Entry
      ChangeLogEntryAfterStatusChange(EntryNo, StatusChangeStdText, 0);
      ChangeLogEntryAfterStatusChange(EntryNo2, StatusChangeStdText, EntryNo);
      ChangeLogEntryAfterStatusChange(EntryNo3, StatusChangeStdText, EntryNo);

      CMPublisher.OnAfterChangeWorkorderStatus(Rec, OldStatus, NewStatus); //Publisher
    END;

    PROCEDURE ChangeStatusUI@1000000026(VAR Rec@1000000000 : Record 5092);
    VAR
      Page@1000000001 : Page 70011;
      Rec2@1000000002 : Record 5092;
      Commenttext@1000000003 : Text[250];
      StdText@1000000004 : Text;
    BEGIN
      Page.SetData(Rec);
      IF Page.RUNMODAL <> ACTION::OK THEN
        ERROR(Text003);

      Rec2.INIT;
      Page.GetData(Rec2, Commenttext);
      IF Rec2."CM Status Change Standard Text" > 0 THEN
        StdText := FORMAT(Rec2."CM Status Change Standard Text");

      Rec."CM Billing Info" := Rec2."CM Billing Info";
      ChangeStatus(Rec, Rec2."CM Status", Commenttext, Rec2."CM Status Change Standard Text", StdText);
      //ChangeStatus(Rec, Page.GetStatus(), Page.GetComment(), Page.GetTicketClosingReason(), Page.GetTicketClosingReasonText());
    END;

    PROCEDURE ChangeStatusOpenToNew@1000000041(VAR Rec@1000000000 : Record 5092);
    BEGIN
      IF (USERID = Rec."CM Assigned User ID") AND
         (Rec."CM Status" = Rec."CM Status"::New) AND
         (Rec."CM Source" = Rec."CM Source"::Alarm)  THEN BEGIN
        IF CONFIRM(STRSUBSTNO(Text011, Rec."CM Status"::Open)) THEN
          ChangeStatus(Rec, Rec."CM Status"::Open, '', 0, '');
      END;
    END;

    PROCEDURE LinkToAssetProjectUI@1000000020(VAR Rec@1000000000 : Record 5092;DoModify@1000000002 : Boolean);
    VAR
      ConfirmationPage@1000000001 : Page 70109;
      Task@1000000003 : Record 5080;
      CMObject@1000000004 : Record 70020;
    BEGIN
      ConfirmationPage.LOOKUPMODE(TRUE);

      IF ConfirmationPage.RUNMODAL() <> ACTION::LookupOK THEN
        ERROR(Text003);

      CMObject.GET(ConfirmationPage.GetObjecttype(), ConfirmationPage.GetObjectno());

      Rec."CM Objecttype" := CMObject.Objecttype;
      Rec."CM Object No." := CMObject."No.";
      Rec."CM Object Name" := CMObject.Name;
      Rec."CM Object Name 2" := CMObject."Name 2";

      IF DoModify THEN
        Rec.MODIFY(FALSE);

      //Change Tasks
      Task.SETCURRENTKEY("CM Type","Opportunity No.","CM Subtype","CM Status","No.");
      Task.SETRANGE("CM Type", Task."CM Type"::Task);
      Task.SETRANGE("Opportunity No.", Rec."No.");
      Task.SETRANGE("CM Status", Task."CM Status"::Open);
      Task.SETRANGE("CM Subtype", Task."CM Subtype"::" ");
      Task.MODIFYALL("CM Objecttype", Rec."CM Objecttype");
      Task.MODIFYALL("CM Object No.", Rec."CM Object No.");
    END;

    PROCEDURE ChangeAssignedUser@1000000006(VAR Rec@1000000000 : Record 5092;NewUid@1000000001 : Code[50];DoModify@1000000002 : Boolean);
    VAR
      OldUid@1000000003 : Code[50];
    BEGIN
      OldUid := Rec."CM Assigned User ID";

      Rec.VALIDATE("CM Assigned User ID", NewUid);
      IF DoModify THEN
        Rec.MODIFY(TRUE);

      CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::"Assigned User Changed", NewUid, STRSUBSTNO(Text004, OldUid, NewUid));
      CMPublisher.OnAfterChangeWorkorderAssignedUserID(Rec, OldUid, NewUid); //Publish
    END;

    PROCEDURE ChangeAssignedUserUI@1000000008(VAR Rec@1000000000 : Record 5092);
    VAR
      NewUserID@1000000003 : Code[50];
      Page@1000000004 : Page 70107;
    BEGIN
      NewUserID := '';

      Page.SetUserID(Rec."CM Assigned User ID");
      Page.LOOKUPMODE(TRUE);
      IF Page.RUNMODAL()  = ACTION::LookupOK THEN
        NewUserID := Page.GetUserID();

      IF NewUserID <> '' THEN
        ChangeAssignedUser(Rec,NewUserID,TRUE);
    END;

    PROCEDURE AddCommentUI@1000000009(VAR Rec@1000000000 : Record 5092;CopyFromEntryNo@1000000002 : Integer) : Integer;
    VAR
      Page@1000000001 : Page 70108;
      LocLogEntry@1000000005 : Record 5065;
      EntryNo@1000000006 : Integer;
      TempLogEntry@1000000003 : TEMPORARY Record 5065;
    BEGIN
      EntryNo := 0;

      IF Rec."CM Status" IN [Rec."CM Status"::Done, Rec."CM Status"::Discarded] THEN
        ERROR(Text012, Rec."No.", Rec."CM Status");

      IF (CopyFromEntryNo <> 0) AND (LocLogEntry.GET(CopyFromEntryNo)) THEN BEGIN
        Page.SetRec(LocLogEntry);
        Page.SetText(LocLogEntry."CM Comment");
      END;

      Page.LOOKUPMODE := TRUE;
      IF Page.RUNMODAL <> ACTION::LookupOK THEN
        ERROR(Text003);

      Page.GETRECORD(TempLogEntry);

      IF TempLogEntry."CM Comment" = '' THEN
        ERROR(Text008);

      LocLogEntry.GET(CMGenMgt.CreateLogEntryComment(Rec,TempLogEntry."CM Internal", TempLogEntry."CM Comment"));
      LocLogEntry."CM Issue" := TempLogEntry."CM Issue";
      LocLogEntry."CM Production Effect" := TempLogEntry."CM Production Effect";
      LocLogEntry.MODIFY(FALSE);

      EXIT(LocLogEntry."Entry No.");
    END;

    PROCEDURE ShowRelatedLogs@1000000019(VAR Rec@1000000000 : Record 5092;LogType@1000000003 : Integer;Scope@1000000004 : 'Workorder,Task,Workoder and Task');
    VAR
      Rec2@1000000001 : Record 5065;
      ListPage@1000000002 : Page 70111;
    BEGIN
      GetRelatedLogs(Rec, Rec2, LogType, Scope);
      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE CountRelatedLogs@1000000036(VAR Rec@1000000000 : Record 5092;LogType@1000000003 : Integer;Scope@1000000004 : 'Workorder,Task,Workoder and Task') : Integer;
    VAR
      Rec2@1000000001 : Record 5065;
    BEGIN
      GetRelatedLogs(Rec, Rec2, LogType, Scope);
      EXIT(Rec2.COUNT());
    END;

    LOCAL PROCEDURE GetRelatedLogs@1000000033(VAR Rec@1000000000 : Record 5092;VAR Rec2@1000000001 : Record 5065;LogType@1000000003 : Integer;Scope@1000000004 : 'Workorder,Task,Workoder and Task');
    BEGIN
      Rec2.RESET;
      Rec2.SETCURRENTKEY("CM Is CMMS Log Entry","Opportunity No.");
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE("CM Is CMMS Log Entry", TRUE);
      IF LogType >= 0 THEN
        Rec2.SETRANGE("CM Log Type", LogType);
      Rec2.FILTERGROUP(0);
      Rec2.SETRANGE("Opportunity No.", Rec."No.");
      IF Scope = Scope::Workorder THEN
        Rec2.SETRANGE("CM Source",Rec2."CM Source"::Workorder);
      IF Scope = Scope::Task THEN
        Rec2.SETRANGE("CM Source",Rec2."CM Source"::Task);
      IF Scope = Scope::"Workoder and Task" THEN
        Rec2.SETFILTER("CM Source",'%1|%2',Rec2."CM Source"::Workorder, Rec2."CM Source"::Task);
    END;

    PROCEDURE "###WORKORDER SHOW COUNT###"@1000000032();
    BEGIN
    END;

    PROCEDURE GetWorkorders@1000000035(VAR Rec@1000000003 : Record 5092;ObjectNo@1000000007 : Code[20];RespUserIDFilter@1000000000 : Text;AssignedUserIDFilter@1000000005 : Text;DateFilter@1000000001 : Text;StatusFilter@1000000006 : Text;DateFilter2@1000000011 : Text;SourceFilter@1000000012 : Text);
    VAR
      CMMSAdditionalData@1000000009 : Record 70021;
      CMMSObject@1000000010 : Record 70020;
      AssetRespFilter@1000000002 : Text;
      ProjectRespFilter@1000000013 : Text;
      UserSetup@1000000014 : Record 91;
    BEGIN
      //Parameter "SourceFilter": Empty = No Filter, All other Values will be seen als Filter (See Table Opportunity."CM Source")
      IF NOT UserSetup.GET(USERID) THEN
        UserSetup.INIT;

      AssetRespFilter := CMUserAccessMgmt.GetAssetRespFilter();
      ProjectRespFilter := CMUserAccessMgmt.GetProjectRespFilter();

      Rec.RESET;
      OptimizeKey(Rec,ObjectNo,RespUserIDFilter,AssignedUserIDFilter,DateFilter,StatusFilter,DateFilter2,SourceFilter);
      Rec.FILTERGROUP(2);
      Rec.SETRANGE("CM Is Workorder", TRUE);

      //Filters:
      IF ObjectNo <> '' THEN
        Rec.SETRANGE("CM Object No.",ObjectNo);
      IF StatusFilter <> '' THEN
        Rec.SETFILTER(Rec."CM Status", StatusFilter);
      IF SourceFilter <> '' THEN
        Rec.SETFILTER("CM Source", SourceFilter);

      //Flow Filters
      IF DateFilter <> '' THEN
        Rec.SETFILTER(Rec."CM Due Date", DateFilter);
      IF DateFilter2 <> '' THEN
        Rec.SETFILTER(Rec."CM Scheduled Due Date", DateFilter2);

      IF RespUserIDFilter <> '' THEN BEGIN
        IF NOT UserSetup."IG Workorder Administrator" THEN
          Rec.SETFILTER("CM Object No.",'<>%1','');
        IF Rec.FIND('-') THEN
          REPEAT
            IF (NOT UserSetup."IG Workorder Administrator") THEN BEGIN
              {Object --> User}
              CMMSAdditionalData.SETRANGE(Type,CMMSAdditionalData.Type::User);
              CMMSAdditionalData.SETFILTER(Key1,Rec."CM Object No.");
              CMMSAdditionalData.SETFILTER(Key2,RespUserIDFilter);
              IF CMMSAdditionalData.FINDFIRST THEN
                Rec.MARK(TRUE);

              {Responsibility Center --> Asset}
              IF AssetRespFilter <> '' THEN BEGIN
                CMMSObject.SETRANGE(Objecttype, CMMSObject.Objecttype::Asset);
                CMMSObject.SETRANGE("No.", Rec."CM Object No.");
                CMMSObject.SETFILTER("Responsibility Center", AssetRespFilter);
                IF CMMSObject.FINDFIRST THEN
                  Rec.MARK(TRUE);
              END;

              {Responsibility Center --> Project}
              IF ProjectRespFilter <> '' THEN BEGIN
                CMMSObject.SETRANGE(Objecttype, CMMSObject.Objecttype::Project);
                CMMSObject.SETRANGE("No.", Rec."CM Object No.");
                CMMSObject.SETFILTER("Responsibility Center", ProjectRespFilter);
                IF CMMSObject.FINDFIRST THEN
                  Rec.MARK(TRUE);
              END;
            END
            ELSE
              Rec.MARK(TRUE);
          UNTIL Rec.NEXT = 0;
      END;

      IF AssignedUserIDFilter <> '' THEN BEGIN
        Rec.SETRANGE("CM Object No.");
        Rec.SETFILTER("CM User ID Filter",AssignedUserIDFilter);
        {Assigned Tasks to User}
        IF Rec.FIND('-') THEN
          REPEAT
            Rec.CALCFIELDS("CM Show Workorder");
            IF Rec."CM Show Workorder" THEN
              Rec.MARK(TRUE);
          UNTIL Rec.NEXT = 0;
        {Direct assigned Workorders}
        Rec.SETFILTER("CM Assigned User ID", AssignedUserIDFilter);
        IF Rec.FIND('-') THEN
          REPEAT
            Rec.MARK(TRUE);
          UNTIL Rec.NEXT = 0;
        Rec.SETRANGE("CM Assigned User ID");
      END;

      Rec.FILTERGROUP(0);

      IF (AssignedUserIDFilter <> '') OR (RespUserIDFilter <> '') THEN
        Rec.MARKEDONLY(TRUE);

      EXIT;
    END;

    PROCEDURE ShowWorkorders@1000000018(ObjectNo@1000000007 : Code[20];RespUserIDFilter@1000000000 : Text;AssignedUserIDFilter@1000000005 : Text;DateFilter@1000000001 : Text;StatusFilter@1000000006 : Text;DateFilter2@1000000011 : Text;SourceFilter@1000000012 : Text);
    VAR
      ListPage@1000000003 : Page 70101;
      Rec@1000000004 : Record 5092;
    BEGIN
      GetWorkorders(Rec, ObjectNo, RespUserIDFilter, AssignedUserIDFilter, DateFilter, StatusFilter, DateFilter2, SourceFilter);

      ListPage.SETTABLEVIEW(Rec);
      ListPage.RUN();
    END;

    PROCEDURE CountWorkorders@1000000015(ObjectNo@1000000007 : Code[20];RespUserIDFilter@1000000000 : Text;AssignedUserIDFilter@1000000005 : Text;DateFilter@1000000001 : Text;StatusFilter@1000000006 : Text;DateFilter2@1000000010 : Text;SourceFilter@1000000011 : Text) : Integer;
    VAR
      Rec@1000000004 : Record 5092;
    BEGIN
      GetWorkorders(Rec, ObjectNo, RespUserIDFilter, AssignedUserIDFilter, DateFilter, StatusFilter, DateFilter2, SourceFilter);

      EXIT(Rec.COUNT)
    END;

    LOCAL PROCEDURE OptimizeKey@1000000005(VAR Rec@1000000002 : Record 5092;ObjectNo@1000000007 : Code[20];RespUserIDFilter@1000000000 : Text;AssignedUserIDFilter@1000000005 : Text;DateFilter@1000000001 : Text;StatusFilter@1000000006 : Text;DateFilter2@1000000010 : Text;SourceFilter@1000000011 : Text) : Integer;
    BEGIN
      //Selects a performant key for GetWorkorders()
      IF DisableKeyOptimization THEN
        EXIT;

      IF ObjectNo <> '' THEN BEGIN
        Rec.SETCURRENTKEY("CM Is Workorder","CM Object No.");
        EXIT;
      END;

      IF StatusFilter <> '' THEN BEGIN
        Rec.SETCURRENTKEY("CM Is Workorder","CM Status","CM Source");
        EXIT;
      END;

      IF (SourceFilter <> '') AND (StatusFilter = '') THEN BEGIN
        Rec.SETCURRENTKEY("CM Is Workorder","CM Source");
        EXIT;
      END;
    END;

    PROCEDURE ShowWorkorderCard@1000000016(VAR Rec@1000000005 : Record 5092);
    VAR
      Rec2@1000000004 : Record 5092;
      CardPage@1000000003 : Page 70100;
    BEGIN
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE("No.",Rec."No.");
      Rec2.FILTERGROUP(0);

      CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::Read, Rec."No.", '');
      CMWoMgt.ChangeStatusOpenToNew(Rec);
      CardPage.SETTABLEVIEW(Rec2);
      CardPage.RUN();
    END;

    PROCEDURE ShowWorkorderArchive@1000000007();
    VAR
      Rec@1000000001 : Record 5092;
      ListPage@1000000000 : Page 70101;
    BEGIN
      Rec.RESET;
      Rec.FILTERGROUP(2);
      Rec.SETCURRENTKEY("CM Is Workorder","CM Status","CM Source");
      Rec.SETRANGE("CM Is Workorder", TRUE);
      Rec.SETFILTER("CM Status", '4|5');
      Rec.FILTERGROUP(2);

      ListPage.SETTABLEVIEW(Rec);
      ListPage.RUN();
    END;

    PROCEDURE "###MISC###"@1000000027();
    BEGIN
    END;

    LOCAL PROCEDURE ChangeLogEntryAfterStatusChange@1000000042(LogEntryNo@1000000000 : Integer;RelatedLogEntryNo@1000000001 : Integer;TicketClosingReason@1000000002 : Integer);
    VAR
      LocLogEntry@1000000003 : Record 5065;
    BEGIN
      IF NOT LocLogEntry.GET(LogEntryNo) THEN
        EXIT;

      LocLogEntry."CM Status Change Standard Text" := TicketClosingReason;
      LocLogEntry."CM Related Entry No." := RelatedLogEntryNo;
      LocLogEntry.MODIFY(FALSE);
    END;

    LOCAL PROCEDURE CloseTasksAutomatically@1000000024(Rec@1000000000 : Record 5092);
    VAR
      Task@1000000001 : Record 5080;
    BEGIN
      IF Rec."No." = '' THEN
        EXIT;

      CLEAR(Task);
      Task.RESET;
      Task.SETCURRENTKEY("Opportunity No.","CM Type","CM Assigned User ID","CM Status");
      Task.SETRANGE("Opportunity No.", Rec."No.");
      Task.SETRANGE("CM Type", Task."CM Type"::Task);
      Task.SETRANGE("CM Subtype", Task."CM Subtype"::" ");
      IF Task.FIND('-') THEN BEGIN
        REPEAT
          IF Task."CM Status" = Task."CM Status"::Open THEN BEGIN
            Task."CM Status" := Task."CM Status"::Closed;
            Task."CM Automatically Closed" := TRUE;
            CMGenMgt.CreateLogEntry(Task,LogEntry."CM Log Type"::"Status Change",FORMAT(Task."CM Status"), Text009);
            Task.MODIFY(FALSE);
            Task."CM Status" := Task."CM Status"::Open; //Dont know why, but the REPEAT Loop needs this to find NEXT
          END;
        UNTIL Task.NEXT = 0;
      END;
    END;

    PROCEDURE ExportToExcel@1000000029(Rec@1000000000 : Record 5092);
    VAR
      Rec2@1000000001 : Record 5092;
    BEGIN
      Rec2.SETRANGE("No.", Rec."No.");
      REPORT.RUNMODAL(70007, TRUE, FALSE, Rec2);
    END;

    PROCEDURE RunSiteVisitionReport@1000000022(Rec@1000000000 : Record 5092;Mode@1000000003 : 'Run Report,Preview,Save As PDF');
    VAR
      Rec2@1000000001 : Record 5092;
      Rep@1000000002 : Report 70001;
      FileMgt@1000000004 : Codeunit 419;
      Timestamp@1000000005 : Text;
      ServerTempFilename@1000000006 : Text;
      ClientFilename@1000000007 : Text;
    BEGIN
      Rec2.SETRANGE("No.", Rec."No.");
      Rep.SETTABLEVIEW(Rec2);
      Timestamp := DateTimeToString(CURRENTDATETIME);

      CASE Mode OF
        Mode::"Run Report"    : Rep.RUNMODAL();
        Mode::Preview         : Rep.EXECUTE('');
        Mode::"Save As PDF"   : BEGIN
          ServerTempFilename := FileMgt.ServerTempFileName('pdf');
          ClientFilename := STRSUBSTNO(Text014, Rec."No.", Rec."CM Object Name", Timestamp, 'pdf');
          Rep.SAVEASPDF(ServerTempFilename);
          DOWNLOAD(ServerTempFilename,'Save File', '','PDF |*.pdf', ClientFilename);
          FileMgt.DeleteServerFile(ServerTempFilename);
        END;
      END;
    END;

    PROCEDURE LookupSubcontractor@1000000028(Rec@1000000000 : Record 5092) : Code[20];
    VAR
      CMAddData@1000000001 : Record 70021;
      Contact@1000000002 : Record 5050;
      CMGenSetup@1000000003 : Record 70000;
      ListPage1@1000000004 : Page 70055;
      ListPage2@1000000005 : Page 5052;
    BEGIN
      //With Object
      IF Rec."CM Object No." <> '' THEN BEGIN
        IF NOT CMGenSetup.GET() THEN
          CMGenSetup.INIT;

        CMGenSetup.TESTFIELD("Subcontractor Bus. Rel. Code");

        CMAddData.SETRANGE(Objecttype, Rec."CM Objecttype");
        CMAddData.SETRANGE(Type, CMAddData.Type::Relation);
        CMAddData.SETRANGE(Key1, Rec."CM Object No.");
        CMAddData.SETRANGE("Business Relation Code", CMGenSetup."Subcontractor Bus. Rel. Code");
        IF CMAddData.FINDSET() THEN
          ;

        ListPage1.LOOKUPMODE(TRUE);
        ListPage1.SETTABLEVIEW(CMAddData);
        IF ListPage1.RUNMODAL <> ACTION::LookupOK THEN
          EXIT('');

        ListPage1.GETRECORD(CMAddData);
        EXIT(CMAddData.Key2);
      END;

      //No Object --> Contact List
      ListPage2.LOOKUPMODE(TRUE);
      IF ListPage2.RUNMODAL <> ACTION::LookupOK THEN
          EXIT('');

      ListPage2.GETRECORD(Contact);
      EXIT(Contact."No.");
    END;

    LOCAL PROCEDURE FillObjectName@1000000031(VAR Rec@1000000000 : Record 5092);
    VAR
      CMObject@1000000001 : Record 70020;
    BEGIN
      IF (Rec."CM Object No." <> '') AND (Rec."CM Object Name" = '') THEN BEGIN
        IF NOT CMObject.GET(Rec."CM Objecttype", Rec."CM Object No.") THEN
          CMObject.INIT;

        Rec."CM Object Name" := CMObject.Name;
        Rec."CM Object Name 2" := CMObject."Name 2";
      END;
    END;

    PROCEDURE IsStatusOpen@1000000040(Rec@1000000000 : Record 5092) : Boolean;
    BEGIN
      EXIT(NOT IsStatusClosed(Rec));
    END;

    PROCEDURE IsStatusClosed@1000000038(Rec@1000000000 : Record 5092) : Boolean;
    BEGIN
      EXIT
      (Rec."CM Status" IN
      [
          Rec."CM Status"::Done,
          Rec."CM Status"::Discarded
      ]);
    END;

    PROCEDURE DateTimeToString@1000000039(value@1000000002 : DateTime) : Text;
    VAR
      DotNetDateTime@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
    BEGIN
      DotNetDateTime := value;
      EXIT(DotNetDateTime.ToString('yyyy-MM-dd_HH\hmm'));
    END;

    PROCEDURE CheckCommentLength@1000000043(CommentText@1000000000 : Text[250]);
    VAR
      CMGenSetup@1000000001 : Record 70000;
    BEGIN
      IF (CommentText = '') OR (NOT CMGenSetup.GET()) OR (CMGenSetup."Min. Comment Len. (Wo. Status)" <= 0) THEN
        EXIT;

      IF STRLEN(CommentText) < CMGenSetup."Min. Comment Len. (Wo. Status)" THEN
        ERROR(Text015, CMGenSetup."Min. Comment Len. (Wo. Status)");
    END;

    PROCEDURE "### SPECIAL ###"@1000000034();
    BEGIN
    END;

    PROCEDURE SetKeyOpimization@1000000048(value@1000000000 : Boolean);
    BEGIN
      DisableKeyOptimization := NOT value;
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70031 CMMS Task Management
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=12:32:06;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      CMGenMgt@1000000000 : Codeunit 70000;
      CMWoMgt@1000000014 : Codeunit 70030;
      CMTTMgt@1000000025 : Codeunit 70040;
      LogEntry@1000000001 : Record 5065;
      Text001@1000000002 : TextConst 'ENU=You have to type in the Reason for this Action!;DEA=Sie mssen den Grund fr diese Aktion eintragen!';
      Text002@1000000003 : TextConst 'ENU=Only Tasks with Status "%1" can be closed!;DEA=Nur Aufgabe im Status "%1" k”nnen geschlossen werden!';
      Text003@1000000004 : TextConst 'ENU=Only Tasks with Status "%1" can finished!;DEA=Nur Aufgabe im Status "%1" k”nnen erledigt werden!';
      Text004@1000000005 : TextConst 'ENU=There are already started / finished Tasks for this Workorder!;DEA=Es existieren bereits begonnene / abgeschlossene Aufgaben zu diesem Arbeitsauftrag!';
      Text005@1000000006 : TextConst 'ENU="Replace existing Tasks? (Yes = replace, No = append)";DEA="Bestehenden Aufgaben ersetzen? (Ja = ersetzen, Nein = Hinzufgen)"';
      Text006@1000000007 : TextConst 'ENU=Canceled.;DEA=Abgebrochen.';
      Text007@1000000008 : TextConst 'ENU=The program has stopped importing the attachment at your request.;DEA=Das Programm hat den Import des Dateianhangs auf Ihren Befehl abgebrochen.';
      Text008@1000000009 : TextConst 'ENU=Invalid Call!;DEA=Ungltiger Aufruf!';
      Text009@1000000010 : TextConst 'ENU=Combine Request(s) to Workorder? Based on your selection there will be a Workorder with %1 Task(s)!;DEA=Anfrage(n) in Arbeitsauftrag berleiten? Anhand ihrer Auswahl wird ein Arbeitsauftrag mit %1 Aufgabe(n) erstellt!';
      Text010@1000000011 : TextConst 'ENU=You can only convert open requests!;DEA=Sie k”nnen nur offene Anfragen berleiten!';
      Text011@1000000012 : TextConst 'ENU=Request %1 has no Object Information!;DEA=Anfrage %1 hat keine Objektinformationen!';
      Text012@1000000013 : TextConst 'ENU=Only request for the same Asset can comined in one Workorder!;DEA=Es drfen nur Anfragen mit der selben Anlage in einen Arbeitsauftrag zusammengefhrt werden!';
      Text013@1000000015 : TextConst 'ENU=Request %1 successfully created!;DEA=Anfrage %1 erfolgreich erstellt!';
      Text014@1000000016 : TextConst 'ENU=Select at least one Request!;DEA=W„hlen Sie min. eine Anfrage aus!';
      Text015@1000000017 : TextConst 'ENU=Reject %1 Request(s)?;DEA=%1 Anfragen ablehnen?';
      Text016@1000000018 : TextConst 'ENU=Team Member ''%1'' already exists!;DEA=Teammitglied ''%1'' existiert bereits!';
      Text017@1000000019 : TextConst 'ENU=Team Member ''%1'' is already responsible for the Task!;DEA=Teammitglied ''%1'' ist bereits fr den Task zust„ndig!';
      Text018@1000000020 : TextConst 'ENU=Please fill all required fields!;DEA=Bitte befllen Sie alle Pflichtfelder!';
      Text019@1000000021 : TextConst 'ENU=New Task "%1" created.';
      Text020@1000000022 : TextConst 'ENU=Caution! This task is assigned to an other user (%1).;DEA=Achtung! Dieser Task ist einem anderen Benutzer (%1) zugewiesen!';
      Text021@1000000023 : TextConst 'ENU=The Work Order for this Task (%1) has the status "%2". Task cannot be finished!;DEA=Der Arbeitsauftrag (%1) fr diese Aufgabe hat den Status "%2". Aufgabe kann nicht geschlossen werden!';
      Text022@1000000024 : TextConst 'ENU=Allowed if Task Status is "%1"!;DEA=Nur bei Aufgaben mit Status "%1" erlaubt!';
      Text023@1000000026 : TextConst 'ENU=Open file;DEA=Datei ”ffnen';
      Text024@1000000027 : TextConst 'ENU=Photo Taken!;DEA=Foto Gespeichert!';
      Text025@1000000028 : TextConst 'ENU=Attachment added.;DEA=Anhang hinzugefgt.';
      Text026@1000000029 : TextConst 'ENU=Error while uploading file!;DEA=Fehler beim Dateiupload!';
      Text027@1000000030 : TextConst 'ENU=There are already finished Tasks for this Workorder! Append new Tasks?;DEA=Es existieren bereits abgeschlossene Aufgaben zu diesem Arbeitsauftrag! Neue Aufgaben anh„ngen?';
      Text028@1000000031 : TextConst 'ENU=The Task (%1) for this Checklist Item has the status "%2". Checklist Item cannot be finished!;DEA=Die Aufgabe (%1) fr diesen Checklist Eintrag hat den Status "%2". Checklist Eintrag kann nicht geschlossen werden!';
      Text029@1000000032 : TextConst 'ENU=The Work Order (%1) for this Checklist Item has the status "%2". Checklist Item cannot be finished!;DEA=Der Arbeitsauftrag (%1) fr diesen Checklist Eintrag hat den Status "%2". Checklist Eintrag kann nicht geschlossen werden!';
      Text030@1000000033 : TextConst 'ENU=The Status cannot be changed anymore!;DEA=Der Status kann nicht mehr ge„ndert werden!';
      Text031@1000000034 : TextConst 'ENU=---,Yes,No,Not Applicable';
      Text032@1000000035 : TextConst 'ENU=Change Checklist Entry Status?;DEA=Checklist Status „ndern?';
      Text033@1000000036 : TextConst 'ENU=Cannot create Task. Status of Workorder "%1" is "%2".;DEA=Aufgabe kann nicht erstellt werden. Status von Arbeitsauftrag "%1" ist "%2".';
      Text034@1000000037 : TextConst 'ENU=Picture added.;DEA=Bild hinzugefgt.';
      CMPublisher@1000000038 : Codeunit 70037;
      Text035@1000000039 : TextConst 'ENU=From "%1" to "%2"';
      Text036@1000000040 : TextConst 'ENU=Cannot change Assigend User in Task %1. Task status is "%2".;DEA=Zugewiesener Benutzer kann bei Aufgabe %1 nicht ge„ndert werden. Status von Aufgabe ist "%2".';
      Text037@1000000041 : TextConst 'ENU=Cannot change Assigned User in Task %1. Status of Workorder %2 is "%3".;DEA=Zugewiesener Benutzer kann bei Aufgabe %1 nicht ge„ndert werden. Status von Arbeitsauftrag %2 ist "%3".';
      Text038@1000000042 : TextConst 'ENU=CMMS Task, Taskteam, Taskchecklist, Requests cannot be deleted.';

    PROCEDURE "###TRIGGER###"@1000000011();
    BEGIN
    END;

    PROCEDURE OnInsert@1000000001(VAR Rec@1000000000 : Record 5080);
    BEGIN
      IF (Rec."CM Type" = Rec."CM Type"::" ") OR (Rec."CM Is Temporary") THEN
        EXIT;

      CMGenMgt.GetTaskNo(Rec);
      AddObjectData(Rec);
      Rec.Date := WORKDATE;
      Rec."CM Created Datetime" := CURRENTDATETIME;

      IF Rec."CM Subtype" = Rec."CM Subtype"::" " THEN
        Rec."CM Maintask No." := Rec."No.";

      Rec."CM Created By User ID" := USERID;
      Rec.VALIDATE(Closed,TRUE);
      ValidateTeam(Rec);

      IF (Rec."CM Type" = Rec."CM Type"::Task) AND (Rec."CM Subtype" = Rec."CM Subtype"::" ") THEN
        CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::Created,Rec."No.", STRSUBSTNO(Text019, Rec."No."));

      CMPublisher.OnAfterInsertTask(Rec); //Publish
    END;

    PROCEDURE OnModify@1000000002(VAR Rec@1000000000 : Record 5080;VAR xRec@1000000001 : Record 5080);
    VAR
      Task@1000000002 : Record 5080;
      Workorder@1000000003 : Record 5092;
    BEGIN
    END;

    PROCEDURE OnDelete@1000000003(VAR Rec@1000000000 : Record 5080);
    BEGIN
      IF Rec."CM Type" = Rec."CM Type"::" " THEN
        EXIT;

      ERROR(Text038);
    END;

    PROCEDURE WoTypeTaskOnInsert@1000000007(VAR Rec@1000000000 : Record 5082);
    BEGIN
      UpdateWoTypeTask(Rec);
      ValidateWoTypeTeam(Rec);
    END;

    PROCEDURE WoTypeTaskOnRename@1000000014(VAR Rec@1000000000 : Record 5082;VAR xRec@1000000002 : Record 5082);
    VAR
      Subtask@1000000001 : Record 5082;
    BEGIN
      IF xRec."Step No." <> Rec."Step No." THEN BEGIN
        Subtask.SETCURRENTKEY("CM Maintask Step No.");
      ;
        Subtask.SETRANGE("CM Maintask Step No.", xRec."Step No.");
        Subtask.SETRANGE("Activity Code", xRec."Activity Code");

        Subtask.MODIFYALL("CM Maintask Step No.", Rec."Step No.", FALSE);
      END;
    END;

    PROCEDURE WoTypeTaskOnModify@1000000009(VAR Rec@1000000000 : Record 5082;VAR xRec@1000000002 : Record 5082);
    BEGIN
      IF Rec."CM Interaction Template Code" <> xRec."CM Interaction Template Code" THEN
        UpdateWoTypeTask(Rec);
    END;

    PROCEDURE WoTypeTaskOnDelete@1000000008(VAR Rec@1000000000 : Record 5082);
    VAR
      Subtask@1000000001 : Record 5082;
    BEGIN
      Subtask.SETCURRENTKEY("CM Maintask Step No.");

      Subtask.SETRANGE("CM Maintask Step No.", Rec."Step No.");
      Subtask.SETRANGE("Activity Code", Rec."Activity Code");

      Subtask.DELETEALL(FALSE);
    END;

    PROCEDURE "###WORKORDER TASK###"@1000000030();
    BEGIN
    END;

    PROCEDURE ValidateWoTypeTeam@1000000031(VAR Rec@1000000000 : Record 5082);
    VAR
      Rec2@1000000001 : Record 5082;
    BEGIN
      IF (Rec."CM Maintask Step No." = 0) OR (Rec."CM Subtype" <> Rec."CM Subtype"::Team) THEN
        EXIT;

      Rec.TESTFIELD("CM Assigned User ID");

      Rec2.SETRANGE("Activity Code", Rec."Activity Code");
      Rec2.SETRANGE("CM Maintask Step No.", Rec."CM Maintask Step No.");
      Rec2.SETRANGE("CM Subtype", Rec2."CM Subtype"::Team);
      Rec2.SETRANGE("CM Assigned User ID", Rec."CM Assigned User ID");
      Rec2.SETFILTER("Step No.", '<>%1', Rec."Step No.");
      IF Rec2.FINDFIRST() THEN
        ERROR(STRSUBSTNO(Text016, Rec."CM Assigned User ID"));
    END;

    LOCAL PROCEDURE UpdateWoTypeTask@1000000010(VAR Rec@1000000000 : Record 5082);
    VAR
      InteractionTpl@1000000001 : Record 5064;
    BEGIN
      IF InteractionTpl.GET(Rec."CM Interaction Template Code") THEN BEGIN
        Rec."CM Wizard Action" := InteractionTpl."Wizard Action";
        Rec."CM Information Type" := InteractionTpl."IG Information Type";
        Rec."CM Interaction Group Code" := InteractionTpl."Interaction Group Code";
      END;
    END;

    PROCEDURE ShowSubToWoTypeTask@1000000016(VAR Rec@1000000000 : Record 5082;CMType@1000000003 : Integer);
    VAR
      Rec2@1000000002 : Record 5082;
      ListPage@1000000001 : Page 70102;
      ListPage2@1000000004 : Page 70103;
    BEGIN
      Rec2.RESET;
      Rec2.SETCURRENTKEY("CM Maintask Step No.");
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE("CM Maintask Step No.", Rec."Step No.");
      Rec2.SETRANGE("Activity Code", Rec."Activity Code");
      Rec2.SETRANGE("CM Subtype", CMType);
      Rec2.FILTERGROUP(2);

      IF CMType = Rec2."CM Subtype"::Checklist THEN BEGIN
        ListPage.SETTABLEVIEW(Rec2);
        ListPage.RUN();
      END
      ELSE BEGIN
        ListPage2.SETTABLEVIEW(Rec2);
        ListPage2.RUN();
      END;
    END;

    PROCEDURE SetWoTypeSubSetupNo@1000000029(VAR Rec@1000000000 : Record 5082;CMType@1000000003 : Integer);
    VAR
      ActivityStep@1000000001 : Record 5082;
      MaintaskFilter@1000000002 : Text;
    BEGIN
      Rec.FILTERGROUP(2);
      MaintaskFilter := Rec.GETFILTER("CM Maintask Step No.");
      Rec.FILTERGROUP(0);

      ActivityStep.RESET;
      ActivityStep.SETRANGE("Activity Code", Rec."Activity Code");
      ActivityStep.SETFILTER("CM Maintask Step No.", MaintaskFilter);
      ActivityStep.SETRANGE("CM Subtype", CMType);
      IF ActivityStep.FINDLAST() THEN BEGIN
        //Do nothing
      END
      ELSE BEGIN
        ActivityStep.SETRANGE("CM Maintask Step No.", 0);
        ActivityStep.SETFILTER("Step No.", MaintaskFilter);
        ActivityStep.SETRANGE("CM Subtype");
        IF ActivityStep.FINDFIRST() THEN BEGIN
          IF CMType = ActivityStep."CM Subtype"::Checklist THEN
            Rec."Step No." := (ActivityStep."Step No." * 100);
          IF CMType = ActivityStep."CM Subtype"::Team THEN
            Rec."Step No." := (ActivityStep."Step No." * 10000);
        END;
      END;
    END;

    PROCEDURE "###TASK FUNCTIONS###"@1000000012();
    BEGIN
    END;

    PROCEDURE NewTaskToWorkorder@1000000000(VAR Workorder@1000000000 : Record 5092;VAR Task@1000000007 : Record 5080;ShowPage@1000000005 : Boolean;DoInsert@1000000006 : Boolean);
    VAR
      ConfPage@1000000002 : Page 70114;
      TempTask@1000000003 : TEMPORARY Record 5080;
      CMAddData@1000000004 : Record 70021;
    BEGIN
      IF Workorder."CM Status" IN [Workorder."CM Status"::Done, Workorder."CM Status"::Discarded] THEN
        ERROR(Text033, Workorder."No.", Workorder."CM Status");

      TempTask.INIT;
      TempTask."No." := '';
      TempTask."CM Type" := TempTask."CM Type"::Task;
      TempTask."CM Maintask No." := '';
      TempTask."Opportunity No." := Workorder."No.";
      TempTask."CM Due Date" := Workorder."CM Due Date";
      TempTask."CM Assigned User ID" := GetFieldserviceUser(Workorder);
      IF TempTask."CM Assigned User ID" = '' THEN
        TempTask."CM Assigned User ID" := Workorder."CM Assigned User ID";
      TempTask."CM Is Temporary" := TRUE;
      TempTask.INSERT(FALSE);
      TempTask.SETRECFILTER();

      IF ShowPage THEN BEGIN
        ConfPage.SetRec(TempTask);
        ConfPage.LOOKUPMODE := TRUE;
        IF ConfPage.RUNMODAL() <> ACTION::Yes THEN
          ERROR(Text006);
        ConfPage.GETRECORD(TempTask);
      END;

      Task.INIT;
      Task.TRANSFERFIELDS(TempTask);
      Task."CM Is Temporary" := FALSE;
      IF DoInsert THEN
        Task.INSERT(TRUE);

      //AddFieldServiceTeam(Task);
    END;

    PROCEDURE NewTaskToWorkorderUI@1000000047(VAR Workorder@1000000000 : Record 5092);
    VAR
      Task@1000000001 : Record 5080;
    BEGIN
      NewTaskToWorkorder(Workorder, Task, TRUE, TRUE);
    END;

    PROCEDURE CreateTasksToWorkorder@1000000006(Workorder@1000000000 : Record 5092);
    VAR
      Task@1000000001 : Record 5080;
      WoTypeTask@1000000002 : Record 5082;
    BEGIN
      IF NOT Workorder."CM Is Workorder" THEN
        ERROR(Text008);

      Task.RESET;
      WoTypeTask.RESET;
      WoTypeTask.SETCURRENTKEY("CM Maintask Step No.");
      WoTypeTask.SETRANGE("CM Maintask Step No.", 0);
      WoTypeTask.SETRANGE("Activity Code", Workorder."CM Work Order Type Code");
      IF NOT WoTypeTask.FINDFIRST() THEN
        EXIT;

      Task.RESET;
      Task.SETCURRENTKEY("Opportunity No.","CM Type","CM Assigned User ID","CM Status");
      Task.SETRANGE("Opportunity No.", Workorder."No.");
      Task.SETRANGE("CM Type", Task."CM Type"::Task);
      Task.SETFILTER("CM Status",'<>%1',Task."CM Status"::Open);
      IF Task.FINDFIRST() THEN BEGIN //Existing Tasks which are NOT open --> Append
        IF NOT CONFIRM(Text027) THEN
          ERROR(Text006);
      END
      ELSE BEGIN //Existing Tasks which are open --> Append or Replace
        Task.SETRANGE("CM Status",Task."CM Status"::Open);
        IF Task.FINDFIRST() THEN BEGIN
          IF CONFIRM(Text005) THEN
            CMGenMgt.DeleteTasksByWo(Workorder,TRUE);
        END;
      END;

      //Ok Create New Tasks:
      Task.RESET;
      IF WoTypeTask.FIND('-') THEN BEGIN
        REPEAT
          Task.INIT;
          Task."Opportunity No." := Workorder."No.";
          IF WoTypeTask."CM Assigned User ID" <> '' THEN
            Task."CM Assigned User ID" := WoTypeTask."CM Assigned User ID"
          ELSE
            Task."CM Assigned User ID" := Workorder."CM Assigned User ID";
          Task."CM Duration (Planned)" := WoTypeTask."CM Planned Duration";
          Task.Description := WoTypeTask.Description;
          Task."CM Extended Description" := WoTypeTask."CM Extended Description";
          Task.Priority := WoTypeTask.Priority;
          Task."CM Creation Type" := Task."CM Creation Type"::"Workorder Type";
          Task."CM Maintask No." := '';

          Task."Interaction Template Code" := WoTypeTask."CM Interaction Template Code";
          Task."CM Interaction Group Code" := WoTypeTask."CM Interaction Group Code";
          Task."CM Wizard Action" := WoTypeTask."CM Wizard Action";
          Task."CM Information Type" := WoTypeTask."CM Information Type";

          //Insert:
          Task."CM Type" := Task."CM Type"::Task;
          Task."CM Is Temporary" := FALSE;
          Task."No." := '';
          Task.INSERT(TRUE);

          //Checklist
          CreateChecklistAndTeam(Task,WoTypeTask);

        UNTIL WoTypeTask.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE CreateChecklistAndTeam@1000000018(Maintask@1000000001 : Record 5080;MainWoTypeTask@1000000000 : Record 5082);
    VAR
      ChecklistTeam@1000000003 : Record 5080;
      WoTypeSub@1000000002 : Record 5082;
    BEGIN
      WoTypeSub.RESET;
      WoTypeSub.SETCURRENTKEY("CM Maintask Step No.");

      WoTypeSub.SETRANGE("CM Maintask Step No.", MainWoTypeTask."Step No.");
      WoTypeSub.SETRANGE("Activity Code", MainWoTypeTask."Activity Code");
      IF WoTypeSub.FIND('-') THEN BEGIN
        REPEAT
          //Dont Add Team member, if Task belongs to this Team member:
          IF NOT ((WoTypeSub."CM Subtype" = WoTypeSub."CM Subtype"::Team) AND (WoTypeSub."CM Assigned User ID" = Maintask."CM Assigned User ID")) THEN BEGIN
            ChecklistTeam.INIT;
            ChecklistTeam.TRANSFERFIELDS(Maintask);
            ChecklistTeam.Description := WoTypeSub.Description;
            ChecklistTeam."CM Maintask No." := Maintask."No.";
            ChecklistTeam."CM Subtype" := WoTypeSub."CM Subtype";
            ChecklistTeam."CM Type" := ChecklistTeam."CM Type"::Task;
            IF ChecklistTeam."CM Subtype" = ChecklistTeam."CM Subtype"::Team THEN
              ChecklistTeam."CM Assigned User ID" := WoTypeSub."CM Assigned User ID";
            IF ChecklistTeam."CM Subtype" = ChecklistTeam."CM Subtype"::Checklist THEN
              ChecklistTeam."CM Assigned User ID" := '';
            ChecklistTeam."CM Is Temporary" := FALSE;
            ChecklistTeam."No." := '';
            ChecklistTeam.INSERT(TRUE);
          END;
        UNTIL WoTypeSub.NEXT = 0;
      END;
    END;

    PROCEDURE ChangeTaskStatusUI@1000000005(VAR Rec@1000000000 : Record 5080);
    VAR
      OldStatusText@1000000001 : Text;
      OldStatus@1000000011 : Integer;
      EndTaskPage@1000000002 : Page 70115;
      LogEntry@1000000003 : Record 5065;
      TempAttachment@1000000004 : TEMPORARY Record 5062;
      NewAssetComp@1000000007 : Record 70025;
      TempNewAssetComp@1000000005 : TEMPORARY Record 70025;
      OldAssetComp@1000000009 : Record 70025;
      Asset@1000000008 : Record 70020;
      CMTTMgt@1000000010 : Codeunit 70040;
      CMEqMgt@1000000006 : Codeunit 70025;
    BEGIN
      IF (Rec."CM Type" <> Rec."CM Type"::Task) OR (Rec."CM Subtype" <> Rec."CM Subtype"::" ")THEN
        ERROR(Text008);

      Rec.CALCFIELDS("CM Workoder Status");
      IF (Rec."CM Workoder Status" IN [Rec."CM Workoder Status"::Discarded, Rec."CM Workoder Status"::Done]) THEN
        ERROR(STRSUBSTNO(Text021, Rec."Opportunity No.", Rec."CM Workoder Status"));

      IF Rec."CM Status" <> Rec."CM Status"::Open THEN
        ERROR(STRSUBSTNO(Text003,Rec."CM Status"::Open));

      IF (Rec."CM Assigned User ID" <> USERID) AND (Rec."CM Assigned User ID" <> '') THEN BEGIN
        Rec.CALCFIELDS("CM Assigned User Name");
        MESSAGE(STRSUBSTNO(Text020, Rec."CM Assigned User Name"));
      END;

      //Init
      EndTaskPage.LOOKUPMODE := TRUE;
      EndTaskPage.SetData(Rec);
      IF (EndTaskPage.RUNMODAL() <> ACTION::Yes) THEN
        EXIT;
      EndTaskPage.GetNewComponent(TempNewAssetComp);

      //Handle Information Types
      IF Rec."CM Wizard Action" = Rec."CM Wizard Action"::Information THEN BEGIN
        IF (Rec."CM Information Type" = Rec."CM Information Type"::Installation) AND (EndTaskPage.GetNewStatus <> Rec."CM Status"::"Done Negative") THEN BEGIN
          NewAssetComp.INIT;
          NewAssetComp.Type := NewAssetComp.Type::Equipment;
          NewAssetComp."Component Type" := TempNewAssetComp."Component Type";
          NewAssetComp.Key1 := Rec."CM Object No.";
          CMEqMgt.InsertEQPT(NewAssetComp);
          NewAssetComp."Replaced with Entry No." := 0;
          NewAssetComp."Serial Number" := TempNewAssetComp."Serial Number";
          NewAssetComp.Description := TempNewAssetComp.Description;
          NewAssetComp.MODIFY(FALSE);
        END;

        IF (Rec."CM Information Type" = Rec."CM Information Type"::Replacement) AND (EndTaskPage.GetNewStatus <> Rec."CM Status"::"Done Negative")THEN BEGIN
          EndTaskPage.GetOldComponent(OldAssetComp);

          NewAssetComp.INIT;
          NewAssetComp.Type := NewAssetComp.Type::Equipment;
          NewAssetComp.Objecttype := OldAssetComp.Objecttype;
          NewAssetComp."Component Type" := OldAssetComp."Component Type";
          NewAssetComp.Key1 := Rec."CM Object No.";
          CMEqMgt.InsertEQPT(NewAssetComp);
          NewAssetComp."Replaced with Entry No." := 0;
          NewAssetComp."Serial Number" := TempNewAssetComp."Serial Number";
          NewAssetComp.Description := TempNewAssetComp.Description;
          NewAssetComp.MODIFY(FALSE);

          OldAssetComp."Replaced with Entry No." := NewAssetComp."Component Type";
          OldAssetComp.MODIFY(FALSE);
        END;
      END;

      //Create Additional Comment
      IF EndTaskPage.GetComment() <> '' THEN
        CMGenMgt.CreateLogEntryComment(Rec,TRUE, EndTaskPage.GetComment());

      //Post Time
      IF EndTaskPage.GetTimeNeeded() > 0 THEN
        CMTTMgt.PostFromTask(Rec, EndTaskPage.GetTimeNeeded(), 0D, 0DT);

      //Change Status
      Rec.Status := Rec.Status::Completed;
      OldStatusText := FORMAT(Rec."CM Status");
      OldStatus := Rec."CM Status";
      Rec."CM Status" := EndTaskPage.GetNewStatus();
      EndTaskPage.GetAttachment(TempAttachment);

      //Create Custom Log
      CMGenMgt.SetAttachment(TempAttachment);
      CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::"Status Change",FORMAT(Rec."CM Status"),EndTaskPage.GetComment());
      Rec.MODIFY(FALSE);

      CMPublisher.OnAfterChangeTaskStatus(Rec, OldStatus, Rec."CM Status"); //Publisher
    END;

    PROCEDURE ChangeChecklistItemStatus@1000000021(VAR Rec@1000000000 : Record 5080);
    VAR
      EndTaskPage@1000000001 : Page 70115;
      Result@1000000002 : Integer;
    BEGIN
      IF (Rec."CM Type" <> Rec."CM Type"::Task) OR (Rec."CM Subtype" <> Rec."CM Subtype"::Checklist) THEN
        ERROR(Text008);

      //Check Workorder Status
      Rec.CALCFIELDS("CM Workoder Status");
      IF Rec."CM Workoder Status" IN [Rec."CM Workoder Status"::Done, Rec."CM Workoder Status"::Discarded] THEN
        ERROR(Text029, Rec."Opportunity No.", Rec."CM Workoder Status");

      //Select Status
      Result := STRMENU(Text031, 1, Text032) - 1;
      IF Result < 0 THEN //Cancel
        EXIT;

      IF Rec."CM Status" <> Result THEN BEGIN
        Rec."CM Status" := Result;
        Rec."CM Checklist Status (Helper)" := Result;
        CMGenMgt.CreateLogEntry(Rec,LogEntry."CM Log Type"::"Status Change",FORMAT(Rec."CM Checklist Status (Helper)"), '');
        Rec.MODIFY(FALSE);
      END;
    END;

    PROCEDURE ChangeAssignedUserID@1000000050(VAR Rec@1000000000 : Record 5080;NewAssignedUserID@1000000001 : Code[50];OldAssignedUserID@1000000006 : Code[50];DoModify@1000000007 : Boolean);
    VAR
      CMGenMgt@1000000005 : Codeunit 70000;
      CMPublisher@1000000004 : Codeunit 70037;
      LogEntry@1000000003 : Record 5065;
      Team@1000000002 : Record 5080;
    BEGIN
      IF (Rec.ISTEMPORARY) OR (Rec."CM Is Temporary") OR (Rec."No." = '')  THEN
        EXIT;

      IF (Rec."CM Type" <> Rec."CM Type"::Task) OR
         (Rec."CM Subtype" <> Rec."CM Subtype"::" ") OR
         (NewAssignedUserID = OldAssignedUserID) THEN
        EXIT;

      IF Rec."CM Status" <> Rec."CM Status"::Open THEN
        ERROR(Text036, Rec."No.", Rec."CM Status");

      Rec.CALCFIELDS("CM Workoder Status");
      IF Rec."CM Workoder Status" IN [Rec."CM Workoder Status"::Done, Rec."CM Workoder Status"::Discarded] THEN
        ERROR(Text037, Rec."No.", Rec."Opportunity No.", Rec."CM Workoder Status");

      Team.SETCURRENTKEY("CM Type","CM Maintask No.","CM Assigned User ID","CM Status");
      Team.SETRANGE("CM Type", Team."CM Type"::Task);
      Team.SETRANGE("CM Subtype", Team."CM Subtype"::Team);
      Team.SETRANGE("CM Maintask No.", Rec."No.");
      Team.SETRANGE("CM Assigned User ID", Rec."CM Assigned User ID");
      IF Team.FINDFIRST() THEN
        Team.DELETE();

      Rec."CM Assigned User ID" := NewAssignedUserID;
      IF DoModify THEN
        Rec.MODIFY;

      CMGenMgt.CreateLogEntry(Rec, LogEntry."CM Log Type"::"Assigned User Changed", NewAssignedUserID,
                            STRSUBSTNO(Text035, OldAssignedUserID, NewAssignedUserID));

      CMPublisher.OnAfterChangeTaskAssignedUserID(Rec, OldAssignedUserID, NewAssignedUserID); //Publish
    END;

    PROCEDURE ShowSubToTask@1000000020(VAR Rec@1000000000 : Record 5080;CMSubType@1000000003 : Integer);
    VAR
      Rec2@1000000001 : Record 5080;
      ListPage@1000000002 : Page 70117;
      ListPage2@1000000004 : Page 70122;
    BEGIN
      Rec2.RESET;
      Rec2.SETCURRENTKEY("CM Type","CM Maintask No.","CM Assigned User ID","CM Status");
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE("CM Type", Rec2."CM Type"::Task);
      Rec2.SETRANGE("CM Maintask No.", Rec."No.");
      Rec2.SETRANGE("CM Subtype", CMSubType);
      Rec2.FILTERGROUP(2);

      IF CMSubType = Rec2."CM Subtype"::Checklist THEN BEGIN
        ListPage.SETTABLEVIEW(Rec2);
        ListPage.RUN();
      END
      ELSE BEGIN
        ListPage2.SETTABLEVIEW(Rec2);
        ListPage2.RUN();
      END;
    END;

    PROCEDURE ShowSubToRecurTask@1000000017(VAR Rec@1000000000 : Record 70021);
    VAR
      Rec2@1000000002 : Record 70021;
      ListPage@1000000001 : Page 70062;
    BEGIN
      Rec2.RESET;
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE(Objecttype, Rec.Objecttype);
      Rec2.SETRANGE(Type, Rec.Type);
      Rec2.SETRANGE(Key1, Rec.Key1);
      Rec2.SETRANGE(Key2, Rec.Key2);
      Rec2.SETRANGE(Key3, Rec.Key3);
      Rec2.SETRANGE("Maintask Step No.", Rec."Step No.");
      //Rec2.SETRANGE("Activity Code", Rec."Activity Code");
      Rec2.SETRANGE("Maintask Line No.", Rec."Line No.");
      Rec2.SETRANGE(Subtype, Rec2.Subtype::Checklist);
      Rec2.FILTERGROUP(0);

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE ShowTaskCard@1000000025(VAR Rec@1000000000 : Record 5080);
    VAR
      CardPage@1000000001 : Page 70119;
      Rec2@1000000002 : Record 5080;
    BEGIN
      Rec2.GET(Rec."No.");
      Rec2.SETRECFILTER();

      CardPage.LOOKUPMODE(FALSE);
      CardPage.SETRECORD(Rec2);
      CardPage.RUN();
    END;

    PROCEDURE ShowRelatedLogs@1000000040(VAR Rec@1000000000 : Record 5080;LogTypeFilter@1000000003 : Text);
    VAR
      Rec2@1000000001 : Record 5065;
      ListPage@1000000002 : Page 70111;
    BEGIN
      GetRelatedLogs(Rec, Rec2, LogTypeFilter);

      ListPage.SETTABLEVIEW(Rec2);
      ListPage.SETRECORD(Rec2);
      ListPage.RUN();
    END;

    PROCEDURE CountRelatedLogs@1000000045(VAR Rec@1000000000 : Record 5080;LogTypeFilter@1000000003 : Text) : Integer;
    VAR
      Rec2@1000000001 : Record 5065;
    BEGIN
      GetRelatedLogs(Rec, Rec2, LogTypeFilter);

      EXIT(Rec2.COUNT());
    END;

    LOCAL PROCEDURE GetRelatedLogs@1000000046(VAR Rec@1000000000 : Record 5080;VAR Rec2@1000000001 : Record 5065;LogTypeFilter@1000000003 : Text);
    BEGIN
      Rec2.RESET;
      Rec2.SETCURRENTKEY("CM Is CMMS Log Entry","CM Source","CM Source No.","CM Log Type");
      Rec2.FILTERGROUP(2);
      Rec2.SETRANGE("CM Is CMMS Log Entry", TRUE);
      IF LogTypeFilter <> '' THEN
        Rec2.SETFILTER("CM Log Type", LogTypeFilter);
      Rec2.FILTERGROUP(0);

      IF Rec."CM Subtype" = Rec."CM Subtype"::" " THEN
        Rec2.SETRANGE("CM Source",Rec2."CM Source"::Task);
      IF Rec."CM Subtype" = Rec."CM Subtype"::Checklist THEN
        Rec2.SETRANGE("CM Source",Rec2."CM Source"::Checklist);

      Rec2.SETRANGE("CM Source No.", Rec."No.");
    END;

    PROCEDURE TrackTaskTime@1000000039(VAR Rec@1000000000 : Record 5080);
    VAR
      Hours@1000000001 : Decimal;
      ConfPage@1000000002 : Page 70116;
    BEGIN
      IF Rec."CM Status" <> Rec."CM Status"::Open THEN
        ERROR(STRSUBSTNO(Text022, Rec."CM Status"::Open));

      ConfPage.LOOKUPMODE(TRUE);
      IF ConfPage.RUNMODAL() <> ACTION::Yes THEN
        ERROR(Text006);

      Hours := ConfPage.GetDuration();
      IF Hours <= 0 THEN
        ERROR(Text006);

      CMTTMgt.PostFromTask(Rec, Hours, 0D, 0DT);
    END;

    PROCEDURE "### Attachments Photos ###"@1000000044();
    BEGIN
    END;

    PROCEDURE ProcessTaskPhoto@1000000043(FileName@1000000000 : Text;FilePath@1000000001 : Text;VAR Rec@1000000002 : Record 5080);
    VAR
      FileMgt@1000000003 : Codeunit 419;
      TempBlob@1000000004 : TEMPORARY Record 99008535;
      LocTempAttachment@1000000005 : TEMPORARY Record 5062;
      LocFile@1000000006 : File;
    BEGIN
      FilePath := TEMPORARYPATH + COPYSTR(FilePath, 6); //This is Shit...

      TempBlob.RESET;
      TempBlob.DELETEALL();
      LocTempAttachment.RESET();
      LocTempAttachment.DELETEALL();

      FileMgt.BLOBImportFromServerFile(TempBlob, FilePath);

      LocTempAttachment.INIT;
      LocTempAttachment.Attachment := TempBlob.Blob;
      LocTempAttachment."File Extension" := COPYSTR(FileMgt.GetExtension(FileName),1,250);
      LocTempAttachment.INSERT(TRUE);

      CMGenMgt.SetAttachment(LocTempAttachment);
      CMGenMgt.CreateLogEntryPhoto(Rec,FileName);
      CMGenMgt.UnsetAttachment();

      FileMgt.DeleteServerFile(FilePath);
      MESSAGE(Text024);
    END;

    PROCEDURE AddAttachment@1000000042(VAR Rec@1000000000 : Record 5080;IsPicture@1000000008 : Boolean);
    VAR
      FileMgt@1000000001 : Codeunit 419;
      FilenameClient@1000000002 : Text;
      FilenameServer@1000000003 : Text;
      TempBlob@1000000004 : TEMPORARY Record 99008535;
      TempAttachment@1000000005 : TEMPORARY Record 5062;
      Filename@1000000006 : Text;
      FileExtension@1000000007 : Text;
      FileExtensionFilter@1000000009 : Text;
    BEGIN
      IF IsPicture THEN
        FileExtensionFilter := 'Pictures|*.jpg;*.jpeg;*.png;*.bmp;*.gif';

      IF CURRENTCLIENTTYPE = CLIENTTYPE::Windows THEN BEGIN
        FilenameClient := FileMgt.OpenFileDialog(Text023, '', FileExtensionFilter);
        FilenameServer := FileMgt.UploadFileSilent(FilenameClient);

        Filename := COPYSTR(FileMgt.GetFileName(FilenameClient), 1, 50);
        FileExtension := COPYSTR(FileMgt.GetExtension(FilenameClient), 1, 50);
      END
      ELSE BEGIN
         IF NOT UPLOAD(Text023, '', '', '', FilenameServer) THEN
           ERROR(Text026);

        Filename := COPYSTR(FileMgt.GetFileName(FilenameServer), 1, 50);
        FileExtension := COPYSTR(FileMgt.GetExtension(FilenameServer), 1, 50);
      END;

      FileMgt.BLOBImportFromServerFile(TempBlob, FilenameServer);

      TempAttachment.INIT;
      TempAttachment.Attachment := TempBlob.Blob;
      TempAttachment."File Extension" := FileExtension;
      TempAttachment.INSERT(TRUE);

      CMGenMgt.SetAttachment(TempAttachment);
      IF IsPicture THEN
        CMGenMgt.CreateLogEntryPhoto(Rec, Filename)
      ELSE
        CMGenMgt.CreateLogEntryAttachment(Rec, Filename);
      CMGenMgt.UnsetAttachment();

      FileMgt.DeleteServerFile(FilenameServer);
      IF IsPicture THEN
        MESSAGE(Text034)
      ELSE
        MESSAGE(Text025);
    END;

    PROCEDURE "###MISC TASK FUNCTIONS###"@1000000038();
    BEGIN
    END;

    LOCAL PROCEDURE AddFieldServiceTeam@1000000041(Task@1000000000 : Record 5080);
    VAR
      CMAddData@1000000001 : Record 70021;
      Workorder@1000000002 : Record 5092;
      Team@1000000003 : Record 5080;
    BEGIN
      IF (NOT Workorder.GET(Task."Opportunity No.")) THEN
        EXIT;

      IF Workorder."CM Object No." = '' THEN
        EXIT;

      CMAddData.SETRANGE(Objecttype, Workorder."CM Objecttype");
      CMAddData.SETRANGE(Type, CMAddData.Type::User);
      CMAddData.SETRANGE("Field Service", TRUE);
      CMAddData.SETRANGE(Key1, Workorder."CM Object No.");
      CMAddData.SETFILTER(Key2, '<>%1', Task."CM Assigned User ID");
      IF CMAddData.FIND('-') THEN BEGIN
        REPEAT
          Team.INIT;
          Team."No." := '';
          Team."CM Type" := Team."CM Type"::Task;
          Team."CM Subtype" := Team."CM Subtype"::Team;
          Team."CM Maintask No." := Task."No.";
          Team."CM Assigned User ID" := CMAddData.Key2;
          Team."Opportunity No." := Task."Opportunity No.";
          Team.INSERT(TRUE);
        UNTIL CMAddData.NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE AddObjectData@1000000027(VAR Rec@1000000000 : Record 5080);
    VAR
      Workorder@1000000002 : Record 5092;
    BEGIN
      IF NOT Workorder.GET(Rec."Opportunity No.") THEN
        EXIT;

      Rec."CM Objecttype" := Workorder."CM Objecttype";
      Rec."CM Object No." := Workorder."CM Object No.";
    END;

    PROCEDURE ValidateTeam@1000000032(VAR Rec@1000000000 : Record 5080);
    VAR
      Rec2@1000000001 : Record 5080;
    BEGIN
      IF (Rec."CM Subtype" <> Rec."CM Subtype"::Team) OR (Rec."CM Type" <> Rec."CM Type"::Task) THEN
        EXIT;

      Rec.TESTFIELD("CM Assigned User ID");

      //IF (Rec2.GET(Rec."CM Maintask No.")) AND (Rec."CM Assigned User ID" = Rec2."CM Assigned User ID") THEN
        //ERROR(STRSUBSTNO(Text017, Rec."CM Assigned User ID"));

      Rec2.RESET;
      Rec2.SETCURRENTKEY("CM Type","CM Maintask No.","CM Assigned User ID","CM Status");
      Rec2.SETRANGE("CM Type", Rec2."CM Type"::Task);
      Rec2.SETRANGE("CM Maintask No.", Rec."CM Maintask No.");
      Rec2.SETRANGE("CM Assigned User ID", Rec."CM Assigned User ID");
      Rec2.SETFILTER("No.", '<>%1', Rec."No.");
      IF Rec2.FINDFIRST() THEN
        ERROR(STRSUBSTNO(Text016, Rec."CM Assigned User ID"));
    END;

    PROCEDURE AddCommentUI@1000000036(VAR Rec@1000000000 : Record 5080;CopyFromEntryNo@1000000002 : Integer) : Integer;
    VAR
      Page@1000000001 : Page 70108;
      LocLogEntry@1000000005 : Record 5065;
      EntryNo@1000000006 : Integer;
      TempLogEntry@1000000003 : TEMPORARY Record 5065;
    BEGIN
      EntryNo := 0;

      IF (CopyFromEntryNo <> 0) AND (LocLogEntry.GET(CopyFromEntryNo)) THEN BEGIN
        Page.SetRec(LocLogEntry);
        Page.SetText(LocLogEntry."CM Comment");
      END;

      Page.LOOKUPMODE := TRUE;
      IF Page.RUNMODAL <> ACTION::LookupOK THEN
        ERROR(Text003);

      Page.GETRECORD(TempLogEntry);

      IF TempLogEntry."CM Comment" = '' THEN
        ERROR(Text008);

      LocLogEntry.GET(CMGenMgt.CreateLogEntryComment(Rec,TempLogEntry."CM Internal", TempLogEntry."CM Comment"));
      LocLogEntry."CM Issue" := TempLogEntry."CM Issue";
      LocLogEntry."CM Production Effect" := TempLogEntry."CM Production Effect";
      LocLogEntry.MODIFY(FALSE);

      EXIT(LocLogEntry."Entry No.");
    END;

    LOCAL PROCEDURE GetFieldserviceUser@1000000037(VAR Workorder@1000000000 : Record 5092) : Code[50];
    VAR
      CMAddData@1000000001 : Record 70021;
    BEGIN
      IF Workorder."CM Object No." = '' THEN
        EXIT('');

      CMAddData.SETRANGE(Objecttype, Workorder."CM Objecttype");
      CMAddData.SETRANGE(Type, CMAddData.Type::User);
      CMAddData.SETRANGE("Field Service", TRUE);
      CMAddData.SETRANGE(Key1, Workorder."CM Object No.");
      CMAddData.SETFILTER(Key2, '<>%1', '');
      IF CMAddData.FINDFIRST() THEN
        EXIT(CMAddData.Key2);

      EXIT('');
    END;

    PROCEDURE IsStatusOpen@1000000049(Rec@1000000000 : Record 5080) : Boolean;
    BEGIN
      EXIT(NOT IsStatusClosed(Rec));
    END;

    PROCEDURE IsStatusClosed@1000000048(Rec@1000000000 : Record 5080) : Boolean;
    BEGIN
      EXIT
      (Rec."CM Status" IN
      [
          Rec."CM Status"::"Done Positive",
          Rec."CM Status"::"Done Negative",
          Rec."CM Status"::Closed
      ]);
    END;

    PROCEDURE "###INTERACTION###"@1000000013();
    BEGIN
    END;

    PROCEDURE ImportFileInAttachment@1000000015(VAR Attachment@1000000000 : Record 5062) : Text;
    VAR
      TempBlob@1000000003 : Record 99008535;
      FileMgt@1000000002 : Codeunit 419;
      ImportedFileName@1000000001 : Text;
    BEGIN
      ImportedFileName := FileMgt.BLOBImport(TempBlob,ImportedFileName);

      IF ImportedFileName = '' THEN
        MESSAGE(Text007)
      ELSE BEGIN
        Attachment.INIT;
        Attachment.Attachment := TempBlob.Blob;
        Attachment."File Extension" := COPYSTR(FileMgt.GetExtension(ImportedFileName),1,250);
        Attachment.INSERT(TRUE);
      END;

      EXIT(ImportedFileName);

    END;

    PROCEDURE "###REQUEST###"@1000000019();
    BEGIN
    END;

    PROCEDURE NewRequestFromTask@1000000026(VAR Rec@1000000000 : Record 5080);
    VAR
      Request@1000000001 : Record 5080;
    BEGIN
      IF Rec."CM Type" <> Rec."CM Type"::Task THEN
        ERROR(Text008);

      Request.INIT;
      Request."CM From Task No." := Rec."No.";
      Request."Opportunity No." := Rec."Opportunity No.";

      NewRequestUI(Request);
    END;

    PROCEDURE NewRequestFromWorkorder@1000000022(VAR Rec@1000000000 : Record 5092);
    VAR
      Request@1000000001 : Record 5080;
    BEGIN
      IF NOT Rec."CM Is Workorder" THEN
        ERROR(Text008);

      Request.INIT;
      Request."Opportunity No." := Rec."No.";

      NewRequestUI(Request);
    END;

    PROCEDURE NewRequestFromAssetProject@1000000023(VAR Rec@1000000000 : Record 70020);
    VAR
      Request@1000000001 : Record 5080;
    BEGIN
      Request.INIT;
      Request."CM Objecttype" := Rec.Objecttype;
      Request."CM Object No." := Rec."No.";

      NewRequestUI(Request);
    END;

    LOCAL PROCEDURE NewRequestUI@1000000024(VAR Rec@1000000000 : Record 5080);
    VAR
      CardPage@1000000001 : Page 70120;
      Obj@1000000002 : Record 70020;
      ObjUser@1000000003 : Record 70021;
    BEGIN
      CardPage.LOOKUPMODE := TRUE;
      IF CardPage.RUNMODAL() <> ACTION::Yes THEN
        ERROR(Text006);

      Rec.Description := CardPage.GetDescription();
      Rec."CM Request Type" := CardPage.GetRequestType();
      Rec."CM Comment Text" := CardPage.GetCommentText();

      NewRequest(Rec);
    END;

    PROCEDURE NewGenRequest@1000000033(MainAssetNo@1000000000 : Code[20];AssetNo@1000000001 : Code[20];ProjectNo@1000000002 : Code[20];TempReqest@1000000003 : TEMPORARY Record 5080) : Boolean;
    VAR
      Obj@1000000004 : Record 70020;
      Rec@1000000005 : Record 5080;
    BEGIN
      //IF (MainAssetNo = '') AND (AssetNo = '') AND (ProjectNo = '') THEN
        //ERROR(Text018);

      IF TempReqest.Description = '' THEN
        ERROR(Text018);

      IF ProjectNo <> '' THEN
        Obj.GET(Obj.Objecttype::Project, ProjectNo)
      ELSE BEGIN
        IF AssetNo <> '' THEN
          Obj.GET(Obj.Objecttype::Asset, AssetNo)
        ELSE BEGIN
          IF MainAssetNo <> '' THEN
            Obj.GET(Obj.Objecttype::Asset, MainAssetNo)
        END;
      END;

      TempReqest."CM Objecttype" := Obj.Objecttype;
      TempReqest."CM Object No." := Obj."No.";
      Rec.TRANSFERFIELDS(TempReqest, FALSE);
      NewRequest(Rec);

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE NewRequest@1000000035(VAR Rec@1000000000 : Record 5080);
    VAR
      Obj@1000000002 : Record 70020;
      ObjUser@1000000003 : Record 70021;
    BEGIN
      Rec."CM Type" := Rec."CM Type"::Request;
      Rec."CM Scheduled Date" := WORKDATE;
      Rec."CM Scheduled Time" := TIME;
      Rec."No." := '';
      Rec.INSERT(TRUE);

      IF Obj.GET(Rec."CM Objecttype", Rec."CM Object No.") THEN BEGIN
        ObjUser.SETRANGE(Objecttype, Obj.Objecttype);
        ObjUser.SETRANGE(Type, ObjUser.Type::User);
        ObjUser.SETRANGE(Key1, Obj."No.");
        ObjUser.SETRANGE("Plant Manager", TRUE);
        IF ObjUser.FINDFIRST() THEN BEGIN
          Rec.VALIDATE("CM Assigned User ID", ObjUser.Key2);
          Rec.MODIFY(FALSE);
        END;
      END;

      MESSAGE(Text013, Rec."No.");
    END;

    PROCEDURE NewGenRequestUI@1000000034();
    VAR
      Page@1000000000 : Page 70124;
    BEGIN
      Page.LOOKUPMODE(TRUE);
      Page.RUNMODAL();
    END;

    PROCEDURE RequestsToWorkorders@1000000028(VAR Rec@1000000000 : Record 5080);
    VAR
      c@1000000001 : Integer;
      c2@1000000004 : Integer;
      OldObjecttype@1000000002 : Integer;
      OldObjectNo@1000000003 : Code[20];
      Obj@1000000005 : Record 70020;
      Workorder@1000000007 : Record 5092;
      Task@1000000006 : Record 5080;
    BEGIN
      Rec.SETCURRENTKEY("CM Type","CM Objecttype","CM Object No."); //Important

      c := 0;
      OldObjectNo := '';
      OldObjecttype := -1;
      IF Rec.FIND('-') THEN BEGIN
        REPEAT
          //IF (Rec."CM Object No." = '') THEN
            //ERROR(STRSUBSTNO(Text011, Rec."No."));

          IF Rec."CM Status" <> Rec."CM Status"::Open THEN
            ERROR(Text010);

          IF (OldObjectNo <> Rec."CM Object No.") OR (OldObjecttype <> Rec."CM Objecttype") THEN
            c += 1;

          OldObjectNo := Rec."CM Object No.";
          OldObjecttype := Rec."CM Objecttype";
        UNTIL Rec.NEXT = 0;
      END;

      IF c < 1 THEN
        ERROR(Text014);
      IF c > 1 THEN
        ERROR(Text012);

      IF NOT CONFIRM(STRSUBSTNO(Text009, Rec.COUNT)) THEN
        ERROR(Text006);

      //Create WO
      c := 0;
      OldObjectNo := '';
      OldObjecttype := -1;
      IF Rec.FIND('-') THEN BEGIN
        IF Obj.GET(Rec."CM Objecttype", Rec."CM Object No.") THEN
          Workorder.GET(CMWoMgt.NewWorkorderToObjectUI(Obj, TRUE))
        ELSE
          Workorder.GET(CMWoMgt.NewWorkorderUI());
        Workorder."CM Source" := Workorder."CM Source"::Request;
        Workorder."CM Source Description" := Rec."No.";
        Workorder.MODIFY(FALSE);

        REPEAT
          Task.INIT;
          Task.TRANSFERFIELDS(Rec, FALSE);
          Task."Opportunity No." := Workorder."No.";
          Task."No." := '';
          Task."CM Type" := Task."CM Type"::Task;
          Task."CM Is Temporary" := FALSE;
          Task."CM Assigned User ID" := Workorder."CM Assigned User ID";
          Task."CM Creation Type" := Task."CM Creation Type"::Request;
          Task.INSERT(TRUE);

          Rec."CM Status" := Rec."CM Status"::"Done Positive";
          Rec."CM Transf. to Task No." := Task."No.";
          Rec."CM Transf. to Workorder No." := Workorder."No.";
          Rec.MODIFY(FALSE);

        UNTIL Rec.NEXT = 0;

        //MESSAGE('OK - ' + Workorder."No.");
      END;
    END;

    PROCEDURE RejectRequest@1000000004(VAR Rec@1000000000 : Record 5080);
    VAR
      c@1000000001 : Integer;
    BEGIN
      IF Rec.COUNT <= 0 THEN
        ERROR(Text014);

      IF NOT CONFIRM(STRSUBSTNO(Text015, Rec.COUNT)) THEN
        ERROR(Text006);

      IF Rec.FIND('-') THEN BEGIN
        REPEAT
          Rec."CM Status" := Rec."CM Status"::"Done Negative";
          Rec.MODIFY(FALSE);
        UNTIL Rec.NEXT = 0;
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70032 CMMS Offline App Mgmt. v1
{
  OBJECT-PROPERTIES
  {
    Date=15.05.18;
    Time=12:15:04;
    Modified=Yes;
    Version List=CMMS,OSR;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Task Attachment with Identifier "%1" not found.';

    LOCAL PROCEDURE GetVersion@1000000005() VERSION : Integer;
    BEGIN
      //### Version ###
      VERSION := 1;
    END;

    LOCAL PROCEDURE GetVersionStatus@1000000009() VERSIONSTATUS : Text;
    VAR
      LocVersionStatus@1000000000 : 'Test,Current,Deprecated,Unsupported';
    BEGIN
      //### Version Statzs ###
      VERSIONSTATUS := FORMAT(LocVersionStatus::Test);
    END;

    PROCEDURE GetVersionMetadata@1000000004(VAR Version@1000000000 : Integer;VAR VersionStatus@1000000001 : Text);
    BEGIN
      Version := GetVersion();
      VersionStatus := GetVersionStatus();
    END;

    PROCEDURE CheckLogin@1000000002();
    BEGIN
    END;

    PROCEDURE GetWorkorders@1000000000(VAR Data@1000000001 : XMLport 50012);
    BEGIN
      Data.EXPORT();
    END;

    PROCEDURE SetWorkorders@1000000001(VAR Data@1000000000 : XMLport 50012) : Boolean;
    VAR
      ImportedWorkorders@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.Generic.List`1";
    BEGIN
      //Import
      Data.IMPORT();
      Data.GetData(ImportedWorkorders);

      //Export
      Data.SetData(TRUE, ImportedWorkorders);
      Data.EXPORT();
      EXIT(TRUE);
    END;

    PROCEDURE SetAttachmentData@1000000003(Data@1000000000 : XMLport 50013) : Boolean;
    BEGIN
      Data.IMPORT();
      EXIT(TRUE)
    END;

    PROCEDURE DeleteAttachment@1000000006(Id@1000000000 : Integer);
    BEGIN
      LocDeleteAttachment(Id, 0);
    END;

    PROCEDURE DeleteAndReplaceAttachment@1000000008(Id@1000000000 : Integer;ReplacedWithId@1000000001 : Integer);
    BEGIN
      LocDeleteAttachment(Id, ReplacedWithId);
    END;

    LOCAL PROCEDURE LocDeleteAttachment@1000000007(Id@1000000000 : Integer;ReplacedWithId@1000000001 : Integer);
    VAR
      CMLogEntry@1000000002 : Record 5065;
      CMLogEntry2@1000000003 : Record 5065;
    BEGIN
      IF (NOT CMLogEntry.GET(Id)) OR
         (NOT(CMLogEntry."CM Log Type" IN [CMLogEntry."CM Log Type"::Attachment, CMLogEntry."CM Log Type"::Picture])) THEN
        ERROR(Text001, Id);

      IF CMLogEntry."CM Deleted" THEN
        EXIT;

      //Replace
      IF (ReplacedWithId > 0)  THEN BEGIN
        IF CMLogEntry2.GET(ReplacedWithId) THEN
          CMLogEntry."CM Related Entry No." := CMLogEntry2."Entry No.";
      END;

      CMLogEntry."CM Deleted" := TRUE;
      CMLogEntry."CM Deleted By User ID" := USERID;
      CMLogEntry."CM Deleted Date" := TODAY;
      CMLogEntry."CM Deleted Time" := TIME;
      CMLogEntry.MODIFY(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70037 CMMS Publisher
{
  OBJECT-PROPERTIES
  {
    Date=04.05.18;
    Time=18:43:05;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [Business]
    PROCEDURE OnAfterChangeWorkorderAssignedUserID@1000000042(VAR Rec@1000000001 : Record 5092;OldUid@1000000000 : Code[50];NewUid@1000000002 : Code[50]);
    BEGIN
    END;

    [Business]
    PROCEDURE OnAfterChangeWorkorderStatus@1000000001(VAR Rec@1000000001 : Record 5092;OldStatus@1000000000 : Integer;NewStatus@1000000002 : Integer);
    BEGIN
    END;

    [Business]
    PROCEDURE OnAfterChangeTaskAssignedUserID@1000000003(VAR Rec@1000000001 : Record 5080;OldUid@1000000000 : Code[50];NewUid@1000000002 : Code[50]);
    BEGIN
    END;

    [Business]
    PROCEDURE OnAfterChangeTaskStatus@1000000002(VAR Rec@1000000001 : Record 5080;OldStatus@1000000000 : Integer;NewStatus@1000000002 : Integer);
    BEGIN
    END;

    [Business]
    PROCEDURE OnAfterInsertWorkorder@1000000000(VAR Rec@1000000001 : Record 5092);
    BEGIN
    END;

    [Business]
    PROCEDURE OnAfterInsertTask@1000000004(VAR Rec@1000000001 : Record 5080);
    BEGIN
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70038 CMMS Subscriber
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=09:44:50;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {

    [EventSubscriber(Table,1511,OnBeforeInsertEvent)]
    LOCAL PROCEDURE SetCMNotificationInfos@1000000000(VAR Rec@1000000000 : Record 1511;RunTrigger@1000000001 : Boolean);
    BEGIN
      Rec."CM Type Text" := FORMAT(Rec."CM Type");
      Rec."CM To Connector Text" := FORMAT(Rec."CM To Connector");
    END;

    [EventSubscriber(Codeunit,70037,OnAfterChangeWorkorderAssignedUserID)]
    LOCAL PROCEDURE OnAfterChangeWorkorderAssignedUserID@1000000008(VAR Rec@1000000000 : Record 5092;OldUid@1000000001 : Code[50];NewUid@1000000002 : Code[50]);
    VAR
      CMGenMgt@1000000003 : Codeunit 70000;
    BEGIN
      CMGenMgt.CheckNotification2(Rec, 0, '', 0);
    END;

    [EventSubscriber(Codeunit,70037,OnAfterChangeWorkorderStatus)]
    LOCAL PROCEDURE OnAfterChangeWorkorderStatus@1000000009(VAR Rec@1000000000 : Record 5092;OldStatus@1000000001 : Integer;NewStatus@1000000002 : Integer);
    VAR
      CMGenMgt@1000000003 : Codeunit 70000;
    BEGIN
      CMGenMgt.CheckNotification3(Rec, 0,  '', 0);
    END;

    [EventSubscriber(Codeunit,70037,OnAfterChangeTaskAssignedUserID)]
    LOCAL PROCEDURE OnAfterChangeTaskAssignedUserID@1000000010(VAR Rec@1000000000 : Record 5080;OldUid@1000000001 : Code[50];NewUid@1000000002 : Code[50]);
    VAR
      CMGenMgt@1000000003 : Codeunit 70000;
      Wo@1000000004 : Record 5092;
    BEGIN
      IF NOT Wo.GET(Rec."Opportunity No.") THEN Wo.INIT;
      IF (Rec."CM Type" <> Rec."CM Type"::Task)  OR (Rec."CM Subtype" <> Rec."CM Subtype"::" ")THEN
        EXIT;

      CMGenMgt.CheckNotification5(Wo, Rec, 0, '', 0);
    END;

    [EventSubscriber(Codeunit,70037,OnAfterChangeTaskStatus)]
    LOCAL PROCEDURE OnAfterChangeTaskStatus@1000000013(VAR Rec@1000000000 : Record 5080;OldStatus@1000000001 : Integer;NewStatus@1000000002 : Integer);
    VAR
      CMGenMgt@1000000003 : Codeunit 70000;
      Wo@1000000004 : Record 5092;
    BEGIN
      IF NOT Wo.GET(Rec."Opportunity No.") THEN Wo.INIT;
      IF (Rec."CM Type" <> Rec."CM Type"::Task) OR (Rec."CM Subtype" <> Rec."CM Subtype"::" ") THEN
        EXIT;

      CMGenMgt.CheckNotification6(Wo, Rec, 0, '', 0);
    END;

    [EventSubscriber(Codeunit,70037,OnAfterInsertWorkorder)]
    LOCAL PROCEDURE OnAfterChangeInsertWorkorder@1000000001(VAR Rec@1000000000 : Record 5092);
    VAR
      CMGenMgt@1000000003 : Codeunit 70000;
    BEGIN
      CMGenMgt.CheckNotification1(Rec, 0, '', 0);
    END;

    [EventSubscriber(Codeunit,70037,OnAfterInsertTask)]
    LOCAL PROCEDURE OnAfterChangeInsertTask@1000000002(VAR Rec@1000000000 : Record 5080);
    VAR
      CMGenMgt@1000000003 : Codeunit 70000;
      Wo@1000000004 : Record 5092;
    BEGIN
      IF NOT Wo.GET(Rec."Opportunity No.") THEN Wo.INIT;
      CMGenMgt.CheckNotification4(Wo, Rec, 0, '', 0);
      CMGenMgt.CheckNotification5(Wo, Rec, 0, '', 0);
    END;

    [EventSubscriber(Codeunit,415,OnAfterReleasePurchaseDoc)]
    LOCAL PROCEDURE OnAfterReleasePurchDokument@1000000003(VAR PurchaseHeader@1000000000 : Record 38);
    VAR
      CMGenMgt@1000000001 : Codeunit 70000;
    BEGIN
      CMGenMgt.SetReleasedProcessingStatus(PurchaseHeader);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 70040 CMMS Timetracking Management
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=17:50:34;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    OnRun=VAR
            cma@1000000000 : Record 70020;
          BEGIN
          END;

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Only one of the fields "%1", "%2", "%3" or "%4" can be filled.;DEA=Es darf nur eines der Felder "%1", "%2", "%3" oder "%4" befllt werden.';
      Text002@1000000001 : TextConst 'ENU=Either "%1", "%2", "%3", "%4" or "%5" must be provided!;DEA=Es muss entweder "%1", "%2", "%3", "%4"  oder "%5" angegeben werden!';
      Text003@1000000002 : TextConst 'ENU=Invalid Asset "%1";DEA=Ungltige Anlage "%1"';
      Text004@1000000003 : TextConst 'ENU=Max. %1 hours per day allowed!;DEA=Max. %1 Stunden pro Tag erlaubt!';
      Text005@1000000004 : TextConst 'ENU=%1 Lines posted.;DEA=%1 Zeilen wurden gebucht.';
      Text006@1000000005 : TextConst 'ENU=Time Tracking entry posted.;DEA=Zeiterfassungseintrag gebucht.';
      Text007@1000000006 : TextConst 'ENU=Date must not be empty!;DEA=Datum muss ausgefllt werden!';
      Text008@1000000007 : TextConst 'ENU=The provided date date is not withing the allowed Posting Period!;DEA=Das eingegebene Datum liegt auáerhalb der erlaubten Buchungs Periode!';
      Text009@1000000008 : TextConst 'ENU=Either "%1", "%2", "%3" or "%4" must be provided!;DEA=Es muss entweder "%1", "%2", "%3" oder "%4" angegeben werden!';
      Text010@1000000009 : TextConst 'ENU=You cannot enter "%1" and "%2"!;DEA=Sie k”nnen nicht "%1" und "%2" eingeben!';
      Text011@1000000010 : TextConst 'ENU=Invalid Procedure!;DEA=Ungltiger Vorgang!';
      Text012@1000000011 : TextConst 'ENU=This Entry is already part of a Reversal!;DEA=Dieser Eintrag ist bereits Teil einer Stornierung!';
      Text013@1000000013 : TextConst 'ENU=Entry successfully reversed.;DEA=Eintrag erfolgreich storniert.';
      Text014@1000000014 : TextConst 'ENU=Invalid Project "%1";DEA=Ungltiges Projekt "%1"';
      Text015@1000000015 : TextConst 'ENU=Description must be provided! (Min. %1 characters).;DEA=Beschreibung muss angegeben werden! (Min. %1 Zeichen).';
      Text016@1000000016 : TextConst 'ENU=Not Allowed!;DEA=Keine Berechtigung';
      Text017@1000000017 : TextConst 'ENU=Please provide either Asset / Project or Cost Center!;DEA=Geben sie entweder Anlage bzw. Projekt oder Kostenstelle an!';
      Text018@1000000018 : TextConst 'ENU=Please enter at least %1 hours!;DEA=Geben sie mind. %1 Stunden ein!';
      Text019@1000000019 : TextConst 'ENU=Invalid Time;DEA=Ungltige Zeitangabe';
      Text020@1000000020 : TextConst 'ENU=Invalid call!;DEA=Ungltiger Aufruf!';
      Text021@1000000021 : TextConst 'ENU=%1 is inactive. No Time Posting allowed!;DEA=%1 ist inaktiv und darf nicht bebucht weden!';
      Text022@1000000022 : TextConst 'ENU=Lines successfully posted!;DEA=Zeilen erfolgreich gebucht!';
      _OsrFlag@1000000023 : Boolean;
      Text023@1000000012 : TextConst 'ENU=Time Tracking Entry cannot be created for Workorder "%1" - Task "%2". Dimension for Asset "%3" has been blocked in CMMS.';
      Text024@1000000024 : TextConst 'ENU=Time Tracking Entry cannot be created for Workorder "%1" - Task "%2". Dimension for Project "%3" has been blocked in CMMS.';

    LOCAL PROCEDURE "###VALIDATION"@1000000013();
    BEGIN
    END;

    PROCEDURE OnBeforeInsert@1000000002(VAR Rec@1000000000 : Record 952);
    VAR
      CT@1000000001 : ClientType;
    BEGIN
      IF NOT Rec."CM Is CMMS Timesheet" THEN
        EXIT;

      IF Rec."Time Sheet Line No." <= 0 THEN
        Rec."Time Sheet Line No." := GetNextLineNo();

      TestDate(Rec);
      TestRefNo(Rec);
      TestQuantity(Rec);
      TestDescription(Rec);
      TestDim(Rec,1);
      TestBlocked(Rec);

      AddAssignedUser(Rec);
      AddDefaultUoM(Rec);

      Rec."Time Sheet No." := '';
      Rec.Date := 0D;

      IF Rec."CM Posted Datetime" = 0DT THEN
        Rec."CM Posted Datetime" := CURRENTDATETIME;

      IF Rec."CM User ID" = '' THEN
        Rec."CM User ID" := USERID;

      Rec."CM Posted By User ID" := USERID;
      Rec.Posted := TRUE;
      Rec."CM Clienttype" := FORMAT(CURRENTCLIENTTYPE);

      AddDefaultDim(Rec);
      CalcDimSetID(Rec);
    END;

    PROCEDURE TestRefNo@1000000001(VAR Rec@1000000000 : Record 952);
    BEGIN
      IF _OsrFlag THEN
        EXIT;

      IF (Rec."CM Main Asset No." = '') AND (Rec."CM Asset No." = '') AND (Rec."CM Project No." = '') AND (Rec."CM Dimension Value 3" = '') THEN
        ERROR(STRSUBSTNO(Text009,Rec.FIELDCAPTION("CM Main Asset No."), Rec.FIELDCAPTION("CM Asset No."), Rec.FIELDCAPTION("CM Project No."), Rec.FIELDCAPTION("CM Dimension Value 3")));
    END;

    PROCEDURE TestDate@1000000012(VAR Rec@1000000000 : Record 952);
    VAR
      CMGenSetup@1000000001 : Record 70000;
    BEGIN
      //Disable Checking in OSR App
      IF _OsrFlag THEN
        EXIT;

      IF Rec."CM Entry Date" = 0D THEN
        ERROR(Text007);

      CMGenSetup.GET();

      IF (FORMAT(CMGenSetup."Posting Allowed to (Past)") <> ' ') AND
         (Rec."CM Entry Date" < CALCDATE(CMGenSetup."Posting Allowed to (Past)")) THEN
        ERROR(Text008);

      IF (FORMAT(CMGenSetup."Posting Allowed to (Past)") <> ' ') AND
         (Rec."CM Entry Date" > CALCDATE(CMGenSetup."Posting Allowed to (Future)")) THEN
        ERROR(Text008);
    END;

    PROCEDURE TestQuantity@1000000009(VAR Rec@1000000000 : Record 952);
    VAR
      CMGenSetup@1000000001 : Record 70000;
    BEGIN
      CMGenSetup.GET();

      IF Rec."CM Quantity" <= 0 THEN
        ERROR(Text019);

      IF (Rec."CM Quantity" <= CMGenSetup."Rounding Precision") THEN
        Rec."CM Quantity" := CMGenSetup."Rounding Precision";

      IF CMGenSetup."Rounding Precision" > 0 THEN
        Rec."CM Quantity" := ROUND(Rec."CM Quantity", CMGenSetup."Rounding Precision",'=');

      //Disable Checking in OSR App
      IF NOT _OsrFlag THEN BEGIN
        IF ((Rec."CM Quantity" + PostedHours(USERID, FORMAT(Rec."CM Entry Date"))) > CMGenSetup."Max. Posting per Day") THEN
          ERROR(STRSUBSTNO(Text004, CMGenSetup."Max. Posting per Day"));
      END;
    END;

    PROCEDURE TestDescription@1000000015(VAR Rec@1000000000 : Record 952);
    VAR
      CMGenSetup@1000000001 : Record 70000;
    BEGIN
      IF NOT CMGenSetup.GET THEN
        CMGenSetup.INIT;

      IF (Rec."CM Task No." = '') AND (Rec."CM Workorder No." = '') THEN BEGIN //If Workorder or Task is provided, we dont neet Description
        IF STRLEN(Rec."CM Description") < CMGenSetup."Posting Descr. Min. Length" THEN
          ERROR(STRSUBSTNO(Text015, CMGenSetup."Posting Descr. Min. Length"));
      END;
    END;

    PROCEDURE TestDim@1000000023(VAR Rec@1000000000 : Record 952;Action@1000000001 : 'Return,Error,Message') : Boolean;
    VAR
      ok@1000000002 : Boolean;
    BEGIN
      //Disable Checking in OSR App
      IF _OsrFlag THEN
        EXIT(TRUE);

      ok :=  NOT ( ((Rec."CM Main Asset No." <> '') OR (Rec."CM Asset No." <> '') OR (Rec."CM Project No." <> '')) AND ((Rec."CM Dimension Value 3" <> '') OR (Rec."CM Dimension Value 4" <> '')) );

      IF (NOT ok) AND (Action = Action::Error) THEN
        ERROR(Text017);
      IF (NOT ok) AND (Action = Action::Message) THEN
        MESSAGE(Text017);

      EXIT(ok);
    END;

    LOCAL PROCEDURE TestBlocked@1000000030(VAR Rec@1000000000 : Record 952);
    VAR
      CMObject@1000000001 : Record 70020;
    BEGIN
      //Disable Checking in OSR App
      IF _OsrFlag THEN
        EXIT;

      IF (Rec."CM Workorder No." = '') AND (Rec."CM Task No." = '') THEN BEGIN
        IF (Rec."CM Main Asset No." <> '') AND (CMObject.GET(CMObject.Objecttype::Asset, Rec."CM Main Asset No.")) AND (CMObject."Operational Status" = CMObject."Operational Status"::Inactive) AND
           ((Rec."CM Asset No." = '') AND (Rec."CM Project No." = ''))THEN
          ERROR(STRSUBSTNO(Text021, Rec."CM Main Asset No."));

        IF (Rec."CM Asset No." <> '') AND (CMObject.GET(CMObject.Objecttype::Asset, Rec."CM Asset No.")) AND (CMObject."Operational Status" = CMObject."Operational Status"::Inactive) AND
           (Rec."CM Project No." = '') THEN
        ERROR(STRSUBSTNO(Text021, Rec."CM Asset No."));

        IF (Rec."CM Project No." <> '') AND (CMObject.GET(CMObject.Objecttype::Project, Rec."CM Project No.")) AND (CMObject."Operational Status" = CMObject."Operational Status"::Inactive) THEN
          ERROR(STRSUBSTNO(Text021, Rec."CM Project No."));
      END;
    END;

    PROCEDURE "###POSTING-FUNCTIONS"@1000000028();
    BEGIN
    END;

    PROCEDURE PostSheet@1000000007(VAR Rec@1000000000 : Record 952);
    VAR
      TempRec@1000000001 : TEMPORARY Record 952;
      TempRec2@1000000003 : TEMPORARY Record 952;
    BEGIN
      TempRec.RESET();
      TempRec.DELETEALL();
      Rec.LOCKTABLE(TRUE);

      //Create Temp Recs
      IF Rec.FIND('-') THEN BEGIN
        REPEAT
          TempRec.INIT;
          TempRec.TRANSFERFIELDS(Rec, TRUE);
          TempRec.INSERT(FALSE);
        UNTIL Rec.NEXT = 0;
      END;

      //Delete the unposted records
      Rec.DELETEALL();

      //Post records
      IF TempRec.FIND('-') THEN BEGIN
        REPEAT
          TempRec2.INIT;
          TempRec2.TRANSFERFIELDS(TempRec, TRUE);

          TempRec2."Time Sheet Line No." := 0; //Dont modify the PK of the loop record...
          TempRec2."CM Is CMMS Timesheet" := TRUE;
          PostLine(TempRec2, FALSE, TRUE);
        UNTIL TempRec.NEXT = 0;
      END;

      MESSAGE(Text022);
    END;

    PROCEDURE PostLine@1000000010(VAR TempRec@1000000000 : TEMPORARY Record 952;DoInit@1000000003 : Boolean;NoMessage@1000000007 : Boolean) : Integer;
    VAR
      CMTimesheet@1000000001 : Record 952;
      Asset@1000000002 : Record 70020;
      Project@1000000004 : Record 70020;
      Text1@1000000005 : Text;
      Text2@1000000006 : Text;
    BEGIN
      IF NOT Asset.GET(Asset.Objecttype::Asset, TempRec."CM Asset No.") THEN
        Asset.INIT;

      IF NOT Project.GET(Asset.Objecttype::Project, TempRec."CM Project No.") THEN
        Project.INIT;

      CMTimesheet.RESET;
      CMTimesheet.INIT;
      CMTimesheet.TRANSFERFIELDS(TempRec, TRUE);
      CMTimesheet."Time Sheet No." := '';
      CMTimesheet."Time Sheet Line No." := 0;
      CMTimesheet."CM Is CMMS Timesheet" := TRUE;

      AddText(Text1, Asset."Country Code");
      AddText(Text1, Asset."No.");
      AddText(Text1, Asset.Name);
      AddText(Text1, Asset."Name 2");
      CMTimesheet."CM Text 1" := COPYSTR(Text1, 1, 250);

      AddText(Text2, Project."Country Code");
      AddText(Text2, Project."No.");
      AddText(Text2, Project.Name);
      AddText(Text2, Project."Name 2");
      CMTimesheet."CM Text 2" := COPYSTR(Text2, 1, 250);

      OnBeforeInsert(CMTimesheet);
      CMTimesheet.INSERT(TRUE);

      IF DoInit THEN
        InitRec(TempRec,TRUE);

      IF NOT NoMessage THEN
        MESSAGE(Text006);

      EXIT(CMTimesheet."Time Sheet Line No.");
    END;

    PROCEDURE PostFromTask@1000000029(VAR Task@1000000000 : Record 5080;Amount@1000000001 : Decimal;EntryDate@1000000005 : Date;PostedDatetime@1000000006 : DateTime) : Integer;
    VAR
      TempRec@1000000002 : TEMPORARY Record 952;
      CMObject@1000000003 : Record 70020;
      CMWorkorder@1000000004 : Record 5092;
    BEGIN
      IF Task."CM Type" <> Task."CM Type"::Task THEN
        ERROR(Text020);

      IF NOT CMObject.GET(Task."CM Objecttype", Task."CM Object No.") THEN
        CMObject.INIT;

      IF NOT CMWorkorder.GET(Task."Opportunity No.") THEN
        CMWorkorder.INIT;

      TempRec.RESET;
      TempRec.INIT;
      TempRec."CM Entry Date" := TODAY;
      TempRec."CM Posted Datetime" := CURRENTDATETIME;
      IF EntryDate <> 0D THEN
        TempRec."CM Entry Date" := EntryDate;
      IF PostedDatetime <> 0DT THEN
        TempRec."CM Posted Datetime" := PostedDatetime;

      IF (CMObject."Asset Type" = CMObject."Asset Type"::"Main Asset") AND
         (CMObject.Objecttype = CMObject.Objecttype::Asset) THEN
        TempRec."CM Main Asset No." := CMObject."No.";

      IF (CMObject."Asset Type" <> CMObject."Asset Type"::"Main Asset") AND
         (CMObject.Objecttype = CMObject.Objecttype::Asset) THEN
        TempRec."CM Asset No." := CMObject."No.";

      IF (CMObject.Objecttype = CMObject.Objecttype::Project) THEN
        TempRec."CM Project No." := CMObject."No.";

      TempRec."CM Workorder No." := CMWorkorder."No.";
      TempRec."CM Task No." := Task."No.";
      TempRec."CM Description" := Task.Description;
      TempRec."CM Quantity" := Amount;
      TempRec."CM Clienttype" := FORMAT(CURRENTCLIENTTYPE);
      TempRec."CM User ID" := USERID;

      EXIT(PostLine(TempRec, FALSE, FALSE));
    END;

    PROCEDURE "###FUNCTIONS"@1000000016();
    BEGIN
    END;

    LOCAL PROCEDURE AddAssignedUser@1000000005(VAR Rec@1000000000 : Record 952);
    VAR
      Workorder@1000000002 : Record 5092;
      Task@1000000001 : Record 5080;
    BEGIN
      Rec."CM Assigned User ID" := '';

      IF Rec."CM Workorder No." <> '' THEN BEGIN
        IF (Workorder.GET(Rec."CM Workorder No.")) AND (Workorder."CM Is Workorder") THEN
          Rec."CM Assigned User ID" := Workorder."CM Assigned User ID";
      END;

      IF Rec."CM Task No." <> '' THEN BEGIN
        IF (Task.GET(Rec."CM Task No.")) AND (Task."CM Type" <> Task."CM Type"::Task) THEN
          Rec."CM Assigned User ID" := Task."CM Assigned User ID";
      END;
    END;

    PROCEDURE AddDefaultUoM@1000000008(VAR Rec@1000000000 : Record 952);
    VAR
      CMGenSetup@1000000001 : Record 70000;
    BEGIN
      CMGenSetup.GET();

      IF Rec."CM UoM Code" = '' THEN
        Rec."CM UoM Code" := CMGenSetup."Default UoM Code";
    END;

    LOCAL PROCEDURE CalcDimSetID@1000000021(VAR Rec@1000000000 : Record 952);
    VAR
      TempDimSetEntry@1000000001 : TEMPORARY Record 480;
      DimMgt@1000000002 : Codeunit 408;
    BEGIN
      TempDimSetEntry.RESET();
      TempDimSetEntry.DELETEALL();
      IF (Rec."CM Dimension Code 1" <> '') AND (Rec."CM Dimension Value 1" <> '') THEN BEGIN
        TempDimSetEntry.INIT;
        TempDimSetEntry."Dimension Set ID" := 0;
        TempDimSetEntry.VALIDATE("Dimension Code", Rec."CM Dimension Code 1");
        TempDimSetEntry.VALIDATE("Dimension Value Code", Rec."CM Dimension Value 1");
        TempDimSetEntry.INSERT();
      END;

      IF (Rec."CM Dimension Code 2" <> '') AND (Rec."CM Dimension Value 2" <> '') THEN BEGIN
        TempDimSetEntry.INIT;
        TempDimSetEntry."Dimension Set ID" := 0;
        TempDimSetEntry.VALIDATE("Dimension Code", Rec."CM Dimension Code 2");
        TempDimSetEntry.VALIDATE("Dimension Value Code", Rec."CM Dimension Value 2");
        TempDimSetEntry.INSERT();
      END;

      IF (Rec."CM Dimension Code 3" <> '') AND (Rec."CM Dimension Value 3" <> '') THEN BEGIN
        TempDimSetEntry.INIT;
        TempDimSetEntry."Dimension Set ID" := 0;
        TempDimSetEntry.VALIDATE("Dimension Code", Rec."CM Dimension Code 3");
        TempDimSetEntry.VALIDATE("Dimension Value Code", Rec."CM Dimension Value 3");
        TempDimSetEntry.INSERT();
      END;

      IF (Rec."CM Dimension Code 4" <> '') AND (Rec."CM Dimension Value 4" <> '') THEN BEGIN
        TempDimSetEntry.INIT;
        TempDimSetEntry."Dimension Set ID" := 0;
        TempDimSetEntry.VALIDATE("Dimension Code", Rec."CM Dimension Code 4");
        TempDimSetEntry.VALIDATE("Dimension Value Code", Rec."CM Dimension Value 4");
        TempDimSetEntry.INSERT();
      END;

      Rec."CM Dimension Set ID" := DimMgt.GetDimensionSetID(TempDimSetEntry);
    END;

    LOCAL PROCEDURE AddDefaultDim@1000000022(VAR Rec@1000000000 : Record 952);
    VAR
      CMGenSetup@1000000001 : Record 70000;
    BEGIN
      IF NOT CMGenSetup.GET THEN
        CMGenSetup.INIT;

      Rec."CM Dimension Code 1" := CMGenSetup."Dimension 1";
      Rec."CM Dimension Code 2" := CMGenSetup."Dimension 2";
      IF Rec."CM Asset No." <> '' THEN
        Rec."CM Dimension Value 1" := Rec."CM Asset No."
      ELSE
        Rec."CM Dimension Value 1" := Rec."CM Main Asset No.";
      Rec."CM Dimension Value 2" := Rec."CM Project No.";
    END;

    LOCAL PROCEDURE AddText@1000000025(VAR ExistingText@1000000001 : Text;NewText@1000000000 : Text);
    BEGIN
      IF NewText = '' THEN
        EXIT;

      IF ExistingText = '' THEN
        ExistingText := NewText
      ELSE
        ExistingText += ' - ' + NewText;
    END;

    PROCEDURE GetNextLineNo@1000000006() : Integer;
    VAR
      CMTimeSheet@1000000000 : Record 952;
    BEGIN
      CMTimeSheet.RESET;
      CMTimeSheet.SETCURRENTKEY("CM Is CMMS Timesheet","Time Sheet No.","Time Sheet Line No.");
      CMTimeSheet.SETRANGE("CM Is CMMS Timesheet", TRUE);
      CMTimeSheet.SETRANGE("Time Sheet No.", '');
      IF CMTimeSheet.FINDLAST() THEN
        EXIT(CMTimeSheet."Time Sheet Line No." + 1);
      EXIT(1);
    END;

    PROCEDURE InitRec@1000000011(VAR Rec@1000000000 : TEMPORARY Record 952;DoInsert@1000000001 : Boolean);
    VAR
      CMGenSetup@1000000002 : Record 70000;
    BEGIN
      IF NOT CMGenSetup.GET() THEN
        CMGenSetup.INIT();

      Rec.RESET;
      Rec.DELETEALL;

      Rec.INIT; //Reset Rec
      Rec."Time Sheet No." := '';
      Rec."Time Sheet Line No." := 1;
      Rec.Date := 0D;
      Rec."CM Entry Date" := WORKDATE;
      Rec."CM Is CMMS Timesheet" := TRUE;
      Rec."CM Dimension Code 1" := CMGenSetup."Dimension 1";
      Rec."CM Dimension Code 2" := CMGenSetup."Dimension 2";
      Rec."CM Dimension Code 3" := CMGenSetup."Dimension 3";
      Rec."CM Dimension Code 4" := CMGenSetup."Dimension 4";
      Rec."CM Dimension Set ID" := 0;
      IF DoInsert THEN
        IF NOT Rec.INSERT(FALSE) THEN
          ;

      Rec.FINDFIRST();
      Rec.SETRECFILTER();
    END;

    PROCEDURE ReverseLine@1000000014(VAR Rec@1000000000 : Record 952);
    VAR
      LineNo@1000000001 : Integer;
      RevEntry@1000000002 : Record 952;
    BEGIN
      IF NOT ReverseAllowed() THEN
        ERROR(Text016);

      IF NOT Rec."CM Is CMMS Timesheet" THEN
        ERROR(Text011);

      IF Rec."CM Reverse Line No." > 0 THEN
        ERROR(Text012);

      RevEntry.RESET;
      RevEntry.INIT;
      RevEntry.TRANSFERFIELDS(Rec, TRUE);
      LineNo := GetNextLineNo();

      RevEntry."Time Sheet Line No." := LineNo;
      RevEntry.INSERT(FALSE);
      RevEntry."CM Is CMMS Timesheet" := TRUE;
      RevEntry."CM Reverse Line No." := Rec."Time Sheet Line No.";
      RevEntry."CM Quantity" := (RevEntry."CM Quantity") * (-1);
      RevEntry."CM Clienttype" := FORMAT(CURRENTCLIENTTYPE);
      RevEntry."CM User ID" := USERID;
      RevEntry."CM Posted Datetime" := CURRENTDATETIME;
      RevEntry.MODIFY(FALSE);

      Rec."CM Reverse Line No." := LineNo;
      Rec.MODIFY(FALSE);

      MESSAGE(Text013);
    END;

    PROCEDURE GetDimCaption@1000000017(DimID@1000000001 : Integer) : Text;
    VAR
      Dim@1000000000 : Record 348;
      DimTranslation@1000000003 : Record 388;
      CMGenSetup@1000000002 : Record 70000;
    BEGIN
      IF (DimID < 1) OR (DimID > 4) THEN
        EXIT('');

      IF NOT CMGenSetup.GET() THEN
        CMGenSetup.INIT();

      CASE DimID OF
        1 : IF NOT Dim.GET(CMGenSetup."Dimension 1") THEN EXIT('');
        2 : IF NOT Dim.GET(CMGenSetup."Dimension 2") THEN EXIT('');
        3 : IF NOT Dim.GET(CMGenSetup."Dimension 3") THEN EXIT('');
        4 : IF NOT Dim.GET(CMGenSetup."Dimension 4") THEN EXIT('');
      END;

      IF DimTranslation.GET(Dim.Code, GLOBALLANGUAGE) THEN
        EXIT(DimTranslation."Code Caption");

      EXIT(Dim."Code Caption");
    END;

    PROCEDURE ShowPostedEntries@1000000018(UserIDFilter@1000000000 : Text;DateFilter@1000000001 : Text;ShowReversed@1000000002 : 'All,Unreversed,Reversed');
    VAR
      ListPage@1000000003 : Page 70093;
      Rec@1000000004 : Record 952;
    BEGIN
      Rec.RESET;
      Rec.SETCURRENTKEY("CM Is CMMS Timesheet","CM User ID","CM Entry Date");
      Rec.FILTERGROUP(2);
      Rec.SETRANGE("CM Is CMMS Timesheet", TRUE);

      IF UserIDFilter <> '' THEN
        Rec.SETFILTER("CM User ID", UserIDFilter);

      CASE ShowReversed OF
        ShowReversed::All : ;
        ShowReversed::Unreversed : Rec.SETRANGE("CM Reverse Line No.", 0);
        ShowReversed::Reversed : Rec.SETFILTER("CM Reverse Line No.", '>%1', 0)
      END;
      Rec.FILTERGROUP(0);

      IF DateFilter <> '' THEN
        Rec.SETFILTER("CM Entry Date", DateFilter);

      ListPage.SETTABLEVIEW(Rec);
      ListPage.RUN();
    END;

    PROCEDURE ShowPostedEntriesToTask@1000000032(Task@1000000000 : Record 5080;ShowReversed@1000000002 : 'All,Unreversed,Reversed');
    VAR
      ListPage@1000000003 : Page 70093;
      Rec@1000000004 : Record 952;
    BEGIN
      Rec.RESET;
      Rec.SETCURRENTKEY("CM Is CMMS Timesheet", "CM Task No.");
      Rec.FILTERGROUP(2);
      Rec.SETRANGE("CM Is CMMS Timesheet", TRUE);
      Rec.SETRANGE("CM Task No.", Task."No.");
      CASE ShowReversed OF
        ShowReversed::All : ;
        ShowReversed::Unreversed : Rec.SETRANGE("CM Reverse Line No.", 0);
        ShowReversed::Reversed : Rec.SETFILTER("CM Reverse Line No.", '>%1', 0)
      END;
      Rec.FILTERGROUP(0);

      ListPage.SETTABLEVIEW(Rec);
      ListPage.RUN();
    END;

    PROCEDURE ShowPostedEntriesToWorkorder@1000000034(Workorder@1000000000 : Record 5092;ShowReversed@1000000002 : 'All,Unreversed,Reversed');
    VAR
      ListPage@1000000003 : Page 70093;
      Rec@1000000004 : Record 952;
    BEGIN
      Rec.RESET;
      Rec.SETCURRENTKEY("CM Is CMMS Timesheet", "CM Workorder No.");
      Rec.FILTERGROUP(2);
      Rec.SETRANGE("CM Is CMMS Timesheet", TRUE);
      Rec.SETRANGE("CM Workorder No.", Workorder."No.");
      CASE ShowReversed OF
        ShowReversed::All : ;
        ShowReversed::Unreversed : Rec.SETRANGE("CM Reverse Line No.", 0);
        ShowReversed::Reversed : Rec.SETFILTER("CM Reverse Line No.", '>%1', 0)
      END;
      Rec.FILTERGROUP(0);

      ListPage.SETTABLEVIEW(Rec);
      ListPage.RUN();
    END;

    PROCEDURE LookupTimeTrackingDim@1000000026(DimCode@1000000000 : Code[20]) : Code[20];
    VAR
      ListPage@1000000001 : Page 537;
      LocDimValue@1000000002 : Record 349;
    BEGIN
      IF DimCode = '' THEN
        EXIT('');

      LocDimValue.RESET;
      LocDimValue.SETRANGE("Dimension Code", DimCode);
      ListPage.SETTABLEVIEW(LocDimValue);
      ListPage.LOOKUPMODE(TRUE);
      IF ListPage.RUNMODAL <> ACTION::LookupOK THEN
        EXIT('');

      ListPage.GETRECORD(LocDimValue);
      EXIT(LocDimValue.Code)
    END;

    PROCEDURE GetThisWeekDatefilter@1000000019(RefDate@1000000000 : Date) : Text;
    BEGIN
      EXIT(FORMAT(CALCDATE('<-CW>', RefDate)) +'..'+ FORMAT(CALCDATE('<+CW>', RefDate)));
    END;

    PROCEDURE GetThisMonthDatefilter@1000000027(RefDate@1000000000 : Date) : Text;
    BEGIN
      EXIT(FORMAT(CALCDATE ('<-CM>', RefDate)) +'..'+ FORMAT(CALCDATE('<+CM>', RefDate)));
    END;

    PROCEDURE ReverseAllowed@1000000020() : Boolean;
    VAR
      UserSetup@1000000000 : Record 91;
    BEGIN
      IF NOT UserSetup.GET(USERID) THEN
        UserSetup.INIT;

      EXIT(UserSetup."CM Timetrack. Revers. Allowed");
    END;

    LOCAL PROCEDURE PostedHours@1000000024(UserFilter@1000000000 : Text;DateFilter@1000000001 : Text) : Decimal;
    VAR
      TimeSheetDetail@1000000002 : Record 952;
      Sum@1000000003 : Decimal;
    BEGIN
      Sum := 0;
      TimeSheetDetail.SETCURRENTKEY("CM Is CMMS Timesheet","CM User ID","CM Entry Date");
      TimeSheetDetail.SETRANGE("CM Is CMMS Timesheet", TRUE);
      IF UserFilter <> '' THEN
        TimeSheetDetail.SETFILTER("CM User ID", UserFilter);
      IF DateFilter <> '' THEN
        TimeSheetDetail.SETFILTER("CM Entry Date", DateFilter);
      IF TimeSheetDetail.FIND('-') THEN BEGIN
        REPEAT
          Sum += TimeSheetDetail."CM Quantity";
        UNTIL TimeSheetDetail.NEXT = 0;
      END;

      EXIT(Sum);
    END;

    PROCEDURE SetUserID@1000000031(VAR RegisterUserID@1000000002 : Code[50];VAR RegisterUserName@1000000001 : Text[80]);
    VAR
      UserRec@1000000004 : Record 2000000120;
    BEGIN
      CLEAR(RegisterUserName);

      UserRec.SETRANGE("User Name",RegisterUserID);
      IF UserRec.FINDFIRST THEN BEGIN
          RegisterUserName := UserRec."Full Name"
      END ELSE
        ERROR(Text020);
    END;

    PROCEDURE "###ADDITIONAL"@1000000000();
    BEGIN
    END;

    PROCEDURE SetOsrFlag@1000000003(value@1000000000 : Boolean);
    BEGIN
      _OsrFlag := value;
    END;

    BEGIN
    END.
  }
}

OBJECT XMLport 50000 CMMS EEM Interface v1.0
{
  OBJECT-PROPERTIES
  {
    Date=16.11.17;
    Time=11:06:59;
    Modified=Yes;
    Version List=CMMS,EEM;
  }
  PROPERTIES
  {
    Direction=Export;
    Encoding=UTF-8;
    DefaultNamespace=urn:microsoft-dynamics-nav/xmlports/eem10;
    UseDefaultNamespace=Yes;
    OnPreXMLport=BEGIN
                   Starttime := TIME;

                   WorkorderCounter := 0;
                   WorkorderCounterLimit := 0;
                   IF NOT InitDone THEN
                     ERROR(Text001);
                 END;

    OnPostXMLport=VAR
                    ExecutionDruation@1000000000 : Duration;
                  BEGIN
                    ExecutionDruation := TIME - Starttime;
                    //ERROR(FORMAT(ExecutionDruation));
                  END;

  }
  ELEMENTS
  {
    { [{C57678E2-9D8B-41AD-A140-1DE6C733D075}];  ;DataV10             ;Element ;Text    ;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{10A27576-DB6E-4C48-939B-AB71EA9376E9}];1 ;WorkorderV10        ;Element ;Table   ;
                                                  VariableName=Workorder;
                                                  SourceTable=Table5092;
                                                  SourceTableView=SORTING(Field50000,Field50090,Field50100,Field1)
                                                                  ORDER(Descending)
                                                                  WHERE(Field50000=CONST(Yes));
                                                  Export::OnPreXMLItem=BEGIN
                                                                         Workorder.SETRANGE("CM Objecttype", Workorder."CM Objecttype"::Asset);
                                                                         Workorder.SETRANGE("CM Object No.", AssetNo);
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             WorkorderCounter += 1;

                                                                             IF WorkorderCounter < WorkorderOffset THEN
                                                                               currXMLport.SKIP
                                                                             ELSE
                                                                               WorkorderCounterLimit += 1;

                                                                             IF WorkorderCounterLimit > WorkorderLimit THEN
                                                                               currXMLport.SKIP;
                                                                           END;
                                                                            }

    { [{58F607F1-EF57-4813-B3A9-66370B7D44B7}];2 ;No                  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Workorder::No. }

    { [{6279E302-E3DF-4CED-8377-8B6861B543D0}];2 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Workorder::Description }

    { [{FC2F9938-1A92-4AF4-AAAE-590D2E5C0511}];2 ;SourceText          ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Workorder::CM Source }

    { [{25E1A63C-6ED0-415D-81CB-F62A22690A09}];2 ;Status              ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Workorder::CM Status }

    { [{E65B9908-D44F-4675-AA3E-CD79EAFAD040}];2 ;Priority            ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Workorder::Priority }

    { [{37804EFB-F1B9-4414-899E-5DE29F45DC11}];2 ;WorkorderCommentV10 ;Element ;Table   ;
                                                  VariableName=WorkorderComment;
                                                  SourceTable=Table5065;
                                                  SourceTableView=SORTING(Field50000,Field50100,Field50110,Field50200)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field50200=CONST(4),
                                                                        Field50100=CONST(1));
                                                  LinkFields=Field50110=FIELD(Field1);
                                                  LinkTable=Workorder }

    { [{53D079E4-FA03-425C-B0BF-2445D6E43ECC}];3 ;Id                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=WorkorderComment::Entry No. }

    { [{5E7B890E-CC10-4CDF-9F3E-34441CFB55CF}];3 ;CreationDatetime    ;Element ;Field   ;
                                                  DataType=DateTime;
                                                  SourceField=WorkorderComment::CM Created Datetime }

    { [{81F0F2D6-9262-478A-8521-E8A11B52BA7C}];3 ;CommentText         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=WorkorderComment::CM Comment }

    { [{90C61E9B-4C6C-4AC6-B207-1F08CC423719}];2 ;TaskV10             ;Element ;Table   ;
                                                  VariableName=Task;
                                                  SourceTable=Table5080;
                                                  SourceTableView=SORTING(Field50000,Field6,Field1)
                                                                  WHERE(Field50000=CONST(1),
                                                                        Field50090=CONST(0));
                                                  LinkFields=Field6=FIELD(Field1);
                                                  LinkTable=Workorder }

    { [{6307573F-B5BD-400A-BB40-8AF114BE0F51}];3 ;No.                 ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Task::No. }

    { [{F5755FF1-DC6A-4585-96B2-B8A4929D86CA}];3 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Task::Description }

    { [{B6310629-8555-4EAB-8154-368DD86E2D85}];3 ;Status              ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Task::CM Status }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      InitDone@1000000000 : Boolean;
      AssetNo@1000000006 : Code[20];
      WorkorderOffset@1000000001 : Integer;
      WorkorderLimit@1000000002 : Integer;
      WorkorderCounter@1000000003 : Integer;
      WorkorderCounterLimit@1000000004 : Integer;
      Text001@1000000005 : TextConst 'ENU=Invalid call. Call DoInit() before executing XML Port.';
      Starttime@1000000007 : Time;

    PROCEDURE DoInit@1000000004(AssetNo_@1000000002 : Code[20];WorkorderOffset_@1000000000 : Integer;WorkorderLimit_@1000000001 : Integer);
    BEGIN
      AssetNo := AssetNo_;
      WorkorderOffset := WorkorderOffset_;
      WorkorderLimit := WorkorderLimit_;
      InitDone := TRUE;
    END;

    BEGIN
    END.
  }
}

OBJECT XMLport 50001 CMMS EEM Interface v2.0
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=15:00:36;
    Modified=Yes;
    Version List=CMMS,EEM;
  }
  PROPERTIES
  {
    Direction=Export;
    Encoding=UTF-8;
    DefaultNamespace=urn:microsoft-dynamics-nav/xmlports/eem20;
    UseDefaultNamespace=Yes;
    OnPreXMLport=BEGIN
                   Starttime := TIME;

                   WorkorderCounter := 0;
                   WorkorderCounterLimit := 0;
                   IF NOT InitDone THEN
                     ERROR(Text001);
                 END;

    OnPostXMLport=VAR
                    ExecutionDruation@1000000000 : Duration;
                  BEGIN
                    {
                    ExecutionDruation := TIME - Starttime;

                    IF ExecutionDruation = 0 THEN
                      ERROR('Microsoft Dynamics NAV execution duration: %1.', '~0');
                    ERROR('Microsoft Dynamics NAV execution duration: %1.', ExecutionDruation);
                    }
                  END;

  }
  ELEMENTS
  {
    { [{C57678E2-9D8B-41AD-A140-1DE6C733D075}];  ;DataV20             ;Element ;Text    ;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{10A27576-DB6E-4C48-939B-AB71EA9376E9}];1 ;WorkordersV20       ;Element ;Table   ;
                                                  VariableName=Workorder;
                                                  SourceTable=Table5092;
                                                  SourceTableView=SORTING(Field50000,Field50090,Field50100,Field1)
                                                                  ORDER(Descending)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field50010=FILTER(0|1|4));
                                                  MinOccurs=Zero;
                                                  Export::OnPreXMLItem=BEGIN
                                                                         Workorder.SETRANGE("CM Objecttype", Workorder."CM Objecttype"::Asset);
                                                                         Workorder.SETRANGE("CM Object No.", AssetNo);
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Offset / Count Logic
                                                                             WorkorderCounter += 1;

                                                                             IF WorkorderCounter < WorkorderOffset THEN
                                                                               currXMLport.SKIP
                                                                             ELSE
                                                                               WorkorderCounterLimit += 1;

                                                                             IF WorkorderCounterLimit > WorkorderLimit THEN
                                                                               currXMLport.SKIP;

                                                                             //Load Data
                                                                             IF (Workorder."CM GPM Notified DateTime" <> 0DT) AND (Workorder."CM GPM Activated DateTime" <> 0DT) THEN
                                                                               _WorkorderReactionTime := FORMAT((Workorder."CM GPM Notified DateTime" - Workorder."CM GPM Activated DateTime") / 1000)
                                                                             ELSE
                                                                               _WorkorderReactionTime := '';

                                                                             IF Workorder."CM Created Datetime" <> 0DT THEN BEGIN
                                                                               _WorkorderCreationDate := FORMAT(DT2DATE(Workorder."CM Created Datetime"));
                                                                               _WorkorderCreationTime := FORMAT(DT2TIME(Workorder."CM Created Datetime"));
                                                                             END
                                                                             ELSE BEGIN
                                                                               _WorkorderCreationDate := '';
                                                                               _WorkorderCreationTime := '';
                                                                             END;
                                                                           END;
                                                                            }

    { [{58F607F1-EF57-4813-B3A9-66370B7D44B7}];2 ;No                  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=Workorder::No. }

    { [{6279E302-E3DF-4CED-8377-8B6861B543D0}];2 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Workorder::Description }

    { [{E65B9908-D44F-4675-AA3E-CD79EAFAD040}];2 ;Priority            ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Workorder::Priority }

    { [{E56147AD-0BCA-4C57-A056-E4102761CBF9}];2 ;ReferenceElementName;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Workorder::CM GPM Reference Element Name }

    { [{25E1A63C-6ED0-415D-81CB-F62A22690A09}];2 ;Status              ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Workorder::CM Status }

    { [{FC2F9938-1A92-4AF4-AAAE-590D2E5C0511}];2 ;Source              ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Workorder::CM Source }

    { [{DA520F2B-4A46-4A42-BA09-4EF95F3AA455}];2 ;CreationDate        ;Element ;Text    ;
                                                  VariableName=_WorkorderCreationDate;
                                                  DataType=Date }

    { [{2FB01458-34EA-4675-9302-98F41D193C1D}];2 ;CreationTime        ;Element ;Text    ;
                                                  VariableName=_WorkorderCreationTime;
                                                  DataType=Time }

    { [{464C5B33-B13D-4A0D-8301-BA9462BB3259}];2 ;ReactionTime        ;Element ;Text    ;
                                                  VariableName=_WorkorderReactionTime;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{37804EFB-F1B9-4414-899E-5DE29F45DC11}];2 ;CommentsV20         ;Element ;Table   ;
                                                  VariableName=Comment;
                                                  SourceTable=Table5065;
                                                  SourceTableView=SORTING(Field50000,Field44,Field50200,Field52010,Field51400,Field51500,Field50100)
                                                                  ORDER(Descending)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field50200=CONST(4),
                                                                        Field50100=FILTER(1|2),
                                                                        Field52010=CONST(No),
                                                                        Field51400=CONST(No));
                                                  LinkFields=Field44=FIELD(Field1);
                                                  LinkTable=Workorder;
                                                  MinOccurs=Zero }

    { [{53D079E4-FA03-425C-B0BF-2445D6E43ECC}];3 ;Id                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=Comment::Entry No. }

    { [{5E7B890E-CC10-4CDF-9F3E-34441CFB55CF}];3 ;CreationDatetime    ;Element ;Field   ;
                                                  DataType=DateTime;
                                                  SourceField=Comment::CM Created Datetime }

    { [{AF860D26-C79F-4351-9D61-4DED6C99B960}];3 ;Source              ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=Comment::CM Source }

    { [{81F0F2D6-9262-478A-8521-E8A11B52BA7C}];3 ;CommentText         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=Comment::CM Comment }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      InitDone@1000000000 : Boolean;
      AssetNo@1000000006 : Code[20];
      WorkorderOffset@1000000001 : Integer;
      WorkorderLimit@1000000002 : Integer;
      WorkorderCounter@1000000003 : Integer;
      WorkorderCounterLimit@1000000004 : Integer;
      Text001@1000000005 : TextConst 'ENU=Invalid call. Call DoInit() before executing XML Port.';
      Starttime@1000000007 : Time;
      x@1000000008 : Record 70020;

    PROCEDURE DoInit@1000000004(AssetNo_@1000000002 : Code[20];WorkorderOffset_@1000000000 : Integer;WorkorderLimit_@1000000001 : Integer);
    BEGIN
      AssetNo := AssetNo_;
      WorkorderOffset := WorkorderOffset_;
      WorkorderLimit := WorkorderLimit_;
      InitDone := TRUE;
    END;

    BEGIN
    END.
  }
}

OBJECT XMLport 50005 CMMS Offline App
{
  OBJECT-PROPERTIES
  {
    Date=16.03.18;
    Time=11:18:27;
    Modified=Yes;
    Version List=CMMS,OSR;
  }
  PROPERTIES
  {
    Encoding=UTF-8;
    DefaultFieldsValidation=No;
    DefaultNamespace=urn:microsoft-dynamics-nav/xmlports/offlineappdata;
    UseDefaultNamespace=Yes;
    OnPreXMLport=BEGIN
                   //ERROR('CMMS OSR Webservice temporary unavailable!');
                   IF ISNULL(ImportedWorkorders) THEN ImportedWorkorders := ImportedWorkorders.List();
                 END;

  }
  ELEMENTS
  {
    { [{FCF7C10E-8549-4215-A965-9B22FDAF010C}];  ;Data                ;Element ;Text    ;
                                                  VariableName=Data;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{E6A4B52C-158B-4E13-A967-7842FDE7E8AD}];1 ;Workorder           ;Element ;Table   ;
                                                  VariableName=WO;
                                                  SourceTable=Table5092;
                                                  Temporary=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 LocWO@1000000000 : Record 5092;
                                                                               BEGIN
                                                                                 //Insert Code
                                                                                 CheckWorkorder(LocWO, FALSE, '', '');
                                                                                 ImportedWorkorders.Add(WO."No.");
                                                                               END;

                                                  Export::OnPreXMLItem=VAR
                                                                         Cue@1000000000 : Record 70011;
                                                                       BEGIN
                                                                         Cue.SETFILTER("Due Date Filter", '..%1', CALCDATE('<+5D>', TODAY));
                                                                         CMWoMgt.GetWorkorders(WO,'','',USERID,Cue.GETFILTER("Due Date Filter"),'0|1|2|3','','');
                                                                         WO.SETCURRENTKEY("No.");
                                                                         WO.ASCENDING(TRUE);
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             WO.CALCFIELDS("CM Assigned User Name");
                                                                             WOdueDate := DateToIsoString(WO."CM Due Date");
                                                                             WOscheduledDueDate := DateToIsoString(WO."CM Scheduled Due Date");

                                                                             //ExportedWorkorders
                                                                             IF IsUploadResponse THEN BEGIN
                                                                               IF NOT ImportedWorkorders.Contains(WO."No.") THEN
                                                                                 currXMLport.SKIP();
                                                                             END;
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code
                                                                                WOdueDate := '';
                                                                                WOscheduledDueDate := '';
                                                                              END;

                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 //Modify Code
                                                                               END;
                                                                                }

    { [{0312BA3E-A6B2-4504-8F1E-43850EF3DFED}];2 ;No                  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=WO::No. }

    { [{53646E29-3F6A-44A2-8D30-FEB390F6FE92}];2 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=WO::Description }

    { [{B0D365B0-00FB-4D07-BD20-CAB0DB41F8FB}];2 ;Status              ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=WO::CM Status }

    { [{17E74762-9024-4A1B-99DF-9964CEB12257}];2 ;Priority            ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=WO::Priority }

    { [{D95C37F5-9216-43BE-A882-46D5E327A2AC}];2 ;AssetNo             ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=WO::CM Object No. }

    { [{59CAD748-88D8-4945-AF44-AB8D85C58F61}];2 ;AssetName           ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=WO::CM Object Name }

    { [{D6B77760-0F01-4259-A719-896C5509DA49}];2 ;DueDate             ;Element ;Text    ;
                                                  VariableName=WOdueDate;
                                                  DataType=Date;
                                                  MaxOccurs=Once }

    { [{8860F213-73AF-432F-BBDA-564EE9BA533D}];2 ;ScheduledDueDate    ;Element ;Text    ;
                                                  VariableName=WOscheduledDueDate;
                                                  DataType=Date;
                                                  MaxOccurs=Once }

    { [{466BD4BF-AFE2-4985-A338-0D7129E014EE}];2 ;AssignedUserId      ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=WO::CM Assigned User ID }

    { [{7A17169A-F993-48BC-968C-725A630043E7}];2 ;AssignedUserName    ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=WO::CM Assigned User Name }

    { [{07D43EAD-1F02-49AA-9D6B-486ECB4C1E9A}];2 ;ReferenceElementName;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=WO::CM GPM Reference Element Name }

    { [{914DD397-7103-4A08-B81D-AA20390B404F}];2 ;WorkorderComment    ;Element ;Table   ;
                                                  VariableName=WOC;
                                                  SourceTable=Table5065;
                                                  SourceTableView=SORTING(Field50000,Field50100,Field50110,Field50200)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field50100=CONST(1),
                                                                        Field50200=CONST(4),
                                                                        Field52010=CONST(No));
                                                  LinkFields=Field44=FIELD(Field1),
                                                             Field50110=FIELD(Field1);
                                                  LinkTable=WO;
                                                  Temporary=No;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 //InsertWorkorderComment();
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Export Code
                                                                             WOCcreatedDatetime := DateTimeToIsoString(WOC."CM Created Datetime");
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code
                                                                                WOCcreatedDatetime := '';
                                                                              END;
                                                                               }

    { [{1CA42A77-AFDE-449D-AD64-751B56666456}];3 ;Id                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=WOC::Entry No.;
                                                  MinOccurs=Zero }

    { [{4CABE5D6-B5BD-4C61-B6A6-B0AF37ADD187}];3 ;UserId              ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=WOC::User ID;
                                                  MinOccurs=Zero }

    { [{F56F7CAB-3678-4BB3-B695-CC874962DBCB}];3 ;CreatedDatetime     ;Element ;Text    ;
                                                  VariableName=WOCcreatedDatetime;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{1AF65B02-EB71-4AF3-93A9-50F73811CD2B}];3 ;Internal            ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=WOC::CM Internal;
                                                  MinOccurs=Zero }

    { [{45A4A0BD-FA40-4EE2-BE5D-21046E1524A0}];3 ;CommentText         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=WOC::CM Comment;
                                                  MinOccurs=Zero }

    { [{611CBEC7-893E-4D09-82D7-F8AF94D8EE8C}];2 ;Task                ;Element ;Table   ;
                                                  VariableName=T;
                                                  SourceTable=Table5080;
                                                  SourceTableView=SORTING(Field50000,Field6,Field1)
                                                                  WHERE(Field50000=CONST(1),
                                                                        Field50090=CONST(0));
                                                  LinkFields=Field6=FIELD(Field1);
                                                  LinkTable=WO;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertUpdateTask();
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Export Code
                                                                             T.CALCFIELDS("CM Assigned User Name");
                                                                             TcreatedDatetime := DateTimeToIsoString(T."CM Created Datetime");
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code (after all Child Items are processed we do Status Changes);
                                                                                AfterInsertUpdateTask();
                                                                                TaskIsNew := FALSE;
                                                                                TaskInsertedUpdated := FALSE;
                                                                                TcreatedDatetime := '';
                                                                              END;
                                                                               }

    { [{6408A217-5146-4805-B38E-FCD9DA0C9A2F}];3 ;No                  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=T::No.;
                                                  MinOccurs=Zero }

    { [{4E8D9A43-DD70-4FC1-9F28-20410C0F5EF8}];3 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=T::Description;
                                                  MinOccurs=Zero }

    { [{F0B4F41A-D02A-4058-979D-733CCD9062A5}];3 ;Description2        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=T::CM Extended Description;
                                                  MinOccurs=Zero }

    { [{9F09F1C5-4600-48EF-9220-1F9390288D92}];3 ;Status              ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=T::CM Status;
                                                  MinOccurs=Zero }

    { [{5953D954-7DB1-416C-9184-5AAE2EDA5AFA}];3 ;Internal            ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=T::CM Internal;
                                                  MinOccurs=Zero }

    { [{5283D43B-3C9E-48C4-BD24-C2451BA07EBA}];3 ;CreatedDatetime     ;Element ;Text    ;
                                                  VariableName=TcreatedDatetime;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{7C916F98-4654-402E-BF3A-65D60689E9E2}];3 ;AssignedUserId      ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=T::CM Assigned User ID;
                                                  MinOccurs=Zero }

    { [{F21425E2-B165-41E1-9468-93FFB5CF6405}];3 ;AssignedUserName    ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=T::CM Assigned User Name;
                                                  MinOccurs=Zero }

    { [{2068A6DA-4D62-4337-BFB0-46E354F11440}];3 ;TaskComment         ;Element ;Table   ;
                                                  VariableName=TC;
                                                  SourceTable=Table5065;
                                                  SourceTableView=SORTING(Field50000,Field50100,Field50110,Field50200)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field50100=CONST(2),
                                                                        Field50200=CONST(4),
                                                                        Field52010=CONST(No));
                                                  LinkFields=Field23=FIELD(Field1),
                                                             Field50110=FIELD(Field1);
                                                  LinkTable=T;
                                                  Temporary=No;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertUpdateTask();
                                                                                 InsertTaskComment();
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Export Code
                                                                             TCcreatedDatetime := DateTimeToIsoString(TC."CM Created Datetime");
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code
                                                                                TCcreatedDatetime := '';
                                                                              END;
                                                                               }

    { [{ABF3D0B6-D053-4511-92A7-7400BBCC4613}];4 ;Id                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=TC::Entry No.;
                                                  MinOccurs=Zero }

    { [{D54696A0-A5D2-4C08-801A-C46E2817214C}];4 ;UserId              ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=TC::User ID;
                                                  MinOccurs=Zero }

    { [{D535C0B1-3C99-45D2-AC08-E8B3738C5F0D}];4 ;CreatedDatetime     ;Element ;Text    ;
                                                  VariableName=TCcreatedDatetime;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{155804C7-3C76-45F8-AAB6-F31D76D6DE4E}];4 ;Internal            ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=TC::CM Internal;
                                                  MinOccurs=Zero }

    { [{61417CB2-9F51-4CCA-A5C3-1720A4C5A081}];4 ;CommentText         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TC::CM Comment }

    { [{868AD38D-DFF5-4DA9-96AC-A9B6F980825C}];3 ;TaskPicture         ;Element ;Table   ;
                                                  VariableName=TP;
                                                  SourceTable=Table5065;
                                                  SourceTableView=SORTING(Field50000,Field50100,Field50110,Field50200)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field50100=CONST(2),
                                                                        Field50200=CONST(6),
                                                                        Field52010=CONST(No));
                                                  LinkFields=Field23=FIELD(Field1),
                                                             Field50110=FIELD(Field1);
                                                  LinkTable=T;
                                                  Temporary=No;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertUpdateTask();
                                                                                 InsertTaskPicture();
                                                                               END;

                                                  Export::OnAfterGetRecord=VAR
                                                                             Attachment@1000000001 : Record 5062;
                                                                             TempBlob@1000000000 : TEMPORARY Record 99008535;
                                                                           BEGIN
                                                                             //Export Code
                                                                             CLEAR(TPImageData);
                                                                             IF NOT IsUploadResponse THEN BEGIN
                                                                               IF (TP."Attachment No." > 0) AND (Attachment.GET(TP."Attachment No.")) THEN BEGIN
                                                                                 Attachment.CALCFIELDS(Attachment);
                                                                                 IF Attachment.Attachment.HASVALUE THEN BEGIN
                                                                                   TempBlob.INIT;
                                                                                   TempBlob.Blob := Attachment.Attachment;
                                                                                   TempBlob.INSERT();

                                                                                   TPImageData.ADDTEXT(TempBlobToBase64String(TempBlob));
                                                                                   TPImageType := ExtensionToMime(Attachment."File Extension");
                                                                                 END;
                                                                               END;
                                                                             END;

                                                                             TPcreatedDatetime := DateTimeToIsoString(TP."CM Created Datetime");
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code
                                                                                CLEAR(TPImageData);
                                                                                TPImageType := '';
                                                                                TPcreatedDatetime := '';
                                                                              END;
                                                                               }

    { [{28807B26-64B1-4180-93BE-8433AFA91539}];4 ;Id                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=TP::Entry No.;
                                                  MinOccurs=Zero }

    { [{C29DD94B-9BF5-4CDF-96F0-BD0A3BC39B60}];4 ;UserId              ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=TP::User ID;
                                                  MinOccurs=Zero }

    { [{65AE400C-A001-429D-B273-5FBB73C117BD}];4 ;CreatedDatetime     ;Element ;Text    ;
                                                  VariableName=TPcreatedDatetime;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{154A6E91-CB33-4FE1-8C3D-23C2BAAD81CA}];4 ;ImageData           ;Element ;Text    ;
                                                  VariableName=TPImageData;
                                                  TextType=BigText;
                                                  DataType=Text;
                                                  MaxOccurs=Once }

    { [{0367FD20-1DF3-4574-82FE-FAFBE8EF2895}];4 ;ImageType           ;Element ;Text    ;
                                                  VariableName=TPImageType;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{809462E0-8CF0-473B-BCF8-7BC26454CDC6}];4 ;NoImageData         ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=TP::CM No Data;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{4CA9A63E-954B-450C-B824-A4175F1FD21E}];4 ;Identifier          ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TP::CM Identifier;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{9380EBFC-1955-446D-9BAD-5FFC8BD44A1E}];4 ;CommentText         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TP::CM Comment;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{4715521C-6869-4509-9AF5-5E5F55ACA7B0}];3 ;TaskTimeTrackingEntry;Element;Table   ;
                                                  VariableName=TTE;
                                                  SourceTable=Table952;
                                                  SourceTableView=SORTING(Field50000,Field50300)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field3=CONST(),
                                                                        Field1=CONST());
                                                  LinkFields=Field50300=FIELD(Field1);
                                                  LinkTable=T;
                                                  Temporary=No;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertUpdateTask();
                                                                                 InsertTaskTimeTrackingEntry();
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Export Code
                                                                             TTEcreatedDatetime := DateTimeToIsoString(TTE."CM Posted Datetime");
                                                                             TTEentryDate := DateToIsoString(TTE."CM Entry Date");
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code
                                                                                TTEcreatedDatetime := '';
                                                                                TTEentryDate := '';
                                                                              END;
                                                                               }

    { [{4FC655C1-9FC3-43BD-9DB0-6B617A011DB6}];4 ;Id                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=TTE::Time Sheet Line No.;
                                                  MinOccurs=Zero }

    { [{D9570676-A16E-4519-A7A3-2C268280B431}];4 ;UserId              ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=TTE::CM Posted By User ID;
                                                  MinOccurs=Zero }

    { [{FA4706EC-B9E6-4984-9895-0E2CD31BDB9F}];4 ;EntryDate           ;Element ;Text    ;
                                                  VariableName=TTEentryDate;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{E86FF228-8096-4DDA-ABB9-58F4F75E5FE8}];4 ;CreatedDatetime     ;Element ;Text    ;
                                                  VariableName=TTEcreatedDatetime;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{55BB1C0A-84C1-4136-8096-381A1786F772}];4 ;Quantity            ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=TTE::CM Quantity;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{CDACFF99-A627-4410-92CB-6559F9DD4C7B}];3 ;TaskChecklistEntry  ;Element ;Table   ;
                                                  VariableName=TCE;
                                                  SourceTable=Table5080;
                                                  SourceTableView=SORTING(Field50000,Field50090,Field50210,Field1)
                                                                  WHERE(Field50000=CONST(1),
                                                                        Field50090=CONST(1));
                                                  LinkFields=Field50210=FIELD(Field1);
                                                  LinkTable=T;
                                                  Temporary=No;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertUpdateTask();
                                                                                 UpdateChecklistItem();
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Export Code
                                                                             TCE."CM Checklist Status (Helper)" := TCE."CM Status";
                                                                           END;
                                                                            }

    { [{22E0E1E5-C8A5-4E24-B82C-C16B02F53B0C}];4 ;No                  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=TCE::No.;
                                                  MinOccurs=Zero }

    { [{B78843C9-F894-44CA-A737-7D632F75B90C}];4 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TCE::Description;
                                                  MinOccurs=Zero }

    { [{ADDB5DFB-3E71-484A-AAC8-4CCA42EC09E9}];4 ;Status              ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=TCE::CM Checklist Status (Helper);
                                                  MinOccurs=Zero }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CMWoMgt@1000000002 : Codeunit 70030;
      CMTaskMgt@1000000004 : Codeunit 70031;
      CMTTMgt@1000000005 : Codeunit 70040;
      Text002@1000000006 : TextConst 'ENU=Workorder "%1" not found.';
      Text003@1000000007 : TextConst 'ENU=Task "%1" not found.';
      CMGenMgt@1000000008 : Codeunit 70000;
      LogEntry@1000000009 : Record 5065;
      TaskInsertedUpdated@1000000010 : Boolean;
      Text004@1000000000 : TextConst 'ENU=Unsupported file extension "%1".';
      Text005@1000000001 : TextConst 'ENU=Unsupported mime type "%1".';
      Text008@1000000012 : TextConst 'ENU=%3. CMMS Status of Workorder "%1" is "%2".';
      Text009@1000000013 : TextConst 'ENU=%3. CMMS Status of Task "%1" is "%2".';
      Text010@1000000020 : TextConst 'ENU=Workorder Comment cannot be created';
      Text011@1000000015 : TextConst 'ENU=Cannot create Task Picture for Task "%1". Please specify an identifier.';
      Text012@1000000014 : TextConst 'ENU=Task cannot be created';
      Text013@1000000016 : TextConst 'ENU=Task Status cannot be changed to "%1"';
      Text016@1000000019 : TextConst 'ENU=Task Time Tracking Entry cannot be created';
      Text017@1000000021 : TextConst 'ENU=Task Checklist Entry status cannot be changed to "%1"';
      TaskIsNew@1000000023 : Boolean;
      Text018@1000000024 : TextConst 'ENU=%5. CMMS Status of Workorder "%1" ist "%2" and CMMS Status of Task "%3" is "%4".';
      IsUploadResponse@1000000003 : Boolean;
      ImportedWorkorders@1000000011 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.Generic.List`1";

    PROCEDURE SetData@1000000015(IsUploadResponse_@1000000000 : Boolean;ImportedWorkorders_@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.Generic.List`1");
    BEGIN
      IsUploadResponse := IsUploadResponse_;
      ImportedWorkorders := ImportedWorkorders_;
    END;

    PROCEDURE GetData@1000000023(VAR ImportedWorkorders_@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.Generic.List`1");
    BEGIN
      ImportedWorkorders_ := ImportedWorkorders;
    END;

    LOCAL PROCEDURE "###LOCAL####"@1000000012();
    BEGIN
    END;

    LOCAL PROCEDURE InsertUpdateTask@1000000000();
    VAR
      LocTask@1000000000 : Record 5080;
      LocWO@1000000001 : Record 5092;
    BEGIN
      IF TaskInsertedUpdated THEN
        EXIT;

      T."CM Created Datetime" := IsoStringToDateTime(TcreatedDatetime);

      //Insert Code
      IF (T."No." = '') THEN BEGIN
        TaskIsNew := TRUE;
        CheckWorkorder(LocWO, TRUE, 'open', Text012);

        CMTaskMgt.NewTaskToWorkorder(LocWO, LocTask, FALSE, FALSE);
        LocTask.Description := T.Description;
        LocTask."CM Extended Description" := T."CM Extended Description";
        LocTask."CM Internal" := LocTask."CM Internal";
        LocTask."CM Created Datetime" := T."CM Created Datetime";
        LocTask.INSERT(TRUE);
        //Task Status is changed after all Child notes are processed, so we habe two log entries - create and change status.

        TaskInsertedUpdated := TRUE;
        T."No." := LocTask."No.";
      END;

      //Update Code
      IF T."No." <> '' THEN BEGIN
        //Task Status is changed after all Child notes are processed, so we habe two log entries - create and change status.
        //Task Data cannot be edited
      END;
    END;

    LOCAL PROCEDURE AfterInsertUpdateTask@1000000017();
    VAR
      LocTask@1000000000 : Record 5080;
      LocWO@1000000001 : Record 5092;
    BEGIN
      //New Task
      IF (TaskIsNew) THEN BEGIN
        IF CMTaskMgt.IsStatusClosed(T) THEN BEGIN //New Task is immediately closed
          CheckTask(LocTask, FALSE, '', '');

          LocTask."CM Status" := T."CM Status";
          CMGenMgt.CreateLogEntry(LocTask,LogEntry."CM Log Type"::"Status Change",FORMAT(LocTask."CM Status"), '');
        END;
      END;

      //Existing Task
      IF NOT TaskIsNew THEN BEGIN
        CheckTask(LocTask, FALSE, '', '');
        IF (T."CM Status" <> LocTask."CM Status") THEN BEGIN //Status has changed.
          CheckWorkorder(LocWO, FALSE, '', '');

          IF CMWoMgt.IsStatusOpen(LocWO) THEN BEGIN
            CheckTask(LocTask, TRUE, 'open', STRSUBSTNO(Text013, T."CM Status"));
          END;
          IF CMWoMgt.IsStatusClosed(LocWO) THEN BEGIN
            IF NOT ((CMTaskMgt.IsStatusClosed(T)) AND (LocTask."CM Status" = LocTask."CM Status"::Closed)) THEN
              ERROR(Text018, LocWO."No.", LocWO."CM Status", LocTask."No.", LocTask."CM Status", STRSUBSTNO(Text013, T."CM Status"));
          END;

          LocTask."CM Status" := T."CM Status";
          CMGenMgt.CreateLogEntry(LocTask,LogEntry."CM Log Type"::"Status Change",FORMAT(LocTask."CM Status"), '');
          LocTask.MODIFY(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE InsertWorkorderComment@1000000001();
    VAR
      LocWO@1000000000 : Record 5092;
      Id@1000000001 : Integer;
    BEGIN
      IF WOC."Entry No." = 0 THEN BEGIN
        //Not available (yet)
        {
        CheckWorkorder(LocWO, TRUE, 'open', Text010);
        WOC."CM Created Datetime" := IsoStringToDateTime(WOCcreatedDatetime);

        Id := CMGenMgt.CreateLogEntryComment(LocWO, WOC."CM Internal", WOC."CM Comment");
        LogEntry.GET(Id);
        LogEntry."CM Created Datetime" := WOC."CM Created Datetime";
        LogEntry.MODIFY(FALSE);
        }
      END;
    END;

    LOCAL PROCEDURE InsertTaskComment@1000000002();
    VAR
      LocTask@1000000000 : Record 5080;
      LocWO@1000000002 : Record 5092;
      Id@1000000001 : Integer;
    BEGIN
      IF TC."Entry No." = 0 THEN BEGIN
        CheckTask(LocTask, FALSE, '', '');

        TC."CM Created Datetime" := IsoStringToDateTime(TCcreatedDatetime);

        Id := CMGenMgt.CreateLogEntryComment(LocTask, TC."CM Internal", TC."CM Comment");
        LogEntry.GET(Id);
        LogEntry."CM Created Datetime" := TC."CM Created Datetime";
        LogEntry.MODIFY();
      END;
    END;

    LOCAL PROCEDURE InsertTaskPicture@1000000003();
    VAR
      LocTask@1000000000 : Record 5080;
      LocWO@1000000004 : Record 5092;
      Id@1000000001 : Integer;
      LocTempAttachment@1000000002 : TEMPORARY Record 5062;
      TempBlob@1000000003 : TEMPORARY Record 99008535;
    BEGIN
      IF TP."Entry No." = 0 THEN BEGIN
        CheckWorkorder(LocWO, FALSE, '', '');
        CheckTask(LocTask, FALSE, '', '');

        TP."CM Created Datetime" := IsoStringToDateTime(TPcreatedDatetime);

        CLEAR(LocTempAttachment);
        IF TP."CM No Data" THEN BEGIN //Has !!!NO!!! Image data

          IF TP."CM Identifier" = '' THEN
            ERROR(Text011, LocTask."No.");

          LocTempAttachment.INIT;
          LocTempAttachment."No." := -1;

          CMGenMgt.SetAttachment(LocTempAttachment);
          Id := CMGenMgt.CreateLogEntryPhoto(LocTask, TP."CM Comment");
          CMGenMgt.UnsetAttachment();
          LogEntry.GET(Id);

          LogEntry."CM Identifier" := TP."CM Identifier";
          LogEntry."CM No Data" := TRUE;
        END
        ELSE BEGIN //Has some Image data
          Base64StringToBlob(TPImageData, TempBlob);
          LocTempAttachment.INIT;
          LocTempAttachment.Attachment := TempBlob.Blob;
          LocTempAttachment."File Extension" := MimeToExtension(TPImageType);
          LocTempAttachment.INSERT(TRUE);
          LocTempAttachment.CALCFIELDS(Attachment);

          CMGenMgt.SetAttachment(LocTempAttachment);
          Id := CMGenMgt.CreateLogEntryPhoto(LocTask, TP."CM Comment");
          CMGenMgt.UnsetAttachment();
          LogEntry.GET(Id);
        END;

        LogEntry."CM Created Datetime" := TP."CM Created Datetime";
        LogEntry.MODIFY();
      END;
    END;

    LOCAL PROCEDURE InsertTaskTimeTrackingEntry@1000000004();
    VAR
      LocTask@1000000000 : Record 5080;
      LocWO@1000000002 : Record 5092;
    BEGIN
      IF TTE."Time Sheet Line No." = 0 THEN BEGIN
        IF TTE."CM Quantity" > 0 THEN BEGIN
          CheckTask(LocTask, FALSE, '', '');
          TTE."CM Posted Datetime" := IsoStringToDateTime(TTEcreatedDatetime);
          TTE."CM Entry Date" := IsoStringToDate(TTEentryDate);

          CMTTMgt.SetOsrFlag(TRUE);
          CMTTMgt.PostFromTask(LocTask, TTE."CM Quantity", TTE."CM Entry Date", TTE."CM Posted Datetime");
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateChecklistItem@1000000014();
    VAR
      TaskCheckListItem@1000000000 : Record 5080;
      LocWO@1000000001 : Record 5092;
    BEGIN
      TCE."CM Status" := TCE."CM Checklist Status (Helper)";

      IF TCE."No." = '' THEN BEGIN
        //No Insert allowed
        {
        TaskCheckListItem.INIT;
        TaskCheckListItem.TRANSFERFIELDS(TCE, FALSE);
        TaskCheckListItem."CM Type" := TaskCheckListItem."CM Type"::Task;
        TaskCheckListItem."CM Subtype" := TaskCheckListItem."CM Subtype"::Checklist;
        TaskCheckListItem."CM Maintask No." := T."No.";
        TaskCheckListItem.INSERT(TRUE);
        }
      END
      ELSE BEGIN
        TaskCheckListItem.GET(TCE."No.");
        IF TaskCheckListItem."CM Status" <> TCE."CM Status" THEN BEGIN
          CheckWorkorder(LocWO, TRUE, 'open', STRSUBSTNO(Text017, TCE."CM Checklist Status (Helper)"));

          TaskCheckListItem."CM Status" := TCE."CM Status";
          TaskCheckListItem."CM Checklist Status (Helper)" := TCE."CM Checklist Status (Helper)";
          CMGenMgt.CreateLogEntry(TaskCheckListItem, LogEntry."CM Log Type"::"Status Change", FORMAT(TaskCheckListItem."CM Checklist Status (Helper)"), '');
          TaskCheckListItem.MODIFY(TRUE);
        END;
      END;
    END;

    PROCEDURE "###GLOBAL###"@1000000013();
    BEGIN
    END;

    PROCEDURE Base64StringToBlob@1000000007(VAR Base64String@1000000005 : BigText;VAR TempBlob@1000000000 : TEMPORARY Record 99008535);
    VAR
      DotNetConvert@1000000004 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Convert" SUPPRESSDISPOSE;
      DotNetMemoryStream@1000000003 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.MemoryStream" SUPPRESSDISPOSE;
      DotNetByteArray@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array" SUPPRESSDISPOSE;
      OutStr@1000000001 : OutStream;
      Base64Text@1000000007 : Text;
    BEGIN
      CLEAR(TempBlob.Blob);
      TempBlob.INIT;

      Base64String.GETSUBTEXT(Base64Text, 1);
      DotNetByteArray := DotNetConvert.FromBase64String(Base64String);

      TempBlob.Blob.CREATEOUTSTREAM(OutStr);
      DotNetMemoryStream := DotNetMemoryStream.MemoryStream(DotNetByteArray);
      DotNetMemoryStream.WriteTo(OutStr);

      TempBlob.INSERT();
      TempBlob.CALCFIELDS(Blob);
    END;

    PROCEDURE TempBlobToBase64String@1000000005(VAR TempBlob@1000000000 : TEMPORARY Record 99008535) : Text;
    VAR
      DotNetConvert@1000000004 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Convert" SUPPRESSDISPOSE;
      DotNetMemoryStream@1000000003 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.MemoryStream" SUPPRESSDISPOSE;
      DotNetByteArray@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array" SUPPRESSDISPOSE;
      InStr@1000000001 : InStream;
    BEGIN
      TempBlob.CALCFIELDS(Blob);
      IF NOT TempBlob.Blob.HASVALUE THEN
        EXIT('');


      TempBlob.Blob.CREATEINSTREAM(InStr);

      DotNetMemoryStream := DotNetMemoryStream.MemoryStream();
      COPYSTREAM(DotNetMemoryStream, InStr);
      DotNetByteArray := DotNetMemoryStream.GetBuffer();
      DotNetMemoryStream.Close();

      EXIT(DotNetConvert.ToBase64String(DotNetByteArray));
    END;

    PROCEDURE IsoStringToDateTime@1000000006(value@1000000000 : Text) : DateTime;
    VAR
      DotNetDateTime@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
      DotNetCultureInfo@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Globalization.CultureInfo" SUPPRESSDISPOSE;
    BEGIN
      IF value = '' THEN
        EXIT(0DT);

      DotNetDateTime := 0DT;
      EXIT(DotNetDateTime.ParseExact(value, 'yyyy-MM-ddTHH\:mm\:ss.fffZ', DotNetCultureInfo.InvariantCulture));
    END;

    PROCEDURE DateTimeToIsoString@1000000008(value@1000000002 : DateTime) : Text;
    VAR
      DotNetDateTime@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
    BEGIN
      DotNetDateTime := value;
      EXIT(DotNetDateTime.ToString('yyyy-MM-ddTHH\:mm\:ss.fffZ'));
    END;

    PROCEDURE IsoStringToDate@1000000018(value@1000000000 : Text) : Date;
    VAR
      DotNetDateTime@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
      DotNetCultureInfo@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Globalization.CultureInfo" SUPPRESSDISPOSE;
      LocDateTime@1000000003 : DateTime;
    BEGIN
      IF value = '' THEN
        EXIT(0D);

      DotNetDateTime := 0DT;
      LocDateTime := DotNetDateTime.ParseExact(value, 'yyyy-MM-dd', DotNetCultureInfo.InvariantCulture);
      EXIT(DT2DATE(LocDateTime));
    END;

    PROCEDURE DateToIsoString@1000000011(value@1000000002 : Date) : Text;
    VAR
      DotNetDateTime@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
    BEGIN
      DotNetDateTime := DotNetDateTime.DateTime(DATE2DMY(value, 3), DATE2DMY(value, 2), DATE2DMY(value, 1));
      EXIT(DotNetDateTime.ToString('yyyy-MM-dd'));
    END;

    PROCEDURE ExtensionToMime@1000000009(value@1000000000 : Text) : Text;
    BEGIN
      value := LOWERCASE(value);
      CASE value OF
        'jpg'   : EXIT('image/jpeg');
        'jpeg'  : EXIT('image/jpeg');
        'png'   : EXIT('image/png');
        'gif'   : EXIT('image/gif');
        ''      : EXIT('image/jpeg');
      ELSE
        ERROR(Text004, value)
      END;
    END;

    PROCEDURE MimeToExtension@1000000010(value@1000000000 : Text) : Text;
    BEGIN
      value := LOWERCASE(value);
      CASE value OF
        'image/jpg'   : EXIT('jpg');
        'image/jpeg'  : EXIT('jpeg');
        'image/png'   : EXIT('png');
        'image/gif'   : EXIT('gif');
        'jpg'         : EXIT('jpg');
        'jpeg'        : EXIT('jpeg');
        'png'         : EXIT('png');
        'gif'         : EXIT('gif');
        '' : EXIT('jpeg');
      ELSE
        ERROR(Text005, value)
      END;
    END;

    LOCAL PROCEDURE CheckWorkorder@1000000019(VAR LocWO@1000000000 : Record 5092;CheckStatus@1000000001 : Boolean;StatusHasToBe@1000000003 : Text;WrongStatusText@1000000002 : Text);
    BEGIN
      IF NOT LocWO.GET(WO."No.") THEN
        ERROR(Text002, WO."No.");

      IF NOT CheckStatus THEN
        EXIT;

      IF (StatusHasToBe = 'open') AND (NOT CMWoMgt.IsStatusOpen(LocWO)) THEN
        ERROR(Text008, LocWO."No.", LocWO."CM Status", WrongStatusText);
      IF (StatusHasToBe = 'closed') AND (NOT CMWoMgt.IsStatusClosed(LocWO)) THEN
        ERROR(Text008, LocWO."No.", LocWO."CM Status", WrongStatusText);
    END;

    LOCAL PROCEDURE CheckTask@1000000020(VAR LocTask@1000000000 : Record 5080;CheckStatus@1000000001 : Boolean;StatusHasToBe@1000000003 : Text;WrongStatusErrorText@1000000002 : Text);
    BEGIN
      IF (NOT LocTask.GET(T."No.")) OR (LocTask."CM Type" <> LocTask."CM Type"::Task) OR (LocTask."CM Subtype" <> LocTask."CM Subtype"::" ") THEN
        ERROR(Text003, T."No.");

      IF NOT CheckStatus THEN
        EXIT;

      StatusHasToBe := LOWERCASE(StatusHasToBe);
      IF (StatusHasToBe = 'open') AND (NOT CMTaskMgt.IsStatusOpen(LocTask)) THEN
        ERROR(Text009, LocTask."No.", LocTask."CM Status", WrongStatusErrorText);
      IF (StatusHasToBe = 'closed') AND (NOT CMTaskMgt.IsStatusClosed(LocTask)) THEN
        ERROR(Text009, LocTask."No.", LocTask."CM Status", WrongStatusErrorText);
    END;

    LOCAL PROCEDURE CheckTimetrackingObjectDimension@1000000016();
    BEGIN
    END;

    BEGIN
    END.
  }
}

OBJECT XMLport 50006 CMMS Offline App Attach.
{
  OBJECT-PROPERTIES
  {
    Date=19.03.18;
    Time=15:28:09;
    Modified=Yes;
    Version List=CMMS,OSR;
  }
  PROPERTIES
  {
    Direction=Import;
    Encoding=UTF-8;
    DefaultFieldsValidation=No;
    DefaultNamespace=urn:microsoft-dynamics-nav/xmlports/offlineappimagedata;
    UseDefaultNamespace=Yes;
  }
  ELEMENTS
  {
    { [{FCF7C10E-8549-4215-A965-9B22FDAF010C}];  ;ImageData           ;Element ;Text    ;
                                                  VariableName=Data;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{868AD38D-DFF5-4DA9-96AC-A9B6F980825C}];1 ;ImageDataTaskPicture;Element ;Table   ;
                                                  VariableName=TP;
                                                  SourceTable=Table5065;
                                                  SourceTableView=SORTING(Field50000,Field50100,Field50110,Field50200)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field50100=CONST(2),
                                                                        Field50200=CONST(6));
                                                  Temporary=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertTaskPicture();
                                                                               END;
                                                                                }

    { [{4CA9A63E-954B-450C-B824-A4175F1FD21E}];2 ;Identifier          ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TP::CM Identifier }

    { [{154A6E91-CB33-4FE1-8C3D-23C2BAAD81CA}];2 ;ImageData           ;Element ;Text    ;
                                                  TextType=BigText;
                                                  DataType=Text;
                                                  MaxOccurs=Once }

    { [{0367FD20-1DF3-4574-82FE-FAFBE8EF2895}];2 ;ImageType           ;Element ;Text    ;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CMWoMgt@1000000002 : Codeunit 70030;
      CMTaskMgt@1000000004 : Codeunit 70031;
      CMTTMgt@1000000005 : Codeunit 70040;
      CMGenMgt@1000000008 : Codeunit 70000;
      OfflineAppData@1000000003 : XMLport 50005;
      Text001@1000000000 : TextConst 'ENU=Task Picture with identifier "%1" not found.';
      Text002@1000000001 : TextConst 'ENU=Please specify an identifier when separately uploading Task Picture.';

    LOCAL PROCEDURE InsertTaskPicture@1000000000();
    VAR
      TempBlob@1000000000 : TEMPORARY Record 99008535;
      Attachment@1000000001 : Record 5062;
      LogEntry@1000000002 : Record 5065;
    BEGIN
      //Find Log Entry
      IF TP."CM Identifier" = '' THEN
        EXIT;

      LogEntry.RESET;
      LogEntry.SETCURRENTKEY("CM Is CMMS Log Entry","CM No Data","CM Log Type","CM Identifier");
      LogEntry.SETRANGE("CM Is CMMS Log Entry", TRUE);
      LogEntry.SETRANGE("CM Log Type", LogEntry."CM Log Type"::Picture);
      LogEntry.SETRANGE("CM Identifier", TP."CM Identifier");
      IF NOT LogEntry.FINDFIRST() THEN
        ERROR(Text001, TP."CM Identifier");

      //Do not override existing Data.
      IF NOT LogEntry."CM No Data" THEN
        EXIT;

      OfflineAppData.Base64StringToBlob(ImageData, TempBlob);

      LOCKTIMEOUT(FALSE);
      Attachment.LOCKTABLE(TRUE, FALSE); //!!
      Attachment.INIT;
      Attachment.Attachment := TempBlob.Blob;
      Attachment."File Extension" := OfflineAppData.MimeToExtension(ImageType);
      Attachment.INSERT(TRUE);
      LOCKTIMEOUT(TRUE);

      LogEntry."Attachment No." := Attachment."No.";
      LogEntry."CM No Data" := FALSE;
      LogEntry.MODIFY(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT XMLport 50009 CMMS Asset Export
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=10:30:12;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Direction=Export;
    Encoding=UTF-8;
    DefaultFieldsValidation=No;
    DefaultNamespace=urn:microsoft-dynamics-nav/xmlports/assetexport;
    UseDefaultNamespace=Yes;
  }
  ELEMENTS
  {
    { [{FCF7C10E-8549-4215-A965-9B22FDAF010C}];  ;Data                ;Element ;Text    ;
                                                  VariableName=Data;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{E6A4B52C-158B-4E13-A967-7842FDE7E8AD}];1 ;Asset               ;Element ;Table   ;
                                                  VariableName=OBJ;
                                                  SourceTable=Table70020;
                                                  SourceTableView=SORTING(Field90,Field100)
                                                                  WHERE(Field90=CONST(0));
                                                  Temporary=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 LocWO@1000000000 : Record 5092;
                                                                               BEGIN
                                                                               END;

                                                  Export::OnPreXMLItem=VAR
                                                                         Cue@1000000000 : Record 70011;
                                                                       BEGIN
                                                                         IF AssetNoFilter <> '' THEN
                                                                           OBJ.SETFILTER("No.", AssetNoFilter);
                                                                       END;
                                                                        }

    { [{6FA5FAE9-17F1-496A-B892-BCA5A545874E}];2 ;No                  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=OBJ::No. }

    { [{DA2442FA-8A9E-4C27-BECB-0EA29D79D90E}];2 ;Name                ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=OBJ::Name }

    { [{33ACF2DB-DC0E-4F87-9CE7-01FBD92B69D9}];2 ;CapacityDcKwp       ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=OBJ::Capacity DC kWp }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      AssetNoFilter@1000000000 : Text;

    PROCEDURE SetData@1000000000(AssetNoFilter_@1000000000 : Text);
    BEGIN
      AssetNoFilter := AssetNoFilter_;
    END;

    BEGIN
    END.
  }
}

OBJECT XMLport 50012 CMMS Offline App v1
{
  OBJECT-PROPERTIES
  {
    Date=15.05.18;
    Time=14:04:07;
    Modified=Yes;
    Version List=CMMS,OSR;
  }
  PROPERTIES
  {
    Encoding=UTF-8;
    DefaultFieldsValidation=No;
    DefaultNamespace=urn:microsoft-dynamics-nav/xmlports/offlineappdata;
    UseDefaultNamespace=Yes;
    OnPreXMLport=BEGIN
                   IF ISNULL(ImportedWorkorders) THEN ImportedWorkorders := ImportedWorkorders.List();
                 END;

  }
  ELEMENTS
  {
    { [{FCF7C10E-8549-4215-A965-9B22FDAF010C}];  ;Data                ;Element ;Text    ;
                                                  VariableName=Data;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{E6A4B52C-158B-4E13-A967-7842FDE7E8AD}];1 ;Workorder           ;Element ;Table   ;
                                                  VariableName=WO;
                                                  SourceTable=Table5092;
                                                  Temporary=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=VAR
                                                                                 LocWO@1000000000 : Record 5092;
                                                                               BEGIN
                                                                                 //Insert Code
                                                                                 LoadWorkorder(LocWO);
                                                                                 ImportedWorkorders.Add(WO."No.");
                                                                               END;

                                                  Export::OnPreXMLItem=VAR
                                                                         Cue@1000000000 : Record 70011;
                                                                       BEGIN
                                                                         //Cue.SETFILTER("Due Date Filter", '..%1', CALCDATE('<+5D>', TODAY));
                                                                         CMWoMgt.GetWorkorders(WO,'','',USERID,Cue.GETFILTER("Due Date Filter"),'0|1|2|3','','');
                                                                         WO.SETCURRENTKEY("No.");
                                                                         WO.ASCENDING(TRUE);
                                                                       END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             WO.CALCFIELDS("CM Assigned User Name");
                                                                             WOdueDate := DateToIsoString(WO."CM Due Date");
                                                                             WOscheduledDueDate := DateToIsoString(WO."CM Scheduled Due Date");

                                                                             //ExportedWorkorders
                                                                             IF IsUploadResponse THEN BEGIN
                                                                               IF NOT ImportedWorkorders.Contains(WO."No.") THEN
                                                                                 currXMLport.SKIP();
                                                                             END;
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code
                                                                                WOdueDate := '';
                                                                                WOscheduledDueDate := '';
                                                                              END;

                                                  Import::OnBeforeModifyRecord=BEGIN
                                                                                 //Modify Code
                                                                               END;
                                                                                }

    { [{0312BA3E-A6B2-4504-8F1E-43850EF3DFED}];2 ;No                  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=WO::No. }

    { [{53646E29-3F6A-44A2-8D30-FEB390F6FE92}];2 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=WO::Description }

    { [{B0D365B0-00FB-4D07-BD20-CAB0DB41F8FB}];2 ;Status              ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=WO::CM Status }

    { [{17E74762-9024-4A1B-99DF-9964CEB12257}];2 ;Priority            ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=WO::Priority }

    { [{D95C37F5-9216-43BE-A882-46D5E327A2AC}];2 ;AssetNo             ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=WO::CM Object No. }

    { [{59CAD748-88D8-4945-AF44-AB8D85C58F61}];2 ;AssetName           ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=WO::CM Object Name }

    { [{D6B77760-0F01-4259-A719-896C5509DA49}];2 ;DueDate             ;Element ;Text    ;
                                                  VariableName=WOdueDate;
                                                  DataType=Date;
                                                  MaxOccurs=Once }

    { [{8860F213-73AF-432F-BBDA-564EE9BA533D}];2 ;ScheduledDueDate    ;Element ;Text    ;
                                                  VariableName=WOscheduledDueDate;
                                                  DataType=Date;
                                                  MaxOccurs=Once }

    { [{466BD4BF-AFE2-4985-A338-0D7129E014EE}];2 ;AssignedUserId      ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=WO::CM Assigned User ID }

    { [{7A17169A-F993-48BC-968C-725A630043E7}];2 ;AssignedUserName    ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=WO::CM Assigned User Name }

    { [{07D43EAD-1F02-49AA-9D6B-486ECB4C1E9A}];2 ;ReferenceElementName;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=WO::CM GPM Reference Element Name }

    { [{914DD397-7103-4A08-B81D-AA20390B404F}];2 ;WorkorderComment    ;Element ;Table   ;
                                                  VariableName=WOC;
                                                  SourceTable=Table5065;
                                                  SourceTableView=SORTING(Field50000,Field50100,Field50110,Field50200)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field50100=CONST(1),
                                                                        Field50200=CONST(4),
                                                                        Field52010=CONST(No));
                                                  LinkFields=Field44=FIELD(Field1),
                                                             Field50110=FIELD(Field1);
                                                  LinkTable=WO;
                                                  Temporary=No;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 //InsertWorkorderComment();
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Export Code
                                                                             WOCcreatedDatetime := DateTimeToIsoString(WOC."CM Created Datetime");
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code
                                                                                WOCcreatedDatetime := '';
                                                                              END;
                                                                               }

    { [{1CA42A77-AFDE-449D-AD64-751B56666456}];3 ;Id                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=WOC::Entry No.;
                                                  MinOccurs=Zero }

    { [{4CABE5D6-B5BD-4C61-B6A6-B0AF37ADD187}];3 ;UserId              ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=WOC::User ID;
                                                  MinOccurs=Zero }

    { [{F56F7CAB-3678-4BB3-B695-CC874962DBCB}];3 ;CreatedDatetime     ;Element ;Text    ;
                                                  VariableName=WOCcreatedDatetime;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{1AF65B02-EB71-4AF3-93A9-50F73811CD2B}];3 ;Internal            ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=WOC::CM Internal;
                                                  MinOccurs=Zero }

    { [{45A4A0BD-FA40-4EE2-BE5D-21046E1524A0}];3 ;CommentText         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=WOC::CM Comment;
                                                  MinOccurs=Zero }

    { [{611CBEC7-893E-4D09-82D7-F8AF94D8EE8C}];2 ;Task                ;Element ;Table   ;
                                                  VariableName=T;
                                                  SourceTable=Table5080;
                                                  SourceTableView=SORTING(Field50000,Field6,Field1)
                                                                  WHERE(Field50000=CONST(1),
                                                                        Field50090=CONST(0));
                                                  LinkFields=Field6=FIELD(Field1);
                                                  LinkTable=WO;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertUpdateTask();
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Export Code
                                                                             T.CALCFIELDS("CM Assigned User Name");
                                                                             TcreatedDatetime := DateTimeToIsoString(T."CM Created Datetime");
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code (after all Child Items are processed we do Status Changes);
                                                                                AfterInsertUpdateTask();
                                                                                TaskIsNew := FALSE;
                                                                                TaskInsertedUpdated := FALSE;
                                                                                TcreatedDatetime := '';
                                                                              END;
                                                                               }

    { [{6408A217-5146-4805-B38E-FCD9DA0C9A2F}];3 ;No                  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=T::No.;
                                                  MinOccurs=Zero }

    { [{4E8D9A43-DD70-4FC1-9F28-20410C0F5EF8}];3 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=T::Description;
                                                  MinOccurs=Zero }

    { [{F0B4F41A-D02A-4058-979D-733CCD9062A5}];3 ;Description2        ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=T::CM Extended Description;
                                                  MinOccurs=Zero }

    { [{9F09F1C5-4600-48EF-9220-1F9390288D92}];3 ;Status              ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=T::CM Status;
                                                  MinOccurs=Zero }

    { [{5953D954-7DB1-416C-9184-5AAE2EDA5AFA}];3 ;Internal            ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=T::CM Internal;
                                                  MinOccurs=Zero }

    { [{5283D43B-3C9E-48C4-BD24-C2451BA07EBA}];3 ;CreatedDatetime     ;Element ;Text    ;
                                                  VariableName=TcreatedDatetime;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{7C916F98-4654-402E-BF3A-65D60689E9E2}];3 ;AssignedUserId      ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=T::CM Assigned User ID;
                                                  MinOccurs=Zero }

    { [{F21425E2-B165-41E1-9468-93FFB5CF6405}];3 ;AssignedUserName    ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=T::CM Assigned User Name;
                                                  MinOccurs=Zero }

    { [{2068A6DA-4D62-4337-BFB0-46E354F11440}];3 ;TaskComment         ;Element ;Table   ;
                                                  VariableName=TC;
                                                  SourceTable=Table5065;
                                                  SourceTableView=SORTING(Field50000,Field50100,Field50110,Field50200)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field50100=CONST(2),
                                                                        Field50200=CONST(4),
                                                                        Field52010=CONST(No));
                                                  LinkFields=Field23=FIELD(Field1),
                                                             Field50110=FIELD(Field1);
                                                  LinkTable=T;
                                                  Temporary=No;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertUpdateTask();
                                                                                 InsertTaskComment();
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Export Code
                                                                             TCcreatedDatetime := DateTimeToIsoString(TC."CM Created Datetime");
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code
                                                                                TCcreatedDatetime := '';
                                                                              END;
                                                                               }

    { [{ABF3D0B6-D053-4511-92A7-7400BBCC4613}];4 ;Id                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=TC::Entry No.;
                                                  MinOccurs=Zero }

    { [{D54696A0-A5D2-4C08-801A-C46E2817214C}];4 ;UserId              ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=TC::User ID;
                                                  MinOccurs=Zero }

    { [{D535C0B1-3C99-45D2-AC08-E8B3738C5F0D}];4 ;CreatedDatetime     ;Element ;Text    ;
                                                  VariableName=TCcreatedDatetime;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{155804C7-3C76-45F8-AAB6-F31D76D6DE4E}];4 ;Internal            ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=TC::CM Internal;
                                                  MinOccurs=Zero }

    { [{61417CB2-9F51-4CCA-A5C3-1720A4C5A081}];4 ;CommentText         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TC::CM Comment }

    { [{868AD38D-DFF5-4DA9-96AC-A9B6F980825C}];3 ;TaskAttachment      ;Element ;Table   ;
                                                  VariableName=TA;
                                                  SourceTable=Table5065;
                                                  SourceTableView=SORTING(Field50000,Field50100,Field50110,Field50200)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field50100=CONST(2),
                                                                        Field50200=FILTER(6|7),
                                                                        Field52010=CONST(No));
                                                  LinkFields=Field23=FIELD(Field1),
                                                             Field50110=FIELD(Field1);
                                                  LinkTable=T;
                                                  Temporary=No;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertUpdateTask();
                                                                                 InsertTaskAttachment();
                                                                               END;

                                                  Export::OnAfterGetRecord=VAR
                                                                             Attachment@1000000001 : Record 5062;
                                                                             TempBlob@1000000000 : TEMPORARY Record 99008535;
                                                                           BEGIN
                                                                             //Export Code
                                                                             CLEAR(TAData);
                                                                             IF (TA."Attachment No." > 0) AND (Attachment.GET(TA."Attachment No.")) THEN BEGIN
                                                                               Attachment.CALCFIELDS(Attachment);

                                                                               TAFileExtension := Attachment."File Extension";

                                                                               IF (Attachment.Attachment.HASVALUE) AND (NOT IsUploadResponse) THEN BEGIN
                                                                                 TempBlob.INIT;
                                                                                 TempBlob.Blob := Attachment.Attachment;

                                                                                 TAData.ADDTEXT(TempBlobToBase64String(TempBlob));
                                                                               END;
                                                                             END;

                                                                             TAcreatedDatetime := DateTimeToIsoString(TA."CM Created Datetime");
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code
                                                                                CLEAR(TAData);
                                                                                TAFileExtension := '';
                                                                                TAcreatedDatetime := '';
                                                                              END;
                                                                               }

    { [{28807B26-64B1-4180-93BE-8433AFA91539}];4 ;Id                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=TA::Entry No.;
                                                  MinOccurs=Zero }

    { [{C29DD94B-9BF5-4CDF-96F0-BD0A3BC39B60}];4 ;UserId              ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=TA::User ID;
                                                  MinOccurs=Zero }

    { [{65AE400C-A001-429D-B273-5FBB73C117BD}];4 ;CreatedDatetime     ;Element ;Text    ;
                                                  VariableName=TAcreatedDatetime;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{154A6E91-CB33-4FE1-8C3D-23C2BAAD81CA}];4 ;Data                ;Element ;Text    ;
                                                  VariableName=TAData;
                                                  TextType=BigText;
                                                  DataType=Text;
                                                  MaxOccurs=Once }

    { [{39F142F9-77D8-4055-B6E3-4A0606E340AA}];4 ;FileExtension       ;Element ;Text    ;
                                                  VariableName=TAFileExtension;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Width=50 }

    { [{7D28FC95-0BB3-46E6-8AF1-D7EF8E225EEA}];4 ;FileName            ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TA::Description;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{809462E0-8CF0-473B-BCF8-7BC26454CDC6}];4 ;NoData              ;Element ;Field   ;
                                                  DataType=Boolean;
                                                  SourceField=TA::CM No Data;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{4CA9A63E-954B-450C-B824-A4175F1FD21E}];4 ;Identifier          ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TA::CM Identifier;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{9380EBFC-1955-446D-9BAD-5FFC8BD44A1E}];4 ;CommentText         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TA::CM Comment;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

    { [{4715521C-6869-4509-9AF5-5E5F55ACA7B0}];3 ;TaskTimeTrackingEntry;Element;Table   ;
                                                  VariableName=TTE;
                                                  SourceTable=Table952;
                                                  SourceTableView=SORTING(Field50000,Field50300)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field3=CONST(),
                                                                        Field1=CONST());
                                                  LinkFields=Field50300=FIELD(Field1);
                                                  LinkTable=T;
                                                  Temporary=No;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertUpdateTask();
                                                                                 InsertTaskTimeTrackingEntry();
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Export Code
                                                                             TTEcreatedDatetime := DateTimeToIsoString(TTE."CM Posted Datetime");
                                                                             TTEentryDate := DateToIsoString(TTE."CM Entry Date");
                                                                           END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code
                                                                                TTEcreatedDatetime := '';
                                                                                TTEentryDate := '';
                                                                              END;
                                                                               }

    { [{4FC655C1-9FC3-43BD-9DB0-6B617A011DB6}];4 ;Id                  ;Element ;Field   ;
                                                  DataType=Integer;
                                                  SourceField=TTE::Time Sheet Line No.;
                                                  MinOccurs=Zero }

    { [{D9570676-A16E-4519-A7A3-2C268280B431}];4 ;UserId              ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=TTE::CM Posted By User ID;
                                                  MinOccurs=Zero }

    { [{FA4706EC-B9E6-4984-9895-0E2CD31BDB9F}];4 ;EntryDate           ;Element ;Text    ;
                                                  VariableName=TTEentryDate;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{E86FF228-8096-4DDA-ABB9-58F4F75E5FE8}];4 ;CreatedDatetime     ;Element ;Text    ;
                                                  VariableName=TTEcreatedDatetime;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{55BB1C0A-84C1-4136-8096-381A1786F772}];4 ;Quantity            ;Element ;Field   ;
                                                  DataType=Decimal;
                                                  SourceField=TTE::CM Quantity;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{CDACFF99-A627-4410-92CB-6559F9DD4C7B}];3 ;TaskChecklistEntry  ;Element ;Table   ;
                                                  VariableName=TCE;
                                                  SourceTable=Table5080;
                                                  SourceTableView=SORTING(Field50000,Field50090,Field50210,Field1)
                                                                  WHERE(Field50000=CONST(1),
                                                                        Field50090=CONST(1));
                                                  LinkFields=Field50210=FIELD(Field1);
                                                  LinkTable=T;
                                                  Temporary=No;
                                                  LinkTableForceInsert=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Zero;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertUpdateTask();
                                                                                 UpdateChecklistItem();
                                                                               END;

                                                  Export::OnAfterGetRecord=BEGIN
                                                                             //Export Code
                                                                             TCE."CM Checklist Status (Helper)" := TCE."CM Status";
                                                                           END;
                                                                            }

    { [{22E0E1E5-C8A5-4E24-B82C-C16B02F53B0C}];4 ;No                  ;Element ;Field   ;
                                                  DataType=Code;
                                                  SourceField=TCE::No.;
                                                  MinOccurs=Zero }

    { [{B78843C9-F894-44CA-A737-7D632F75B90C}];4 ;Description         ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TCE::Description;
                                                  MinOccurs=Zero }

    { [{ADDB5DFB-3E71-484A-AAC8-4CCA42EC09E9}];4 ;Status              ;Element ;Field   ;
                                                  DataType=Option;
                                                  SourceField=TCE::CM Checklist Status (Helper);
                                                  MinOccurs=Zero }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CMWoMgt@1000000002 : Codeunit 70030;
      CMTaskMgt@1000000004 : Codeunit 70031;
      CMTTMgt@1000000005 : Codeunit 70040;
      Text002@1000000006 : TextConst 'ENU=Cannot synchronize Workorder "%1", because Workorder was not found in CMMS.';
      Text003@1000000007 : TextConst 'ENU=Cannot synchronize Task "%1", because Task was not found in CMMS.';
      CMGenMgt@1000000008 : Codeunit 70000;
      LogEntry@1000000009 : Record 5065;
      TaskInsertedUpdated@1000000010 : Boolean;
      Text008@1000000012 : TextConst 'ENU=%3 CMMS Status of Workorder "%1" is "%2".';
      Text009@1000000013 : TextConst 'ENU=%3 CMMS Status of Task "%1" is "%2".';
      Text010@1000000020 : TextConst 'ENU=Cannot create Workorder Comment for Workorder "%1"';
      Text011@1000000015 : TextConst 'ENU=Cannot add Picture/Attachment for Task "%1". No Identifier was specified.';
      Text012@1000000014 : TextConst 'ENU=Cannot add new Task because';
      Text013@1000000016 : TextConst 'ENU=Cannot change Task "%1" because';
      Text016@1000000019 : TextConst 'ENU=Task Time Tracking Entry cannot be created';
      Text017@1000000021 : TextConst 'ENU=Task Checklist Entry status cannot be changed to "%1"';
      TaskIsNew@1000000023 : Boolean;
      Text018@1000000024 : TextConst 'ENU=%5. CMMS Status of Workorder "%1" ist "%2" and CMMS Status of Task "%3" is "%4".';
      IsUploadResponse@1000000003 : Boolean;
      ImportedWorkorders@1000000011 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.Generic.List`1";
      Text019@1000000017 : TextConst 'ENU=Cannot add or update Picture/Attachment for Task "%1". Invalid Mime Type "%2".';
      Text020@1000000018 : TextConst 'ENU=Cannot add Time Tracking Entry on Task "%1" because the corresponding Asset/Project "%1" is blocked CMMS!';

    PROCEDURE SetData@1000000015(IsUploadResponse_@1000000000 : Boolean;ImportedWorkorders_@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.Generic.List`1");
    BEGIN
      IsUploadResponse := IsUploadResponse_;
      ImportedWorkorders := ImportedWorkorders_;
    END;

    PROCEDURE GetData@1000000023(VAR ImportedWorkorders_@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Collections.Generic.List`1");
    BEGIN
      ImportedWorkorders_ := ImportedWorkorders;
    END;

    LOCAL PROCEDURE "###LOCAL####"@1000000012();
    BEGIN
    END;

    LOCAL PROCEDURE InsertUpdateTask@1000000000();
    VAR
      LocTask@1000000000 : Record 5080;
      LocWO@1000000001 : Record 5092;
    BEGIN
      IF TaskInsertedUpdated THEN
        EXIT;

      T."CM Created Datetime" := IsoStringToDateTime(TcreatedDatetime);

      //Insert Code
      IF (T."No." = '') THEN BEGIN
        TaskIsNew := TRUE;
        LoadWorkorder(LocWO);
        IF NOT CMWoMgt.IsStatusOpen(LocWO) THEN
          ERROR_(STRSUBSTNO(Text008, LocWO."No.", LocWO."CM Status", Text012), WO."No.", '', 0, 0, 0, '');

        CMTaskMgt.NewTaskToWorkorder(LocWO, LocTask, FALSE, FALSE);
        LocTask.Description := T.Description;
        LocTask."CM Extended Description" := T."CM Extended Description";
        LocTask."CM Internal" := LocTask."CM Internal";
        LocTask."CM Created Datetime" := T."CM Created Datetime";
        LocTask.INSERT(TRUE);
        //Task Status is changed after all Child notes are processed, so we habe two log entries - create and change status.

        TaskInsertedUpdated := TRUE;
        T."No." := LocTask."No.";
      END;

      //Update Code
      IF T."No." <> '' THEN BEGIN
        //Task Status is changed after all Child notes are processed, so we habe two log entries - create and change status.
        //Task Data cannot be edited
      END;
    END;

    LOCAL PROCEDURE AfterInsertUpdateTask@1000000017();
    VAR
      LocTask@1000000000 : Record 5080;
      LocWO@1000000001 : Record 5092;
    BEGIN
      //New Task
      IF (TaskIsNew) THEN BEGIN
        IF CMTaskMgt.IsStatusClosed(T) THEN BEGIN //New Task is immediately closed
          LoadTask(LocTask, WO."No.");

          LocTask."CM Status" := T."CM Status";
          CMGenMgt.CreateLogEntry(LocTask,LogEntry."CM Log Type"::"Status Change",FORMAT(LocTask."CM Status"), '');
        END;
      END;

      //Existing Task
      IF NOT TaskIsNew THEN BEGIN
        LoadTask(LocTask, WO."No.");
        IF (T."CM Status" <> LocTask."CM Status") THEN BEGIN //Status has changed.
          LoadWorkorder(LocWO);

          IF CMWoMgt.IsStatusOpen(LocWO) THEN BEGIN
            IF NOT CMTaskMgt.IsStatusOpen(LocTask) THEN
              ERROR_(STRSUBSTNO(Text009, LocTask."No.", LocTask."CM Status", Text013), LocWO."No.", LocTask."No.", 0, 0, 0, '');
          END;
          IF CMWoMgt.IsStatusClosed(LocWO) THEN BEGIN
            IF NOT ((CMTaskMgt.IsStatusClosed(T)) AND (LocTask."CM Status" = LocTask."CM Status"::Closed)) THEN
              ERROR_(STRSUBSTNO(Text018, LocWO."No.", LocWO."CM Status", LocTask."No.", LocTask."CM Status", STRSUBSTNO(Text013, T."No.")), LocWO."No.", LocTask."No.", 0, 0, 0, '');
          END;

          LocTask."CM Status" := T."CM Status";
          CMGenMgt.CreateLogEntry(LocTask,LogEntry."CM Log Type"::"Status Change",FORMAT(LocTask."CM Status"), '');
          LocTask.MODIFY(FALSE);
        END;
      END;
    END;

    LOCAL PROCEDURE InsertWorkorderComment@1000000001();
    VAR
      LocWO@1000000000 : Record 5092;
      Id@1000000001 : Integer;
    BEGIN
      IF WOC."Entry No." = 0 THEN BEGIN
        //Not available (yet)
        {
        CheckWorkorder(LocWO, TRUE, 'open', Text010);
        WOC."CM Created Datetime" := IsoStringToDateTime(WOCcreatedDatetime);

        Id := CMGenMgt.CreateLogEntryComment(LocWO, WOC."CM Internal", WOC."CM Comment");
        LogEntry.GET(Id);
        LogEntry."CM Created Datetime" := WOC."CM Created Datetime";
        LogEntry.MODIFY(FALSE);
        }
      END;
    END;

    LOCAL PROCEDURE InsertTaskComment@1000000002();
    VAR
      LocTask@1000000000 : Record 5080;
      LocWO@1000000002 : Record 5092;
      Id@1000000001 : Integer;
    BEGIN
      IF TC."Entry No." = 0 THEN BEGIN
        LoadTask(LocTask, WO."No.");

        TC."CM Created Datetime" := IsoStringToDateTime(TCcreatedDatetime);

        Id := CMGenMgt.CreateLogEntryComment(LocTask, TC."CM Internal", TC."CM Comment");
        LogEntry.GET(Id);
        LogEntry."CM Created Datetime" := TC."CM Created Datetime";
        LogEntry.MODIFY();
      END;
    END;

    LOCAL PROCEDURE InsertTaskAttachment@1000000003();
    VAR
      LocTask@1000000000 : Record 5080;
      LocWO@1000000004 : Record 5092;
      Id@1000000001 : Integer;
      LocTempAttachment@1000000002 : TEMPORARY Record 5062;
      TempBlob@1000000003 : TEMPORARY Record 99008535;
    BEGIN
      IF TA."Entry No." = 0 THEN BEGIN
        LoadWorkorder(LocWO);
        LoadTask(LocTask, WO."No.");

        TA."CM Created Datetime" := IsoStringToDateTime(TAcreatedDatetime);
        TA."CM Log Type" := ExtensionToLogType(TAFileExtension);

        CLEAR(LocTempAttachment);
        IF TA."CM No Data" THEN BEGIN //Has NO Data

          IF TA."CM Identifier" = '' THEN
            ERROR_(STRSUBSTNO(Text011, LocTask."No."), LocWO."No.", LocTask."No.", 0, 0, 0, '');

          LocTempAttachment.INIT;
          LocTempAttachment."No." := -1;
          CMGenMgt.SetAttachment(LocTempAttachment);
          IF TA."CM Log Type" = TA."CM Log Type"::Picture THEN
            Id := CMGenMgt.CreateLogEntryPhoto(LocTask, TA."CM Comment")
          ELSE
            Id := CMGenMgt.CreateLogEntryAttachment(LocTask, TA."CM Comment");
          CMGenMgt.UnsetAttachment();
          LogEntry.GET(Id);

          //Change Log Entry
          LogEntry.Description := TA.Description; //Filename
          LogEntry."CM Identifier" := TA."CM Identifier";
          LogEntry."CM No Data" := TRUE;
          LogEntry.MODIFY(FALSE);
        END
        ELSE BEGIN //Has data
          Base64StringToBlob(TAData, TempBlob);
          LocTempAttachment.INIT;
          LocTempAttachment.Attachment := TempBlob.Blob;
          LocTempAttachment."File Extension" := TAFileExtension;
          LocTempAttachment.INSERT(TRUE);
          LocTempAttachment.CALCFIELDS(Attachment);

          CMGenMgt.SetAttachment(LocTempAttachment);
          IF TA."CM Log Type" = TA."CM Log Type"::Picture THEN
            Id := CMGenMgt.CreateLogEntryPhoto(LocTask, TA."CM Comment")
          ELSE
            Id := CMGenMgt.CreateLogEntryAttachment(LocTask, TA."CM Comment");
          CMGenMgt.UnsetAttachment();
          LogEntry.GET(Id);
        END;

        //Change Log Entry
        LogEntry.Description := TA.Description; //Filename
        LogEntry."CM Identifier" := TA."CM Identifier";
        LogEntry."CM Created Datetime" := TA."CM Created Datetime";
        LogEntry.MODIFY(FALSE);
      END;
    END;

    LOCAL PROCEDURE InsertTaskTimeTrackingEntry@1000000004();
    VAR
      LocTask@1000000000 : Record 5080;
      LocWO@1000000002 : Record 5092;
    BEGIN
      IF TTE."Time Sheet Line No." = 0 THEN BEGIN
        IF TTE."CM Quantity" > 0 THEN BEGIN
          LoadTask(LocTask, WO."No.");
          CheckDimBlocked(LocTask);

          TTE."CM Posted Datetime" := IsoStringToDateTime(TTEcreatedDatetime);
          TTE."CM Entry Date" := IsoStringToDate(TTEentryDate);

          CMTTMgt.SetOsrFlag(TRUE);
          CMTTMgt.PostFromTask(LocTask, TTE."CM Quantity", TTE."CM Entry Date", TTE."CM Posted Datetime");
        END;
      END;
    END;

    LOCAL PROCEDURE UpdateChecklistItem@1000000014();
    VAR
      TaskCheckListItem@1000000000 : Record 5080;
      LocWO@1000000001 : Record 5092;
    BEGIN
      TCE."CM Status" := TCE."CM Checklist Status (Helper)";

      IF TCE."No." = '' THEN BEGIN
        //No Insert allowed
        {
        TaskCheckListItem.INIT;
        TaskCheckListItem.TRANSFERFIELDS(TCE, FALSE);
        TaskCheckListItem."CM Type" := TaskCheckListItem."CM Type"::Task;
        TaskCheckListItem."CM Subtype" := TaskCheckListItem."CM Subtype"::Checklist;
        TaskCheckListItem."CM Maintask No." := T."No.";
        TaskCheckListItem.INSERT(TRUE);
        }
      END
      ELSE BEGIN
        TaskCheckListItem.GET(TCE."No.");
        IF TaskCheckListItem."CM Status" <> TCE."CM Status" THEN BEGIN
          //CheckWorkorder(LocWO, TRUE, 'open', STRSUBSTNO(Text017, TCE."CM Checklist Status (Helper)"));

          TaskCheckListItem."CM Status" := TCE."CM Status";
          TaskCheckListItem."CM Checklist Status (Helper)" := TCE."CM Checklist Status (Helper)";
          CMGenMgt.CreateLogEntry(TaskCheckListItem, LogEntry."CM Log Type"::"Status Change", FORMAT(TaskCheckListItem."CM Checklist Status (Helper)"), '');
          TaskCheckListItem.MODIFY(TRUE);
        END;
      END;
    END;

    PROCEDURE "###GLOBAL###"@1000000013();
    BEGIN
    END;

    PROCEDURE Base64StringToBlob@1000000007(VAR Base64String@1000000005 : BigText;VAR TempBlob@1000000000 : TEMPORARY Record 99008535);
    VAR
      DotNetConvert@1000000004 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Convert" SUPPRESSDISPOSE;
      DotNetMemoryStream@1000000003 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.MemoryStream" SUPPRESSDISPOSE;
      DotNetByteArray@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array" SUPPRESSDISPOSE;
      OutStr@1000000001 : OutStream;
      Base64Text@1000000007 : Text;
    BEGIN
      CLEAR(TempBlob.Blob);
      TempBlob.INIT;

      Base64String.GETSUBTEXT(Base64Text, 1);
      DotNetByteArray := DotNetConvert.FromBase64String(Base64String);

      TempBlob.Blob.CREATEOUTSTREAM(OutStr);
      DotNetMemoryStream := DotNetMemoryStream.MemoryStream(DotNetByteArray);
      DotNetMemoryStream.WriteTo(OutStr);
      DotNetMemoryStream.Close();

      TempBlob.INSERT();
      TempBlob.CALCFIELDS(Blob);
    END;

    PROCEDURE TempBlobToBase64String@1000000005(VAR TempBlob@1000000000 : TEMPORARY Record 99008535) : Text;
    VAR
      DotNetConvert@1000000004 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Convert" SUPPRESSDISPOSE;
      DotNetMemoryStream@1000000003 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.MemoryStream" SUPPRESSDISPOSE;
      DotNetByteArray@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array" SUPPRESSDISPOSE;
      InStr@1000000001 : InStream;
    BEGIN
      //TempBlob.CALCFIELDS(Blob);
      IF NOT TempBlob.Blob.HASVALUE THEN
        EXIT('');

      TempBlob.Blob.CREATEINSTREAM(InStr);

      DotNetMemoryStream := DotNetMemoryStream.MemoryStream();
      COPYSTREAM(DotNetMemoryStream, InStr);
      DotNetByteArray := DotNetMemoryStream.ToArray();
      DotNetMemoryStream.Close();

      EXIT(DotNetConvert.ToBase64String(DotNetByteArray));
    END;

    PROCEDURE IsoStringToDateTime@1000000006(value@1000000000 : Text) : DateTime;
    VAR
      DotNetDateTime@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
      DotNetCultureInfo@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Globalization.CultureInfo" SUPPRESSDISPOSE;
    BEGIN
      IF value = '' THEN
        EXIT(0DT);

      DotNetDateTime := 0DT;
      EXIT(DotNetDateTime.ParseExact(value, 'yyyy-MM-ddTHH\:mm\:ss.fffZ', DotNetCultureInfo.InvariantCulture));
    END;

    PROCEDURE DateTimeToIsoString@1000000008(value@1000000002 : DateTime) : Text;
    VAR
      DotNetDateTime@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
    BEGIN
      DotNetDateTime := value;
      EXIT(DotNetDateTime.ToString('yyyy-MM-ddTHH\:mm\:ss.fffZ'));
    END;

    PROCEDURE IsoStringToDate@1000000018(value@1000000000 : Text) : Date;
    VAR
      DotNetDateTime@1000000002 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
      DotNetCultureInfo@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Globalization.CultureInfo" SUPPRESSDISPOSE;
      LocDateTime@1000000003 : DateTime;
    BEGIN
      IF value = '' THEN
        EXIT(0D);

      DotNetDateTime := 0DT;
      LocDateTime := DotNetDateTime.ParseExact(value, 'yyyy-MM-dd', DotNetCultureInfo.InvariantCulture);
      EXIT(DT2DATE(LocDateTime));
    END;

    PROCEDURE DateToIsoString@1000000011(value@1000000002 : Date) : Text;
    VAR
      DotNetDateTime@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.DateTime" SUPPRESSDISPOSE;
    BEGIN
      DotNetDateTime := DotNetDateTime.DateTime(DATE2DMY(value, 3), DATE2DMY(value, 2), DATE2DMY(value, 1));
      EXIT(DotNetDateTime.ToString('yyyy-MM-dd'));
    END;

    LOCAL PROCEDURE CheckDimBlocked@1000000026(Task@1000000000 : Record 5080);
    VAR
      CMGenMgt@1000000002 : Record 70000;
      DimValue@1000000003 : Record 349;
      LocWo@1000000001 : Record 5092;
    BEGIN
      IF NOT CMGenMgt.GET() THEN
        CMGenMgt.INIT;

      IF NOT LocWo.GET(Task."Opportunity No.") OR (LocWo."CM Object No." = '') THEN
        EXIT;

      IF LocWo."CM Objecttype" = LocWo."CM Objecttype"::Asset THEN BEGIN
        IF (NOT DimValue.GET(CMGenMgt."Asset Dimension Code", LocWo."CM Object No.")) OR (DimValue.Blocked) THEN
          ERROR_(STRSUBSTNO(Text020, Task."No.", LocWo."CM Object No."), LocWo."No.", Task."No.", 0, 0, 0, '');
      END;

      IF LocWo."CM Objecttype" = LocWo."CM Objecttype"::Project THEN BEGIN
        IF (NOT DimValue.GET(CMGenMgt."Project Dimension Code", LocWo."CM Object No.")) OR (DimValue.Blocked) THEN
          ERROR_(STRSUBSTNO(Text020, Task."No.", LocWo."CM Object No."), LocWo."No.", Task."No.", 0, 0, 0, '');
      END;
    END;

    PROCEDURE ExtensionToLogType@1000000016(value@1000000000 : Text) : Integer;
    VAR
      LocLogEntry@1000000001 : Record 5065;
    BEGIN
      value := LOWERCASE(value);
      IF value IN ['png','jpg','jpeg','gif','bmp','tiff','tif'] THEN
        EXIT(LocLogEntry."CM Log Type"::Picture);
      EXIT(LocLogEntry."CM Log Type"::Attachment);
    END;

    PROCEDURE "###LOCAL###"@1000000027();
    BEGIN
    END;

    LOCAL PROCEDURE LoadWorkorder@1000000019(VAR LocWO@1000000000 : Record 5092);
    BEGIN
      IF NOT LocWO.GET(WO."No.") THEN
        ERROR_(Text002, WO."No.", '', 0, 0, 0, ''); //ERROR(Text002, WO."No.");
    END;

    LOCAL PROCEDURE LoadTask@1000000020(VAR LocTask@1000000000 : Record 5080;WorkorderNo@1000000001 : Code[20]);
    BEGIN
      IF (NOT LocTask.GET(T."No.")) OR (LocTask."CM Type" <> LocTask."CM Type"::Task) OR (LocTask."CM Subtype" <> LocTask."CM Subtype"::" ") THEN
        ERROR_(STRSUBSTNO(Text003, T."No."), WorkorderNo, T."No.", 0, 0, 0, '');
    END;

    PROCEDURE ERROR_@1000000009(ErrorMessage@1000000001 : Text;Workorder@1000000003 : Code[20];Task@1000000004 : Code[20];TaskComment@1000000009 : Integer;TaskAttachment@1000000005 : Integer;TaskTimetrackingEntry@1000000006 : Integer;TaskChecklistEntry@1000000007 : Code[20]);
    VAR
      Result@1000000008 : Text;
    BEGIN
      Result += XmlTag('Message', ErrorMessage, TRUE);
      Result += XmlTag('Workorder', Workorder, TRUE);
      Result += XmlTag('Task', Task, TRUE);
      Result += XmlTag('TaskComment', FORMAT(TaskComment), TRUE);
      Result += XmlTag('TaskAttachment', FORMAT(TaskAttachment), TRUE);
      Result += XmlTag('TaskTimetrackingEntry', FORMAT(TaskTimetrackingEntry), TRUE);
      Result += XmlTag('TaskChecklistEntry', TaskChecklistEntry, TRUE);

      Result := XmlTag('Error', Result, FALSE);
      ERROR(Result);
    END;

    LOCAL PROCEDURE XmlTag@1000000010(key@1000000000 : Text;value@1000000001 : Text;escape@1000000002 : Boolean) : Text;
    BEGIN
      IF escape THEN BEGIN
        XmlEscape(value);
        XmlEscape(key);
      END;

      EXIT(STRSUBSTNO('<%1>%2</%1>', key, value));
    END;

    LOCAL PROCEDURE XmlEscape@1000000022(VAR value@1000000000 : Text);
    VAR
      DotNetString@1000000001 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.String" SUPPRESSDISPOSE;
      apos@1000000002 : TextConst 'ENU=''';
      SecurityElement@1000000003 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Security.SecurityElement" SUPPRESSDISPOSE;
    BEGIN
      {DotNetString := value;
      DotNetString := DotNetString.Replace('"', '&quot;');
      DotNetString := DotNetString.Replace(apos, '&quot;');
      DotNetString := DotNetString.Replace('<', '&lt;');
      DotNetString := DotNetString.Replace('>', '&gt;');
      DotNetString := DotNetString.Replace('&', '&amp;');
      value := DotNetString.ToString();}

      value := SecurityElement.Escape(value);
    END;

    LOCAL PROCEDURE StringSplit@1000000043(Input@1000000000 : Text;SplitChars@1000000001 : Text;VAR ResultArray64@1000000002 : ARRAY [64] OF Text) : Integer;
    VAR
      pos@1000000003 : Integer;
      c@1000000004 : Integer;
      max@1000000005 : Integer;
      splitlen@1000000006 : Integer;
    BEGIN
      CLEAR(ResultArray64);
      IF (Input = '') OR (SplitChars = '') THEN
        EXIT(0);

      splitlen := STRLEN(SplitChars);
      max := ARRAYLEN(ResultArray64);
      c := 0;

      REPEAT
        pos := STRPOS(Input, SplitChars);

        IF pos <> 0 THEN BEGIN
          c += 1;
          ResultArray64[c] := COPYSTR(Input, 1, pos - 1);
          Input := COPYSTR(Input, pos + splitlen);
        END
        ELSE BEGIN
          IF Input <> '' THEN BEGIN
            c += 1;
            ResultArray64[c] := Input;
          END;
        END;
      UNTIL (pos = 0) OR (c = max);

      EXIT(c);
    END;

    BEGIN
    END.
  }
}

OBJECT XMLport 50013 CMMS Offline App Attach. v1
{
  OBJECT-PROPERTIES
  {
    Date=15.05.18;
    Time=12:52:41;
    Modified=Yes;
    Version List=CMMS,OSR;
  }
  PROPERTIES
  {
    Direction=Import;
    Encoding=UTF-8;
    DefaultFieldsValidation=No;
    DefaultNamespace=urn:microsoft-dynamics-nav/xmlports/offlineappattachment;
    UseDefaultNamespace=Yes;
  }
  ELEMENTS
  {
    { [{FCF7C10E-8549-4215-A965-9B22FDAF010C}];  ;DataSeparateUpload  ;Element ;Text    ;
                                                  VariableName=DataAttachment;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once }

    { [{868AD38D-DFF5-4DA9-96AC-A9B6F980825C}];1 ;TaskAttachmentSeparateUpload;Element;Table;
                                                  VariableName=TA;
                                                  SourceTable=Table5065;
                                                  SourceTableView=SORTING(Field50000,Field50100,Field50110,Field50200)
                                                                  WHERE(Field50000=CONST(Yes),
                                                                        Field50100=CONST(2),
                                                                        Field50200=CONST(6));
                                                  Temporary=No;
                                                  AutoSave=No;
                                                  AutoUpdate=No;
                                                  AutoReplace=No;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Import::OnBeforeInsertRecord=BEGIN
                                                                                 //Insert Code
                                                                                 InsertTaskAttachment();
                                                                               END;

                                                  Import::OnAfterInsertRecord=BEGIN
                                                                                //After Insert Code
                                                                                CLEAR(TAData);
                                                                                TAFileExtension := '';
                                                                              END;
                                                                               }

    { [{4CA9A63E-954B-450C-B824-A4175F1FD21E}];2 ;Identifier          ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TA::CM Identifier }

    { [{154A6E91-CB33-4FE1-8C3D-23C2BAAD81CA}];2 ;Data                ;Element ;Text    ;
                                                  VariableName=TAData;
                                                  TextType=BigText;
                                                  DataType=Text;
                                                  MaxOccurs=Once }

    { [{D56B8FD0-059E-42E3-9E8E-B5FFB21CBBB3}];2 ;FileExtension       ;Element ;Text    ;
                                                  VariableName=TAFileExtension;
                                                  MinOccurs=Once;
                                                  MaxOccurs=Once;
                                                  Width=50 }

    { [{AEE5B739-6691-4823-9212-23766BC8E468}];2 ;FileName            ;Element ;Field   ;
                                                  DataType=Text;
                                                  SourceField=TA::Description;
                                                  MinOccurs=Zero;
                                                  MaxOccurs=Once }

  }
  EVENTS
  {
  }
  REQUESTPAGE
  {
    PROPERTIES
    {
    }
    CONTROLS
    {
    }
  }
  CODE
  {
    VAR
      CMWoMgt@1000000002 : Codeunit 70030;
      CMTaskMgt@1000000004 : Codeunit 70031;
      CMTTMgt@1000000005 : Codeunit 70040;
      CMGenMgt@1000000008 : Codeunit 70000;
      Text001@1000000000 : TextConst 'ENU=Cannot upload picture/attachment. Invalid Identifier "%1".';
      OfflineAppDataV1@1000000003 : XMLport 50012;
      Text002@1000000001 : TextConst 'ENU=Cannot upload picture/attachment. You cannot override picture/attachment with Identifier "%1". (Data already uploaded).';

    LOCAL PROCEDURE InsertTaskAttachment@1000000000();
    VAR
      TempBlob@1000000000 : TEMPORARY Record 99008535;
      Attachment@1000000001 : Record 5062;
      LogEntry@1000000002 : Record 5065;
    BEGIN
      //Find Log Entry
      IF TA."CM Identifier" = '' THEN
        EXIT;

      LogEntry.RESET;
      LogEntry.SETCURRENTKEY("CM Is CMMS Log Entry","CM No Data","CM Log Type","CM Identifier");
      LogEntry.SETRANGE("CM Is CMMS Log Entry", TRUE);
      LogEntry.SETFILTER("CM Log Type", '%1|%2', LogEntry."CM Log Type"::Picture, LogEntry."CM Log Type"::Attachment);
      LogEntry.SETRANGE("CM Identifier", TA."CM Identifier");
      IF NOT LogEntry.FINDFIRST() THEN
        OfflineAppDataV1.ERROR_(STRSUBSTNO(Text001, TA."CM Identifier"),'','',0,0,0,'');

      //Do not override existing Data.
      IF NOT LogEntry."CM No Data" THEN
        OfflineAppDataV1.ERROR_(STRSUBSTNO(Text002, TA."CM Identifier"),'','',0,0,0,'');

      OfflineAppDataV1.Base64StringToBlob(TAData, TempBlob);

      LOCKTIMEOUT(FALSE);
      Attachment.LOCKTABLE(TRUE, FALSE); //!!
      Attachment.INIT;
      Attachment.Attachment := TempBlob.Blob;
      Attachment."File Extension" := TAFileExtension;
      Attachment.INSERT(TRUE);
      LOCKTIMEOUT(TRUE);

      LogEntry."Attachment No." := Attachment."No.";
      LogEntry.Description := TA.Description;
      LogEntry."CM Log Type" := OfflineAppDataV1.ExtensionToLogType(TAFileExtension);
      LogEntry."CM No Data" := FALSE;
      LogEntry.MODIFY(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT MenuSuite 1080 Dept - Partner
{
  OBJECT-PROPERTIES
  {
    Date=07.09.17;
    Time=13:30:19;
    Modified=Yes;
    Version List=ENC,CMMS,SHFT;
  }
  PROPERTIES
  {
  }
  MENUNODES
  {
    {                ;[{19A352FE-D90D-424E-B85F-CF3B8E98CF0E}] ;NextNodeID=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}] }
    { Menu           ;[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}] ;Name=Modules;
                                                                CaptionML=[ENU=CMMS;
                                                                           DEA=CMMS];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                ParentNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                Image=0;
                                                                IsShortcut=No;
                                                                Visible=Yes;
                                                                Enabled=Yes;
                                                                NextNodeID=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                FirstChild=[{93F9C3CC-91CA-4EDE-9C6B-6A2CF443F616}] }
    { MenuGroup      ;[{93F9C3CC-91CA-4EDE-9C6B-6A2CF443F616}] ;Name=CMMS;
                                                                CaptionML=ENU=CMMS;
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                ParentNodeID=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F2B17BCE-5E34-484C-BEEF-5457C02BFD2A}];
                                                                FirstChild=[{22CAAFC0-FE38-40F2-8245-27E227EEDCFF}] }
    { MenuItem       ;[{AEE8D36F-9D5F-4CF6-8A57-4CBD9E0AAEE2}] ;Name=Assets;
                                                                CaptionML=[ENU=Assets;
                                                                           DEA=Anlagen];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70021;
                                                                ParentNodeID=[{22CAAFC0-FE38-40F2-8245-27E227EEDCFF}];
                                                                Visible=Yes;
                                                                NextNodeID=[{3ACFF473-9D2D-4A97-BF83-B59F95104D1E}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{EDD4F547-5B7B-4866-841B-D4CB7FA4983D}] ;Name=General Setup;
                                                                CaptionML=[ENU=General Setup;
                                                                           DEA=Allgemeine Einrichtung];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70000;
                                                                ParentNodeID=[{7C01B74C-B720-453E-9C8C-628F37CA35D8}];
                                                                Visible=Yes;
                                                                NextNodeID=[{B74F9FC4-E073-4E3C-B4DD-04B1894CE3B1}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{7C01B74C-B720-453E-9C8C-628F37CA35D8}] ;Name=Setup;
                                                                CaptionML=[ENU=Setup;
                                                                           DEA=Einrichtung];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                ParentNodeID=[{93F9C3CC-91CA-4EDE-9C6B-6A2CF443F616}];
                                                                Visible=Yes;
                                                                NextNodeID=[{2B9BDC5A-5C5E-4D9F-AED1-A96FF622D986}];
                                                                FirstChild=[{EDD4F547-5B7B-4866-841B-D4CB7FA4983D}];
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{82DBA6DA-5AB3-4B2D-8FE5-64932A76F63A}] ;Name=Vertr„ge;
                                                                CaptionML=[ENU=Contracts;
                                                                           DEA=Vertr„ge];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70024;
                                                                ParentNodeID=[{22CAAFC0-FE38-40F2-8245-27E227EEDCFF}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Lists }
    { MenuGroup      ;[{22CAAFC0-FE38-40F2-8245-27E227EEDCFF}] ;Name=Master Data;
                                                                CaptionML=[ENU=Master Data;
                                                                           DEA=Stammdaten];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                ParentNodeID=[{93F9C3CC-91CA-4EDE-9C6B-6A2CF443F616}];
                                                                Visible=Yes;
                                                                NextNodeID=[{7C01B74C-B720-453E-9C8C-628F37CA35D8}];
                                                                FirstChild=[{AEE8D36F-9D5F-4CF6-8A57-4CBD9E0AAEE2}];
                                                                IsDepartmentPage=Yes }
    { MenuGroup      ;[{2B9BDC5A-5C5E-4D9F-AED1-A96FF622D986}] ;Name=Periodic Activities;
                                                                CaptionML=[ENU=Periodic Activities;
                                                                           DEA=Periodische Aktivit„ten];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                ParentNodeID=[{93F9C3CC-91CA-4EDE-9C6B-6A2CF443F616}];
                                                                Visible=Yes;
                                                                NextNodeID=[{80FF4566-F8EE-4836-A0F5-21F3FB77DBBE}];
                                                                IsDepartmentPage=Yes }
    { MenuGroup      ;[{80FF4566-F8EE-4836-A0F5-21F3FB77DBBE}] ;Name=History;
                                                                CaptionML=[ENU=History;
                                                                           DEA=Historie];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                ParentNodeID=[{93F9C3CC-91CA-4EDE-9C6B-6A2CF443F616}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{198B64C7-A772-4B8B-8D77-38679FE6034A}];
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{3ACFF473-9D2D-4A97-BF83-B59F95104D1E}] ;Name=Projects;
                                                                CaptionML=[ENU=Projects;
                                                                           DEA=Projekte];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70023;
                                                                ParentNodeID=[{22CAAFC0-FE38-40F2-8245-27E227EEDCFF}];
                                                                Visible=Yes;
                                                                NextNodeID=[{82DBA6DA-5AB3-4B2D-8FE5-64932A76F63A}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{198B64C7-A772-4B8B-8D77-38679FE6034A}] ;Name=Time Records;
                                                                CaptionML=[ENU=Time Records;
                                                                           DEA=Zeitposten];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70091;
                                                                ParentNodeID=[{80FF4566-F8EE-4836-A0F5-21F3FB77DBBE}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=History }
    { MenuItem       ;[{B74F9FC4-E073-4E3C-B4DD-04B1894CE3B1}] ;Name=User Report Selection;
                                                                CaptionML=[ENU=User Report Selection;
                                                                           DEA=Benutzer Berichtsauswahl];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70005;
                                                                ParentNodeID=[{7C01B74C-B720-453E-9C8C-628F37CA35D8}];
                                                                Visible=Yes;
                                                                NextNodeID=[{7F96B3AA-F578-4FEB-AEE5-DB907431473E}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{C2985B06-6201-442D-B602-063784384B9C}] ;Name=Interaction Groups;
                                                                CaptionML=[ENU=Interaction Groups;
                                                                           DEA=Aktivit„tengruppen];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=5074;
                                                                ParentNodeID=[{7C01B74C-B720-453E-9C8C-628F37CA35D8}];
                                                                Visible=Yes;
                                                                NextNodeID=[{5AD23390-A4DE-4577-BF27-2A85D6803BFE}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{5AD23390-A4DE-4577-BF27-2A85D6803BFE}] ;Name=Interaction Templates;
                                                                CaptionML=[ENU=Interaction Templates;
                                                                           DEA=Aktivit„tenvorlagen];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=5075;
                                                                ParentNodeID=[{7C01B74C-B720-453E-9C8C-628F37CA35D8}];
                                                                Visible=Yes;
                                                                NextNodeID=[{F5CF29F8-1163-42D6-B8B9-E5273BAEA49B}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{F5CF29F8-1163-42D6-B8B9-E5273BAEA49B}] ;Name=Activity List;
                                                                CaptionML=[ENU=Activity List;
                                                                           DEA=Aktionenbersicht];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=5103;
                                                                ParentNodeID=[{7C01B74C-B720-453E-9C8C-628F37CA35D8}];
                                                                Visible=Yes;
                                                                NextNodeID=[{9EC2D020-F237-4A15-B1E7-F0BEA1B00C2F}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{9EC2D020-F237-4A15-B1E7-F0BEA1B00C2F}] ;Name=Contact Business Relations;
                                                                CaptionML=[ENU=Contact Business Relations;
                                                                           DEA=Kontakt Gesch„ftsbeziehungen];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=5061;
                                                                ParentNodeID=[{7C01B74C-B720-453E-9C8C-628F37CA35D8}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{7F96B3AA-F578-4FEB-AEE5-DB907431473E}] ;Name=User Setup;
                                                                CaptionML=[ENU=User Setup;
                                                                           DEA=Benutzer Einrichtung];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=119;
                                                                ParentNodeID=[{7C01B74C-B720-453E-9C8C-628F37CA35D8}];
                                                                Visible=Yes;
                                                                NextNodeID=[{1BFDC46D-DAE1-46D8-8F6A-0F1B5C3369F9}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{1BFDC46D-DAE1-46D8-8F6A-0F1B5C3369F9}] ;Name=User Personalization List;
                                                                CaptionML=[ENU=User Personalization List;
                                                                           DEA=Benutzeranpassungsbersicht];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=9173;
                                                                ParentNodeID=[{7C01B74C-B720-453E-9C8C-628F37CA35D8}];
                                                                Visible=Yes;
                                                                NextNodeID=[{C2985B06-6201-442D-B602-063784384B9C}];
                                                                DepartmentCategory=Administration }
    { Menu           ;[{484D897A-FC27-44B4-9F5F-C0CC3E6409AA}] ;Name=Zeiterfassung;
                                                                CaptionML=[DEU=Zeiterfassung;
                                                                           ENU=Attendance;
                                                                           DEA=Zeiterfassung];
                                                                MemberOfMenu=[{484D897A-FC27-44B4-9F5F-C0CC3E6409AA}];
                                                                Image=8;
                                                                IsShortcut=No;
                                                                Visible=Yes;
                                                                Enabled=Yes }
    { MenuGroup      ;[{2F915740-D9D1-41BF-82DB-D9C6D755A7FC}] ;Name=Stammdaten;
                                                                CaptionML=[DEU=Stammdaten;
                                                                           ENU=Master Data;
                                                                           DEA=Stammdaten];
                                                                Visible=Yes;
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{136AB9ED-321B-48B8-A97B-6F01B5FA274B}] ;Name=PZE Personal šbersicht;
                                                                CaptionML=[DEU=Personal;
                                                                           ENU=Personnel;
                                                                           DEA=Personal];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024202;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{847E0333-D483-499B-8BFE-9AF7940491CF}] ;Name=Zeitart;
                                                                CaptionML=[DEU=Zeitart;
                                                                           ENU=Time Type;
                                                                           DEA=Zeitart];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024210;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{F473D5DF-F1F0-42E4-A5EC-7C0211C582F8}] ;Name=Zeitkonto;
                                                                CaptionML=[DEU=Zeitkonto;
                                                                           ENU=Time Account;
                                                                           DEA=Zeitkonto];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024227;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{5173385E-B973-40AF-9F4B-E3067A24FE4D}] ;Name=Zeitmodell;
                                                                CaptionML=[DEU=Zeitmodell;
                                                                           ENU=Time Model;
                                                                           DEA=Zeitmodell];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024211;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{2118E54E-57E8-4C30-9284-21B5EFCB20F5}] ;Name=Gleitzeitschema;
                                                                CaptionML=[DEU=Gleitzeitschema;
                                                                           ENU=Flexitime Schedule;
                                                                           DEA=Gleitzeitschema];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024226;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{D5816D04-306E-494B-AB92-9B969DEB2F4D}] ;Name=Fixzeitschema;
                                                                CaptionML=[DEU=Fixzeitschema;
                                                                           ENU=Fixed Time Schedule;
                                                                           DEA=Fixzeitschema];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024225;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{55D71AD3-7A9F-40DA-ACE7-43867771EFB7}] ;Name=Sollzeitautomatik;
                                                                CaptionML=[DEU=Sollzeitautomatik;
                                                                           ENU=Scheduled Time Recognition;
                                                                           DEA=Sollzeitautomatik];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024238;
                                                                Visible=Yes;
                                                                NextNodeID=[{136AB9ED-321B-48B8-A97B-6F01B5FA274B}];
                                                                DepartmentCategory=Lists }
    { MenuGroup      ;[{15D11D35-D53E-41F6-A440-20C32247C1A2}] ;Name=Erfassung;
                                                                CaptionML=[DEU=Erfassung;
                                                                           ENU=Registration;
                                                                           DEA=Erfassung];
                                                                Visible=Yes;
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{67507E08-BD2D-4373-BFEE-53999866F285}] ;Name=Softterminal;
                                                                CaptionML=[DEU=Softterminal;
                                                                           ENU=Softterminal;
                                                                           DEA=Softterminal];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024246;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{BAB4B1B6-6385-4523-B9B0-CF288DB4E82F}] ;Name=Pincodeeingabe;
                                                                CaptionML=[DEU=Pincodeeingabe;
                                                                           ENU=PIN Code Entry;
                                                                           DEA=Pincodeeingabe];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024294;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{C34712EA-55B6-480E-B52B-29D161F22D11}] ;Name=Erfassungsbuchblatt-Zeile;
                                                                CaptionML=[DEU=Erfassungsbuchblatt-Zeile;
                                                                           ENU=Registration Worksheet;
                                                                           DEA=Erfassungsbuchblatt-Zeile];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024265;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{2F4F68DF-765B-4E4C-8433-3AD9D5810B93}] ;Name=Interaktive Abwesenheits-Erfas;
                                                                CaptionML=[DEU=Interaktive Abwesenheits-Erfassung;
                                                                           ENU=Interactive Absence Registration;
                                                                           DEA=Interaktive Abwesenheits-Erfassung];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024305;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{576899FC-B411-4DF0-BAC3-4CEDABA6A7FB}] ;Name=PZE Planzeit setzen;
                                                                CaptionML=[DEU=Planzeit setzen;
                                                                           ENU=Set Scheduled Time;
                                                                           DEA=Planzeit setzen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024206;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{64105442-3D2B-4438-B1A2-0A712C546142}] ;Name=PZE Planzeitantrag;
                                                                CaptionML=[DEU=Zeitantrag;
                                                                           ENU=Time Request;
                                                                           DEA=Zeitantrag];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024332;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{F2044D3C-CDFF-4079-9364-3F62D33F3E5E}] ;Name=Sammelerfassung extern;
                                                                CaptionML=[DEU=Sammelerfassung extern;
                                                                           ENU=External Registration Pool;
                                                                           DEA=Sammelerfassung extern];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024348;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{AF0A29F2-A6D4-4826-AA6B-F968F58A05A7}] ;Name=PZE Sammelerfassung extern Liste;
                                                                CaptionML=[DEU=Sammelerfassung extern;
                                                                           ENU=External Registration Pool;
                                                                           DEA=Sammelerfassung extern];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024349;
                                                                Visible=Yes;
                                                                NextNodeID=[{67507E08-BD2D-4373-BFEE-53999866F285}];
                                                                DepartmentCategory=Lists }
    { MenuGroup      ;[{ADE846F8-A481-4B19-A240-3CDDA8784A4B}] ;Name=Servicefunktionen;
                                                                CaptionML=[DEU=Servicefunktionen;
                                                                           ENU=Service Functions;
                                                                           DEA=Servicefunktionen];
                                                                Visible=Yes;
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{036E65FA-98B8-448E-A613-F317142410A5}] ;Name=Dienstnehmerabgleich;
                                                                CaptionML=DEA=Dienstnehmerabgleich;
                                                                RunObjectType=Report;
                                                                RunObjectID=1024240;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{8BA73658-9C1E-4513-84F9-20297606E465}] ;Name=PZE Zeitartabrechnung Von-Bis;
                                                                CaptionML=[DEU=Zeitartabrechnung Von-Bis;
                                                                           ENU=Time Type Billing From-To;
                                                                           DEA=Zeitartabrechnung Von-Bis];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024210;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{A3DF5F0A-E477-4AA0-B10E-B12389C267A4}] ;Name=PZE Kontenabrechnung Von-Bis;
                                                                CaptionML=[DEU=Kontenabrechnung Von-Bis;
                                                                           ENU=Account Billing From-To;
                                                                           DEA=Kontenabrechnung Von-Bis];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024211;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{FB09EE0F-14D7-4BEC-B347-510ABEB96745}] ;Name=Gruppennachricht;
                                                                CaptionML=[DEU=Gruppennachricht;
                                                                           ENU=Group Message;
                                                                           DEA=Gruppennachricht];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024219;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{E3F54757-D664-4E0E-99EB-7515BCB38E44}] ;Name=PZE Sollzeit erzeugen;
                                                                CaptionML=[DEU=Sollzeit erzeugen;
                                                                           ENU=Calculate Schedule;
                                                                           DEA=Sollzeit erzeugen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024202;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{027B8E41-52F4-4D17-9F9D-A1F7B3B7798C}] ;Name=Tageweise Sollzeit erzeugen;
                                                                CaptionML=[DEU=Tageweise Sollzeit erzeugen;
                                                                           ENU=Create Schedule by Days;
                                                                           DEA=Tageweise Sollzeit erzeugen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024230;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{ADDA14C9-7767-4548-BDFC-E8A54664489C}] ;Name=PZE Sollzeit erzeugen Von-Bis;
                                                                CaptionML=[DEU=Sollzeit erzeugen Von-Bis;
                                                                           ENU=Calculate Schedule From-To;
                                                                           DEA=Sollzeit erzeugen Von-Bis];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024217;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{2A46BF30-3C28-49F8-B31C-4157B29F45EE}] ;Name=Istzeit aus Sollzeit erzeugen;
                                                                CaptionML=[DEU=Istzeit aus Sollzeit erzeugen;
                                                                           ENU=Create Actual Times from Schedule;
                                                                           DEA=Istzeit aus Sollzeit erzeugen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024229;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{56577BEF-8491-4E75-B256-96D13D6E076D}] ;Name=Sperrverwaltung Erfassungszeil;
                                                                CaptionML=[DEU=Sperrverwaltung Erfassungszeilen;
                                                                           ENU=Lock Administration Registration Lines;
                                                                           DEA=Sperrverwaltung Erfassungszeilen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024220;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{F7EF4060-3706-49F8-8A3A-1302DF9ECFDB}] ;Name=Pflegelauf Zeiterfassungszeile;
                                                                CaptionML=[DEU=Pflegelauf Zeiterfassungszeilen;
                                                                           ENU=Maintenance of Registration Lines;
                                                                           DEA=Pflegelauf Zeiterfassungszeilen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024242;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{C3F4CF51-E7E4-4786-BCD3-0962FA0AEC9F}] ;Name=Planzeiten ber Wochenende;
                                                                CaptionML=DEA=Planzeiten ber Wochenende;
                                                                RunObjectType=Report;
                                                                RunObjectID=1024249;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{6540150E-826D-4E8F-ACAF-D5F9BA5429B7}] ;Name=Zeitkonten Nullstellung;
                                                                CaptionML=DEA=Zeitkonten Nullstellung;
                                                                RunObjectType=Report;
                                                                RunObjectID=1024250;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{4B10D20D-D8C1-4332-9EF7-8046B7AD6293}] ;Name=Check+Abrechnung;
                                                                CaptionML=[DEU=Check+Abrechnung;
                                                                           ENU=Check+Billing;
                                                                           DEA=Check+Abrechnung];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024318;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{C9D27767-3425-4F86-9FFE-E7670C01F58A}] ;Name=Datentransfer Terminals;
                                                                CaptionML=DEA=Datentransfer Terminals;
                                                                RunObjectType=Page;
                                                                RunObjectID=1024312;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{5389DC08-B292-4E64-BFF7-1199976A197D}] ;Name=Erfassungszeilenimport aus Dat;
                                                                CaptionML=DEA=Erfassungszeilenimport aus Datei;
                                                                RunObjectType=XMLport;
                                                                RunObjectID=1024202;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{13C028AC-CFAD-4DAE-9115-5DD2C33D79E1}] ;Name=PZE Import in Erfassungsbuchblatt;
                                                                CaptionML=[DEU=Import in Erfassungsbuchblatt;
                                                                           ENU=Import to Registration Worksheet;
                                                                           DEA=Import in Erfassungsbuchblatt];
                                                                RunObjectType=XMLport;
                                                                RunObjectID=1024206;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{81598397-8501-4600-A8F4-023C2F20FEB0}] ;Name=PZE Erinnerung MJ-Freigabe;
                                                                CaptionML=[DEU=Erinnerung MJ-Freigabe;
                                                                           ENU=Reminder MJ-Approval;
                                                                           DEA=Erinnerung MJ-Freigabe];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024255;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{00804633-F380-4684-AE31-7ADB1773C2FC}] ;Name=PZE Reset Lohnberleitung;
                                                                CaptionML=[DEU=Reset Lohnberleitung;
                                                                           ENU=Reset Transfer Wages&Salary;
                                                                           DEA=Reset Lohnberleitung];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024256;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{6F06AE66-D4EE-4B57-9A80-AB30FAAAFAAA}] ;Name=PZE Zeitarten in Zeitmodelle bertragen;
                                                                CaptionML=[DEU=Zeitarten in Zeitmodelle bertragen;
                                                                           ENU=Transfer Time Types into Time Models;
                                                                           DEA=Zeitarten in Zeitmodelle bertragen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024264;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{3EA7A3FC-2B66-4E59-B0C7-D446B98A2F62}] ;Name=PZE Zeitmodell eintragen;
                                                                CaptionML=[DEU=Zeitmodell eintragen;
                                                                           ENU=Assign Time Model;
                                                                           DEA=Zeitmodell eintragen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024268;
                                                                Visible=Yes;
                                                                NextNodeID=[{036E65FA-98B8-448E-A613-F317142410A5}];
                                                                DepartmentCategory=Tasks }
    { MenuGroup      ;[{75277BF9-9140-4810-BAB9-789042513C12}] ;Name=Abrechnung;
                                                                CaptionML=[DEU=Abrechnung;
                                                                           ENU=Billing;
                                                                           DEA=Abrechnung];
                                                                Visible=Yes;
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{6E1C72CB-632B-42A9-87CF-D20A5DEF4C52}] ;Name=PZE Stempelungsfreigabe;
                                                                CaptionML=[DEU=Stempelungsfreigabe;
                                                                           ENU=Registration Approval;
                                                                           DEA=Stempelungsfreigabe];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024258;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{626C264C-E122-4024-A1DD-354C6A8805F1}] ;Name=Umbuchungsblatt;
                                                                CaptionML=[DEU=Umbuchungsblatt;
                                                                           ENU=Transfer Worksheet;
                                                                           DEA=Umbuchungsblatt];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024264;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{ADD79C60-159A-45D4-9868-D8EB4F432887}] ;Name=PZE Abrechnungsbuchblatt;
                                                                CaptionML=[DEU=Abrechnungsbuchblatt;
                                                                           ENU=Billing Worksheet;
                                                                           DEA=Abrechnungsbuchblatt];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024334;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{D3212F90-641E-44E7-861E-F0FD3A2FE29B}] ;Name=PZE Check + Abrechnung;
                                                                CaptionML=[DEU=Batch-Abrechnung interaktiv starten;
                                                                           ENU=Interactive Execution of Batch Billing;
                                                                           DEA=Batch-Abrechnung interaktiv starten];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024318;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{34B42179-19DD-4C8A-9841-E897570244A2}] ;Name=PZE Projekt Buch.-Blatt fr Ist-Zeit;
                                                                CaptionML=[DEU=Projekt Buch.-Blatt fr Ist-Zeit;
                                                                           ENU=Job Journal for Posted Hours;
                                                                           DEA=Projekt Buch.-Blatt fr Ist-Zeit];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024360;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{A42AA025-142B-4FF7-BC8A-8F1E3164045B}] ;Name=PZE Zeitverletzungen;
                                                                CaptionML=[DEU=Zeitverletzungen;
                                                                           ENU=Core Time Infractions;
                                                                           DEA=Zeitverletzungen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024213;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{A9C73EA9-5863-45F7-953D-3F261F948B55}] ;Name=Erfassungscheck 2;
                                                                CaptionML=[DEU=Erfassungscheck;
                                                                           ENU=Registration Check;
                                                                           DEA=Erfassungscheck];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024226;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{A718D352-04AF-4FF7-8E9A-6650500BBC57}] ;Name=Zeitartabrechnung;
                                                                CaptionML=[DEU=Zeitartabrechnung;
                                                                           ENU=Time Type Billing;
                                                                           DEA=Zeitartabrechnung];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024204;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{481B64C4-B17D-4B2D-8E99-1A86EAC8FC8E}] ;Name=Kontenabrechnung;
                                                                CaptionML=[DEU=Kontenabrechnung;
                                                                           ENU=Account Billing;
                                                                           DEA=Kontenabrechnung];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024205;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{6679FC49-584D-438F-BF2C-5654F41F079D}] ;Name=Abrechnungsdruck;
                                                                CaptionML=[DEU=Abrechnungsdruck;
                                                                           ENU=Statement;
                                                                           DEA=Abrechnungsdruck];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024223;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{A8C698B3-6A20-4E82-B433-376281B36BEA}] ;Name=Check + Abrechnung;
                                                                CaptionML=[DEU=Check + Abrechnung;
                                                                           ENU=Check + Billing;
                                                                           DEA=Check + Abrechnung];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024234;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{4D6323F6-6C2F-4C29-86A6-0D4E5590F6E0}] ;Name=šberleitung Lohn;
                                                                CaptionML=[DEU=šberleitung Lohn;
                                                                           ENU=Transfer Wages/Salary;
                                                                           DEA=šberleitung Lohn];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024212;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{EFEE5E5B-ACAC-413E-A8EC-C5786D803387}] ;Name=Salden in Lohn kopieren;
                                                                CaptionML=[DEU=Salden in Lohn kopieren;
                                                                           ENU=Copy Balances to Wages/Salary;
                                                                           DEA=Salden in Lohn kopieren];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024228;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{D77AF2E8-F497-4B6F-9519-900B7CEE17D1}] ;Name=Lohn-Abwesenheiten in Arbeiter-Stunden holen;
                                                                CaptionML=[DEU=Lohn-Abwesenheiten in Arbeiter-Stunden holen;
                                                                           ENU=Transfer Absences from Wages/Salary to Worker Registrations;
                                                                           DEA=Lohn-Abwesenheiten in Arbeiter-Stunden holen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024272;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{175D29FD-62E1-4F4C-AA98-792B6E54DC9C}] ;Name=Auszahlung;
                                                                CaptionML=[DEU=Auszahlung;
                                                                           ENU=Payment;
                                                                           DEA=Auszahlung];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024215;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{0A1CE041-2CE5-4DC4-8C85-4312990C111B}] ;Name=šberleitung Ressourcenbuchblat;
                                                                CaptionML=DEA=šberleitung Ressourcenbuchblatt nach KTR;
                                                                RunObjectType=Report;
                                                                RunObjectID=1024253;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{3954AAF1-8F3A-4D48-AB48-B6CA3FFE4EB9}] ;Name=Summenumbuchung;
                                                                CaptionML=[DEU=Summenumbuchung;
                                                                           DEA=Summenumbuchung];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024252;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{7C1E9970-BB8F-42A7-A22F-4233B492B27E}] ;Name=Sammelerfassung verbuchen;
                                                                CaptionML=[DEU=Sammelerfassung verbuchen;
                                                                           ENU=Post Registration Pool;
                                                                           DEA=Sammelerfassung verbuchen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024263;
                                                                Visible=Yes;
                                                                NextNodeID=[{6E1C72CB-632B-42A9-87CF-D20A5DEF4C52}];
                                                                DepartmentCategory=Tasks }
    { MenuGroup      ;[{2AF8AE66-EEF5-4A83-AFA6-0C0C9EF0701A}] ;Name=Berichte;
                                                                CaptionML=[DEU=Berichte;
                                                                           ENU=Reports;
                                                                           DEA=Berichte];
                                                                Visible=Yes;
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{020738F2-A321-43CD-AD19-66B1F6E866B3}] ;Name=Zeitkonten;
                                                                CaptionML=[DEU=Zeitkonten;
                                                                           ENU=Time Accounts;
                                                                           DEA=Zeitkonten];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024208;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{1D6D79CD-C116-4E0E-BE3C-96A4A36DE50B}] ;Name=Arbeitsplan/Periode;
                                                                CaptionML=[DEU=Arbeitsplan/Periode;
                                                                           ENU=Schedule/Period;
                                                                           DEA=Arbeitsplan/Periode];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024209;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{7C5E2C50-A193-41AA-9C65-96E83BE026C9}] ;Name=Personal Anwesenheits-Status;
                                                                CaptionML=[DEU=Personal Anwesenheits-Status;
                                                                           ENU=Personnel Attendence Status;
                                                                           DEA=Personal Anwesenheits-Status];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024200;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{FB7BFA48-7A6B-4D34-90C7-1C2F46F95FB7}] ;Name=Soll/Ist Auswertung;
                                                                CaptionML=[DEU=Soll/Ist Auswertung;
                                                                           ENU=Schedule/Actual Analysis;
                                                                           DEA=Soll/Ist Auswertung];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024218;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{111841AD-34FD-4A6A-A401-04A132D1E062}] ;Name=An/Abwesenheitsliste;
                                                                CaptionML=[DEU=An/Abwesenheitsliste;
                                                                           ENU=Attendance List;
                                                                           DEA=An/Abwesenheitsliste];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024221;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{5D67A6C0-4615-48D3-8561-6B24F9E04FC0}] ;Name=Planzeitliste;
                                                                CaptionML=[DEU=Planzeitliste;
                                                                           ENU=Scheduled Absence List;
                                                                           DEA=Planzeitliste];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024216;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{C3443805-0C9D-4AAB-9938-CF3325F4BC93}] ;Name=PZE Maschinenstunden;
                                                                CaptionML=[DEU=Maschinenstunden;
                                                                           ENU=Machine Hours;
                                                                           DEA=Maschinenstunden];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024259;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{FD298F39-DB62-48DB-A782-8067E5584EC0}] ;Name=PZE Personal - Zeitkonten/KST;
                                                                CaptionML=[DEU=Personal - Zeitkonten nach KST;
                                                                           ENU=Personnel - Time Accounts by CC;
                                                                           DEA=Personal - Zeitkonten nach KST];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024260;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{2C5BD56E-E069-4F5F-AAF5-3E72B5DD01D0}] ;Name=Zeiterfassungsliste MA/KS;
                                                                CaptionML=[DEU=Zeiterfassungsliste MA/KS;
                                                                           ENU=Registration List EE/CC;
                                                                           DEA=Zeiterfassungsliste MA/KS];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024225;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{40F4FC71-24BF-4B5D-802C-CC4CA719B76A}] ;Name=Kontensalden -> Excel;
                                                                CaptionML=[DEU=Kontensalden -> Excel;
                                                                           ENU=Time Account Balances -> Excel;
                                                                           DEA=Kontensalden -> Excel];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024232;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{B4BEEC42-7E2A-4E66-B622-362C698652F1}] ;Name=PZE Erfassung auáerhalb Limits;
                                                                CaptionML=[DEU=Erfassung auáerhalb Limits;
                                                                           ENU=Registration out of Limits;
                                                                           DEA=Erfassung auáerhalb Limits];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024258;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{0C1ECB9B-20E0-4F9D-84F9-3A2847929750}] ;Name=PZE Abgezogene Pausen;
                                                                CaptionML=[DEU=Abgezogene Pausen;
                                                                           ENU=Deducted Breaks;
                                                                           DEA=Abgezogene Pausen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024269;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{D997EF88-425D-4EBB-A453-3F0DFDCF9CD3}] ;Name=PZE Prfung Tagesruhezeit/Mail;
                                                                CaptionML=[DEU=Prfung Tagesruhezeit/Mail;
                                                                           ENU=Check Daily Recreation Time/Mail;
                                                                           DEA=Prfung Tagesruhezeit/Mail];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024271;
                                                                Visible=Yes;
                                                                NextNodeID=[{020738F2-A321-43CD-AD19-66B1F6E866B3}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{B1A9FD29-D983-45FD-B854-AE6BACA114B7}] ;Name=Analysen;
                                                                CaptionML=[DEU=Analysen;
                                                                           ENU=Analyses;
                                                                           DEA=Analysen];
                                                                Visible=Yes;
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{EAC16D15-9C05-48A2-A738-5404A932416A}] ;Name=Zeitarten;
                                                                CaptionML=[DEU=Zeitarten;
                                                                           ENU=Time Types;
                                                                           DEA=Zeitarten];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024251;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{15D980BA-6F1F-4D4E-B94B-EF0E7CFD538E}] ;Name=Zeitkonten;
                                                                CaptionML=[DEU=Zeitkonten;
                                                                           ENU=Time Accounts;
                                                                           DEA=Zeitkonten];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024250;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{4EFA6414-F986-446D-8D1F-53C3A51823FB}] ;Name=Arbeitsplan/Periode;
                                                                CaptionML=[DEU=Arbeitsplan/Periode;
                                                                           ENU=Schedule/Period;
                                                                           DEA=Arbeitsplan/Periode];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024252;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{375B1314-75E2-4C83-A073-06FD949AA403}] ;Name=Arbeitsplan/Zeiteinheit;
                                                                CaptionML=[DEU=Arbeitsplan/Zeiteinheit;
                                                                           ENU=Schedule/Time Unit;
                                                                           DEA=Arbeitsplan/Zeiteinheit];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024256;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{C161EFA9-4C6B-4AB0-9C75-10B23BCEF840}] ;Name=Wochenauswertung;
                                                                CaptionML=[DEU=Wochenauswertung;
                                                                           ENU=Weekly Report;
                                                                           DEA=Wochenauswertung];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024254;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{7DDBAD5E-D17E-4B4C-BDE4-0E0E42BE3C41}] ;Name=Soll/Ist Auswertung;
                                                                CaptionML=[DEU=Soll/Ist Auswertung;
                                                                           ENU=Schedule/Actual Analysis;
                                                                           DEA=Soll/Ist Auswertung];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024277;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{C5B4B2E6-1905-4044-B4A8-9CC8B5DD91F7}] ;Name=Zeitartensalden;
                                                                CaptionML=[DEU=Zeitartensalden;
                                                                           ENU=Time Type Balances;
                                                                           DEA=Zeitartensalden];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024253;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{62F8AF9A-77CA-4494-8DD5-B1475C1515F7}] ;Name=Zeitkontensalden;
                                                                CaptionML=[DEU=Zeitkontensalden;
                                                                           ENU=Time Account Balances;
                                                                           DEA=Zeitkontensalden];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024257;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{0CC65DAF-794E-4793-8A19-32C6E27BEF27}] ;Name=Kontensalden -> Excel;
                                                                CaptionML=[DEU=Kontensalden -> Excel;
                                                                           ENU=Time Account Balances -> Excel;
                                                                           DEA=Kontensalden -> Excel];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024232;
                                                                Visible=Yes;
                                                                NextNodeID=[{EAC16D15-9C05-48A2-A738-5404A932416A}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{D19DE574-C1EB-4187-8636-7215EDED59C1}] ;Name=Abteilungsleiter;
                                                                CaptionML=[DEU=Abteilungsleiter;
                                                                           ENU=Manager;
                                                                           DEA=Abteilungsleiter];
                                                                Visible=Yes;
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{D6611C14-4819-4296-938C-192AD6FC6050}] ;Name=Zeiterfassungszeile;
                                                                CaptionML=[DEU=Zeiterfassungszeile;
                                                                           ENU=Registration Line;
                                                                           DEA=Zeiterfassungszeile];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024228;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{E4112327-757B-4BCD-AAEC-8C8A126EDA10}] ;Name=Erfassungskorrektur;
                                                                CaptionML=[DEU=Erfassungskorrektur;
                                                                           ENU=Registration Adjustment;
                                                                           DEA=Erfassungskorrektur];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024279;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{5852A92F-0222-4FA0-95A8-0FF2E7108826}] ;Name=Soll/Ist Auswertung;
                                                                CaptionML=[DEU=Soll/Ist Auswertung;
                                                                           ENU=Schedule/Actual Analysis;
                                                                           DEA=Soll/Ist Auswertung];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024277;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{F2409391-0CBA-4340-8870-9405ECF3A38D}] ;Name=Arbeitsplan/Periode;
                                                                CaptionML=[DEU=Arbeitsplan/Periode;
                                                                           ENU=Schedule/Period;
                                                                           DEA=Arbeitsplan/Periode];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024252;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{24DF468A-8DAF-4BFF-9F49-2E44C2457E9D}] ;Name=Arbeitsplan/Zeiteinheit;
                                                                CaptionML=[DEU=Arbeitsplan/Zeiteinheit;
                                                                           ENU=Schedule/Time Unit;
                                                                           DEA=Arbeitsplan/Zeiteinheit];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024256;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{5737391B-653B-44EA-B4B2-037C6D24E0E4}] ;Name=PZE Personal - Status;
                                                                CaptionML=[DEU=Personal - Status;
                                                                           ENU=Personnel - Status;
                                                                           DEA=Personal - Status];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024282;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{D313FDDF-1807-43B0-AE68-A0FF69450305}] ;Name=PZE Personal - Status;
                                                                CaptionML=[DEU=Personal - Info;
                                                                           ENU=Personnel - Info;
                                                                           DEA=Personal - Info];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024255;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{783B9F81-38CC-4E04-BFAF-DFB2982C3C2F}] ;Name=Wochenauswertung;
                                                                CaptionML=[DEU=Wochenauswertung;
                                                                           ENU=Weekly Report;
                                                                           DEA=Wochenauswertung];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024254;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{54F15C07-B901-4A39-9629-A8BEECF5C357}] ;Name=Auszahlungsbersicht;
                                                                CaptionML=[DEU=Auszahlungsbersicht;
                                                                           ENU=Payment Journal;
                                                                           DEA=Auszahlungsbersicht];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024286;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{63A25E29-EE66-4E90-813C-C25C114A285F}] ;Name=Gesamtfreigabe Monatsjournal;
                                                                CaptionML=DEA=Gesamtfreigabe Monatsjournal;
                                                                RunObjectType=Page;
                                                                RunObjectID=1024338;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{45AAA329-E5C7-43C0-A57D-FCE7EE0385F1}] ;Name=Zeiterfassungsliste MA/KS;
                                                                CaptionML=[DEU=Zeiterfassungsliste MA/KS;
                                                                           ENU=Registration List EE/CC;
                                                                           DEA=Zeiterfassungsliste MA/KS];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024225;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{9F5A84B4-EE25-4744-B24F-1DD7C3B09FAC}] ;Name=Kontensalden -> Excel;
                                                                CaptionML=[DEU=Kontensalden -> Excel;
                                                                           ENU=Time Account Balances -> Excel;
                                                                           DEA=Kontensalden -> Excel];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024232;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{9ACBB11A-D01F-4F35-A81B-795BF5103D7F}] ;Name=PZE Zeitverletzungen;
                                                                CaptionML=[DEU=Zeitverletzungen;
                                                                           ENU=Core Time Infractions;
                                                                           DEA=Zeitverletzungen];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024213;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{7E348D9A-7BEF-4CD1-A521-B5D7352F13B4}] ;Name=An/Abwesenheitsliste;
                                                                CaptionML=[DEU=An/Abwesenheitsliste;
                                                                           ENU=Attendance List;
                                                                           DEA=An/Abwesenheitsliste];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024221;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{D5550777-8E67-461F-8D96-805A776FFED0}] ;Name=Auszahlung;
                                                                CaptionML=[DEU=Auszahlung;
                                                                           ENU=Payment;
                                                                           DEA=Auszahlung];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024215;
                                                                Visible=Yes;
                                                                NextNodeID=[{D6611C14-4819-4296-938C-192AD6FC6050}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{9E07E306-72C0-4986-B874-7519A408A9C9}] ;Name=Bauarbeiter;
                                                                CaptionML=[DEU=Bauarbeiter;
                                                                           ENU=Construction Workers;
                                                                           DEA=Bauarbeiter];
                                                                Visible=Yes;
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{1C0287D4-6582-4B4E-96A2-70A1BC802AF6}] ;Name=PZE Wochenerfassung;
                                                                CaptionML=[DEU=Wochenerfassung;
                                                                           ENU=Weekly Registration;
                                                                           DEA=Wochenerfassung];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024324;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{628487D3-A992-483C-AE0F-9F9E33B9D6E4}] ;Name=PZE Zulage Personal/Baustelle;
                                                                CaptionML=[DEU=Zulage Personal/Baustelle;
                                                                           ENU=Allowance Personnel/Site;
                                                                           DEA=Zulage Personal/Baustelle];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024326;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{9EE31F51-D537-43C1-BDA1-DF2D2C4ED6D6}] ;Name=PZE Zulagendefinition;
                                                                CaptionML=[DEU=Zulagendefinition;
                                                                           ENU=Allowances Definition;
                                                                           DEA=Zulagendefinition];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024327;
                                                                Visible=Yes;
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{FA50402C-2FE3-4AB3-BBA3-F9CDC054897F}] ;Name=PZE Check+Abrechnung;
                                                                CaptionML=[DEU=Check+Abrechnung;
                                                                           ENU=Check+Billing;
                                                                           DEA=Check+Abrechnung];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024318;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuGroup      ;[{91DC6CB3-629B-4B6B-AEA8-63BBB805AB45}] ;Name=Bau - Einrichtung;
                                                                CaptionML=[DEU=Bau - Einrichtung;
                                                                           ENU=Construction - Setup;
                                                                           DEA=Bau - Einrichtung];
                                                                Visible=Yes;
                                                                NextNodeID=[{1C0287D4-6582-4B4E-96A2-70A1BC802AF6}];
                                                                IsDepartmentPage=No }
    { MenuItem       ;[{6B879601-5B2C-4E27-986A-06FB387121BA}] ;Name=PZE Arbeitszeitkalender/Woche;
                                                                CaptionML=[DEU=Arbeitszeitkalender/Woche;
                                                                           ENU=Work Schedule/Week;
                                                                           DEA=Arbeitszeitkalender/Woche];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024323;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{A00F2F3C-885B-4A68-BD4D-F10C9DB325D7}] ;Name=PZE Arbeitszeitkalender/Tag;
                                                                CaptionML=[DEU=Arbeitszeitkalender/Tag;
                                                                           ENU=Work Schedule/Day;
                                                                           DEA=Arbeitszeitkalender/Tag];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024329;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{B50FFE28-7E42-4523-AC13-D07515CF828D}] ;Name=PZE Aufflldefinition;
                                                                CaptionML=[DEU=Aufflldefinition;
                                                                           ENU=Fillup Definition;
                                                                           DEA=Aufflldefinition];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024328;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{5503D11D-65E6-41A0-885C-800E82EAFE9B}] ;Name=PZE Generierung Zeitkonten;
                                                                CaptionML=[DEU=Generierung Zeitkonten;
                                                                           ENU=Generate Time Accounts;
                                                                           DEA=Generierung Zeitkonten];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024246;
                                                                Visible=Yes;
                                                                NextNodeID=[{6B879601-5B2C-4E27-986A-06FB387121BA}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{6186E1E8-F4DC-4378-8716-852F6C0CDF02}] ;Name=Belege;
                                                                CaptionML=[DEU=Belege;
                                                                           ENU=Documents;
                                                                           DEA=Belege];
                                                                Visible=Yes;
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{64F2D1B4-9D90-4ECA-9C67-47B9F3B84164}] ;Name=Abrechnungsdruck;
                                                                CaptionML=[DEU=Abrechnungsdruck;
                                                                           ENU=Statement;
                                                                           DEA=Abrechnungsdruck];
                                                                RunObjectType=Report;
                                                                RunObjectID=1024223;
                                                                Visible=Yes;
                                                                DepartmentCategory=Documents }
    { MenuItem       ;[{F3B3E4B1-7F09-4584-A453-440035FF9AD0}] ;Name=Berechnungslauf;
                                                                CaptionML=[DEU=Berechnungslauf;
                                                                           ENU=Billing Job;
                                                                           DEA=Berechnungslauf];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024216;
                                                                Visible=Yes;
                                                                NextNodeID=[{64F2D1B4-9D90-4ECA-9C67-47B9F3B84164}];
                                                                DepartmentCategory=History }
    { MenuGroup      ;[{287BAD7B-B7A6-44F1-93F7-23286C437096}] ;Name=Einrichtung;
                                                                CaptionML=[DEU=Einrichtung;
                                                                           ENU=Setup;
                                                                           DEA=Einrichtung];
                                                                Visible=Yes;
                                                                NextNodeID=[{2F915740-D9D1-41BF-82DB-D9C6D755A7FC}];
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{3A963E45-62A2-46D5-A818-17107384C416}] ;Name=Einrichtung;
                                                                CaptionML=[DEU=Zeiterfassung Einrichtung;
                                                                           ENU=Registration Setup;
                                                                           DEA=Zeiterfassung Einrichtung];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024231;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{07C2752F-A682-405A-917A-89E2301356C9}] ;Name=Benutzereinrichtung;
                                                                CaptionML=[DEU=Benutzereinrichtung;
                                                                           ENU=User Setup;
                                                                           DEA=Benutzereinrichtung];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024235;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{17F4C632-CDDE-4B8C-AED6-82C80E7E3D66}] ;Name=Formatierung;
                                                                CaptionML=[DEU=Formatierung;
                                                                           ENU=Formatting;
                                                                           DEA=Formatierung];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024240;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{DEF4AFF2-6689-46B1-8CB3-0037AD6BEE20}] ;Name=Feiertags-Kalender Codes;
                                                                CaptionML=[DEU=Feiertags-Kalender Codes;
                                                                           ENU=Holiday-Calendar Codes;
                                                                           DEA=Feiertags-Kalender Codes];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024212;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{F66F973E-ED27-4988-9546-BE0D5087F96B}] ;Name=Feiertags-Kalender;
                                                                CaptionML=[DEU=Feiertags-Kalender;
                                                                           ENU=Holiday-Calendar;
                                                                           DEA=Feiertags-Kalender];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024209;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{A71B45B6-8593-4239-A40F-0B9F773C89B0}] ;Name=Rundungsmethoden;
                                                                CaptionML=[DEU=Rundungsmethoden;
                                                                           ENU=Rounding Methods;
                                                                           DEA=Rundungsmethoden];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024213;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{0F2CEE9E-A950-43C2-9B99-CFAF4A67B05F}] ;Name=Erfassungscodegruppen;
                                                                CaptionML=[DEU=Erfassungscodegruppen;
                                                                           ENU=Registration Code Groups;
                                                                           DEA=Erfassungscodegruppen];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024249;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{ED74FF65-F6A5-4348-83C7-5AACDF182331}] ;Name=Zeiterfassungscodes;
                                                                CaptionML=[DEU=Zeiterfassungscodes;
                                                                           ENU=Registration Codes;
                                                                           DEA=Zeiterfassungscodes];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024203;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{D5C2AE53-EBAE-4FA1-8FFE-34594AE78074}] ;Name=šbersetzung Zeiterfassungscode;
                                                                CaptionML=[DEU=šbersetzung Zeiterfassungscodes;
                                                                           ENU=Translation Registration Codes;
                                                                           DEA=šbersetzung Zeiterfassungscodes];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024204;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{8848550A-E59F-42EC-A567-7D7D34B051CC}] ;Name=PZE šbersetzung Lohn-Abwesenheitscodes;
                                                                CaptionML=[DEU=šbersetzung Lohn-Abwesenheitscodes;
                                                                           ENU=Mapping of Absence Codes Wages/Salary;
                                                                           DEA=šbersetzung Lohn-Abwesenheitscodes];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024365;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{404BF9CA-3A7C-4AF9-855C-9D86E3F62B3C}] ;Name=Kommen/Gehen Krzel;
                                                                CaptionML=[DEU=Kommen/Gehen Krzel;
                                                                           ENU=Coming/Leaving Shortcuts;
                                                                           DEA=Kommen/Gehen Krzel];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024221;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{35037C2D-5AD5-4D8F-87C3-0B248D89CCAE}] ;Name=Zeiterfassungszeile;
                                                                CaptionML=[DEU=Zeiterfassungszeile;
                                                                           ENU=Registration Line;
                                                                           DEA=Zeiterfassungszeile];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024228;
                                                                Visible=Yes;
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{A19CAEB7-1B1D-4CF2-9282-A954E00D904E}] ;Name=Umbuchungsblatt-Vorlagen;
                                                                CaptionML=[DEU=Umbuchungsblatt-Vorlagen;
                                                                           ENU=Transfer Worksheet Templates;
                                                                           DEA=Umbuchungsblatt-Vorlagen];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024263;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{12356593-49AD-48F8-999E-9EC22A1C3492}] ;Name=Importdefinitionen;
                                                                CaptionML=[DEU=Importdefinitionen;
                                                                           ENU=Import Definitions;
                                                                           DEA=Importdefinitionen];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024234;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{6E27DE33-7851-4B2E-B1B2-E64B0DD070E1}] ;Name=Personalgruppen;
                                                                CaptionML=[DEU=Personalgruppen;
                                                                           ENU=Personnel Groups;
                                                                           DEA=Personalgruppen];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024214;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{BA91D4E2-A24A-441D-BA18-B633A87F11A5}] ;Name=Berechtigungsgruppen;
                                                                CaptionML=[DEU=Berechtigungsgruppen;
                                                                           ENU=Permission Groups;
                                                                           DEA=Berechtigungsgruppen];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024236;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{C1D1E405-3FF9-4489-B489-9B007D5066B4}] ;Name=Zeiterfassungsperioden;
                                                                CaptionML=[DEU=Zeiterfassungsperioden;
                                                                           ENU=Registration Periods;
                                                                           DEA=Zeiterfassungsperioden];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024205;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{C8167660-75FE-41CC-A358-A84FE6B84472}] ;Name=Reportspaltenschemata;
                                                                CaptionML=[DEU=Reportspaltenschemata;
                                                                           ENU=Report Column Layouts;
                                                                           DEA=Reportspaltenschemata];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024295;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{1E960A49-57A3-41B7-80C3-B9E298BF473F}] ;Name=Aufteilungsdefinition;
                                                                CaptionML=[DEU=Aufteilungsdefinition;
                                                                           ENU=Distribution Definition;
                                                                           DEA=Aufteilungsdefinition];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024314;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{158EB15B-F25E-4650-9CAC-659DF586B87F}] ;Name=Firmenliste;
                                                                CaptionML=[DEU=Firmenliste;
                                                                           ENU=Company List;
                                                                           DEA=Firmenliste];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024335;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{BFF3765F-CD7F-4B94-8E17-E46A2F75DC88}] ;Name=™ffnungszeiten;
                                                                CaptionML=[DEU=™ffnungszeiten;
                                                                           ENU=Opening Hours;
                                                                           DEA=™ffnungszeiten];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024356;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{994615C6-5898-416E-A06D-E669BD8FA832}] ;Name=PZE Stempelbare Entfernungen;
                                                                CaptionML=[DEU=Stempelbare Entfernungen;
                                                                           ENU=Registrable Distances;
                                                                           DEA=Stempelbare Entfernungen];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024357;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{89D4B10A-EF41-4789-8AE8-5997EE5C7120}] ;Name=PZE Kontenausgleich šbersicht;
                                                                CaptionML=[DEU=Kontenausgleich;
                                                                           ENU=Account Application;
                                                                           DEA=Kontenausgleich];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024363;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{7207B8CF-707F-49A7-B641-2F09D9537208}] ;Name=PZE-Komplettzugriffsrolle erst;
                                                                CaptionML=DEA=PZE-Komplettzugriffsrolle erstellen;
                                                                RunObjectType=Report;
                                                                RunObjectID=1024241;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{71CAA682-4A42-4DCE-A8A7-C0EC38907DDD}] ;Name=Datentransfer;
                                                                CaptionML=[DEU=Datentransfer;
                                                                           ENU=Data Exchange;
                                                                           DEA=Datentransfer];
                                                                Visible=Yes;
                                                                IsDepartmentPage=No }
    { MenuItem       ;[{49EA5E91-F39C-42A1-83CE-A3DCE10339CB}] ;Name=Kompletter Datenbestand;
                                                                CaptionML=DEA=Kompletter Datenbestand;
                                                                RunObjectType=XMLport;
                                                                RunObjectID=1024203;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{29721DA0-6F4E-4916-B3AF-2B6DD00DF45B}] ;Name=Einrichtungsdaten;
                                                                CaptionML=DEA=Einrichtungsdaten;
                                                                RunObjectType=XMLport;
                                                                RunObjectID=1024204;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{D092C7B3-7206-4CEA-AE69-DA66EF965CEC}] ;Name=Lohn Staatsangeh. Export;
                                                                CaptionML=DEA=Lohn Staatsangeh. Export;
                                                                RunObjectType=XMLport;
                                                                RunObjectID=1024210;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{08858D27-2C62-423E-9C28-B41BF8B539C1}] ;Name=Staatsangeh. Import;
                                                                CaptionML=DEA=Staatsangeh. Import;
                                                                RunObjectType=XMLport;
                                                                RunObjectID=1024211;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{109E10C4-DB1D-4428-96E9-CF4172E77A2F}] ;Name=Planzeiten fr Kalender;
                                                                CaptionML=DEA=Planzeiten fr Kalender;
                                                                RunObjectType=XMLport;
                                                                RunObjectID=1024207;
                                                                Visible=Yes;
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{36534F4B-F954-4751-A92B-8A3D152C8D85}] ;Name=Arbeitszeitkalender erg„nzen;
                                                                CaptionML=[DEU=Arbeitszeitkalender erg„nzen;
                                                                           ENU=Amend Work Time Schedule;
                                                                           DEA=Arbeitszeitkalender erg„nzen];
                                                                RunObjectType=XMLport;
                                                                RunObjectID=1024400;
                                                                Visible=Yes;
                                                                NextNodeID=[{49EA5E91-F39C-42A1-83CE-A3DCE10339CB}];
                                                                DepartmentCategory=Tasks }
    { MenuGroup      ;[{ADEF0671-034C-4DAF-83A1-D0DD95F4D78F}] ;Name=Terminals;
                                                                CaptionML=[DEU=Terminals;
                                                                           ENU=Terminals;
                                                                           DEA=Terminals];
                                                                Visible=Yes;
                                                                IsDepartmentPage=No }
    { MenuItem       ;[{08211735-C2C8-4FFD-90A8-3BC9676B839D}] ;Name=PZE Reihenfolge Terminalimport;
                                                                CaptionML=[DEU=Reihenfolge Terminalimport;
                                                                           ENU=Search Order Terminal Import;
                                                                           DEA=Reihenfolge Terminalimport];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024364;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{3FB7EFE5-4D45-48AE-AE55-FB2AFE0E0A60}] ;Name=Einrichtung Gantner;
                                                                CaptionML=[DEU=Einrichtung Gantner;
                                                                           ENU=Setup Gantner;
                                                                           DEA=Einrichtung Gantner];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024310;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{8A3337A5-C322-4C26-BC78-73836AFDCF32}] ;Name=PZE Zutrittsgruppen Gantner;
                                                                CaptionML=[DEU=Zutrittsgruppen Gantner;
                                                                           ENU=Access Groups Gantner;
                                                                           DEA=Zutrittsgruppen Gantner];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024317;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{7F909BB6-162A-48BB-9A44-25FE30283396}] ;Name=Einrichtung Kaba;
                                                                CaptionML=[DEU=Einrichtung Kaba;
                                                                           ENU=Setup Kaba;
                                                                           DEA=Einrichtung Kaba];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024319;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{8AB3AAE0-4645-4FEC-8CD0-AB9077A7255A}] ;Name=Einrichtung PCS;
                                                                CaptionML=[DEU=Einrichtung PCS;
                                                                           ENU=Setup PCS;
                                                                           DEA=Einrichtung PCS];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024330;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{5B420692-BBF8-42F9-8862-4EE51E9F6B4E}] ;Name=PZE Einrichtung Consens;
                                                                CaptionML=[DEU=Einrichtung Consens;
                                                                           ENU=Setup Consens;
                                                                           DEA=Einrichtung Consens];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024344;
                                                                Visible=Yes;
                                                                NextNodeID=[{08211735-C2C8-4FFD-90A8-3BC9676B839D}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{A5B42503-D130-48F8-8972-348F5CE17ACA}] ;Name=Erinnerungen;
                                                                CaptionML=[DEU=Erinnerungen;
                                                                           ENU=Reminders;
                                                                           DEA=Erinnerungen];
                                                                Visible=Yes;
                                                                NextNodeID=[{3A963E45-62A2-46D5-A818-17107384C416}];
                                                                IsDepartmentPage=No }
    { MenuItem       ;[{7ED8D4AB-ED1C-4990-B4FF-86B05D742B96}] ;Name=PZE Erinnerungsgruppe fr Frei;
                                                                CaptionML=[DEU=Erinnerungsgruppe fr Freigabe;
                                                                           ENU=Reminder Group for Approval;
                                                                           DEA=Erinnerungsgruppe fr Freigabe];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024339;
                                                                Visible=Yes;
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{887EE47F-7F59-43CE-A61D-A4F7A5DCA357}] ;Name=Erinnerungsprotokoll;
                                                                CaptionML=[DEU=Erinnerungsprotokoll;
                                                                           ENU=Reminder Log;
                                                                           DEA=Erinnerungsprotokoll];
                                                                RunObjectType=Page;
                                                                RunObjectID=1024342;
                                                                Visible=Yes;
                                                                NextNodeID=[{7ED8D4AB-ED1C-4990-B4FF-86B05D742B96}];
                                                                DepartmentCategory=Administration }
    { Menu           ;[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}] ;Name=Module;
                                                                CaptionML=[ENU=Modules;
                                                                           DEA=Module];
                                                                MemberOfMenu=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                ParentNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                Image=0;
                                                                IsShortcut=No;
                                                                Visible=Yes;
                                                                Enabled=Yes;
                                                                NextNodeID=[{484D897A-FC27-44B4-9F5F-C0CC3E6409AA}];
                                                                FirstChild=[{264CD3D2-E11C-4E17-ADFF-A8C5623D960B}] }
    { MenuGroup      ;[{264CD3D2-E11C-4E17-ADFF-A8C5623D960B}] ;Name=Consolidation;
                                                                CaptionML=[ENU=Consolidation;
                                                                           DEA=Konsolidierung];
                                                                MemberOfMenu=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                ParentNodeID=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                Visible=Yes;
                                                                NextNodeID=[{31C3BB3E-2BBC-4892-B650-73C19FB64BAE}];
                                                                FirstChild=[{6466C418-552A-46E2-9F15-98B8E161DE8D}];
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{6466C418-552A-46E2-9F15-98B8E161DE8D}] ;Name=Konsolidierung Export;
                                                                CaptionML=[ENU=Consolidation Export;
                                                                           DEA=Konsolidierung Export];
                                                                MemberOfMenu=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                RunObjectType=Report;
                                                                RunObjectID=50020;
                                                                ParentNodeID=[{264CD3D2-E11C-4E17-ADFF-A8C5623D960B}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuGroup      ;[{31C3BB3E-2BBC-4892-B650-73C19FB64BAE}] ;Name=Setup;
                                                                CaptionML=[ENU=Setup;
                                                                           DEA=Einrichtung];
                                                                MemberOfMenu=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                ParentNodeID=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                Visible=Yes;
                                                                NextNodeID=[{85583BC8-7711-4927-997C-D49022D1D308}];
                                                                FirstChild=[{04D62F58-F567-46D1-91F1-E6E48E9B1B03}];
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{04D62F58-F567-46D1-91F1-E6E48E9B1B03}] ;Name=Allgemeine Einrichtung;
                                                                CaptionML=[ENU=General Setup;
                                                                           DEA=Allgemeine Einrichtung];
                                                                MemberOfMenu=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                RunObjectType=Page;
                                                                RunObjectID=50001;
                                                                ParentNodeID=[{31C3BB3E-2BBC-4892-B650-73C19FB64BAE}];
                                                                Visible=Yes;
                                                                NextNodeID=[{64997E6A-8F01-4625-BA6E-8C100DC44939}];
                                                                DepartmentCategory=Administration }
    { MenuGroup      ;[{85583BC8-7711-4927-997C-D49022D1D308}] ;Name=PZE Shift;
                                                                CaptionML=[ENU=PZE Shift;
                                                                           DEA=PZE Schicht];
                                                                MemberOfMenu=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                ParentNodeID=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                FirstChild=[{F9F23EBB-4DDA-4A45-8D03-FBDAE82D7E8E}];
                                                                IsDepartmentPage=Yes }
    { MenuItem       ;[{F9F23EBB-4DDA-4A45-8D03-FBDAE82D7E8E}] ;Name=Allgemeine Einrichtung;
                                                                CaptionML=[ENU=General Setup;
                                                                           DEA=Allgemeine Einrichtung];
                                                                MemberOfMenu=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                RunObjectType=Page;
                                                                RunObjectID=50001;
                                                                ParentNodeID=[{85583BC8-7711-4927-997C-D49022D1D308}];
                                                                Visible=Yes;
                                                                NextNodeID=[{31EC7170-2D0B-4229-9602-8223DB444F07}];
                                                                DepartmentCategory=Administration }
    { MenuItem       ;[{31EC7170-2D0B-4229-9602-8223DB444F07}] ;Name=Schichtkalender;
                                                                CaptionML=[ENU=Shift Calendar;
                                                                           DEA=Schichtkalender];
                                                                MemberOfMenu=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                RunObjectType=Page;
                                                                RunObjectID=50002;
                                                                ParentNodeID=[{85583BC8-7711-4927-997C-D49022D1D308}];
                                                                Visible=Yes;
                                                                NextNodeID=[{05B05BAC-6533-48B6-B9CF-106E81009AB4}];
                                                                DepartmentCategory=Tasks }
    { MenuItem       ;[{05B05BAC-6533-48B6-B9CF-106E81009AB4}] ;Name=Schichtzeiten Anpassen;
                                                                CaptionML=[ENU=Adjust Tracked Time Shift;
                                                                           DEA=Schichtzeiten Anpassen];
                                                                MemberOfMenu=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                RunObjectType=Report;
                                                                RunObjectID=50023;
                                                                ParentNodeID=[{85583BC8-7711-4927-997C-D49022D1D308}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Reports and Analysis }
    { MenuItem       ;[{F2B17BCE-5E34-484C-BEEF-5457C02BFD2A}] ;Name=CMMS Bestellungen;
                                                                CaptionML=[ENU=CMMS Purchase Orders;
                                                                           DEA=CMMS Bestellungen];
                                                                MemberOfMenu=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                RunObjectType=Page;
                                                                RunObjectID=70142;
                                                                ParentNodeID=[{D14132FD-CA12-4DA3-8F2B-1CF8B8EE1D00}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Lists }
    { MenuItem       ;[{64997E6A-8F01-4625-BA6E-8C100DC44939}] ;Name=Statusablauf;
                                                                CaptionML=[ENU=Status Sequence;
                                                                           DEA=Statusablauf];
                                                                MemberOfMenu=[{D77FB5E2-2D13-4ACC-BDF1-B8EEC89CCBD7}];
                                                                RunObjectType=Page;
                                                                RunObjectID=50009;
                                                                ParentNodeID=[{31C3BB3E-2BBC-4892-B650-73C19FB64BAE}];
                                                                Visible=Yes;
                                                                NextNodeID=[{00000000-0000-0000-0000-000000000000}];
                                                                DepartmentCategory=Administration }
  }
}
OBJECT Page 22 Customer List
{
  OBJECT-PROPERTIES
  {
    Date=31.10.16;
    Time=08:40:30;
    Modified=Yes;
    Version List=NAVW19.00.00.44974,ENC,CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Customer List;
               DEA=Debitorenbersicht];
    SourceTable=Table18;
    PageType=List;
    CardPageID=Customer Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Approve;
                                DEA=Neu,Verarbeiten,Melden,Genehmigen];
    OnOpenPage=VAR
                 CRMIntegrationManagement@1000 : Codeunit 5330;
               BEGIN
                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;
               END;

    OnAfterGetRecord=BEGIN
                       SetSocialListeningFactboxVisibility;
                     END;

    OnAfterGetCurrRecord=VAR
                           CRMCouplingManagement@1001 : Codeunit 5331;
                         BEGIN
                           SetSocialListeningFactboxVisibility;

                           CRMIsCoupledToRecord :=
                             CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID) AND CRMIntegrationEnabled;
                           OpenApprovalEntriesExist := ApprovalsMgmt.HasOpenApprovalEntries(RECORDID);
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 16      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Customer;
                                 DEA=D&ebitor];
                      Image=Customer }
      { 20      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 DEA=Be&merkungen];
                      RunObject=Page 124;
                      RunPageLink=Table Name=CONST(Customer),
                                  No.=FIELD(No.);
                      Image=ViewComments }
      { 66      ;2   ;ActionGroup;
                      CaptionML=[ENU=Dimensions;
                                 DEA=Dimensionen];
                      Image=Dimensions }
      { 84      ;3   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions-Single;
                                 DEA=Zuordnung fr aktuellen Datensatz];
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(18),
                                  No.=FIELD(No.);
                      Image=Dimensions }
      { 42      ;3   ;Action    ;
                      AccessByPermission=TableData 348=R;
                      CaptionML=[ENU=Dimensions-&Multiple;
                                 DEA=Zuordnung fr &markierte Datens„tze];
                      Image=DimensionSets;
                      OnAction=VAR
                                 Cust@1001 : Record 18;
                                 DefaultDimMultiple@1002 : Page 542;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Cust);
                                 DefaultDimMultiple.SetMultiCust(Cust);
                                 DefaultDimMultiple.RUNMODAL;
                               END;
                                }
      { 58      ;2   ;Action    ;
                      CaptionML=[ENU=Bank Accounts;
                                 DEA=Bankkonten];
                      RunObject=Page 424;
                      RunPageLink=Customer No.=FIELD(No.);
                      Image=BankAccount }
      { 29      ;2   ;Action    ;
                      CaptionML=[ENU=Direct Debit Mandates;
                                 DEA=Lastschrift-Mandate];
                      RunObject=Page 1230;
                      RunPageLink=Customer No.=FIELD(No.);
                      Image=MakeAgreement }
      { 23      ;2   ;Action    ;
                      CaptionML=[ENU=Ship-&to Addresses;
                                 DEA=L&ief. an Adressen];
                      RunObject=Page 301;
                      RunPageLink=Customer No.=FIELD(No.);
                      Image=ShipAddress }
      { 60      ;2   ;Action    ;
                      AccessByPermission=TableData 5050=R;
                      CaptionML=[ENU=C&ontact;
                                 DEA=Ko&ntakt];
                      Image=ContactPerson;
                      OnAction=BEGIN
                                 ShowContact;
                               END;
                                }
      { 45      ;2   ;Action    ;
                      CaptionML=[ENU=Cross Re&ferences;
                                 DEA=Re&ferenzen];
                      RunObject=Page 5723;
                      RunPageView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunPageLink=Cross-Reference Type=CONST(Customer),
                                  Cross-Reference Type No.=FIELD(No.);
                      Image=Change }
      { 67      ;2   ;Action    ;
                      Name=ApprovalEntries;
                      CaptionML=[ENU=Approvals;
                                 DEA=Genehmigungen];
                      Image=Approvals;
                      OnAction=BEGIN
                                 ApprovalsMgmt.OpenApprovalEntriesPage(RECORDID);
                               END;
                                }
      { 44      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 DEA=Dynamics CRM];
                      Visible=CRMIntegrationEnabled }
      { 41      ;2   ;Action    ;
                      Name=CRMGotoAccount;
                      CaptionML=[ENU=Account;
                                 DEA=Konto];
                      ToolTipML=[ENU=Open the coupled Microsoft Dynamics CRM account.;
                                 DEA=™ffnen Sie das gekoppelte Microsoft Dynamics CRM-Konto.];
                      Image=CoupledCustomer;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 37      ;2   ;Action    ;
                      Name=CRMSynchronizeNow;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Synchronize Now;
                                 DEA=Jetzt synchronisieren];
                      ToolTipML=[ENU=Send or get updated data to or from Microsoft Dynamics CRM.;
                                 DEA=Senden Sie aktualisierte Daten an Microsoft Dynamics CRM, oder rufen Sie sie daraus ab.];
                      Image=Refresh;
                      OnAction=VAR
                                 Customer@1000 : Record 18;
                                 CRMIntegrationManagement@1001 : Codeunit 5330;
                                 CustomerRecordRef@1003 : RecordRef;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Customer);
                                 Customer.NEXT;

                                 IF Customer.COUNT = 1 THEN
                                   CRMIntegrationManagement.UpdateOneNow(Customer.RECORDID)
                                 ELSE BEGIN
                                   CustomerRecordRef.GETTABLE(Customer);
                                   CRMIntegrationManagement.UpdateMultipleNow(CustomerRecordRef);
                                 END
                               END;
                                }
      { 97      ;2   ;Action    ;
                      Name=UpdateStatisticsInCRM;
                      CaptionML=[ENU=Update Account Statistics;
                                 DEA=Kontostatistik aktualisieren];
                      ToolTipML=[ENU=Send Customer Statistics data to Microsoft Dynamics CRM to update the Account Statistics factbox;
                                 DEA=Kundenstatistikdaten zum Aktualisieren der Infobox "Kontostatistik" an Microsoft Dynamics CRM senden];
                      Enabled=CRMIsCoupledToRecord;
                      Image=UpdateXML;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.CreateOrUpdateCRMAccountStatistics(Rec);
                               END;
                                }
      { 31      ;2   ;ActionGroup;
                      Name=Coupling;
                      CaptionML=[@@@=Coupling is a noun;
                                 ENU=Coupling;
                                 DEA=Kopplung];
                      ToolTipML=[ENU=Create, change, or delete a coupling between the Microsoft Dynamics NAV record and a Microsoft Dynamics CRM record.;
                                 DEA=Erstellen, „ndern oder l”schen Sie eine Kopplung zwischen dem Microsoft Dynamics NAV-Datensatz und einem Microsoft Dynamics CRM-Datensatz.];
                      Image=LinkAccount }
      { 49      ;3   ;Action    ;
                      Name=ManageCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Set Up Coupling;
                                 DEA=Kopplung einrichten];
                      ToolTipML=[ENU=Create or modify the coupling to a Microsoft Dynamics CRM account.;
                                 DEA=Erstellen oder „ndern Sie die Kopplung mit einem Microsoft Dynamics CRM-Konto.];
                      Image=LinkAccount;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.CreateOrUpdateCoupling(RECORDID);
                               END;
                                }
      { 47      ;3   ;Action    ;
                      Name=DeleteCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Delete Coupling;
                                 DEA=Kopplung l”schen];
                      ToolTipML=[ENU=Delete the coupling to a Microsoft Dynamics CRM account.;
                                 DEA=L”schen Sie die Kopplung mit einem Microsoft Dynamics CRM-Konto.];
                      Enabled=CRMIsCoupledToRecord;
                      Image=UnLinkAccount;
                      OnAction=VAR
                                 CRMCouplingManagement@1000 : Codeunit 5331;
                               BEGIN
                                 CRMCouplingManagement.RemoveCoupling(RECORDID);
                               END;
                                }
      { 53      ;2   ;ActionGroup;
                      Name=Create;
                      CaptionML=[ENU=Create;
                                 DEA=Erstellen];
                      Image=NewCustomer }
      { 57      ;3   ;Action    ;
                      Name=CreateInCRM;
                      CaptionML=[ENU=Create Account in Dynamics CRM;
                                 DEA=Konto in Dynamics CRM erstellen];
                      Image=NewCustomer;
                      OnAction=VAR
                                 Customer@1001 : Record 18;
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                                 CustomerRecordRef@1002 : RecordRef;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Customer);
                                 Customer.NEXT;

                                 IF Customer.COUNT = 1 THEN
                                   CRMIntegrationManagement.CreateNewRecordInCRM(RECORDID,FALSE)
                                 ELSE BEGIN
                                   CustomerRecordRef.GETTABLE(Customer);
                                   CRMIntegrationManagement.CreateNewRecordsInCRM(CustomerRecordRef);
                                 END
                               END;
                                }
      { 17      ;3   ;Action    ;
                      Name=CreateFromCRM;
                      CaptionML=[ENU=Create Customer in Dynamics NAV;
                                 DEA=Debitor in Dynamics NAV erstellen];
                      Image=NewCustomer;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ManageCreateNewRecordFromCRM(DATABASE::Customer);
                               END;
                                }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=History;
                                 DEA=Historie];
                      Image=History }
      { 22      ;2   ;Action    ;
                      Name=CustomerLedgerEntries;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 DEA=&Posten];
                      RunObject=Page 25;
                      RunPageView=SORTING(Customer No.);
                      RunPageLink=Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=CustomerLedger;
                      PromotedCategory=Process }
      { 18      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 DEA=Statistik];
                      RunObject=Page 151;
                      RunPageLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 21      ;2   ;Action    ;
                      CaptionML=[ENU=S&ales;
                                 DEA=&Verkauf];
                      RunObject=Page 155;
                      RunPageLink=No.=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Image=Sales }
      { 19      ;2   ;Action    ;
                      CaptionML=[ENU=Entry Statistics;
                                 DEA=Buchungsstatistik];
                      RunObject=Page 302;
                      RunPageLink=No.=FIELD(No.),
                                  Date Filter=FIELD(Date Filter),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                      Image=EntryStatistics }
      { 63      ;2   ;Action    ;
                      CaptionML=[ENU=Statistics by C&urrencies;
                                 DEA=Statistik nach &W„hrungen];
                      RunObject=Page 486;
                      RunPageLink=Customer Filter=FIELD(No.),
                                  Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                                  Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter),
                                  Date Filter=FIELD(Date Filter);
                      Image=Currencies }
      { 6500    ;2   ;Action    ;
                      CaptionML=[ENU=Item &Tracking Entries;
                                 DEA=Artikel&verfolgungsposten];
                      Image=ItemTrackingLedger;
                      OnAction=VAR
                                 ItemTrackingDocMgt@1001 : Codeunit 6503;
                               BEGIN
                                 ItemTrackingDocMgt.ShowItemTrackingForMasterData(1,"No.",'','','','','');
                               END;
                                }
      { 24      ;1   ;ActionGroup;
                      CaptionML=[ENU=S&ales;
                                 DEA=&Verkauf];
                      Image=Sales }
      { 25      ;2   ;Action    ;
                      Name=Sales_InvoiceDiscounts;
                      CaptionML=[ENU=Invoice &Discounts;
                                 DEA=&Rechnungsrabatte];
                      RunObject=Page 23;
                      RunPageLink=Code=FIELD(Invoice Disc. Code);
                      Image=CalculateInvoiceDiscount }
      { 26      ;2   ;Action    ;
                      Name=Sales_Prices;
                      CaptionML=[ENU=Prices;
                                 DEA=Preise];
                      RunObject=Page 7002;
                      RunPageView=SORTING(Sales Type,Sales Code);
                      RunPageLink=Sales Type=CONST(Customer),
                                  Sales Code=FIELD(No.);
                      Image=Price }
      { 71      ;2   ;Action    ;
                      Name=Sales_LineDiscounts;
                      CaptionML=[ENU=Line Discounts;
                                 DEA=Zeilenrabatte];
                      RunObject=Page 7004;
                      RunPageView=SORTING(Sales Type,Sales Code);
                      RunPageLink=Sales Type=CONST(Customer),
                                  Sales Code=FIELD(No.);
                      Image=LineDiscount }
      { 82      ;2   ;Action    ;
                      CaptionML=[ENU=Prepa&yment Percentages;
                                 DEA=&Vorauszahlungsprozents„tze];
                      RunObject=Page 664;
                      RunPageView=SORTING(Sales Type,Sales Code);
                      RunPageLink=Sales Type=CONST(Customer),
                                  Sales Code=FIELD(No.);
                      Image=PrepaymentPercentages }
      { 75      ;2   ;Action    ;
                      CaptionML=[ENU=S&td. Cust. Sales Codes;
                                 DEA=S&td.-Debitorverkaufscodes];
                      RunObject=Page 173;
                      RunPageLink=Customer No.=FIELD(No.);
                      Image=CodesList }
      { 11      ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 DEA=Belege];
                      Image=Documents }
      { 27      ;2   ;Action    ;
                      CaptionML=[ENU=Quotes;
                                 DEA=Angebote];
                      RunObject=Page 9300;
                      RunPageView=SORTING(Sell-to Customer No.);
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Image=Quote }
      { 28      ;2   ;Action    ;
                      CaptionML=[ENU=Orders;
                                 DEA=Auftr„ge];
                      RunObject=Page 9305;
                      RunPageView=SORTING(Sell-to Customer No.);
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Image=Document }
      { 70      ;2   ;Action    ;
                      CaptionML=[ENU=Return Orders;
                                 DEA=Reklamationen];
                      RunObject=Page 9304;
                      RunPageView=SORTING(Sell-to Customer No.);
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Image=ReturnOrder }
      { 76      ;2   ;ActionGroup;
                      CaptionML=[ENU=Issued Documents;
                                 DEA=Registrierte Belege];
                      Image=Documents }
      { 77      ;3   ;Action    ;
                      CaptionML=[ENU=Issued &Reminders;
                                 DEA=Registrierte &Mahnungen];
                      RunObject=Page 440;
                      RunPageView=SORTING(Customer No.,Posting Date);
                      RunPageLink=Customer No.=FIELD(No.);
                      Image=OrderReminder }
      { 78      ;3   ;Action    ;
                      CaptionML=[ENU=Issued &Finance Charge Memos;
                                 DEA=Registrierte &Zinsrechnungen];
                      RunObject=Page 452;
                      RunPageView=SORTING(Customer No.,Posting Date);
                      RunPageLink=Customer No.=FIELD(No.);
                      Image=FinChargeMemo }
      { 65      ;2   ;Action    ;
                      CaptionML=[ENU=Blanket Orders;
                                 DEA=Rahmenauftr„ge];
                      RunObject=Page 9303;
                      RunPageView=SORTING(Document Type,Sell-to Customer No.);
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Image=BlanketOrder }
      { 13      ;1   ;ActionGroup;
                      CaptionML=[ENU=Credit Card;
                                 DEA=Kreditkarte];
                      Image=CreditCard }
      { 15      ;2   ;ActionGroup;
                      CaptionML=[ENU=Credit Cards;
                                 DEA=Kreditkarten];
                      Image=CreditCard }
      { 85      ;3   ;Action    ;
                      CaptionML=[ENU=C&redit Cards;
                                 DEA=K&reditkarten];
                      RunObject=Page 828;
                      RunPageLink=Customer No.=FIELD(No.);
                      Image=CreditCard }
      { 86      ;3   ;Action    ;
                      CaptionML=[ENU=Credit Cards Transaction Lo&g Entries;
                                 DEA=Transaktionspro&tokolleintr„ge fr Kreditkarten];
                      RunObject=Page 829;
                      RunPageLink=Customer No.=FIELD(No.);
                      Image=CreditCardLog }
      { 14      ;1   ;ActionGroup;
                      CaptionML=[ENU=Service;
                                 DEA=Service];
                      Image=ServiceItem }
      { 81      ;2   ;Action    ;
                      CaptionML=[ENU=Service Orders;
                                 DEA=Serviceauftr„ge];
                      RunObject=Page 9318;
                      RunPageView=SORTING(Document Type,Customer No.);
                      RunPageLink=Customer No.=FIELD(No.);
                      Image=Document }
      { 68      ;2   ;Action    ;
                      CaptionML=[ENU=Ser&vice Contracts;
                                 DEA=S&ervicevertr„ge];
                      RunObject=Page 6065;
                      RunPageView=SORTING(Customer No.,Ship-to Code);
                      RunPageLink=Customer No.=FIELD(No.);
                      Image=ServiceAgreement }
      { 69      ;2   ;Action    ;
                      CaptionML=[ENU=Service &Items;
                                 DEA=Service&artikel];
                      RunObject=Page 5988;
                      RunPageView=SORTING(Customer No.,Ship-to Code,Item No.,Serial No.);
                      RunPageLink=Customer No.=FIELD(No.);
                      Image=ServiceItem }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1902575205;1 ;Action    ;
                      CaptionML=[ENU=Blanket Sales Order;
                                 DEA=Rahmenauftrag];
                      RunObject=Page 507;
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=BlanketOrder;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1900246505;1 ;Action    ;
                      CaptionML=[ENU=Sales Quote;
                                 DEA=Verkaufsangebot];
                      RunObject=Page 41;
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1906384905;1 ;Action    ;
                      CaptionML=[ENU=Sales Invoice;
                                 DEA=Verkaufsrechnung];
                      RunObject=Page 43;
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1904747105;1 ;Action    ;
                      CaptionML=[ENU=Sales Order;
                                 DEA=Verkaufsauftrag];
                      RunObject=Page 42;
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Document;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1902583505;1 ;Action    ;
                      CaptionML=[ENU=Sales Credit Memo;
                                 DEA=Verkaufsgutschrift];
                      RunObject=Page 44;
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1905163705;1 ;Action    ;
                      CaptionML=[ENU=Sales Return Order;
                                 DEA=Verkaufsreklamation];
                      RunObject=Page 6630;
                      RunPageLink=Sell-to Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=ReturnOrder;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1905185205;1 ;Action    ;
                      CaptionML=[ENU=Service Quote;
                                 DEA=Serviceangebot];
                      RunObject=Page 5964;
                      RunPageLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Quote;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1902079405;1 ;Action    ;
                      CaptionML=[ENU=Service Invoice;
                                 DEA=Servicerechnung];
                      RunObject=Page 5933;
                      RunPageLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Invoice;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1907102005;1 ;Action    ;
                      CaptionML=[ENU=Service Order;
                                 DEA=Serviceauftrag];
                      RunObject=Page 5900;
                      RunPageLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=Document;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1901662105;1 ;Action    ;
                      CaptionML=[ENU=Service Credit Memo;
                                 DEA=Servicegutschrift];
                      RunObject=Page 5935;
                      RunPageLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1903839805;1 ;Action    ;
                      CaptionML=[ENU=Reminder;
                                 DEA=Mahnung];
                      RunObject=Page 434;
                      RunPageLink=Customer No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Reminder;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1901102005;1 ;Action    ;
                      CaptionML=[ENU=Finance Charge Memo;
                                 DEA=Zinsrechnung];
                      RunObject=Page 446;
                      RunPageLink=Customer No.=FIELD(No.);
                      Promoted=No;
                      Image=FinChargeMemo;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 55      ;1   ;ActionGroup;
                      CaptionML=[ENU=Request Approval;
                                 DEA=Genehmigungsanforderung];
                      Image=SendApprovalRequest }
      { 51      ;2   ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 DEA=&Genehmigungsanforderung senden];
                      Enabled=NOT OpenApprovalEntriesExist;
                      Image=SendApprovalRequest;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckCustomerApprovalsWorkflowEnabled(Rec) THEN
                                   ApprovalsMgmt.OnSendCustomerForApproval(Rec);
                               END;
                                }
      { 39      ;2   ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 DEA=&Genehmigungsanforderung stornieren];
                      Enabled=OpenApprovalEntriesExist;
                      Image=Cancel;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelCustomerApprovalRequest(Rec);
                               END;
                                }
      { 1900839804;1 ;Action    ;
                      CaptionML=[ENU=Cash Receipt Journal;
                                 DEA=Zahlungseingangs Buch.-Blatt];
                      RunObject=Page 255;
                      Promoted=Yes;
                      Image=CashReceiptJournal;
                      PromotedCategory=Process }
      { 1905171704;1 ;Action    ;
                      CaptionML=[ENU=Sales Journal;
                                 DEA=Verkaufs Buch.-Blatt];
                      RunObject=Page 253;
                      Promoted=Yes;
                      Image=Journals;
                      PromotedCategory=Process }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 3       ;1   ;ActionGroup;
                      CaptionML=[ENU=General;
                                 DEA=Allgemein] }
      { 1905562606;2 ;Action    ;
                      CaptionML=[ENU=Customer List;
                                 DEA=Debitorenbersicht];
                      RunObject=Report 101;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1901007206;2 ;Action    ;
                      CaptionML=[ENU=Customer Register;
                                 DEA=Debitorenjournal];
                      RunObject=Report 103;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1907152806;2 ;Action    ;
                      CaptionML=[ENU=Customer - Top 10 List;
                                 DEA=Debitor - Top 10 Liste];
                      RunObject=Report 111;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
      { 5       ;1   ;ActionGroup;
                      CaptionML=[ENU=Sales;
                                 DEA=Verkauf];
                      Image=Sales }
      { 1905727106;2 ;Action    ;
                      CaptionML=[ENU=Customer - Order Summary;
                                 DEA=Debitor - Auftragsbersicht];
                      RunObject=Report 107;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
      { 1900172506;2 ;Action    ;
                      CaptionML=[ENU=Customer - Order Detail;
                                 DEA=Debitor - Auftr„ge];
                      RunObject=Report 108;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1906073506;2 ;Action    ;
                      CaptionML=[ENU=Customer - Sales List;
                                 DEA=Debitor - Verkaufsbersicht];
                      RunObject=Report 119;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
      { 1904190506;2 ;Action    ;
                      CaptionML=[ENU=Sales Statistics;
                                 DEA=Verkaufsstatistik];
                      RunObject=Report 112;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1900760706;2 ;Action    ;
                      CaptionML=[ENU=Customer/Item Sales;
                                 DEA=Debitor/Artikel Statistik];
                      RunObject=Report 113;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 7       ;1   ;ActionGroup;
                      CaptionML=[ENU=Financial Management;
                                 DEA=Finanzmanagement];
                      Image=Report }
      { 1906871306;2 ;Action    ;
                      CaptionML=[ENU=Customer - Detail Trial Bal.;
                                 DEA=Debitor - Kontoblatt];
                      RunObject=Report 104;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1907944606;2 ;Action    ;
                      CaptionML=[ENU=Customer - Summary Aging;
                                 DEA=Debitor - Saldo nach Perioden];
                      RunObject=Report 105;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1906813206;2 ;Action    ;
                      CaptionML=[ENU=Customer Detailed Aging;
                                 DEA=Debitor - F„llige Posten];
                      RunObject=Report 106;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1055    ;2   ;Action    ;
                      Name=Statement;
                      CaptionML=[ENU=Statement;
                                 DEA=Kontoauszug];
                      RunObject=Codeunit 8810;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
      { 1903839806;2 ;Action    ;
                      CaptionML=[ENU=Reminder;
                                 DEA=Mahnung];
                      RunObject=Report 117;
                      Promoted=No;
                      Image=Reminder;
                      PromotedCategory=Report }
      { 1900711606;2 ;Action    ;
                      CaptionML=[ENU=Aged Accounts Receivable;
                                 DEA=Debitor - Saldenrckblick];
                      RunObject=Report 120;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
      { 1902299006;2 ;Action    ;
                      CaptionML=[ENU=Customer - Balance to Date;
                                 DEA=Debitorenposten per];
                      RunObject=Report 121;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
      { 1906359306;2 ;Action    ;
                      CaptionML=[ENU=Customer - Trial Balance;
                                 DEA=Debitor - Saldenliste];
                      RunObject=Report 129;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1904039606;2 ;Action    ;
                      CaptionML=[ENU=Customer - Payment Receipt;
                                 DEA=Debitor - Zahlungseingang];
                      RunObject=Report 211;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 40  ;2   ;Field     ;
                SourceExpr="Responsibility Center" }

    { 43  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 54  ;2   ;Field     ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 30  ;2   ;Field     ;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 32  ;2   ;Field     ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 79  ;2   ;Field     ;
                SourceExpr="IC Partner Code";
                Visible=FALSE }

    { 34  ;2   ;Field     ;
                SourceExpr=Contact }

    { 36  ;2   ;Field     ;
                SourceExpr="Salesperson Code";
                Visible=FALSE }

    { 38  ;2   ;Field     ;
                SourceExpr="Customer Posting Group";
                Visible=FALSE }

    { 56  ;2   ;Field     ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 52  ;2   ;Field     ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 46  ;2   ;Field     ;
                SourceExpr="Customer Price Group";
                Visible=FALSE }

    { 72  ;2   ;Field     ;
                SourceExpr="Customer Disc. Group";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 61  ;2   ;Field     ;
                SourceExpr="Reminder Terms Code";
                Visible=FALSE }

    { 48  ;2   ;Field     ;
                SourceExpr="Fin. Charge Terms Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 50  ;2   ;Field     ;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 1102601000;2;Field  ;
                SourceExpr="Credit Limit (LCY)";
                Visible=FALSE }

    { 1102601002;2;Field  ;
                SourceExpr=Blocked;
                Visible=FALSE }

    { 1102601004;2;Field  ;
                SourceExpr="Last Date Modified";
                Visible=FALSE }

    { 1102601006;2;Field  ;
                SourceExpr="Application Method";
                Visible=FALSE }

    { 1102601008;2;Field  ;
                SourceExpr="Combine Shipments";
                Visible=FALSE }

    { 1102601010;2;Field  ;
                SourceExpr=Reserve;
                Visible=FALSE }

    { 1102601012;2;Field  ;
                SourceExpr="Shipping Advice";
                Visible=FALSE }

    { 1102601014;2;Field  ;
                SourceExpr="Shipping Agent Code";
                Visible=FALSE }

    { 1102601016;2;Field  ;
                SourceExpr="Base Calendar Code";
                Visible=FALSE }

    { 1000000002;2;Field  ;
                Name=ENC Chain Name;
                SourceExpr="Chain Name" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 99  ;1   ;Part      ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page5360;
                Visible=CRMIsCoupledToRecord;
                PartType=Page }

    { 35  ;1   ;Part      ;
                SubPageLink=Source Type=CONST(Customer),
                            Source No.=FIELD(No.);
                PagePartID=Page875;
                Visible=SocialListeningVisible;
                PartType=Page }

    { 33  ;1   ;Part      ;
                SubPageLink=Source Type=CONST(Customer),
                            Source No.=FIELD(No.);
                PagePartID=Page876;
                Visible=SocialListeningSetupVisible;
                PartType=Page;
                UpdatePropagation=Both }

    { 1903720907;1;Part   ;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9080;
                Visible=TRUE;
                PartType=Page }

    { 1907234507;1;Part   ;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9081;
                Visible=FALSE;
                PartType=Page }

    { 1902018507;1;Part   ;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9082;
                Visible=TRUE;
                PartType=Page }

    { 1900316107;1;Part   ;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9084;
                Visible=FALSE;
                PartType=Page }

    { 1907829707;1;Part   ;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9085;
                Visible=FALSE;
                PartType=Page }

    { 1902613707;1;Part   ;
                SubPageLink=No.=FIELD(No.),
                            Currency Filter=FIELD(Currency Filter),
                            Date Filter=FIELD(Date Filter),
                            Global Dimension 1 Filter=FIELD(Global Dimension 1 Filter),
                            Global Dimension 2 Filter=FIELD(Global Dimension 2 Filter);
                PagePartID=Page9086;
                Visible=FALSE;
                PartType=Page }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      ApprovalsMgmt@1005 : Codeunit 1535;
      SocialListeningSetupVisible@1000 : Boolean;
      SocialListeningVisible@1001 : Boolean;
      CRMIntegrationEnabled@1003 : Boolean;
      CRMIsCoupledToRecord@1002 : Boolean;
      OpenApprovalEntriesExist@1004 : Boolean;

    PROCEDURE GetSelectionFilter@2() : Text;
    VAR
      Cust@1001 : Record 18;
      SelectionFilterManagement@1002 : Codeunit 46;
    BEGIN
      CurrPage.SETSELECTIONFILTER(Cust);
      EXIT(SelectionFilterManagement.GetSelectionFilterForCustomer(Cust));
    END;

    PROCEDURE SetSelection@1(VAR Cust@1000 : Record 18);
    BEGIN
      CurrPage.SETSELECTIONFILTER(Cust);
    END;

    LOCAL PROCEDURE SetSocialListeningFactboxVisibility@3();
    VAR
      SocialListeningMgt@1000 : Codeunit 871;
    BEGIN
      SocialListeningMgt.GetCustFactboxVisibility(Rec,SocialListeningSetupVisible,SocialListeningVisible);
    END;

    PROCEDURE CMSetCompany@1000000000(CompName@1000000000 : Text[30]);
    BEGIN
      CHANGECOMPANY(CompName);
    END;

    BEGIN
    {
      CM  20161010 Added Function CMSetCompany();
      ENC 20160905  Added Field "Chain Name"
    }
    END.
  }
}

OBJECT Page 119 User Setup
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=14:17:33;
    Modified=Yes;
    Version List=NAVW17.00,CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=User Setup;
               DEA=Benutzer Einrichtung];
    SourceTable=Table91;
    PageType=List;
    CardPageID=CMMS User Setup Card;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="User ID" }

    { 1000000002;2;Field  ;
                SourceExpr="CM Name" }

    { 4   ;2   ;Field     ;
                SourceExpr="Allow Posting From" }

    { 6   ;2   ;Field     ;
                SourceExpr="Allow Posting To" }

    { 8   ;2   ;Field     ;
                SourceExpr="Register Time" }

    { 15  ;2   ;Field     ;
                SourceExpr="Sales Resp. Ctr. Filter" }

    { 17  ;2   ;Field     ;
                SourceExpr="Purchase Resp. Ctr. Filter" }

    { 21  ;2   ;Field     ;
                SourceExpr="Service Resp. Ctr. Filter" }

    { 3   ;2   ;Field     ;
                SourceExpr="Time Sheet Admin." }

    { 1000000000;2;Field  ;
                Name=ENC E-Mail;
                SourceExpr="E-Mail" }

    { 1000000001;2;Field  ;
                SourceExpr="IG Phone No." }

    { 1000000003;2;Field  ;
                SourceExpr="IG Fax No." }

    { 1000000004;2;Field  ;
                SourceExpr="CM Notifications" }

    { 1000000005;2;Field  ;
                SourceExpr="CM Connector" }

    { 1000000006;2;Field  ;
                SourceExpr="CM Connector Id" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    {
      ENC 20160905  Added Fields "E-Mail", "Fax No."
    }
    END.
  }
}

OBJECT Page 5052 Contact List
{
  OBJECT-PROPERTIES
  {
    Date=31.03.17;
    Time=11:45:15;
    Modified=Yes;
    Version List=NAVW19.00,CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Contact List;
               DEA=Kontaktbersicht];
    SourceTable=Table5050;
    SourceTableView=SORTING(Company Name,Company No.,Type,Name);
    DataCaptionFields=Company No.;
    PageType=List;
    CardPageID=Contact Card;
    OnOpenPage=VAR
                 CRMIntegrationManagement@1000 : Codeunit 5330;
               BEGIN
                 CRMIntegrationEnabled := CRMIntegrationManagement.IsCRMIntegrationEnabled;
                 SETRANGE("CMMS Is CMMS Contact", FALSE);//CMMS
               END;

    OnAfterGetRecord=VAR
                       CRMCouplingManagement@1001 : Codeunit 5331;
                     BEGIN
                       EnableFields;
                       StyleIsStrong := Type = Type::Company;

                       NameIndent := 0;
                       IF Type <> Type::Company THEN BEGIN
                         Cont.SETCURRENTKEY("Company Name","Company No.",Type,Name);
                         IF ("Company No." <> '') AND (NOT HASFILTER) AND (NOT MARKEDONLY) AND (CURRENTKEY = Cont.CURRENTKEY) THEN
                           NameIndent := 1
                       END;

                       IF CRMIntegrationEnabled THEN
                         CRMIsCoupledToRecord := CRMCouplingManagement.IsRecordCoupledToCRM(RECORDID);
                     END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 29      ;1   ;ActionGroup;
                      CaptionML=[ENU=C&ontact;
                                 DEA=Ko&ntakt];
                      Image=ContactPerson }
      { 34      ;2   ;ActionGroup;
                      CaptionML=[ENU=Comp&any;
                                 DEA=Un&ternehmen];
                      Enabled=CompanyGroupEnabled;
                      Image=Company }
      { 35      ;3   ;Action    ;
                      CaptionML=[ENU=Business Relations;
                                 DEA=Gesch„ftsbeziehungen];
                      RunObject=Page 5061;
                      RunPageLink=Contact No.=FIELD(Company No.);
                      Image=BusinessRelation }
      { 36      ;3   ;Action    ;
                      CaptionML=[ENU=Industry Groups;
                                 DEA=Branchen];
                      RunObject=Page 5067;
                      RunPageLink=Contact No.=FIELD(Company No.);
                      Image=IndustryGroups }
      { 37      ;3   ;Action    ;
                      CaptionML=[ENU=Web Sources;
                                 DEA=Internetfavoriten];
                      RunObject=Page 5070;
                      RunPageLink=Contact No.=FIELD(Company No.);
                      Image=Web }
      { 38      ;2   ;ActionGroup;
                      CaptionML=[ENU=P&erson;
                                 DEA=&Person];
                      Enabled=PersonGroupEnabled;
                      Image=User }
      { 39      ;3   ;Action    ;
                      CaptionML=[ENU=Job Responsibilities;
                                 DEA=Verantwortlichkeiten];
                      Image=Job;
                      OnAction=VAR
                                 ContJobResp@1001 : Record 5067;
                               BEGIN
                                 TESTFIELD(Type,Type::Person);
                                 ContJobResp.SETRANGE("Contact No.","No.");
                                 PAGE.RUNMODAL(PAGE::"Contact Job Responsibilities",ContJobResp);
                               END;
                                }
      { 41      ;2   ;Action    ;
                      CaptionML=[ENU=Pro&files;
                                 DEA=Pr&ofile];
                      Image=Answers;
                      OnAction=VAR
                                 ProfileManagement@1001 : Codeunit 5059;
                               BEGIN
                                 ProfileManagement.ShowContactQuestionnaireCard(Rec,'',0);
                               END;
                                }
      { 43      ;2   ;Action    ;
                      CaptionML=[ENU=&Picture;
                                 DEA=Bi&ld];
                      RunObject=Page 5104;
                      RunPageLink=No.=FIELD(No.);
                      Image=Picture }
      { 44      ;2   ;Action    ;
                      CaptionML=[ENU=Co&mments;
                                 DEA=Be&merkungen];
                      RunObject=Page 5072;
                      RunPageLink=Table Name=CONST(Contact),
                                  No.=FIELD(No.),
                                  Sub No.=CONST(0);
                      Image=ViewComments }
      { 45      ;2   ;ActionGroup;
                      CaptionML=[ENU=Alternati&ve Address;
                                 DEA=Al&ternative Adressen];
                      Image=Addresses }
      { 46      ;3   ;Action    ;
                      CaptionML=[ENU=Card;
                                 DEA=Karte];
                      RunObject=Page 5057;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=EditLines }
      { 47      ;3   ;Action    ;
                      CaptionML=[ENU=Date Ranges;
                                 DEA=Gltigkeiten];
                      RunObject=Page 5059;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=DateRange }
      { 48      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 DEA=""] }
      { 25      ;1   ;ActionGroup;
                      Name=ActionGroupCRM;
                      CaptionML=[ENU=Dynamics CRM;
                                 DEA=Dynamics CRM];
                      Visible=CRMIntegrationEnabled }
      { 23      ;2   ;Action    ;
                      Name=CRMGotoContact;
                      CaptionML=[ENU=Contact;
                                 DEA=Kontakt];
                      ToolTipML=[ENU=Open the coupled Microsoft Dynamics CRM contact.;
                                 DEA=™ffnen Sie den gekoppelten Microsoft Dynamics CRM-Kontakt.];
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=CoupledContactPerson;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ShowCRMEntityFromRecordID(RECORDID);
                               END;
                                }
      { 27      ;2   ;Action    ;
                      Name=CRMSynchronizeNow;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Synchronize Now;
                                 DEA=Jetzt synchronisieren];
                      ToolTipML=[ENU=Send or get updated data to or from Microsoft Dynamics CRM.;
                                 DEA=Senden Sie aktualisierte Daten an Microsoft Dynamics CRM, oder rufen Sie sie daraus ab.];
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=Refresh;
                      OnAction=VAR
                                 Contact@1000 : Record 5050;
                                 CRMIntegrationManagement@1001 : Codeunit 5330;
                                 ContactRecordRef@1002 : RecordRef;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Contact);
                                 Contact.NEXT;

                                 IF Contact.COUNT = 1 THEN
                                   CRMIntegrationManagement.UpdateOneNow(Contact.RECORDID)
                                 ELSE BEGIN
                                   ContactRecordRef.GETTABLE(Contact);
                                   CRMIntegrationManagement.UpdateMultipleNow(ContactRecordRef);
                                 END
                               END;
                                }
      { 26      ;2   ;ActionGroup;
                      Name=Coupling;
                      CaptionML=[@@@=Coupling is a noun;
                                 ENU=Coupling;
                                 DEA=Kopplung];
                      ToolTipML=[ENU=Create, change, or delete a coupling between the Microsoft Dynamics NAV record and a Microsoft Dynamics CRM record.;
                                 DEA=Erstellen, „ndern oder l”schen Sie eine Kopplung zwischen dem Microsoft Dynamics NAV-Datensatz und einem Microsoft Dynamics CRM-Datensatz.];
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=LinkAccount }
      { 21      ;3   ;Action    ;
                      Name=ManageCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Set Up Coupling;
                                 DEA=Kopplung einrichten];
                      ToolTipML=[ENU=Create or modify the coupling to a Microsoft Dynamics CRM contact.;
                                 DEA=Erstellen Sie die Kopplung mit einem Microsoft Dynamics CRM-Kontakt oder „ndern Sie diese.];
                      Image=LinkAccount;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.CreateOrUpdateCoupling(RECORDID);
                               END;
                                }
      { 19      ;3   ;Action    ;
                      Name=DeleteCRMCoupling;
                      AccessByPermission=TableData 5331=IM;
                      CaptionML=[ENU=Delete Coupling;
                                 DEA=Kopplung l”schen];
                      ToolTipML=[ENU=Delete the coupling to a Microsoft Dynamics CRM contact.;
                                 DEA=L”schen Sie die Kopplung mit einem Microsoft Dynamics CRM-Kontakt.];
                      Enabled=CRMIsCoupledToRecord;
                      Image=UnLinkAccount;
                      OnAction=VAR
                                 CRMCouplingManagement@1000 : Codeunit 5331;
                               BEGIN
                                 CRMCouplingManagement.RemoveCoupling(RECORDID);
                               END;
                                }
      { 17      ;2   ;ActionGroup;
                      Name=Create;
                      CaptionML=[ENU=Create;
                                 DEA=Erstellen];
                      Image=NewCustomer }
      { 15      ;3   ;Action    ;
                      Name=CreateInCRM;
                      CaptionML=[ENU=Create Contact in Dynamics CRM;
                                 DEA=Kontakt in Dynamics CRM erstellen];
                      Enabled=(Type <> Type::Company) AND ("Company No." <> '');
                      Image=NewCustomer;
                      OnAction=VAR
                                 Contact@1001 : Record 5050;
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                                 ContactRecordRef@1002 : RecordRef;
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Contact);
                                 Contact.NEXT;

                                 IF Contact.COUNT = 1 THEN
                                   CRMIntegrationManagement.CreateNewRecordInCRM(RECORDID,FALSE)
                                 ELSE BEGIN
                                   ContactRecordRef.GETTABLE(Contact);
                                   CRMIntegrationManagement.CreateNewRecordsInCRM(ContactRecordRef);
                                 END
                               END;
                                }
      { 13      ;3   ;Action    ;
                      Name=CreateFromCRM;
                      CaptionML=[ENU=Create Contact in Dynamics NAV;
                                 DEA=Kontakt in Dynamics NAV erstellen];
                      Image=NewCustomer;
                      OnAction=VAR
                                 CRMIntegrationManagement@1000 : Codeunit 5330;
                               BEGIN
                                 CRMIntegrationManagement.ManageCreateNewRecordFromCRM(DATABASE::Contact);
                               END;
                                }
      { 5       ;1   ;ActionGroup;
                      CaptionML=[ENU=Related Information;
                                 DEA=Verknpfte Informationen];
                      Image=Users }
      { 33      ;2   ;Action    ;
                      CaptionML=[ENU=Relate&d Contacts;
                                 DEA=Zugeh”rige Ko&ntakte];
                      RunObject=Page 5052;
                      RunPageLink=Company No.=FIELD(Company No.);
                      Image=Users }
      { 55      ;2   ;Action    ;
                      CaptionML=[ENU=Segmen&ts;
                                 DEA=S&egmente];
                      RunObject=Page 5150;
                      RunPageView=SORTING(Contact No.,Segment No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=Segment }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=Mailing &Groups;
                                 DEA=&Verteiler];
                      RunObject=Page 5064;
                      RunPageLink=Contact No.=FIELD(No.);
                      Image=DistributionGroup }
      { 53      ;2   ;Action    ;
                      CaptionML=[ENU=C&ustomer/Vendor/Bank Acc.;
                                 DEA=&Debitor/Kreditor/Bankkonto];
                      Image=ContactReference;
                      OnAction=BEGIN
                                 ShowCustVendBank;
                               END;
                                }
      { 7       ;1   ;ActionGroup;
                      CaptionML=[ENU=Tasks;
                                 DEA=Aufgaben];
                      Image=Task }
      { 50      ;2   ;Action    ;
                      CaptionML=[ENU=T&o-dos;
                                 DEA=Aufga&ben];
                      RunObject=Page 5096;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.)),
                                  System To-do Type=FILTER(Contact Attendee);
                      Image=TaskList }
      { 3       ;2   ;Action    ;
                      CaptionML=[ENU=Oppo&rtunities;
                                 DEA=Verkaufs&chancen];
                      RunObject=Page 5123;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=OpportunityList }
      { 52      ;2   ;Separator ;
                      CaptionML=[ENU="";
                                 DEA=""] }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=Documents;
                                 DEA=Belege];
                      Image=Documents }
      { 68      ;2   ;Action    ;
                      CaptionML=[ENU=Sales &Quotes;
                                 DEA=&Angebote];
                      RunObject=Page 9300;
                      RunPageView=SORTING(Document Type,Sell-to Contact No.);
                      RunPageLink=Sell-to Contact No.=FIELD(No.);
                      Image=Quote }
      { 69      ;2   ;Separator  }
      { 11      ;1   ;ActionGroup;
                      CaptionML=[ENU=History;
                                 DEA=Historie];
                      Image=History }
      { 76      ;2   ;Action    ;
                      CaptionML=[ENU=Postponed &Interactions;
                                 DEA=Zurckgestellte &Aktivit„ten];
                      RunObject=Page 5082;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=PostponedInteractions }
      { 49      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Interaction Log E&ntries;
                                 DEA=Aktivit&„tenprotokollposten];
                      RunObject=Page 5076;
                      RunPageView=SORTING(Contact Company No.,Contact No.);
                      RunPageLink=Contact Company No.=FIELD(Company No.),
                                  Contact No.=FILTER(<>''),
                                  Contact No.=FIELD(FILTER(Lookup Contact No.));
                      Image=InteractionLog }
      { 42      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 DEA=Statistik];
                      RunObject=Page 5053;
                      RunPageLink=No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 30      ;1   ;ActionGroup;
                      CaptionML=[ENU=F&unctions;
                                 DEA=F&unktion];
                      Image=Action }
      { 54      ;2   ;Action    ;
                      CaptionML=[ENU=Make &Phone Call;
                                 DEA=&Telefonverbindung herstellen];
                      Image=Calls;
                      OnAction=VAR
                                 TAPIManagement@1001 : Codeunit 5053;
                               BEGIN
                                 TAPIManagement.DialContCustVendBank(DATABASE::Contact,"No.","Phone No.",'');
                               END;
                                }
      { 56      ;2   ;Action    ;
                      CaptionML=[ENU=Launch &Web Source;
                                 DEA=&Internetfavorit aufrufen];
                      Image=LaunchWeb;
                      OnAction=VAR
                                 ContactWebSource@1001 : Record 5060;
                               BEGIN
                                 ContactWebSource.SETRANGE("Contact No.","Company No.");
                                 IF PAGE.RUNMODAL(PAGE::"Web Source Launch",ContactWebSource) = ACTION::LookupOK THEN
                                   ContactWebSource.Launch;
                               END;
                                }
      { 57      ;2   ;Action    ;
                      CaptionML=[ENU=Print Cover &Sheet;
                                 DEA=&Deckblatt drucken];
                      Image=PrintCover;
                      OnAction=VAR
                                 Cont@1001 : Record 5050;
                               BEGIN
                                 Cont := Rec;
                                 Cont.SETRECFILTER;
                                 REPORT.RUN(REPORT::"Contact - Cover Sheet",TRUE,FALSE,Cont);
                               END;
                                }
      { 58      ;2   ;ActionGroup;
                      CaptionML=[ENU=Create as;
                                 DEA=Erstellen als];
                      Image=CustomerContact }
      { 59      ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 DEA=Debitor];
                      Image=Customer;
                      OnAction=BEGIN
                                 CreateCustomer(ChooseCustomerTemplate);
                               END;
                                }
      { 60      ;3   ;Action    ;
                      Name=Vendor;
                      CaptionML=[ENU=Vendor;
                                 DEA=Kreditor];
                      Image=Vendor;
                      OnAction=BEGIN
                                 CreateVendor;
                               END;
                                }
      { 61      ;3   ;Action    ;
                      AccessByPermission=TableData 270=R;
                      CaptionML=[ENU=Bank;
                                 DEA=Bankkonto];
                      Image=Bank;
                      OnAction=BEGIN
                                 CreateBankAccount;
                               END;
                                }
      { 62      ;2   ;ActionGroup;
                      CaptionML=[ENU=Link with existing;
                                 DEA=Verknpfen mit];
                      Image=Links }
      { 63      ;3   ;Action    ;
                      CaptionML=[ENU=Customer;
                                 DEA=Debitor];
                      Image=Customer;
                      OnAction=BEGIN
                                 CreateCustomerLink;
                               END;
                                }
      { 64      ;3   ;Action    ;
                      CaptionML=[ENU=Vendor;
                                 DEA=Kreditor];
                      Image=Vendor;
                      OnAction=BEGIN
                                 CreateVendorLink;
                               END;
                                }
      { 65      ;3   ;Action    ;
                      AccessByPermission=TableData 270=R;
                      CaptionML=[ENU=Bank;
                                 DEA=Bankkonto];
                      Image=Bank;
                      OnAction=BEGIN
                                 CreateBankAccountLink;
                               END;
                                }
      { 31      ;1   ;Action    ;
                      AccessByPermission=TableData 5062=R;
                      CaptionML=[ENU=Create &Interact;
                                 DEA=Aktivit„t &erst.];
                      Promoted=Yes;
                      Image=CreateInteraction;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CreateInteraction;
                               END;
                                }
      { 1900000005;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1900900305;1 ;Action    ;
                      CaptionML=[ENU=New Sales Quote;
                                 DEA=Neues Verkaufsangebot];
                      RunObject=Page 41;
                      RunPageLink=Sell-to Contact No.=FIELD(No.);
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=New;
                      RunPageMode=Create }
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 1907415106;1 ;Action    ;
                      CaptionML=[ENU=Contact Cover Sheet;
                                 DEA=Kontakt Deckblatt];
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 Cont := Rec;
                                 Cont.SETRECFILTER;
                                 REPORT.RUN(REPORT::"Contact - Cover Sheet",TRUE,FALSE,Cont);
                               END;
                                }
      { 1907778706;1 ;Action    ;
                      CaptionML=[ENU=Contact Company Summary;
                                 DEA=Kontakt - Unternehmensbersicht];
                      RunObject=Report 5051;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
      { 1904205506;1 ;Action    ;
                      CaptionML=[ENU=Contact Labels;
                                 DEA=Kontaktetiketten];
                      RunObject=Report 5056;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1905922906;1 ;Action    ;
                      CaptionML=[ENU=Questionnaire Handout;
                                 DEA=Befragung Handzettel];
                      RunObject=Report 5066;
                      Promoted=No;
                      Image=Report;
                      PromotedCategory=Report }
      { 1900800206;1 ;Action    ;
                      CaptionML=[ENU=Sales Cycle Analysis;
                                 DEA=Verkaufsprozess Analyse];
                      RunObject=Report 5062;
                      Promoted=Yes;
                      Image=Report;
                      PromotedCategory=Report }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                IndentationColumnName=NameIndent;
                IndentationControls=Name;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr="No.";
                Style=Strong;
                StyleExpr=StyleIsStrong }

    { 4   ;2   ;Field     ;
                SourceExpr=Name;
                Style=Strong;
                StyleExpr=StyleIsStrong }

    { 66  ;2   ;Field     ;
                SourceExpr="Company Name";
                Visible=FALSE }

    { 6   ;2   ;Field     ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 8   ;2   ;Field     ;
                SourceExpr="Country/Region Code";
                Visible=FALSE }

    { 10  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 24  ;2   ;Field     ;
                SourceExpr="Mobile Phone No.";
                Visible=FALSE }

    { 12  ;2   ;Field     ;
                SourceExpr="Fax No.";
                Visible=FALSE }

    { 14  ;2   ;Field     ;
                SourceExpr="Salesperson Code" }

    { 16  ;2   ;Field     ;
                SourceExpr="Territory Code" }

    { 18  ;2   ;Field     ;
                SourceExpr="Currency Code";
                Visible=FALSE }

    { 20  ;2   ;Field     ;
                SourceExpr="Language Code";
                Visible=FALSE }

    { 22  ;2   ;Field     ;
                SourceExpr="Search Name" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=TRUE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {
    VAR
      Cont@1000 : Record 5050;
      StyleIsStrong@1001 : Boolean INDATASET;
      NameIndent@1002 : Integer INDATASET;
      CompanyGroupEnabled@1004 : Boolean;
      PersonGroupEnabled@1003 : Boolean;
      CRMIntegrationEnabled@1006 : Boolean;
      CRMIsCoupledToRecord@1005 : Boolean;

    LOCAL PROCEDURE EnableFields@1();
    BEGIN
      CompanyGroupEnabled := Type = Type::Company;
      PersonGroupEnabled := Type = Type::Person;
    END;

    BEGIN
    {
      CMMS
        20170310  SETRANGE OnOpenPage
    }
    END.
  }
}

OBJECT Page 5075 Interaction Templates
{
  OBJECT-PROPERTIES
  {
    Date=21.10.16;
    Time=12:52:34;
    Modified=Yes;
    Version List=NAVW17.00,CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Interaction Templates;
               DEA=Aktivit„tenvorlagen];
    SourceTable=Table5064;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       CALCFIELDS("Attachment No.");
                     END;

    OnNewRecord=BEGIN
                  IF GETFILTER("Interaction Group Code") <> '' THEN
                    IF GETRANGEMIN("Interaction Group Code") = GETRANGEMAX("Interaction Group Code") THEN
                      "Interaction Group Code" := GETRANGEMIN("Interaction Group Code");
                END;

    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 25      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Interaction Template;
                                 DEA=A&ktivit„tenvorlage];
                      Image=Interaction }
      { 29      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Interaction Log E&ntries;
                                 DEA=Aktivit&„tenprotokollposten];
                      RunObject=Page 5076;
                      RunPageView=SORTING(Interaction Template Code,Date);
                      RunPageLink=Interaction Template Code=FIELD(Code);
                      Image=InteractionLog }
      { 30      ;2   ;Action    ;
                      ShortCutKey=F7;
                      CaptionML=[ENU=Statistics;
                                 DEA=Statistik];
                      RunObject=Page 5079;
                      RunPageLink=Code=FIELD(Code);
                      Promoted=Yes;
                      Image=Statistics;
                      PromotedCategory=Process }
      { 26      ;2   ;Action    ;
                      CaptionML=[ENU=Languages;
                                 DEA=Sprachen];
                      RunObject=Page 5154;
                      RunPageLink=Interaction Template Code=FIELD(Code);
                      Image=Language }
      { 41      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Attachment;
                                 DEA=Da&teianhang];
                      Image=Attachments }
      { 43      ;2   ;Action    ;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Open;
                                 DEA=™ffnen];
                      Image=Edit;
                      OnAction=VAR
                                 InteractTemplLanguage@1001 : Record 5103;
                               BEGIN
                                 IF InteractTemplLanguage.GET(Code,"Language Code (Default)") THEN
                                   InteractTemplLanguage.OpenAttachment;
                               END;
                                }
      { 44      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Create;
                                 DEA=Erstellen];
                      Image=New;
                      OnAction=VAR
                                 InteractTemplLanguage@1001 : Record 5103;
                               BEGIN
                                 IF NOT InteractTemplLanguage.GET(Code,"Language Code (Default)") THEN BEGIN
                                   InteractTemplLanguage.INIT;
                                   InteractTemplLanguage."Interaction Template Code" := Code;
                                   InteractTemplLanguage."Language Code" := "Language Code (Default)";
                                   InteractTemplLanguage.Description := Description;
                                 END;
                                 InteractTemplLanguage.CreateAttachment;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 45      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Copy &from;
                                 DEA=&Kopieren von];
                      Image=Copy;
                      OnAction=VAR
                                 InteractTemplLanguage@1001 : Record 5103;
                               BEGIN
                                 IF NOT InteractTemplLanguage.GET(Code,"Language Code (Default)") THEN BEGIN
                                   InteractTemplLanguage.INIT;
                                   InteractTemplLanguage."Interaction Template Code" := Code;
                                   InteractTemplLanguage."Language Code" := "Language Code (Default)";
                                   InteractTemplLanguage.Description := Description;
                                   InteractTemplLanguage.INSERT;
                                   COMMIT;
                                 END;
                                 InteractTemplLanguage.CopyFromAttachment;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 46      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Import;
                                 DEA=Importieren];
                      Image=Import;
                      OnAction=VAR
                                 InteractTemplLanguage@1001 : Record 5103;
                               BEGIN
                                 IF NOT InteractTemplLanguage.GET(Code,"Language Code (Default)") THEN BEGIN
                                   InteractTemplLanguage.INIT;
                                   InteractTemplLanguage."Interaction Template Code" := Code;
                                   InteractTemplLanguage."Language Code" := "Language Code (Default)";
                                   InteractTemplLanguage.Description := Description;
                                   InteractTemplLanguage.INSERT;
                                 END;
                                 InteractTemplLanguage.ImportAttachment;
                                 CurrPage.UPDATE;
                               END;
                                }
      { 47      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=E&xport;
                                 DEA=E&xportieren];
                      Image=Export;
                      OnAction=VAR
                                 InteractTemplLanguage@1001 : Record 5103;
                               BEGIN
                                 IF InteractTemplLanguage.GET(Code,"Language Code (Default)") THEN
                                   InteractTemplLanguage.ExportAttachment;
                               END;
                                }
      { 48      ;2   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Remove;
                                 DEA=L”schen];
                      Image=Cancel;
                      OnAction=VAR
                                 InteractTemplLanguage@1001 : Record 5103;
                               BEGIN
                                 IF InteractTemplLanguage.GET(Code,"Language Code (Default)") THEN
                                   InteractTemplLanguage.RemoveAttachment(TRUE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 2   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr="Interaction Group Code" }

    { 6   ;2   ;Field     ;
                SourceExpr=Description }

    { 37  ;2   ;Field     ;
                SourceExpr="Wizard Action" }

    { 1000000000;2;Field  ;
                SourceExpr="IG Information Type" }

    { 31  ;2   ;Field     ;
                SourceExpr="Language Code (Default)" }

    { 27  ;2   ;Field     ;
                AssistEdit=Yes;
                CaptionML=[ENU=Attachment;
                           DEA=Dateianhang];
                SourceExpr="Attachment No." <> 0;
                OnAssistEdit=VAR
                               InteractTmplLanguage@1001 : Record 5103;
                             BEGIN
                               IF InteractTmplLanguage.GET(Code,"Language Code (Default)") THEN BEGIN
                                 IF InteractTmplLanguage."Attachment No." <> 0 THEN
                                   InteractTmplLanguage.OpenAttachment
                                 ELSE
                                   InteractTmplLanguage.CreateAttachment;
                               END ELSE BEGIN
                                 InteractTmplLanguage.INIT;
                                 InteractTmplLanguage."Interaction Template Code" := Code;
                                 InteractTmplLanguage."Language Code" := "Language Code (Default)";
                                 InteractTmplLanguage.Description := Description;
                                 InteractTmplLanguage.CreateAttachment;
                               END;
                               CurrPage.UPDATE;
                             END;
                              }

    { 33  ;2   ;Field     ;
                SourceExpr="Ignore Contact Corres. Type" }

    { 39  ;2   ;Field     ;
                SourceExpr="Correspondence Type (Default)" }

    { 8   ;2   ;Field     ;
                SourceExpr="Unit Cost (LCY)" }

    { 10  ;2   ;Field     ;
                SourceExpr="Unit Duration (Min.)" }

    { 12  ;2   ;Field     ;
                SourceExpr="Information Flow" }

    { 14  ;2   ;Field     ;
                SourceExpr="Initiated By" }

    { 16  ;2   ;Field     ;
                SourceExpr="Campaign No." }

    { 18  ;2   ;Field     ;
                SourceExpr="Campaign Target" }

    { 20  ;2   ;Field     ;
                SourceExpr="Campaign Response" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    {
      CM  20161021  Added Field "IG Information Type"
    }
    END.
  }
}

OBJECT Page 5101 Activity
{
  OBJECT-PROPERTIES
  {
    Date=29.01.18;
    Time=10:00:47;
    Modified=Yes;
    Version List=NAVW17.00,CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Activity;
               DEA=Aktionen];
    SourceTable=Table5081;
    PageType=ListPlus;
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group      }

    { 2   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000000;2;Field  ;
                Name=CM Extended Description;
                SourceExpr="CM Extended Description";
                MultiLine=Yes }

    { 9   ;1   ;Part      ;
                SubPageLink=Activity Code=FIELD(Code);
                PagePartID=Page5102 }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 5102 Activity Step Subform
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=14:56:32;
    Modified=Yes;
    Version List=NAVW16.00,CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Lines;
               DEA=Zeilen];
    LinksAllowed=No;
    SourceTable=Table5082;
    DelayedInsert=Yes;
    SourceTableView=SORTING(CM Maintask Step No.)
                    WHERE(CM Maintask Step No.=CONST(0));
    PageType=ListPart;
    AutoSplitKey=Yes;
    ActionList=ACTIONS
    {
      { 1000000000;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000001;1 ;Action    ;
                      Name=Checklist;
                      CaptionML=[ENU=Checklist;
                                 DEA=Checkliste];
                      Image=CheckList;
                      OnAction=VAR
                                 CMTaskMgt@1000000000 : Codeunit 70031;
                               BEGIN
                                 CMTaskMgt.ShowSubToWoTypeTask(Rec, Rec."CM Subtype"::Checklist);
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=Team;
                      CaptionML=[ENU=Team;
                                 DEA=Team];
                      Image=SalesPurchaseTeam;
                      OnAction=VAR
                                 CMTaskMgt@1000000000 : Codeunit 70031;
                               BEGIN
                                 CMTaskMgt.ShowSubToWoTypeTask(Rec, Rec."CM Subtype"::Team);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                Name=CMStepNo;
                SourceExpr="Step No.";
                Editable=FALSE }

    { 2   ;2   ;Field     ;
                SourceExpr=Type }

    { 4   ;2   ;Field     ;
                SourceExpr=Description }

    { 1000000008;2;Field  ;
                SourceExpr="CM Extended Description" }

    { 6   ;2   ;Field     ;
                SourceExpr=Priority }

    { 8   ;2   ;Field     ;
                SourceExpr="Date Formula" }

    { 1000000004;2;Field  ;
                SourceExpr="CM Interaction Group Code" }

    { 1000000003;2;Field  ;
                SourceExpr="CM Interaction Template Code" }

    { 1000000006;2;Field  ;
                SourceExpr="CM Assigned User ID" }

    { 1000000007;2;Field  ;
                SourceExpr="CM Assigned User Name" }

  }
  CODE
  {

    BEGIN
    {
      CM 20161025 Added Action "Subtasks"
                  Changed Table View to "SORTING(CM Maintask Step No.) WHERE(CM Maintask Step No.=CONST(0))"
                  Added Field "CMStepNo"
    }
    END.
  }
}

OBJECT Page 5714 Responsibility Center Card
{
  OBJECT-PROPERTIES
  {
    Date=30.09.16;
    Time=13:42:17;
    Modified=Yes;
    Version List=NAVW17.10, CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Responsibility Center Card;
               DEA=Zust„ndigkeitseinheitencode-Karte];
    SourceTable=Table5714;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1900000003;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 34      ;1   ;ActionGroup;
                      CaptionML=[ENU=&Resp. Ctr.;
                                 DEA=&Zst-Einh.];
                      Image=Dimensions }
      { 30      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 DEA=Dimensionen];
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(5714),
                                  No.=FIELD(Code);
                      Image=Dimensions }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=General;
                           DEA=Allgemein] }

    { 2   ;2   ;Field     ;
                SourceExpr=Code }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 6   ;2   ;Field     ;
                SourceExpr=Address }

    { 8   ;2   ;Field     ;
                SourceExpr="Address 2" }

    { 10  ;2   ;Field     ;
                SourceExpr="Post Code" }

    { 33  ;2   ;Field     ;
                SourceExpr=City }

    { 12  ;2   ;Field     ;
                SourceExpr="Country/Region Code" }

    { 14  ;2   ;Field     ;
                SourceExpr=Contact }

    { 18  ;2   ;Field     ;
                SourceExpr="Global Dimension 1 Code" }

    { 20  ;2   ;Field     ;
                SourceExpr="Global Dimension 2 Code" }

    { 16  ;2   ;Field     ;
                SourceExpr="Location Code" }

    { 1000000000;2;Field  ;
                Name=IG_Company_Name;
                SourceExpr="Company Name" }

    { 1902768601;1;Group  ;
                CaptionML=[ENU=Communication;
                           DEA=Kommunikation] }

    { 24  ;2   ;Field     ;
                SourceExpr="Phone No." }

    { 26  ;2   ;Field     ;
                SourceExpr="Fax No." }

    { 28  ;2   ;Field     ;
                SourceExpr="E-Mail" }

    { 36  ;2   ;Field     ;
                SourceExpr="Home Page" }

    { 1900000007;0;Container;
                ContainerType=FactBoxArea }

    { 1900383207;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1905767507;1;Part   ;
                Visible=FALSE;
                PartType=System;
                SystemPartID=Notes }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 50010 ENC Admin Activities
{
  OBJECT-PROPERTIES
  {
    Date=14.03.18;
    Time=21:10:03;
    Modified=Yes;
    Version List=ENC,CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=ENcome Administration;
               DEA=ENcome Administration];
    SourceTable=Table50001;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       CALCFIELDS("Active Sessions");
                       "Active Sessions" -= 1;
                     END;

    ActionList=ACTIONS
    {
      { 1000000005;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000004;1 ;Action    ;
                      Name=Set Up Cues;
                      CaptionML=[ENU=Set Up Cues;
                                 DEA=Stapel einrichten];
                      Image=Setup;
                      OnAction=VAR
                                 CueRecordRef@1000 : RecordRef;
                               BEGIN
                                 CueRecordRef.GETTABLE(Rec);
                                 CueSetup.OpenCustomizePageForCurrentUser(CueRecordRef.NUMBER);
                               END;
                                }
      { 1000000002;1 ;Action    ;
                      Name=DistributeDimensions;
                      CaptionML=[ENU=Distribute Dimensions;
                                 DEA=Dimensionen Verteilen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Allocate;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ENCGenMgt@1000000000 : Codeunit 50003;
                               BEGIN
                                 ENCGenMgt.PowershellDimCopy();
                               END;
                                }
      { 1000000003;1 ;Action    ;
                      Name=SyncCustomers;
                      CaptionML=[ENU=Sychronize Customers;
                                 DEA=Debitoren Synchronisieren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=RefreshLines;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ENCGenMgt@1000000000 : Codeunit 50003;
                               BEGIN
                                 ENCGenMgt.PowershellCustomerSync();
                               END;
                                }
      { 1000000008;1 ;Action    ;
                      Name=SyncVendors;
                      CaptionML=[ENU=Sychronize Vendors;
                                 DEA=Kreditoren Synchronisieren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=RefreshLines;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ENCGenMgt@1000000000 : Codeunit 50003;
                               BEGIN
                                 ENCGenMgt.PowershellVendorSync();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000007;1;Group  ;
                Name=ENcome;
                CaptionML=[ENU=ENcome Administration;
                           DEA=ENcome Administration];
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 1000000006;  ;Action    ;
                                  Name=DistributeDimensions_;
                                  CaptionML=[ENU=Distribute Dimensions;
                                             DEA=Dimensionen Verteilen];
                                  Promoted=Yes;
                                  PromotedIsBig=Yes;
                                  Image=Allocate;
                                  PromotedCategory=Process;
                                  OnAction=VAR
                                             ENCGenMgt@1000000000 : Codeunit 50003;
                                           BEGIN
                                             ENCGenMgt.PowershellDimCopy();
                                           END;
                                            }
                  { 1000000010;  ;Action    ;
                                  Name=SyncCustomers_;
                                  CaptionML=[ENU=Sychronize Customers;
                                             DEA=Debitoren Synchronisieren];
                                  Promoted=Yes;
                                  PromotedIsBig=Yes;
                                  Image=RefreshLines;
                                  PromotedCategory=Process;
                                  OnAction=VAR
                                             ENCGenMgt@1000000000 : Codeunit 50003;
                                           BEGIN
                                             ENCGenMgt.PowershellCustomerSync();
                                           END;
                                            }
                  { 1000000009;  ;Action    ;
                                  Name=SyncVendors_;
                                  CaptionML=[ENU=Sychronize Vendors;
                                             DEA=Kreditoren Synchronisieren];
                                  Promoted=Yes;
                                  PromotedIsBig=Yes;
                                  Image=RefreshLines;
                                  PromotedCategory=Process;
                                  OnAction=VAR
                                             ENCGenMgt@1000000000 : Codeunit 50003;
                                           BEGIN
                                             ENCGenMgt.PowershellVendorSync();
                                           END;
                                            }
                }
                 }

    { 1000000001;2;Field  ;
                SourceExpr="Active Sessions";
                OnDrillDown=VAR
                              ActiveSession@1000000000 : Record 2000000110;
                              SessionList@1000000001 : Page 9506;
                            BEGIN
                              ActiveSession.SETFILTER("Client Type", '<>%1', ActiveSession."Client Type"::Background);
                              SessionList.SETTABLEVIEW(ActiveSession);
                              SessionList.RUN();
                            END;
                             }

  }
  CODE
  {
    VAR
      CueSetup@1000000000 : Codeunit 9701;

    BEGIN
    END.
  }
}

OBJECT Page 70000 CMMS General Setup
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=09:27:45;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=General Setup;
               DEA=Allgemeine Einrichtung];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70000;
    PageType=Card;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                GroupType=Group }

    { 1000000006;1;Group  ;
                CaptionML=[ENU=Numbering;
                           DEA=Nummerierung] }

    { 1000000002;2;Field  ;
                SourceExpr="Asset Nos. Code" }

    { 1000000003;2;Field  ;
                SourceExpr="Project Nos. Code" }

    { 1000000004;2;Field  ;
                SourceExpr="Workorder Nos. Code" }

    { 1000000005;2;Field  ;
                SourceExpr="Task Nos. Code" }

    { 1000000047;2;Field  ;
                SourceExpr="Checklist Nos. Code" }

    { 1000000048;2;Field  ;
                SourceExpr="Team Nos. Code" }

    { 1000000015;2;Field  ;
                SourceExpr="Contract Nos. Code" }

    { 1000000029;1;Group  ;
                Name=Dimensions;
                CaptionML=[ENU=Dimensions;
                           DEA=Dimensionen];
                GroupType=Group }

    { 1000000030;2;Field  ;
                SourceExpr="Asset Dimension Code" }

    { 1000000031;2;Field  ;
                SourceExpr="Project Dimension Code" }

    { 1000000007;1;Group  ;
                Name=Maps;
                CaptionML=[ENU=Maps;
                           DEA=Karten];
                GroupType=Group }

    { 1000000008;2;Field  ;
                SourceExpr="Map Setup (Coordinates)" }

    { 1000000009;2;Field  ;
                SourceExpr="Map Setup (Address)" }

    { 1000000010;1;Group  ;
                Name=Timetracking;
                CaptionML=[ENU=Timetracking;
                           DEA=Zeiterfassung];
                GroupType=Group }

    { 1000000011;2;Field  ;
                SourceExpr="Max. Posting per Day" }

    { 1000000012;2;Field  ;
                SourceExpr="Rounding Precision" }

    { 1000000013;2;Field  ;
                SourceExpr="Default UoM Code" }

    { 1000000014;2;Field  ;
                SourceExpr="Posting Allowed to (Past)" }

    { 1000000032;2;Field  ;
                SourceExpr="Posting Allowed to (Future)" }

    { 1000000034;2;Field  ;
                SourceExpr="Posting Descr. Min. Length" }

    { 1000000024;2;Field  ;
                SourceExpr="Dimension 1";
                Editable=FALSE }

    { 1000000025;2;Field  ;
                SourceExpr="Dimension 2";
                Editable=FALSE }

    { 1000000026;2;Field  ;
                SourceExpr="Dimension 3" }

    { 1000000027;2;Field  ;
                SourceExpr="Dimension 4" }

    { 1000000016;1;Group  ;
                Name=YieldStudy;
                CaptionML=[ENU=Yield Study;
                           DEA=Yield Study];
                GroupType=Group }

    { 1000000017;2;Field  ;
                SourceExpr="Yield Type 1 (Starts with)" }

    { 1000000018;2;Field  ;
                SourceExpr="Yield Unit 1" }

    { 1000000020;2;Field  ;
                SourceExpr="Yield Type 2 (Starts with)" }

    { 1000000021;2;Field  ;
                SourceExpr="Yield Unit 2" }

    { 1000000019;2;Field  ;
                SourceExpr="Degradation Allow. (Starts w.)" }

    { 1000000022;1;Group  ;
                Name=Other;
                CaptionML=[ENU=Other;
                           DEA=Sonstiges];
                GroupType=Group }

    { 1000000042;2;Field  ;
                SourceExpr="Subcontractor Bus. Rel. Code" }

    { 1000000023;2;Field  ;
                SourceExpr="Default Interact. Tpl. Code" }

    { 1000000028;2;Field  ;
                SourceExpr="Photo Quality %" }

    { 1000000033;2;Field  ;
                SourceExpr="Recurring Workorder Name" }

    { 1000000035;2;Field  ;
                SourceExpr="System Contact" }

    { 1000000036;2;Field  ;
                SourceExpr="System Salesperson" }

    { 1000000037;2;Field  ;
                SourceExpr="System User ID" }

    { 1000000049;2;Field  ;
                SourceExpr="Min. Comment Len. (Wo. Status)" }

    { 1000000043;2;Field  ;
                SourceExpr="Allow CMMS Purch. Orders" }

    { 1000000044;2;Field  ;
                SourceExpr="CMMS PO Default Vendor" }

    { 1000000045;2;Field  ;
                SourceExpr="CMMS PO Status Sequence" }

    { 1000000046;2;Field  ;
                SourceExpr="CMMS PO Initial Status" }

    { 1000000050;2;Field  ;
                SourceExpr="CMMS PO Released Status" }

    { 1000000038;1;Group  ;
                Name=ExcelExport;
                CaptionML=[ENU=Excel Export;
                           DEA=Excel Export];
                GroupType=Group }

    { 1000000039;2;Field  ;
                SourceExpr="Excel Export Template 1 Path" }

    { 1000000040;2;Field  ;
                SourceExpr="Excel Export Template 2 Path" }

    { 1000000041;2;Field  ;
                SourceExpr="Excel Export Template 3 Path" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70002 CMMS GPM Ticket Archive
{
  OBJECT-PROPERTIES
  {
    Date=02.01.18;
    Time=11:41:17;
    Modified=Yes;
    Version List=CMMS,GPM;
  }
  PROPERTIES
  {
    Editable=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table50005;
    SourceTableView=SORTING(id)
                    ORDER(Descending);
    PageType=List;
    OnAfterGetCurrRecord=BEGIN
                           Rec.GetBlobValues
                           (
                           activation_description,
                           deactivation_description,
                           activation_details,
                           deactivation_details,
                           problem_description,
                           actions_performed
                           );
                         END;

    ActionList=ACTIONS
    {
      { 1000000006;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000007;1 ;Action    ;
                      Name=OpenWorkorder;
                      CaptionML=[ENU=Open Workorder Card;
                                 DEA=™ffne Workorder Karte];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Rec2@1000000000 : Record 5092;
                                 CMWoMgt@1000000001 : Codeunit 70030;
                               BEGIN
                                 IF NOT Rec2.GET(Rec."Workorder No.") THEN
                                   EXIT;

                                 CMWoMgt.ShowWorkorderCard(Rec2);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=PVPlusData;
                CaptionML=ENU=PVPlus Data;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr=id }

    { 1000000030;2;Field  ;
                SourceExpr="Creation Datetime" }

    { 1000000034;2;Field  ;
                SourceExpr="Creation Date";
                Style=StandardAccent;
                StyleExpr=TRUE }

    { 1000000035;2;Field  ;
                SourceExpr="Creation Time";
                Style=StandardAccent;
                StyleExpr=TRUE }

    { 1000000036;2;Field  ;
                SourceExpr="Is Error";
                Style=StandardAccent;
                StyleExpr=TRUE }

    { 1000000037;2;Field  ;
                SourceExpr="Error Text";
                Style=StandardAccent;
                StyleExpr=TRUE }

    { 1000000040;2;Field  ;
                SourceExpr="Workorder No.";
                Style=StandardAccent;
                StyleExpr=TRUE;
                OnLookup=VAR
                           Rec2@1000000000 : Record 5092;
                         BEGIN
                           IF NOT Rec2.GET(Rec."Workorder No.") THEN
                             EXIT;

                           CMWoMgt.ShowWorkorderCard(Rec2);
                         END;

                OnDrillDown=VAR
                              Rec2@1000000000 : Record 5092;
                            BEGIN
                              IF NOT Rec2.GET(Rec."Workorder No.") THEN
                                EXIT;

                              CMWoMgt.ShowWorkorderCard(Rec2);
                            END;

                OnAssistEdit=VAR
                               Rec2@1000000000 : Record 5092;
                             BEGIN
                             END;
                              }

    { 1000000003;2;Field  ;
                SourceExpr=ticket_id }

    { 1000000038;2;Field  ;
                SourceExpr=deleted }

    { 1000000004;2;Field  ;
                SourceExpr=name }

    { 1000000005;2;Field  ;
                SourceExpr=grouping }

    { 1000000041;2;Field  ;
                SourceExpr=activated_time_DATE }

    { 1000000042;2;Field  ;
                SourceExpr=activated_time_TIME }

    { 1000000043;2;Field  ;
                SourceExpr=deactivated_time_DATE }

    { 1000000044;2;Field  ;
                SourceExpr=deactivated_time_TIME }

    { 1000000008;2;Field  ;
                SourceExpr=reference_plant_id }

    { 1000000009;2;Field  ;
                SourceExpr=reference_element_id }

    { 1000000039;2;Field  ;
                SourceExpr=reference_element_name }

    { 1000000010;2;Field  ;
                SourceExpr=priority }

    { 1000000011;2;Field  ;
                SourceExpr=reference_alerm_id }

    { 1000000012;2;Field  ;
                SourceExpr=state }

    { 1000000013;2;Field  ;
                SourceExpr=alert_type }

    { 1000000014;2;Field  ;
                SourceExpr=operator_name }

    { 1000000019;2;Field  ;
                SourceExpr=affects_availibility }

    { 1000000020;2;Field  ;
                SourceExpr=calculate_loss }

    { 1000000021;2;Field  ;
                SourceExpr=repercussion_id }

    { 1000000022;2;Field  ;
                SourceExpr=affected_element_id }

    { 1000000023;2;Field  ;
                SourceExpr=reason_id }

    { 1000000025;2;Field  ;
                SourceExpr=company }

    { 1000000026;2;Field  ;
                SourceExpr=time_t }

    { 1000000028;2;Field  ;
                SourceExpr=maintenance_type_id }

    { 1000000029;2;Field  ;
                SourceExpr=reference_element_type_id }

    { 1000000045;2;Field  ;
                SourceExpr=notified_time_DATE }

    { 1000000046;2;Field  ;
                SourceExpr=notified_time_TIME }

    { 1000000031;2;Field  ;
                SourceExpr=estimated_activation_time }

    { 1000000032;2;Field  ;
                SourceExpr=operator_id }

    { 1000000033;1;Group  ;
                Name=Extended;
                GroupType=Group }

    { 1000000015;2;Field  ;
                Name=activation_description;
                SourceExpr=activation_description;
                MultiLine=Yes;
                OnValidate=BEGIN
                             CLEAR(Rec.activation_description_BLOB);
                             Rec.activation_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
                             OutStr.WRITETEXT(activation_description);
                           END;
                            }

    { 1000000016;2;Field  ;
                Name=deactivation_description;
                SourceExpr=deactivation_description;
                MultiLine=Yes;
                OnValidate=BEGIN
                             CLEAR(Rec.deactivation_description_BLOB);
                             Rec.deactivation_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
                             OutStr.WRITETEXT(deactivation_description);
                           END;
                            }

    { 1000000017;2;Field  ;
                Name=activation_details;
                SourceExpr=activation_details;
                MultiLine=Yes;
                OnValidate=BEGIN
                             CLEAR(Rec.activation_details_BLOB);
                             Rec.activation_details_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
                             OutStr.WRITETEXT(activation_details);
                           END;
                            }

    { 1000000018;2;Field  ;
                Name=deactivation_details;
                SourceExpr=deactivation_details;
                MultiLine=Yes;
                OnValidate=BEGIN
                             CLEAR(Rec.deactivation_details_BLOB);
                             Rec.deactivation_details_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
                             OutStr.WRITETEXT(deactivation_details);
                           END;
                            }

    { 1000000024;2;Field  ;
                Name=problem_description;
                SourceExpr=problem_description;
                MultiLine=Yes;
                OnValidate=BEGIN
                             CLEAR(Rec.problem_description_BLOB);
                             Rec.problem_description_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
                             OutStr.WRITETEXT(problem_description);
                           END;
                            }

    { 1000000027;2;Field  ;
                Name=actions_performed;
                SourceExpr=actions_performed;
                MultiLine=Yes;
                OnValidate=BEGIN
                             CLEAR(Rec.actions_performed_BLOB);
                             Rec.actions_performed_BLOB.CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
                             OutStr.WRITETEXT(actions_performed);
                           END;
                            }

  }
  CODE
  {
    VAR
      activation_description@1000000000 : Text INDATASET;
      deactivation_description@1000000001 : Text INDATASET;
      activation_details@1000000002 : Text INDATASET;
      deactivation_details@1000000003 : Text INDATASET;
      problem_description@1000000004 : Text INDATASET;
      actions_performed@1000000005 : Text INDATASET;
      OutStr@1000000006 : OutStream;
      CMWoMgt@1000000007 : Codeunit 70030;

    BEGIN
    END.
  }
}

OBJECT Page 70003 CMMS Change Status Asset
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=11:20:27;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Change Status;
               DEA=Status „ndern];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    DataCaptionExpr='';
    PageType=ConfirmationDialog;
    InstructionalTextML=[ENU=Do you want to change the status?;
                         DEA=M”chten Sie den Status „ndern?];
    OnInit=VAR
             CR@1000000001 : Char;
             LF@1000000000 : Char;
           BEGIN
             StatusEditable[1] := FALSE;
             StatusEditable[2] := FALSE;
             StatusEditable[3] := FALSE;
             StatusEditable[4] := FALSE;
             StatusEditable[5] := FALSE;
             StatusEditable[6] := FALSE;
             StatusEditable[7] := FALSE;
             StatusEditable[8] := FALSE;
             StatusEditable[9] := FALSE;
             StatusEditable[10] := FALSE;

             CR := 13;
             LF := 10;
           END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 8   ;1   ;Field     ;
                Name=NewObjectStatus;
                CaptionML=[ENU=New Status;
                           DEA=Neuer Status];
                SourceExpr=ObjectStatus."Operational Status";
                ValuesAllowed=[New;Released;Inactive];
                OnValidate=BEGIN
                             CASE ObjectStatus."Operational Status" OF
                               ObjectStatus."Operational Status"::New:
                                 CheckStatus(StatusEditable[1]);
                               ObjectStatus."Operational Status"::Released:
                                 CheckStatus(StatusEditable[2]);
                               ObjectStatus."Operational Status"::Inactive:
                                 CheckStatus(StatusEditable[3]);
                             END;
                           END;
                            }

    { 1000000001;1;Field  ;
                Name=CommentText;
                CaptionML=[ENU=Comment;
                           DEA=Kommentar];
                SourceExpr=CommentText;
                MultiLine=Yes }

  }
  CODE
  {
    VAR
      ObjectStatus@1000 : Record 70020;
      Text001@19003950 : TextConst 'ENU=" ""%1"" is not a valid selection.";DEA=" ""%1"" ist keine gltige Auswahl."';
      StatusEditable@1000000004 : ARRAY [100] OF Boolean;
      CommentText@1000000005 : Text;
      Text002@1000000008 : TextConst 'ENU=Please provide "%1" or "%2".;DEA=Bitte geben Sie "%1" oder "%2" an.';
      Text003@1000000009 : TextConst 'ENU=Only allowed with Status ''%1''!;DEA=Nur mit Status ''%1'' erlaubt!';
      Text004@1000000010 : TextConst 'ENU="%2 = Newly created%1%3 = Taken by Plant Manager%1%4 =Assigned to Fieldservice. Physical work in process%1%5 = Physical work completed by Fieldservice%1%6 = Workorder is finally done. Set by Plant Manager%1%7 = Workorder is aborted or cannot be done because of a special reason"';
      Text005@1000000015 : TextConst 'ENU=Comment;DEA=Kommentar';

    PROCEDURE Set@1(Rec@1000 : Record 70020);
    BEGIN
      {Set Status Editable}
      StatusEditable[1] := TRUE; //New
      StatusEditable[2] := TRUE; //Released
      StatusEditable[3] := TRUE; //Inactive

      ObjectStatus."Operational Status" := Rec."Operational Status";// + 1
    END;

    LOCAL PROCEDURE CheckStatus@19071396(StatusEditable@19000001 : Boolean);
    BEGIN
      IF NOT StatusEditable THEN
        ERROR(Text001,ObjectStatus."Operational Status");
    END;

    PROCEDURE GetComment@1000000000() : Text;
    BEGIN
      EXIT(CommentText);
    END;

    PROCEDURE GetStatus@4() : Integer;
    BEGIN
      EXIT(ObjectStatus."Operational Status");
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70004 CMMS Code Data
{
  OBJECT-PROPERTIES
  {
    Date=06.03.17;
    Time=12:44:36;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU="Drop Down List ";
               DEA=Auswahlliste];
    SourceTable=Table70006;
    PageType=List;
    ShowFilter=No;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr=Code }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70005 CMMS User Object Sel. Admin
{
  OBJECT-PROPERTIES
  {
    Date=20.06.17;
    Time=22:08:39;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=User Object Selection Administration;
               DEA=Benutzer Objectauswahl Verwaltung];
    SourceTable=Table70005;
    DelayedInsert=Yes;
    PageType=List;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr=Type }

    { 1000000006;2;Field  ;
                SourceExpr="User ID" }

    { 1000000009;2;Field  ;
                SourceExpr="Object Type" }

    { 1000000003;2;Field  ;
                SourceExpr="Object ID" }

    { 1000000004;2;Field  ;
                SourceExpr="Object Caption" }

    { 1000000005;2;Field  ;
                SourceExpr=Description }

    { 1000000007;2;Field  ;
                SourceExpr=Priority }

    { 1000000008;2;Field  ;
                SourceExpr=Sorting }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70006 CMMS User Objects
{
  OBJECT-PROPERTIES
  {
    Date=20.06.17;
    Time=22:09:09;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=User Objects;
               DEA=Benutzer Objekte];
    SourceTable=Table70005;
    SourceTableView=SORTING(User ID,Sorting,Type);
    PageType=ListPart;
    RefreshOnActivate=Yes;
    OnOpenPage=BEGIN
                 SETFILTER("User ID",'%1',USERID);
               END;

    OnAfterGetRecord=BEGIN
                       SETFILTER("User ID",'%1',USERID);

                       StyleText := 'Standard';
                       CASE Priority OF
                         Priority::Low: StyleText := 'Subordinate';
                         Priority::Normal: StyleText := 'Standard';
                         Priority::High: StyleText := 'Strong';
                       END;
                     END;

    ActionList=ACTIONS
    {
      { 1000000007;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000008;1 ;Action    ;
                      Name=Execute;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Execute;
                                 DEA=Ausfhren];
                      Image=ExecuteBatch;
                      OnAction=BEGIN
                                 ExecuteObject;
                               END;
                                }
      { 1000000009;1 ;Action    ;
                      Name=MoveUp;
                      CaptionML=[ENU=Move Up;
                                 DEA=Nach Oben];
                      Image=MoveUp;
                      OnAction=BEGIN
                                 SetSorting(0);
                               END;
                                }
      { 1000000010;1 ;Action    ;
                      Name=MoveDown;
                      CaptionML=[ENU=Move Down;
                                 DEA=Nach Unten];
                      Image=MoveDown;
                      OnAction=BEGIN
                                 SetSorting(1);
                               END;
                                }
      { 1000000011;1 ;Action    ;
                      Name=SetPriority;
                      CaptionML=[ENU=Set Priority;
                                 DEA=Priorit„t festlegen];
                      Image=SetPriorities;
                      OnAction=VAR
                                 Selection@1000000000 : Integer;
                                 Text000@1000000001 : TextConst 'ENU=Low,Normal,High;DEA=Niedrig,Normal,Hoch';
                               BEGIN
                                 Selection := STRMENU(Text000,2);

                                 IF Selection = 0 THEN
                                   EXIT;
                                 Priority := Selection - 1;
                                 MODIFY;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr=Type;
                StyleExpr=StyleText }

    { 1000000006;2;Field  ;
                SourceExpr="User ID";
                Visible=False }

    { 1000000003;2;Field  ;
                SourceExpr="Object ID";
                Visible=False }

    { 1000000004;2;Field  ;
                SourceExpr="Object Caption";
                StyleExpr=StyleText;
                OnDrillDown=BEGIN
                              ExecuteObject;
                            END;
                             }

    { 1000000005;2;Field  ;
                SourceExpr=Description }

  }
  CODE
  {
    VAR
      StyleText@1000000000 : Text INDATASET;

    LOCAL PROCEDURE SetSorting@1000000000(Direction@1000000003 : 'Up,Down');
    VAR
      Rec2@1000000000 : Record 70005;
      NoOfRec@1000000001 : Integer;
      i@1000000002 : Integer;
    BEGIN
      Rec.SETCURRENTKEY("User ID",Sorting);

      CLEAR(NoOfRec);
      CLEAR(i);

      Rec2.RESET;
      Rec2.SETCURRENTKEY("User ID",Sorting);
      Rec2.SETFILTER("User ID",USERID);

      NoOfRec := Rec2.COUNT;

      IF NoOfRec <> 0 THEN BEGIN
        {Calculate Sorting}
        IF Rec2.FINDFIRST THEN
          REPEAT
            i += 10;
            Rec2."Sorting (Temp.)" := i;
            Rec2.MODIFY;
          UNTIL Rec2.NEXT = 0;
        {Set Sorting}
        Rec2.SETCURRENTKEY("User ID","Object Type","Object ID");
        IF Rec2.FINDFIRST THEN
          REPEAT
            Rec2.Sorting := Rec2."Sorting (Temp.)";
            Rec2."Sorting (Temp.)" := 0;
            Rec2.MODIFY;
          UNTIL Rec2.NEXT = 0;

        Rec2.GET(Rec."User ID",Rec."Object Type",Rec."Object ID");
        {Set New Sorting}
        CASE Direction OF
          Direction::Up: IF Rec2.Sorting > 10 THEN Rec2.Sorting := Rec2.Sorting - 11;
          Direction::Down: Rec2.Sorting := Rec2.Sorting + 11;
        END;
        Rec2.MODIFY;

        CurrPage.UPDATE(FALSE);
        {Set Record to marked Record}
        Rec.GET(xRec."User ID",xRec."Object Type",xRec."Object ID");
      END;
    END;

    LOCAL PROCEDURE ExecuteObject@1000000006();
    BEGIN
      IF "Object ID" <> 0 THEN
        CASE "Object Type" OF
          "Object Type"::Report: REPORT.RUN("Object ID");
          "Object Type"::Page: PAGE.RUN("Object ID");
        END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70007 CMMS User Setup Card
{
  OBJECT-PROPERTIES
  {
    Date=30.04.18;
    Time=18:37:39;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=User Setup Card;
               DEA=Benutzereinrichtungskarte];
    SourceTable=Table91;
    PageType=Card;
    ActionList=ACTIONS
    {
      { 1000000014;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000015;1 ;Action    ;
                      Name=User Card;
                      CaptionML=[ENU=User Card;
                                 DEA=Benutzerkarte];
                      RunObject=Page 9807;
                      RunPageLink=User Name=FIELD(User ID);
                      Image=User }
      { 1000000016;1 ;Action    ;
                      Name=User Personalization Card;
                      CaptionML=[ENU=User Personalization Card;
                                 DEA=Benutzeranpassungskarte];
                      RunObject=Page 9172;
                      RunPageLink=User ID=FIELD(User ID);
                      Image=User }
      { 1000000023;1 ;Action    ;
                      Name=Salesperson/Purchaser Card;
                      CaptionML=[ENU=Salesperson/Purchaser Card;
                                 DEA=Verk„ufer-/Eink„uferkarte];
                      RunObject=Page 5116;
                      RunPageLink=Code=FIELD(CM Salesperson Code);
                      Image=SalesPerson }
      { 1000000020;1 ;Action    ;
                      Name=Resource Card;
                      CaptionML=[ENU=Resource Card;
                                 DEA=Ressourcenkarte];
                      RunObject=Page 76;
                      RunPageLink=No.=FIELD(IG Resource No.);
                      Image=Resource }
      { 1000000017;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000018;1 ;Action    ;
                      Name=CreateUser;
                      CaptionML=[ENU=Create User;
                                 DEA=Benutzer Anlegen];
                      RunObject=Report 50000;
                      Image=UserSetup }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                GroupType=Group }

    { 1000000002;2;Field  ;
                SourceExpr="User ID" }

    { 1000000010;2;Field  ;
                SourceExpr="IG Paraph" }

    { 1000000009;2;Field  ;
                SourceExpr="IG Function Code" }

    { 1000000022;2;Field  ;
                SourceExpr="CM Salesperson Code" }

    { 1000000019;2;Field  ;
                SourceExpr="IG Resource No." }

    { 1000000003;1;Group  ;
                Name=Communication;
                CaptionML=[ENU=Communication;
                           DEA=Kommunikation];
                GroupType=Group }

    { 1000000011;2;Field  ;
                SourceExpr="IG Phone No." }

    { 1000000012;2;Field  ;
                SourceExpr="IG Fax No." }

    { 1000000004;2;Field  ;
                SourceExpr="E-Mail" }

    { 1000000005;1;Group  ;
                Name=Rights;
                CaptionML=[ENU=Rights;
                           DEA=Berechtigungen];
                GroupType=Group }

    { 1000000006;2;Field  ;
                SourceExpr="IG Asset Administrator" }

    { 1000000024;2;Field  ;
                SourceExpr="IG Project Administrator" }

    { 1000000025;2;Field  ;
                SourceExpr="IG Workorder Administrator" }

    { 1000000027;2;Field  ;
                SourceExpr="IG PO Resp. Ctr. Filter" }

    { 1000000007;2;Field  ;
                SourceExpr="IG Asset Resp. Ctr. Filter" }

    { 1000000008;2;Field  ;
                SourceExpr="IG Project Resp. Ctr. Filter" }

    { 1000000021;2;Field  ;
                SourceExpr="CM Timetrack. Revers. Allowed" }

    { 1000000028;2;Field  ;
                SourceExpr="CM Timetrack. Mandatory" }

    { 1000000013;2;Field  ;
                SourceExpr="CM Substitution Admin" }

    { 1000000026;2;Field  ;
                SourceExpr="CM User Admin" }

    { 1000000029;2;Field  ;
                SourceExpr="CM Change Oper. Status Allowed" }

    { 1000000041;2;Field  ;
                SourceExpr="CM Discard Workorders Allowed" }

    { 1000000030;1;Group  ;
                Name=Notifications;
                CaptionML=[ENU=Notifications;
                           DEA=Benachrichtigungen];
                GroupType=Group }

    { 1000000031;2;Field  ;
                SourceExpr="CM Notifications" }

    { 1000000032;2;Field  ;
                SourceExpr="CM Connector" }

    { 1000000033;2;Field  ;
                SourceExpr="CM Connector Id" }

    { 1000000040;2;Group  ;
                Name=NotificationTypes;
                CaptionML=[ENU=Types;
                           DEA=Arten];
                GroupType=Group }

    { 1000000034;3;Field  ;
                SourceExpr="CM Notification 1" }

    { 1000000035;3;Field  ;
                SourceExpr="CM Notification 2" }

    { 1000000036;3;Field  ;
                SourceExpr="CM Notification 3" }

    { 1000000037;3;Field  ;
                SourceExpr="CM Notification 4" }

    { 1000000038;3;Field  ;
                SourceExpr="CM Notification 5" }

    { 1000000039;3;Field  ;
                SourceExpr="CM Notification 6" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70008 CMMS User List
{
  OBJECT-PROPERTIES
  {
    Date=10.11.16;
    Time=14:42:00;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table91;
    PageType=List;
    ShowFilter=No;
    OnOpenPage=BEGIN
                 //SetVisibilityRec;
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="User ID" }

    { 1000000008;2;Field  ;
                SourceExpr="CM Name" }

    { 1000000003;2;Field  ;
                SourceExpr="IG Function Code" }

    { 1000000004;2;Field  ;
                SourceExpr="IG Paraph" }

    { 1000000005;2;Field  ;
                SourceExpr="E-Mail" }

    { 1000000006;2;Field  ;
                SourceExpr="IG Phone No." }

    { 1000000007;2;Field  ;
                SourceExpr="IG Fax No." }

  }
  CODE
  {

    LOCAL PROCEDURE SetVisibilityRec@1000000000();
    VAR
      CMUserAccessMgmt@1000000000 : Codeunit 70010;
    BEGIN
      {
      IF NOT CMUserAccessMgmt.UserAllAccess THEN BEGIN
        IF CMUserAccessMgmt.GetUserRespFilter <> '' THEN BEGIN
          FILTERGROUP(2);
          SETRANGE("IG Org. Resp. Ctr. Filter",CMUserAccessMgmt.GetUserRespFilter);
          FILTERGROUP(0);
        END;
      END;
      }
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70009 CMMS GPM Ticket
{
  OBJECT-PROPERTIES
  {
    Date=07.06.17;
    Time=15:36:42;
    Modified=Yes;
    Version List=CMMS,GPM;
  }
  PROPERTIES
  {
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table50004;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    PageType=List;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             EntryNo := 3; //Auto increment doesnt work with Temporary Tables like this one!
           END;

    OnAfterGetRecord=BEGIN
                       IF (CURRENTCLIENTTYPE <> CLIENTTYPE::SOAP) AND (CURRENTCLIENTTYPE <> CLIENTTYPE::OData) THEN BEGIN
                         Rec.GetBlobValues
                         (
                         activation_description,
                         deactivation_description,
                         activation_details,
                         deactivation_details,
                         problem_description,
                         actions_performed
                         );
                       END;
                     END;

    OnInsertRecord=VAR
                     CMGPMTicketArch@1000000001 : Record 50005;
                   BEGIN
                     Rec.id := EntryNo;
                     EntryNo += 1;

                     Rec.SetBlobValues
                     (
                     activation_description,
                     deactivation_description,
                     activation_details,
                     deactivation_details,
                     problem_description,
                     actions_performed
                     );

                     activation_description := '';
                     deactivation_description := '';
                     activation_details := '';
                     deactivation_details := '';
                     problem_description := '';
                     actions_performed := '';

                     CMGPMTicketArch.RESET;
                     CMGPMTicketArch.INIT;
                     CMGPMTicketArch.TRANSFERFIELDS(Rec, FALSE);
                     CMGPMTicketArch.id := 0; //Auto Increment in Archive
                     CMGPMTicketArch.INSERT(TRUE);
                   END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr=id }

    { 1000000003;2;Field  ;
                SourceExpr=ticket_id }

    { 1000000033;2;Field  ;
                SourceExpr=deleted }

    { 1000000004;2;Field  ;
                SourceExpr=name }

    { 1000000005;2;Field  ;
                SourceExpr=grouping }

    { 1000000006;2;Field  ;
                SourceExpr=activated_time }

    { 1000000007;2;Field  ;
                SourceExpr=deactivated_time }

    { 1000000008;2;Field  ;
                SourceExpr=reference_plant_id }

    { 1000000009;2;Field  ;
                SourceExpr=reference_element_id }

    { 1000000034;2;Field  ;
                SourceExpr=reference_element_name }

    { 1000000010;2;Field  ;
                SourceExpr=priority }

    { 1000000011;2;Field  ;
                SourceExpr=reference_alerm_id }

    { 1000000012;2;Field  ;
                SourceExpr=state }

    { 1000000013;2;Field  ;
                SourceExpr=alert_type }

    { 1000000014;2;Field  ;
                SourceExpr=operator_name }

    { 1000000015;2;Field  ;
                Name=activation_description;
                SourceExpr=activation_description }

    { 1000000016;2;Field  ;
                Name=deactivation_description;
                SourceExpr=deactivation_description }

    { 1000000017;2;Field  ;
                Name=activation_details;
                SourceExpr=activation_details }

    { 1000000018;2;Field  ;
                Name=deactivation_details;
                SourceExpr=deactivation_details }

    { 1000000019;2;Field  ;
                SourceExpr=affects_availibility }

    { 1000000020;2;Field  ;
                SourceExpr=calculate_loss }

    { 1000000021;2;Field  ;
                SourceExpr=repercussion_id }

    { 1000000022;2;Field  ;
                SourceExpr=affected_element_id }

    { 1000000023;2;Field  ;
                SourceExpr=reason_id }

    { 1000000024;2;Field  ;
                Name=problem_description;
                SourceExpr=problem_description }

    { 1000000025;2;Field  ;
                SourceExpr=company }

    { 1000000026;2;Field  ;
                SourceExpr=time_t }

    { 1000000027;2;Field  ;
                Name=actions_performed;
                SourceExpr=actions_performed }

    { 1000000028;2;Field  ;
                SourceExpr=maintenance_type_id }

    { 1000000029;2;Field  ;
                SourceExpr=reference_element_type_id }

    { 1000000030;2;Field  ;
                SourceExpr=notified_time }

    { 1000000031;2;Field  ;
                SourceExpr=estimated_activation_time }

    { 1000000032;2;Field  ;
                SourceExpr=operator_id }

  }
  CODE
  {
    VAR
      activation_description@1000000000 : Text INDATASET;
      deactivation_description@1000000001 : Text INDATASET;
      activation_details@1000000002 : Text INDATASET;
      deactivation_details@1000000003 : Text INDATASET;
      problem_description@1000000004 : Text INDATASET;
      actions_performed@1000000005 : Text INDATASET;
      EntryNo@1000000006 : Integer;

    BEGIN
    END.
  }
}

OBJECT Page 70010 CMMS Notification Setup Card
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=09:09:08;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=User Setup Card;
               DEA=Benutzereinrichtungskarte];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table91;
    PageType=Card;
    ShowFilter=No;
    OnOpenPage=BEGIN
                 SETRANGE("User ID", USERID);
               END;

    ActionList=ACTIONS
    {
      { 1000000014;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000015;1 ;Action    ;
                      Name=User Card;
                      CaptionML=[ENU=User Card;
                                 DEA=Benutzerkarte];
                      RunObject=Page 9807;
                      RunPageLink=User Name=FIELD(User ID);
                      Image=User }
      { 1000000016;1 ;Action    ;
                      Name=User Personalization Card;
                      CaptionML=[ENU=User Personalization Card;
                                 DEA=Benutzeranpassungskarte];
                      RunObject=Page 9172;
                      RunPageLink=User ID=FIELD(User ID);
                      Image=User }
      { 1000000023;1 ;Action    ;
                      Name=Salesperson/Purchaser Card;
                      CaptionML=[ENU=Salesperson/Purchaser Card;
                                 DEA=Verk„ufer-/Eink„uferkarte];
                      RunObject=Page 5116;
                      RunPageLink=Code=FIELD(CM Salesperson Code);
                      Image=SalesPerson }
      { 1000000020;1 ;Action    ;
                      Name=Resource Card;
                      CaptionML=[ENU=Resource Card;
                                 DEA=Ressourcenkarte];
                      RunObject=Page 76;
                      RunPageLink=No.=FIELD(IG Resource No.);
                      Image=Resource }
      { 1000000017;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000018;1 ;Action    ;
                      Name=CreateUser;
                      CaptionML=[ENU=Create User;
                                 DEA=Benutzer Anlegen];
                      RunObject=Report 50000;
                      Image=UserSetup }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000030;1;Group  ;
                Name=Notifications;
                CaptionML=[ENU=Notifications;
                           DEA=Benachrichtigungen];
                GroupType=Group }

    { 1000000031;2;Field  ;
                SourceExpr="CM Notifications" }

    { 1000000032;2;Field  ;
                SourceExpr="CM Connector" }

    { 1000000033;2;Field  ;
                SourceExpr="CM Connector Id" }

    { 1000000040;2;Group  ;
                Name=NotificationTypes;
                CaptionML=[ENU=Types;
                           DEA=Arten];
                GroupType=Group }

    { 1000000034;3;Field  ;
                SourceExpr="CM Notification 1" }

    { 1000000035;3;Field  ;
                SourceExpr="CM Notification 2" }

    { 1000000036;3;Field  ;
                SourceExpr="CM Notification 3" }

    { 1000000037;3;Field  ;
                SourceExpr="CM Notification 4" }

    { 1000000038;3;Field  ;
                SourceExpr="CM Notification 5" }

    { 1000000039;3;Field  ;
                SourceExpr="CM Notification 6" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70011 CMMS Change Status Workorder
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=14:34:50;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Change Status;
               DEA=Status „ndern];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table50002;
    DataCaptionExpr='';
    PageType=StandardDialog;
    SourceTableTemporary=Yes;
    InstructionalTextML=[ENU=Do you want to change the status?;
                         DEA=M”chten Sie den Status „ndern?];
    OnInit=VAR
             CR@1000000001 : Char;
             LF@1000000000 : Char;
           BEGIN
             INIT;
             INSERT;

             CR := 13;
             LF := 10;
             Infotext := STRSUBSTNO
             (Text004,
               (FORMAT(CR) + FORMAT(LF) + FORMAT(CR) + FORMAT(LF)),
               Rec2."CM Status"::New,
               Rec2."CM Status"::Open,
               Rec2."CM Status"::"In Process",
               Rec2."CM Status"::Completed,
               Rec2."CM Status"::Done
             );
           END;

    OnOpenPage=VAR
                 UserSetup@1000000000 : Record 91;
               BEGIN
                 IF NOT UserSetup.GET(USERID) THEN UserSetup.INIT;
                 ShowOpportunity1 := UserSetup."CM Discard Workorders Allowed";
                 ShowOpportunity2 := NOT UserSetup."CM Discard Workorders Allowed";
               END;

    OnQueryClosePage=BEGIN
                       IF CloseAction = ACTION::Yes THEN BEGIN
                         IF ((Rec2."CM Status" IN [Rec2."CM Status"::Done, Rec2."CM Status"::Discarded]) AND
                             (CommentText = '') AND
                             (Rec2."CM Status Change Standard Text" = 0)) THEN
                           ERROR(STRSUBSTNO(Text002), Rec2.FIELDCAPTION("CM Status Change Standard Text"), Text005);
                       END;
                     END;

  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1000000000;1;Field  ;
                Name=NewOpportunityStatus1;
                CaptionML=[ENU=New Status;
                           DEA=Neuer Status];
                SourceExpr=Rec2."CM Status";
                ValuesAllowed=[New;Open;In Process;Completed;Done;Discarded];
                Visible=ShowOpportunity1;
                Style=Strong;
                StyleExpr=TRUE;
                OnValidate=BEGIN
                             CheckStatus();
                           END;
                            }

    { 1000000004;1;Field  ;
                Name=NewOpportunityStatus2;
                CaptionML=[ENU=New Status;
                           DEA=Neuer Status];
                SourceExpr=Rec2."CM Status";
                ValuesAllowed=[New;Open;In Process;Completed;Done];
                Visible=ShowOpportunity2;
                OnValidate=BEGIN
                             CheckStatus();
                           END;
                            }

    { 1000000010;1;Field  ;
                Name=BillingInfo;
                CaptionML=ENU=Billing Info;
                SourceExpr=Rec2."CM Billing Info" }

    { 1000000017;1;Group  ;
                Name=G_New;
                CaptionML=ENU=Standard Text;
                Visible=ShowStatusChangeStdText_New;
                GroupType=Group }

    { 1000000002;2;Field  ;
                Name=StatusChangeStdText_New;
                CaptionML=[ENU=Standard Text;
                           DEA=Standard Text];
                SourceExpr=Rec2."CM Status Change Standard Text";
                Visible=ShowStatusChangeStdText_New }

    { 1000000018;1;Group  ;
                Name=G_Open;
                CaptionML=ENU=Standard Text;
                Visible=ShowStatusChangeStdText_Open;
                GroupType=Group }

    { 1000000005;2;Field  ;
                Name=StatusChangeStdText_Open;
                CaptionML=[ENU=Standard Text;
                           DEA=Standard Text];
                SourceExpr=Rec2."CM Status Change Standard Text";
                ValuesAllowed=[" ";On-Site Check has been scheduled];
                Visible=ShowStatusChangeStdText_Open }

    { 1000000019;1;Group  ;
                Name=G_InProcess;
                CaptionML=ENU=Standard Text;
                Visible=ShowStatusChangeStdText_InProcess;
                GroupType=Group }

    { 1000000006;2;Field  ;
                Name=StatusChangeStdText_InProcess;
                CaptionML=[ENU=Standard Text;
                           DEA=Standard Text];
                SourceExpr=Rec2."CM Status Change Standard Text";
                ValuesAllowed=[" ";Technician has been informed;Work started;Technician is on site;Technician is on the way];
                Visible=ShowStatusChangeStdText_InProcess }

    { 1000000020;1;Group  ;
                Name=G_Completed;
                CaptionML=ENU=Standard Text;
                Visible=ShowStatusChangeStdText_Completed;
                GroupType=Group }

    { 1000000007;2;Field  ;
                Name=StatusChangeStdText_Completed;
                CaptionML=[ENU=Standard Text;
                           DEA=Standard Text];
                SourceExpr=Rec2."CM Status Change Standard Text";
                ValuesAllowed=[" ";Operational work has been finished;Work Order needs to be invoiced];
                Visible=ShowStatusChangeStdText_Completed }

    { 1000000021;1;Group  ;
                Name=G_Done;
                CaptionML=ENU=Standard Text;
                Visible=ShowStatusChangeStdText_Done;
                GroupType=Group }

    { 1000000008;2;Field  ;
                Name=StatusChangeStdText_Done;
                CaptionML=[ENU=Standard Text;
                           DEA=Standard Text];
                SourceExpr=Rec2."CM Status Change Standard Text";
                ValuesAllowed=[" ";Alarm condition disappeared;Plant back in production;Alarm solved;Communication issue;Internet connection problem];
                Visible=ShowStatusChangeStdText_Done }

    { 1000000022;1;Group  ;
                Name=G_Discarded;
                CaptionML=ENU=Standard Text;
                Visible=ShowStatusChangeStdText_Discarded;
                GroupType=Group }

    { 1000000009;2;Field  ;
                Name=StatusChangeStdText_Discarded;
                CaptionML=[ENU=Standard Text;
                           DEA=Standard Text];
                SourceExpr=Rec2."CM Status Change Standard Text";
                ValuesAllowed=[" ";False alarm;Alarm condition disappeared];
                Visible=ShowStatusChangeStdText_Discarded }

    { 1000000011;1;Field  ;
                Name=InfoText;
                Width=2;
                SourceExpr=Infotext;
                Visible=ShowOpportunity1 OR ShowOpportunity2;
                Editable=FALSE;
                MultiLine=Yes;
                ShowCaption=No }

    { 1000000001;1;Field  ;
                Name=CommentText;
                CaptionML=[ENU=Comment;
                           DEA=Kommentar];
                SourceExpr=CommentText;
                MultiLine=Yes;
                OnValidate=VAR
                             CMWoMgt@1000000000 : Codeunit 70030;
                           BEGIN
                             IF CommentText <> '' THEN
                               CMWoMgt.CheckCommentLength(CommentText);
                           END;
                            }

  }
  CODE
  {
    VAR
      Text001@19003950 : TextConst 'ENU=" ""%1"" is not a valid selection.";DEA=" ""%1"" ist keine gltige Auswahl."';
      Rec2@1000000000 : Record 5092;
      ShowOpportunity1@1000000003 : Boolean;
      ShowOpportunity2@1000000016 : Boolean INDATASET;
      ShowStatusChangeStdText_New@1000000006 : Boolean INDATASET;
      ShowStatusChangeStdText_Open@1000000014 : Boolean INDATASET;
      ShowStatusChangeStdText_InProcess@1000000013 : Boolean INDATASET;
      ShowStatusChangeStdText_Completed@1000000012 : Boolean INDATASET;
      ShowStatusChangeStdText_Done@1000000007 : Boolean INDATASET;
      ShowStatusChangeStdText_Discarded@1000000002 : Boolean INDATASET;
      StatusSelectable@1000000004 : ARRAY [8] OF Boolean;
      CommentText@1000000005 : Text[250];
      Text002@1000000008 : TextConst 'ENU=Please provide "%1" or "%2".;DEA=Bitte geben Sie "%1" oder "%2" an.';
      Text003@1000000009 : TextConst 'ENU=Only allowed with Status ''%1''!;DEA=Nur mit Status ''%1'' erlaubt!';
      Text004@1000000010 : TextConst 'ENU="%2 = Newly created%1%3 = Taken by Plant Manager%1%4 =Assigned to Fieldservice. Physical work in process%1%5 = Physical work completed by Fieldservice%1%6 = Workorder is finally done. Set by Plant Manager"';
      Infotext@1000000011 : Text;
      Text005@1000000015 : TextConst 'ENU=Comment;DEA=Kommentar';

    LOCAL PROCEDURE CheckStatus@19071396();
    BEGIN
      IF NOT StatusSelectable[Rec2."CM Status" + 1] THEN
        ERROR(Text001,Rec2."CM Status");

      CalcVisibility();
    END;

    LOCAL PROCEDURE CalcVisibility@1000000004();
    BEGIN
      Rec2."CM Status Change Standard Text" := 0;

      ShowStatusChangeStdText_New := FALSE;
      ShowStatusChangeStdText_Open := FALSE;
      ShowStatusChangeStdText_InProcess := FALSE;
      ShowStatusChangeStdText_Completed := FALSE;
      ShowStatusChangeStdText_Done := FALSE;
      ShowStatusChangeStdText_Discarded := FALSE;

      CASE Rec2."CM Status" OF
        Rec2."CM Status"::New : ShowStatusChangeStdText_New := TRUE;
        Rec2."CM Status"::Open : ShowStatusChangeStdText_Open := TRUE;
        Rec2."CM Status"::"In Process" : ShowStatusChangeStdText_InProcess := TRUE;
        Rec2."CM Status"::Completed : ShowStatusChangeStdText_Completed := TRUE;
        Rec2."CM Status"::Done : ShowStatusChangeStdText_Done := TRUE;
        Rec2."CM Status"::Discarded : ShowStatusChangeStdText_Discarded := TRUE;
      END;
    END;

    PROCEDURE SetData@1(Rec@1000 : Record 5092);
    BEGIN
      IF Rec."CM Status" IN [Rec."CM Status"::Done,Rec."CM Status"::Discarded] THEN
        Rec.FIELDERROR("CM Status");

      CASE TRUE OF
        Rec."CM Status" = Rec."CM Status"::New:
          BEGIN
            StatusSelectable[2] := TRUE; //Open
            StatusSelectable[3] := TRUE; //In Process
            StatusSelectable[4] := TRUE; //Completed
            StatusSelectable[5] := TRUE; //Done
            StatusSelectable[6] := TRUE; //Closed
          END;
        Rec."CM Status" = Rec."CM Status"::Open:
          BEGIN
            StatusSelectable[3] := TRUE; //In Process
            StatusSelectable[4] := TRUE; //Completed
            StatusSelectable[5] := TRUE; //Done
            StatusSelectable[6] := TRUE; //Closed
          END;
        Rec."CM Status" = Rec."CM Status"::"In Process":
          BEGIN
            StatusSelectable[4] := TRUE; //Completed
            StatusSelectable[5] := TRUE; //Done
            StatusSelectable[6] := TRUE; //Closed
          END;
        Rec."CM Status" = Rec."CM Status"::Completed:
          BEGIN
            StatusSelectable[3] := TRUE; //In Process
            StatusSelectable[5] := TRUE; //Done
          END;
      END; {End}
      {Set Marked Status}

      Rec2.TRANSFERFIELDS(Rec, TRUE);
      Rec2."CM Status" := Rec."CM Status"; // + 1;
      CalcVisibility();
    END;

    PROCEDURE GetData@1000000000(VAR Workorder@1000000000 : Record 5092;VAR CommentText_@1000000001 : Text[250]);
    BEGIN
      Workorder := Rec2;
      CommentText_ := CommentText;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70018 CMMS Workorder Task Search
{
  OBJECT-PROPERTIES
  {
    Date=16.02.18;
    Time=14:44:55;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    PopulateAllFields=Yes;
    PageType=StandardDialog;
    InstructionalTextML=[ENU=Please provide Workorder or Task No.;
                         DEA=Geben Sie eine Arbeitsauftrag- oder Augabennr. an.];
    OnQueryClosePage=VAR
                       Workorder@1000000000 : Record 5092;
                       Task@1000000001 : Record 5080;
                     BEGIN
                       IF CloseAction = ACTION::OK THEN BEGIN
                         IF (Workorder.GET(No)) AND (Workorder."CM Is Workorder") THEN BEGIN
                           CMWoMgt.ShowWorkorderCard(Workorder);

                           EXIT(TRUE);
                         END;

                         IF (Task.GET(No)) AND (Task."CM Type" = Task."CM Type"::Task) THEN BEGIN
                           CMTaskMgt.ShowTaskCard(Task);

                           EXIT(TRUE);
                         END;

                         ERROR(Text001);
                       END;
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                Name=No;
                CaptionML=[ENU=Workorder/Task No.;
                           DEA=Arbeitsauftrag/Aufgabe Nr.];
                SourceExpr=No }

  }
  CODE
  {
    VAR
      No@1000000000 : Code[20];
      Text001@1000000001 : TextConst 'ENU=Nothing found!;DEA=Nichts gefunden!';
      CMWoMgt@1000000002 : Codeunit 70030;
      CMTaskMgt@1000000003 : Codeunit 70031;

    BEGIN
    END.
  }
}

OBJECT Page 70019 CMMS Asset Search
{
  OBJECT-PROPERTIES
  {
    Date=06.06.17;
    Time=10:04:26;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Asset Search;
               DEA=Anlagensuche];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    PageType=StandardDialog;
    InstructionalTextML=[ENU=Asset Search;
                         DEA=Anlagensuche];
    ShowFilter=No;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000003;1;Field  ;
                Name=SearchTerm;
                CaptionML=[ENU=Search Term;
                           DEA=Suchbegriff];
                SourceExpr=SearchTerm }

    { 1000000010;1;Field  ;
                Name=Search In;
                SourceExpr=GetText();
                ShowCaption=No }

    { 1000000002;1;Field  ;
                Name=Address;
                CaptionML=ENU=Address 1 & 2;
                SourceExpr=SearchIn[1] }

    { 1000000001;1;Field  ;
                Name=City;
                CaptionML=[ENU=City;
                           DEA=Ort];
                SourceExpr=SearchIn[8] }

    { 1000000004;1;Field  ;
                Name=No;
                CaptionML=ENU=No.;
                SourceExpr=SearchIn[2] }

    { 1000000005;1;Field  ;
                Name=MainAssetNo;
                CaptionML=ENU=Main Asset No.;
                SourceExpr=SearchIn[3] }

    { 1000000006;1;Field  ;
                Name=NameName2;
                CaptionML=ENU=Name & Name 2;
                SourceExpr=SearchIn[4] }

    { 1000000007;1;Field  ;
                Name=CustomerNo;
                CaptionML=ENU=Customer No.;
                SourceExpr=SearchIn[5] }

    { 1000000008;1;Field  ;
                Name=CustomerName;
                CaptionML=ENU=Customer Name;
                SourceExpr=SearchIn[6] }

    { 1000000009;1;Field  ;
                Name=CustomerCompChain;
                CaptionML=ENU=Cust. Company Chain;
                SourceExpr=SearchIn[7] }

  }
  CODE
  {
    VAR
      SearchTerm@1000000002 : Text[30];
      SearchIn@1000000001 : ARRAY [16] OF Boolean;

    PROCEDURE GetSearchTerm@1000000006() : Text[30];
    BEGIN
      EXIT(SearchTerm);
    END;

    PROCEDURE GetSearchInArray@1000000000(VAR SearchInArray@1000000001 : ARRAY [16] OF Boolean);
    BEGIN
      CLEAR(SearchInArray);
      COPYARRAY(SearchInArray, SearchIn, 1);
    END;

    LOCAL PROCEDURE GetText@1000000005() : Text;
    BEGIN
      EXIT('Search In');
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70020 CMMS Asset Card
{
  OBJECT-PROPERTIES
  {
    Date=16.04.18;
    Time=15:12:54;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Asset;
               DEA=Anlage];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70020;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,No.)
                    WHERE(Objecttype=CONST(Asset));
    PageType=Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Master Data,Extended,History;
                                DEA=Neu,Vorgang,Berichte,Masterdaten,Erweitert,Historie];
    OnOpenPage=BEGIN
                 _showDetails := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       IF(Rec.Objecttype <> Rec.Objecttype::Asset) THEN
                         ERROR(Text001);

                       SetEditable();
                       _editable := IGEdit;

                       CurrPage.CMContractInfobox.PAGE.SetAssetNo(Rec."No.");
                     END;

    ActionList=ACTIONS
    {
      { 1000000017;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000090;1 ;ActionGroup;
                      CaptionML=[ENU=Master Data;
                                 DEA=Masterdaten];
                      Image=<DataEntry> }
      { 1000000028;2 ;Action    ;
                      Name=Customers;
                      CaptionML=[ENU=Customers;
                                 DEA=Debitoren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CoupledCustomer;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedCustomers(Rec);
                               END;
                                }
      { 1000000005;2 ;Action    ;
                      Name=Contracts;
                      CaptionML=[ENU=Contracts;
                                 DEA=Vertr„ge];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Signature;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedContracts(Rec);
                               END;
                                }
      { 1000000019;2 ;Action    ;
                      Name=Projects;
                      CaptionML=[ENU=Projects;
                                 DEA=Projekte];
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=ServiceTasks;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedAssetsProjects(Rec);
                               END;
                                }
      { 1000000078;2 ;Action    ;
                      Name=UserRoles;
                      CaptionML=[ENU=User / Roles;
                                 DEA=Benutzer / Rollen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Users;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedUserroles(Rec);
                               END;
                                }
      { 1000000088;2 ;Action    ;
                      Name=Relations;
                      CaptionML=[ENU=Relations / Contacts;
                                 DEA=Relations / Kontakte];
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=ContactReference;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedRelations(Rec);
                               END;
                                }
      { 1000000064;2 ;Action    ;
                      Name=Dimensions;
                      CaptionML=[ENU=Dimensions;
                                 DEA=Dimensionen];
                      Image=Dimensions;
                      RunPageMode=View;
                      OnAction=VAR
                                 DimMgt@1000000000 : Codeunit 408;
                               BEGIN
                                 CurrPage.UPDATE(TRUE);
                                 Rec."Dimension Set ID" := DimMgt.EditDimensionSet(Rec."Dimension Set ID", '');
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1000000075;1 ;ActionGroup;
                      Name=Extended;
                      CaptionML=[ENU=Extended;
                                 DEA=Erweitert] }
      { 1000000074;2 ;ActionGroup;
                      Name=Map;
                      CaptionML=[ENU=Map;
                                 DEA=Karte];
                      Image=Map }
      { 1000000070;3 ;Action    ;
                      Name=Show Map (Coordinates);
                      CaptionML=[ENU=Show Map (Coordinates);
                                 DEA=Zeige Karte (Koordinaten)];
                      Image=Map;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowMapByCoordinates(Rec);
                               END;
                                }
      { 1000000071;3 ;Action    ;
                      Name=Show Map (Address);
                      CaptionML=[ENU=Show Map (Address);
                                 DEA=Zeige Karte (Adresse)];
                      Image=Map;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowMapByAddress(Rec);
                               END;
                                }
      { 1000000083;2 ;Action    ;
                      Name=YieldStudy;
                      CaptionML=ENU=Yield Study;
                      Promoted=Yes;
                      Image=BarChart;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedYieldStudy(Rec);
                               END;
                                }
      { 1000000077;2 ;Action    ;
                      Name=Equipment Hierarchy;
                      CaptionML=[ENU=Equipment Hierarchy;
                                 DEA=Equipment Hierarchie];
                      Promoted=Yes;
                      Image=Hierarchy;
                      PromotedCategory=Category5;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMEQPTMgmt@1000000000 : Codeunit 70025;
                               BEGIN
                                 CMEQPTMgmt.ShowEQPT(0,0,Rec."No.");
                               END;
                                }
      { 1000000081;2 ;Action    ;
                      Name=Spare Parts;
                      CaptionML=[ENU=Spare Parts;
                                 DEA=Ersatzteile];
                      Promoted=Yes;
                      Image=ServiceItem;
                      PromotedCategory=Category5;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMEQPTMgmt@1000000000 : Codeunit 70025;
                               BEGIN
                                 CMEQPTMgmt.ShowEQPT(0,1,Rec."No.");
                               END;
                                }
      { 1000000082;2 ;Action    ;
                      Name=To-dos;
                      CaptionML=[ENU=Recurring To-dos;
                                 DEA=Wiederkehrende Aufgaben];
                      Promoted=Yes;
                      Image=Task;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedToDos(Rec);
                               END;
                                }
      { 1000000089;1 ;ActionGroup;
                      CaptionML=[ENU=History;
                                 DEA=Historie];
                      Image=History }
      { 1000000067;2 ;Action    ;
                      Name=Status Change;
                      CaptionML=[ENU=Status Change;
                                 DEA=Status„nderungen];
                      Promoted=Yes;
                      Image=Status;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,1);
                               END;
                                }
      { 1000000086;2 ;Action    ;
                      Name=Read Activities;
                      CaptionML=[ENU=Read Activities;
                                 DEA=Leseaktivit„ten];
                      Image=ViewDetails;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,2);
                               END;
                                }
      { 1000000087;2 ;Action    ;
                      Name=Activities (Internal);
                      CaptionML=[ENU=Activities (Internal);
                                 DEA=Aktivit„ten (Intern)];
                      Promoted=Yes;
                      Image=InteractionLog;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,3);
                               END;
                                }
      { 1000000091;2 ;Action    ;
                      Name=Activities (External);
                      CaptionML=[ENU=Activities (External);
                                 DEA=Aktivit„ten (Extern)];
                      Promoted=Yes;
                      Image=InteractionLog;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,4);
                               END;
                                }
      { 1000000022;2 ;Action    ;
                      Name=Activities;
                      CaptionML=[ENU=Activities;
                                 DEA=Aktivit„ten];
                      Image=InteractionLog;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,0);
                               END;
                                }
      { 1000000084;2 ;Action    ;
                      Name=WOs;
                      CaptionML=[ENU=Workorders;
                                 DEA=Arbeitsauftr„ge];
                      Image=ViewServiceOrder;
                      OnAction=VAR
                                 CMMSWOMgmt@1000000000 : Codeunit 70030;
                               BEGIN
                                 CMMSWOMgmt.ShowWorkorders("No.",'','','','0|1|2|3','','');
                               END;
                                }
      { 1000000085;2 ;Action    ;
                      Name=FinishedWOs;
                      CaptionML=[ENU=Finished Workorders;
                                 DEA=Beendete Arbeitsauftr„ge];
                      Image=PostedServiceOrder;
                      OnAction=VAR
                                 CMMSWOMgmt@1000000000 : Codeunit 70030;
                               BEGIN
                                 CMMSWOMgmt.ShowWorkorders("No.",'','','','4|5','','');
                               END;
                                }
      { 1000000024;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1000000025;1 ;Action    ;
                      Name=NewWorkorder;
                      CaptionML=[ENU=New Workorder;
                                 DEA=Neuer Arbeitsauftrag];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedServiceOrder;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CMWoMgt.NewWorkorderToObjectUI(Rec, FALSE);
                               END;
                                }
      { 1000000026;1 ;Action    ;
                      Name=NewRequest;
                      CaptionML=[ENU=New Request;
                                 DEA=Neue Anfrage];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedReturnReceipt;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CMTaskMgt.NewRequestFromAssetProject(Rec);
                               END;
                                }
      { 1000000038;1 ;Action    ;
                      Name=ChangeStatus;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Change &Status;
                                 DEA=S&tatus „ndern];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ChangeStatus;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CMMSAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                                 CurrPage.UPDATE;
                                 CMMSAssetMgmt.ChangeStatus(Rec);
                               END;
                                }
      { 1000000072;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000073;1 ;Action    ;
                      Name=ShowDetails;
                      CaptionML=[ENU=Show Details;
                                 DEA=Zeige Details];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Setup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 _showDetails := NOT _showDetails;
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[ENU=General;
                           DEA=Allgemein];
                Editable=IGEdit;
                GroupType=Group }

    { 1000000002;2;Field  ;
                SourceExpr="No.";
                Enabled=FALSE;
                OnAssistEdit=BEGIN
                               //CMGenMgt.GetNo(Rec);
                             END;
                              }

    { 1000000003;2;Field  ;
                SourceExpr=Name }

    { 1000000006;2;Field  ;
                SourceExpr="Name 2" }

    { 1000000014;2;Field  ;
                SourceExpr="Operational Status";
                Editable=FALSE }

    { 1000000092;2;Field  ;
                SourceExpr="Inactive at Date" }

    { 1000000034;2;Field  ;
                SourceExpr=Portfolio }

    { 1000000021;2;Field  ;
                SourceExpr="Asset Type";
                Importance=Additional }

    { 1000000080;2;Field  ;
                SourceExpr="Responsibility Center" }

    { 1000000007;2;Field  ;
                Name=<Address_>;
                SourceExpr=Address;
                OnAssistEdit=BEGIN
                               CMAssetMgt.ShowMapByAddress(Rec);
                             END;
                              }

    { 1000000018;2;Field  ;
                SourceExpr="Extended Address";
                Importance=Additional }

    { 1000000009;2;Field  ;
                SourceExpr=City }

    { 1000000010;2;Field  ;
                SourceExpr="Post Code" }

    { 1000000011;2;Field  ;
                SourceExpr="Country Code" }

    { 1000000023;2;Field  ;
                SourceExpr="Coordinates Latitude";
                OnAssistEdit=BEGIN
                               CMAssetMgt.ShowMapByCoordinates(Rec);
                             END;
                              }

    { 1000000008;2;Field  ;
                SourceExpr="Coordinates Longitude";
                OnAssistEdit=BEGIN
                               CMAssetMgt.ShowMapByCoordinates(Rec);
                             END;
                              }

    { 1000000029;2;Field  ;
                SourceExpr="Company Name";
                Importance=Additional }

    { 1000000040;2;Field  ;
                SourceExpr="Capacity DC kWp" }

    { 1000000094;2;Field  ;
                SourceExpr="Email Notification" }

    { 1000000045;1;Group  ;
                Name=Operational;
                CaptionML=ENU=Operational;
                Visible=_showDetails;
                Editable=IGEdit;
                GroupType=Group }

    { 1000000050;2;Field  ;
                SourceExpr="Available in PV Plus" }

    { 1000000051;2;Field  ;
                SourceExpr="Available in EEM" }

    { 1000000044;2;Field  ;
                SourceExpr="EEM Identification";
                MultiLine=Yes }

    { 1000000047;2;Field  ;
                SourceExpr="Direct Marketer Interface";
                Importance=Additional }

    { 1000000046;2;Field  ;
                SourceExpr="External Portal Available" }

    { 1000000056;2;Field  ;
                SourceExpr="On Site Maintanance" }

    { 1000000059;2;Field  ;
                SourceExpr="Security Center Handling" }

    { 1000000060;2;Field  ;
                SourceExpr="Site Entry Specifics";
                Importance=Additional;
                MultiLine=Yes }

    { 1000000065;2;Field  ;
                SourceExpr="Weekend Working Procedure";
                Importance=Additional;
                MultiLine=Yes }

    { 1000000066;2;Field  ;
                SourceExpr="Health and Safety Requirements";
                Importance=Additional;
                MultiLine=Yes }

    { 1000000058;1;Group  ;
                Name=Technical;
                CaptionML=ENU=Technical;
                Visible=_showDetails;
                Editable=IGEdit;
                GroupType=Group }

    { 1000000049;2;Field  ;
                SourceExpr="Inverter Type" }

    { 1000000033;2;Field  ;
                SourceExpr=Mounting }

    { 1000000041;2;Field  ;
                SourceExpr="Commissioning Date" }

    { 1000000031;2;Field  ;
                SourceExpr=Surroundings }

    { 1000000037;2;Field  ;
                SourceExpr="Additional Technical Info";
                Importance=Additional;
                MultiLine=Yes }

    { 1000000042;2;Field  ;
                SourceExpr="PAC Date" }

    { 1000000068;2;Field  ;
                SourceExpr="FAC Date" }

    { 1000000035;1;Group  ;
                Name=Commercial;
                Visible=_showDetails;
                Editable=IGEdit;
                GroupType=Group }

    { 1000000039;2;Field  ;
                SourceExpr="Subsidy Tariff Details";
                MultiLine=Yes }

    { 1000000063;2;Field  ;
                SourceExpr="Subsidy Tariff Currency" }

    { 1000000043;2;Field  ;
                SourceExpr="Export PPA Price" }

    { 1000000062;2;Field  ;
                SourceExpr="Export PPA Currency" }

    { 1000000036;1;Group  ;
                Name=Reporting;
                Visible=_showDetails;
                Editable=IGEdit;
                GroupType=Group }

    { 1000000053;2;Field  ;
                SourceExpr="Irradiation Yield Study" }

    { 1000000054;2;Field  ;
                SourceExpr="Anticipated Annual Yield" }

    { 1000000012;0;Container;
                ContainerType=FactBoxArea }

    { 1000000076;1;Part   ;
                Name=CMContractInfobox;
                SubPageView=SORTING(No.);
                PagePartID=Page70704;
                PartType=Page }

    { 1000000069;1;Part   ;
                SubPageView=SORTING(Objecttype,No.);
                SubPageLink=Objecttype=CONST(Asset),
                            No.=FIELD(No.);
                PagePartID=Page70700;
                PartType=Page }

    { 1000000016;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1000000015;1;Part   ;
                SubPageView=SORTING(Objecttype,No.);
                SubPageLink=Objecttype=CONST(Asset),
                            No.=FIELD(No.);
                PagePartID=Page70706;
                PartType=Page }

    { 1000000013;1;Part   ;
                SubPageView=SORTING(Objecttype,No.);
                SubPageLink=No.=FIELD(No.),
                            Objecttype=CONST(Asset);
                PagePartID=Page70701;
                PartType=Page }

  }
  CODE
  {
    VAR
      CMGenMgt@1000000000 : Codeunit 70000;
      CMWoMgt@1000000001 : Codeunit 70030;
      CMAssetMgt@1000000002 : Codeunit 70020;
      CMTaskMgt@1000000038 : Codeunit 70031;
      IGEdit@1000000003 : Boolean INDATASET;
      _editable@1000000015 : Boolean INDATASET;
      _showDetails@1000000016 : Boolean INDATASET;
      Text001@1000000037 : TextConst 'ENU=Invalid call. Recorad is a Project!;DEA=Ungltiger Aufruf. Datensatz ist ein Projekt!';
      LogEntry@1000000039 : Record 5065;
      Text002@1000000004 : TextConst 'ENU=Edit Dimensions;DEA=Dimensionen bearbeiten';

    LOCAL PROCEDURE SetVisibilityRec@1000000002();
    VAR
      CMUserAccessMgmt@1000000000 : Codeunit 70010;
    BEGIN
    END;

    LOCAL PROCEDURE SetEditable@1000000000();
    BEGIN
      IGEdit := FALSE;

      IF (Rec."Operational Status" IN [Rec."Operational Status"::New, Rec."Operational Status"::Released]) AND (CurrPage.EDITABLE) THEN
        IGEdit := TRUE;

      CurrPage.EDITABLE := IGEdit;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70021 CMMS Asset List
{
  OBJECT-PROPERTIES
  {
    Date=26.03.18;
    Time=10:31:34;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Assets;
               DEA=Anlagen];
    MultipleNewLines=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=Yes;
    SourceTable=Table70020;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,No.)
                    WHERE(Objecttype=CONST(Asset));
    PageType=List;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Master Data,Extended,History;
                                DEA=Neu,Vorgang,Berichte,Masterdaten,Erweitert,Historie];
    OnOpenPage=BEGIN
                 //SetVisibilityRec;
                 CMIsMainAsset := (Rec.GETFILTER("Asset Type") = FORMAT(Rec."Asset Type"::"Main Asset"));
               END;

    OnAfterGetRecord=BEGIN
                       SetStyle();
                       CMIsMainAsset := (Rec."Asset Type" = Rec."Asset Type"::"Main Asset");

                       CurrPage.CMContractInfobox.PAGE.SetAssetNo(Rec."No.");
                     END;

    OnAfterGetCurrRecord=BEGIN
                           SetStyle();

                           CurrPage.CMContractInfobox.PAGE.SetAssetNo(Rec."No.");
                         END;

    ActionList=ACTIONS
    {
      { 1000000013;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1000000004;1 ;Action    ;
                      Name=New;
                      CaptionML=[ENU=New;
                                 DEA=Neu];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      Visible=NOT CMIsMainAsset;
                      Enabled=NOT CMIsMainAsset;
                      PromotedIsBig=Yes;
                      Image=New;
                      PromotedCategory=New;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                                 CMAssetMgmt.NewAssetProjectUI(0); {0 = Asset}
                               END;
                                }
      { 1000000025;1 ;Action    ;
                      Name=NewMainAsset;
                      CaptionML=[ENU=New Main Asset;
                                 DEA=Neue Hauptanlage];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      Visible=CMIsMainAsset;
                      Enabled=CMIsMainAsset;
                      PromotedIsBig=Yes;
                      Image=New;
                      PromotedCategory=New;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                                 CMAssetMgmt.NewAssetProjectUI(2) {2 = Main Asset}
                               END;
                                }
      { 1000000012;1 ;Action    ;
                      Name=NewWorkorder;
                      CaptionML=[ENU=New Workorder;
                                 DEA=Neuer Arbeitsauftrag];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedServiceOrder;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CMWoMgt.NewWorkorderToObjectUI(Rec, FALSE);
                               END;
                                }
      { 1000000010;1 ;Action    ;
                      Name=NewRequest;
                      CaptionML=[ENU=New Request;
                                 DEA=Neue Anfrage];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedReturnReceipt;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CMTaskMgt.NewRequestFromAssetProject(Rec);
                               END;
                                }
      { 1000000008;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000015;1 ;Action    ;
                      Name=CMCard;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Card;
                                 DEA=Karte];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                                 CMAssetMgmt.ShowAssetCard(Rec);
                               END;
                                }
      { 1000000009;1 ;Action    ;
                      Name=Search;
                      CaptionML=[ENU=Extended Search;
                                 DEA=Erweiterte Suche];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewDescription;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMAssetMgt.SearchAsset(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000011;1 ;Action    ;
                      Name=ClearSearch;
                      CaptionML=[ENU=Clear Search;
                                 DEA=Suche Aufheben];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ClearLog;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMAssetMgt.ClearAssetSearch(0,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000048;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000047;1 ;ActionGroup;
                      CaptionML=[ENU=Master Data;
                                 DEA=Masterdaten];
                      Image=<DataEntry> }
      { 1000000046;2 ;Action    ;
                      Name=Customers;
                      CaptionML=[ENU=Customers;
                                 DEA=Debitoren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CoupledCustomer;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedCustomers(Rec);
                               END;
                                }
      { 1000000042;2 ;Action    ;
                      Name=Relations;
                      CaptionML=[ENU=Relations / Contacts;
                                 DEA=Relations / Kontakte];
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=ContactReference;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedRelations(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="No.";
                StyleExpr=StyleText }

    { 1000000003;2;Field  ;
                SourceExpr=Name;
                StyleExpr=StyleText }

    { 1000000021;2;Field  ;
                SourceExpr="Name 2" }

    { 1000000006;2;Field  ;
                SourceExpr="Country Code";
                StyleExpr=StyleText }

    { 1000000016;2;Field  ;
                SourceExpr="Responsibility Center";
                Visible=false }

    { 1000000026;2;Field  ;
                SourceExpr="Capacity DC kWp" }

    { 1000000043;2;Field  ;
                SourceExpr="Email Notification" }

    { 1000000036;2;Field  ;
                SourceExpr=Address }

    { 1000000037;2;Field  ;
                SourceExpr="Extended Address" }

    { 1000000039;2;Field  ;
                SourceExpr="Post Code" }

    { 1000000038;2;Field  ;
                SourceExpr=City }

    { 1000000014;2;Field  ;
                SourceExpr="Operational Status";
                Visible=false;
                StyleExpr=StyleText }

    { 1000000007;2;Field  ;
                SourceExpr="Asset Type";
                Visible=false;
                StyleExpr=StyleText }

    { 1000000005;2;Field  ;
                SourceExpr="Main Asset No.";
                Visible=false;
                StyleExpr=StyleText }

    { 1000000035;2;Field  ;
                SourceExpr="Weekend Working Procedure";
                Visible=FALSE }

    { 1000000034;2;Field  ;
                SourceExpr="Available in PV Plus";
                Visible=FALSE }

    { 1000000033;2;Field  ;
                SourceExpr="External Portal Available";
                Visible=FALSE }

    { 1000000032;2;Field  ;
                SourceExpr="Inverter Type";
                Visible=FALSE }

    { 1000000031;2;Field  ;
                SourceExpr=Mounting;
                Visible=FALSE }

    { 1000000030;2;Field  ;
                SourceExpr="Security Center Handling";
                Visible=FALSE }

    { 1000000029;2;Field  ;
                SourceExpr="On Site Maintanance";
                Visible=FALSE }

    { 1000000028;2;Field  ;
                SourceExpr="Customer Demand Level";
                Visible=FALSE }

    { 1000000024;2;Field  ;
                SourceExpr="Coordinates Latitude";
                Visible=FALSE }

    { 1000000027;2;Field  ;
                SourceExpr="Coordinates Longitude";
                Visible=FALSE }

    { 1000000023;2;Field  ;
                SourceExpr=Portfolio;
                Visible=FALSE }

    { 1000000022;2;Field  ;
                SourceExpr="Commercial Status";
                Visible=FALSE }

    { 1000000020;0;Container;
                ContainerType=FactBoxArea }

    { 1000000040;1;Part   ;
                Name=CMContractInfobox;
                SubPageView=SORTING(No.);
                PagePartID=Page70704;
                PartType=Page }

    { 1000000019;1;Part   ;
                SubPageView=SORTING(Objecttype,No.);
                SubPageLink=Objecttype=CONST(Asset),
                            No.=FIELD(No.);
                PagePartID=Page70700;
                PartType=Page }

    { 1000000041;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1000000017;1;Part   ;
                SubPageView=SORTING(Objecttype,No.);
                SubPageLink=Objecttype=CONST(Asset),
                            No.=FIELD(No.);
                PagePartID=Page70706;
                PartType=Page }

    { 1000000018;1;Part   ;
                SubPageView=SORTING(Objecttype,No.);
                SubPageLink=No.=FIELD(No.),
                            Objecttype=CONST(Asset);
                PagePartID=Page70701;
                PartType=Page }

  }
  CODE
  {
    VAR
      CMAssetMgt@1000000000 : Codeunit 70020;
      CMWoMgt@1000000001 : Codeunit 70030;
      CMTaskMgt@1000000003 : Codeunit 70031;
      StyleText@1000000002 : Text INDATASET;
      CMIsMainAsset@1000000004 : Boolean INDATASET;

    LOCAL PROCEDURE SetVisibilityRec@1000000000();
    VAR
      CMUserAccessMgmt@1000000000 : Codeunit 70010;
    BEGIN
      {
      IF NOT CMUserAccessMgmt.UserAllAccess THEN BEGIN
        IF CMUserAccessMgmt.GetAssetRespFilter <> '' THEN BEGIN
          FILTERGROUP(2);
          SETFILTER("Responsibility Center",CMUserAccessMgmt.GetAssetRespFilter);
          FILTERGROUP(0);
        END ELSE BEGIN
          FILTERGROUP(2);
          SETRANGE("User ID Filter",USERID);
          SETRANGE(ShowAsset,TRUE);
          FILTERGROUP(0);
        END;
      END;
      }
    END;

    PROCEDURE SetRec@1000000001(VAR Record@1000000000 : Record 70020);
    BEGIN
      Rec.COPYFILTERS(Record);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE GetNo@1000000002() : Text;
    BEGIN
      EXIT(Rec."No.");
    END;

    LOCAL PROCEDURE SetStyle@1000000003();
    BEGIN
      StyleText := '';

      IF "Asset Type" = "Asset Type"::"Main Asset" THEN
        StyleText := 'Strong';
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70022 CMMS Project Card
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=16:28:51;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Project;
               DEA=Projekt];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70020;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,No.)
                    WHERE(Objecttype=CONST(Project));
    PageType=Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Master Data,Extended,History;
                                DEA=Neu,Vorgang,Berichte,Masterdaten,Erweitert,Historie];
    OnAfterGetRecord=BEGIN
                       IF Rec.Objecttype <> Rec.Objecttype::Project THEN
                         ERROR(Text001);

                       SetEditable();
                     END;

    ActionList=ACTIONS
    {
      { 1000000017;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000026;1 ;ActionGroup;
                      CaptionML=[ENU=Master Data;
                                 DEA=Masterdaten];
                      Image=<DataEntry> }
      { 1000000004;2 ;Action    ;
                      Name=Customers;
                      CaptionML=[ENU=Customers;
                                 DEA=Debitoren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CoupledCustomer;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedCustomers(Rec);
                               END;
                                }
      { 1000000076;2 ;Action    ;
                      Name=UserRoles;
                      CaptionML=[ENU=User / Roles;
                                 DEA=Benutzer / Rollen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Users;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedUserroles(Rec);
                               END;
                                }
      { 1000000021;2 ;Action    ;
                      Name=Relations;
                      CaptionML=[ENU=Relations / Contacts;
                                 DEA=Relations / Kontakte];
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=ContactReference;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedRelations(Rec);
                               END;
                                }
      { 1000000010;2 ;Action    ;
                      Name=Assets;
                      CaptionML=[ENU=Assets;
                                 DEA=Anlagen];
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=ServiceTasks;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedAssetsProjects(Rec);
                               END;
                                }
      { 1000000009;2 ;Action    ;
                      Name=Dimensions;
                      CaptionML=[ENU=Dimensions;
                                 DEA=Dimensionen];
                      Image=Dimensions;
                      RunPageMode=View;
                      OnAction=VAR
                                 DimMgt@1000000000 : Codeunit 408;
                               BEGIN
                                 CurrPage.UPDATE(TRUE);
                                 Rec."Dimension Set ID" := DimMgt.EditDimensionSet(Rec."Dimension Set ID", '');
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1000000075;1 ;ActionGroup;
                      Name=Extended;
                      CaptionML=[ENU=Extended;
                                 DEA=Erweitert] }
      { 1000000074;2 ;ActionGroup;
                      Name=Map;
                      CaptionML=[ENU=Map;
                                 DEA=Karte];
                      Image=Map }
      { 1000000070;3 ;Action    ;
                      Name=Show Map (Coordinates);
                      CaptionML=[ENU=Show Map (Coordinates);
                                 DEA=Zeige Karte (Koordinaten)];
                      Image=Map;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowMapByCoordinates(Rec);
                               END;
                                }
      { 1000000071;3 ;Action    ;
                      Name=Show Map (Address);
                      CaptionML=[ENU=Show Map (Address);
                                 DEA=Zeige Karte (Adresse)];
                      Image=Map;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowMapByAddress(Rec);
                               END;
                                }
      { 1000000027;1 ;ActionGroup;
                      CaptionML=[ENU=History;
                                 DEA=Historie];
                      Image=History }
      { 1000000023;2 ;Action    ;
                      Name=Status Change;
                      CaptionML=[ENU=Status Change;
                                 DEA=Status„nderungen];
                      Promoted=Yes;
                      Image=Status;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,1);
                               END;
                                }
      { 1000000022;2 ;Action    ;
                      Name=Read Activities;
                      CaptionML=[ENU=Read Activities;
                                 DEA=Leseaktivit„ten];
                      Image=ViewDetails;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,2);
                               END;
                                }
      { 1000000020;2 ;Action    ;
                      Name=Activities (Internal);
                      CaptionML=[ENU=Activities (Internal);
                                 DEA=Aktivit„ten (Intern)];
                      Promoted=Yes;
                      Image=InteractionLog;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,3);
                               END;
                                }
      { 1000000011;2 ;Action    ;
                      Name=Activities (External);
                      CaptionML=[ENU=Activities (External);
                                 DEA=Aktivit„ten (Extern)];
                      Promoted=Yes;
                      Image=InteractionLog;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,4);
                               END;
                                }
      { 1000000018;2 ;Action    ;
                      Name=Activities;
                      CaptionML=[ENU=Activities;
                                 DEA=Aktivit„ten];
                      Image=InteractionLog;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,0);
                               END;
                                }
      { 1000000041;2 ;Action    ;
                      Name=WOs;
                      CaptionML=[ENU=Workorders;
                                 DEA=Arbeitsauftr„ge];
                      Image=ViewServiceOrder;
                      OnAction=VAR
                                 CMMSWOMgmt@1000000000 : Codeunit 70030;
                               BEGIN
                                 CMMSWOMgmt.ShowWorkorders("No.",'','','','0|1|2|3','','');
                               END;
                                }
      { 1000000040;2 ;Action    ;
                      Name=FinishedWOs;
                      CaptionML=[ENU=Finished Workorders;
                                 DEA=Beendete Arbeitsauftr„ge];
                      Image=PostedServiceOrder;
                      OnAction=VAR
                                 CMMSWOMgmt@1000000000 : Codeunit 70030;
                               BEGIN
                                 CMMSWOMgmt.ShowWorkorders("No.",'','','','4|5','','');
                               END;
                                }
      { 1000000024;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1000000025;1 ;Action    ;
                      Name=NewWorkorder;
                      CaptionML=[ENU=New Workorder;
                                 DEA=Neuer Arbeitsauftrag];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedServiceOrder;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CMWoMgt.NewWorkorderToObjectUI(Rec, FALSE);
                               END;
                                }
      { 1000000007;1 ;Action    ;
                      Name=ChangeStatus;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Change &Status;
                                 DEA=S&tatus „ndern];
                      Promoted=Yes;
                      Enabled=IGEdit;
                      PromotedIsBig=Yes;
                      Image=ChangeStatus;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CMMSAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                                 CurrPage.UPDATE;
                                 CMMSAssetMgmt.ChangeStatus(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[ENU=General;
                           DEA=Allgemein];
                Editable=IGEdit;
                GroupType=Group }

    { 1000000002;2;Field  ;
                SourceExpr="No.";
                Enabled=FALSE;
                OnAssistEdit=BEGIN
                               CMGenMgt.GetNo(Rec);
                             END;
                              }

    { 1000000003;2;Field  ;
                SourceExpr=Name }

    { 1000000006;2;Field  ;
                SourceExpr="Name 2" }

    { 1000000014;2;Field  ;
                SourceExpr="Operational Status";
                Editable=FALSE }

    { 1000000015;2;Field  ;
                SourceExpr="Project Status" }

    { 1000000019;2;Field  ;
                SourceExpr="Responsibility Center" }

    { 1000000029;2;Field  ;
                SourceExpr="Project Company Name" }

    { 1000000028;1;Group  ;
                Name=Extended;
                CaptionML=[ENU=Extended;
                           DEA=Erweitert];
                Editable=IGEdit;
                GroupType=Group }

    { 1000000030;2;Field  ;
                SourceExpr="Project Order No." }

    { 1000000031;2;Field  ;
                SourceExpr="Project Quote No" }

    { 1000000032;2;Field  ;
                SourceExpr="Project Start Date" }

    { 1000000034;2;Field  ;
                SourceExpr="Project End Date" }

    { 1000000008;2;Field  ;
                SourceExpr="Project Due date" }

    { 1000000035;2;Field  ;
                SourceExpr="Project Trigger" }

    { 1000000036;2;Field  ;
                SourceExpr="Project Goals";
                Importance=Additional }

    { 1000000037;2;Field  ;
                SourceExpr="Project Summary";
                Importance=Additional }

    { 1000000038;2;Field  ;
                SourceExpr="Project Documentation";
                Importance=Additional }

    { 1000000039;2;Field  ;
                SourceExpr="Project Prority";
                Importance=Additional }

    { 1000000047;2;Field  ;
                SourceExpr="First Project Manager" }

    { 1000000048;2;Field  ;
                SourceExpr="First Related Customer" }

    { 1000000049;2;Field  ;
                SourceExpr="First Related Customer Name" }

    { 1000000050;2;Field  ;
                SourceExpr="First Related Asset" }

    { 1000000033;1;Group  ;
                Name=Location;
                CaptionML=[ENU=Location;
                           DEA=Ort];
                GroupType=Group }

    { 1000000042;2;Field  ;
                SourceExpr=Address }

    { 1000000043;2;Field  ;
                SourceExpr="Extended Address" }

    { 1000000044;2;Field  ;
                SourceExpr=City }

    { 1000000045;2;Field  ;
                SourceExpr="Post Code" }

    { 1000000046;2;Field  ;
                SourceExpr="Country Code" }

    { 1000000012;0;Container;
                ContainerType=FactBoxArea }

    { 1000000005;1;Part   ;
                SubPageView=SORTING(Objecttype,No.);
                SubPageLink=No.=FIELD(No.),
                            Objecttype=CONST(Project);
                PagePartID=Page70705;
                PartType=Page }

    { 1000000016;1;Part   ;
                SubPageView=SORTING(Objecttype,No.);
                SubPageLink=Objecttype=CONST(Project),
                            No.=FIELD(No.);
                PagePartID=Page70700;
                PartType=Page }

    { 1000000013;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      CMGenMgt@1000000000 : Codeunit 70000;
      CMWoMgt@1000000001 : Codeunit 70030;
      CMAssetMgt@1000000002 : Codeunit 70020;
      _editable@1000000015 : Boolean INDATASET;
      IGEdit@1000000004 : Boolean INDATASET;
      Text001@1000000037 : TextConst 'ENU=Invalid call. Record is an Asset!;DEA=Ungltiger Aufruf. Datensatz ist eine Anlage!';
      LogEntry@1000000003 : Record 5065;

    LOCAL PROCEDURE SetEditable@1000000002();
    BEGIN
      IGEdit := FALSE;

      IF (Rec."Operational Status" IN [Rec."Operational Status"::New, Rec."Operational Status"::Released]) AND (CurrPage.EDITABLE) THEN
        IGEdit := TRUE;

      CurrPage.EDITABLE := IGEdit;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70023 CMMS Project List
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=16:29:03;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Projects;
               DEA=Projekte];
    MultipleNewLines=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table70020;
    SourceTableView=SORTING(Objecttype,No.)
                    WHERE(Objecttype=CONST(Project));
    PageType=List;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Master Data,Extended,History;
                                DEA=Neu,Vorgang,Berichte,Masterdaten,Erweitert,Historie];
    OnOpenPage=BEGIN
                 //SetVisibilityRec();
               END;

    ActionList=ACTIONS
    {
      { 1000000008;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1000000017;1 ;Action    ;
                      Name=New;
                      CaptionML=[ENU=New;
                                 DEA=Neu];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=New;
                      PromotedCategory=New;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                                 CMAssetMgmt.NewAssetProjectUI(1); {1 = Project}
                               END;
                                }
      { 1000000007;1 ;Action    ;
                      Name=NewWorkorder;
                      CaptionML=[ENU=New Workorder;
                                 DEA=Neuer Arbeitsauftrag];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedServiceOrder;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CMWoMgt.NewWorkorderToObjectUI(Rec, FALSE);
                               END;
                                }
      { 1000000012;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000018;1 ;Action    ;
                      Name=CMCard;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Card;
                                 DEA=Karte];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                                 CMAssetMgmt.ShowProjectCard(Rec);
                               END;
                                }
      { 1000000011;1 ;Action    ;
                      Name=Search;
                      CaptionML=[ENU=Extended Search;
                                 DEA=Erweiterte Suche];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewDescription;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMAssetMgt.SearchAsset(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000010;1 ;Action    ;
                      Name=ClearSearch;
                      CaptionML=[ENU=Clear Search;
                                 DEA=Suche Aufheben];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ClearLog;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMAssetMgt.ClearAssetSearch(1,Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000022;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000021;1 ;ActionGroup;
                      CaptionML=[ENU=Master Data;
                                 DEA=Masterdaten];
                      Image=<DataEntry> }
      { 1000000019;2 ;Action    ;
                      Name=Customers;
                      CaptionML=[ENU=Customers;
                                 DEA=Debitoren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CoupledCustomer;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedCustomers(Rec);
                               END;
                                }
      { 1000000006;2 ;Action    ;
                      Name=Relations;
                      CaptionML=[ENU=Relations / Contacts;
                                 DEA=Relations / Kontakte];
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=ContactReference;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedRelations(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="No." }

    { 1000000003;2;Field  ;
                SourceExpr=Name }

    { 1000000004;2;Field  ;
                SourceExpr="Name 2" }

    { 1000000005;2;Field  ;
                SourceExpr="Country Code" }

    { 1000000020;2;Field  ;
                SourceExpr="Project Company Name" }

    { 1000000014;2;Field  ;
                SourceExpr="Responsibility Center" }

    { 1000000087;2;Field  ;
                SourceExpr=City;
                Visible=FALSE }

    { 1000000086;2;Field  ;
                SourceExpr="Post Code";
                Visible=FALSE }

    { 1000000023;2;Field  ;
                SourceExpr="Project Start Date" }

    { 1000000024;2;Field  ;
                SourceExpr="Project End Date" }

    { 1000000025;2;Field  ;
                SourceExpr="Project Due date" }

    { 1000000026;2;Field  ;
                SourceExpr="Project Status" }

    { 1000000030;2;Field  ;
                SourceExpr="First Project Manager" }

    { 1000000029;2;Field  ;
                SourceExpr="First Related Customer" }

    { 1000000028;2;Field  ;
                SourceExpr="First Related Customer Name" }

    { 1000000027;2;Field  ;
                SourceExpr="First Related Asset" }

    { 1000000016;0;Container;
                ContainerType=FactBoxArea }

    { 1000000015;1;Part   ;
                SubPageView=SORTING(Objecttype,No.);
                SubPageLink=Objecttype=CONST(Project),
                            No.=FIELD(No.);
                PagePartID=Page70700;
                PartType=Page }

    { 1000000013;1;Part   ;
                SubPageView=SORTING(No.);
                SubPageLink=No.=FIELD(No.),
                            Objecttype=CONST(Project);
                PagePartID=Page70705;
                PartType=Page }

    { 1000000009;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      CMAssetMgt@1000000000 : Codeunit 70020;
      CMWoMgt@1000000001 : Codeunit 70030;

    LOCAL PROCEDURE SetVisibilityRec@1000000000();
    VAR
      CMUserAccessMgmt@1000000000 : Codeunit 70010;
    BEGIN
      {
      IF NOT CMUserAccessMgmt.UserAllAccess THEN BEGIN
        IF CMUserAccessMgmt.GetProjectRespFilter <> '' THEN BEGIN
          FILTERGROUP(2);
          SETFILTER("Responsibility Center",CMUserAccessMgmt.GetProjectRespFilter);
          FILTERGROUP(0);
        END ELSE BEGIN
          FILTERGROUP(2);
          SETRANGE("User ID Filter",USERID);
          SETRANGE(ShowAsset,TRUE);
          FILTERGROUP(0);
        END;
      END;
      }
    END;

    PROCEDURE SetRec@1000000001(VAR Record@1000000000 : Record 70020);
    BEGIN
      Rec.COPYFILTERS(Record);
      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE GetNo@1000000002() : Text;
    BEGIN
      EXIT(Rec."No.");
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70024 CMMS Contract List
{
  OBJECT-PROPERTIES
  {
    Date=15.05.18;
    Time=14:28:11;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Contracts;
               DEA=Vertr„ge];
    MultipleNewLines=No;
    ModifyAllowed=No;
    SourceTable=Table70050;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(No.)
                    ORDER(Descending);
    PageType=List;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Master Data,Extended,History;
                                DEA=Neu,Vorgang,Berichte,Masterdaten,Erweitert,Historie];
    OnOpenPage=BEGIN
                 IF FINDFIRST THEN
                   ;
               END;

    OnAfterGetRecord=BEGIN
                       CALCFIELDS("No. of linked Assets");
                       _enabled := Rec.Template;
                     END;

    OnAfterGetCurrRecord=BEGIN
                           _enabled := Rec.Template;
                         END;

    ActionList=ACTIONS
    {
      { 1000000008;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000019;1 ;Action    ;
                      Name=New;
                      CaptionML=[ENU=New;
                                 DEA=Neu];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=New;
                      PromotedCategory=New;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                                 //CMAssetMgmt.CreateNewAssetProject(0); {0 = Asset}
                                 CMContractMgmt.NewContractUI();
                               END;
                                }
      { 1000000018;1 ;Action    ;
                      Name=Card;
                      CaptionML=[ENU=Card;
                                 DEA=Karte];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMContractMgmt.ShowContractCard(Rec);
                               END;
                                }
      { 1000000009;1 ;Action    ;
                      Name=CreateContract;
                      CaptionML=[ENU=Contract form Template;
                                 DEA=Vertrag aus Vorlage];
                      Promoted=Yes;
                      Enabled=_enabled;
                      PromotedIsBig=Yes;
                      Image=ApplyTemplate;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMGenMgt.ContractTemplateToContract(Rec,TRUE);
                               END;
                                }
      { 1000000015;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000014;1 ;ActionGroup;
                      CaptionML=[ENU=Master Data;
                                 DEA=Masterdaten];
                      Image=<DataEntry> }
      { 1000000013;2 ;Action    ;
                      Name=ContractEntities;
                      CaptionML=ENU=Contract Entities;
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=Signature;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 CMContractMgmt.ShowRelatedContractEntites(Rec);
                               END;
                                }
      { 1000000012;1 ;ActionGroup;
                      Name=Extended;
                      CaptionML=[ENU=Extended;
                                 DEA=Erweitert] }
      { 1000000011;2 ;Action    ;
                      Name=To-dos;
                      CaptionML=[ENU=Recurring To-dos;
                                 DEA=Wiederkehrende Aufgaben];
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=Task;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CMContractMgmt.ShowRelatedToDos(Rec);
                               END;
                                }
      { 1000000004;2 ;Action    ;
                      Name=Activities;
                      CaptionML=[ENU=Activities;
                                 DEA=Aktivit„ten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=InteractionLog;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CMContractMgmt.ShowRelatedLogs(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="No." }

    { 1000000003;2;Field  ;
                SourceExpr=Name }

    { 1000000005;2;Field  ;
                SourceExpr=Status }

    { 1000000006;2;Field  ;
                SourceExpr="Start Date" }

    { 1000000007;2;Field  ;
                SourceExpr="End Date" }

    { 1000000010;2;Field  ;
                SourceExpr="Type of Service" }

    { 1000000020;2;Field  ;
                SourceExpr="Contract Manager" }

    { 1000000042;2;Field  ;
                SourceExpr="Extension Options";
                Visible=FALSE }

    { 1000000041;2;Field  ;
                SourceExpr="Indexation Start Date";
                Visible=FALSE }

    { 1000000040;2;Field  ;
                SourceExpr="Indexation Details";
                Visible=FALSE }

    { 1000000039;2;Field  ;
                SourceExpr=Indexation;
                Visible=FALSE }

    { 1000000038;2;Field  ;
                SourceExpr="Cancellation External (Months)";
                Visible=FALSE }

    { 1000000037;2;Field  ;
                SourceExpr="Payment Terms Code";
                Visible=FALSE }

    { 1000000036;2;Field  ;
                SourceExpr="Annual Fee incl. Adaption";
                Visible=FALSE }

    { 1000000035;2;Field  ;
                SourceExpr="Annual Fee";
                Visible=FALSE }

    { 1000000034;2;Field  ;
                SourceExpr="Extension Type";
                Visible=FALSE }

    { 1000000033;2;Field  ;
                SourceExpr="Bonus Terms";
                Visible=FALSE }

    { 1000000032;2;Field  ;
                SourceExpr=Bonusagreement;
                Visible=FALSE }

    { 1000000031;2;Field  ;
                SourceExpr="Penalty Payment Details";
                Visible=FALSE }

    { 1000000030;2;Field  ;
                SourceExpr="Penalty Payments";
                Visible=FALSE }

    { 1000000029;2;Field  ;
                SourceExpr="Additional Services";
                Visible=FALSE }

    { 1000000028;2;Field  ;
                SourceExpr="Reporting Interval";
                Visible=FALSE }

    { 1000000027;2;Field  ;
                SourceExpr="Weekend Reaction";
                Visible=FALSE }

    { 1000000026;2;Field  ;
                SourceExpr="Reaction Time Details";
                Visible=FALSE }

    { 1000000025;2;Field  ;
                SourceExpr="Min. Reaction Time";
                Visible=FALSE }

    { 1000000024;2;Field  ;
                SourceExpr="Practical Customer Agreements";
                Visible=FALSE }

    { 1000000023;2;Field  ;
                SourceExpr="Service Included";
                Visible=FALSE }

    { 1000000022;2;Field  ;
                SourceExpr="Responsible Sales User";
                Visible=FALSE }

    { 1000000021;2;Field  ;
                SourceExpr="Energy Monitor Accounts";
                Visible=FALSE }

    { 1000000046;0;Container;
                ContainerType=FactBoxArea }

    { 1000000045;1;Part   ;
                SubPageView=SORTING(No.);
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page70709;
                PartType=Page }

    { 1000000043;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      CMGenMgt@1000000001 : Codeunit 70000;
      _enabled@1000000000 : Boolean INDATASET;
      CMContractMgmt@1000000002 : Codeunit 70021;

    BEGIN
    END.
  }
}

OBJECT Page 70025 CMMS Contract Card
{
  OBJECT-PROPERTIES
  {
    Date=15.05.18;
    Time=14:23:54;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Contract;
               DEA=Vertrag];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70050;
    PageType=Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Master Data,Extended,History;
                                DEA=Neu,Vorgang,Berichte,Masterdaten,Erweitert,Historie];
    OnOpenPage=BEGIN
                 _editable := CurrPage.EDITABLE;
               END;

    OnAfterGetRecord=BEGIN
                       _editable := CurrPage.EDITABLE;
                     END;

    ActionList=ACTIONS
    {
      { 1000000046;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000044;1 ;ActionGroup;
                      CaptionML=[ENU=Master Data;
                                 DEA=Masterdaten];
                      Image=<DataEntry> }
      { 1000000047;2 ;Action    ;
                      Name=Contract Entities;
                      CaptionML=ENU=Contract Entities;
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=Signature;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 CMContractMgmt.ShowRelatedContractEntites(Rec);
                               END;
                                }
      { 1000000048;1 ;ActionGroup;
                      Name=Extended;
                      CaptionML=[ENU=Extended;
                                 DEA=Erweitert] }
      { 1000000045;2 ;Action    ;
                      Name=To-dos;
                      CaptionML=[ENU=Recurring To-dos;
                                 DEA=Wiederkehrende Aufgaben];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Task;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CMContractMgmt.ShowRelatedToDos(Rec);
                               END;
                                }
      { 1000000049;2 ;Action    ;
                      Name=Activities;
                      CaptionML=[ENU=Activities;
                                 DEA=Aktivit„ten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=InteractionLog;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CMContractMgmt.ShowRelatedLogs(Rec);
                               END;
                                }
      { 1000000028;2 ;Action    ;
                      Name=Relations;
                      CaptionML=ENU=Relations;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ContactReference;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CMContractMgmt.ShowRelatedRelations(Rec);
                               END;
                                }
      { 1000000041;2 ;Action    ;
                      Name=ContractPackages;
                      CaptionML=ENU=Contract Packages;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ItemVariant;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 CMContractMgmt.ShowContractPackages(Rec);
                               END;
                                }
      { 1000000053;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000054;1 ;Action    ;
                      Name=New;
                      CaptionML=[ENU=New;
                                 DEA=Neu];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=New;
                      PromotedCategory=New;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                                 //CMAssetMgmt.CreateNewAssetProject(0); {0 = Asset}
                                 CMContractMgmt.NewContractUI();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[ENU=General;
                           DEA=Allgemein];
                GroupType=Group }

    { 1000000002;2;Field  ;
                SourceExpr="No.";
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               CMGenMgt.GetContractNo(Rec);
                             END;
                              }

    { 1000000003;2;Field  ;
                SourceExpr=Name }

    { 1000000005;2;Field  ;
                SourceExpr=Status }

    { 1000000007;2;Field  ;
                SourceExpr="Type of Service" }

    { 1000000008;2;Field  ;
                SourceExpr="Start Date";
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               CMContractMgmt.EditContractInvoicing(Rec);
                             END;
                              }

    { 1000000009;2;Field  ;
                SourceExpr="End Date";
                Editable=FALSE }

    { 1000000012;2;Field  ;
                SourceExpr="Invoicing Type";
                Editable=FALSE }

    { 1000000011;2;Field  ;
                SourceExpr="Invoicing Period";
                Editable=FALSE }

    { 1000000055;2;Field  ;
                SourceExpr="Contract Manager" }

    { 1000000010;1;Group  ;
                Name=Extended;
                CaptionML=[ENU=Extended;
                           DEA=Erweitert];
                GroupType=Group }

    { 1000000015;2;Field  ;
                SourceExpr="Accounting Entity" }

    { 1000000017;2;Field  ;
                SourceExpr="Responsible Sales User" }

    { 1000000020;2;Field  ;
                SourceExpr="Min. Reaction Time" }

    { 1000000021;2;Field  ;
                SourceExpr="Weekend Reaction" }

    { 1000000023;2;Field  ;
                SourceExpr="Reporting Interval" }

    { 1000000026;2;Field  ;
                SourceExpr="Penalty Payments" }

    { 1000000031;2;Field  ;
                SourceExpr="Currency Code" }

    { 1000000034;2;Field  ;
                SourceExpr="Payment Terms Code";
                Importance=Additional }

    { 1000000036;2;Field  ;
                SourceExpr="Cancellation External (Months)" }

    { 1000000037;2;Field  ;
                SourceExpr=Indexation }

    { 1000000004;2;Field  ;
                SourceExpr="Indexation Rate" }

    { 1000000038;2;Field  ;
                SourceExpr="Indexation Start Date" }

    { 1000000039;2;Field  ;
                SourceExpr="Indexation Cycle" }

    { 1000000016;2;Field  ;
                SourceExpr="Penalty Risk Class" }

    { 1000000029;2;Field  ;
                SourceExpr=Bonusagreement }

    { 1000000013;2;Field  ;
                SourceExpr="Energy Monitor Access" }

    { 1000000018;2;Field  ;
                SourceExpr="Extension Type" }

    { 1000000052;2;Field  ;
                SourceExpr="Extension Options";
                Editable=_editable;
                MultiLine=Yes }

    { 1000000050;2;Field  ;
                SourceExpr="Reaction Time Details";
                MultiLine=Yes }

    { 1000000043;2;Field  ;
                SourceExpr="Practical Customer Agreements";
                Editable=_editable;
                MultiLine=Yes }

    { 1000000057;1;Part   ;
                SubPageLink=Objecttype=CONST(Contract),
                            Key1=FIELD(No.);
                PagePartID=Page70060;
                PartType=Page }

    { 1000000006;0;Container;
                ContainerType=FactBoxArea }

    { 1000000056;1;Part   ;
                SubPageView=SORTING(No.);
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page70709;
                PartType=Page }

    { 1000000058;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      _EnergyMonitorAccounts@1000000011 : Text;
      CMGenMgt@1000000013 : Codeunit 70000;
      _editable@1000000014 : Boolean INDATASET;
      CMContractMgmt@1000000015 : Codeunit 70021;

    BEGIN
    END.
  }
}

OBJECT Page 70026 CMMS Main Asset Card
{
  OBJECT-PROPERTIES
  {
    Date=16.04.18;
    Time=15:34:02;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Asset;
               DEA=Anlage];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70020;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,No.)
                    WHERE(Objecttype=CONST(Asset));
    PageType=Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Master Data,Extended,History;
                                DEA=Neu,Vorgang,Berichte,Masterdaten,Erweitert,Historie];
    OnOpenPage=BEGIN
                 _showDetails := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       IF(Rec.Objecttype <> Rec.Objecttype::Asset) THEN
                         ERROR(Text001);

                       _editable := CurrPage.EDITABLE;
                       SetEditable();

                       CurrPage.CMContractInfobox.PAGE.SetAssetNo(Rec."No.");
                     END;

    ActionList=ACTIONS
    {
      { 1000000017;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000090;1 ;ActionGroup;
                      CaptionML=[ENU=Master Data;
                                 DEA=Masterdaten];
                      Image=<DataEntry> }
      { 1000000028;2 ;Action    ;
                      Name=Customers;
                      CaptionML=[ENU=Customers;
                                 DEA=Debitoren];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CoupledCustomer;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedCustomers(Rec);
                               END;
                                }
      { 1000000005;2 ;Action    ;
                      Name=Contracts;
                      CaptionML=[ENU=Contracts;
                                 DEA=Vertr„ge];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Signature;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedContracts(Rec);
                               END;
                                }
      { 1000000018;2 ;Action    ;
                      Name=SubAssets;
                      CaptionML=[ENU=Subassets;
                                 DEA=Unteranlagen];
                      Promoted=Yes;
                      Image=Components;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedSubAssets(Rec);
                               END;
                                }
      { 1000000019;2 ;Action    ;
                      Name=Projects;
                      CaptionML=[ENU=Projects;
                                 DEA=Projekte];
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=ServiceTasks;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedAssetsProjects(Rec);
                               END;
                                }
      { 1000000078;2 ;Action    ;
                      Name=UserRoles;
                      CaptionML=[ENU=User / Roles;
                                 DEA=Benutzer / Rollen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Users;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedUserroles(Rec);
                               END;
                                }
      { 1000000088;2 ;Action    ;
                      Name=Relations;
                      CaptionML=[ENU=Relations / Contacts;
                                 DEA=Relations / Kontakte];
                      Promoted=Yes;
                      PromotedIsBig=No;
                      Image=ContactReference;
                      PromotedCategory=Category4;
                      RunPageMode=View;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedRelations(Rec);
                               END;
                                }
      { 1000000033;2 ;Action    ;
                      Name=Dimensions;
                      CaptionML=[ENU=Dimensions;
                                 DEA=Dimensionen];
                      Image=Dimensions;
                      RunPageMode=View;
                      OnAction=VAR
                                 DimMgt@1000000000 : Codeunit 408;
                               BEGIN
                                 CurrPage.UPDATE(TRUE);
                                 Rec."Dimension Set ID" := DimMgt.EditDimensionSet(Rec."Dimension Set ID", '');
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1000000075;1 ;ActionGroup;
                      Name=Extended;
                      CaptionML=[ENU=Extended;
                                 DEA=Erweitert] }
      { 1000000074;2 ;ActionGroup;
                      Name=Map;
                      CaptionML=[ENU=Map;
                                 DEA=Karte];
                      Image=Map }
      { 1000000070;3 ;Action    ;
                      Name=Show Map (Coordinates);
                      CaptionML=[ENU=Show Map (Coordinates);
                                 DEA=Zeige Karte (Koordinaten)];
                      Image=Map;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowMapByCoordinates(Rec);
                               END;
                                }
      { 1000000071;3 ;Action    ;
                      Name=Show Map (Address);
                      CaptionML=[ENU=Show Map (Address);
                                 DEA=Zeige Karte (Adresse)];
                      Image=Map;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowMapByAddress(Rec);
                               END;
                                }
      { 1000000082;2 ;Action    ;
                      Name=To-dos;
                      CaptionML=[ENU=Recurring To-dos;
                                 DEA=Wiederkehrende Aufgaben];
                      Enabled=IGEdit;
                      Image=Task;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedToDos(Rec);
                               END;
                                }
      { 1000000089;1 ;ActionGroup;
                      CaptionML=[ENU=History;
                                 DEA=Historie];
                      Image=History }
      { 1000000039;2 ;Action    ;
                      Name=Status Change;
                      CaptionML=[ENU=Status Change;
                                 DEA=Status„nderungen];
                      Promoted=Yes;
                      Image=Status;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,1);
                               END;
                                }
      { 1000000037;2 ;Action    ;
                      Name=Read Activities;
                      CaptionML=[ENU=Read Activities;
                                 DEA=Leseaktivit„ten];
                      Image=ViewDetails;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,2);
                               END;
                                }
      { 1000000036;2 ;Action    ;
                      Name=Activities (Internal);
                      CaptionML=[ENU=Activities (Internal);
                                 DEA=Aktivit„ten (Intern)];
                      Promoted=Yes;
                      Image=InteractionLog;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,3);
                               END;
                                }
      { 1000000035;2 ;Action    ;
                      Name=Activities (External);
                      CaptionML=[ENU=Activities (External);
                                 DEA=Aktivit„ten (Extern)];
                      Promoted=Yes;
                      Image=InteractionLog;
                      PromotedCategory=Category6;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,4);
                               END;
                                }
      { 1000000022;2 ;Action    ;
                      Name=Activities;
                      CaptionML=[ENU=Activities;
                                 DEA=Aktivit„ten];
                      Image=InteractionLog;
                      OnAction=BEGIN
                                 CMAssetMgt.ShowRelatedLogs(Rec,0);
                               END;
                                }
      { 1000000031;2 ;Action    ;
                      Name=WOs;
                      CaptionML=[ENU=Workorders;
                                 DEA=Arbeitsauftr„ge];
                      Image=ViewServiceOrder;
                      OnAction=VAR
                                 CMMSWOMgmt@1000000000 : Codeunit 70030;
                               BEGIN
                                 CMMSWOMgmt.ShowWorkorders("No.",'','','','0|1|2|3','','');
                               END;
                                }
      { 1000000030;2 ;Action    ;
                      Name=FinishedWOs;
                      CaptionML=[ENU=Finished Workorders;
                                 DEA=Beendete Arbeitsauftr„ge];
                      Image=PostedServiceOrder;
                      OnAction=VAR
                                 CMMSWOMgmt@1000000000 : Codeunit 70030;
                               BEGIN
                                 CMMSWOMgmt.ShowWorkorders("No.",'','','','4|5','','');
                               END;
                                }
      { 1000000024;0 ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 1000000025;1 ;Action    ;
                      Name=NewWorkorder;
                      CaptionML=[ENU=New Workorder;
                                 DEA=Neuer Arbeitsauftrag];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedServiceOrder;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CMWoMgt.NewWorkorderToObjectUI(Rec, FALSE);
                               END;
                                }
      { 1000000026;1 ;Action    ;
                      Name=NewRequest;
                      CaptionML=[ENU=New Request;
                                 DEA=Neue Anfrage];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedReturnReceipt;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CMTaskMgt.NewRequestFromAssetProject(Rec);
                               END;
                                }
      { 1000000038;1 ;Action    ;
                      Name=ChangeStatus;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Change &Status;
                                 DEA=S&tatus „ndern];
                      Promoted=Yes;
                      Enabled=IGEdit;
                      PromotedIsBig=Yes;
                      Image=ChangeStatus;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CMMSAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                                 CurrPage.UPDATE;
                                 CMMSAssetMgmt.ChangeStatus(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[ENU=General;
                           DEA=Allgemein];
                Editable=IGEdit;
                GroupType=Group }

    { 1000000002;2;Field  ;
                SourceExpr="No.";
                Enabled=FALSE }

    { 1000000003;2;Field  ;
                SourceExpr=Name }

    { 1000000006;2;Field  ;
                SourceExpr="Name 2";
                Importance=Additional }

    { 1000000034;2;Field  ;
                SourceExpr=Portfolio }

    { 1000000014;2;Field  ;
                SourceExpr="Operational Status";
                Editable=FALSE }

    { 1000000040;2;Field  ;
                SourceExpr="Inactive at Date" }

    { 1000000080;2;Field  ;
                SourceExpr="Responsibility Center" }

    { 1000000007;2;Field  ;
                Name=<Address_>;
                SourceExpr=Address;
                Importance=Additional;
                OnAssistEdit=BEGIN
                               CMAssetMgt.ShowMapByAddress(Rec);
                             END;
                              }

    { 1000000027;2;Field  ;
                SourceExpr="Extended Address";
                Importance=Additional }

    { 1000000009;2;Field  ;
                SourceExpr=City;
                Importance=Additional }

    { 1000000010;2;Field  ;
                SourceExpr="Post Code";
                Importance=Additional }

    { 1000000011;2;Field  ;
                SourceExpr="Country Code";
                Importance=Additional }

    { 1000000023;2;Field  ;
                SourceExpr="Coordinates Latitude";
                Importance=Additional;
                OnAssistEdit=BEGIN
                               CMAssetMgt.ShowMapByCoordinates(Rec);
                             END;
                              }

    { 1000000008;2;Field  ;
                SourceExpr="Coordinates Longitude";
                Importance=Additional;
                OnAssistEdit=BEGIN
                               CMAssetMgt.ShowMapByCoordinates(Rec);
                             END;
                              }

    { 1000000029;2;Field  ;
                SourceExpr="Company Name" }

    { 1000000012;0;Container;
                ContainerType=FactBoxArea }

    { 1000000042;1;Part   ;
                Name=CMContractInfobox;
                SubPageView=SORTING(No.);
                PagePartID=Page70704;
                PartType=Page }

    { 1000000041;1;Part   ;
                SubPageView=SORTING(Objecttype,No.);
                SubPageLink=Objecttype=CONST(Asset),
                            No.=FIELD(No.);
                PagePartID=Page70700;
                PartType=Page }

    { 1000000016;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

    { 1000000013;1;Part   ;
                SubPageView=SORTING(Objecttype,No.);
                SubPageLink=No.=FIELD(No.),
                            Objecttype=CONST(Asset);
                PagePartID=Page70701;
                PartType=Page }

  }
  CODE
  {
    VAR
      CMGenMgt@1000000000 : Codeunit 70000;
      CMWoMgt@1000000001 : Codeunit 70030;
      CMAssetMgt@1000000002 : Codeunit 70020;
      CMTaskMgt@1000000038 : Codeunit 70031;
      IGEdit@1000000003 : Boolean INDATASET;
      _editable@1000000015 : Boolean INDATASET;
      _showDetails@1000000016 : Boolean INDATASET;
      Text001@1000000037 : TextConst 'ENU=Invalid call. Recorad is a Project!;DEA=Ungltiger Aufruf. Datensatz ist ein Projekt!';
      LogEntry@1000000039 : Record 5065;

    LOCAL PROCEDURE SetBlob@1000000003();
    BEGIN
    END;

    LOCAL PROCEDURE SetEditable@1000000000();
    BEGIN
      IGEdit := FALSE;

      IF (Rec."Operational Status" IN [Rec."Operational Status"::New, Rec."Operational Status"::Released]) AND (CurrPage.EDITABLE) THEN
        IGEdit := TRUE;

      CurrPage.EDITABLE := IGEdit;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70030 CMMS Department List
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=11:31:30;
    Modified=Yes;
    Version List=CMMS,DPT;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Departments;
               DEA=Abteilungen];
    SourceTable=Table70009;
    PageType=List;
    CardPageID=CMMS Department Card;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr=Code }

    { 1000000003;2;Field  ;
                SourceExpr=Name }

    { 1000000004;2;Field  ;
                SourceExpr=Company }

    { 1000000007;2;Field  ;
                SourceExpr="In Scheduling Tool" }

    { 1000000006;0;Container;
                ContainerType=FactBoxArea }

    { 1000000005;1;Part   ;
                PagePartID=Page70034;
                PartType=Page }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70031 CMMS Department Card
{
  OBJECT-PROPERTIES
  {
    Date=09.05.18;
    Time=11:07:46;
    Modified=Yes;
    Version List=CMMS,DPT;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Department;
               DEA=Abteilung];
    SourceTable=Table70009;
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[ENU=General;
                           DEA=Allgemein];
                GroupType=Group }

    { 1000000002;2;Field  ;
                SourceExpr=Code }

    { 1000000003;2;Field  ;
                SourceExpr=Name }

    { 1000000004;2;Field  ;
                SourceExpr=Company }

    { 1000000007;2;Field  ;
                SourceExpr="In Scheduling Tool" }

    { 1000000005;1;Part   ;
                SubPageView=SORTING(Type,Code);
                SubPageLink=Belongs To Department Code=FIELD(Code);
                PagePartID=Page70032;
                PartType=Page }

    { 1000000006;1;Part   ;
                SubPageView=SORTING(Type,Code);
                SubPageLink=Belongs To Department Code=FIELD(Code);
                PagePartID=Page70033;
                PartType=Page }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70032 CMMS Dept. Team Subpage
{
  OBJECT-PROPERTIES
  {
    Date=22.08.17;
    Time=12:55:03;
    Modified=Yes;
    Version List=CMMS,DPT;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Team;
               DEA=Team];
    SourceTable=Table70010;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Type,Code)
                    WHERE(Type=CONST(User));
    PageType=ListPart;
    ActionList=ACTIONS
    {
      { 1000000005;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000007;1 ;Action    ;
                      Name=UserCard;
                      CaptionML=[ENU=User;
                                 DEA=Benutzer];
                      RunObject=Page 9807;
                      RunPageLink=User Name=FIELD(Code);
                      Image=View }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr=Type;
                Visible=FALSE;
                Editable=FALSE }

    { 1000000003;2;Field  ;
                SourceExpr=Code;
                OnValidate=BEGIN
                             Rec.ValidateUserID();
                           END;

                OnLookup=BEGIN
                           Rec.LookupUserID();
                         END;
                          }

    { 1000000004;2;Field  ;
                SourceExpr="User Name" }

    { 1000000008;2;Field  ;
                SourceExpr="User Role" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70033 CMMS Dept. Dept. Subpage
{
  OBJECT-PROPERTIES
  {
    Date=22.08.17;
    Time=11:32:52;
    Modified=Yes;
    Version List=CMMS,DPT;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Sub Departments;
               DEA=Unterabteilungen];
    SourceTable=Table70010;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Type,Code)
                    WHERE(Type=CONST(Department));
    PageType=ListPart;
    ActionList=ACTIONS
    {
      { 1000000005;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000006;1 ;Action    ;
                      Name=DepartmentCard;
                      CaptionML=[ENU=Department;
                                 DEA=Abteilung];
                      RunObject=Page 70031;
                      RunPageLink=Code=FIELD(Code);
                      Image=View }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr=Type;
                Visible=FALSE;
                Editable=FALSE }

    { 1000000003;2;Field  ;
                SourceExpr=Code }

    { 1000000008;2;Field  ;
                SourceExpr="Department Name" }

    { 1000000004;2;Field  ;
                SourceExpr="Department Comany" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70034 CMMS Dept. Hierarchy View
{
  OBJECT-PROPERTIES
  {
    Date=16.02.18;
    Time=14:06:49;
    Modified=Yes;
    Version List=CMMS,DPT;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Department Hierarchy;
               DEA=Abteilungen Hierarchie];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table50002;
    SourceTableView=SORTING(SourceNo1,TypeText1,ProductNo1);
    PageType=ListPart;
    SourceTableTemporary=Yes;
    OnOpenPage=VAR
                 CMDepartment@1000000000 : Record 70009;
                 CMDepartmentTeam@1000000001 : Record 70010;
                 Level@1000000002 : Integer;
                 ok@1000000003 : Boolean;
               BEGIN
                 EntryNo := 1;
                 Level := 1;
                 IF CMDepartment.FIND('-') THEN BEGIN
                   REPEAT

                     Rec.INIT;
                     Rec."Entry No." := EntryNo;
                     Rec.SourceNo1 := FORMAT(EntryNo);
                     Rec.SourceNo2 := CMDepartment.Code;
                     Rec.Int1 := Level;
                     Rec.Text1 := CMDepartment.Name;

                     CMDepartmentTeam.SETRANGE(Type, CMDepartmentTeam.Type::Department);
                     CMDepartmentTeam.SETFILTER(Code, CMDepartment.Code);
                     CMDepartmentTeam.SETFILTER("Belongs To Department Code", '<>%1', '');
                     IF NOT CMDepartmentTeam.FINDFIRST() THEN BEGIN
                       Rec.INSERT;
                       EntryNo += 1;

                       Loop(CMDepartment.Code, Level, Rec.SourceNo1);
                     END;
                   UNTIL CMDepartment.NEXT = 0;
                 END;
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                IndentationColumnName=Int1;
                IndentationControls=DepartmentCode;
                ShowAsTree=Yes;
                GroupType=Repeater }

    { 1000000003;2;Field  ;
                Name=DepartmentCode;
                SourceExpr=SourceNo2;
                StyleExpr=Style }

    { 1000000004;2;Field  ;
                Name=DepartmentName;
                SourceExpr=Text1;
                StyleExpr=Style }

    { 1000000002;2;Field  ;
                SourceExpr=OK1 }

    { 1000000005;2;Field  ;
                SourceExpr=Int1 }

  }
  CODE
  {
    VAR
      EntryNo@1000000000 : Integer;
      Style@1000000001 : Text INDATASET;

    LOCAL PROCEDURE Loop@1000000000(PartentDepartmentCode@1000000000 : Code[20];Level@1000000001 : Integer;Src1@1000000004 : Code[20]) : Boolean;
    VAR
      CMDepartmentTeam@1000000002 : Record 70010;
      SubEntryNo@1000000003 : Integer;
    BEGIN
      Level += 1;
      SubEntryNo := 1;

      CMDepartmentTeam.SETRANGE(Type, CMDepartmentTeam.Type::Department);
      CMDepartmentTeam.SETFILTER(Code, '<>%1', '');
      CMDepartmentTeam.SETRANGE("Belongs To Department Code", PartentDepartmentCode);
      IF CMDepartmentTeam.FIND('-') THEN BEGIN
        REPEAT
          CMDepartmentTeam.CALCFIELDS("Department Name");

          Rec.INIT;
          Rec."Entry No." := EntryNo;
          Rec.SourceNo1 := Src1 + FORMAT(SubEntryNo);
          Rec.SourceNo2 := CMDepartmentTeam.Code;
          Rec.Int1 := Level;
          Rec.Text1 := CMDepartmentTeam."Department Name";
          Rec.INSERT;

          SubEntryNo += 1;
          EntryNo += 1;

          Loop(CMDepartmentTeam.Code, Level, Rec.SourceNo1);

        UNTIL CMDepartmentTeam.NEXT = 0;
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70050 CMMS Subassets
{
  OBJECT-PROPERTIES
  {
    Date=22.03.17;
    Time=13:41:08;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Subassets;
               DEA=Subanlagen];
    LinksAllowed=No;
    SourceTable=Table70021;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.);
    PageType=List;
    ShowFilter=No;
    OnAfterGetRecord=BEGIN
                       Rec.CALCFIELDS("Asset Name");
                     END;

    OnAfterGetCurrRecord=BEGIN
                           Rec.CALCFIELDS("Asset Name");
                         END;

    ActionList=ACTIONS
    {
      { 1000000006;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000005;1 ;Action    ;
                      Name=CMCard;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Subasset Card;
                                 DEA=Subasset Karte];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                                 SubAsset@1000000001 : Record 70020;
                               BEGIN
                                 IF SubAsset.GET(SubAsset.Objecttype::Asset, Rec.Key2) THEN;
                                   CMAssetMgmt.ShowAssetCard(SubAsset);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                CaptionML=[ENU=Main Asset No.;
                           DEA=Hauptanlagennr.];
                SourceExpr=Key1;
                Visible=FALSE }

    { 1000000003;2;Field  ;
                CaptionML=[ENU=Asset No.;
                           DEA=Anlagennr.];
                SourceExpr=Key2 }

    { 1000000004;2;Field  ;
                SourceExpr="Asset Name" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70051 CMMS Related Customers
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=15:28:52;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Customers;
               DEA=Kunden];
    SourceTable=Table70021;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Type=CONST(Customer));
    PageType=List;
    ShowFilter=No;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000006;2;Field  ;
                CaptionML=[ENU=Company;
                           DEA=Mandant];
                SourceExpr=Rec.GetObjectCompanyName();
                Visible=FALSE }

    { 1000000003;2;Field  ;
                CaptionML=[ENU=Customer No.;
                           DEA=Debitornr.];
                SourceExpr=Key3 }

    { 1000000004;2;Field  ;
                SourceExpr="Customer Name" }

    { 1000000002;2;Field  ;
                SourceExpr="Customer Company Chain" }

    { 1000000005;2;Field  ;
                SourceExpr=Share }

    { 1000000008;2;Field  ;
                SourceExpr="Customer No. Invalid";
                Editable=FALSE }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70052 CMMS Asset Contracts
{
  OBJECT-PROPERTIES
  {
    Date=07.03.18;
    Time=09:18:24;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Asset Contracts;
               DEA=Anlagenvertr„ge];
    SourceTable=Table70021;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Type=CONST(Contract),
                          Objecttype=CONST(Asset));
    PageType=List;
    CardPageID=CMMS Asset Contract Card;
    OnAfterGetRecord=BEGIN
                       CALCFIELDS("Contract Name", "Asset NameX");
                     END;

    ActionList=ACTIONS
    {
      { 1000000007;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000006;1 ;Action    ;
                      Name=Asset Card;
                      CaptionML=[ENU=Asset Card;
                                 DEA=Anlagenkarte];
                      RunObject=Page 70020;
                      RunPageLink=No.=FIELD(Key1),
                                  Objecttype=CONST(Asset);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                               END;
                                }
      { 1000000008;1 ;Action    ;
                      Name=Contract Card;
                      CaptionML=[ENU=Contract Card;
                                 DEA=Vertragskarte];
                      RunObject=Page 70025;
                      RunPageLink=No.=FIELD(Key2);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ContactReference;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000005;2;Field  ;
                SourceExpr="Main Contract" }

    { 1000000002;2;Field  ;
                CaptionML=[ENU=Asset No.;
                           DEA=Anlagennr.];
                SourceExpr=Key1 }

    { 1000000009;2;Field  ;
                SourceExpr="Asset NameX" }

    { 1000000003;2;Field  ;
                CaptionML=[ENU=Contract No.;
                           DEA=Vertragsnr.];
                SourceExpr=Key2 }

    { 1000000004;2;Field  ;
                SourceExpr="Contract Name" }

    { 1000000010;2;Field  ;
                SourceExpr="Contract Start Date" }

    { 1000000015;2;Field  ;
                SourceExpr="Contract End Date" }

    { 1000000013;2;Field  ;
                SourceExpr="Invoicing Type" }

    { 1000000012;2;Field  ;
                SourceExpr="Invoicing Period" }

    { 1000000014;2;Field  ;
                SourceExpr="Monthly Amount" }

    { 1000000011;2;Field  ;
                SourceExpr="Contract Type" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70053 CMMS Asset Userrole
{
  OBJECT-PROPERTIES
  {
    Date=16.08.17;
    Time=14:21:28;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=User / Roles;
               DEA=Benutzer / Rollen];
    SourceTable=Table70021;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Type=CONST(User));
    PageType=List;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000003;2;Field  ;
                CaptionML=[ENU=Asset No.;
                           DEA=Anlagennr.];
                SourceExpr=Key1;
                Visible=FALSE;
                Editable=FALSE }

    { 1000000004;2;Field  ;
                Lookup=Yes;
                CaptionML=[ENU=User ID;
                           DEA=Benutzer ID];
                SourceExpr=Key2;
                LookupPageID=User Setup }

    { 1000000007;2;Field  ;
                SourceExpr="Plant Manager" }

    { 1000000012;2;Field  ;
                SourceExpr="Project Manager" }

    { 1000000008;2;Field  ;
                SourceExpr="Field Service" }

    { 1000000002;2;Field  ;
                SourceExpr="Reporting Responsible" }

    { 1000000005;2;Field  ;
                SourceExpr="Invoice Responsible" }

    { 1000000006;2;Field  ;
                SourceExpr="Accounting Responsible" }

    { 1000000010;2;Field  ;
                SourceExpr="Remote Monitoring Responsible" }

    { 1000000011;2;Field  ;
                SourceExpr="Responsible OM supervisor" }

    { 1000000009;2;Field  ;
                SourceExpr=Customer }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70054 CMMS Asset Projects
{
  OBJECT-PROPERTIES
  {
    Date=04.01.18;
    Time=15:05:29;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Projects;
               DEA=Projekte];
    LinksAllowed=No;
    SourceTable=Table70021;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Type=CONST(Project));
    PageType=List;
    ShowFilter=No;
    OnInit=BEGIN
             _editAssetNo := TRUE;
             _editProjectNo := FALSE;
           END;

    OnAfterGetRecord=BEGIN
                       CALCFIELDS("Asset NameXX", "Project NameXX");
                     END;

    ActionList=ACTIONS
    {
      { 1000000005;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000006;1 ;Action    ;
                      Name=CMProjectCard;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Project Card;
                                 DEA=Projekt Karte];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                                 Project@1000000001 : Record 70020;
                               BEGIN
                                 IF Project.GET(Project.Objecttype::Project, Rec.Key2) THEN;
                                   CMAssetMgmt.ShowProjectCard(Project);
                               END;
                                }
      { 1000000008;1 ;Action    ;
                      Name=CMAssetCard;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Asset Card;
                                 DEA=Anlage Karte];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                                 Asset@1000000001 : Record 70020;
                               BEGIN
                                 IF Asset.GET(Asset.Objecttype::Asset, Rec.Key1) THEN;
                                   CMAssetMgmt.ShowAssetCard(Asset);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                CaptionML=[ENU=Asset No.;
                           DEA=Anlagennr.];
                SourceExpr=Key1;
                Enabled=_editAssetNo;
                OnLookup=BEGIN
                           VALIDATE(Key1, CMGenMgmt.DoUniversalLookup(0,'','','',''));
                         END;
                          }

    { 1000000003;2;Field  ;
                CaptionML=[ENU=Project No.;
                           DEA=Projektnr.];
                SourceExpr=Key2;
                Enabled=_editProjectNo;
                OnLookup=BEGIN
                           VALIDATE(Key2, CMGenMgmt.DoUniversalLookup(1,'','','',''));
                         END;
                          }

    { 1000000004;2;Field  ;
                SourceExpr="Asset NameXX" }

    { 1000000007;2;Field  ;
                SourceExpr="Project NameXX" }

  }
  CODE
  {
    VAR
      CMGenMgmt@1000000000 : Codeunit 70000;
      _editAssetNo@1000000004 : Boolean INDATASET;
      _editProjectNo@1000000005 : Boolean INDATASET;

    PROCEDURE Set@1000000001(Mode@1000000000 : 'FromAsset,FromProject');
    BEGIN
      IF Mode = Mode::FromAsset THEN BEGIN
        _editAssetNo := TRUE;
        _editProjectNo := FALSE;
      END;

      IF Mode = Mode::FromAsset THEN BEGIN
        _editAssetNo := FALSE;
        _editProjectNo := TRUE;
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70055 CMMS Object Relations
{
  OBJECT-PROPERTIES
  {
    Date=28.08.17;
    Time=13:55:13;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Relations / Contacts;
               DEA=Relations / Kontakte];
    SourceTable=Table70021;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Type=CONST(Relation));
    PageType=List;
    OnAfterGetRecord=BEGIN
                       IF NOT Contact.GET(Key2) THEN Contact.INIT;
                     END;

    OnAfterGetCurrRecord=BEGIN
                           IF NOT Contact.GET(Key2) THEN Contact.INIT;
                         END;

    ActionList=ACTIONS
    {
      { 1000000007;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000008;1 ;Action    ;
                      Name=Contact Card;
                      CaptionML=[ENU=Contact Card;
                                 DEA=Kontact Card];
                      RunObject=Page 5050;
                      RunPageLink=No.=FIELD(Key2);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ContactReference;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                               BEGIN
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                CaptionML=ENU=Source No.;
                SourceExpr=Key1;
                Visible=FALSE;
                Editable=FALSE }

    { 1000000003;2;Field  ;
                CaptionML=[ENU=Contact No..;
                           DEA=Kontaktnr.];
                SourceExpr=Key2 }

    { 1000000009;2;Field  ;
                SourceExpr="Business Relation Code" }

    { 1000000010;2;Field  ;
                SourceExpr="Business Relation Description" }

    { 1000000004;2;Field  ;
                SourceExpr="Relation Group Code" }

    { 1000000005;2;Field  ;
                SourceExpr="Relation Group Description" }

    { 1000000006;2;Field  ;
                SourceExpr="Contact Name";
                OnDrillDown=BEGIN
                              ;
                            END;
                             }

    { 1000000011;2;Field  ;
                ExtendedDatatype=Phone No.;
                SourceExpr="Contact Phone No.";
                OnDrillDown=BEGIN
                              ;
                            END;
                             }

    { 1000000012;2;Field  ;
                ExtendedDatatype=E-Mail;
                SourceExpr="Contact E-Mail";
                OnDrillDown=BEGIN
                              ;
                            END;
                             }

  }
  CODE
  {
    VAR
      Contact@1000000000 : Record 5050;

    BEGIN
    END.
  }
}

OBJECT Page 70056 CMMS Asset Yield Study
{
  OBJECT-PROPERTIES
  {
    Date=23.03.18;
    Time=13:21:36;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=ENU=Yield Study;
    SourceTable=Table70021;
    SourceTableView=SORTING(Type,Key1,Key2,Key3)
                    WHERE(Type=CONST(YieldStudy));
    PageType=List;
    OnOpenPage=BEGIN
                 CMGenSetup.GET();
                 CMGenSetup.TESTFIELD("Degradation Allow. (Starts w.)");
               END;

    OnAfterGetRecord=BEGIN
                       SetDegradationEditable();
                     END;

    OnAfterGetCurrRecord=BEGIN
                           SetDegradationEditable();
                         END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000004;2;Field  ;
                CaptionML=ENU=Type;
                SourceExpr=Key3;
                OnValidate=BEGIN
                             SetDegradationEditable();
                           END;
                            }

    { 1000000020;2;Field  ;
                SourceExpr="Unit of Measure" }

    { 1000000003;2;Field  ;
                Lookup=No;
                DrillDown=No;
                AssistEdit=No;
                CaptionML=ENU=Source;
                SourceExpr=Key2 }

    { 1000000002;2;Field  ;
                SourceExpr=Degradation;
                Editable=_enableDegradation }

    { 1000000021;2;Field  ;
                SourceExpr="Degradation Start Date";
                Editable=_enableDegradation }

    { 1000000005;2;Field  ;
                SourceExpr="Yield Source Description" }

    { 1000000006;2;Field  ;
                SourceExpr="Valid Source" }

    { 1000000007;2;Field  ;
                SourceExpr=January }

    { 1000000008;2;Field  ;
                SourceExpr=February }

    { 1000000009;2;Field  ;
                SourceExpr=March }

    { 1000000010;2;Field  ;
                SourceExpr=April }

    { 1000000011;2;Field  ;
                SourceExpr=May }

    { 1000000012;2;Field  ;
                SourceExpr=June }

    { 1000000013;2;Field  ;
                SourceExpr=July }

    { 1000000014;2;Field  ;
                SourceExpr=August }

    { 1000000015;2;Field  ;
                SourceExpr=September }

    { 1000000016;2;Field  ;
                SourceExpr=October }

    { 1000000017;2;Field  ;
                SourceExpr=November }

    { 1000000018;2;Field  ;
                SourceExpr=December }

    { 1000000019;2;Field  ;
                CaptionML=ENU=Yield Study;
                SourceExpr="Yield Total";
                Style=Strong;
                StyleExpr=TRUE }

  }
  CODE
  {
    VAR
      _enableDegradation@1000000000 : Boolean INDATASET;
      CMGenSetup@1000000001 : Record 70000;
      ENCGenMgt@1000000002 : Codeunit 50003;

    LOCAL PROCEDURE SetDegradationEditable@1000000000();
    BEGIN
      _enableDegradation := ENCGenMgt.TextStartsWith(Rec.Key3, CMGenSetup."Degradation Allow. (Starts w.)");
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70057 CMMS Asset Address
{
  OBJECT-PROPERTIES
  {
    Date=11.11.16;
    Time=11:35:52;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Address;
               DEA=Adresse];
    MultipleNewLines=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70020;
    DelayedInsert=No;
    PageType=StandardDialog;
    ShowFilter=No;
    OnAfterGetRecord=BEGIN
                       SETRECFILTER();
                       CALCFIELDS("Country/Region Name");
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                SourceExpr="No." }

    { 1000000002;1;Field  ;
                SourceExpr=Name }

    { 1000000003;1;Field  ;
                SourceExpr="Name 2" }

    { 1000000004;1;Field  ;
                SourceExpr=Address;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowMapByAddress(Rec);
                            END;
                             }

    { 1000000005;1;Field  ;
                SourceExpr=City }

    { 1000000006;1;Field  ;
                SourceExpr="Post Code" }

    { 1000000007;1;Field  ;
                SourceExpr="Country Code" }

    { 1000000008;1;Field  ;
                SourceExpr="Coordinates Latitude";
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowMapByCoordinates(Rec);
                            END;
                             }

    { 1000000009;1;Field  ;
                SourceExpr="Coordinates Longitude";
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowMapByCoordinates(Rec);
                            END;
                             }

    { 1000000010;1;Field  ;
                SourceExpr="Country/Region Name";
                OnDrillDown=BEGIN
                              ;
                            END;
                             }

  }
  CODE
  {
    VAR
      CMAssetMgt@1000000000 : Codeunit 70020;

    BEGIN
    END.
  }
}

OBJECT Page 70058 CMMS Contract Packages
{
  OBJECT-PROPERTIES
  {
    Date=06.03.17;
    Time=12:43:49;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=ENU=Contract Packages;
    SourceTable=Table70021;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Objecttype=CONST(Contract),
                          Type=CONST(ContractPackage));
    PageType=List;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                CaptionML=ENU=Contract No.;
                SourceExpr=Key1;
                Visible=FALSE;
                Editable=FALSE }

    { 1000000003;2;Field  ;
                CaptionML=ENU=Package Code;
                SourceExpr=Key2 }

    { 1000000004;2;Field  ;
                SourceExpr="Package Description" }

    { 1000000005;2;Field  ;
                SourceExpr="Additional Package Info" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70059 CMMS Substitution / Not. Copy
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=12:29:05;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    SourceTable=Table70021;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Objecttype=CONST(User));
    PageType=List;
    OnInit=BEGIN
             IF NOT UserSetup.GET(USERID) THEN
               UserSetup.INIT;

             _isSubstitutionAdmin := UserSetup."CM Substitution Admin";
           END;

    OnOpenPage=BEGIN
                 FILTERGROUP(3);
                 _isSubstitution := Rec.GETFILTER(Type) = FORMAT(Rec.Type::Substitue);
                 FILTERGROUP(0);

                 IF (NOT _isSubstitutionAdmin) THEN BEGIN
                   Rec.FILTERGROUP(2);
                   Rec.SETRANGE(Key1, USERID);
                   Rec.FILTERGROUP(0);
                 END;
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                CaptionML=[ENU=User ID;
                           DEA=Benutzer ID];
                SourceExpr=Key1;
                Enabled=_isSubstitutionAdmin }

    { 1000000003;2;Field  ;
                CaptionML=[ENU=Substitution;
                           DEA=Vertreter];
                SourceExpr=Key2;
                Visible=_isSubstitution }

    { 1000000006;2;Field  ;
                Name=Key2_;
                CaptionML=[ENU=Send copy to;
                           DEA=Sende Kopie an];
                SourceExpr=Key2;
                Visible=NOT _isSubstitution }

    { 1000000004;2;Field  ;
                SourceExpr="From Date" }

    { 1000000005;2;Field  ;
                SourceExpr="To Date" }

  }
  CODE
  {
    VAR
      UserSetup@1000000001 : Record 91;
      _isSubstitutionAdmin@1000000000 : Boolean INDATASET;
      _isSubstitution@1000000002 : Boolean INDATASET;

    BEGIN
    END.
  }
}

OBJECT Page 70060 CMMS Contract Pack. Lines
{
  OBJECT-PROPERTIES
  {
    Date=28.08.17;
    Time=14:07:59;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Contract Packages;
               DEA=Vertragspakete];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70021;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Type=CONST(ContractPackage),
                          Objecttype=CONST(Contract));
    PageType=ListPart;
    ShowFilter=No;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000003;2;Field  ;
                CaptionML=[ENU=Package Code;
                           DEA=Paketcode];
                SourceExpr=Key2 }

    { 1000000005;2;Field  ;
                SourceExpr="Package Description" }

    { 1000000006;2;Field  ;
                SourceExpr="Additional Package Info" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70061 CMMS Recurring To-dos
{
  OBJECT-PROPERTIES
  {
    Date=17.11.16;
    Time=13:23:29;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Recurring To-dos;
               DEA=Wiederkehrende Aufgaben];
    SourceTable=Table70021;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Type=CONST(RecurringToDo));
    PageType=List;
    AutoSplitKey=Yes;
    OnOpenPage=BEGIN
                 Rec.FILTERGROUP(2);
                 Rec.SETRANGE("Maintask Step No.",0);
                 //Rec.SETRANGE(Subtype,rec.subtype::);
                 Rec.FILTERGROUP(0);
               END;

    ActionList=ACTIONS
    {
      { 1000000017;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000019;1 ;Action    ;
                      Name=Checklist;
                      CaptionML=[ENU=Checklist;
                                 DEA=Checkliste];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CheckList;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CMTaskMgt@1000000000 : Codeunit 70031;
                               BEGIN
                                 CurrPage.UPDATE(TRUE);
                                 CMTaskMgt.ShowSubToRecurTask(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000012;2;Field  ;
                SourceExpr="Interaction Template Code" }

    { 1000000014;2;Field  ;
                SourceExpr=Description }

    { 1000000011;2;Field  ;
                SourceExpr="Interaction Group Code" }

    { 1000000013;2;Field  ;
                SourceExpr="Activity Code";
                OnValidate=BEGIN
                             CurrPage.UPDATE(FALSE);
                           END;
                            }

    { 1000000015;2;Field  ;
                SourceExpr=Priority }

    { 1000000005;2;Field  ;
                SourceExpr="Start Date" }

    { 1000000006;2;Field  ;
                SourceExpr="Start Time" }

    { 1000000007;2;Field  ;
                SourceExpr="Due Date" }

    { 1000000008;2;Field  ;
                SourceExpr="Expiration Date" }

    { 1000000009;2;Field  ;
                SourceExpr="Recurring Date Interval" }

    { 1000000010;2;Field  ;
                SourceExpr="All Day Event" }

    { 1000000016;2;Field  ;
                SourceExpr=Duration }

    { 1000000018;2;Field  ;
                SourceExpr="Automated Posting" }

    { 1000000002;2;Field  ;
                SourceExpr=Clearable }

    { 1000000003;2;Field  ;
                SourceExpr="Source Type";
                Editable=false }

    { 1000000004;2;Field  ;
                SourceExpr="Source No.";
                Editable=false }

    { 1000000020;2;Field  ;
                SourceExpr=Inactive }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70062 CMMS Recur. To-dos Checklist
{
  OBJECT-PROPERTIES
  {
    Date=17.11.16;
    Time=12:08:46;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=Yes;
    CaptionML=[ENU=Checklist;
               DEA=Checkliste];
    MultipleNewLines=Yes;
    InsertAllowed=Yes;
    DeleteAllowed=Yes;
    ModifyAllowed=Yes;
    LinksAllowed=No;
    SourceTable=Table70021;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    PageType=List;
    OnNewRecord=VAR
                  ActivityStep@1000000000 : Record 5082;
                BEGIN
                  ActivityStep.RESET;
                  ActivityStep.SETRANGE("Activity Code", Rec."Activity Code");
                  IF ActivityStep.FINDLAST() THEN
                    Rec."Step No." := ActivityStep."Step No." + 10000
                  ELSE
                    Rec."Step No." := 10000;
                END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="Step No.";
                Editable=FALSE }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000004;2;Field  ;
                SourceExpr="Maintask Step No.";
                Visible=FALSE;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Record is no Subtask.;DEA=Datensatz ist keine Unteraufgabe.';

    BEGIN
    END.
  }
}

OBJECT Page 70063 CMMS GPM Plant Mapping
{
  OBJECT-PROPERTIES
  {
    Date=30.01.17;
    Time=13:37:13;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=GPM Plant to CMMS Asset Mapping;
               DEA=GPM Plant zu CMMS Asset Mapping];
    SourceTable=Table70021;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Objecttype=CONST(Asset),
                          Type=CONST(GpmPlantMapping));
    PageType=List;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                CaptionML=[ENU=GPM Plant ID;
                           DEA=GPM Plant ID];
                SourceExpr=Key1 }

    { 1000000003;2;Field  ;
                SourceExpr="Asset No." }

    { 1000000004;2;Field  ;
                SourceExpr="GPM Op. Mapping Comment" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70064 CMMS GPM Operator Mapping
{
  OBJECT-PROPERTIES
  {
    Date=21.03.17;
    Time=16:20:36;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=GPM Operator to CMMS User Mapping;
               DEA=GPM Operator zu CMMS User Mapping];
    SourceTable=Table70021;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Objecttype=CONST(Asset),
                          Type=CONST(GpmOperatorMapping));
    PageType=List;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                CaptionML=[ENU=GPM Operator ID;
                           DEA=GPM Operator ID];
                SourceExpr=Key1 }

    { 1000000003;2;Field  ;
                SourceExpr="User Id" }

    { 1000000004;2;Field  ;
                SourceExpr="GPM Plant Mapping Comment" }

    { 1000000005;2;Field  ;
                SourceExpr="Ignore this Operator" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70065 CMMS Asset Contract Card
{
  OBJECT-PROPERTIES
  {
    Date=15.05.18;
    Time=17:11:07;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Asset Contracts;
               DEA=Anlagen Vetr„ge];
    SourceTable=Table70021;
    DataCaptionExpr=(Key1 + ' - ' + Key2);
    SourceTableView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                    WHERE(Objecttype=CONST(Asset),
                          Type=CONST(Contract));
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                GroupType=Group }

    { 1000000019;2;Field  ;
                CaptionML=[ENU=Asset No.;
                           DEA=Anlagennr.];
                SourceExpr=Key1 }

    { 1000000017;2;Field  ;
                CaptionML=[ENU=Contract No.;
                           DEA=Vertragsnr.];
                SourceExpr=Key2 }

    { 1000000012;2;Field  ;
                SourceExpr="Contract Type" }

    { 1000000004;2;Field  ;
                SourceExpr="Contract Name" }

    { 1000000005;2;Field  ;
                SourceExpr="Asset NameX" }

    { 1000000006;1;Group  ;
                Name=Dates;
                CaptionML=[ENU=Dates;
                           DEA=Datum];
                GroupType=Group }

    { 1000000007;2;Field  ;
                SourceExpr="Contract Start Date" }

    { 1000000008;2;Field  ;
                SourceExpr="Contract End Date" }

    { 1000000011;1;Group  ;
                Name=Invoicing;
                CaptionML=[ENU=Invoicing;
                           DEA=Verrechnung];
                GroupType=Group }

    { 1000000014;2;Field  ;
                SourceExpr="Invoicing Type" }

    { 1000000013;2;Field  ;
                SourceExpr="Invoicing Period" }

    { 1000000009;2;Field  ;
                SourceExpr="Start Date Invoicing" }

    { 1000000010;2;Field  ;
                SourceExpr="End Date Invoicing" }

    { 1000000015;2;Field  ;
                SourceExpr="Monthly Amount" }

    { 1000000016;2;Field  ;
                SourceExpr="Currency Code" }

    { 1000000002;2;Field  ;
                SourceExpr="Accounting Entity" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70066 CMMS Edit Contract Invoicing
{
  OBJECT-PROPERTIES
  {
    Date=07.03.18;
    Time=11:54:52;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    SourceTable=Table70050;
    PageType=ConfirmationDialog;
    SourceTableTemporary=Yes;
    InstructionalTextML=[ENU=Edit Contract Invoicing;
                         DEA=Vertragsverrechnung bearbeiten];
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000002;1;Field  ;
                SourceExpr="Start Date" }

    { 1000000003;1;Field  ;
                SourceExpr="End Date" }

    { 1000000005;1;Field  ;
                SourceExpr="Invoicing Type" }

    { 1000000004;1;Field  ;
                SourceExpr="Invoicing Period" }

  }
  CODE
  {

    PROCEDURE SetRec@1000000000(VAR TempRec@1000000000 : TEMPORARY Record 70050);
    BEGIN
      Rec := TempRec;
      Rec.INSERT;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70080 CMMS Equipment Hierarchy
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=11:54:06;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Equipment Hierarchy;
               DEA=Equipment Hierarchie];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70025;
    SourceTableView=SORTING(Objecttype,Type,Component Type,Key1,Entry No.)
                    WHERE(Component Type=FILTER(<>Remote Access Details));
    PageType=List;
    OnAfterGetRecord=BEGIN
                       DescriptionIndent := "Line Type";

                       IF "Line Type" = "Line Type"::Header THEN BEGIN
                         IGStyleTxt := 'Strong';
                         IGIsEditable := FALSE;
                       END ELSE BEGIN
                         IGStyleTxt := 'Standard';
                         IGIsEditable := TRUE;
                       END;

                       SetEditable;
                     END;

    OnNewRecord=BEGIN
                  "Component Type Integer" := "Component Type";
                END;

    OnInsertRecord=BEGIN
                     "Component Type Integer" := "Component Type";
                   END;

    OnAfterGetCurrRecord=BEGIN
                           "Component Type Integer" := "Component Type";
                         END;

    ActionList=ACTIONS
    {
      { 1000000008;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000009;1 ;Action    ;
                      Name=New;
                      ShortCutKey=Ctrl+N;
                      CaptionML=[ENU=New;
                                 DEA=Neu];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NewDocument;
                      OnAction=VAR
                                 CMEQPTMgmt@1000000000 : Codeunit 70025;
                               BEGIN
                                 IF NOT CurrPage.EDITABLE THEN EXIT;
                                 CMEQPTMgmt.InsertEQPT(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000019;1 ;ActionGroup;
                      CaptionML=[ENU=Component;
                                 DEA=&Komponente];
                      Image=Vendor }
      { 1000000018;2 ;Action    ;
                      Name=Card;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Card;
                                 DEA=Karte];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMEQPTMgmt@1000000000 : Codeunit 70025;
                               BEGIN
                                 CMEQPTMgmt.ShowEQPTCard(Rec);
                               END;
                                }
      { 1000000029;2 ;Action    ;
                      Name=ShowDetails;
                      CaptionML=[ENU=Show Details;
                                 DEA=Zeige Details];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Setup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IGShowDetails := NOT IGShowDetails;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000002;1;Group  ;
                Name=Group;
                IndentationColumnName=DescriptionIndent;
                IndentationControls=ComponentType;
                ShowAsTree=Yes;
                GroupType=Repeater }

    { 1000000028;2;Field  ;
                Name=ComponentType;
                SourceExpr="Component Type";
                Editable=false;
                StyleExpr=IGStyleTxt;
                OnLookup=BEGIN
                           CMEQPTMgmt.ShowEQPTCard(Rec);
                         END;
                          }

    { 1000000025;2;Field  ;
                Name=FI0005.1;
                SourceExpr="Item No.";
                Visible=false;
                Enabled=_FI0005 }

    { 1000000026;2;Field  ;
                SourceExpr=Description;
                Editable=IGIsEditable;
                StyleExpr=IGStyleTxt }

    { 1000000015;2;Field  ;
                SourceExpr=Quantity;
                Editable=_FI0005 }

    { 1000000023;2;Field  ;
                SourceExpr="Description 2";
                Visible=IGShowDetails;
                Editable=IGIsEditable }

    { 1000000024;2;Field  ;
                Name=FI0005.2;
                SourceExpr=Manufacturer;
                Editable=_FI0005;
                LookupPageID=CMMS Manufacturer List }

    { 1000000021;2;Field  ;
                Name=FI0005.3;
                SourceExpr=Model;
                Editable=_FI0005;
                LookupPageID=CMMS Model List }

    { 1000000022;2;Field  ;
                Name=FI0005.4;
                SourceExpr="Serial Number";
                Editable=_FI0005 }

    { 1000000017;2;Field  ;
                Name=FI0005.5;
                SourceExpr="Warranty End Date";
                Visible=IGShowDetails;
                Editable=_FI0005 }

    { 1000000020;2;Field  ;
                Name=FI0005.6;
                SourceExpr="Asset Tag";
                Visible=IGShowDetails;
                Editable=_FI0005 }

    { 1000000016;2;Field  ;
                SourceExpr="Type of Equipment";
                Editable=IGIsEditable }

    { 1000000013;2;Field  ;
                SourceExpr="Type of Equipment (Details)";
                Editable=IGIsEditable }

    { 1000000014;2;Field  ;
                Name=FI0005.8;
                SourceExpr="Data Source ID";
                Visible=IGShowDetails;
                Editable=_FI0005 }

    { 1000000011;2;Field  ;
                Name=FI0005.9;
                SourceExpr="Location on Site";
                Visible=IGShowDetails;
                Editable=_FI0005 }

    { 1000000012;2;Field  ;
                Name=FI0001;
                SourceExpr="Nominal DC Capacity";
                Visible=IGShowDetails;
                Editable=_FI0001 }

    { 1000000034;2;Field  ;
                Name=FI0001.2;
                SourceExpr=Azimut;
                Visible=IGShowDetails;
                Editable=_FI0001 }

    { 1000000035;2;Field  ;
                Name=FI0001.3;
                SourceExpr=Tilt;
                Visible=IGShowDetails;
                Editable=_FI0001 }

    { 1000000007;2;Field  ;
                Name=FI0002;
                SourceExpr="AC Capacity";
                Visible=IGShowDetails;
                Editable=_FI0002 }

    { 1000000010;2;Field  ;
                SourceExpr="IP-Address";
                Visible=IGShowDetails }

    { 1000000006;2;Field  ;
                Name=FI0004.1;
                SourceExpr="Detail 1";
                Visible=IGShowDetails;
                Editable=_FI0004 }

    { 1000000004;2;Field  ;
                Name=FI0004.2;
                SourceExpr="Detail 2";
                Visible=IGShowDetails;
                Editable=_FI0004 }

    { 1000000001;2;Field  ;
                Name=FI0004.3;
                SourceExpr="Detail 3";
                Visible=IGShowDetails;
                Editable=_FI0004 }

    { 1000000005;2;Field  ;
                SourceExpr="IP Address Local";
                Visible=IGShowDetails }

    { 1000000027;2;Field  ;
                SourceExpr="IP Address Remote/VPN";
                Visible=IGShowDetails }

    { 1000000030;2;Field  ;
                SourceExpr=Username;
                Visible=IGShowDetails }

    { 1000000031;2;Field  ;
                SourceExpr=Password;
                Visible=IGShowDetails }

    { 1000000003;0;Container;
                ContainerType=FactBoxArea }

  }
  CODE
  {
    VAR
      DescriptionIndent@1000000001 : Integer INDATASET;
      IGStyleTxt@1000000000 : Text INDATASET;
      IGIsEditable@1000000002 : Boolean INDATASET;
      IGShowDetails@1000000013 : Boolean INDATASET;
      _FI0001@1000000003 : Boolean INDATASET;
      _FI0002@1000000004 : Boolean INDATASET;
      _FI0003@1000000005 : Boolean INDATASET;
      _FI0004@1000000006 : Boolean INDATASET;
      _FI0005@1000000007 : Boolean INDATASET;
      _FI0006@1000000008 : Boolean INDATASET;
      _FI0007@1000000009 : Boolean INDATASET;
      _FI0008@1000000010 : Boolean INDATASET;
      _FI0009@1000000011 : Boolean INDATASET;
      _FI0010@1000000012 : Boolean INDATASET;
      Text001@1000000014 : TextConst 'ENU=" "';
      CMEQPTMgmt@1000000016 : Codeunit 70025;

    LOCAL PROCEDURE SetEditable@1000000001();
    VAR
      RecRef@1000000000 : RecordRef;
      FunctionArray@1000000001 : ARRAY [1000] OF Boolean;
      GroupArray@1000000002 : ARRAY [1000] OF Boolean;
      FieldArray@1000000004 : ARRAY [1000] OF Boolean;
      CMUserAccessMgmt@1000000003 : Codeunit 70010;
    BEGIN
      RecRef.GETTABLE(Rec);

      CMUserAccessMgmt.SetEditable(RecRef,FunctionArray,GroupArray,FieldArray);

      _FI0001 := FieldArray[1];
      _FI0002 := FieldArray[2];
      _FI0003 := FieldArray[3];
      _FI0004 := FieldArray[4];
      _FI0005 := FieldArray[5];
      _FI0006 := FieldArray[6];
      _FI0007 := FieldArray[7];
      _FI0008 := FieldArray[8];
      _FI0009 := FieldArray[9];
      _FI0010 := FieldArray[10];
      {
      _F0001 := FunctionArray[1];
      _F0002 := FunctionArray[2];
      _F0003 := FunctionArray[3];
      _F0004 := FunctionArray[4];
      _F0005 := FunctionArray[5];
      _F0006 := FunctionArray[6];
      _F0007 := FunctionArray[7];
      _F0008 := FunctionArray[8];
      _F0009 := FunctionArray[9];
      _F0010 := FunctionArray[10];

      _G0001 := GroupArray[1];
      _G0002 := GroupArray[2];
      _G0003 := GroupArray[3];
      _G0004 := GroupArray[4];
      _G0005 := GroupArray[5];
      _G0006 := GroupArray[6];
      _G0007 := GroupArray[7];
      _G0008 := GroupArray[8];
      _G0009 := GroupArray[9];
      _G0010 := GroupArray[10];
      }
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70081 CMMS Equipment Hierarchy Card
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=11:54:26;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Equipment Hierarchy Card;
               DEA=Equipmenthierarchiekarte];
    Description=CM;
    SourceTable=Table70025;
    PageType=Card;
    OnOpenPage=BEGIN
                 SetEditable;
               END;

    OnAfterGetRecord=BEGIN
                       SetEditable;
                       "Component Type Integer" := "Component Type";
                     END;

    OnNewRecord=BEGIN
                  "Component Type Integer" := "Component Type";
                END;

    OnAfterGetCurrRecord=BEGIN
                           "Component Type Integer" := "Component Type";
                         END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[ENU=General;
                           DEA=Allgemein];
                GroupType=Group }

    { 1000000025;2;Field  ;
                Name=ComponentType;
                SourceExpr="Component Type";
                Editable=false }

    { 1000000024;2;Field  ;
                Name=FI0005.1;
                SourceExpr="Item No.";
                Visible=_FI0005;
                Editable=_FI0005 }

    { 1000000023;2;Field  ;
                SourceExpr=Description }

    { 1000000022;2;Field  ;
                SourceExpr="Description 2" }

    { 1000000021;2;Field  ;
                Name=FI0005.2;
                SourceExpr=Manufacturer;
                Visible=_FI0005;
                Editable=_FI0005;
                LookupPageID=CMMS Manufacturer List }

    { 1000000020;2;Field  ;
                Name=FI0005.3;
                SourceExpr=Model;
                Visible=_FI0005;
                Editable=_FI0005;
                LookupPageID=CMMS Model List }

    { 1000000019;2;Field  ;
                Name=FI0005.4;
                SourceExpr="Serial Number";
                Visible=_FI0005;
                Editable=_FI0005 }

    { 1000000018;2;Field  ;
                Name=FI0005.5;
                SourceExpr="Warranty End Date";
                Visible=_FI0005;
                Editable=_FI0005 }

    { 1000000017;2;Field  ;
                Name=FI0005.6;
                SourceExpr="Asset Tag";
                Visible=_FI0005;
                Editable=_FI0005 }

    { 1000000016;2;Field  ;
                Name=FI0005.7;
                SourceExpr=Quantity;
                Visible=_FI0005;
                Editable=_FI0005 }

    { 1000000015;2;Field  ;
                SourceExpr="Type of Equipment" }

    { 1000000014;2;Field  ;
                SourceExpr="Type of Equipment (Details)" }

    { 1000000013;2;Field  ;
                Name=FI0005.8;
                SourceExpr="Data Source ID";
                Visible=_FI0005;
                Editable=_FI0005 }

    { 1000000012;2;Field  ;
                Name=FI0005.9;
                SourceExpr="Location on Site";
                Visible=_FI0005;
                Editable=_FI0005 }

    { 1000000011;2;Field  ;
                Name=FI0001;
                SourceExpr="Nominal DC Capacity";
                Visible=_FI0001;
                Editable=_FI0001 }

    { 1000000027;2;Field  ;
                Name=FI0001.2;
                SourceExpr=Azimut;
                Visible=_FI0001;
                Editable=_FI0001 }

    { 1000000028;2;Field  ;
                Name=FI0001.3;
                SourceExpr=Tilt;
                Visible=_FI0001;
                Editable=_FI0001 }

    { 1000000010;2;Field  ;
                Name=FI0002;
                SourceExpr="AC Capacity";
                Visible=_FI0002;
                Editable=_FI0002 }

    { 1000000009;2;Field  ;
                SourceExpr="IP-Address" }

    { 1000000008;2;Field  ;
                Name=FI0004.1;
                SourceExpr="Detail 1";
                Visible=_FI0004;
                Editable=_FI0004 }

    { 1000000007;2;Field  ;
                Name=FI0004.2;
                SourceExpr="Detail 2";
                Visible=_FI0004;
                Editable=_FI0004 }

    { 1000000005;2;Field  ;
                Name=FI0004.3;
                SourceExpr="Detail 3";
                Visible=_FI0004;
                Editable=_FI0004 }

    { 1000000006;2;Field  ;
                SourceExpr="IP Address Local" }

    { 1000000004;2;Field  ;
                SourceExpr="IP Address Remote/VPN" }

    { 1000000003;2;Field  ;
                SourceExpr=Username }

    { 1000000002;2;Field  ;
                SourceExpr=Password }

  }
  CODE
  {
    VAR
      _FI0001@1000000009 : Boolean INDATASET;
      _FI0002@1000000008 : Boolean INDATASET;
      _FI0003@1000000007 : Boolean INDATASET;
      _FI0004@1000000006 : Boolean INDATASET;
      _FI0005@1000000005 : Boolean INDATASET;
      _FI0006@1000000004 : Boolean INDATASET;
      _FI0007@1000000003 : Boolean INDATASET;
      _FI0008@1000000002 : Boolean INDATASET;
      _FI0009@1000000001 : Boolean INDATASET;
      _FI0010@1000000000 : Boolean INDATASET;

    LOCAL PROCEDURE SetEditable@1000000001();
    VAR
      RecRef@1000000000 : RecordRef;
      FunctionArray@1000000001 : ARRAY [1000] OF Boolean;
      GroupArray@1000000002 : ARRAY [1000] OF Boolean;
      FieldArray@1000000004 : ARRAY [1000] OF Boolean;
      CMUserAccessMgmt@1000000003 : Codeunit 70010;
    BEGIN
      RecRef.GETTABLE(Rec);

      CMUserAccessMgmt.SetEditable(RecRef,FunctionArray,GroupArray,FieldArray);

      _FI0001 := FieldArray[1];
      _FI0002 := FieldArray[2];
      _FI0003 := FieldArray[3];
      _FI0004 := FieldArray[4];
      _FI0005 := FieldArray[5];
      _FI0006 := FieldArray[6];
      _FI0007 := FieldArray[7];
      _FI0008 := FieldArray[8];
      _FI0009 := FieldArray[9];
      _FI0010 := FieldArray[10];
      {
      _F0001 := FunctionArray[1];
      _F0002 := FunctionArray[2];
      _F0003 := FunctionArray[3];
      _F0004 := FunctionArray[4];
      _F0005 := FunctionArray[5];
      _F0006 := FunctionArray[6];
      _F0007 := FunctionArray[7];
      _F0008 := FunctionArray[8];
      _F0009 := FunctionArray[9];
      _F0010 := FunctionArray[10];

      _G0001 := GroupArray[1];
      _G0002 := GroupArray[2];
      _G0003 := GroupArray[3];
      _G0004 := GroupArray[4];
      _G0005 := GroupArray[5];
      _G0006 := GroupArray[6];
      _G0007 := GroupArray[7];
      _G0008 := GroupArray[8];
      _G0009 := GroupArray[9];
      _G0010 := GroupArray[10];
      }
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70082 CMMS Spare Parts
{
  OBJECT-PROPERTIES
  {
    Date=11.11.16;
    Time=14:04:41;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Spare Parts;
               DEA=Ersatzteile];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table70025;
    PageType=List;
    OnAfterGetRecord=BEGIN
                       DescriptionIndent := "Line Type";

                       IF "Entry No." = "Line Type"::Header THEN BEGIN
                         IGStyleTxt := 'Strong';
                         IGIsEditable := FALSE;
                       END ELSE BEGIN
                         IGStyleTxt := 'Standard';
                         IGIsEditable := TRUE;
                       END;

                       SetEditable;
                     END;

    ActionList=ACTIONS
    {
      { 1000000008;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000009;1 ;Action    ;
                      Name=New;
                      ShortCutKey=Ctrl+N;
                      CaptionML=[ENU=New;
                                 DEA=Neu];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NewDocument;
                      OnAction=VAR
                                 CMEQPTMgmt@1000000000 : Codeunit 70025;
                               BEGIN
                                 IF NOT CurrPage.EDITABLE THEN EXIT;
                                 CMEQPTMgmt.InsertEQPT(Rec);
                               END;
                                }
      { 1000000019;1 ;ActionGroup;
                      CaptionML=[ENU=Component;
                                 DEA=&Komponente];
                      Image=Vendor }
      { 1000000018;2 ;Action    ;
                      Name=Card;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Card;
                                 DEA=Karte];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMEQPTMgmt@1000000000 : Codeunit 70025;
                               BEGIN
                                 CMEQPTMgmt.ShowEQPTCard(Rec);
                               END;
                                }
      { 1000000029;2 ;Action    ;
                      Name=ShowDetails;
                      CaptionML=[ENU=Show Details;
                                 DEA=Zeige Details];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Setup;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IGShowDetails := NOT IGShowDetails;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000002;1;Group  ;
                Name=Group;
                IndentationColumnName=DescriptionIndent;
                IndentationControls=ComponentType;
                ShowAsTree=Yes;
                GroupType=Repeater }

    { 1000000001;2;Field  ;
                Name=ComponentType;
                SourceExpr="Component Type";
                Editable=false;
                StyleExpr=IGStyleTxt }

    { 1000000010;2;Field  ;
                SourceExpr="Item No.";
                Visible=false;
                Editable=IGIsEditable }

    { 1000000006;2;Field  ;
                SourceExpr=Description;
                Editable=IGIsEditable;
                StyleExpr=IGStyleTxt }

    { 1000000007;2;Field  ;
                SourceExpr="Description 2";
                Visible=IGShowDetails;
                Editable=IGIsEditable }

    { 1000000012;2;Field  ;
                SourceExpr=Manufacturer;
                Editable=IGIsEditable }

    { 1000000013;2;Field  ;
                SourceExpr=Model;
                Editable=IGIsEditable }

    { 1000000020;2;Field  ;
                SourceExpr="Serial Number";
                Editable=IGIsEditable }

    { 1000000014;2;Field  ;
                SourceExpr="Warranty End Date";
                Visible=IGShowDetails;
                Editable=IGIsEditable }

    { 1000000011;2;Field  ;
                SourceExpr="Asset Tag";
                Visible=IGShowDetails;
                Editable=IGIsEditable }

    { 1000000015;2;Field  ;
                SourceExpr=Quantity;
                Visible=IGShowDetails;
                Editable=IGIsEditable }

    { 1000000017;2;Field  ;
                SourceExpr="Type of Equipment";
                Editable=IGIsEditable }

    { 1000000026;2;Field  ;
                SourceExpr="Type of Equipment (Details)";
                Editable=IGIsEditable }

    { 1000000028;2;Field  ;
                SourceExpr="Data Source ID";
                Visible=IGShowDetails;
                Editable=IGIsEditable }

    { 1000000016;2;Field  ;
                SourceExpr="Location on Site";
                Visible=IGShowDetails;
                Editable=IGIsEditable }

    { 1000000021;2;Field  ;
                SourceExpr="Nominal DC Capacity";
                Visible=IGShowDetails;
                Editable=_FI0001 }

    { 1000000022;2;Field  ;
                SourceExpr="AC Capacity";
                Visible=IGShowDetails;
                Editable=_FI0002 }

    { 1000000027;2;Field  ;
                SourceExpr="IP-Address";
                Visible=IGShowDetails;
                Editable=_FI0003 }

    { 1000000023;2;Field  ;
                SourceExpr="Detail 1";
                Visible=IGShowDetails;
                Editable=_FI0004 }

    { 1000000024;2;Field  ;
                SourceExpr="Detail 2";
                Visible=IGShowDetails;
                Editable=_FI0004 }

    { 1000000025;2;Field  ;
                SourceExpr="Detail 3";
                Visible=IGShowDetails;
                Editable=_FI0004 }

    { 1000000004;0;Container;
                ContainerType=FactBoxArea }

  }
  CODE
  {
    VAR
      DescriptionIndent@1000000001 : Integer;
      IGStyleTxt@1000000000 : Text;
      IGIsEditable@1000000002 : Boolean;
      IGShowDetails@1000000013 : Boolean;
      _FI0001@1000000003 : Boolean;
      _FI0002@1000000004 : Boolean;
      _FI0003@1000000005 : Boolean;
      _FI0004@1000000006 : Boolean;
      _FI0005@1000000007 : Boolean;
      _FI0006@1000000008 : Boolean;
      _FI0007@1000000009 : Boolean;
      _FI0008@1000000010 : Boolean;
      _FI0009@1000000011 : Boolean;
      _FI0010@1000000012 : Boolean;

    LOCAL PROCEDURE SetEditable@1000000001();
    VAR
      RecRef@1000000000 : RecordRef;
      FunctionArray@1000000001 : ARRAY [1000] OF Boolean;
      GroupArray@1000000002 : ARRAY [1000] OF Boolean;
      FieldArray@1000000004 : ARRAY [1000] OF Boolean;
      CMUserAccessMgmt@1000000003 : Codeunit 70010;
    BEGIN
      RecRef.GETTABLE(Rec);

      CMUserAccessMgmt.SetEditable(RecRef,FunctionArray,GroupArray,FieldArray);

      _FI0001 := FieldArray[1];
      _FI0002 := FieldArray[2];
      _FI0003 := FieldArray[3];
      _FI0004 := FieldArray[4];
      _FI0005 := FieldArray[5];
      _FI0006 := FieldArray[6];
      _FI0007 := FieldArray[7];
      _FI0008 := FieldArray[8];
      _FI0009 := FieldArray[9];
      _FI0010 := FieldArray[10];
      {
      _F0001 := FunctionArray[1];
      _F0002 := FunctionArray[2];
      _F0003 := FunctionArray[3];
      _F0004 := FunctionArray[4];
      _F0005 := FunctionArray[5];
      _F0006 := FunctionArray[6];
      _F0007 := FunctionArray[7];
      _F0008 := FunctionArray[8];
      _F0009 := FunctionArray[9];
      _F0010 := FunctionArray[10];

      _G0001 := GroupArray[1];
      _G0002 := GroupArray[2];
      _G0003 := GroupArray[3];
      _G0004 := GroupArray[4];
      _G0005 := GroupArray[5];
      _G0006 := GroupArray[6];
      _G0007 := GroupArray[7];
      _G0008 := GroupArray[8];
      _G0009 := GroupArray[9];
      _G0010 := GroupArray[10];
      }
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70083 CMMS Manufacturer List
{
  OBJECT-PROPERTIES
  {
    Date=23.03.18;
    Time=09:54:16;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Manufacturers / Brands / Make;
               DEA=Hersteller / Marken];
    SourceTable=Table70021;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key2,Key1)
                    WHERE(Type=CONST(Manufacturer));
    PageType=List;
    OnNewRecord=BEGIN
                  "Component Type" := "Line No.";
                END;

    ActionList=ACTIONS
    {
      { 1000000002;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000004;1 ;Action    ;
                      Name=Models;
                      CaptionML=ENU=Models;
                      RunObject=Page 70084;
                      RunPageLink=Key2=FIELD(Key2),
                                  Line No.=FIELD(Line No.);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Line;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000007;2;Field  ;
                SourceExpr="Component Type" }

    { 1000000003;2;Field  ;
                Name=Code;
                CaptionML=ENU=Code;
                SourceExpr=Key2 }

    { 1000000006;2;Field  ;
                Name=Name;
                CaptionML=ENU=Name;
                SourceExpr="Manufacturer Name" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70084 CMMS Model List
{
  OBJECT-PROPERTIES
  {
    Date=23.03.18;
    Time=09:56:39;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Models / Types;
               DEA=Modelle / Typen];
    SourceTable=Table70021;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Objecttype,Type,Key2,Key1)
                    WHERE(Type=CONST(Model));
    PageType=List;
    OnNewRecord=BEGIN
                  "Component Type" := "Line No.";
                END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000004;2;Field  ;
                SourceExpr="Component Type" }

    { 1000000002;2;Field  ;
                Name=ManufacturerCode;
                CaptionML=ENU=Manufacturer Code;
                SourceExpr=Key2;
                Editable=FALSE }

    { 1000000005;2;Field  ;
                SourceExpr="Manufacturer Name_";
                Visible=FALSE }

    { 1000000003;2;Field  ;
                Name=Code;
                SourceExpr=Key3 }

    { 1000000006;2;Field  ;
                Name=Name;
                CaptionML=ENU=Name;
                SourceExpr="Model Name" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70090 CMMS Time Tracking
{
  OBJECT-PROPERTIES
  {
    Date=13.07.16;
    Time=16:07:39;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Time Tracking;
               DEA=Zeiterfassung];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5092;
    PageType=ConfirmationDialog;
    SourceTableTemporary=Yes;
    InstructionalTextML=[ENU=Track Time;
                         DEA=Zeiten erfassen];
    OnInit=BEGIN
             Show := TRUE;
           END;

    OnOpenPage=BEGIN
                 INIT;
                 Rec."CM Assigned User ID" := USERID;
                 INSERT();
                 FINDFIRST();
                 SETRECFILTER();
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                Name=WorkingTimeCtrl;
                CaptionML=[ENU=Time (Hrs.);
                           DEA=Zeit (Std.)];
                SourceExpr=WorkingTime }

    { 1000000002;1;Field  ;
                Name=TrackingTypeCtrl;
                CaptionML=[ENU=Post on;
                           DEA=Verbuchen auf];
                OptionCaptionML=[ENU=Asset,Workorder;
                                 DEA=Anlage,Arbeitsauftrag];
                SourceExpr=TrackingType;
                OnValidate=BEGIN
                             IF TrackingType = TrackingType::Asset THEN BEGIN
                               Show := TRUE;
                               WorkorderNo := '';
                             END
                             ELSE BEGIN
                               Show := FALSE;
                               AssetNo := '';
                             END;

                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1000000004;1;Field  ;
                Name=AssetNoCtrl;
                CaptionML=[ENU=Asset;
                           DEA=Anlage];
                SourceExpr=AssetNo;
                TableRelation="CMMS Object".No.;
                Enabled=Show }

    { 1000000003;1;Field  ;
                Name=WoNoCtrl;
                CaptionML=[ENU=Workorder;
                           DEA=Arbeitsauftrag];
                SourceExpr=WorkorderNo;
                TableRelation=Opportunity.No. WHERE (CM Is Workorder=CONST(Yes),
                                                     CM Assigned User ID=FIELD(CM Assigned User ID));
                Enabled=NOT Show }

  }
  CODE
  {
    VAR
      WorkingTime@1000000000 : Duration;
      TrackingType@1000000001 : 'Asset,Workorder';
      AssetNo@1000000002 : Code[20];
      WorkorderNo@1000000003 : Code[20];
      Show@1000000004 : Boolean INDATASET;

    BEGIN
    END.
  }
}

OBJECT Page 70091 CMMS Time Tracking Register
{
  OBJECT-PROPERTIES
  {
    Date=28.08.17;
    Time=14:38:30;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Time Tracking Worksheet;
               DEA=Zeiterfassung];
    SourceTable=Table952;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(CM Is CMMS Timesheet,CM User ID,CM Entry Date)
                    WHERE(CM Is CMMS Timesheet=CONST(Yes),
                          Posted=CONST(No));
    PageType=Worksheet;
    OnOpenPage=BEGIN
                 SetShowDim();

                 IF RegisterUserID = '' THEN
                   RegisterUserID := USERID;
                 CMTTMgt.SetUserID(RegisterUserID,RegisterUserName);

                 IF NOT UserSetup.GET(RegisterUserID) THEN ERROR(Text001);

                 FILTERGROUP(2);
                 SETRANGE("CM User ID", RegisterUserID);
                 SETRANGE("CM Posted By User ID", USERID);
                 FILTERGROUP(2);
               END;

    OnInsertRecord=BEGIN
                     Rec."Time Sheet Line No." := CMTTMgt.GetNextLineNo();
                   END;

    ActionList=ACTIONS
    {
      { 1000000016;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000017;1 ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      CaptionML=[ENU=P&ost;
                                 DEA=Bu&chen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMTTMgt.PostSheet(Rec);
                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
      { 1000000010;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000014;1 ;Action    ;
                      Name=Entries;
                      CaptionML=[ENU=Entries;
                                 DEA=Posten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Ledger;
                      PromotedCategory=Report;
                      OnAction=BEGIN
                                 CMTTMgt.ShowPostedEntries(RegisterUserID,'',0);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000013;1;Field  ;
                Lookup=No;
                CaptionML=[ENU=User ID;
                           DEA=Benuter ID];
                SourceExpr=RegisterUserID;
                Editable=false }

    { 1000000012;1;Field  ;
                CaptionML=[ENU=User Name;
                           DEA=Benutzername];
                SourceExpr=RegisterUserName;
                Editable=false }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000008;2;Field  ;
                SourceExpr="CM User ID";
                Editable=FALSE }

    { 1000000002;2;Field  ;
                SourceExpr="CM Entry Date";
                ShowMandatory=True }

    { 1000000018;2;Field  ;
                SourceExpr="CM Main Asset No." }

    { 1000000009;2;Field  ;
                SourceExpr="CM Asset No." }

    { 1000000007;2;Field  ;
                SourceExpr="CM Project No." }

    { 1000000006;2;Field  ;
                SourceExpr="CM Dimension Value 3";
                Visible=_showDim3 }

    { 1000000005;2;Field  ;
                SourceExpr="CM Dimension Value 4";
                Visible=_showDim4 }

    { 1000000004;2;Field  ;
                SourceExpr="CM Description";
                ShowMandatory=True }

    { 1000000003;2;Field  ;
                CaptionML=[ENU=Hours;
                           DEA=Stunden];
                SourceExpr="CM Quantity";
                ShowMandatory=TRUE }

    { 1000000011;0;Container;
                ContainerType=FactBoxArea }

  }
  CODE
  {
    VAR
      CMTTMgt@1000000015 : Codeunit 70040;
      CMGenMgt@1000000014 : Codeunit 70000;
      CMGenSetup@1000000013 : Record 70000;
      RegisterUserID@1000000004 : Code[50];
      RegisterUserName@1000000003 : Text[80];
      UserSetup@1000000002 : Record 91;
      Resource@1000000001 : Record 156;
      Text001@1000000005 : TextConst 'ENU=You can not access the time tracking! Please contact your system administrator!;DEA=Sie haben keinen Zugriff auf die Zeiterfassung! Wenden Sie sich bitte an Ihren Systemadministrator!';
      Balance@1000000000 : Decimal;
      UsePin@1000000007 : Boolean;
      MainAssetName@1000000010 : Text[50];
      AssetName@1000000009 : Text[50];
      ProjectName@1000000006 : Text[50];
      _editable@1000000008 : Boolean INDATASET;
      _showDim3@1000000012 : Boolean INDATASET;
      _showDim4@1000000011 : Boolean INDATASET;
      TempLineNo@1000000016 : Integer;

    PROCEDURE SetValue@1000000002(VAR SetRegisterUserID@1000000000 : Code[50]);
    BEGIN
      RegisterUserID := SetRegisterUserID;
    END;

    LOCAL PROCEDURE SetShowDim@1000000000();
    VAR
      CMGenSetup@1000000000 : Record 70000;
    BEGIN
      IF NOT CMGenSetup.GET() THEN
        CMGenSetup.INIT;

      IF CMGenSetup."Dimension 3" <> '' THEN
        _showDim3 := TRUE;
      IF CMGenSetup."Dimension 4" <> '' THEN
        _showDim4 := TRUE;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70092 CMMS Time Posting Card
{
  OBJECT-PROPERTIES
  {
    Date=20.02.18;
    Time=15:47:59;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=Yes;
    CaptionML=[ENU=Time Tracking;
               DEA=Zeiterfassung];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table952;
    DataCaptionExpr=Text002;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(CM Is CMMS Timesheet,Time Sheet No.,Time Sheet Line No.)
                    WHERE(CM Is CMMS Timesheet=CONST(Yes),
                          Time Sheet No.=CONST());
    PageType=Card;
    SourceTableTemporary=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Entries;
                                DEA=Neu,Vorgang,Bericht,Posten];
    ShowFilter=No;
    OnInit=BEGIN
             CurrPage.EDITABLE := TRUE;
             SetShowDim();
           END;

    OnOpenPage=BEGIN
                 CMTTMgt.InitRec(Rec,TRUE);
                 Rec.SETRECFILTER();
                 IF NOT CMGenSetup.GET() THEN
                   CMGenSetup.INIT();
               END;

    OnAfterGetRecord=BEGIN
                       _editable := CurrPage.EDITABLE;
                     END;

    OnInsertRecord=BEGIN
                     TempLineNo += 1;
                     Rec."Time Sheet Line No." := TempLineNo;
                   END;

    ActionList=ACTIONS
    {
      { 1000000003;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000008;1 ;Action    ;
                      Name=PostTime;
                      CaptionML=[ENU=Post Time;
                                 DEA=Zeit Buchen];
                      Promoted=Yes;
                      InFooterBar=Yes;
                      PromotedIsBig=Yes;
                      Image=Post;
                      PromotedCategory=Process;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 CurrPage.SAVERECORD();
                                 CMTTMgt.PostLine(Rec,TRUE,FALSE);
                                 ResetPage();

                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=PostedEntries;
                      CaptionML=[ENU=Posted Entries;
                                 DEA=Gebuchte Eintr„ge];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedTimeSheet;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 CMTTMgt.ShowPostedEntries(USERID,'',1);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                SourceExpr="CM Entry Date";
                OnValidate=BEGIN
                             CMTTMgt.TestDate(Rec);
                           END;
                            }

    { 1000000012;1;Field  ;
                Name=MainAssetName;
                CaptionML=[ENU=Main Asset;
                           DEA=Hauptanlage];
                SourceExpr=MainAssetName;
                OnValidate=BEGIN
                             IF MainAssetName <> '' THEN
                               ValidateNo(2,CMGenMgt.DoUniversalLookup(2,'','0|1',MainAssetName, ''))
                             ELSE
                               ValidateNo(2,'');
                           END;
                            }

    { 1000000013;1;Field  ;
                SourceExpr="CM Main Asset No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000006;1;Field  ;
                Name=AssetName;
                CaptionML=[ENU=Asset;
                           DEA=Anlage];
                SourceExpr=AssetName;
                Editable=_editable;
                OnValidate=BEGIN
                             IF AssetName <> '' THEN
                               ValidateNo(0,CMGenMgt.DoUniversalLookup(3,Rec."CM Main Asset No.",'0|1', AssetName, ''))
                             ELSE
                               ValidateNo(0,'');
                           END;
                            }

    { 1000000007;1;Field  ;
                SourceExpr="CM Asset No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000011;1;Field  ;
                Name=ProjectName;
                CaptionML=[ENU=Project;
                           DEA=Projekt];
                SourceExpr=ProjectName;
                Editable=_editable;
                OnValidate=BEGIN
                             IF ProjectName <> '' THEN
                               ValidateNo(1,CMGenMgt.DoUniversalLookup(1,GetProjectSourceNo(),'0|1', ProjectName, '')) //1 = Project
                             ELSE
                               ValidateNo(1,'');
                           END;
                            }

    { 1000000004;1;Field  ;
                SourceExpr="CM Project No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000014;1;Field  ;
                SourceExpr="CM Dimension Value 3";
                Visible=_showDim3;
                OnValidate=BEGIN
                             ValidateSelection();
                           END;
                            }

    { 1000000015;1;Field  ;
                SourceExpr="CM Dimension Value 4";
                Visible=_showDim4;
                OnValidate=BEGIN
                             ValidateSelection();
                           END;
                            }

    { 1000000002;1;Field  ;
                SourceExpr="CM Description";
                ShowMandatory=True }

    { 1000000009;1;Field  ;
                CaptionML=[ENU=Hours;
                           DEA=Stunden];
                SourceExpr="CM Quantity";
                OnValidate=BEGIN
                             //CMTTMgt.TestQuantity(Rec);
                           END;

                ShowMandatory=TRUE }

    { 1000000018;1;Field  ;
                Name=InfoText;
                SourceExpr=GetText(STRSUBSTNO(Text005, CMGenSetup."Rounding Precision", CMGenSetup."Default UoM Code"));
                Style=Strong;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              ;
                            END;

                ShowCaption=No }

    { 1000000010;1;Field  ;
                Name=PostTime;
                SourceExpr=GetText(FORMAT(Text001));
                Style=Favorable;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD();
                              CMTTMgt.PostLine(Rec, TRUE, FALSE);
                              ResetPage();

                              CurrPage.UPDATE(TRUE);
                            END;

                ShowCaption=No }

    { 1000000016;0;Container;
                ContainerType=FactBoxArea }

  }
  CODE
  {
    VAR
      TempLineNo@1000000000 : Integer;
      CMTTMgt@1000000001 : Codeunit 70040;
      Text001@1000000003 : TextConst 'ENU=Post Time;DEA=Zeit Buchen';
      Text002@1000000002 : TextConst 'ENU=Time Tracking;DEA=Zeiterfassung';
      CMGenMgt@1000000004 : Codeunit 70000;
      CMGenSetup@1000000014 : Record 70000;
      MainAssetName@1000000012 : Text[50];
      AssetName@1000000005 : Text[50];
      ProjectName@1000000006 : Text[50];
      _editable@1000000007 : Boolean INDATASET;
      _showDim3@1000000010 : Boolean INDATASET;
      _showDim4@1000000011 : Boolean INDATASET;
      Text003@1000000008 : TextConst 'ENU=Invalid Input!;DEA=šngltige Eingabe!';
      Text004@1000000009 : TextConst 'ENU=Please provide either Asset / Project or Cost Center!;DEA=Geben sie entweder Anlage bzw. Projekt oder Kostenstelle an!';
      Text005@1000000013 : TextConst 'ENU=Time will be rounded on the basis of %1 %2.;DEA=Zeiten werden auf %1 %2 Basis gerundet';

    LOCAL PROCEDURE GetText@1000000018(InputText@1000000000 : Text) : Text;
    BEGIN
      EXIT(InputText);
    END;

    LOCAL PROCEDURE ValidateNo@1000000000(ObjType@1000000000 : 'Asset,Project,MainAsset';No@1000000001 : Code[20]);
    VAR
      CMAsset@1000000002 : Record 70020;
    BEGIN
      //Main Asset
      IF ObjType = ObjType::MainAsset THEN BEGIN
        IF CMAsset.GET(CMAsset.Objecttype::Asset, No) THEN BEGIN
          MainAssetName := GetObjectName(No,CMAsset.Name);
          Rec."CM Main Asset No." := No;
        END
        ELSE BEGIN
          MainAssetName := '';
          Rec."CM Main Asset No." := '';
        END;

        AssetName := '';
        Rec."CM Asset No." := '';
        ProjectName := '';
        Rec."CM Project No." := '';
      END;

      //Asset
      IF ObjType = ObjType::Asset THEN BEGIN
        IF CMAsset.GET(CMAsset.Objecttype::Asset, No) THEN BEGIN
          AssetName := GetObjectName(No,CMAsset.Name);
          Rec."CM Asset No." := No;
        END
        ELSE BEGIN
          AssetName := '';
          Rec."CM Asset No." := '';
        END;

        ProjectName := '';
        Rec."CM Project No." := '';
      END;

      //Project
      IF ObjType = ObjType::Project THEN BEGIN
        IF CMAsset.GET(CMAsset.Objecttype::Project, No) THEN BEGIN
          ProjectName := GetObjectName(No,CMAsset.Name);
          "CM Project No." := No;
        END
        ELSE BEGIN
          "CM Project No." := '';
          ProjectName := '';
        END;
      END;

      ValidateSelection();
      CurrPage.SAVERECORD();
    END;

    LOCAL PROCEDURE ValidateSelection@1000000003();
    BEGIN
      IF NOT CMTTMgt.TestDim(Rec,2) THEN BEGIN //Shows message
        "CM Dimension Value 3" := '';
        "CM Dimension Code 4" := '';
      END;
    END;

    LOCAL PROCEDURE ResetPage@1000000001();
    BEGIN
        AssetName := '';
        ProjectName := '';
        MainAssetName := '';
    END;

    LOCAL PROCEDURE SetShowDim@1000000002();
    VAR
      CMGenSetup@1000000000 : Record 70000;
    BEGIN
      IF NOT CMGenSetup.GET() THEN
        CMGenSetup.INIT;

      IF CMGenSetup."Dimension 3" <> '' THEN
        _showDim3 := TRUE;
      IF CMGenSetup."Dimension 4" <> '' THEN
        _showDim4 := TRUE;
    END;

    LOCAL PROCEDURE GetProjectSourceNo@1000000005() : Code[20];
    BEGIN
      IF Rec."CM Asset No." <> '' THEN
        EXIT(Rec."CM Asset No.");
      IF Rec."CM Main Asset No." <> '' THEN
        EXIT(Rec."CM Main Asset No.");

      EXIT('');
    END;

    LOCAL PROCEDURE GetObjectName@1000000008(Code@1000000000 : Code[20];Name@1000000001 : Text[50]) : Text;
    VAR
      Result@1000000002 : Text;
    BEGIN
      Result := '';
      IF Code <> '' THEN
        Result += Code;
      IF (Name <> '') AND (Result <> '') THEN
        Result += (' - ' + Name);

      EXIT(COPYSTR(Result,1,50));
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70093 CMMS Post. Time Track. Entry
{
  OBJECT-PROPERTIES
  {
    Date=28.08.17;
    Time=08:32:24;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Time Tracking Entries;
               DEA=Zeiterfassungsposten];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table952;
    SourceTableView=SORTING(CM Is CMMS Timesheet,CM User ID,CM Entry Date)
                    ORDER(Descending)
                    WHERE(CM Is CMMS Timesheet=CONST(Yes));
    PageType=List;
    ShowFilter=Yes;
    OnOpenPage=BEGIN
                 _reverseAllowed := CMTTMgt.ReverseAllowed();
               END;

    OnAfterGetRecord=BEGIN
                       SetStyle();
                     END;

    OnAfterGetCurrRecord=BEGIN
                           SetStyle();
                         END;

    ActionList=ACTIONS
    {
      { 1000000008;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000009;1 ;Action    ;
                      Name=Reverse;
                      CaptionML=[ENU=Reverse Entry;
                                 DEA=Eintrag Stornieren];
                      Promoted=Yes;
                      Visible=_reverseAllowed;
                      PromotedIsBig=Yes;
                      Image=CancelLine;
                      PromotedCategory=Process;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 CMTTMgt.ReverseLine(Rec);
                               END;
                                }
      { 1000000013;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000012;1 ;Action    ;
                      Name=Dimensions;
                      CaptionML=[ENU=Dimensions;
                                 DEA=Dimensionen];
                      Image=Dimensions;
                      OnAction=VAR
                                 DimMgt@1000000000 : Codeunit 408;
                               BEGIN
                                 DimMgt.ShowDimensionSet(Rec."CM Dimension Set ID", Text001);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000017;2;Field  ;
                SourceExpr="CM User ID" }

    { 1000000021;2;Field  ;
                SourceExpr="CM Posted By User ID" }

    { 1000000002;2;Field  ;
                SourceExpr="CM Entry Date";
                StyleExpr=StyleText }

    { 1000000018;2;Field  ;
                SourceExpr="CM Main Asset No." }

    { 1000000003;2;Field  ;
                SourceExpr="CM Asset No.";
                StyleExpr=StyleText }

    { 1000000004;2;Field  ;
                SourceExpr="CM Project No.";
                StyleExpr=StyleText }

    { 1000000019;2;Field  ;
                SourceExpr="CM Workorder No." }

    { 1000000020;2;Field  ;
                SourceExpr="CM Task No." }

    { 1000000005;2;Field  ;
                SourceExpr="CM Description";
                StyleExpr=StyleText }

    { 1000000016;2;Field  ;
                SourceExpr="CM Dimension Value 3" }

    { 1000000007;2;Field  ;
                DecimalPlaces=2:2;
                SourceExpr="CM Quantity";
                StyleExpr=StyleText }

    { 1000000006;2;Field  ;
                SourceExpr="CM UoM Code";
                StyleExpr=StyleText }

    { 1000000010;2;Field  ;
                SourceExpr="CM Reverse Line No.";
                Visible=FALSE;
                StyleExpr=StyleText }

    { 1000000011;2;Field  ;
                CaptionML=[ENU=Reversed;
                           DEA=Storniert];
                SourceExpr="CM Reverse Line No." > 0;
                Editable=FALSE;
                StyleExpr=StyleText }

    { 1000000014;2;Field  ;
                CaptionML=[ENU=Asset Data;
                           DEA=Anlagendaten];
                SourceExpr="CM Text 1" }

    { 1000000015;2;Field  ;
                CaptionML=[ENU=Project Data;
                           DEA=Projektdaten];
                SourceExpr="CM Text 2" }

  }
  CODE
  {
    VAR
      CMTTMgt@1000000000 : Codeunit 70040;
      StyleText@1000000001 : Text INDATASET;
      Text001@1000000002 : TextConst 'ENU=Dimensions;DEA=Dimensionen';
      _reverseAllowed@1000000003 : Boolean INDATASET;

    LOCAL PROCEDURE SetStyle@1000000001();
    BEGIN
      StyleText := '';

      IF Rec."CM Reverse Line No." > 0 THEN
        StyleText := 'Subordinate';
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70094 CMMS Scheduling Tool Card
{
  OBJECT-PROPERTIES
  {
    Date=05.01.18;
    Time=13:20:37;
    Modified=Yes;
    Version List=CMMS,SCT;
  }
  PROPERTIES
  {
    SourceTable=Table50002;
    DataCaptionExpr=Text001;
    PageType=Card;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             Rec.INIT;
             Rec.INSERT;
             CalendarSubpageVisible := TRUE;
             TaskSubpageVisible := FALSE;
             Webclient := (CURRENTCLIENTTYPE = CLIENTTYPE::Web);
           END;

    OnAfterGetRecord=BEGIN
                       SETRECFILTER;
                     END;

    OnAfterGetCurrRecord=BEGIN
                           UpdateCalendarSubpage();
                           UpdateTaskSubpage();
                         END;

    ActionList=ACTIONS
    {
      { 1000000013;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000017;1 ;Action    ;
                      Name=ToggleTaskSubpage;
                      CaptionML=[ENU=Show/Hide Tasks;
                                 DEA=Zeige/Verstecke Tasks];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ToggleBreakpoint;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 TaskSubpageVisible := NOT TaskSubpageVisible;
                               END;
                                }
      { 1000000019;1 ;Action    ;
                      Name=PrevWeek;
                      CaptionML=[ENU=Previous Week;
                                 DEA=Vorherige Woche];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF NOT Webclient THEN
                                   CurrPage.CalendarSubpage.PAGE.CalendarPrevWeek()
                                 ELSE
                                   CurrPage.CalendarSubpage2.PAGE.CalendarPrevWeek();
                               END;
                                }
      { 1000000018;1 ;Action    ;
                      Name=NextWeek;
                      CaptionML=[ENU=Next Week;
                                 DEA=N„chste Woche];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 IF NOT Webclient THEN
                                   CurrPage.CalendarSubpage.PAGE.CalendarNextWeek()
                                 ELSE
                                   CurrPage.CalendarSubpage2.PAGE.CalendarNextWeek();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000012;1;Group  ;
                Name=Filters;
                CaptionML=[ENU=Filters;
                           DEA=Filter];
                GroupType=Group }

    { 1000000003;2;Group  ;
                GroupType=GridLayout }

    { 1000000007;3;Group  ;
                GroupType=Group }

    { 1000000004;4;Field  ;
                Name=UserFilter;
                CaptionML=[ENU=User;
                           DEA=Benutzer];
                SourceExpr=UserFilter;
                TableRelation="User Setup";
                OnValidate=BEGIN
                             UpdateCalendarSubpage();
                           END;
                            }

    { 1000000010;3;Group  ;
                GroupType=Group }

    { 1000000005;4;Field  ;
                Name=ObjectTypeFilter;
                CaptionML=[ENU=Objecttyle;
                           DEA=Objektart];
                SourceExpr=ObjectTypeFilter;
                OnValidate=BEGIN
                             UpdateCalendarSubpage();
                           END;
                            }

    { 1000000008;3;Group  ;
                GroupType=Group }

    { 1000000006;4;Field  ;
                Name=ObjectNoFilter;
                CaptionML=[ENU=Object No.;
                           DEA=Objektnr.];
                SourceExpr=ObjectNoFilter;
                OnValidate=VAR
                             CMObject@1000000000 : Record 70020;
                           BEGIN
                             ObjectNoFilter := CMGenMgt.DoUniversalLookup(ObjectTypeFilter, '', '', ObjectNoFilter, '');

                             ObjectName := '';
                             IF CMObject.GET(ObjectTypeFilter, ObjectNoFilter) THEN
                               ObjectName := CMObject.Name;

                             UpdateCalendarSubpage();
                           END;
                            }

    { 1000000011;3;Group  ;
                GroupType=Group }

    { 1000000009;4;Field  ;
                Name=ObjectName;
                CaptionML=[ENU=Object Name;
                           DEA=Objektname];
                SourceExpr=ObjectName;
                Enabled=FALSE;
                Editable=FALSE;
                ShowCaption=No }

    { 1000000020;1;Group  ;
                Name=RTC;
                CaptionML=[ENU=Scheduling;
                           DEA=Scheduling];
                Visible=NOT Webclient;
                GroupType=Group }

    { 1000000001;2;Part   ;
                Name=TasksSubpage;
                PagePartID=Page70095;
                Visible=TaskSubpageVisible;
                PartType=Page }

    { 1000000002;2;Part   ;
                Name=CalendarSubpage;
                PagePartID=Page70096;
                PartType=Page }

    { 1000000014;1;Group  ;
                Name=Tasks;
                Visible=Webclient AND TaskSubpageVisible;
                GroupType=Group }

    { 1000000016;2;Part   ;
                Name=TasksSubpage2;
                CaptionML=ENU=Tasks;
                PagePartID=Page70095;
                PartType=Page }

    { 1000000023;1;Group  ;
                Name=Calendar;
                CaptionML=[ENU=Scheduling Calendar;
                           DEA=Planungskalender];
                Visible=Webclient;
                GroupType=Group }

    { 1000000015;2;Part   ;
                Name=CalendarSubpage2;
                CaptionML=ENU=Calendar;
                PagePartID=Page70097;
                Visible=Webclient;
                PartType=Page }

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=CMMS Scheduling Tool';
      UserFilter@1000000003 : Text;
      ObjectTypeFilter@1000000002 : 'Asset,Project';
      ObjectNoFilter@1000000001 : Text;
      ObjectName@1000000005 : Text;
      CMGenMgt@1000000004 : Codeunit 70000;
      TaskSubpageVisible@1000000006 : Boolean INDATASET;
      CalendarSubpageVisible@1000000007 : Boolean INDATASET;
      Webclient@1000000010 : Boolean INDATASET;
      Mode@1000000008 : 'Week,Month';
      Mode2@1000000009 : 'User,Object';

    LOCAL PROCEDURE UpdateCalendarSubpage@1000000000();
    BEGIN
      IF NOT Webclient THEN
        CurrPage.CalendarSubpage.PAGE.SetFilterValues(UserFilter, ObjectTypeFilter, ObjectNoFilter)
      ELSE
        CurrPage.CalendarSubpage2.PAGE.SetFilterValues(UserFilter, ObjectTypeFilter, ObjectNoFilter)
    END;

    LOCAL PROCEDURE UpdateTaskSubpage@1000000017();
    BEGIN
      IF NOT Webclient THEN
        CurrPage.TasksSubpage.PAGE.Reload()
      ELSE
        CurrPage.TasksSubpage2.PAGE.Reload();
    END;

    LOCAL PROCEDURE Inc@1000000001(value@1000000000 : Integer) : Integer;
    BEGIN
      value += 1;
      EXIT(value MOD 2);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70095 CMMS Sched. Tool Task Subpage
{
  OBJECT-PROPERTIES
  {
    Date=23.03.18;
    Time=12:38:36;
    Modified=Yes;
    Version List=CMMS,SCT;
  }
  PROPERTIES
  {
    Editable=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5080;
    SourceTableView=SORTING(CM Type,CM Subtype,CM Status,CM Scheduled Date,Priority)
                    ORDER(Descending)
                    WHERE(CM Type=CONST(Task),
                          CM Subtype=CONST(" "),
                          CM Status=CONST(Open));
    PageType=ListPart;
    OnInit=BEGIN
             //Sometimes this needs very long, so we are loading this only once at startup
             CMGenMgt.SetFilterUniversalLookup(0, '', '', '', '', CMObject);
           END;

    OnAfterGetRecord=BEGIN
                       DueDateStyle := GetDueDateStyle();
                     END;

    ActionList=ACTIONS
    {
      { 1000000008;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000009;1 ;Action    ;
                      Name=ScheduleTask;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Schedule Task;
                                 DEA=Aufgabe Planen];
                      Image=Apply;
                      OnAction=BEGIN
                                 IF CMSctMgt.ScheduleTask(Rec) THEN
                                   Reload();
                               END;
                                }
      { 1000000010;1 ;Action    ;
                      Name=TaskCard;
                      CaptionML=[ENU=Task Card;
                                 DEA=Aufgabenkarte];
                      Image=View;
                      OnAction=BEGIN
                                 CMTaskMgt.ShowTaskCard(Rec);
                               END;
                                }
      { 1000000011;1 ;Action    ;
                      Name=WorkorderCard;
                      CaptionML=[ENU=Workorder Card;
                                 DEA=Arbeitsauftragskarte];
                      Image=View;
                      OnAction=VAR
                                 Workorder@1000000000 : Record 5092;
                               BEGIN
                                 IF Workorder.GET(Rec."Opportunity No.") THEN
                                   CMWoMgt.ShowWorkorderCard(Workorder);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000012;2;Field  ;
                SourceExpr="CM Object No." }

    { 1000000013;2;Field  ;
                SourceExpr="Opportunity No." }

    { 1000000002;2;Field  ;
                SourceExpr="No.";
                OnAssistEdit=BEGIN
                               IF CMSctMgt.ScheduleTask(Rec) THEN
                                 Reload();
                             END;
                              }

    { 1000000003;2;Field  ;
                SourceExpr=Description;
                OnAssistEdit=BEGIN
                               IF CMSctMgt.ScheduleTask(Rec) THEN
                                 Reload();
                             END;
                              }

    { 1000000004;2;Field  ;
                SourceExpr=Priority }

    { 1000000007;2;Field  ;
                SourceExpr="CM Due Date";
                StyleExpr=DueDateStyle }

    { 1000000005;2;Field  ;
                SourceExpr="CM Scheduled Date" }

    { 1000000006;2;Field  ;
                SourceExpr="CM Assigned User ID" }

  }
  CODE
  {
    VAR
      CMSctMgt@1000000000 : Codeunit 70029;
      CMTaskMgt@1000000001 : Codeunit 70031;
      CMWoMgt@1000000002 : Codeunit 70030;
      CMGenMgt@1000000004 : Codeunit 70000;
      CMObject@1000000003 : Record 70020;
      DueDateStyle@1000000005 : Text[20] INDATASET;

    PROCEDURE Reload@1000000000();
    BEGIN
      CMSctMgt.GetUnscheduledTasks(Rec, CMObject);
      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE GetDueDateStyle@1000000001() : Text;
    BEGIN
      IF Rec."CM Due Date" <= TODAY THEN
        EXIT('Unfavorable');
      IF Rec."CM Due Date" <= CALCDATE('<+CW>') THEN
        EXIT('Ambiguous');
      EXIT('');
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70096 CMMS Sch. Tool Calend. Subpage
{
  OBJECT-PROPERTIES
  {
    Date=12.01.18;
    Time=11:25:13;
    Modified=Yes;
    Version List=CMMS,SCT;
  }
  PROPERTIES
  {
    Editable=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table50002;
    SourceTableView=SORTING(SourceNo1,SourceNo2,PostingDate1,EntryNo1);
    PageType=ListPart;
    SourceTableTemporary=Yes;
    OnOpenPage=BEGIN
                 AdditionalInfoVisible := TRUE;
               END;

    OnAfterGetRecord=BEGIN
                       CMSctMgt.LoadRecordData(Rec, Values, Styles, MainStyle, Level, StartDate, 0);
                       MapStyle();
                     END;

    ActionList=ACTIONS
    {
      { 1000000012;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000013;1 ;Action    ;
                      Name=AdditionalInfoVisible;
                      CaptionML=[ENU=Show/Hide Additional Info;
                                 DEA=Zusatzinfos Ein/Ausblenden];
                      Image=ToggleBreakpoint;
                      OnAction=BEGIN
                                 AdditionalInfoVisible := NOT AdditionalInfoVisible;
                               END;
                                }
      { 1000000004;1 ;Action    ;
                      Name=CalendarWeek;
                      CaptionML=[ENU=Show Week;
                                 DEA=Zeige Woche];
                      Image=Calendar;
                      OnAction=BEGIN
                                 Mode := Mode::Week;
                                 Reload();
                               END;
                                }
      { 1000000006;1 ;Action    ;
                      Name=CalendarMonth;
                      CaptionML=[ENU=Show Month;
                                 DEA=Zeige Monat];
                      Image=Calendar;
                      OnAction=BEGIN
                                 Mode := Mode::Month;
                                 Reload();
                               END;
                                }
      { 1000000007;1 ;Action    ;
                      Name=CalendarUser;
                      CaptionML=[ENU=Show Users;
                                 DEA=Zeige Benutzer];
                      Image=CalendarWorkcenter;
                      OnAction=BEGIN
                                 Mode2 := Mode2::User;
                                 Reload();
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=CalendarObject;
                      CaptionML=[ENU=Show Assets/Projects;
                                 DEA=Zeige Anlagen/Projekte];
                      Image=CalendarWorkcenter;
                      OnAction=BEGIN
                                 Mode2 := Mode2::Object;
                                 Reload();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=RTC;
                IndentationColumnName=Level;
                IndentationControls=Dummy;
                ShowAsTree=Yes;
                GroupType=Repeater;
                FreezeColumnID=Text2 }

    { 1000000003;2;Field  ;
                Name=Dummy;
                SourceExpr='';
                Visible=FALSE }

    { 1000000002;2;Field  ;
                Name=Text1;
                SourceExpr=SourceNo1;
                CaptionClass=MainCaptions[1];
                StyleExpr=MainStyle }

    { 1000000011;2;Field  ;
                Name=Text2;
                SourceExpr=Text1;
                CaptionClass=MainCaptions[2];
                Visible=AdditionalInfoVisible;
                StyleExpr=MainStyle }

    { 1000000905;2;Field  ;
                Name=Value1;
                SourceExpr=Values[1];
                CaptionClass='3,' + Captions[1];
                Visible=Visible1;
                StyleExpr=Style1;
                OnAssistEdit=BEGIN
                               DoAssistEdit(1);
                             END;
                              }

    { 1000000906;2;Field  ;
                Name=Value2;
                SourceExpr=Values[2];
                CaptionClass='3,' + Captions[2];
                Visible=Visible2;
                StyleExpr=Style2;
                OnAssistEdit=BEGIN
                               DoAssistEdit(2);
                             END;
                              }

    { 1000000908;2;Field  ;
                Name=Value3;
                SourceExpr=Values[3];
                CaptionClass='3,' + Captions[3];
                Visible=Visible3;
                StyleExpr=Style3;
                OnAssistEdit=BEGIN
                               DoAssistEdit(3);
                             END;
                              }

    { 1000000909;2;Field  ;
                Name=Value4;
                SourceExpr=Values[4];
                CaptionClass='3,' + Captions[4];
                Visible=Visible4;
                StyleExpr=Style4;
                OnAssistEdit=BEGIN
                               DoAssistEdit(4);
                             END;
                              }

    { 1000000911;2;Field  ;
                Name=Value5;
                SourceExpr=Values[5];
                CaptionClass='3,' + Captions[5];
                Visible=Visible5;
                StyleExpr=Style5;
                OnAssistEdit=BEGIN
                               DoAssistEdit(5);
                             END;
                              }

    { 1000000912;2;Field  ;
                Name=Value6;
                SourceExpr=Values[6];
                CaptionClass='3,' + Captions[6];
                Visible=Visible6;
                StyleExpr=Style6;
                OnAssistEdit=BEGIN
                               DoAssistEdit(6);
                             END;
                              }

    { 1000000913;2;Field  ;
                Name=Value7;
                SourceExpr=Values[7];
                CaptionClass='3,' + Captions[7];
                Visible=Visible7;
                StyleExpr=Style7;
                OnAssistEdit=BEGIN
                               DoAssistEdit(7);
                             END;
                              }

    { 1000000914;2;Field  ;
                Name=Value8;
                SourceExpr=Values[8];
                CaptionClass='3,' + Captions[8];
                Visible=Visible8;
                StyleExpr=Style8;
                OnAssistEdit=BEGIN
                               DoAssistEdit(8);
                             END;
                              }

    { 1000000915;2;Field  ;
                Name=Value9;
                SourceExpr=Values[9];
                CaptionClass='3,' + Captions[9];
                Visible=Visible9;
                StyleExpr=Style9;
                OnAssistEdit=BEGIN
                               DoAssistEdit(9);
                             END;
                              }

    { 1000000916;2;Field  ;
                Name=Value10;
                SourceExpr=Values[10];
                CaptionClass='3,' + Captions[10];
                Visible=Visible10;
                StyleExpr=Style10;
                OnAssistEdit=BEGIN
                               DoAssistEdit(10);
                             END;
                              }

    { 1000000917;2;Field  ;
                Name=Value11;
                SourceExpr=Values[11];
                CaptionClass='3,' + Captions[11];
                Visible=Visible11;
                StyleExpr=Style11;
                OnAssistEdit=BEGIN
                               DoAssistEdit(11);
                             END;
                              }

    { 1000000918;2;Field  ;
                Name=Value12;
                SourceExpr=Values[12];
                CaptionClass='3,' + Captions[12];
                Visible=Visible12;
                StyleExpr=Style12;
                OnAssistEdit=BEGIN
                               DoAssistEdit(12);
                             END;
                              }

    { 1000000919;2;Field  ;
                Name=Value13;
                SourceExpr=Values[13];
                CaptionClass='3,' + Captions[13];
                Visible=Visible13;
                StyleExpr=Style13;
                OnAssistEdit=BEGIN
                               DoAssistEdit(13);
                             END;
                              }

    { 1000000920;2;Field  ;
                Name=Value14;
                SourceExpr=Values[14];
                CaptionClass='3,' + Captions[14];
                Visible=Visible14;
                StyleExpr=Style14;
                OnAssistEdit=BEGIN
                               DoAssistEdit(14);
                             END;
                              }

    { 1000000921;2;Field  ;
                Name=Value15;
                SourceExpr=Values[15];
                CaptionClass='3,' + Captions[15];
                Visible=Visible15;
                StyleExpr=Style15;
                OnAssistEdit=BEGIN
                               DoAssistEdit(15);
                             END;
                              }

    { 1000000922;2;Field  ;
                Name=Value16;
                SourceExpr=Values[16];
                CaptionClass='3,' + Captions[16];
                Visible=Visible16;
                StyleExpr=Style16;
                OnAssistEdit=BEGIN
                               DoAssistEdit(16);
                             END;
                              }

    { 1000000923;2;Field  ;
                Name=Value17;
                SourceExpr=Values[17];
                CaptionClass='3,' + Captions[17];
                Visible=Visible17;
                StyleExpr=Style17;
                OnAssistEdit=BEGIN
                               DoAssistEdit(17);
                             END;
                              }

    { 1000000924;2;Field  ;
                Name=Value18;
                SourceExpr=Values[18];
                CaptionClass='3,' + Captions[18];
                Visible=Visible18;
                StyleExpr=Style18;
                OnAssistEdit=BEGIN
                               DoAssistEdit(18);
                             END;
                              }

    { 1000000925;2;Field  ;
                Name=Value19;
                SourceExpr=Values[19];
                CaptionClass='3,' + Captions[19];
                Visible=Visible19;
                StyleExpr=Style19;
                OnAssistEdit=BEGIN
                               DoAssistEdit(19);
                             END;
                              }

    { 1000000926;2;Field  ;
                Name=Value20;
                SourceExpr=Values[20];
                CaptionClass='3,' + Captions[20];
                Visible=Visible20;
                StyleExpr=Style20;
                OnAssistEdit=BEGIN
                               DoAssistEdit(20);
                             END;
                              }

    { 1000000927;2;Field  ;
                Name=Value21;
                SourceExpr=Values[21];
                CaptionClass='3,' + Captions[21];
                Visible=Visible21;
                StyleExpr=Style21;
                OnAssistEdit=BEGIN
                               DoAssistEdit(21);
                             END;
                              }

    { 1000000928;2;Field  ;
                Name=Value22;
                SourceExpr=Values[22];
                CaptionClass='3,' + Captions[22];
                Visible=Visible22;
                StyleExpr=Style22;
                OnAssistEdit=BEGIN
                               DoAssistEdit(22);
                             END;
                              }

    { 1000000929;2;Field  ;
                Name=Value23;
                SourceExpr=Values[23];
                CaptionClass='3,' + Captions[23];
                Visible=Visible23;
                StyleExpr=Style23;
                OnAssistEdit=BEGIN
                               DoAssistEdit(23);
                             END;
                              }

    { 1000000930;2;Field  ;
                Name=Value24;
                SourceExpr=Values[24];
                CaptionClass='3,' + Captions[24];
                Visible=Visible24;
                StyleExpr=Style24;
                OnAssistEdit=BEGIN
                               DoAssistEdit(24);
                             END;
                              }

    { 1000000931;2;Field  ;
                Name=Value25;
                SourceExpr=Values[25];
                CaptionClass='3,' + Captions[25];
                Visible=Visible25;
                StyleExpr=Style25;
                OnAssistEdit=BEGIN
                               DoAssistEdit(25);
                             END;
                              }

    { 1000000932;2;Field  ;
                Name=Value26;
                SourceExpr=Values[26];
                CaptionClass='3,' + Captions[26];
                Visible=Visible26;
                StyleExpr=Style26;
                OnAssistEdit=BEGIN
                               DoAssistEdit(26);
                             END;
                              }

    { 1000000933;2;Field  ;
                Name=Value27;
                SourceExpr=Values[27];
                CaptionClass='3,' + Captions[27];
                Visible=Visible27;
                StyleExpr=Style27;
                OnAssistEdit=BEGIN
                               DoAssistEdit(27);
                             END;
                              }

    { 1000000934;2;Field  ;
                Name=Value28;
                SourceExpr=Values[28];
                CaptionClass='3,' + Captions[28];
                Visible=Visible28;
                StyleExpr=Style28;
                OnAssistEdit=BEGIN
                               DoAssistEdit(28);
                             END;
                              }

    { 1000000935;2;Field  ;
                Name=Value29;
                SourceExpr=Values[29];
                CaptionClass='3,' + Captions[29];
                Visible=Visible29;
                StyleExpr=Style29;
                OnAssistEdit=BEGIN
                               DoAssistEdit(29);
                             END;
                              }

    { 1000000936;2;Field  ;
                Name=Value30;
                SourceExpr=Values[30];
                CaptionClass='3,' + Captions[30];
                Visible=Visible30;
                StyleExpr=Style30;
                OnAssistEdit=BEGIN
                               DoAssistEdit(30);
                             END;
                              }

    { 1000000937;2;Field  ;
                Name=Value31;
                SourceExpr=Values[31];
                CaptionClass='3,' + Captions[31];
                Visible=Visible31;
                StyleExpr=Style31;
                OnAssistEdit=BEGIN
                               DoAssistEdit(31);
                             END;
                              }

  }
  CODE
  {
    VAR
      Values@1000000000 : ARRAY [31] OF Text;
      Captions@1000000001 : ARRAY [31] OF Text;
      MainCaptions@1000000076 : ARRAY [2] OF Text;
      Styles@1000000003 : ARRAY [31] OF Text;
      Visibles@1000000073 : ARRAY [31] OF Boolean;
      Style1@1000000004 : Text INDATASET;
      Style2@1000000005 : Text INDATASET;
      Style3@1000000006 : Text INDATASET;
      Style4@1000000007 : Text INDATASET;
      Style5@1000000008 : Text INDATASET;
      Style6@1000000009 : Text INDATASET;
      Style7@1000000010 : Text INDATASET;
      Style8@1000000024 : Text INDATASET;
      Style9@1000000023 : Text INDATASET;
      Style10@1000000022 : Text INDATASET;
      Style11@1000000021 : Text INDATASET;
      Style12@1000000020 : Text INDATASET;
      Style13@1000000019 : Text INDATASET;
      Style14@1000000018 : Text INDATASET;
      Style15@1000000031 : Text INDATASET;
      Style16@1000000030 : Text INDATASET;
      Style17@1000000029 : Text INDATASET;
      Style18@1000000028 : Text INDATASET;
      Style19@1000000027 : Text INDATASET;
      Style20@1000000026 : Text INDATASET;
      Style21@1000000025 : Text INDATASET;
      Style22@1000000038 : Text INDATASET;
      Style23@1000000037 : Text INDATASET;
      Style24@1000000036 : Text INDATASET;
      Style25@1000000035 : Text INDATASET;
      Style26@1000000041 : Text INDATASET;
      Style27@1000000034 : Text INDATASET;
      Style28@1000000033 : Text INDATASET;
      Style29@1000000032 : Text INDATASET;
      Style30@1000000040 : Text INDATASET;
      Style31@1000000039 : Text INDATASET;
      Visible1@1000000050 : Boolean INDATASET;
      Visible2@1000000049 : Boolean INDATASET;
      Visible3@1000000048 : Boolean INDATASET;
      Visible4@1000000047 : Boolean INDATASET;
      Visible5@1000000046 : Boolean INDATASET;
      Visible6@1000000045 : Boolean INDATASET;
      Visible7@1000000044 : Boolean INDATASET;
      Visible8@1000000043 : Boolean INDATASET;
      Visible9@1000000042 : Boolean INDATASET;
      Visible10@1000000060 : Boolean INDATASET;
      Visible11@1000000059 : Boolean INDATASET;
      Visible12@1000000058 : Boolean INDATASET;
      Visible13@1000000057 : Boolean INDATASET;
      Visible14@1000000056 : Boolean INDATASET;
      Visible15@1000000055 : Boolean INDATASET;
      Visible16@1000000054 : Boolean INDATASET;
      Visible17@1000000053 : Boolean INDATASET;
      Visible18@1000000052 : Boolean INDATASET;
      Visible19@1000000051 : Boolean INDATASET;
      Visible20@1000000063 : Boolean INDATASET;
      Visible21@1000000072 : Boolean INDATASET;
      Visible22@1000000071 : Boolean INDATASET;
      Visible23@1000000070 : Boolean INDATASET;
      Visible24@1000000069 : Boolean INDATASET;
      Visible25@1000000068 : Boolean INDATASET;
      Visible26@1000000067 : Boolean INDATASET;
      Visible27@1000000066 : Boolean INDATASET;
      Visible28@1000000065 : Boolean INDATASET;
      Visible29@1000000064 : Boolean INDATASET;
      Visible30@1000000062 : Boolean INDATASET;
      Visible31@1000000061 : Boolean INDATASET;
      MainStyle@1000000011 : Text INDATASET;
      Level@1000000012 : Integer INDATASET;
      UserFilter@1000000015 : Text;
      ObjectTypeFilter@1000000014 : Integer;
      ObjectNoFilter@1000000013 : Text;
      Mode@1000000075 : 'Week,Month';
      Mode2@1000000074 : 'User,Object';
      StartDate@1000000016 : Date;
      AdditionalInfoVisible@1000000017 : Boolean INDATASET;
      CMSctMgt@1000000002 : Codeunit 70029;

    PROCEDURE SetFilterValues@1000000000(UserFilter_@1000000000 : Text;ObjectTypeFilter_@1000000001 : Integer;ObjectNoFilter_@1000000002 : Text);
    BEGIN
      UserFilter := UserFilter_;
      ObjectTypeFilter := ObjectTypeFilter_;
      ObjectNoFilter := ObjectNoFilter_;
      Reload();
    END;

    PROCEDURE CalendarNextWeek@1000000003();
    BEGIN
      StartDate := CALCDATE('<-CW+1W>', StartDate);
      Reload();
    END;

    PROCEDURE CalendarPrevWeek@1000000005();
    BEGIN
      StartDate := CALCDATE('<-CW-1W>', StartDate);
      Reload();
    END;

    LOCAL PROCEDURE DoAssistEdit@1000000006(No@1000000000 : Integer);
    VAR
      RefDate@1000000001 : Date;
    BEGIN
      RefDate := CALCDATE(STRSUBSTNO('<+%1D>', No - 1), StartDate);
      CMSctMgt.ScheduleCalendarEntry(Rec, RefDate, No);
      Reload();
    END;

    PROCEDURE Reload@1000000002();
    BEGIN
      IF StartDate = 0D THEN
        StartDate := CALCDATE('<-CW>', TODAY);
        //StartDate := 181217D;

      CMSctMgt.LoadRecords
      (
        Rec,
        Captions,
        MainCaptions,
        Visibles,
        Mode,
        Mode2,
        StartDate,
        UserFilter,
        ObjectTypeFilter,
        ObjectNoFilter
      );

      MapVisibles();

      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE MapStyle@1000000001();
    BEGIN
      Style1 := Styles[1];
      Style2 := Styles[2];
      Style3 := Styles[3];
      Style4 := Styles[4];
      Style5 := Styles[5];
      Style6 := Styles[6];
      Style7 := Styles[7];
      Style8 := Styles[8];
      Style9 := Styles[9];
      Style10 := Styles[10];
      Style11 := Styles[11];
      Style12 := Styles[12];
      Style13 := Styles[13];
      Style14 := Styles[14];
      Style15 := Styles[15];
      Style16 := Styles[16];
      Style17 := Styles[17];
      Style18 := Styles[18];
      Style19 := Styles[19];
      Style20 := Styles[20];
      Style21 := Styles[21];
      Style22 := Styles[22];
      Style23 := Styles[23];
      Style24 := Styles[24];
      Style25 := Styles[25];
      Style26 := Styles[26];
      Style27 := Styles[27];
      Style28 := Styles[28];
      Style29 := Styles[29];
      Style30 := Styles[30];
      Style31 := Styles[31];
    END;

    LOCAL PROCEDURE MapVisibles@1000000004();
    BEGIN
      Visible1 := Visibles[1];
      Visible2 := Visibles[2];
      Visible3 := Visibles[3];
      Visible4 := Visibles[4];
      Visible5 := Visibles[5];
      Visible6 := Visibles[6];
      Visible7 := Visibles[7];
      Visible8 := Visibles[8];
      Visible9 := Visibles[9];
      Visible10 := Visibles[10];
      Visible11 := Visibles[11];
      Visible12 := Visibles[12];
      Visible13 := Visibles[13];
      Visible14 := Visibles[14];
      Visible15 := Visibles[15];
      Visible16 := Visibles[16];
      Visible17 := Visibles[17];
      Visible18 := Visibles[18];
      Visible19 := Visibles[19];
      Visible20 := Visibles[20];
      Visible21 := Visibles[21];
      Visible22 := Visibles[22];
      Visible23 := Visibles[23];
      Visible24 := Visibles[24];
      Visible25 := Visibles[25];
      Visible26 := Visibles[26];
      Visible27 := Visibles[27];
      Visible28 := Visibles[28];
      Visible29 := Visibles[29];
      Visible30 := Visibles[30];
      Visible31 := Visibles[31];
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70097 CMMS Sch. Tool Calend. Web
{
  OBJECT-PROPERTIES
  {
    Date=05.01.18;
    Time=13:11:32;
    Modified=Yes;
    Version List=CMMS,SCT;
  }
  PROPERTIES
  {
    Editable=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table50002;
    SourceTableView=SORTING(SourceNo1,SourceNo2,PostingDate1,EntryNo1);
    PageType=ListPart;
    SourceTableTemporary=Yes;
    OnOpenPage=BEGIN
                 AdditionalInfoVisible := TRUE;
               END;

    OnAfterGetRecord=BEGIN
                       CMSctMgt.LoadRecordData(Rec, Values, Styles, MainStyle, Level, StartDate, 0);
                       MapStyle();
                     END;

    ActionList=ACTIONS
    {
      { 1000000012;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000013;1 ;Action    ;
                      Name=AdditionalInfoVisible;
                      CaptionML=[ENU=Show/Hide Additional Info;
                                 DEA=Zusatzinfos Ein/Ausblenden];
                      Image=ToggleBreakpoint;
                      OnAction=BEGIN
                                 AdditionalInfoVisible := NOT AdditionalInfoVisible;
                               END;
                                }
      { 1000000004;1 ;Action    ;
                      Name=CalendarWeek;
                      CaptionML=[ENU=Show Week;
                                 DEA=Zeige Woche];
                      Image=Calendar;
                      OnAction=BEGIN
                                 Mode := Mode::Week;
                                 Reload();
                               END;
                                }
      { 1000000006;1 ;Action    ;
                      Name=CalendarMonth;
                      CaptionML=[ENU=Show Month;
                                 DEA=Zeige Monat];
                      Image=Calendar;
                      OnAction=BEGIN
                                 Mode := Mode::Month;
                                 Reload();
                               END;
                                }
      { 1000000007;1 ;Action    ;
                      Name=CalendarUser;
                      CaptionML=[ENU=Show Users;
                                 DEA=Zeige Benutzer];
                      Image=CalendarWorkcenter;
                      OnAction=BEGIN
                                 Mode2 := Mode2::User;
                                 Reload();
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=CalendarObject;
                      CaptionML=[ENU=Show Assets/Projects;
                                 DEA=Zeige Anlagen/Projekte];
                      Image=CalendarWorkcenter;
                      OnAction=BEGIN
                                 Mode2 := Mode2::Object;
                                 Reload();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                IndentationColumnName=Level;
                IndentationControls=Dummy,Text1,Text2;
                GroupType=Repeater }

    { 1000000003;2;Field  ;
                Name=Dummy;
                SourceExpr='';
                Visible=FALSE }

    { 1000000002;2;Field  ;
                Name=Text1;
                SourceExpr=SourceNo1;
                CaptionClass=MainCaptions[1];
                StyleExpr=MainStyle }

    { 1000000011;2;Field  ;
                Name=Text2;
                SourceExpr=Text1;
                CaptionClass=MainCaptions[2];
                Visible=AdditionalInfoVisible;
                StyleExpr=MainStyle }

    { 1000000905;2;Field  ;
                Name=Value1;
                SourceExpr=Values[1];
                CaptionClass='3,' + Captions[1];
                Visible=Visible1;
                StyleExpr=Style1;
                OnAssistEdit=BEGIN
                               DoAssistEdit(1);
                             END;
                              }

    { 1000000906;2;Field  ;
                Name=Value2;
                SourceExpr=Values[2];
                CaptionClass='3,' + Captions[2];
                Visible=Visible2;
                StyleExpr=Style2;
                OnAssistEdit=BEGIN
                               DoAssistEdit(2);
                             END;
                              }

    { 1000000908;2;Field  ;
                Name=Value3;
                SourceExpr=Values[3];
                CaptionClass='3,' + Captions[3];
                Visible=Visible3;
                StyleExpr=Style3;
                OnAssistEdit=BEGIN
                               DoAssistEdit(3);
                             END;
                              }

    { 1000000909;2;Field  ;
                Name=Value4;
                SourceExpr=Values[4];
                CaptionClass='3,' + Captions[4];
                Visible=Visible4;
                StyleExpr=Style4;
                OnAssistEdit=BEGIN
                               DoAssistEdit(4);
                             END;
                              }

    { 1000000911;2;Field  ;
                Name=Value5;
                SourceExpr=Values[5];
                CaptionClass='3,' + Captions[5];
                Visible=Visible5;
                StyleExpr=Style5;
                OnAssistEdit=BEGIN
                               DoAssistEdit(5);
                             END;
                              }

    { 1000000912;2;Field  ;
                Name=Value6;
                SourceExpr=Values[6];
                CaptionClass='3,' + Captions[6];
                Visible=Visible6;
                StyleExpr=Style6;
                OnAssistEdit=BEGIN
                               DoAssistEdit(6);
                             END;
                              }

    { 1000000913;2;Field  ;
                Name=Value7;
                SourceExpr=Values[7];
                CaptionClass='3,' + Captions[7];
                Visible=Visible7;
                StyleExpr=Style7;
                OnAssistEdit=BEGIN
                               DoAssistEdit(7);
                             END;
                              }

    { 1000000914;2;Field  ;
                Name=Value8;
                SourceExpr=Values[8];
                CaptionClass='3,' + Captions[8];
                Visible=Visible8;
                StyleExpr=Style8;
                OnAssistEdit=BEGIN
                               DoAssistEdit(8);
                             END;
                              }

    { 1000000915;2;Field  ;
                Name=Value9;
                SourceExpr=Values[9];
                CaptionClass='3,' + Captions[9];
                Visible=Visible9;
                StyleExpr=Style9;
                OnAssistEdit=BEGIN
                               DoAssistEdit(9);
                             END;
                              }

    { 1000000916;2;Field  ;
                Name=Value10;
                SourceExpr=Values[10];
                CaptionClass='3,' + Captions[10];
                Visible=Visible10;
                StyleExpr=Style10;
                OnAssistEdit=BEGIN
                               DoAssistEdit(10);
                             END;
                              }

    { 1000000917;2;Field  ;
                Name=Value11;
                SourceExpr=Values[11];
                CaptionClass='3,' + Captions[11];
                Visible=Visible11;
                StyleExpr=Style11;
                OnAssistEdit=BEGIN
                               DoAssistEdit(11);
                             END;
                              }

    { 1000000918;2;Field  ;
                Name=Value12;
                SourceExpr=Values[12];
                CaptionClass='3,' + Captions[12];
                Visible=Visible12;
                StyleExpr=Style12;
                OnAssistEdit=BEGIN
                               DoAssistEdit(12);
                             END;
                              }

    { 1000000919;2;Field  ;
                Name=Value13;
                SourceExpr=Values[13];
                CaptionClass='3,' + Captions[13];
                Visible=Visible13;
                StyleExpr=Style13;
                OnAssistEdit=BEGIN
                               DoAssistEdit(13);
                             END;
                              }

    { 1000000920;2;Field  ;
                Name=Value14;
                SourceExpr=Values[14];
                CaptionClass='3,' + Captions[14];
                Visible=Visible14;
                StyleExpr=Style14;
                OnAssistEdit=BEGIN
                               DoAssistEdit(14);
                             END;
                              }

    { 1000000921;2;Field  ;
                Name=Value15;
                SourceExpr=Values[15];
                CaptionClass='3,' + Captions[15];
                Visible=Visible15;
                StyleExpr=Style15;
                OnAssistEdit=BEGIN
                               DoAssistEdit(15);
                             END;
                              }

    { 1000000922;2;Field  ;
                Name=Value16;
                SourceExpr=Values[16];
                CaptionClass='3,' + Captions[16];
                Visible=Visible16;
                StyleExpr=Style16;
                OnAssistEdit=BEGIN
                               DoAssistEdit(16);
                             END;
                              }

    { 1000000923;2;Field  ;
                Name=Value17;
                SourceExpr=Values[17];
                CaptionClass='3,' + Captions[17];
                Visible=Visible17;
                StyleExpr=Style17;
                OnAssistEdit=BEGIN
                               DoAssistEdit(17);
                             END;
                              }

    { 1000000924;2;Field  ;
                Name=Value18;
                SourceExpr=Values[18];
                CaptionClass='3,' + Captions[18];
                Visible=Visible18;
                StyleExpr=Style18;
                OnAssistEdit=BEGIN
                               DoAssistEdit(18);
                             END;
                              }

    { 1000000925;2;Field  ;
                Name=Value19;
                SourceExpr=Values[19];
                CaptionClass='3,' + Captions[19];
                Visible=Visible19;
                StyleExpr=Style19;
                OnAssistEdit=BEGIN
                               DoAssistEdit(19);
                             END;
                              }

    { 1000000926;2;Field  ;
                Name=Value20;
                SourceExpr=Values[20];
                CaptionClass='3,' + Captions[20];
                Visible=Visible20;
                StyleExpr=Style20;
                OnAssistEdit=BEGIN
                               DoAssistEdit(20);
                             END;
                              }

    { 1000000927;2;Field  ;
                Name=Value21;
                SourceExpr=Values[21];
                CaptionClass='3,' + Captions[21];
                Visible=Visible21;
                StyleExpr=Style21;
                OnAssistEdit=BEGIN
                               DoAssistEdit(21);
                             END;
                              }

    { 1000000928;2;Field  ;
                Name=Value22;
                SourceExpr=Values[22];
                CaptionClass='3,' + Captions[22];
                Visible=Visible22;
                StyleExpr=Style22;
                OnAssistEdit=BEGIN
                               DoAssistEdit(22);
                             END;
                              }

    { 1000000929;2;Field  ;
                Name=Value23;
                SourceExpr=Values[23];
                CaptionClass='3,' + Captions[23];
                Visible=Visible23;
                StyleExpr=Style23;
                OnAssistEdit=BEGIN
                               DoAssistEdit(23);
                             END;
                              }

    { 1000000930;2;Field  ;
                Name=Value24;
                SourceExpr=Values[24];
                CaptionClass='3,' + Captions[24];
                Visible=Visible24;
                StyleExpr=Style24;
                OnAssistEdit=BEGIN
                               DoAssistEdit(24);
                             END;
                              }

    { 1000000931;2;Field  ;
                Name=Value25;
                SourceExpr=Values[25];
                CaptionClass='3,' + Captions[25];
                Visible=Visible25;
                StyleExpr=Style25;
                OnAssistEdit=BEGIN
                               DoAssistEdit(25);
                             END;
                              }

    { 1000000932;2;Field  ;
                Name=Value26;
                SourceExpr=Values[26];
                CaptionClass='3,' + Captions[26];
                Visible=Visible26;
                StyleExpr=Style26;
                OnAssistEdit=BEGIN
                               DoAssistEdit(26);
                             END;
                              }

    { 1000000933;2;Field  ;
                Name=Value27;
                SourceExpr=Values[27];
                CaptionClass='3,' + Captions[27];
                Visible=Visible27;
                StyleExpr=Style27;
                OnAssistEdit=BEGIN
                               DoAssistEdit(27);
                             END;
                              }

    { 1000000934;2;Field  ;
                Name=Value28;
                SourceExpr=Values[28];
                CaptionClass='3,' + Captions[28];
                Visible=Visible28;
                StyleExpr=Style28;
                OnAssistEdit=BEGIN
                               DoAssistEdit(28);
                             END;
                              }

    { 1000000935;2;Field  ;
                Name=Value29;
                SourceExpr=Values[29];
                CaptionClass='3,' + Captions[29];
                Visible=Visible29;
                StyleExpr=Style29;
                OnAssistEdit=BEGIN
                               DoAssistEdit(29);
                             END;
                              }

    { 1000000936;2;Field  ;
                Name=Value30;
                SourceExpr=Values[30];
                CaptionClass='3,' + Captions[30];
                Visible=Visible30;
                StyleExpr=Style30;
                OnAssistEdit=BEGIN
                               DoAssistEdit(30);
                             END;
                              }

    { 1000000937;2;Field  ;
                Name=Value31;
                SourceExpr=Values[31];
                CaptionClass='3,' + Captions[31];
                Visible=Visible31;
                StyleExpr=Style31;
                OnAssistEdit=BEGIN
                               DoAssistEdit(31);
                             END;
                              }

  }
  CODE
  {
    VAR
      Values@1000000000 : ARRAY [31] OF Text;
      Captions@1000000001 : ARRAY [31] OF Text;
      MainCaptions@1000000076 : ARRAY [2] OF Text;
      Styles@1000000003 : ARRAY [31] OF Text;
      Visibles@1000000073 : ARRAY [31] OF Boolean;
      Style1@1000000004 : Text INDATASET;
      Style2@1000000005 : Text INDATASET;
      Style3@1000000006 : Text INDATASET;
      Style4@1000000007 : Text INDATASET;
      Style5@1000000008 : Text INDATASET;
      Style6@1000000009 : Text INDATASET;
      Style7@1000000010 : Text INDATASET;
      Style8@1000000024 : Text INDATASET;
      Style9@1000000023 : Text INDATASET;
      Style10@1000000022 : Text INDATASET;
      Style11@1000000021 : Text INDATASET;
      Style12@1000000020 : Text INDATASET;
      Style13@1000000019 : Text INDATASET;
      Style14@1000000018 : Text INDATASET;
      Style15@1000000031 : Text INDATASET;
      Style16@1000000030 : Text INDATASET;
      Style17@1000000029 : Text INDATASET;
      Style18@1000000028 : Text INDATASET;
      Style19@1000000027 : Text INDATASET;
      Style20@1000000026 : Text INDATASET;
      Style21@1000000025 : Text INDATASET;
      Style22@1000000038 : Text INDATASET;
      Style23@1000000037 : Text INDATASET;
      Style24@1000000036 : Text INDATASET;
      Style25@1000000035 : Text INDATASET;
      Style26@1000000041 : Text INDATASET;
      Style27@1000000034 : Text INDATASET;
      Style28@1000000033 : Text INDATASET;
      Style29@1000000032 : Text INDATASET;
      Style30@1000000040 : Text INDATASET;
      Style31@1000000039 : Text INDATASET;
      Visible1@1000000050 : Boolean INDATASET;
      Visible2@1000000049 : Boolean INDATASET;
      Visible3@1000000048 : Boolean INDATASET;
      Visible4@1000000047 : Boolean INDATASET;
      Visible5@1000000046 : Boolean INDATASET;
      Visible6@1000000045 : Boolean INDATASET;
      Visible7@1000000044 : Boolean INDATASET;
      Visible8@1000000043 : Boolean INDATASET;
      Visible9@1000000042 : Boolean INDATASET;
      Visible10@1000000060 : Boolean INDATASET;
      Visible11@1000000059 : Boolean INDATASET;
      Visible12@1000000058 : Boolean INDATASET;
      Visible13@1000000057 : Boolean INDATASET;
      Visible14@1000000056 : Boolean INDATASET;
      Visible15@1000000055 : Boolean INDATASET;
      Visible16@1000000054 : Boolean INDATASET;
      Visible17@1000000053 : Boolean INDATASET;
      Visible18@1000000052 : Boolean INDATASET;
      Visible19@1000000051 : Boolean INDATASET;
      Visible20@1000000063 : Boolean INDATASET;
      Visible21@1000000072 : Boolean INDATASET;
      Visible22@1000000071 : Boolean INDATASET;
      Visible23@1000000070 : Boolean INDATASET;
      Visible24@1000000069 : Boolean INDATASET;
      Visible25@1000000068 : Boolean INDATASET;
      Visible26@1000000067 : Boolean INDATASET;
      Visible27@1000000066 : Boolean INDATASET;
      Visible28@1000000065 : Boolean INDATASET;
      Visible29@1000000064 : Boolean INDATASET;
      Visible30@1000000062 : Boolean INDATASET;
      Visible31@1000000061 : Boolean INDATASET;
      MainStyle@1000000011 : Text INDATASET;
      Level@1000000012 : Integer INDATASET;
      UserFilter@1000000015 : Text;
      ObjectTypeFilter@1000000014 : Integer;
      ObjectNoFilter@1000000013 : Text;
      Mode@1000000075 : 'Week,Month';
      Mode2@1000000074 : 'User,Object';
      StartDate@1000000016 : Date;
      AdditionalInfoVisible@1000000017 : Boolean INDATASET;
      CMSctMgt@1000000002 : Codeunit 70029;

    PROCEDURE SetFilterValues@1000000000(UserFilter_@1000000000 : Text;ObjectTypeFilter_@1000000001 : Integer;ObjectNoFilter_@1000000002 : Text);
    BEGIN
      UserFilter := UserFilter_;
      ObjectTypeFilter := ObjectTypeFilter_;
      ObjectNoFilter := ObjectNoFilter_;
      Reload();
    END;

    PROCEDURE CalendarNextWeek@1000000003();
    BEGIN
      StartDate := CALCDATE('<-CW+1W>', StartDate);
      Reload();
    END;

    PROCEDURE CalendarPrevWeek@1000000005();
    BEGIN
      StartDate := CALCDATE('<-CW-1W>', StartDate);
      Reload();
    END;

    LOCAL PROCEDURE DoAssistEdit@1000000006(No@1000000000 : Integer);
    VAR
      RefDate@1000000001 : Date;
    BEGIN
      RefDate := CALCDATE(STRSUBSTNO('<+%1D>', No - 1), StartDate);
      CMSctMgt.ScheduleCalendarEntry(Rec, RefDate, No);
    END;

    PROCEDURE Reload@1000000002();
    BEGIN
      IF StartDate = 0D THEN
        StartDate := CALCDATE('<-CW>', TODAY);
        //StartDate := 181217D;

      CMSctMgt.LoadRecords
      (
        Rec,
        Captions,
        MainCaptions,
        Visibles,
        Mode,
        Mode2,
        StartDate,
        UserFilter,
        ObjectTypeFilter,
        ObjectNoFilter
      );

      MapVisibles();

      CurrPage.UPDATE(FALSE);
    END;

    LOCAL PROCEDURE MapStyle@1000000001();
    BEGIN
      Style1 := Styles[1];
      Style2 := Styles[2];
      Style3 := Styles[3];
      Style4 := Styles[4];
      Style5 := Styles[5];
      Style6 := Styles[6];
      Style7 := Styles[7];
      Style8 := Styles[8];
      Style9 := Styles[9];
      Style10 := Styles[10];
      Style11 := Styles[11];
      Style12 := Styles[12];
      Style13 := Styles[13];
      Style14 := Styles[14];
      Style15 := Styles[15];
      Style16 := Styles[16];
      Style17 := Styles[17];
      Style18 := Styles[18];
      Style19 := Styles[19];
      Style20 := Styles[20];
      Style21 := Styles[21];
      Style22 := Styles[22];
      Style23 := Styles[23];
      Style24 := Styles[24];
      Style25 := Styles[25];
      Style26 := Styles[26];
      Style27 := Styles[27];
      Style28 := Styles[28];
      Style29 := Styles[29];
      Style30 := Styles[30];
      Style31 := Styles[31];
    END;

    LOCAL PROCEDURE MapVisibles@1000000004();
    BEGIN
      Visible1 := Visibles[1];
      Visible2 := Visibles[2];
      Visible3 := Visibles[3];
      Visible4 := Visibles[4];
      Visible5 := Visibles[5];
      Visible6 := Visibles[6];
      Visible7 := Visibles[7];
      Visible8 := Visibles[8];
      Visible9 := Visibles[9];
      Visible10 := Visibles[10];
      Visible11 := Visibles[11];
      Visible12 := Visibles[12];
      Visible13 := Visibles[13];
      Visible14 := Visibles[14];
      Visible15 := Visibles[15];
      Visible16 := Visibles[16];
      Visible17 := Visibles[17];
      Visible18 := Visibles[18];
      Visible19 := Visibles[19];
      Visible20 := Visibles[20];
      Visible21 := Visibles[21];
      Visible22 := Visibles[22];
      Visible23 := Visibles[23];
      Visible24 := Visibles[24];
      Visible25 := Visibles[25];
      Visible26 := Visibles[26];
      Visible27 := Visibles[27];
      Visible28 := Visibles[28];
      Visible29 := Visibles[29];
      Visible30 := Visibles[30];
      Visible31 := Visibles[31];
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70098 CMMS Sch. Task Card
{
  OBJECT-PROPERTIES
  {
    Date=05.01.18;
    Time=12:08:17;
    Modified=Yes;
    Version List=CMMS,SCT;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table5080;
    PageType=StandardDialog;
    SourceTableTemporary=Yes;
    ShowFilter=No;
    OnOpenPage=BEGIN
                 IF NOT InitDone THEN
                   ERROR(Text001);
               END;

    OnAfterGetRecord=BEGIN
                       CALCFIELDS("CM Object Name");
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                GroupType=Group }

    { 1000000008;2;Group  ;
                Name=General;
                GroupType=Group }

    { 1000000002;3;Field  ;
                SourceExpr="No.";
                Editable=FALSE;
                OnLookup=VAR
                           Task@1000000000 : Record 5080;
                           TaskList@1000000001 : Page 70112;
                           CMObject@1000000003 : Record 70020;
                         BEGIN
                           IF Mode = Mode::SelectTask THEN BEGIN
                             CMGenMgt.SetFilterUniversalLookup(0, '', '', '', '', CMObject);

                             CMSctMgt.GetUnscheduledTasks(Task, CMObject);
                             TaskList.LOOKUPMODE(TRUE);
                             TaskList.SETTABLEVIEW(Task);
                             IF TaskList.RUNMODAL = ACTION::LookupOK THEN BEGIN
                               TaskList.GETRECORD(Task);
                               Rec."No." := Task."No.";
                             END;
                           END;

                           IF Mode = Mode::Default THEN BEGIN
                             IF Task.GET(Rec."No.") THEN
                               CMTaskMgt.ShowTaskCard(Task);
                           END;
                         END;
                          }

    { 1000000003;3;Field  ;
                SourceExpr=Description;
                Editable=FALSE }

    { 1000000004;3;Field  ;
                SourceExpr="CM Extended Description";
                Editable=FALSE }

    { 1000000011;2;Group  ;
                Name=User;
                GroupType=Group }

    { 1000000009;3;Field  ;
                SourceExpr="CM Assigned User ID" }

    { 1000000010;3;Field  ;
                SourceExpr="CM Assigned User Name";
                Editable=FALSE }

    { 1000000012;2;Group  ;
                Name=Scheduling;
                GroupType=Group }

    { 1000000005;3;Field  ;
                SourceExpr="CM Scheduled Date" }

    { 1000000006;3;Field  ;
                SourceExpr="CM Scheduled Time" }

    { 1000000007;3;Field  ;
                SourceExpr="CM Due Date" }

    { 1000000013;2;Group  ;
                Name=Extended;
                GroupType=Group }

    { 1000000018;3;Field  ;
                CaptionML=ENU=Workorder No.;
                SourceExpr="Opportunity No.";
                Editable=FALSE;
                OnLookup=BEGIN
                           IF Workorder.GET(Rec."Opportunity No.") THEN
                             CMWoMgt.ShowWorkorderCard(Workorder);
                         END;
                          }

    { 1000000017;3;Field  ;
                SourceExpr="CM Workorder Description";
                Editable=FALSE;
                OnLookup=BEGIN
                           IF Workorder.GET(Rec."Opportunity No.") THEN
                             CMWoMgt.ShowWorkorderCard(Workorder);
                         END;
                          }

    { 1000000016;3;Field  ;
                SourceExpr="CM Objecttype";
                Editable=FALSE }

    { 1000000015;3;Field  ;
                SourceExpr="CM Object No.";
                Editable=FALSE;
                OnLookup=BEGIN
                           IF CMObject.GET(Rec."CM Objecttype", Rec."CM Object No.") THEN BEGIN
                             RecRef.GETTABLE(CMObject);
                             CMAssetMgt.ShowAssetProjectCard(RecRef);
                           END;
                         END;
                          }

    { 1000000014;3;Field  ;
                SourceExpr="CM Object Name";
                Editable=FALSE;
                OnLookup=BEGIN
                           IF CMObject.GET(Rec."CM Objecttype", Rec."CM Object No.") THEN BEGIN
                             RecRef.GETTABLE(CMObject);
                             CMAssetMgt.ShowAssetProjectCard(RecRef);
                           END;
                         END;
                          }

  }
  CODE
  {
    VAR
      InitDone@1000000000 : Boolean;
      Text001@1000000001 : TextConst 'ENU=Invalid call. Call DoInit() first.;DEA=Ungltiger Aufruf. DoInit() muss zuerst aufgerufen werden.';
      Mode@1000000002 : 'Default,SelectTask';
      CMSctMgt@1000000003 : Codeunit 70029;
      CMGenMgt@1000000004 : Codeunit 70000;
      CMWoMgt@1000000007 : Codeunit 70030;
      CMAssetMgt@1000000008 : Codeunit 70020;
      CMTaskMgt@1000000011 : Codeunit 70031;
      Workorder@1000000005 : Record 5092;
      CMObject@1000000006 : Record 70020;
      RecRef@1000000009 : RecordRef;
      Task@1000000010 : Integer;

    PROCEDURE DoInit@1000000002(TempRec@1000000002 : Record 5080;Mode_@1000000001 : Integer);
    BEGIN
      TempRec.TESTFIELD("No.");
      Mode := Mode_;

      Rec := TempRec;
      Rec.INSERT();
      Rec.SETRECFILTER();

      IF Mode = Mode::Default THEN BEGIN

      END;
      IF Mode = Mode::SelectTask THEN BEGIN
        Rec."No." := '';
      END;

      InitDone := TRUE;
    END;

    PROCEDURE GetRec@1000000008(VAR TempRec@1000000000 : Record 5080);
    BEGIN
      TempRec := Rec;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70100 CMMS Workorder Card
{
  OBJECT-PROPERTIES
  {
    Date=09.04.18;
    Time=12:15:19;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Workorder;
               DEA=Arbeitsauftrag];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=Yes;
    SourceTable=Table5092;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(No.)
                    WHERE(CM Is Workorder=CONST(Yes));
    DataCaptionFields=Description;
    PageType=Card;
    PromotedActionCategoriesML=[ENU=New,Process,Report,Master Data,Extended,History;
                                DEA=Neu,Vorgang,Berichte,Masterdaten,Erweitert,Historie];
    OnOpenPage=BEGIN
                 __hideOnPhone := NOT ((CURRENTCLIENTTYPE = CLIENTTYPE::Phone) OR (CURRENTCLIENTTYPE = CLIENTTYPE::Tablet));
                 Rec.SETRANGE("CM Status");
               END;

    OnAfterGetRecord=BEGIN
                       SetEditable;
                       GetBlobValues();

                       CurrPage.CMContractInfobox.PAGE.SetAssetNo("CM Object No.");
                     END;

    OnNewRecord=BEGIN
                  Rec."CM Is Workorder" := TRUE;
                END;

    ActionList=ACTIONS
    {
      { 1000000010;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000008;1 ;Action    ;
                      Name=ChangeStatus;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Change &Status;
                                 DEA=S&tatus „ndern];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ChangeStatus;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 CMMSWOMgmt@1000000000 : Codeunit 70030;
                               BEGIN
                                 CurrPage.UPDATE;
                                 CMMSWOMgmt.ChangeStatusUI(Rec);
                               END;
                                }
      { 1000000016;1 ;Action    ;
                      Name=ChangeUser;
                      CaptionML=[ENU=Assign to new User;
                                 DEA=Neuen Benutzer Zuweisen];
                      Promoted=Yes;
                      Enabled=__edit;
                      PromotedIsBig=Yes;
                      Image=CoupledUsers;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMWoMgt.ChangeAssignedUserUI(Rec);
                                 CurrPage.UPDATE(TRUE);
                               END;
                                }
      { 1000000030;1 ;Action    ;
                      Name=AssignToAssetProject;
                      CaptionML=[ENU=Link to Asset/Project;
                                 DEA=Verlinken zu Anlage/Projekt];
                      Promoted=Yes;
                      Enabled=__edit;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMWoMgt.LinkToAssetProjectUI(Rec, TRUE);
                               END;
                                }
      { 1000000012;1 ;Action    ;
                      Name=NewTask;
                      CaptionML=[ENU=New Task;
                                 DEA=Neue Aufgabe];
                      Promoted=Yes;
                      Enabled=__edit;
                      PromotedIsBig=Yes;
                      Image=CopyFromTask;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CMTaskMgt.NewTaskToWorkorderUI(Rec);
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1000000018;1 ;Action    ;
                      Name=NewRequest;
                      CaptionML=[ENU=New Request;
                                 DEA=Neue Anfrage];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedReturnReceipt;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CMTaskMgt.NewRequestFromWorkorder(Rec);
                               END;
                                }
      { 1000000076;1 ;Action    ;
                      Name=SiteVisitingReportPreview;
                      CaptionML=[ENU=Site Visiting Report - Preview;
                                 DEA=Site Visiting Report - Vorschau];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Rec2@1000000000 : Record 5092;
                                 SiteVisitionReport@1000000001 : Report 70001;
                               BEGIN
                                 CMWoMgt.RunSiteVisitionReport(Rec, 1);
                               END;
                                }
      { 1000000074;1 ;Action    ;
                      Name=SiteVisitingReportPDF;
                      CaptionML=[ENU=Site Visiting Report - PDF;
                                 DEA=Site Visiting Report - PDF];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Rec2@1000000000 : Record 5092;
                                 SiteVisitionReport@1000000001 : Report 70001;
                               BEGIN
                                 CMWoMgt.RunSiteVisitionReport(Rec, 2);
                               END;
                                }
      { 1000000066;1 ;Action    ;
                      Name=ExportToExcel;
                      CaptionML=[ENU=Export Excel;
                                 DEA=Excel Export];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ExportToExcel;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMWoMgt.ExportToExcel(Rec);
                               END;
                                }
      { 1000000019;1 ;ActionGroup;
                      Name=Comments;
                      CaptionML=[ENU=Comments;
                                 DEA=Kommentare] }
      { 1000000020;2 ;Action    ;
                      Name=NewComment;
                      CaptionML=[ENU=New Comment;
                                 DEA=Neuer Kommentar];
                      Promoted=Yes;
                      Enabled=__edit;
                      PromotedIsBig=Yes;
                      Image=ViewComments;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMWoMgt.AddCommentUI(Rec, 0);
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1000000057;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000060;1 ;Action    ;
                      Name=Asset/Project Card;
                      CaptionML=[ENU=Asset/Project Card;
                                 DEA=Anlagen/Projektkarte];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMAssetMgmt@1000000000 : Codeunit 70020;
                                 RecRef@1000000001 : RecordRef;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 CMAssetMgt.ShowAssetProjectCard(RecRef);
                               END;
                                }
      { 1000000058;1 ;ActionGroup;
                      CaptionML=[ENU=History;
                                 DEA=Historie];
                      Image=History }
      { 1000000029;2 ;Action    ;
                      Name=Activities;
                      CaptionML=[ENU=Activities;
                                 DEA=Aktivit„ten];
                      Image=InteractionLog;
                      OnAction=BEGIN
                                 CMWoMgt.ShowRelatedLogs(Rec, -1, 0);
                               END;
                                }
      { 1000000056;2 ;Action    ;
                      Name=Status Change;
                      CaptionML=[ENU=Status Change;
                                 DEA=Status„nderungen];
                      Image=Status;
                      OnAction=BEGIN
                                 CMWoMgt.ShowRelatedLogs(Rec, LogEntry."CM Log Type"::"Status Change", 0);
                               END;
                                }
      { 1000000070;2 ;Action    ;
                      Name=Attachment Activities;
                      CaptionML=[ENU=Attachments;
                                 DEA=Anh„nge];
                      Visible=FALSE;
                      Image=Attach;
                      OnAction=BEGIN
                                 CMWoMgt.ShowRelatedLogs(Rec, LogEntry."CM Log Type"::Attachment, 0);
                               END;
                                }
      { 1000000071;2 ;Action    ;
                      Name=Photo Activities;
                      CaptionML=[ENU=Pictures;
                                 DEA=Fotos];
                      Visible=FALSE;
                      Image=Picture;
                      OnAction=BEGIN
                                 CMWoMgt.ShowRelatedLogs(Rec, LogEntry."CM Log Type"::Picture, 0);
                               END;
                                }
      { 1000000055;2 ;Action    ;
                      Name=Read Activities;
                      CaptionML=[ENU=Read Activities;
                                 DEA=Leseaktivit„ten];
                      Image=ViewDetails;
                      OnAction=BEGIN
                                 CMWoMgt.ShowRelatedLogs(Rec, LogEntry."CM Log Type"::Read, 0);
                               END;
                                }
      { 1000000068;2 ;Action    ;
                      Name=TaskActivities;
                      CaptionML=[ENU=Task Activities;
                                 DEA=Aufgaben Aktivit„ten];
                      Image=InteractionLog;
                      OnAction=BEGIN
                                 CMWoMgt.ShowRelatedLogs(Rec, -1, 1);
                               END;
                                }
      { 1000000065;2 ;Action    ;
                      Name=TrackedTime;
                      CaptionML=[ENU=Tracked Time;
                                 DEA=Erfasste Zeiten];
                      Image=JobTimeSheet;
                      OnAction=BEGIN
                                 CMTTMgt.ShowPostedEntriesToWorkorder(Rec, 1);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[ENU=General;
                           DEA=Allgemein];
                Editable=__edit;
                GroupType=Group }

    { 1000000002;2;Field  ;
                Lookup=No;
                DrillDown=No;
                AssistEdit=No;
                SourceExpr="No.";
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               CMGenMgt.GetWorkorderNo(Rec);
                             END;
                              }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000073;2;Field  ;
                Name=CM GPM Reference Element Name2;
                SourceExpr="CM GPM Reference Element Name" }

    { 1000000021;2;Field  ;
                CaptionML=[ENU=Asset / Project No.;
                           DEA=Analge / Projektnr.];
                SourceExpr="CM Object No.";
                Editable=FALSE;
                OnLookup=VAR
                           Obj@1000000001 : Record 70020;
                         BEGIN
                           IF Obj.GET(Rec."CM Objecttype", Rec."CM Object No.") THEN
                             CMAssetMgt.ShowAddressCard(Obj);
                         END;

                OnDrillDown=VAR
                              Obj@1000000000 : Record 70020;
                            BEGIN
                              IF Obj.GET(Rec."CM Objecttype", Rec."CM Object No.") THEN
                                CMAssetMgt.ShowAddressCard(Obj);
                            END;
                             }

    { 1000000006;2;Field  ;
                CaptionML=[ENU=Asset / Project Name;
                           DEA=Anlage / Projektname];
                SourceExpr="CM Object Name";
                Editable=FALSE;
                OnLookup=VAR
                           Obj@1000000001 : Record 70020;
                         BEGIN
                           IF Obj.GET(Rec."CM Objecttype", Rec."CM Object No.") THEN
                             CMAssetMgt.ShowAddressCard(Obj);
                         END;

                OnDrillDown=VAR
                              Obj@1000000000 : Record 70020;
                            BEGIN
                              IF Obj.GET(Rec."CM Objecttype", Rec."CM Object No.") THEN
                                CMAssetMgt.ShowAddressCard(Obj);
                            END;
                             }

    { 1000000011;2;Field  ;
                SourceExpr="CM Due Date" }

    { 1000000027;2;Field  ;
                SourceExpr="CM Scheduled Due Date" }

    { 1000000014;2;Field  ;
                SourceExpr="CM Assigned User ID";
                Editable=FALSE }

    { 1000000024;2;Field  ;
                SourceExpr="CM Created By User ID";
                Editable=FALSE }

    { 1000000009;2;Field  ;
                SourceExpr=Priority }

    { 1000000007;2;Field  ;
                SourceExpr="CM Status";
                Editable=FALSE }

    { 1000000005;2;Field  ;
                SourceExpr="CM Work Order Type Code";
                Visible=__hideOnPhone }

    { 1000000017;2;Field  ;
                SourceExpr="CM Billing Info" }

    { 1000000075;2;Field  ;
                SourceExpr="CM Email Notification" }

    { 1000000004;1;Part   ;
                Name=CMTaskSubpage;
                SubPageView=SORTING(Opportunity No.,CM Type,CM Assigned User ID,CM Status);
                SubPageLink=Opportunity No.=FIELD(No.),
                            CM Subtype=CONST(" "),
                            CM Type=CONST(Task);
                PagePartID=Page70113;
                PartType=Page }

    { 1000000022;1;Part   ;
                Name=CMCommentSubpage;
                SubPageLink=CM Is CMMS Log Entry=CONST(Yes),
                            CM Source=FILTER(Workorder|Task),
                            Opportunity No.=FIELD(No.),
                            CM Log Type=CONST(Comment);
                PagePartID=Page70110;
                Editable=FALSE;
                PartType=Page }

    { 1000000023;1;Group  ;
                Name=Extended;
                CaptionML=[ENU=Extended;
                           DEA=Erweitert];
                Editable=__edit;
                GroupType=Group }

    { 1000000067;2;Field  ;
                SourceExpr="CM Subcontractor No.";
                OnLookup=BEGIN
                           Rec."CM Subcontractor No." := CMWoMgt.LookupSubcontractor(Rec);
                         END;
                          }

    { 1000000028;2;Field  ;
                SourceExpr="CM Internal" }

    { 1000000053;2;Field  ;
                SourceExpr="CM Status Change Standard Text" }

    { 1000000025;2;Field  ;
                SourceExpr="CM Source";
                Editable=FALSE }

    { 1000000026;2;Field  ;
                SourceExpr="CM Source Description";
                Editable=FALSE }

    { 1000000031;1;Group  ;
                Name=Alarm;
                CaptionML=[ENU=Alarm;
                           DEA=Alarm];
                Visible=__showAlarm;
                Editable=__editAlarm;
                GroupType=Group }

    { 1000000032;2;Field  ;
                SourceExpr="CM GPM Ticket Id" }

    { 1000000054;2;Field  ;
                SourceExpr="CM GPM Ticket Name" }

    { 1000000052;2;Field  ;
                SourceExpr="CM GPM Plant ID";
                Visible=__hideOnPhone }

    { 1000000051;2;Field  ;
                SourceExpr="CM GPM No. of Updates";
                Visible=__hideOnPhone }

    { 1000000033;2;Field  ;
                SourceExpr="CM GPM Grouping" }

    { 1000000034;2;Field  ;
                SourceExpr="CM GPM Activated Date" }

    { 1000000035;2;Field  ;
                SourceExpr="CM GPM Activated Time" }

    { 1000000062;2;Field  ;
                SourceExpr="CM GPM Deactivated Date" }

    { 1000000063;2;Field  ;
                SourceExpr="CM GPM Deactivated Time" }

    { 1000000064;2;Field  ;
                SourceExpr="CM GPM Reference Element ID" }

    { 1000000061;2;Field  ;
                SourceExpr="CM GPM Reference Element Name" }

    { 1000000036;2;Field  ;
                SourceExpr="CM GPM Prority" }

    { 1000000037;2;Field  ;
                SourceExpr="CM GPM State";
                Visible=__hideOnPhone }

    { 1000000038;2;Field  ;
                SourceExpr="CM GPM Alert Type";
                Visible=__hideOnPhone }

    { 1000000039;2;Field  ;
                Name=Activation Description;
                SourceExpr=_activation_description;
                Visible=__hideOnPhone;
                Editable=__edit;
                MultiLine=Yes;
                OnValidate=BEGIN
                             SetBlobValues();
                           END;
                            }

    { 1000000040;2;Field  ;
                Name=Deactivation Description;
                SourceExpr=_deactivation_description;
                Visible=__hideOnPhone;
                Editable=__edit;
                MultiLine=Yes;
                OnValidate=BEGIN
                             SetBlobValues();
                           END;
                            }

    { 1000000041;2;Field  ;
                Name=Activation Details;
                SourceExpr=_activation_details;
                Visible=__hideOnPhone;
                Editable=__edit;
                MultiLine=Yes;
                OnValidate=BEGIN
                             SetBlobValues();
                           END;
                            }

    { 1000000042;2;Field  ;
                Name=Deactivation Details;
                SourceExpr=_deactivation_details;
                Visible=__hideOnPhone;
                Editable=__edit;
                MultiLine=Yes;
                OnValidate=BEGIN
                             SetBlobValues();
                           END;
                            }

    { 1000000043;2;Field  ;
                SourceExpr="CM GPM Affects Availibility";
                Visible=__hideOnPhone }

    { 1000000044;2;Field  ;
                SourceExpr="CM GPM Calculate Loss";
                Visible=__hideOnPhone }

    { 1000000045;2;Field  ;
                Name=Problem Description;
                SourceExpr=_problem_description;
                Editable=__edit;
                MultiLine=Yes;
                OnValidate=BEGIN
                             SetBlobValues();
                           END;
                            }

    { 1000000048;2;Field  ;
                Name=Actions Performed;
                SourceExpr=_actions_performed;
                Editable=__edit;
                MultiLine=Yes;
                OnValidate=BEGIN
                             SetBlobValues();
                           END;
                            }

    { 1000000046;2;Field  ;
                SourceExpr="CM GPM Company";
                Visible=__hideOnPhone }

    { 1000000047;2;Field  ;
                SourceExpr="CM GPM Ticket Duration";
                Visible=__hideOnPhone }

    { 1000000049;2;Field  ;
                SourceExpr="CM GPM Maintenance Type";
                Visible=__hideOnPhone }

    { 1000000050;2;Field  ;
                SourceExpr="CM GPM Notified DateTime" }

    { 1000000013;0;Container;
                ContainerType=FactBoxArea }

    { 1000000059;1;Part   ;
                Name=CMContractInfobox;
                PagePartID=Page70704;
                PartType=Page }

    { 1000000015;1;Part   ;
                SubPageLink=No.=FIELD(No.),
                            CM Is Workorder=CONST(Yes);
                PagePartID=Page70702;
                Visible=False;
                PartType=Page }

    { 1000000069;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page70710;
                ProviderID=1000000004;
                PartType=Page }

    { 1000000072;1;Part   ;
                PartType=System;
                SystemPartID=RecordLinks }

  }
  CODE
  {
    VAR
      CMGenMgt@1000000000 : Codeunit 70000;
      CMWoMgt@1000000001 : Codeunit 70030;
      CMTaskMgt@1000000002 : Codeunit 70031;
      CMAssetMgt@1000000006 : Codeunit 70020;
      CMTTMgt@1000000015 : Codeunit 70040;
      LogEntry@1000000003 : Record 5065;
      _activation_description@1000000011 : Text;
      _deactivation_description@1000000010 : Text;
      _activation_details@1000000009 : Text;
      _deactivation_details@1000000008 : Text;
      _problem_description@1000000007 : Text;
      _actions_performed@1000000004 : Text;
      __showAlarm@1000000013 : Boolean INDATASET;
      __editAlarm@1000000014 : Boolean INDATASET;
      __edit@1000000005 : Boolean INDATASET;
      __hideOnPhone@1000000012 : Boolean INDATASET;

    LOCAL PROCEDURE SetEditable@1000000005();
    BEGIN
      __edit := FALSE;

      IF ("CM Status" IN ["CM Status"::New,"CM Status"::Open,"CM Status"::"In Process","CM Status"::Completed]) AND  (CurrPage.EDITABLE) THEN
        __edit := TRUE;

      CurrPage.EDITABLE := __edit;

      __showAlarm := (Rec."CM Source" IN [Rec."CM Source"::Alarm, Rec."CM Source"::"Manual Alarm"]);
      __editAlarm := (__edit) AND (Rec."CM Source" = Rec."CM Source"::"Manual Alarm");

      CurrPage.CMCommentSubpage.PAGE.SetActionsEnabled(__edit);
    END;

    PROCEDURE GetBlobValues@1000000002();
    VAR
      InStr@1000000006 : InStream;
      CMGenMgt@1000000007 : Codeunit 70000;
    BEGIN
      Rec.CALCFIELDS("CM GPM Activation Description");
      Rec.CALCFIELDS("CM GPM Deactivation Descr.");
      Rec.CALCFIELDS("CM GPM Activation Details");
      Rec.CALCFIELDS("CM GPM Deactivation Details");
      Rec.CALCFIELDS("CM GPM Problem Description");
      Rec.CALCFIELDS("CM GPM Actions Performed");

      Rec."CM GPM Activation Description".CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      _activation_description := CMGenMgt.Instream2Text(InStr);

      Rec."CM GPM Deactivation Descr.".CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      _deactivation_description := CMGenMgt.Instream2Text(InStr);

      Rec."CM GPM Activation Details".CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      _activation_details := CMGenMgt.Instream2Text(InStr);

      Rec."CM GPM Deactivation Details".CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      _deactivation_details := CMGenMgt.Instream2Text(InStr);

      Rec."CM GPM Problem Description".CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      _problem_description := CMGenMgt.Instream2Text(InStr);

      Rec."CM GPM Actions Performed".CREATEINSTREAM(InStr, TEXTENCODING::UTF8);
      _actions_performed := CMGenMgt.Instream2Text(InStr);
    END;

    PROCEDURE SetBlobValues@1000000001();
    VAR
      OutStr@1000000006 : OutStream;
    BEGIN
      CLEAR("CM GPM Activation Description");
      CLEAR("CM GPM Deactivation Descr.");
      CLEAR("CM GPM Activation Details");
      CLEAR("CM GPM Deactivation Details");
      CLEAR("CM GPM Problem Description");
      CLEAR("CM GPM Actions Performed");

      Rec."CM GPM Activation Description".CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(_activation_description);

      Rec."CM GPM Deactivation Descr.".CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(_deactivation_description);

      Rec."CM GPM Activation Details".CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(_activation_details);

      Rec."CM GPM Deactivation Details".CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(_deactivation_details);

      Rec."CM GPM Problem Description".CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(_problem_description);

      Rec."CM GPM Actions Performed".CREATEOUTSTREAM(OutStr, TEXTENCODING::UTF8);
      OutStr.WRITETEXT(_actions_performed);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70101 CMMS Workorder List
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=12:42:09;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Workorders;
               DEA=Arbeitsauftr„ge];
    InsertAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5092;
    PopulateAllFields=Yes;
    PageType=List;
    OnOpenPage=BEGIN
                 Rec.SETCURRENTKEY("CM Is Workorder",Priority,"CM Objecttype","CM Object No.");
                 Rec.ASCENDING(FALSE);
                 IF Rec.FIND('-') THEN
                   ;
               END;

    OnAfterGetRecord=BEGIN
                       SetStyle();
                     END;

    OnAfterGetCurrRecord=BEGIN
                           CurrPage.CMContractInfobox.PAGE.SetAssetNo("CM Object No.");
                           SetStyle();
                         END;

    ActionList=ACTIONS
    {
      { 1000000034;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000010;1 ;Action    ;
                      Name=CMCard;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Card;
                                 DEA=Karte];
                      RunPageOnRec=Yes;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EditLines;
                      PromotedCategory=Process;
                      RunPageMode=View;
                      OnAction=VAR
                                 CMWOMgmt@1000000000 : Codeunit 70030;
                               BEGIN
                                 CMWOMgmt.ShowWorkorderCard(Rec);
                               END;
                                }
      { 1000000038;1 ;Action    ;
                      Name=SiteVisitingReportPreview;
                      CaptionML=[ENU=Site Visiting Report - Preview;
                                 DEA=Site Visiting Report - Vorschau];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Rec2@1000000000 : Record 5092;
                                 SiteVisitionReport@1000000001 : Report 70001;
                               BEGIN
                                 CMWoMgt.RunSiteVisitionReport(Rec, 1);
                               END;
                                }
      { 1000000037;1 ;Action    ;
                      Name=SiteVisitingReportPDF;
                      CaptionML=[ENU=Site Visiting Report - PDF;
                                 DEA=Site Visiting Report - PDF];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Print;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Rec2@1000000000 : Record 5092;
                                 SiteVisitionReport@1000000001 : Report 70001;
                               BEGIN
                                 CMWoMgt.RunSiteVisitionReport(Rec, 2);
                               END;
                                }
      { 1000000013;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000023;1 ;Action    ;
                      Name=Sort_PriorityAssetProject;
                      CaptionML=ENU=Sort: Priority - Asset/Project;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SetPriorities;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Rec.SETCURRENTKEY("CM Is Workorder",Priority,"CM Objecttype","CM Object No.");
                                 Rec.ASCENDING(FALSE);
                                 IF Rec.FIND('-') THEN
                                   ;
                                 //CurrPage.UPDATE();
                               END;
                                }
      { 1000000022;1 ;Action    ;
                      Name=Sort_AssetProjectPriority;
                      CaptionML=ENU=Sort: Asset/Project - Priority;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SetPriorities;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Rec.SETCURRENTKEY("CM Is Workorder","CM Objecttype","CM Object No.",Priority);
                                 Rec.ASCENDING(TRUE);
                                 IF Rec.FIND('-') THEN
                                   ;
                                 //CurrPage.UPDATE();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                GroupType=Repeater }

    { 1000000004;2;Field  ;
                SourceExpr="CM Object No.";
                OnLookup=BEGIN
                           CMWoMgt.ShowWorkorderCard(Rec);
                         END;

                OnDrillDown=BEGIN
                              CMWoMgt.ShowWorkorderCard(Rec);
                            END;
                             }

    { 1000000009;2;Field  ;
                SourceExpr="CM Object Name";
                Editable=false;
                OnLookup=BEGIN
                           CMWoMgt.ShowWorkorderCard(Rec);
                         END;

                OnDrillDown=BEGIN
                              CMWoMgt.ShowWorkorderCard(Rec);
                            END;
                             }

    { 1000000002;2;Field  ;
                SourceExpr="No.";
                OnLookup=BEGIN
                           CMWoMgt.ShowWorkorderCard(Rec);
                         END;

                OnDrillDown=BEGIN
                              CMWoMgt.ShowWorkorderCard(Rec);
                            END;
                             }

    { 1000000006;2;Field  ;
                SourceExpr="CM Status" }

    { 1000000018;2;Field  ;
                SourceExpr=Priority;
                StyleExpr=_priorityStyle }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000029;2;Field  ;
                SourceExpr="CM GPM Reference Element Name" }

    { 1000000014;2;Field  ;
                BlankZero=Yes;
                SourceExpr="CM GPM Ticket Id" }

    { 1000000017;2;Field  ;
                SourceExpr="CM GPM Ticket Name" }

    { 1000000012;2;Field  ;
                SourceExpr="CM Source" }

    { 1000000007;2;Field  ;
                SourceExpr="CM Assigned User ID" }

    { 1000000011;2;Field  ;
                SourceExpr="CM Due Date" }

    { 1000000005;2;Field  ;
                SourceExpr="CM Work Order Type Code" }

    { 1000000008;2;Field  ;
                SourceExpr="CM Work Order Type Descr." }

    { 1000000027;2;Field  ;
                SourceExpr="CM GPM Activated Date" }

    { 1000000026;2;Field  ;
                SourceExpr="CM GPM Activated Time" }

    { 1000000030;2;Field  ;
                SourceExpr="CM GPM Deactivated Date" }

    { 1000000031;2;Field  ;
                SourceExpr="CM GPM Deactivated Time" }

    { 1000000016;2;Field  ;
                SourceExpr="CM GPM Notified Date" }

    { 1000000015;2;Field  ;
                SourceExpr="CM GPM Notified Time" }

    { 1000000028;2;Field  ;
                SourceExpr="CM GPM Reference Element ID" }

    { 1000000025;2;Field  ;
                SourceExpr="CM GPM State" }

    { 1000000024;2;Field  ;
                SourceExpr="CM Open Tasks";
                Visible=FALSE }

    { 1000000032;2;Field  ;
                SourceExpr="CM Finished Tasks";
                Visible=FALSE }

    { 1000000033;2;Field  ;
                SourceExpr="CM All Tasks Finished";
                Visible=false }

    { 1000000036;2;Field  ;
                SourceExpr="CM Email Notification";
                Visible=FALSE }

    { 1000000035;2;Field  ;
                SourceExpr="CM Billing Info";
                Visible=FALSE }

    { 1000000021;0;Container;
                ContainerType=FactBoxArea }

    { 1000000020;1;Part   ;
                Name=CMContractInfobox;
                PagePartID=Page70704;
                PartType=Page }

    { 1000000019;1;Part   ;
                SubPageLink=No.=FIELD(No.),
                            CM Is Workorder=CONST(Yes);
                PagePartID=Page70702;
                Visible=False;
                PartType=Page }

  }
  CODE
  {
    VAR
      Obj@1000000000 : Record 70020;
      CMAssetMgt@1000000001 : Codeunit 70020;
      CMWoMgt@1000000003 : Codeunit 70030;
      _priorityStyle@1000000002 : Text[20] INDATASET;

    LOCAL PROCEDURE SetStyle@1000000001();
    BEGIN
      _priorityStyle := '';
      IF Rec.Priority = Rec.Priority::High THEN
        _priorityStyle := 'Strong';
      IF Rec.Priority = Rec.Priority::Low THEN
        _priorityStyle := 'Subordinate';
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70102 CMMS Wo. Type Checklist List
{
  OBJECT-PROPERTIES
  {
    Date=15.11.16;
    Time=08:15:30;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Checklist;
               DEA=Checkliste];
    LinksAllowed=No;
    SourceTable=Table5082;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(CM Maintask Step No.)
                    WHERE(CM Subtype=CONST(Checklist));
    PageType=List;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       IF Rec."CM Maintask Step No." = 0 THEN
                         ERROR(Text001)
                     END;

    OnNewRecord=BEGIN
                  CMTaskMgt.SetWoTypeSubSetupNo(Rec, Rec."CM Subtype"::Checklist);
                END;

    OnInsertRecord=VAR
                     ActivityStep@1000000000 : Record 5082;
                   BEGIN
                   END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="Step No.";
                Editable=FALSE }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000004;2;Field  ;
                SourceExpr="CM Maintask Step No.";
                Visible=FALSE;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Record is no Subtask.;DEA=Datensatz ist keine Unteraufgabe.';
      CMTaskMgt@1000000001 : Codeunit 70031;

    BEGIN
    END.
  }
}

OBJECT Page 70103 CMMS Wo. Type Team List
{
  OBJECT-PROPERTIES
  {
    Date=15.11.16;
    Time=08:49:17;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Team;
               DEA=Team];
    LinksAllowed=No;
    SourceTable=Table5082;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(CM Maintask Step No.)
                    WHERE(CM Subtype=CONST(Team));
    PageType=List;
    AutoSplitKey=Yes;
    OnAfterGetRecord=BEGIN
                       IF Rec."CM Maintask Step No." = 0 THEN
                         ERROR(Text001)
                     END;

    OnNewRecord=BEGIN
                  CMTaskMgt.SetWoTypeSubSetupNo(Rec, Rec."CM Subtype"::Team);
                END;

    OnInsertRecord=VAR
                     ActivityStep@1000000000 : Record 5082;
                   BEGIN
                   END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="Step No.";
                Editable=FALSE }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000004;2;Field  ;
                SourceExpr="CM Maintask Step No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000005;2;Field  ;
                SourceExpr="CM Assigned User ID" }

    { 1000000006;2;Field  ;
                SourceExpr="CM Assigned User Name" }

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Record is no Subtask.;DEA=Datensatz ist keine Unteraufgabe.';
      CMTaskMgt@1000000001 : Codeunit 70031;

    BEGIN
    END.
  }
}

OBJECT Page 70105 CMMS New Workorder Wizzard
{
  OBJECT-PROPERTIES
  {
    Date=30.08.17;
    Time=16:10:50;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=New;
               DEA=Neu];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table5092;
    DataCaptionExpr=Text001;
    PageType=ConfirmationDialog;
    SourceTableTemporary=Yes;
    InstructionalTextML=[ENU=Create New Workorder...;
                         DEA=Neuen Arbeitsauftrag erstellen...];
    ShowFilter=No;
    OnOpenPage=BEGIN
                 IF NOT FINDFIRST() THEN BEGIN
                   Rec.INIT;
                   Rec."CM Is Temporary" := TRUE;
                   Rec."CM Is Workorder" :=  TRUE;
                   Rec."CM Due Date"  := WORKDATE;
                   Rec."CM Scheduled Due Date" := WORKDATE;
                   Rec."CM Internal" := TRUE;
                   Rec.INSERT;
                 END;

                 SETRECFILTER();
               END;

    OnQueryClosePage=BEGIN
                       IF (CloseAction = ACTION::Yes) AND ((Rec.Description = '') OR (Rec."CM Assigned User ID" = '')) THEN
                         ERROR(Text002);
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000003;1;Field  ;
                Name=isManualAlarm;
                CaptionML=[ENU=Manual Alarm;
                           DEA=Manueller Alarm];
                SourceExpr=_isManualAlarm;
                OnValidate=BEGIN
                             IF _isManualAlarm THEN
                               Rec."CM Source" := Rec."CM Source"::"Manual Alarm"
                             ELSE
                               Rec."CM Source" := Rec."CM Source"::Standard;
                           END;
                            }

    { 1000000004;1;Field  ;
                SourceExpr="CM Work Order Type Code";
                Visible=NOT _hideWorkorderType;
                OnValidate=VAR
                             WOType@1000000000 : Record 5081;
                           BEGIN
                             IF (NOT WOType.GET("CM Work Order Type Code")) THEN
                               WOType.INIT;

                             Description := WOType.Description;
                             Priority := WOType."CM Priority";
                           END;
                            }

    { 1000000001;1;Field  ;
                SourceExpr=Description;
                ShowMandatory=TRUE }

    { 1000000005;1;Field  ;
                SourceExpr="CM Assigned User ID";
                ShowMandatory=TRUE }

    { 1000000006;1;Field  ;
                SourceExpr="CM Due Date" }

    { 1000000008;1;Field  ;
                SourceExpr="CM Scheduled Due Date" }

    { 1000000002;1;Field  ;
                SourceExpr=Priority }

    { 1000000007;1;Field  ;
                SourceExpr="CM Billing Info";
                ShowMandatory=TRUE }

    { 1000000009;1;Field  ;
                SourceExpr="CM Internal" }

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=New Workorder;DEA=Neuer Arbeitsauftrag';
      _hideWorkorderType@1000000001 : Boolean INDATASET;
      Text002@1000000002 : TextConst 'ENU=Please fill all required fields!;DEA=Bitte befllen Sie alle Pflichtfelder!';
      _isManualAlarm@1000000003 : Boolean;

    PROCEDURE SetAsset@1000000000(CMAsset@1000000000 : Record 70020);
    BEGIN
      CLEAR(Rec);
      Rec.RESET;
      Rec.DELETEALL();
      Rec.INIT;
      Rec."CM Is Temporary" := TRUE;
      Rec."CM Is Workorder" := TRUE;
      Rec."CM Objecttype" := CMAsset.Objecttype;
      Rec."CM Object No." := CMAsset."No.";
      Rec."CM Object Name" := CMAsset.Name;
      Rec."CM Due Date"  := TODAY;
      Rec.INSERT(FALSE);
    END;

    PROCEDURE HideWorkorderType@1000000001(value@1000000000 : Boolean);
    BEGIN
      _hideWorkorderType := value;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70106 CMMS Select WO Status
{
  OBJECT-PROPERTIES
  {
    Date=12.07.16;
    Time=13:49:32;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Select New Status;
               DEA=Neuen Status w„hlen];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table5092;
    PageType=StandardDialog;
    SourceTableTemporary=Yes;
    InstructionalTextML=[ENU=Select New Status;
                         DEA=Neuen Status w„hlen];
    ShowFilter=No;
    OnOpenPage=BEGIN
                 FINDFIRST();
                 SETRECFILTER();
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                CaptionML=[ENU=New Status;
                           DEA=Neuer Status];
                SourceExpr="CM Status" }

  }
  CODE
  {

    PROCEDURE SetStatus@1000000000(CurrentStatus@1000000000 : Integer);
    BEGIN
      Rec.RESET;
      Rec.DELETEALL();
      Rec.INIT;
      Rec."CM Status" := CurrentStatus;
      Rec.INSERT();
    END;

    PROCEDURE GetStatus@1000000001() : Integer;
    BEGIN
      EXIT(Rec."CM Status");
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70107 CMMS Select Assigned User ID
{
  OBJECT-PROPERTIES
  {
    Date=11.11.16;
    Time=10:54:00;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    SourceTable=Table5092;
    PageType=StandardDialog;
    SourceTableTemporary=Yes;
    OnOpenPage=BEGIN
                 FINDFIRST();
                 SETRECFILTER();
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                SourceExpr="CM Assigned User ID";
                LookupPageID=CMMS User List }

  }
  CODE
  {

    PROCEDURE SetUserID@1000000000(CurrentUserID@1000000000 : Code[50]);
    BEGIN
      Rec.RESET;
      Rec.DELETEALL();
      Rec.INIT;
      Rec."CM Assigned User ID" := CurrentUserID;
      Rec.INSERT();
    END;

    PROCEDURE GetUserID@1000000001() : Code[50];
    BEGIN
      EXIT(Rec."CM Assigned User ID");
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70108 CMMS New Workorder Comment
{
  OBJECT-PROPERTIES
  {
    Date=05.02.18;
    Time=17:34:01;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=New Comment;
               DEA=Neuer Kommentar];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5065;
    DataCaptionExpr=Text001;
    PageType=StandardDialog;
    SourceTableTemporary=Yes;
    InstructionalTextML=[ENU=Please enter a Comment Text;
                         DEA=Geben sie einen Kommentar ein];
    OnOpenPage=BEGIN
                 IF NOT FINDFIRST() THEN BEGIN
                   INIT;
                   INSERT(FALSE);
                 END;
                 SETRECFILTER();
               END;

    OnClosePage=BEGIN
                  CurrPage.UPDATE(TRUE);
                END;

    OnQueryClosePage=BEGIN
                       CurrPage.UPDATE(TRUE);

                       IF (CloseAction = ACTION::LookupOK) AND (Rec."CM Comment" = '') THEN
                         ERROR(Text002);
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000006;1;Field  ;
                SourceExpr="CM Comment";
                MultiLine=Yes }

    { 1000000004;1;Field  ;
                SourceExpr="CM Issue" }

    { 1000000005;1;Field  ;
                SourceExpr="CM Production Effect" }

    { 1000000002;1;Field  ;
                SourceExpr="CM Internal" }

  }
  CODE
  {
    VAR
      Text001@1000000001 : TextConst 'ENU=New Comment;DEA=Neuer Kommentar';
      Text002@1000000002 : TextConst 'ENU=Please enter a comment text! (You have to leave the the comment field after you write your Text.);DEA=Bitte Kommentartext eingeben! (Sie mssen das Kommentarfeld verlassen, nachdem sie den Text eingegeben haben.)';

    PROCEDURE SetText@1000000003(value@1000000000 : Text);
    BEGIN
      Rec."CM Comment" := value;
    END;

    PROCEDURE SetRec@1000000005(VAR Record@1000000000 : Record 5065);
    BEGIN
      Rec.RESET;
      Rec.DELETEALL;
      Rec.INIT();
      Rec.COPY(Record);
      Rec.INSERT;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70109 CMMS Assign Workorder
{
  OBJECT-PROPERTIES
  {
    Date=04.01.18;
    Time=15:21:42;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=Yes;
    CaptionML=[ENU=Assing Asset / Project;
               DEA=Anlage / Projekt zuweisen];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5092;
    DataCaptionExpr=Text001;
    PopulateAllFields=Yes;
    PageType=Card;
    SourceTableTemporary=Yes;
    ShowFilter=No;
    OnInit=BEGIN
             CurrPage.EDITABLE := TRUE;
           END;

    OnOpenPage=BEGIN
                 Rec.RESET();
                 Rec.DELETEALL(FALSE);
                 Rec.INIT();
                 Rec.INSERT(FALSE);
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000012;1;Field  ;
                Name=MainAssetName_;
                CaptionML=[ENU=Main Asset;
                           DEA=Hauptanlage];
                SourceExpr=MainAssetName;
                OnValidate=BEGIN
                             IF MainAssetName <> '' THEN
                               ValidateNo(2,CMGenMgt.DoUniversalLookup(2,'', '',MainAssetName, ''))
                             ELSE
                               ValidateNo(2,'');
                           END;
                            }

    { 1000000013;1;Field  ;
                Name=MainAssetNo_;
                CaptionML=[ENU=Main Asset;
                           DEA=Hauptanlage];
                SourceExpr=MainAssetNo;
                Visible=FALSE;
                Editable=FALSE }

    { 1000000006;1;Field  ;
                Name=AssetName_;
                CaptionML=[ENU=Asset;
                           DEA=Anlage];
                SourceExpr=AssetName;
                OnValidate=BEGIN
                             IF AssetName <> '' THEN
                               ValidateNo(0,CMGenMgt.DoUniversalLookup(3,MainAssetNo,'', AssetName, ''))
                             ELSE
                               ValidateNo(0,'');
                           END;
                            }

    { 1000000007;1;Field  ;
                Name=AssetNo_;
                CaptionML=[ENU=Asset;
                           DEA=Anlage];
                SourceExpr=AssetNo;
                Visible=FALSE;
                Editable=FALSE }

    { 1000000011;1;Field  ;
                Name=ProjectName_;
                CaptionML=[ENU=Project;
                           DEA=Projekt];
                SourceExpr=ProjectName;
                OnValidate=BEGIN
                             IF ProjectName <> '' THEN
                               ValidateNo(1,CMGenMgt.DoUniversalLookup(1,GetProjectSourceNo(), '', ProjectName, '')) //1 = Project
                             ELSE
                               ValidateNo(1,'');
                           END;
                            }

    { 1000000004;1;Field  ;
                Name=ProjectNo_;
                CaptionML=[ENU=Project;
                           DEA=Projekt];
                SourceExpr=ProjectNo;
                Visible=FALSE;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      Text001@1000000003 : TextConst 'ENU=Link Workorder to Asset / Project;DEA=Arbeitsauftrag zu Anlage/Projekt verlinken';
      MainAssetName@1000000012 : Text[50];
      AssetName@1000000005 : Text[50];
      ProjectName@1000000006 : Text[50];
      Description@1000000007 : Text[50];
      DescriptionLong@1000000008 : Text[250];
      CMGenMgt@1000000000 : Codeunit 70000;
      CMTaskMgt@1000000009 : Codeunit 70031;
      MainAssetNo@1000000004 : Code[20];
      AssetNo@1000000002 : Code[20];
      ProjectNo@1000000001 : Code[20];
      Obj@1000000010 : Record 70020;

    PROCEDURE GetObjecttype@1000000002() : Integer;
    BEGIN
      IF ProjectNo <> '' THEN
        EXIT(Obj.Objecttype::Project);

      EXIT(Obj.Objecttype::Asset);
    END;

    PROCEDURE GetObjectno@1000000003() : Code[20];
    BEGIN
      IF ProjectNo <> '' THEN
        EXIT(ProjectNo);

      IF AssetNo <> '' THEN
        EXIT(AssetNo);

      IF MainAssetNo <> '' THEN
        EXIT(MainAssetNo);
    END;

    LOCAL PROCEDURE ValidateNo@1000000000(ObjType@1000000000 : 'Asset,Project,MainAsset';No@1000000001 : Code[20]);
    VAR
      CMAsset@1000000002 : Record 70020;
    BEGIN
      //Main Asset
      IF ObjType = ObjType::MainAsset THEN BEGIN
        IF CMAsset.GET(CMAsset.Objecttype::Asset, No) THEN BEGIN
          MainAssetName := GetObjectName(No,CMAsset.Name);
          MainAssetNo := No;
        END
        ELSE BEGIN
          MainAssetName := '';
          MainAssetNo := '';
        END;

        AssetName := '';
        AssetNo := '';
        ProjectName := '';
        ProjectNo := '';
      END;

      //Asset
      IF ObjType = ObjType::Asset THEN BEGIN
        IF CMAsset.GET(CMAsset.Objecttype::Asset, No) THEN BEGIN
          AssetName := GetObjectName(No,CMAsset.Name);
          AssetNo := No;
        END
        ELSE BEGIN
          AssetName := '';
          AssetNo := '';
        END;

        ProjectName := '';
        ProjectNo := '';
      END;

      //Project
      IF ObjType = ObjType::Project THEN BEGIN
        IF CMAsset.GET(CMAsset.Objecttype::Project, No) THEN BEGIN
          ProjectName := GetObjectName(No,CMAsset.Name);
          ProjectNo := No;
        END
        ELSE BEGIN
          ProjectNo := '';
          ProjectName := '';
        END;
      END;

      CurrPage.SAVERECORD();
    END;

    LOCAL PROCEDURE GetProjectSourceNo@1000000005() : Code[20];
    BEGIN
      IF AssetNo <> '' THEN
        EXIT(AssetNo);
      IF MainAssetNo <> '' THEN
        EXIT(MainAssetNo);

      EXIT('');
    END;

    LOCAL PROCEDURE GetObjectName@1000000008(Code@1000000000 : Code[20];Name@1000000001 : Text[50]) : Text;
    VAR
      Result@1000000002 : Text;
    BEGIN
      Result := '';
      IF Code <> '' THEN
        Result += Code;
      IF (Name <> '') AND (Result <> '') THEN
        Result += (' - ' + Name);

      EXIT(Result);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70110 CMMS Comment Subpage
{
  OBJECT-PROPERTIES
  {
    Date=16.02.18;
    Time=14:09:02;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Comments;
               DEA=Kommentare];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5065;
    SourceTableView=SORTING(CM Is CMMS Log Entry,Opportunity No.)
                    ORDER(Descending)
                    WHERE(CM Is CMMS Log Entry=CONST(Yes),
                          CM Log Type=CONST(Comment));
    PageType=ListPart;
    OnInit=BEGIN
             VisibleOnPhoneTablet := CMGenMgt.VisibleOnPhone();
           END;

    OnAfterGetRecord=BEGIN
                       _style := '';
                       IF (Rec."CM Log Type" = Rec."CM Log Type"::Comment) AND (Rec."CM Deleted") THEN
                         _style := 'Subordinate';

                       _enabled := (ActionsEnabled) AND (Rec."CM Source" = Rec."CM Source"::Workorder);
                     END;

    OnAfterGetCurrRecord=BEGIN
                           _enabled := (ActionsEnabled) AND (Rec."CM Source" = Rec."CM Source"::Workorder);
                         END;

    ActionList=ACTIONS
    {
      { 1000000004;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000014;1 ;Action    ;
                      Name=ToggleInternal;
                      CaptionML=[ENU=Toggle 'Internal';
                                 DEA='Intern' umschalten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approvals;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Rec."CM Internal" := NOT Rec."CM Internal";
                                 Rec.MODIFY(FALSE);

                                 CurrPage.UPDATE();
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=DeleteComment;
                      CaptionML=[ENU=Delete Comment;
                                 DEA=Kommentar L”schen];
                      Promoted=Yes;
                      Enabled=_enabled;
                      PromotedIsBig=Yes;
                      Image=RemoveLine;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMGenMgt.DeleteLogEntry(Rec, TRUE);
                               END;
                                }
      { 1000000006;1 ;Action    ;
                      Name=CopyDeleteComment;
                      CaptionML=[ENU=Copy and Delete Comment;
                                 DEA=Kommentar Kopieren und L”schen];
                      Promoted=Yes;
                      Enabled=_enabled;
                      PromotedIsBig=Yes;
                      Image=DeleteAllBreakpoints;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMGenMgt.CopyAndDeleteComment(Rec);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000008;2;Field  ;
                SourceExpr="CM Created Datetime";
                Editable=false;
                StyleExpr=_style }

    { 1000000013;2;Field  ;
                SourceExpr="User ID";
                Enabled=False;
                StyleExpr=_style }

    { 1000000011;2;Field  ;
                SourceExpr="CM Source" }

    { 1000000007;2;Field  ;
                SourceExpr="CM Source No." }

    { 1000000009;2;Field  ;
                CaptionML=[ENU=Title;
                           DEA=Titel];
                SourceExpr=Description;
                Visible=false;
                Editable=false;
                StyleExpr=_style }

    { 1000000010;2;Field  ;
                SourceExpr="CM Comment" }

    { 1000000012;2;Field  ;
                SourceExpr="CM Internal" }

    { 1000000002;2;Field  ;
                SourceExpr="CM Issue";
                StyleExpr=_style }

    { 1000000003;2;Field  ;
                SourceExpr="CM Production Effect";
                StyleExpr=_style }

  }
  CODE
  {
    VAR
      CMGenMgt@1000000000 : Codeunit 70000;
      VisibleOnPhoneTablet@1000000001 : Boolean INDATASET;
      _style@1000000004 : Text INDATASET;
      _enabled@1000000005 : Boolean INDATASET;
      ActionsEnabled@1000000002 : Boolean;

    PROCEDURE SetActionsEnabled@1000000000(Enabled@1000000000 : Boolean);
    BEGIN
      ActionsEnabled := Enabled;
      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70111 CMMS Log List
{
  OBJECT-PROPERTIES
  {
    Date=20.04.18;
    Time=09:59:57;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Activities;
               DEA=Aktivit„ten];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5065;
    SourceTableView=WHERE(CM Is CMMS Log Entry=CONST(Yes),
                          CM Deleted=CONST(No));
    PageType=List;
    ShowFilter=Yes;
    OnAfterGetRecord=BEGIN
                       _showPhoto := (Rec."CM Log Type" = Rec."CM Log Type"::Picture);
                     END;

    ActionList=ACTIONS
    {
      { 1000000015;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000016;1 ;Action    ;
                      Name=ShowPhoto;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Show Photo;
                                 DEA=Foto Anzeigen];
                      Promoted=Yes;
                      Enabled=("CM Log Type" = "CM Log Type"::Picture) AND ("Attachment No." > 0);
                      PromotedIsBig=Yes;
                      Image=Camera;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Attachment@1000000000 : Record 5062;
                                 FileMgt@1000000001 : Codeunit 419;
                                 ClientFileName@1000000002 : Text;
                               BEGIN
                                 //Rec.OpenAttachment();
                                 CMGenMgt.OpenAttachment(Rec);
                               END;
                                }
      { 1000000022;1 ;Action    ;
                      Name=OpenAttachment;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Open Attachment;
                                 DEA=Anhang ™ffnen];
                      Promoted=Yes;
                      Enabled=("CM Log Type" = "CM Log Type"::Attachment) AND ("Attachment No." > 0);
                      PromotedIsBig=Yes;
                      Image=ExportAttachment;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Attachment@1000000000 : Record 5062;
                                 FileMgt@1000000001 : Codeunit 419;
                                 ClientFileName@1000000002 : Text;
                               BEGIN
                                 //Rec.OpenAttachment();
                                 CMGenMgt.OpenAttachment(Rec);
                               END;
                                }
      { 1000000019;1 ;Action    ;
                      Name=ToggleInternal;
                      CaptionML=[ENU=Toggle 'Internal';
                                 DEA='Intern' umschalten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approvals;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Rec."CM Internal" := NOT Rec."CM Internal";
                                 Rec.MODIFY(FALSE);

                                 CurrPage.UPDATE();
                               END;
                                }
      { 1000000021;1 ;Action    ;
                      Name=ToggleHealthAndSafety;
                      CaptionML=[ENU=Toggle 'Health and Safety Document';
                                 DEA='Health and Safety Dokument' umschalten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approvals;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Rec."CM Health And Safety Document" := NOT Rec."CM Health And Safety Document";
                                 Rec.MODIFY(FALSE);

                                 CurrPage.UPDATE();
                               END;
                                }
      { 1000000023;1 ;Action    ;
                      Name=DeleteEntry;
                      CaptionML=[ENU=Delete Entry;
                                 DEA=Eintrag L”schen];
                      Promoted=Yes;
                      Enabled=("CM Log Type" = "CM Log Type"::Picture) OR ("CM Log Type" = "CM Log Type"::Attachment) OR ("CM Log Type" = "CM Log Type"::Comment);
                      PromotedIsBig=Yes;
                      Image=CancelLine;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMGenMgt.DeleteLogEntry(Rec, TRUE);
                                 CurrPage.UPDATE();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                GroupType=Repeater }

    { 1000000003;2;Field  ;
                SourceExpr=Date }

    { 1000000006;2;Field  ;
                SourceExpr="Time of Interaction" }

    { 1000000011;2;Field  ;
                SourceExpr="CM Log Type" }

    { 1000000013;2;Field  ;
                SourceExpr=Description;
                Style=Strong;
                StyleExpr=TRUE }

    { 1000000010;2;Field  ;
                SourceExpr="CM Source" }

    { 1000000012;2;Field  ;
                SourceExpr="CM Source No." }

    { 1000000005;2;Field  ;
                SourceExpr="User ID" }

    { 1000000014;2;Field  ;
                SourceExpr="CM Object No." }

    { 1000000008;2;Field  ;
                CaptionML=[ENU=Workorder No.;
                           DEA=Arbeitsauftragnr.];
                SourceExpr="Opportunity No." }

    { 1000000007;2;Field  ;
                CaptionML=[ENU=Task No.;
                           DEA=Aufgabennr.];
                SourceExpr="To-do No." }

    { 1000000004;2;Field  ;
                Name=Attachment;
                CaptionML=[ENU=Attachment;
                           DEA=Dateianhang];
                BlankZero=Yes;
                SourceExpr="Attachment No." <> 0;
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               IF "Attachment No." <> 0 THEN
                                 Rec.OpenAttachment;
                             END;
                              }

    { 1000000017;2;Field  ;
                SourceExpr="CM Internal" }

    { 1000000018;2;Field  ;
                SourceExpr="CM Health And Safety Document" }

    { 1000000002;0;Container;
                ContainerType=FactBoxArea }

    { 1000000009;1;Part   ;
                Name=CommentPage;
                SubPageLink=Entry No.=FIELD(Entry No.);
                PagePartID=Page70703;
                PartType=Page }

    { 1000000020;1;Part   ;
                Name=PhotoPage;
                SubPageLink=Entry No.=FIELD(Entry No.);
                PagePartID=Page70708;
                Visible=_showPhoto;
                Enabled=_showPhoto;
                Editable=FALSE;
                PartType=Page }

  }
  CODE
  {
    VAR
      _showPhoto@1000000000 : Boolean INDATASET;
      CMGenMgt@1000000001 : Codeunit 70000;

    BEGIN
    END.
  }
}

OBJECT Page 70112 CMMS Task List
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=14:47:00;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Tasks;
               DEA=Aufgaben];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5080;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(No.)
                    WHERE(CM Type=CONST(Task));
    PageType=List;
    ActionList=ACTIONS
    {
      { 1000000005;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000006;1 ;ActionGroup }
      { 1000000007;2 ;Action    ;
                      Name=Card;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=View;
                      PromotedCategory=New;
                      OnAction=BEGIN
                                 CMTaskMgt.ShowTaskCard(Rec);
                               END;
                                }
      { 1000000019;2 ;Action    ;
                      Name=ScheduleTask;
                      CaptionML=[ENU=Schedule Task;
                                 DEA=Aufgabe Planen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Apply;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMSctMgt.ScheduleTask(Rec);
                               END;
                                }
      { 1000000018;2 ;Action    ;
                      Name=ToggleInternal;
                      CaptionML=[ENU=Toggle 'Internal';
                                 DEA='Intern' umschalten];
                      Image=Approvals;
                      OnAction=BEGIN
                                 Rec."CM Internal" := NOT Rec."CM Internal";
                                 Rec.MODIFY(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="No." }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000008;2;Field  ;
                SourceExpr="CM Extended Description";
                Visible=FALSE }

    { 1000000004;2;Field  ;
                SourceExpr="CM Status";
                Visible=FALSE }

    { 1000000012;2;Field  ;
                SourceExpr="CM Due Date" }

    { 1000000009;2;Field  ;
                SourceExpr="CM Scheduled Date" }

    { 1000000010;2;Field  ;
                SourceExpr="CM Scheduled Time" }

    { 1000000011;2;Field  ;
                SourceExpr="CM Duration (Planned)" }

    { 1000000013;2;Field  ;
                SourceExpr="CM Assigned User ID" }

    { 1000000014;2;Field  ;
                SourceExpr="CM Assigned User Name" }

    { 1000000017;2;Field  ;
                SourceExpr="CM Object Name" }

    { 1000000016;2;Field  ;
                SourceExpr="CM Object No." }

    { 1000000015;2;Field  ;
                SourceExpr="CM Objecttype" }

  }
  CODE
  {
    VAR
      CMTaskMgt@1000000000 : Codeunit 70031;
      CMSctMgt@1000000001 : Codeunit 70029;

    BEGIN
    END.
  }
}

OBJECT Page 70113 CMMS Task Subpage
{
  OBJECT-PROPERTIES
  {
    Date=11.05.18;
    Time=11:27:56;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=Yes;
    CaptionML=[ENU=Tasks;
               DEA=Aufgaben];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    LinksAllowed=No;
    SourceTable=Table5080;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(No.)
                    WHERE(CM Type=CONST(Task),
                          CM Maintask No.=CONST());
    PageType=ListPart;
    OnOpenPage=BEGIN
                 IF Camera.IsAvailable THEN BEGIN
                   Camera := Camera.Create();
                   _cameraAvailable := TRUE;
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       Style := '';
                       IF "CM Status" = "CM Status"::"Done Positive" THEN
                         Style := 'Favorable';
                       IF "CM Status" = "CM Status"::"Done Negative" THEN
                         Style := 'Unfavorable';
                       IF "CM Status" = "CM Status"::Closed THEN
                         Style := 'Subordinate';
                       IF "CM Status" = "CM Status"::Open THEN
                         Style := 'StandardAccent';

                     END;

    ActionList=ACTIONS
    {
      { 1000000002;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000004;1 ;Action    ;
                      Name=FinishTask;
                      CaptionML=[ENU=Task Done;
                                 DEA=Aufgabe Erledigt];
                      Image=Approve;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 CMTaskMgt.ChangeTaskStatusUI(Rec);
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1000000007;1 ;Action    ;
                      Name=TakePicture;
                      CaptionML=[ENU=Take Photo;
                                 DEA=Foto machen];
                      Visible=_cameraAvailable;
                      Enabled=_cameraAvailable;
                      Image=Camera;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 IF NOT _cameraAvailable THEN
                                   EXIT;

                                 CameraOptions := CameraOptions.CameraOptions();
                                 CameraOptions.Quality := 80; //Jpg Quality from 1 to 100%
                                 Camera.RequestPictureAsync(CameraOptions);
                               END;
                                }
      { 1000000008;1 ;Action    ;
                      Name=Card;
                      ShortCutKey=Return;
                      CaptionML=[ENU=Card;
                                 DEA=Karte];
                      Image=CheckList;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 CMTaskMgt.ShowTaskCard(Rec);
                               END;
                                }
      { 1000000015;1 ;Action    ;
                      Name=ChangeAssignedUsers;
                      CaptionML=ENU=Change Assigned Users;
                      Image=CoupledUsers;
                      OnAction=VAR
                                 Rec2@1000000000 : Record 5080;
                                 Page@1000000001 : Page 70107;
                                 NewAssignedUserId@1000000002 : Code[50];
                               BEGIN
                                 CurrPage.SETSELECTIONFILTER(Rec2);
                                 IF Rec2.FIND('-') THEN BEGIN
                                   Page.SetUserID(Rec2."CM Assigned User ID");
                                   Page.LOOKUPMODE(FALSE);
                                   IF Page.RUNMODAL <> ACTION::OK THEN
                                     EXIT;
                                   NewAssignedUserId := Page.GetUserID();

                                   REPEAT
                                     CMTaskMgt.ChangeAssignedUserID(Rec2, NewAssignedUserId, Rec2."CM Assigned User ID", TRUE);
                                   UNTIL Rec2.NEXT = 0;
                                 END;

                                 CurrPage.UPDATE(FALSE);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                GroupType=Repeater }

    { 1000000005;2;Field  ;
                SourceExpr="No.";
                Editable=FALSE }

    { 1000000009;2;Field  ;
                SourceExpr=Description }

    { 1000000010;2;Field  ;
                SourceExpr=Priority }

    { 1000000003;2;Field  ;
                SourceExpr="CM Status";
                Editable=FALSE;
                StyleExpr=Style;
                OnDrillDown=BEGIN
                              CMTaskMgt.ChangeTaskStatusUI(Rec);
                              CurrPage.UPDATE();
                            END;
                             }

    { 1000000014;2;Field  ;
                SourceExpr="CM Due Date" }

    { 1000000011;2;Field  ;
                SourceExpr="CM Assigned User ID" }

    { 1000000006;2;Field  ;
                SourceExpr="CM Scheduled Date";
                Visible=FALSE }

    { 1000000012;2;Field  ;
                SourceExpr="CM Scheduled Time";
                Visible=FALSE }

    { 1000000013;2;Field  ;
                SourceExpr="CM Duration (Planned)";
                Visible=FALSE }

  }
  CODE
  {
    VAR
      Style@1000000001 : Text INDATASET;
      CMTaskMgt@1000000002 : Codeunit 70031;
      Camera@1000000004 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.CameraProvider" WITHEVENTS RUNONCLIENT;
      CameraOptions@1000000003 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.CameraOptions";
      _cameraAvailable@1000000005 : Boolean INDATASET;

    EVENT Camera@1000000004::PictureAvailable@10(PictureName@1000000001 : Text;PictureFilePath@1000000000 : Text);
    BEGIN
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70114 CMMS New Task Wizzard
{
  OBJECT-PROPERTIES
  {
    Date=03.07.17;
    Time=12:50:39;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=New;
               DEA=Neu];
    InsertAllowed=No;
    DeleteAllowed=No;
    SourceTable=Table5080;
    DataCaptionExpr=Text001;
    PageType=ConfirmationDialog;
    SourceTableTemporary=Yes;
    InstructionalTextML=[ENU=Create New Task...;
                         DEA=Neue Aufgabe erstellen...];
    ShowFilter=No;
    OnOpenPage=BEGIN
                 Rec.FINDFIRST();
                 {Rec.INIT;
                 Rec."No." := '';
                 Rec."CM Type" := Rec."CM Type"::Task;
                 Rec."CM Maintask No." := '';

                 Rec."Opportunity No." := Wo."No.";
                 Rec."CM Assigned User ID" := Wo."CM Assigned User ID";
                 Rec.INSERT(FALSE);

                 Rec.SETRECFILTER();}
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000003;1;Field  ;
                SourceExpr=Description }

    { 1000000008;1;Field  ;
                SourceExpr="CM Extended Description";
                MultiLine=Yes }

    { 1000000001;1;Field  ;
                CaptionML=[ENU=Workorder No.;
                           DEA=Arbeitsauftrag Nr.];
                SourceExpr="Opportunity No.";
                Editable=FALSE }

    { 1000000002;1;Field  ;
                SourceExpr="CM Assigned User ID" }

    { 1000000004;1;Field  ;
                SourceExpr="CM Scheduled Date" }

    { 1000000005;1;Field  ;
                SourceExpr="CM Scheduled Time" }

    { 1000000006;1;Field  ;
                SourceExpr="CM Duration (Planned)" }

    { 1000000007;1;Field  ;
                SourceExpr="CM Internal" }

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=New Workorder;DEA=Neuer Arbeitsauftrag';

    PROCEDURE SetRec@1000000000(VAR TempRec@1000000000 : TEMPORARY Record 5080);
    BEGIN
      Rec.COPY(TempRec, TRUE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70115 CMMS End Task
{
  OBJECT-PROPERTIES
  {
    Date=09.03.18;
    Time=10:48:31;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Finish Task;
               DEA=Aufgabe Erledigen];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    PageType=ConfirmationDialog;
    InstructionalTextML=[ENU=Do you want to finish this Task?;
                         DEA=Wollen Sie diese Aufgabe erledigen?];
    ShowFilter=No;
    OnOpenPage=VAR
                 CMGenSetup@1000000000 : Record 70000;
                 UoM@1000000001 : Record 204;
                 CMGenMgt@1000000002 : Codeunit 70000;
               BEGIN
                 IF NOT DataSet THEN
                   ERROR(Text003);

                 TempNewComponent.INIT;
                 ClosingType := ClosingType::Positive;
                 TimeNeededCaption := 'x1';

                 IF NOT CMGenSetup.GET() THEN
                     CMGenSetup.INIT;

                 TimeNeededCaption := STRSUBSTNO(Text006, CMGenMgt.GetUoMTranslated(CMGenSetup."Default UoM Code"));
               END;

    OnQueryClosePage=BEGIN
                       IF CloseAction = ACTION::Yes THEN BEGIN
                         ValidateData();
                       END;
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000002;1;Field  ;
                Name=ClosingType;
                CaptionML=[ENU=Closing Type;
                           DEA=Art der Erledigung];
                OptionCaptionML=[ENU=Positive,Negative;
                                 DEA=Positiv,Negativ];
                SourceExpr=ClosingType;
                Visible=_showClosingType;
                OnValidate=VAR
                             value@1000000000 : Boolean;
                           BEGIN
                             IF ClosingType = ClosingType::Negative THEN BEGIN
                               _showComment := TRUE;
                               _showImportFilename := FALSE;
                               _showNewCompDescription := FALSE;
                               _showNewCompSerialNo := FALSE;
                               _showNewCompType := FALSE;
                               _showOldComponent := FALSE;

                               _requireComment := TRUE;
                               _requireImportFilename := FALSE;
                               _requireNewCompDescription := FALSE;
                               _requireNewCompSerialNo := FALSE;
                               _requireNewCompType := FALSE;
                               _requireOldComponent := FALSE;
                             END
                             ELSE BEGIN
                               _showComment := FALSE;
                               _showImportFilename := FALSE;
                               _showNewCompDescription := FALSE;
                               _showNewCompSerialNo := FALSE;
                               _showNewCompType := FALSE;
                               _showOldComponent := FALSE;

                               _requireComment := FALSE;
                               _requireImportFilename := FALSE;
                               _requireNewCompDescription := FALSE;
                               _requireNewCompSerialNo := FALSE;
                               _requireNewCompType := FALSE;
                               _requireOldComponent := FALSE;

                               SetData(Task);
                             END;
                             CurrPage.UPDATE(TRUE);
                           END;

                ShowMandatory=_requireClosingType }

    { 1000000001;1;Field  ;
                Name=CommentText;
                CaptionML=[ENU=Comment / Reason;
                           DEA=Kommentar / Grund];
                SourceExpr=CommentText;
                Visible=_showComment;
                ShowMandatory=_requireComment }

    { 1000000003;1;Field  ;
                Name=ImportFilename;
                CaptionML=[ENU=File;
                           DEA=Datei];
                SourceExpr=ImportFilename;
                Visible=_showImportFilename;
                Editable=FALSE;
                OnAssistEdit=BEGIN
                               ImportFilename := CMTaskMgt.ImportFileInAttachment(TempAttach);
                             END;

                ShowMandatory=_requireImportFilename }

    { 1000000004;1;Field  ;
                Name=OldComponentText;
                CaptionML=[ENU=Old Module;
                           DEA=Altes Modul];
                SourceExpr=OldComponentText;
                Visible=_showOldComponent;
                Editable=FALSE;
                OnAssistEdit=VAR
                               ListPage@1000000000 : Page 70080;
                               LocComp@1000000001 : Record 70025;
                               Asset@1000000002 : Record 70020;
                             BEGIN
                               //here

                               LocComp.RESET;
                               LocComp.SETRANGE(Type, LocComp.Type::Equipment);
                               LocComp.SETRANGE(Key1, Task."CM Object No.");
                               //OldComponent.SETRANGE("Line Type", LocComp."Line Type"::Line);

                               ListPage.LOOKUPMODE(TRUE);
                               ListPage.SETTABLEVIEW(LocComp);
                               IF ListPage.RUNMODAL = ACTION::LookupOK THEN BEGIN
                                 ListPage.GETRECORD(LocComp);
                                 OldComponentText := FORMAT(LocComp."Component Type") + ' - ' + LocComp.Description;
                                 OldComponent := LocComp;
                               END;
                             END;

                ShowMandatory=_requireOldComponent }

    { 1000000007;1;Field  ;
                Name=NewCompType;
                CaptionML=[ENU=Type of New Module;
                           DEA=Typ Neues Modul];
                SourceExpr=TempNewComponent."Component Type";
                Visible=_showNewCompType;
                ShowMandatory=_requireNewCompType }

    { 1000000005;1;Field  ;
                Name=NewCompSerialNo;
                CaptionML=[ENU=Serial No. New Module;
                           DEA=Seriennr. Neues Modul];
                SourceExpr=TempNewComponent."Serial Number";
                Visible=_showNewCompSerialNo;
                ShowMandatory=_requireNewCompSerialNo }

    { 1000000006;1;Field  ;
                Name=NewCompDescription;
                CaptionML=[ENU=Description New Module;
                           DEA=Beschreibung Neues Modul];
                SourceExpr=TempNewComponent.Description;
                Visible=_showNewCompDescription;
                ShowMandatory=_requireNewCompDescription }

    { 1000000008;1;Field  ;
                Name=TimeNeeded;
                SourceExpr=TimeNeeded;
                CaptionClass=TimeNeededCaption }

  }
  CODE
  {
    VAR
      Task@1000000030 : Record 5080;
      CMTaskMgt@1000000008 : Codeunit 70031;
      _showComment@1000000005 : Boolean INDATASET;
      _showClosingType@1000000012 : Boolean INDATASET;
      _showImportFilename@1000000004 : Boolean INDATASET;
      _showOldComponent@1000000009 : Boolean INDATASET;
      _showNewCompSerialNo@1000000010 : Boolean INDATASET;
      _showNewCompType@1000000028 : Boolean INDATASET;
      _showNewCompDescription@1000000011 : Boolean INDATASET;
      _requireComment@1000000023 : Boolean INDATASET;
      _requireClosingType@1000000022 : Boolean INDATASET;
      _requireImportFilename@1000000021 : Boolean INDATASET;
      _requireOldComponent@1000000020 : Boolean INDATASET;
      _requireNewCompSerialNo@1000000019 : Boolean INDATASET;
      _requireNewCompType@1000000027 : Boolean INDATASET;
      _requireNewCompDescription@1000000018 : Boolean INDATASET;
      DataSet@1000000016 : Boolean;
      TempAttach@1000000007 : TEMPORARY Record 5062;
      Text001@1000000002 : TextConst 'ENU=You must upload a File!;DEA=Sie mssen eine Datei hochladen!';
      Text002@1000000003 : TextConst 'ENU=You must enter a Comment!;DEA=Sie mssen einen Kommentar eingeben!';
      Text003@1000000017 : TextConst 'ENU=Invalid Page Call! Use SetData() before.;DEA=Ungltiger Seitenaufruf! Benutzen sie SetData() davor.';
      Text004@1000000024 : TextConst 'ENU=Record is no CMMS Task!;DEA=Record ist kein CMMS Task!';
      Text005@1000000026 : TextConst 'ENU=Please fill all required fields!;DEA=Bitte befllen Sie alle Pflichtfelder!';
      TimeNeeded@1000000031 : Decimal;
      TimeNeededCaption@1000000032 : Text INDATASET;
      Text006@1000000033 : TextConst 'ENU=Time Needed [%1];DEA=Zeit Ben”tigt [%1]';
      Text007@1000000034 : TextConst 'ENU=h;DEA=h';
      CommentText@1000000013 : Text[250];
      ClosingType@1000000001 : 'Positive,Negative';
      ImportFilename@1000000000 : Text;
      OldComponent@1000000015 : Record 70025;
      TempNewComponent@1000000014 : TEMPORARY Record 70025;
      OldComponentText@1000000006 : Text;

    PROCEDURE GetNewStatus@1000000002() : Integer;
    VAR
      Task@1000000000 : Record 5080;
    BEGIN
      IF ClosingType = ClosingType::Positive THEN
        EXIT(Task."CM Status"::"Done Positive");

      EXIT(Task."CM Status"::"Done Negative");
    END;

    PROCEDURE GetComment@1000000001() : Text;
    BEGIN
      EXIT(CommentText);
    END;

    PROCEDURE GetAttachment@1000000003(VAR AttachmentTemp@1000000000 : TEMPORARY Record 5062);
    BEGIN
      AttachmentTemp.INIT;
      AttachmentTemp.COPY(TempAttach);
    END;

    PROCEDURE GetOldComponent@1000000020(VAR OldAssetComponent@1000000000 : Record 70025) : Boolean;
    BEGIN
      EXIT(OldAssetComponent.GET
            (
              OldComponent.Objecttype,
              OldComponent.Type,
              OldComponent."Component Type",
              OldComponent.Key1,
              OldComponent."Entry No."
            ));
    END;

    PROCEDURE GetNewComponent@1000000006(VAR TempNewComponent_@1000000000 : TEMPORARY Record 70025);
    BEGIN
      TempNewComponent_ := TempNewComponent;
    END;

    PROCEDURE GetTimeNeeded@1000000005() : Decimal;
    BEGIN
      EXIT(TimeNeeded);
    END;

    PROCEDURE SetData@1000000000(Rec@1000000000 : Record 5080) : Integer;
    VAR
      Asset@1000000001 : Record 70020;
    BEGIN
      IF (Rec."CM Type" <> Rec."CM Type"::Task) THEN
        ERROR(Text004);

      Task := Rec;
      _showClosingType := TRUE;
      _showComment := TRUE;

      _requireClosingType := TRUE;
      _requireComment := FALSE;

      //Information Type
      IF (Rec."CM Wizard Action" = Rec."CM Wizard Action"::Information) THEN BEGIN

        IF (Rec."CM Information Type" = Rec."CM Information Type"::Comment) OR
           (Rec."CM Information Type" = Rec."CM Information Type"::Comment) THEN BEGIN

          _showComment := TRUE;

          _requireComment := TRUE;
        END;

        IF (Rec."CM Information Type" = Rec."CM Information Type"::Installation) THEN BEGIN
          _showNewCompDescription := TRUE;
          _showNewCompSerialNo := TRUE;
          _showNewCompType := TRUE;

          _requireNewCompType := TRUE;
          _requireNewCompDescription := TRUE;
        END;

        IF (Rec."CM Information Type" = Rec."CM Information Type"::Replacement) THEN BEGIN
          _showNewCompDescription := TRUE;
          _showNewCompSerialNo := TRUE;
          _showOldComponent := TRUE;

          _requireNewCompDescription := TRUE;
        END;
      END;

      //Standard Wizzard
      IF (Rec."CM Wizard Action" = Rec."CM Wizard Action"::Import) THEN BEGIN
        _showClosingType := TRUE;
        _showComment := TRUE;
        _showImportFilename := TRUE;

        _requireClosingType := TRUE;
        _requireImportFilename := TRUE;
      END;

      DataSet := TRUE;
    END;

    LOCAL PROCEDURE ValidateData@1000000004();
    BEGIN
      IF ((_requireComment) AND (CommentText = '')) OR
         ((_requireImportFilename) AND (ImportFilename = '')) OR
         ((_requireNewCompDescription) AND (TempNewComponent.Description = '')) OR
         ((_requireNewCompSerialNo) AND (TempNewComponent."Serial Number" = '')) OR
         ((_requireNewCompType) AND (FORMAT(TempNewComponent."Component Type") = '')) OR
         ((_requireOldComponent) AND ((OldComponent.Key1 = '')))
      THEN
        ERROR(Text005);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70116 CMMS Track Task Time
{
  OBJECT-PROPERTIES
  {
    Date=07.06.17;
    Time=09:49:46;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Track Time;
               DEA=Zeit Buchen];
    SourceTable=Table5080;
    PageType=ConfirmationDialog;
    SourceTableTemporary=Yes;
    InstructionalTextML=[ENU=Track Time for this Task?;
                         DEA=Zeiten fr diese Aufgabe erfassen?];
    OnInit=BEGIN
             INIT;
             INSERT(FALSE);
             FINDFIRST();
             SETRECFILTER();
           END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000002;1;Field  ;
                CaptionML=[ENU=Hours;
                           DEA=Stunden];
                SourceExpr=Dur }

  }
  CODE
  {
    VAR
      Dur@1000000000 : Decimal;

    PROCEDURE GetDuration@1000000000() : Decimal;
    BEGIN
      EXIT(Dur);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70117 CMMS Checklist Subpage
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=17:28:08;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=Yes;
    CaptionML=[ENU=Checklist;
               DEA=Checkliste];
    InsertAllowed=Yes;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    LinksAllowed=No;
    SourceTable=Table5080;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(No.)
                    WHERE(CM Type=CONST(Task),
                          CM Subtype=CONST(Checklist));
    PageType=ListPart;
    OnAfterGetRecord=BEGIN
                       IF Rec."CM Maintask No." = '' THEN
                         ERROR(STRSUBSTNO(Text001, Rec."No."));

                       Update();
                     END;

    OnAfterGetCurrRecord=BEGIN
                           Update();
                         END;

    ActionList=ACTIONS
    {
      { 1000000002;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000004;1 ;Action    ;
                      Name=FinishTask;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Change Status;
                                 DEA=Status „ndern];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 CMTaskMgt.ChangeChecklistItemStatus(Rec);
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1000000005;1 ;Action    ;
                      Name=Status Change;
                      CaptionML=[ENU=Status Change;
                                 DEA=Status„nderungen];
                      Image=Status;
                      OnAction=VAR
                                 LogEntry@1000000000 : Record 5065;
                               BEGIN
                                 CMTaskMgt.ShowRelatedLogs(Rec, FORMAT(LogEntry."CM Log Type"::"Status Change" + 0));
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                GroupType=Repeater }

    { 1000000009;2;Field  ;
                SourceExpr=Description;
                Editable=_editable }

    { 1000000003;2;Field  ;
                CaptionML=ENU=Status;
                OptionCaptionML=ENU=---,Yes,No,Not Applicable;
                SourceExpr="CM Status";
                Editable=FALSE;
                StyleExpr=_style;
                OnDrillDown=BEGIN
                              CMTaskMgt.ChangeChecklistItemStatus(Rec);
                              CurrPage.UPDATE();
                            END;
                             }

  }
  CODE
  {
    VAR
      _style@1000000001 : Text INDATASET;
      _editable@1000000000 : Boolean INDATASET;
      CMTaskMgt@1000000002 : Codeunit 70031;
      Text001@1000000003 : TextConst 'ENU=Record is no Subtask. No. %1;DEA=Datensatz ist keine Unteraufgabe. Nr. %1';
      Text002@1000000004 : TextConst 'ENU=Mark as Done;DEA=Erledigen';

    LOCAL PROCEDURE Update@1000000006();
    BEGIN
      _style := '';
      _editable := FALSE;

      IF "CM Status" = "CM Status"::"Done Positive" THEN BEGIN //Yes
        _style := 'Favorable';
      END;
      IF "CM Status" = "CM Status"::"Done Negative" THEN BEGIN //No
        _style := 'Unfavorable';
      END;
      IF "CM Status" = "CM Status"::Closed THEN BEGIN //Not Applicable
        _style := 'Subordinate';
      END;
      IF "CM Status" = "CM Status"::Open THEN BEGIN //---
        _style := 'StandardAccent';
        _editable := TRUE;
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70118 CMMS Asset/Project Lookup List
{
  OBJECT-PROPERTIES
  {
    Date=18.11.16;
    Time=11:51:26;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    MultipleNewLines=No;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70020;
    DataCaptionExpr=CaptionText;
    PageType=List;
    ShowFilter=No;
    OnAfterGetRecord=BEGIN
                       _style := '';
                       {
                       IF Rec."Main/Subasset" = Rec."Main/Subasset"::"Main Asset" THEN
                         _style := 'Strong';
                       }
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="No.";
                StyleExpr=_style }

    { 1000000003;2;Field  ;
                SourceExpr=Name;
                StyleExpr=_style }

    { 1000000004;2;Field  ;
                SourceExpr="Name 2" }

    { 1000000005;2;Field  ;
                SourceExpr="Country Code" }

    { 1000000007;2;Field  ;
                SourceExpr="Asset Type" }

    { 1000000006;2;Field  ;
                SourceExpr="Main Asset No." }

  }
  CODE
  {
    VAR
      CaptionText@1000000000 : Text;
      _style@1000000001 : Text[20] INDATASET;

    PROCEDURE SetCaption@1000000003(value@1000000000 : Text[20]);
    BEGIN
      CaptionText := value;
    END;

    PROCEDURE GetNo@1000000000() : Code[20];
    BEGIN
      EXIT(Rec."No.");
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70119 CMMS Task Card
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=14:49:25;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Task Card;
               DEA=Aufgabenkarte];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5080;
    SourceTableView=SORTING(No.)
                    WHERE(CM Type=CONST(Task),
                          CM Maintask No.=CONST());
    PageType=Card;
    OnOpenPage=BEGIN
                 LoadCamera();
               END;

    OnAfterGetRecord=BEGIN
                       SetEditable;

                       CALCFIELDS("CM Assigned User Name");

                       IF Rec."CM Assigned User ID" <> USERID THEN
                         CurrPage.TeamSubpage.PAGE.SetUserIDFilter();

                       _style := '';
                       IF "CM Status" = "CM Status"::"Done Positive" THEN
                         _style := 'Favorable';
                       IF "CM Status" = "CM Status"::"Done Negative" THEN
                         _style := 'Unfavorable';
                       IF "CM Status" = "CM Status"::Closed THEN
                         _style := 'Subordinate';
                       IF "CM Status" = "CM Status"::Open THEN
                         _style := 'StandardAccent';
                     END;

    OnAfterGetCurrRecord=BEGIN
                           SetEditable();
                         END;

    ActionList=ACTIONS
    {
      { 1000000014;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000013;1 ;Action    ;
                      Name=FinishTask;
                      CaptionML=[ENU=Task Done;
                                 DEA=Aufgabe Erledigt];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      PromotedCategory=Process;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 CMTaskMgt.ChangeTaskStatusUI(Rec);
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1000000011;1 ;Action    ;
                      Name=TakePicture;
                      CaptionML=[ENU=Take Photo;
                                 DEA=Foto machen];
                      Promoted=Yes;
                      Visible=_cameraAvailable;
                      Enabled=_cameraAvailable;
                      PromotedIsBig=Yes;
                      Image=Camera;
                      PromotedCategory=Process;
                      Scope=Repeater;
                      OnAction=VAR
                                 CMGenSetup@1000000000 : Record 70000;
                               BEGIN
                                 IF NOT _cameraAvailable THEN
                                   EXIT;
                                 IF NOT CMGenSetup.GET() THEN
                                   CMGenSetup.INIT();

                                 CameraOptions := CameraOptions.CameraOptions();
                                 CameraOptions.Quality := CMGenSetup."Photo Quality %"; //Jpg Quality from 1 to 100%
                                 Camera.RequestPictureAsync(CameraOptions);
                               END;
                                }
      { 1000000036;1 ;Action    ;
                      Name=AddPicture;
                      CaptionML=[ENU=Add Picture;
                                 DEA=Bild hinzufgen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Picture;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMTaskMgt.AddAttachment(Rec, TRUE);
                               END;
                                }
      { 1000000021;1 ;Action    ;
                      Name=AddAttachment;
                      CaptionML=[ENU=Add Attachment;
                                 DEA=Anhang hinzufgen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Attach;
                      PromotedCategory=Process;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 CMTaskMgt.AddAttachment(Rec, FALSE);
                               END;
                                }
      { 1000000012;1 ;Action    ;
                      Name=NewComment;
                      CaptionML=[ENU=New Comment;
                                 DEA=Neuer Kommentar];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ViewComments;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMTaskMgt.AddCommentUI(Rec, 0);
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1000000015;1 ;Action    ;
                      Name=PostTime;
                      CaptionML=[ENU=Track Time;
                                 DEA=Zeiten Erfassen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostedTimeSheet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 CMTaskMgt.TrackTaskTime(Rec);
                               END;
                                }
      { 1000000037;1 ;Action    ;
                      Name=ToggleInternal;
                      CaptionML=[ENU=Toggle 'Internal';
                                 DEA='Intern' umschalten];
                      Image=Approvals;
                      OnAction=BEGIN
                                 Rec."CM Internal" := NOT Rec."CM Internal";
                                 Rec.MODIFY(FALSE);
                               END;
                                }
      { 1000000020;  ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000019;1 ;ActionGroup;
                      CaptionML=[ENU=History;
                                 DEA=Historie];
                      Image=History }
      { 1000000016;2 ;Action    ;
                      Name=Activities;
                      CaptionML=[ENU=Activities;
                                 DEA=Aktivit„ten];
                      Image=InteractionLog;
                      OnAction=BEGIN
                                 CMTaskMgt.ShowRelatedLogs(Rec, '');
                               END;
                                }
      { 1000000030;2 ;Action    ;
                      Name=Status Change;
                      CaptionML=[ENU=Status Change;
                                 DEA=Status„nderungen];
                      Image=Status;
                      OnAction=BEGIN
                                 CMTaskMgt.ShowRelatedLogs(Rec, STRSUBSTNO('%1', LogEntry."CM Log Type"::"Status Change"));
                               END;
                                }
      { 1000000029;2 ;Action    ;
                      Name=Attachments;
                      CaptionML=[ENU=Attachments;
                                 DEA=Anh„nge];
                      Image=Attach;
                      OnAction=BEGIN
                                 CMTaskMgt.ShowRelatedLogs(Rec, STRSUBSTNO('%1', LogEntry."CM Log Type"::Attachment));
                               END;
                                }
      { 1000000028;2 ;Action    ;
                      Name=Photos;
                      CaptionML=[ENU=Pictues;
                                 DEA=Fotos];
                      Image=Picture;
                      OnAction=BEGIN
                                 CMTaskMgt.ShowRelatedLogs(Rec, STRSUBSTNO('%1', LogEntry."CM Log Type"::Picture));
                               END;
                                }
      { 1000000017;2 ;Action    ;
                      Name=TrackedTime;
                      CaptionML=[ENU=Tracked Time;
                                 DEA=Erfasste Zeiten];
                      Image=JobTimeSheet;
                      OnAction=BEGIN
                                 CMTTMgt.ShowPostedEntriesToTask(Rec, 1);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000010;1;Part   ;
                Name=Comments;
                CaptionML=[ENU=Comments;
                           DEA=Kommentare];
                SubPageView=SORTING(CM Is CMMS Log Entry,CM Source,CM Source No.,CM Log Type)
                            ORDER(Descending);
                SubPageLink=CM Is CMMS Log Entry=CONST(Yes),
                            CM Source=CONST(Task),
                            CM Source No.=FIELD(No.),
                            CM Log Type=CONST(Comment);
                PagePartID=Page70110;
                PartType=Page }

    { 1000000001;1;Group  ;
                Name=Allgemein;
                GroupType=Group }

    { 1000000002;2;Field  ;
                SourceExpr="No.";
                Editable=FALSE }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000018;2;Field  ;
                SourceExpr="CM Extended Description";
                MultiLine=Yes }

    { 1000000027;2;Field  ;
                CaptionML=[ENU=Workorder No.;
                           DEA=Arbeitsauftrag Nr.];
                SourceExpr="Opportunity No.";
                Editable=FALSE;
                OnLookup=VAR
                           Workorder@1000000000 : Record 5092;
                         BEGIN
                           IF Workorder.GET(Rec."Opportunity No.") THEN
                             CMWoMgt.ShowWorkorderCard(Workorder);
                         END;
                          }

    { 1000000004;2;Field  ;
                SourceExpr=Priority }

    { 1000000005;2;Field  ;
                SourceExpr="CM Status";
                Editable=FALSE;
                StyleExpr=_style;
                OnDrillDown=BEGIN
                              CMTaskMgt.ChangeTaskStatusUI(Rec);
                              CurrPage.UPDATE();
                            END;
                             }

    { 1000000008;2;Field  ;
                SourceExpr="CM Assigned User ID" }

    { 1000000009;2;Field  ;
                SourceExpr="CM Assigned User Name" }

    { 1000000026;2;Field  ;
                SourceExpr="CM Due Date" }

    { 1000000022;2;Field  ;
                SourceExpr="CM Scheduled Date" }

    { 1000000023;2;Field  ;
                SourceExpr="CM Scheduled Time" }

    { 1000000024;2;Field  ;
                SourceExpr="CM Duration (Planned)" }

    { 1000000007;1;Part   ;
                Name=ChecklistSubpage;
                SubPageView=SORTING(CM Type,CM Maintask No.,CM Assigned User ID,CM Status);
                SubPageLink=CM Type=CONST(Task),
                            CM Maintask No.=FIELD(No.),
                            CM Subtype=CONST(Checklist);
                PagePartID=Page70117;
                Visible=_visibleChecklist;
                PartType=Page }

    { 1000000006;1;Part   ;
                Name=TeamSubpage;
                SubPageView=SORTING(CM Type,CM Maintask No.,CM Assigned User ID,CM Status);
                SubPageLink=CM Type=CONST(Task),
                            CM Subtype=FILTER(' '|Team),
                            CM Maintask No.=FIELD(No.),
                            Opportunity No.=FIELD(Opportunity No.);
                PagePartID=Page70122;
                Visible=TRUE;
                Editable=TRUE;
                PartType=Page }

    { 1000000032;1;Group  ;
                Name=Additional;
                CaptionML=[ENU=Additional;
                           DEA=Erweitert];
                GroupType=Group }

    { 1000000033;2;Field  ;
                SourceExpr="CM Wizard Action" }

    { 1000000034;2;Field  ;
                SourceExpr="CM Information Type" }

    { 1000000035;2;Field  ;
                SourceExpr="CM Interaction Group Code" }

    { 1000000031;0;Container;
                ContainerType=FactBoxArea }

    { 1000000025;1;Part   ;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page70710;
                PartType=Page }

  }
  CODE
  {
    VAR
      CMTaskMgt@1000000000 : Codeunit 70031;
      CMGenMgt@1000000005 : Codeunit 70000;
      CMTTMgt@1000000006 : Codeunit 70040;
      CMWoMgt@1000000009 : Codeunit 70030;
      Camera@1000000003 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.CameraProvider" WITHEVENTS RUNONCLIENT;
      CameraOptions@1000000002 : DotNet "'Microsoft.Dynamics.Nav.ClientExtensions, Version=9.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35'.Microsoft.Dynamics.Nav.Client.Capabilities.CameraOptions";
      _cameraAvailable@1000000001 : Boolean INDATASET;
      _style@1000000004 : Text INDATASET;
      _visibleChecklist@1000000007 : Boolean INDATASET;
      _visibleTeam@1000000008 : Boolean INDATASET;
      LogEntry@1000000010 : Record 5065;

    LOCAL PROCEDURE SetEditable@1000000005();
    BEGIN
      _visibleChecklist := TRUE;
      _visibleTeam := TRUE;
      IF (Rec."CM Status" = Rec."CM Status"::Open) AND (CurrPage.EDITABLE) THEN
        CurrPage.Comments.PAGE.SetActionsEnabled(TRUE)
      ELSE
        CurrPage.Comments.PAGE.SetActionsEnabled(FALSE);
    END;

    LOCAL PROCEDURE LoadCamera@1000000000();
    BEGIN
      IF CURRENTCLIENTTYPE <> CLIENTTYPE::Phone THEN
        EXIT;

      IF Camera.IsAvailable THEN BEGIN
        Camera := Camera.Create();
        _cameraAvailable := TRUE;
      END;
    END;

    EVENT Camera@1000000003::PictureAvailable@10(PictureName@1000000001 : Text;PictureFilePath@1000000000 : Text);
    BEGIN
      CMTaskMgt.ProcessTaskPhoto(PictureName, PictureFilePath, Rec);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70120 CMMS New Request
{
  OBJECT-PROPERTIES
  {
    Date=28.11.16;
    Time=14:33:00;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=New Request;
               DEA=Neue Anfrage];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5080;
    PopulateAllFields=Yes;
    PageType=ConfirmationDialog;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             CurrPage.EDITABLE := TRUE;
           END;

    OnOpenPage=BEGIN
                 Rec.RESET();
                 Rec.DELETEALL();
                 Rec.INIT();
                 Rec.INSERT();
               END;

    OnQueryClosePage=BEGIN
                       IF (CloseAction = ACTION::Yes) AND (Rec.Description = '') THEN BEGIN
                         ERROR(Text001);
                       END;
                     END;

  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                SourceExpr=Description;
                ShowMandatory=TRUE }

    { 1000000003;1;Field  ;
                SourceExpr="CM Comment Text" }

    { 1000000002;1;Field  ;
                SourceExpr="CM Request Type";
                ShowMandatory=TRUE }

  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=Please fill all required fields!;DEA=Bitte befllen Sie alle Pflichtfelder!';

    PROCEDURE GetDescription@1000000004() : Text[50];
    BEGIN
      EXIT(Rec.Description);
    END;

    PROCEDURE GetCommentText@1000000000() : Text[250];
    BEGIN
      EXIT(Rec."CM Comment Text");
    END;

    PROCEDURE GetRequestType@1000000005() : Integer;
    BEGIN
      EXIT(Rec."CM Request Type");
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70121 CMMS Request List
{
  OBJECT-PROPERTIES
  {
    Date=27.03.17;
    Time=14:16:42;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=Yes;
    CaptionML=[ENU=Requests;
               DEA=Anfragen];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=Yes;
    SourceTable=Table5080;
    SourceTableView=SORTING(No.)
                    WHERE(CM Type=CONST(Request),
                          CM Status=CONST(Open));
    PageType=List;
    ShowFilter=No;
    OnClosePage=BEGIN
                  Rec.MODIFYALL("CM Selected", FALSE, FALSE);
                END;

    OnAfterGetRecord=BEGIN
                       CALCFIELDS("CM Assigned User Name", "CM Created By User Name");
                       SetStyle();
                     END;

    OnAfterGetCurrRecord=BEGIN
                           SetStyle();
                         END;

    ActionList=ACTIONS
    {
      { 1000000011;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000012;1 ;Action    ;
                      Name=ToWorkorder;
                      CaptionML=[ENU=To Workorder;
                                 DEA=Zu Workorder];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ServiceOrderSetup;
                      PromotedCategory=New;
                      OnAction=VAR
                                 Rec2@1000000000 : Record 5080;
                               BEGIN
                                 CurrPage.SAVERECORD();

                                 CLEAR(Rec2);
                                 Rec2.RESET();
                                 Rec2.COPYFILTERS(Rec);
                                 Rec2.SETRANGE("CM Selected", TRUE);
                                 CMTaskMgt.RequestsToWorkorders(Rec2);
                                 CurrPage.UPDATE();
                               END;
                                }
      { 1000000017;1 ;Action    ;
                      Name=RejectRequests;
                      CaptionML=[ENU=Reject Request(s);
                                 DEA=Anfrage(n) Ablehnen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CancelLine;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 Rec2@1000000000 : Record 5080;
                               BEGIN
                                 CurrPage.SAVERECORD();

                                 CLEAR(Rec2);
                                 Rec2.RESET();
                                 Rec2.COPYFILTERS(Rec);
                                 Rec2.SETRANGE("CM Selected", TRUE);
                                 CMTaskMgt.RejectRequest(Rec2);
                                 CurrPage.UPDATE();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000009;2;Field  ;
                SourceExpr="CM Selected";
                Style=Favorable;
                StyleExpr=TRUE }

    { 1000000002;2;Field  ;
                SourceExpr="No.";
                Editable=FALSE;
                StyleExpr=_style }

    { 1000000003;2;Field  ;
                SourceExpr="CM Request Type";
                Editable=FALSE;
                StyleExpr=_style }

    { 1000000008;2;Field  ;
                CaptionML=[ENU=Created;
                           DEA=Erstellt];
                SourceExpr=Date;
                Editable=FALSE }

    { 1000000010;2;Field  ;
                SourceExpr="CM Scheduled Date";
                StyleExpr=_style }

    { 1000000019;2;Field  ;
                SourceExpr="CM Assigned User ID" }

    { 1000000020;2;Field  ;
                SourceExpr="CM Assigned User Name";
                Editable=FALSE }

    { 1000000005;2;Field  ;
                SourceExpr="CM Created By User ID";
                Editable=FALSE }

    { 1000000006;2;Field  ;
                SourceExpr="CM Created By User Name";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000007;2;Field  ;
                SourceExpr=Description;
                Editable=FALSE }

    { 1000000018;2;Field  ;
                SourceExpr="CM Comment Text" }

    { 1000000004;2;Field  ;
                SourceExpr="CM Status";
                Editable=FALSE }

    { 1000000013;2;Field  ;
                SourceExpr="CM Objecttype";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000014;2;Field  ;
                SourceExpr="CM Object No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000016;2;Field  ;
                CaptionML=[ENU=From Workorder No.;
                           DEA=Von Arbeitsauftragnr.];
                SourceExpr="Opportunity No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1000000015;2;Field  ;
                SourceExpr="CM From Task No.";
                Visible=FALSE;
                Editable=FALSE }

  }
  CODE
  {
    VAR
      CMTaskMgt@1000000000 : Codeunit 70031;
      _style@1000000001 : Text INDATASET;
      _select@1000000002 : Boolean INDATASET;

    LOCAL PROCEDURE SetStyle@1000000000();
    BEGIN
      _style := '';
      IF Rec."CM Scheduled Date" < TODAY THEN
        _style := 'Unfavorable';
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70122 CMMS Team Subpage
{
  OBJECT-PROPERTIES
  {
    Date=22.05.17;
    Time=10:51:59;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=Yes;
    CaptionML=[ENU=Team;
               DEA=Team];
    InsertAllowed=Yes;
    DeleteAllowed=Yes;
    ModifyAllowed=Yes;
    LinksAllowed=No;
    SourceTable=Table5080;
    DelayedInsert=Yes;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(No.)
                    WHERE(CM Type=CONST(Task),
                          CM Subtype=FILTER(' '|Team));
    PageType=ListPart;
    OnAfterGetRecord=BEGIN
                       SetStyle();
                     END;

    OnNewRecord=BEGIN
                  Rec."CM Subtype" := Rec."CM Subtype"::Team;
                  _editable := TRUE;
                END;

    OnDeleteRecord=BEGIN
                     IF NOT _editable THEN
                       ERROR(Text001);
                   END;

    OnAfterGetCurrRecord=BEGIN
                           SetStyle();
                         END;

    ActionList=ACTIONS
    {
      { 1000000002;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000004;1 ;Action    ;
                      Name=FinishTask;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Mark as Done;
                                 DEA=Erledigen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Approve;
                      Scope=Repeater;
                      OnAction=BEGIN
                                 CMTaskMgt.ChangeTaskStatusUI(Rec);
                                 CurrPage.UPDATE();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                GroupType=Repeater }

    { 1000000006;2;Field  ;
                SourceExpr="CM Assigned User ID";
                Editable=_editable;
                StyleExpr=_style2 }

    { 1000000007;2;Field  ;
                SourceExpr="CM Assigned User Name" }

    { 1000000008;2;Field  ;
                Name=TaskResponsible;
                CaptionML=[ENU=Task Responsible;
                           DEA=Aufgabenverantw.];
                SourceExpr="CM Subtype"="CM Subtype"::" " }

  }
  CODE
  {
    VAR
      _style@1000000001 : Text INDATASET;
      _style2@1000000005 : Text INDATASET;
      _showDone@1000000000 : Boolean INDATASET;
      _editable@1000000006 : Boolean INDATASET;
      CMTaskMgt@1000000002 : Codeunit 70031;
      Text001@1000000003 : TextConst 'ENU=Task Responsible cannot be deleted!;DEA=Aufgabenverantwortlicher kann nicht gel”scht werden!';
      Text002@1000000004 : TextConst 'ENU=Mark as Done;DEA=Erledigen';

    LOCAL PROCEDURE GetText@1000000000() : Text;
    BEGIN
      IF Rec."CM Status" = Rec."CM Status"::Open THEN
        EXIT(Text002);
      EXIT('');
    END;

    PROCEDURE SetUserIDFilter@1000000001();
    BEGIN
      //SETRANGE("CM Assigned User ID", USERID);
      //CurrPage.UPDATE();
    END;

    LOCAL PROCEDURE SetStyle@1000000002();
    BEGIN
      _style := '';
      _style2 := '';
      _showDone := FALSE;
      _editable := TRUE;
      IF "CM Status" = "CM Status"::"Done Positive" THEN BEGIN
        _style := 'Favorable';
      END;
      IF "CM Status" = "CM Status"::"Done Negative" THEN BEGIN
        _style := 'Unfavorable';
      END;
      IF "CM Status" = "CM Status"::Closed THEN BEGIN
        _style := 'Subordinate';
      END;
      IF "CM Status" = "CM Status"::Open THEN BEGIN
        _style := 'StandardAccent';
        _showDone := TRUE;
      END;

      IF Rec."CM Subtype" = Rec."CM Subtype"::" " THEN BEGIN
        _style2 := 'StrongAccent';
        _editable := FALSE;
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70123 CMMS New Asset/Project
{
  OBJECT-PROPERTIES
  {
    Date=28.11.16;
    Time=10:27:08;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=Yes;
    SourceTable=Table70020;
    PageType=ConfirmationDialog;
    SourceTableTemporary=Yes;
    InstructionalTextML=[ENU=Create new Asset / Project?;
                         DEA=Neue Anlage / Projekt erstellen?];
    OnOpenPage=BEGIN
                 Rec.RESET;
                 Rec.INIT;
                 Rec.INSERT(FALSE);
                 Rec.SETRECFILTER();
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                SourceExpr=Name }

    { 1000000002;1;Field  ;
                SourceExpr="Name 2" }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70124 CMMS New Gen. Request
{
  OBJECT-PROPERTIES
  {
    Date=04.01.18;
    Time=15:22:11;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=Yes;
    CaptionML=[ENU=New Request;
               DEA=Neue Anfrage];
    InsertAllowed=No;
    DeleteAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5080;
    DataCaptionExpr=Text001;
    PopulateAllFields=Yes;
    PageType=Card;
    SourceTableTemporary=Yes;
    ShowFilter=No;
    OnInit=BEGIN
             CurrPage.EDITABLE := TRUE;
           END;

    OnOpenPage=BEGIN
                 Rec.RESET();
                 Rec.DELETEALL(FALSE);
                 Rec.INIT();
                 Rec.INSERT(FALSE);
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000012;1;Field  ;
                Name=MainAssetName_;
                CaptionML=[ENU=Main Asset;
                           DEA=Hauptanlage];
                SourceExpr=MainAssetName;
                OnValidate=BEGIN
                             IF MainAssetName <> '' THEN
                               ValidateNo(2,CMGenMgt.DoUniversalLookup(2,'','', MainAssetName, ''))
                             ELSE
                               ValidateNo(2,'');
                           END;
                            }

    { 1000000013;1;Field  ;
                Name=MainAssetNo_;
                CaptionML=[ENU=Main Asset;
                           DEA=Hauptanlage];
                SourceExpr=MainAssetNo;
                Visible=FALSE;
                Editable=FALSE }

    { 1000000006;1;Field  ;
                Name=AssetName_;
                CaptionML=[ENU=Asset;
                           DEA=Anlage];
                SourceExpr=AssetName;
                OnValidate=BEGIN
                             IF AssetName <> '' THEN
                               ValidateNo(0,CMGenMgt.DoUniversalLookup(3,MainAssetNo,'', AssetName, ''))
                             ELSE
                               ValidateNo(0,'');
                           END;
                            }

    { 1000000007;1;Field  ;
                Name=AssetNo_;
                CaptionML=[ENU=Asset;
                           DEA=Anlage];
                SourceExpr=AssetNo;
                Visible=FALSE;
                Editable=FALSE }

    { 1000000011;1;Field  ;
                Name=ProjectName_;
                CaptionML=[ENU=Project;
                           DEA=Projekt];
                SourceExpr=ProjectName;
                OnValidate=BEGIN
                             IF ProjectName <> '' THEN
                               ValidateNo(1,CMGenMgt.DoUniversalLookup(1,GetProjectSourceNo(),'', ProjectName, '')) //1 = Project
                             ELSE
                               ValidateNo(1,'');
                           END;
                            }

    { 1000000004;1;Field  ;
                Name=ProjectNo_;
                CaptionML=[ENU=Project;
                           DEA=Projekt];
                SourceExpr=ProjectNo;
                Visible=FALSE;
                Editable=FALSE }

    { 1000000001;1;Field  ;
                SourceExpr=Description;
                ShowMandatory=TRUE }

    { 1000000002;1;Field  ;
                SourceExpr="CM Comment Text" }

    { 1000000003;1;Field  ;
                SourceExpr="CM Request Type" }

    { 1000000010;1;Field  ;
                Name=CreateRequest;
                SourceExpr=GetText(FORMAT(Text001));
                Style=Favorable;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              CurrPage.SAVERECORD();
                              IF CMTaskMgt.NewGenRequest(MainAssetNo,AssetNo, ProjectNo, Rec) THEN
                                CurrPage.CLOSE();
                            END;

                ShowCaption=No }

  }
  CODE
  {
    VAR
      Text001@1000000003 : TextConst 'ENU=Create New Request;DEA=Neue Anfrage Erstellen';
      MainAssetName@1000000012 : Text[50];
      AssetName@1000000005 : Text[50];
      ProjectName@1000000006 : Text[50];
      Description@1000000007 : Text[50];
      DescriptionLong@1000000008 : Text[250];
      CMGenMgt@1000000000 : Codeunit 70000;
      CMTaskMgt@1000000009 : Codeunit 70031;
      MainAssetNo@1000000004 : Code[20];
      AssetNo@1000000002 : Code[20];
      ProjectNo@1000000001 : Code[20];

    LOCAL PROCEDURE GetText@1000000018(InputText@1000000000 : Text) : Text;
    BEGIN
      EXIT(InputText);
    END;

    LOCAL PROCEDURE ValidateNo@1000000000(ObjType@1000000000 : 'Asset,Project,MainAsset';No@1000000001 : Code[20]);
    VAR
      CMAsset@1000000002 : Record 70020;
    BEGIN
      //Main Asset
      IF ObjType = ObjType::MainAsset THEN BEGIN
        IF CMAsset.GET(CMAsset.Objecttype::Asset, No) THEN BEGIN
          MainAssetName := GetObjectName(No,CMAsset.Name);
          MainAssetNo := No;
        END
        ELSE BEGIN
          MainAssetName := '';
          MainAssetNo := '';
        END;

        AssetName := '';
        AssetNo := '';
        ProjectName := '';
        ProjectNo := '';
      END;

      //Asset
      IF ObjType = ObjType::Asset THEN BEGIN
        IF CMAsset.GET(CMAsset.Objecttype::Asset, No) THEN BEGIN
          AssetName := GetObjectName(No,CMAsset.Name);
          AssetNo := No;
        END
        ELSE BEGIN
          AssetName := '';
          AssetNo := '';
        END;

        ProjectName := '';
        ProjectNo := '';
      END;

      //Project
      IF ObjType = ObjType::Project THEN BEGIN
        IF CMAsset.GET(CMAsset.Objecttype::Project, No) THEN BEGIN
          ProjectName := GetObjectName(No,CMAsset.Name);
          ProjectNo := No;
        END
        ELSE BEGIN
          ProjectNo := '';
          ProjectName := '';
        END;
      END;

      CurrPage.SAVERECORD();
    END;

    LOCAL PROCEDURE GetProjectSourceNo@1000000005() : Code[20];
    BEGIN
      IF AssetNo <> '' THEN
        EXIT(AssetNo);
      IF MainAssetNo <> '' THEN
        EXIT(MainAssetNo);

      EXIT('');
    END;

    LOCAL PROCEDURE GetObjectName@1000000008(Code@1000000000 : Code[20];Name@1000000001 : Text[50]) : Text;
    VAR
      Result@1000000002 : Text;
    BEGIN
      Result := '';
      IF Code <> '' THEN
        Result += Code;
      IF (Name <> '') AND (Result <> '') THEN
        Result += (' - ' + Name);

      EXIT(Result);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70125 CMMS New Contract
{
  OBJECT-PROPERTIES
  {
    Date=22.03.17;
    Time=11:09:14;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=Yes;
    SourceTable=Table70050;
    PageType=ConfirmationDialog;
    SourceTableTemporary=Yes;
    InstructionalTextML=[ENU=Create new Contract?;
                         DEA=Neuen Vertrag erstellen?];
    OnOpenPage=BEGIN
                 Rec.RESET;
                 Rec.INIT;
                 Rec.INSERT(FALSE);
                 Rec.SETRECFILTER();
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                SourceExpr=Name }

    { 1000000003;1;Field  ;
                SourceExpr="Type of Service" }

    { 1000000002;1;Field  ;
                SourceExpr=Template }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70126 CMMS Job Queue
{
  OBJECT-PROPERTIES
  {
    Date=22.03.17;
    Time=11:53:34;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=ENU=Job Queue;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table470;
    PageType=ListPart;
    ActionList=ACTIONS
    {
      { 1000000009;  ;ActionContainer;
                      CaptionML=[ENU=Actions;
                                 DEA=Aktionen];
                      ActionContainerType=ActionItems }
      { 1000000008;1 ;Action    ;
                      Name=StartJobQueue;
                      CaptionML=[ENU=Start Job Queue;
                                 DEA=Aufgabenwarteschlange starten];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Start;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 StartQueueFromUI(COMPANYNAME);
                               END;
                                }
      { 1000000007;1 ;Action    ;
                      Name=StopJobQueue;
                      CaptionML=[ENU=Stop Job Queue;
                                 DEA=Aufgabenwarteschlange beenden];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Stop;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 StopQueue;
                               END;
                                }
      { 1000000006;1 ;Action    ;
                      Name=JobQueue;
                      CaptionML=ENU=Job Queue List;
                      RunObject=Page 670;
                      Image=List }
      { 1000000010;1 ;Action    ;
                      Name=JobQueueEntries;
                      CaptionML=ENU=Job Queue Entries;
                      RunObject=Page 672;
                      RunPageLink=Job Queue Category Code=FIELD(Job Queue Category Filter);
                      Image=AllLines }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr=Code }

    { 1000000003;2;Field  ;
                SourceExpr=Description }

    { 1000000004;2;Field  ;
                SourceExpr="Last Heartbeat" }

    { 1000000005;2;Field  ;
                SourceExpr=Started }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70130 CMMS User Statistics
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=14:43:30;
    Modified=Yes;
    Version List=CMMS,CMMSREP;
  }
  PROPERTIES
  {
    CaptionML=[ENU=User Statistics;
               DEA=Benutzer Statistik];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    DataCaptionExpr='';
    PageType=ListPlus;
    OnOpenPage=BEGIN
                 AnalysisType := AnalysisType::User;
                 SetColumns(SetWanted::Initial);
                 Seteditable;
                 UpdateMatrixSubform;
               END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1102601014;1 ;Action    ;
                      Name=Previous Set;
                      CaptionML=[ENU=Previous Set;
                                 DEA=Vorheriger Satz];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::Previous);
                                 UpdateMatrixSubform;
                               END;
                                }
      { 1102601018;1 ;Action    ;
                      Name=Previous Column;
                      CaptionML=[ENU=Previous Column;
                                 DEA=Vorherige Spalte];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PreviousRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::PreviousColumn);
                                 UpdateMatrixSubform;
                               END;
                                }
      { 1102601017;1 ;Action    ;
                      Name=Next Column;
                      CaptionML=[ENU=Next Column;
                                 DEA=N„chste Spalte];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NextRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::NextColumn);
                                 UpdateMatrixSubform;
                               END;
                                }
      { 5       ;1   ;Action    ;
                      Name=Next Set;
                      CaptionML=[ENU=Next Set;
                                 DEA=N„chster Satz];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::Next);
                                 UpdateMatrixSubform;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=Matrix Options;
                           DEA=Matrixoptionen] }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=View by;
                           DEA=Anzeigen nach];
                OptionCaptionML=[ENU=Day,Week,Month,Quarter,Year,Accounting Period;
                                 DEA=Tag,Woche,Monat,Quartal,Jahr,Buchhaltungsperiode];
                SourceExpr=PeriodType;
                OnValidate=BEGIN
                             SetColumns(SetWanted::Initial);
                             UpdateMatrixSubform;
                           END;
                            }

    { 9   ;2   ;Field     ;
                CaptionML=[ENU=View as;
                           DEA=Anzeigen als];
                OptionCaptionML=[ENU=Work Order,Task,Time Records;
                                 DEA=Arbeitsauftrag,Aufgabe,Zeiterfassung];
                SourceExpr=QtyType;
                OnValidate=BEGIN
                             Seteditable;
                             UpdateMatrixSubform;
                           END;
                            }

    { 1000000000;2;Field  ;
                CaptionML=[ENU=Analysis Type;
                           DEA=Analyseart];
                SourceExpr=AnalysisType;
                OnValidate=BEGIN
                             UpdateMatrixSubform;
                           END;
                            }

    { 1000000002;2;Field  ;
                Name=StatusType;
                CaptionML=[ENU=Status Type;
                           DEA=Statusart];
                OptionCaptionML=[ENU=All,Open,Closed;
                                 DEA=Alle,Offen,Geschlossen];
                SourceExpr=StatusType;
                Editable=StatusTypeEditable;
                OnValidate=BEGIN
                             UpdateMatrixSubform;
                           END;
                            }

    { 1000000001;1;Group  ;
                CaptionML=[ENU=Extended Filters;
                           DEA=Erweiterte Filter];
                GroupType=Group }

    { 1000000003;2;Field  ;
                Name=UserTimeTrackingMandatory;
                CaptionML=[ENU=User Time Tracking Mandatory;
                           DEA=Benutezr Zeiterfassung Pflicht];
                SourceExpr=UserTimeTrackingMandatory;
                OnValidate=BEGIN
                             UpdateMatrixSubform;
                           END;
                            }

    { 1102601000;1;Part   ;
                Name=MatrixForm;
                PagePartID=Page70131;
                Visible=UserMatrixVisible }

  }
  CODE
  {
    VAR
      MatrixRecords@1000 : ARRAY [32] OF Record 2000000007;
      PeriodType@1001 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      QtyType@1002 : 'Work Order,Task,Time Records';
      StatusType@1000000003 : 'All,Open,Closed';
      AnalysisType@1000000000 : 'User';
      UserTimeTrackingMandatory@1000000005 : Boolean;
      MatrixColumnCaptions@1010 : ARRAY [32] OF Text[1024];
      ColumnSet@1007 : Text[1024];
      SetWanted@1005 : 'Initial,Previous,Same,Next,PreviousColumn,NextColumn';
      PKFirstRecInCurrSet@1006 : Text[100];
      CurrSetLength@1008 : Integer;
      UserMatrixVisible@1000000001 : Boolean;
      ObjectMatrixVisible@1000000002 : Boolean;
      StatusTypeEditable@1000000004 : Boolean;

    PROCEDURE SetColumns@11(SetWanted@1001 : 'Initial,Previous,Same,Next,PreviousColumn,NextColumn');
    VAR
      MatrixMgt@1000 : Codeunit 9200;
    BEGIN
      MatrixMgt.GeneratePeriodMatrixData(SetWanted,13,FALSE,PeriodType,'',
        PKFirstRecInCurrSet,MatrixColumnCaptions,ColumnSet,CurrSetLength,MatrixRecords);
    END;

    LOCAL PROCEDURE UpdateMatrixSubform@1102601000();
    BEGIN
      CASE AnalysisType OF
        AnalysisType::User:
          BEGIN
            UserMatrixVisible := TRUE;
            ObjectMatrixVisible := FALSE;
            CurrPage.MatrixForm.PAGE.Load(PeriodType,QtyType,StatusType,MatrixColumnCaptions,MatrixRecords,CurrSetLength,UserTimeTrackingMandatory);
            CurrPage.UPDATE(FALSE);
          END;
      END;
    END;

    LOCAL PROCEDURE Seteditable@1000000000();
    BEGIN
      IF QtyType = QtyType::"Time Records" THEN
        StatusTypeEditable := FALSE
      ELSE
        StatusTypeEditable := TRUE;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70131 CMMS User Statistic Matrix
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=14:42:41;
    Modified=Yes;
    Version List=CMMS,CMMSREP;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=User Statistics Matrix;
               DEA=Benutzer Statistik - Matrix];
    LinksAllowed=No;
    SourceTable=Table91;
    PageType=ListPart;
    SourceTableTemporary=Yes;
    OnOpenPage=BEGIN
                 InitRec;
               END;

    OnAfterGetRecord=VAR
                       MATRIX_CurrentColumnOrdinal@1043 : Integer;
                     BEGIN
                       MATRIX_CurrentColumnOrdinal := 0;
                       WHILE MATRIX_CurrentColumnOrdinal < MATRIX_NoOfMatrixColumns DO BEGIN
                         MATRIX_CurrentColumnOrdinal := MATRIX_CurrentColumnOrdinal + 1;
                         MATRIX_OnAfterGetRecord(MATRIX_CurrentColumnOrdinal);
                       END;
                     END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 2       ;1   ;ActionGroup;
                      CaptionML=[ENU=Line;
                                 DEA=Zeile];
                      Image=Line }
      { 8       ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 DEA=Karte];
                      RunObject=Page 70007;
                      RunPageLink=User ID=FIELD(User ID);
                      Image=EditLines }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 6   ;2   ;Field     ;
                SourceExpr="User ID" }

    { 4   ;2   ;Field     ;
                SourceExpr="CM Name" }

    { 1000000001;2;Field  ;
                Name=Field13;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[13];
                CaptionClass='3,' + MATRIX_ColumnCaption[13];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(13);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(13)
                            END;
                             }

    { 1011;2   ;Field     ;
                Name=Field1;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[1];
                CaptionClass='3,' + MATRIX_ColumnCaption[1];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(1);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(1)
                            END;
                             }

    { 1012;2   ;Field     ;
                Name=Field2;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[2];
                CaptionClass='3,' + MATRIX_ColumnCaption[2];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(2);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(2)
                            END;
                             }

    { 1013;2   ;Field     ;
                Name=Field3;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[3];
                CaptionClass='3,' + MATRIX_ColumnCaption[3];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(3);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(3)
                            END;
                             }

    { 1014;2   ;Field     ;
                Name=Field4;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[4];
                CaptionClass='3,' + MATRIX_ColumnCaption[4];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(4);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(4)
                            END;
                             }

    { 1015;2   ;Field     ;
                Name=Field5;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[5];
                CaptionClass='3,' + MATRIX_ColumnCaption[5];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(5);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(5)
                            END;
                             }

    { 1016;2   ;Field     ;
                Name=Field6;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[6];
                CaptionClass='3,' + MATRIX_ColumnCaption[6];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(6);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(6)
                            END;
                             }

    { 1017;2   ;Field     ;
                Name=Field7;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[7];
                CaptionClass='3,' + MATRIX_ColumnCaption[7];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(7);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(7)
                            END;
                             }

    { 1018;2   ;Field     ;
                Name=Field8;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[8];
                CaptionClass='3,' + MATRIX_ColumnCaption[8];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(8);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(8)
                            END;
                             }

    { 1019;2   ;Field     ;
                Name=Field9;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[9];
                CaptionClass='3,' + MATRIX_ColumnCaption[9];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(9);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(9)
                            END;
                             }

    { 1020;2   ;Field     ;
                Name=Field10;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[10];
                CaptionClass='3,' + MATRIX_ColumnCaption[10];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(10);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(10)
                            END;
                             }

    { 1021;2   ;Field     ;
                Name=Field11;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[11];
                CaptionClass='3,' + MATRIX_ColumnCaption[11];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(11);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(11)
                            END;
                             }

    { 1022;2   ;Field     ;
                Name=Field12;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[12];
                CaptionClass='3,' + MATRIX_ColumnCaption[12];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(12);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(12)
                            END;
                             }

  }
  CODE
  {
    VAR
      PeriodType@1080 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      QtyType@1081 : 'Work Order,To-do,Time Tracking';
      StatusType@1000000001 : 'All,Open,Closed';
      MatrixRecords@1000 : ARRAY [32] OF Record 2000000007;
      MATRIX_NoOfMatrixColumns@1084 : Integer;
      MATRIX_CellData@1085 : ARRAY [32] OF Decimal;
      MATRIX_ColumnCaption@1001 : ARRAY [32] OF Text[1024];
      CaptionText013@1000000000 : TextConst 'ENU=Previous Period;DEA=Vorperiode';
      CMMSUserAccessMgmt@1000000002 : Codeunit 70010;
      TempDepartmentTeam@1000000003 : TEMPORARY Record 70010;
      UserTimeTrackingMandatory@1000000004 : Boolean;

    LOCAL PROCEDURE SetDateFilter@1086(ColumnID@1000 : Integer);
    BEGIN
      IF MatrixRecords[ColumnID]."Period Start" = MatrixRecords[ColumnID]."Period End" THEN
        SETRANGE("CM Date Filter",MatrixRecords[ColumnID]."Period Start")
      ELSE
        SETRANGE("CM Date Filter",MatrixRecords[ColumnID]."Period Start",MatrixRecords[ColumnID]."Period End");

      IF ColumnID = 13 THEN
          SETRANGE("CM Date Filter",0D,MatrixRecords[1]."Period Start"-1)
    END;

    LOCAL PROCEDURE MATRIX_OnAfterGetRecord@1091(ColumnID@1000 : Integer);
    BEGIN
      SetDateFilter(ColumnID);

      MATRIX_CellData[ColumnID] := 0;
      MATRIX_CellData[ColumnID] := CalcMatrixCellData(ColumnID);
    END;

    PROCEDURE Load@3(PeriodType1@1003 : 'Day,Week,Month,Quarter,Year,Accounting Period';QtyType1@1000 : 'Work Order,To-do,Time Tracking';StatusType1@1000000000 : 'All,Open,Closed';MatrixColumns1@1001 : ARRAY [32] OF Text[1024];VAR MatrixRecords1@1002 : ARRAY [32] OF Record 2000000007;NoOfMatrixColumns1@1004 : Integer;UserTimeTrackingMandatory1@1000000001 : Boolean);
    VAR
      i@1005 : Integer;
    BEGIN
      PeriodType := PeriodType1;
      QtyType := QtyType1;
      StatusType := StatusType1;
      UserTimeTrackingMandatory := UserTimeTrackingMandatory1;

      COPYARRAY(MATRIX_ColumnCaption,MatrixColumns1,1);

      MATRIX_ColumnCaption[13] := FORMAT(CaptionText013);

      FOR i := 1 TO ARRAYLEN(MatrixRecords) DO
        MatrixRecords[i].COPY(MatrixRecords1[i]);
      MATRIX_NoOfMatrixColumns := NoOfMatrixColumns1;

      InitRec();
    END;

    LOCAL PROCEDURE MatrixOnDrillDown@4(ColumnID@1000 : Integer);
    VAR
      WOList@1000000002 : Page 70101;
      TaskList@1000000003 : Page 70112;
      TimeList@1000000005 : Page 70093;
      Opp@1000000004 : Record 5092;
      Todo@1000000001 : Record 5080;
      TimeSheet@1000000000 : Record 952;
    BEGIN
      Opp.FILTERGROUP(2);
      Todo.FILTERGROUP(2);
      TimeSheet.FILTERGROUP(2);

      SetDateFilter(ColumnID);

      {SetStatusFilter}
      CASE StatusType OF
        StatusType::All:
          BEGIN
            Opp.SETRANGE("CM Status");
            Todo.SETRANGE("CM Status");
          END;
        StatusType::Open:
          BEGIN
            CASE QtyType OF
              QtyType::"Work Order": Opp.SETFILTER("CM Status",'%1|%2|%3|%4',
                Opp."CM Status"::New,
                Opp."CM Status"::Open,
                Opp."CM Status"::"In Process",
                Opp."CM Status"::Completed);
              QtyType::"To-do": Todo.SETFILTER("CM Status",'%1',
                Todo."CM Status"::Open);
            END;
          END;
        StatusType::Closed:
          BEGIN
            CASE QtyType OF
              QtyType::"Work Order": Opp.SETFILTER("CM Status",'%1|%2',
                Opp."CM Status"::Done,
                Opp."CM Status"::Discarded);
              QtyType::"To-do": Todo.SETFILTER("CM Status",'%1|%2|%3',
                Todo."CM Status"::"Done Positive",
                Todo."CM Status"::"Done Negative",
                Todo."CM Status"::Closed);
            END;
          END;
      END;

      CASE QtyType OF
        QtyType::"Work Order":
          BEGIN
          Opp.SETRANGE("CM Is Workorder",TRUE);
          Opp.SETRANGE("CM Assigned User ID","User ID");
          Opp.SETFILTER("CM Due Date",GETFILTER("CM Date Filter"));
          Opp.FILTERGROUP(0);
          WOList.SETRECORD(Opp);
          WOList.SETTABLEVIEW(Opp);
          WOList.LOOKUPMODE := FALSE;
          WOList.RUNMODAL();
          END;
        QtyType::"To-do":
          BEGIN
          Todo.SETRANGE("CM Assigned User ID","User ID");
          Todo.SETFILTER(Date,GETFILTER("CM Date Filter"));
          Todo.FILTERGROUP(0);
          TaskList.SETRECORD(Todo);
          TaskList.SETTABLEVIEW(Todo);
          TaskList.LOOKUPMODE := FALSE;
          TaskList.EDITABLE := FALSE;
          TaskList.RUNMODAL();
          END;
        QtyType::"Time Tracking":
          BEGIN
          TimeSheet.SETRANGE("CM Is CMMS Timesheet",TRUE);
          TimeSheet.SETRANGE("CM User ID","User ID");
          TimeSheet.SETFILTER("CM Entry Date",GETFILTER("CM Date Filter"));
          TimeSheet.FILTERGROUP(0);
          TimeList.SETRECORD(TimeSheet);
          TimeList.SETTABLEVIEW(TimeSheet);
          TimeList.LOOKUPMODE := FALSE;
          TimeList.RUNMODAL();
          END;
      END;
    END;

    LOCAL PROCEDURE CalcMatrixCellData@1000000002(ColumnID@1000000000 : Integer) ReturnValue : Decimal;
    VAR
      Opp@1000000003 : Record 5092;
      Todo@1000000002 : Record 5080;
      TimeSheet@1000000001 : Record 952;
    BEGIN
      ReturnValue := 0;
      SetDateFilter(ColumnID);

      {SetStatusFilter}
      CASE StatusType OF
        StatusType::All:
          BEGIN
            Opp.SETRANGE("CM Status");
            Todo.SETRANGE("CM Status");
          END;
        StatusType::Open:
          BEGIN
            CASE QtyType OF
              QtyType::"Work Order": Opp.SETFILTER("CM Status",'%1|%2|%3|%4',
                Opp."CM Status"::New,
                Opp."CM Status"::Open,
                Opp."CM Status"::"In Process",
                Opp."CM Status"::Completed);
              QtyType::"To-do": Todo.SETFILTER("CM Status",'%1',
                Todo."CM Status"::Open);
            END;
          END;
        StatusType::Closed:
          BEGIN
            CASE QtyType OF
              QtyType::"Work Order": Opp.SETFILTER("CM Status",'%1|%2',
                Opp."CM Status"::Done,
                Opp."CM Status"::Discarded);
              QtyType::"To-do": Todo.SETFILTER("CM Status",'%1|%2|%3',
                Todo."CM Status"::"Done Positive",
                Todo."CM Status"::"Done Negative",
                Todo."CM Status"::Closed);
            END;
          END;
      END;


      CASE QtyType OF
        QtyType::"Work Order":
          BEGIN
            //Opp.SETCURRENTKEY("CM Is Workorder","CM Objecttype","CM Object No.","Priority");
            Opp.SETCURRENTKEY("CM Is Workorder","CM Assigned User ID");
            Opp.SETRANGE("CM Is Workorder",TRUE);
            Opp.SETRANGE("CM Assigned User ID","User ID");
            Opp.SETFILTER("CM Due Date",GETFILTER("CM Date Filter"));
            ReturnValue := Opp.COUNT;
          END;
        QtyType::"To-do":
          BEGIN
            Todo.SETRANGE("CM Assigned User ID","User ID");
            Todo.SETFILTER(Date,GETFILTER("CM Date Filter"));
            ReturnValue := Todo.COUNT;
          END;
        QtyType::"Time Tracking":
          BEGIN
            TimeSheet.SETRANGE("CM Is CMMS Timesheet",TRUE);
            TimeSheet.SETRANGE("CM User ID","User ID");
            TimeSheet.SETFILTER("CM Entry Date",GETFILTER("CM Date Filter"));
            TimeSheet.CALCSUMS("CM Quantity");
            ReturnValue := TimeSheet."CM Quantity";
          END;
      END;
    END;

    LOCAL PROCEDURE ValidateCapacity@1(MATRIX_ColumnOrdinal@1000 : Integer);
    BEGIN
    END;

    LOCAL PROCEDURE InitRec@1000000001();
    VAR
      UserSetup@1000000000 : Record 91;
      DoInsert@1000000001 : Boolean;
    BEGIN
      Rec.RESET;
      Rec.DELETEALL(FALSE);

      CMMSUserAccessMgmt.GetSubordinatedUsers(USERID,COMPANYNAME,FALSE,FALSE,TempDepartmentTeam);
      IF TempDepartmentTeam.FIND('-') THEN BEGIN
        REPEAT
          IF NOT UserSetup.GET(TempDepartmentTeam.Code) THEN
            UserSetup.INIT;

          DoInsert := ((UserTimeTrackingMandatory) AND (UserSetup."CM Timetrack. Mandatory")) OR (NOT UserTimeTrackingMandatory);

          Rec.INIT;
          Rec."User ID" := TempDepartmentTeam.Code;
          IF DoInsert THEN
            Rec.INSERT;
        UNTIL TempDepartmentTeam.NEXT = 0;
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70132 CMMS Asset Statistics
{
  OBJECT-PROPERTIES
  {
    Date=06.09.17;
    Time=15:34:48;
    Modified=Yes;
    Version List=CMMS,CMMSREP;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Asset Statistics;
               DEA=Anlagen Statistik];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    DataCaptionExpr='';
    PageType=ListPlus;
    OnOpenPage=BEGIN
                 AnalysisType := AnalysisType::Asset;
                 SetColumns(SetWanted::Initial);
                 Seteditable;
                 UpdateMatrixSubform;
               END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1102601014;1 ;Action    ;
                      Name=Previous Set;
                      CaptionML=[ENU=Previous Set;
                                 DEA=Vorheriger Satz];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::Previous);
                                 UpdateMatrixSubform;
                               END;
                                }
      { 1102601018;1 ;Action    ;
                      Name=Previous Column;
                      CaptionML=[ENU=Previous Column;
                                 DEA=Vorherige Spalte];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PreviousRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::PreviousColumn);
                                 UpdateMatrixSubform;
                               END;
                                }
      { 1102601017;1 ;Action    ;
                      Name=Next Column;
                      CaptionML=[ENU=Next Column;
                                 DEA=N„chste Spalte];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NextRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::NextColumn);
                                 UpdateMatrixSubform;
                               END;
                                }
      { 5       ;1   ;Action    ;
                      Name=Next Set;
                      CaptionML=[ENU=Next Set;
                                 DEA=N„chster Satz];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::Next);
                                 UpdateMatrixSubform;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=Matrix Options;
                           DEA=Matrixoptionen] }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=View by;
                           DEA=Anzeigen nach];
                OptionCaptionML=[ENU=Day,Week,Month,Quarter,Year,Accounting Period;
                                 DEA=Tag,Woche,Monat,Quartal,Jahr,Buchhaltungsperiode];
                SourceExpr=PeriodType;
                OnValidate=BEGIN
                             SetColumns(SetWanted::Initial);
                             UpdateMatrixSubform;
                           END;
                            }

    { 9   ;2   ;Field     ;
                CaptionML=[ENU=View as;
                           DEA=Anzeigen als];
                OptionCaptionML=[ENU=Work Order,Task,Time Records;
                                 DEA=Arbeitsauftrag,Aufgabe,Zeiterfassung];
                SourceExpr=QtyType;
                OnValidate=BEGIN
                             Seteditable;
                             UpdateMatrixSubform;
                           END;
                            }

    { 1000000000;2;Field  ;
                CaptionML=[ENU=Analysis Type;
                           DEA=Analyseart];
                SourceExpr=AnalysisType;
                OnValidate=BEGIN
                             UpdateMatrixSubform;
                           END;
                            }

    { 1000000002;2;Field  ;
                Name=StatusType;
                CaptionML=[ENU=Status Type;
                           DEA=Statusart];
                OptionCaptionML=[ENU=All,Open,Closed;
                                 DEA=Alle,Offen,Geschlossen];
                SourceExpr=StatusType;
                Editable=StatusTypeEditable;
                OnValidate=BEGIN
                             UpdateMatrixSubform;
                           END;
                            }

    { 1102601000;1;Part   ;
                Name=MatrixForm;
                PagePartID=Page70133;
                Visible=ObjectMatrixVisible }

  }
  CODE
  {
    VAR
      MatrixRecords@1000 : ARRAY [32] OF Record 2000000007;
      PeriodType@1000000008 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      QtyType@1000000007 : 'Work Order,Task,Time Records';
      StatusType@1000000006 : 'All,Open,Closed';
      AnalysisType@1000000005 : ',Main Asset,Asset';
      MatrixColumnCaptions@1010 : ARRAY [32] OF Text[1024];
      ColumnSet@1007 : Text[1024];
      SetWanted@1005 : 'Initial,Previous,Same,Next,PreviousColumn,NextColumn';
      PKFirstRecInCurrSet@1006 : Text[100];
      CurrSetLength@1008 : Integer;
      UserMatrixVisible@1000000001 : Boolean;
      ObjectMatrixVisible@1000000002 : Boolean;
      StatusTypeEditable@1000000004 : Boolean;

    PROCEDURE SetColumns@11(SetWanted@1001 : 'Initial,Previous,Same,Next,PreviousColumn,NextColumn');
    VAR
      MatrixMgt@1000 : Codeunit 9200;
    BEGIN
      MatrixMgt.GeneratePeriodMatrixData(SetWanted,13,FALSE,PeriodType,'',
        PKFirstRecInCurrSet,MatrixColumnCaptions,ColumnSet,CurrSetLength,MatrixRecords);
    END;

    LOCAL PROCEDURE UpdateMatrixSubform@1102601000();
    BEGIN
      CASE AnalysisType OF
        AnalysisType::"Main Asset",AnalysisType::Asset:
          BEGIN
            UserMatrixVisible := FALSE;
            ObjectMatrixVisible := TRUE;
            CurrPage.MatrixForm.PAGE.Load(AnalysisType-1,PeriodType,QtyType,StatusType,MatrixColumnCaptions,MatrixRecords,CurrSetLength);
            CurrPage.UPDATE(FALSE);
          END;
      END;
    END;

    LOCAL PROCEDURE Seteditable@1000000000();
    BEGIN
      IF QtyType = QtyType::"Time Records" THEN
        StatusTypeEditable := FALSE
      ELSE
        StatusTypeEditable := TRUE;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70133 CMMS Asset/Project Statistic M
{
  OBJECT-PROPERTIES
  {
    Date=04.01.18;
    Time=15:28:42;
    Modified=Yes;
    Version List=CMMS,CMMSREP;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Asset/Project Statistics Matrix;
               DEA=Anlagen/Project Statistik - Matrix];
    LinksAllowed=No;
    SourceTable=Table70020;
    PageType=ListPart;
    OnOpenPage=BEGIN
                 //++AD
                 //SetObjectFilter;
                 //--AD
               END;

    OnAfterGetRecord=VAR
                       MATRIX_CurrentColumnOrdinal@1043 : Integer;
                     BEGIN
                       //++AD
                       //SetObjectFilter;
                       //--AD
                       MATRIX_CurrentColumnOrdinal := 0;
                       WHILE MATRIX_CurrentColumnOrdinal < MATRIX_NoOfMatrixColumns DO BEGIN
                         MATRIX_CurrentColumnOrdinal := MATRIX_CurrentColumnOrdinal + 1;
                         MATRIX_OnAfterGetRecord(MATRIX_CurrentColumnOrdinal);
                       END;
                     END;

    OnAfterGetCurrRecord=BEGIN
                           //++AD
                           //SetObjectFilter;
                           //--AD
                         END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 2       ;1   ;ActionGroup;
                      CaptionML=[ENU=Line;
                                 DEA=Zeile];
                      Image=Line }
      { 8       ;2   ;Action    ;
                      ShortCutKey=Shift+F7;
                      CaptionML=[ENU=Card;
                                 DEA=Karte];
                      Image=EditLines;
                      OnAction=VAR
                                 RecRef@1000000000 : RecordRef;
                                 CMAssetMgt@1000000001 : Codeunit 70020;
                               BEGIN
                                 RecRef.GETTABLE(Rec);
                                 CMAssetMgt.ShowAssetProjectCard(RecRef);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                GroupType=Repeater }

    { 6   ;2   ;Field     ;
                SourceExpr="No." }

    { 4   ;2   ;Field     ;
                SourceExpr=Name }

    { 1000000000;2;Field  ;
                Name=Field13;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[13];
                CaptionClass='3,' + MATRIX_ColumnCaption[13];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(13);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(13)
                            END;
                             }

    { 1011;2   ;Field     ;
                Name=Field1;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[1];
                CaptionClass='3,' + MATRIX_ColumnCaption[1];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(1);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(1)
                            END;
                             }

    { 1012;2   ;Field     ;
                Name=Field2;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[2];
                CaptionClass='3,' + MATRIX_ColumnCaption[2];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(2);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(2)
                            END;
                             }

    { 1013;2   ;Field     ;
                Name=Field3;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[3];
                CaptionClass='3,' + MATRIX_ColumnCaption[3];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(3);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(3)
                            END;
                             }

    { 1014;2   ;Field     ;
                Name=Field4;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[4];
                CaptionClass='3,' + MATRIX_ColumnCaption[4];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(4);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(4)
                            END;
                             }

    { 1015;2   ;Field     ;
                Name=Field5;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[5];
                CaptionClass='3,' + MATRIX_ColumnCaption[5];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(5);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(5)
                            END;
                             }

    { 1016;2   ;Field     ;
                Name=Field6;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[6];
                CaptionClass='3,' + MATRIX_ColumnCaption[6];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(6);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(6)
                            END;
                             }

    { 1017;2   ;Field     ;
                Name=Field7;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[7];
                CaptionClass='3,' + MATRIX_ColumnCaption[7];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(7);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(7)
                            END;
                             }

    { 1018;2   ;Field     ;
                Name=Field8;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[8];
                CaptionClass='3,' + MATRIX_ColumnCaption[8];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(8);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(8)
                            END;
                             }

    { 1019;2   ;Field     ;
                Name=Field9;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[9];
                CaptionClass='3,' + MATRIX_ColumnCaption[9];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(9);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(9)
                            END;
                             }

    { 1020;2   ;Field     ;
                Name=Field10;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[10];
                CaptionClass='3,' + MATRIX_ColumnCaption[10];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(10);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(10)
                            END;
                             }

    { 1021;2   ;Field     ;
                Name=Field11;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[11];
                CaptionClass='3,' + MATRIX_ColumnCaption[11];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(11);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(11)
                            END;
                             }

    { 1022;2   ;Field     ;
                Name=Field12;
                DecimalPlaces=0:3;
                SourceExpr=MATRIX_CellData[12];
                CaptionClass='3,' + MATRIX_ColumnCaption[12];
                Editable=false;
                OnValidate=BEGIN
                             ValidateCapacity(12);
                           END;

                OnDrillDown=BEGIN
                              MatrixOnDrillDown(12)
                            END;
                             }

  }
  CODE
  {
    VAR
      ObjType@1000000000 : 'MainAsset,Asset,Project';
      PeriodType@1080 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      QtyType@1081 : 'Work Order,To-do,Time Tracking';
      StatusType@1000000001 : 'All,Open,Closed';
      MatrixRecords@1000 : ARRAY [32] OF Record 2000000007;
      MATRIX_NoOfMatrixColumns@1084 : Integer;
      MATRIX_CellData@1085 : ARRAY [32] OF Decimal;
      MATRIX_ColumnCaption@1001 : ARRAY [32] OF Text[1024];
      CaptionText013@1000000002 : TextConst 'ENU=Previous Period;DEA=Vorperiode';

    LOCAL PROCEDURE SetDateFilter@1086(ColumnID@1000 : Integer);
    BEGIN
      IF MatrixRecords[ColumnID]."Period Start" = MatrixRecords[ColumnID]."Period End" THEN
        SETRANGE("Date Filter",MatrixRecords[ColumnID]."Period Start")
      ELSE
        SETRANGE("Date Filter",MatrixRecords[ColumnID]."Period Start",MatrixRecords[ColumnID]."Period End");

      IF ColumnID = 13 THEN
          SETRANGE("Date Filter",0D,MatrixRecords[1]."Period Start"-1)
    END;

    LOCAL PROCEDURE SetObjectFilter@1000000000();
    VAR
      CMGenMgt@1000000001 : Codeunit 70000;
      Type@1000000000 : Integer;
    BEGIN
      {
      CASE ObjType OF
        ObjType::MainAsset:
          BEGIN
          SETRANGE(Objecttype,Objecttype::Asset);
          SETRANGE("Asset Type","Asset Type"::"Main Asset");
          END;
        ObjType::Asset:
          BEGIN
          SETRANGE(Objecttype,Objecttype::Asset);
          SETFILTER("Asset Type",'<>%1',"Asset Type"::"Main Asset");
          END;
        ObjType::Project:
          BEGIN
          SETRANGE(Objecttype,Objecttype::Project);
          SETRANGE("Asset Type");
          END;
      END;
      }

      //++AD Comment out Above...
      CASE ObjType OF
        ObjType::MainAsset : Type := 2;
        ObjType::Asset : Type := 0;
        ObjType::Project : Type := 1;
      END;
      CLEAR(Rec);
      Rec.RESET;
      CMGenMgt.SetFilterUniversalLookup(Type,'','','','',Rec);
      IF Rec.FINDFIRST() THEN
        ;
      //--AD
    END;

    LOCAL PROCEDURE SetStatusFilter@1000000001();
    BEGIN
      CASE StatusType OF
        StatusType::All:
          BEGIN
          END;
        StatusType::Open:
          BEGIN
          END;
        StatusType::Closed:
          BEGIN
          END;
      END;
    END;

    LOCAL PROCEDURE MATRIX_OnAfterGetRecord@1091(ColumnID@1000 : Integer);
    BEGIN
      //++AD
      //SetObjectFilter
      //--AD
      SetDateFilter(ColumnID);

      MATRIX_CellData[ColumnID] := 0;
      MATRIX_CellData[ColumnID] := CalcMatrixCellData(ColumnID);
    END;

    PROCEDURE Load@3(ObjectType1@1000000000 : 'MainAsset,Asset,Project';PeriodType1@1003 : 'Day,Week,Month,Quarter,Year,Accounting Period';QtyType1@1000 : 'Work Order,To-do,Time Tracking';StatusType1@1000000001 : 'All,Open,Closed';MatrixColumns1@1001 : ARRAY [32] OF Text[1024];VAR MatrixRecords1@1002 : ARRAY [32] OF Record 2000000007;NoOfMatrixColumns1@1004 : Integer);
    VAR
      i@1005 : Integer;
    BEGIN
      PeriodType := PeriodType1;
      QtyType := QtyType1;
      StatusType := StatusType1;
      ObjType := ObjectType1;

      COPYARRAY(MATRIX_ColumnCaption,MatrixColumns1,1);

      MATRIX_ColumnCaption[13] := FORMAT(CaptionText013);

      FOR i := 1 TO ARRAYLEN(MatrixRecords) DO
        MatrixRecords[i].COPY(MatrixRecords1[i]);
      MATRIX_NoOfMatrixColumns := NoOfMatrixColumns1;

      SetObjectFilter;
      //++AD
      CurrPage.UPDATE(FALSE);
      //--AD
    END;

    LOCAL PROCEDURE MatrixOnDrillDown@4(ColumnID@1000 : Integer);
    VAR
      Opp@1000000000 : Record 5092;
      WOList@1000000002 : Page 70101;
      Todo@1000000001 : Record 5080;
      TaskList@1000000003 : Page 70112;
      TimeSheet@1000000004 : Record 952;
      TimeList@1000000005 : Page 70093;
    BEGIN
      Opp.FILTERGROUP(2);
      Todo.FILTERGROUP(2);
      TimeSheet.FILTERGROUP(2);

      SetDateFilter(ColumnID);

      {SetStatusFilter}
      CASE StatusType OF
        StatusType::All:
          BEGIN
            Opp.SETRANGE("CM Status");
            Todo.SETRANGE("CM Status");
          END;
        StatusType::Open:
          BEGIN
            CASE QtyType OF
              QtyType::"Work Order": Opp.SETFILTER("CM Status",'%1|%2|%3|%4',
                Opp."CM Status"::New,
                Opp."CM Status"::Open,
                Opp."CM Status"::"In Process",
                Opp."CM Status"::Completed);
              QtyType::"To-do": Todo.SETFILTER("CM Status",'%1',
                Todo."CM Status"::Open);
            END;
          END;
        StatusType::Closed:
          BEGIN
            CASE QtyType OF
              QtyType::"Work Order": Opp.SETFILTER("CM Status",'%1|%2',
                Opp."CM Status"::Done,
                Opp."CM Status"::Discarded);
              QtyType::"To-do": Todo.SETFILTER("CM Status",'%1|%2|%3',
                Todo."CM Status"::"Done Positive",
                Todo."CM Status"::"Done Negative",
                Todo."CM Status"::Closed);
            END;
          END;
      END;
      CASE QtyType OF
        QtyType::"Work Order":
          BEGIN
          Opp.FILTERGROUP(2);
          Opp.SETRANGE("CM Is Workorder",TRUE);
          Opp.SETRANGE("CM Objecttype",Objecttype);
          Opp.SETRANGE("CM Object No.","No.");
          Opp.SETFILTER("CM Due Date",GETFILTER("Date Filter"));
          Opp.FILTERGROUP(0);
          WOList.SETRECORD(Opp);
          WOList.SETTABLEVIEW(Opp);
          WOList.LOOKUPMODE := FALSE;
          WOList.RUNMODAL();
          END;
        QtyType::"To-do":
          BEGIN
          Todo.FILTERGROUP(2);
          Todo.SETRANGE("CM Objecttype",Objecttype);
          Todo.SETRANGE("CM Object No.","No.");
          Todo.SETFILTER(Date,GETFILTER("Date Filter"));
          Todo.FILTERGROUP(0);
          TaskList.SETRECORD(Todo);
          TaskList.SETTABLEVIEW(Todo);
          TaskList.LOOKUPMODE := FALSE;
          TaskList.EDITABLE := FALSE;
          TaskList.RUNMODAL();
          END;
        QtyType::"Time Tracking":
          BEGIN
          TimeSheet.RESET;
          TimeSheet.FILTERGROUP(2);
          TimeSheet.SETRANGE("CM Is CMMS Timesheet",TRUE);
          CASE Objecttype OF
            Objecttype::Asset: TimeSheet.SETRANGE("CM Asset No.","No.");
            Objecttype::Project: TimeSheet.SETRANGE("CM Project No.","No.");
          END;
          TimeSheet.SETFILTER("CM Entry Date",GETFILTER("Date Filter"));
          TimeSheet.FILTERGROUP(0);
          TimeList.SETRECORD(TimeSheet);
          TimeList.SETTABLEVIEW(TimeSheet);
          TimeList.LOOKUPMODE := FALSE;
          TimeList.RUNMODAL();
          END;
      END;
    END;

    LOCAL PROCEDURE CalcMatrixCellData@1000000002(ColumnID@1000000000 : Integer) ReturnValue : Decimal;
    VAR
      Opp@1000000003 : Record 5092;
      Todo@1000000002 : Record 5080;
      TimeSheet@1000000001 : Record 952;
    BEGIN
      ReturnValue := 0;
      SetDateFilter(ColumnID);

      {SetStatusFilter}
      CASE StatusType OF
        StatusType::All:
          BEGIN
            Opp.SETRANGE("CM Status");
            Todo.SETRANGE("CM Status");
          END;
        StatusType::Open:
          BEGIN
            CASE QtyType OF
              QtyType::"Work Order": Opp.SETFILTER("CM Status",'%1|%2|%3|%4',
                Opp."CM Status"::New,
                Opp."CM Status"::Open,
                Opp."CM Status"::"In Process",
                Opp."CM Status"::Completed);
              QtyType::"To-do": Todo.SETFILTER("CM Status",'%1',
                Todo."CM Status"::Open);
            END;
          END;
        StatusType::Closed:
          BEGIN
            CASE QtyType OF
              QtyType::"Work Order": Opp.SETFILTER("CM Status",'%1|%2',
                Opp."CM Status"::Done,
                Opp."CM Status"::Discarded);
              QtyType::"To-do": Todo.SETFILTER("CM Status",'%1|%2|%3',
                Todo."CM Status"::"Done Positive",
                Todo."CM Status"::"Done Negative",
                Todo."CM Status"::Closed);
            END;
          END;
      END;

      CASE QtyType OF
        QtyType::"Work Order":
          BEGIN
            //Opp.SETCURRENTKEY("CM Is Workorder","CM Objecttype","CM Object No.","Priority");
            Opp.SETCURRENTKEY("CM Is Workorder","CM Assigned User ID");
            Opp.SETRANGE("CM Is Workorder",TRUE);
            Opp.SETRANGE("CM Objecttype",Objecttype);
            Opp.SETRANGE("CM Object No.","No.");
            Opp.SETFILTER("CM Due Date",GETFILTER("Date Filter"));
            ReturnValue := Opp.COUNT;
          END;
        QtyType::"To-do":
          BEGIN
            Todo.SETRANGE("CM Objecttype",Objecttype);
            Todo.SETRANGE("CM Object No.","No.");
            Todo.SETFILTER(Date,GETFILTER("Date Filter"));
            ReturnValue := Todo.COUNT;
          END;
        QtyType::"Time Tracking":
          BEGIN
            TimeSheet.SETRANGE("CM Is CMMS Timesheet",TRUE);
            CASE Objecttype OF
              Objecttype::Asset: TimeSheet.SETRANGE("CM Asset No.","No.");
              Objecttype::Project: TimeSheet.SETRANGE("CM Project No.","No.");
            END;
            TimeSheet.SETFILTER("CM Entry Date",GETFILTER("Date Filter"));
            TimeSheet.CALCSUMS("CM Quantity");
            ReturnValue := TimeSheet."CM Quantity";
          END;
      END;
    END;

    LOCAL PROCEDURE ValidateCapacity@1(MATRIX_ColumnOrdinal@1000 : Integer);
    BEGIN
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70134 CMMS Project Statistics
{
  OBJECT-PROPERTIES
  {
    Date=06.09.17;
    Time=15:35:05;
    Modified=Yes;
    Version List=CMMS,CMMSREP;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Project Statistics;
               DEA=Projekt Statistik];
    SaveValues=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    DataCaptionExpr='';
    PageType=ListPlus;
    OnOpenPage=BEGIN
                 AnalysisType := AnalysisType::Project;
                 SetColumns(SetWanted::Initial);
                 Seteditable;
                 UpdateMatrixSubform;
               END;

    ActionList=ACTIONS
    {
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1102601014;1 ;Action    ;
                      Name=Previous Set;
                      CaptionML=[ENU=Previous Set;
                                 DEA=Vorheriger Satz];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PreviousSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::Previous);
                                 UpdateMatrixSubform;
                               END;
                                }
      { 1102601018;1 ;Action    ;
                      Name=Previous Column;
                      CaptionML=[ENU=Previous Column;
                                 DEA=Vorherige Spalte];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PreviousRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::PreviousColumn);
                                 UpdateMatrixSubform;
                               END;
                                }
      { 1102601017;1 ;Action    ;
                      Name=Next Column;
                      CaptionML=[ENU=Next Column;
                                 DEA=N„chste Spalte];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NextRecord;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::NextColumn);
                                 UpdateMatrixSubform;
                               END;
                                }
      { 5       ;1   ;Action    ;
                      Name=Next Set;
                      CaptionML=[ENU=Next Set;
                                 DEA=N„chster Satz];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=NextSet;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 SetColumns(SetWanted::Next);
                                 UpdateMatrixSubform;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=Matrix Options;
                           DEA=Matrixoptionen] }

    { 6   ;2   ;Field     ;
                CaptionML=[ENU=View by;
                           DEA=Anzeigen nach];
                OptionCaptionML=[ENU=Day,Week,Month,Quarter,Year,Accounting Period;
                                 DEA=Tag,Woche,Monat,Quartal,Jahr,Buchhaltungsperiode];
                SourceExpr=PeriodType;
                OnValidate=BEGIN
                             SetColumns(SetWanted::Initial);
                             UpdateMatrixSubform;
                           END;
                            }

    { 9   ;2   ;Field     ;
                CaptionML=[ENU=View as;
                           DEA=Anzeigen als];
                OptionCaptionML=[ENU=Work Order,Task,Time Records;
                                 DEA=Arbeitsauftrag,Aufgabe,Zeiterfassung];
                SourceExpr=QtyType;
                OnValidate=BEGIN
                             Seteditable;
                             UpdateMatrixSubform;
                           END;
                            }

    { 1000000000;2;Field  ;
                CaptionML=[ENU=Analysis Type;
                           DEA=Analyseart];
                SourceExpr=AnalysisType;
                OnValidate=BEGIN
                             UpdateMatrixSubform;
                           END;
                            }

    { 1000000002;2;Field  ;
                Name=StatusType;
                CaptionML=[ENU=Status Type;
                           DEA=Statusart];
                OptionCaptionML=[ENU=All,Open,Closed;
                                 DEA=Alle,Offen,Geschlossen];
                SourceExpr=StatusType;
                Editable=StatusTypeEditable;
                OnValidate=BEGIN
                             UpdateMatrixSubform;
                           END;
                            }

    { 1102601000;1;Part   ;
                Name=MatrixForm;
                PagePartID=Page70133;
                Visible=ObjectMatrixVisible }

  }
  CODE
  {
    VAR
      MatrixRecords@1000 : ARRAY [32] OF Record 2000000007;
      PeriodType@1000000008 : 'Day,Week,Month,Quarter,Year,Accounting Period';
      QtyType@1000000007 : 'Work Order,Task,Time Records';
      StatusType@1000000006 : 'All,Open,Closed';
      AnalysisType@1000000005 : ',,,Project';
      MatrixColumnCaptions@1010 : ARRAY [32] OF Text[1024];
      ColumnSet@1007 : Text[1024];
      SetWanted@1005 : 'Initial,Previous,Same,Next,PreviousColumn,NextColumn';
      PKFirstRecInCurrSet@1006 : Text[100];
      CurrSetLength@1008 : Integer;
      UserMatrixVisible@1000000001 : Boolean;
      ObjectMatrixVisible@1000000002 : Boolean;
      StatusTypeEditable@1000000004 : Boolean;

    PROCEDURE SetColumns@11(SetWanted@1001 : 'Initial,Previous,Same,Next,PreviousColumn,NextColumn');
    VAR
      MatrixMgt@1000 : Codeunit 9200;
    BEGIN
      MatrixMgt.GeneratePeriodMatrixData(SetWanted,13,FALSE,PeriodType,'',
        PKFirstRecInCurrSet,MatrixColumnCaptions,ColumnSet,CurrSetLength,MatrixRecords);
    END;

    LOCAL PROCEDURE UpdateMatrixSubform@1102601000();
    BEGIN
      CASE AnalysisType OF
        AnalysisType::Project:
          BEGIN
            UserMatrixVisible := FALSE;
            ObjectMatrixVisible := TRUE;
            CurrPage.MatrixForm.PAGE.Load(AnalysisType-1,PeriodType,QtyType,StatusType,MatrixColumnCaptions,MatrixRecords,CurrSetLength);
            CurrPage.UPDATE(FALSE);
          END;
      END;
    END;

    LOCAL PROCEDURE Seteditable@1000000000();
    BEGIN
      IF QtyType = QtyType::"Time Records" THEN
        StatusTypeEditable := FALSE
      ELSE
        StatusTypeEditable := TRUE;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70140 CMMS Enter User
{
  OBJECT-PROPERTIES
  {
    Date=16.08.17;
    Time=12:42:04;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Enter User;
               DEA=Benutzer eingeben];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    PageType=StandardDialog;
    InstructionalTextML=[ENU=Please enter your user ID and password!;
                         DEA=Bitte geben Sie Ihre Benutzer ID und das Passwort ein!];
    ShowFilter=No;
    OnQueryClosePage=BEGIN
                       IF CloseAction = ACTION::OK THEN BEGIN
                         IGTimeTrackingRegister.SetValue(NewUserID);
                         IGTimeTrackingRegister.RUN();
                       END;
                     END;

  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                Name=User;
                CaptionML=[ENU=User ID;
                           DEA=Benutzer-ID];
                SourceExpr=NewUserID;
                OnLookup=VAR
                           UserSetup@1000000001 : Record 91;
                           UserSetupPage@1000000000 : Page 119;
                         BEGIN
                           UserSetup.FILTERGROUP(2);
                           UserSetup.FILTERGROUP(2);

                           UserSetupPage.SETRECORD(UserSetup);
                           UserSetupPage.SETTABLEVIEW(UserSetup);
                           UserSetupPage.EDITABLE(FALSE);
                           UserSetupPage.LOOKUPMODE(TRUE);

                           IF UserSetupPage.RUNMODAL = ACTION::LookupOK THEN BEGIN
                             UserSetupPage.GETRECORD(UserSetup);
                             Text := UserSetup."User ID";
                             EXIT(TRUE);
                           END ELSE
                             EXIT(FALSE);
                         END;
                          }

  }
  CODE
  {
    VAR
      Text000@1000000005 : TextConst 'ENU=Placeholder;DEA=Platzhalter';
      NewUserID@1000000004 : Code[50];
      UserRec@1000000001 : Record 2000000120;
      Text001@1000000002 : TextConst 'ENU=User ID or Password are invalid!;DEA=Die Benutzer ID oder das Passwort stimmen nicht!';
      Error004@1000000003 : TextConst 'ENU=Execution terminated!;DEA=Die Verarbeitung wurde abgebrochen!';
      IGTimeTrackingRegister@1000000007 : Page 70091;

    PROCEDURE SetValue@1160002(VAR SetUserID@1000000000 : Code[50]);
    BEGIN
      NewUserID := SetUserID;
    END;

    PROCEDURE GetValue@1160000(VAR GetUserID@1000000000 : Code[50]);
    BEGIN
      GetUserID := NewUserID;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70141 CMMS Purchase Order Card
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=10:01:30;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=CMMS Purchase Order;
               DEA=CMMS Bestellung];
    SourceTable=Table38;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Document Type,No.)
                    WHERE(Document Type=CONST(Order),
                          CM Is CMMS Purchase Order=CONST(Yes));
    ActionList=ACTIONS
    {
      { 1000000028;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000029;1 ;Action    ;
                      Name=Post;
                      ShortCutKey=F9;
                      Ellipsis=Yes;
                      CaptionML=[ENU=P&ost;
                                 DEA=Bu&chen];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=PostOrder;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 Post(CODEUNIT::"Purch.-Post (Yes/No)");
                               END;
                                }
      { 1000000032;1 ;Action    ;
                      Name=IGChangeStatus;
                      CaptionML=[ENU=Processing Status;
                                 DEA=Bearbeitungsstatus];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Continue;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 IGStatusMgt@1000000000 : Codeunit 50007;
                               BEGIN
                                 IGStatusMgt.ChangePurchHeaderStatusUI(Rec); //IG AD
                               END;
                                }
      { 1000000039;1 ;Action    ;
                      Name=Release;
                      ShortCutKey=Ctrl+F9;
                      CaptionML=[ENU=Re&lease;
                                 DEA=&Freigeben];
                      Promoted=Yes;
                      Image=ReleaseDoc;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 ReleasePurchDoc@1000 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualRelease(Rec);
                               END;
                                }
      { 1000000038;1 ;Action    ;
                      Name=Reopen;
                      CaptionML=[ENU=Re&open;
                                 DEA=Stat&us zurcksetzen];
                      Image=ReOpen;
                      OnAction=VAR
                                 ReleasePurchDoc@1001 : Codeunit 415;
                               BEGIN
                                 ReleasePurchDoc.PerformManualReopen(Rec);
                               END;
                                }
      { 1000000037;1 ;Action    ;
                      Name=SendApprovalRequest;
                      CaptionML=[ENU=Send A&pproval Request;
                                 DEA=&Genehmigungsanforderung senden];
                      Promoted=Yes;
                      Image=SendApprovalRequest;
                      PromotedCategory=Category9;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 IF ApprovalsMgmt.CheckPurchaseApprovalsWorkflowEnabled(Rec) THEN
                                   ApprovalsMgmt.OnSendPurchaseDocForApproval(Rec);
                               END;
                                }
      { 1000000036;1 ;Action    ;
                      Name=CancelApprovalRequest;
                      CaptionML=[ENU=Cancel Approval Re&quest;
                                 DEA=&Genehmigungsanforderung stornieren];
                      Promoted=Yes;
                      Image=Cancel;
                      PromotedCategory=Category9;
                      OnAction=VAR
                                 ApprovalsMgmt@1001 : Codeunit 1535;
                               BEGIN
                                 ApprovalsMgmt.OnCancelPurchaseApprovalRequest(Rec);
                               END;
                                }
      { 1000000034;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1000000035;1 ;Action    ;
                      Name=IGStatusSequence;
                      CaptionML=[ENU=Status Sequence;
                                 DEA=Statusablauf];
                      Image=Status;
                      OnAction=VAR
                                 IGStatusMgt@1000000000 : Codeunit 50007;
                               BEGIN
                                 IGStatusMgt.ShowStatusHistory(Rec."No."); //IG AD
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[ENU=General;
                           DEA=Allgemein];
                GroupType=Group }

    { 1000000003;2;Field  ;
                SourceExpr="No." }

    { 1000000016;2;Field  ;
                CaptionML=[ENU=CMMS Template Vendor No.;
                           DEA=CMMS Vorlage Debitor Nr.];
                SourceExpr="Buy-from Vendor No." }

    { 1000000012;2;Field  ;
                SourceExpr="CM Company" }

    { 1000000013;2;Field  ;
                SourceExpr="CM Vendor No." }

    { 1000000031;2;Field  ;
                SourceExpr="IG Status Code";
                Editable=FALSE }

    { 1000000033;2;Field  ;
                SourceExpr="IG Status Name" }

    { 1000000040;2;Field  ;
                SourceExpr="Purchaser Code" }

    { 1000000026;2;Field  ;
                SourceExpr="Assigned User ID" }

    { 1000000030;2;Field  ;
                SourceExpr="Responsibility Center" }

    { 1000000027;2;Field  ;
                SourceExpr="Currency Code" }

    { 1000000021;1;Group  ;
                Name=Extended;
                CaptionML=[ENU=Extended;
                           DEA=Erweitert];
                GroupType=Group }

    { 1000000019;2;Field  ;
                SourceExpr="Order Date" }

    { 1000000020;2;Field  ;
                SourceExpr="Posting Date" }

    { 1000000024;2;Field  ;
                SourceExpr="Expected Receipt Date" }

    { 1000000018;2;Field  ;
                SourceExpr="Posting Description" }

    { 1000000017;2;Field  ;
                SourceExpr="Your Reference" }

    { 1000000022;2;Field  ;
                SourceExpr="Vendor Shipment No." }

    { 1000000023;2;Field  ;
                SourceExpr="Vendor Invoice No." }

    { 1000000014;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group" }

    { 1000000015;2;Field  ;
                SourceExpr="VAT Bus. Posting Group" }

    { 1000000025;2;Field  ;
                SourceExpr="Payment Terms Code" }

    { 1000000010;1;Group  ;
                Name=Address;
                CaptionML=[ENU=Address;
                           DEA=Adresse];
                Editable=FALSE;
                GroupType=Group }

    { 1000000004;2;Field  ;
                SourceExpr="Buy-from Vendor Name" }

    { 1000000005;2;Field  ;
                SourceExpr="Buy-from Vendor Name 2" }

    { 1000000006;2;Field  ;
                SourceExpr="Buy-from Address" }

    { 1000000007;2;Field  ;
                SourceExpr="Buy-from Address 2" }

    { 1000000008;2;Field  ;
                SourceExpr="Buy-from City" }

    { 1000000009;2;Field  ;
                SourceExpr="Buy-from Post Code" }

    { 1000000011;2;Field  ;
                SourceExpr="Buy-from Country/Region Code" }

    { 1000000002;1;Part   ;
                Name=PurchLines;
                CaptionML=[ENU=Lines;
                           DEA=Zeilen];
                SubPageLink=Document No.=FIELD(No.);
                PagePartID=Page54;
                UpdatePropagation=Both }

  }
  CODE
  {

    LOCAL PROCEDURE Post@4(PostingCodeunitID@1000 : Integer);
    BEGIN
      SendToPosting(PostingCodeunitID);
      IF "Job Queue Status" = "Job Queue Status"::"Scheduled for Posting" THEN
        CurrPage.CLOSE;
      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70142 CMMS Purchase Order List
{
  OBJECT-PROPERTIES
  {
    Date=07.09.17;
    Time=13:28:30;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=CMMS Purchase Orders;
               DEA=CMMS Bestellungen];
    SourceTable=Table38;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Document Type,No.)
                    WHERE(Document Type=CONST(Order),
                          CM Is CMMS Purchase Order=CONST(Yes));
    PageType=List;
    CardPageID=CMMS Purchase Order Card;
    OnOpenPage=VAR
                 CMGenSetup@1000000000 : Record 70000;
               BEGIN
                 IF NOT CMGenSetup.GET() THEN
                   CMGenSetup.INIT();

                 CMGenSetup.TESTFIELD("Allow CMMS Purch. Orders");

                 CMMSGenMgt.SetRespCenterFilter(Rec);
               END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=Group;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                SourceExpr="No." }

    { 1000000012;2;Field  ;
                SourceExpr="CM Vendor No." }

    { 1000000011;2;Field  ;
                SourceExpr="CM Company" }

    { 1000000003;2;Field  ;
                SourceExpr="Buy-from Vendor Name" }

    { 1000000004;2;Field  ;
                SourceExpr="Buy-from Vendor Name 2";
                Visible=FALSE }

    { 1000000005;2;Field  ;
                SourceExpr="Buy-from Address" }

    { 1000000006;2;Field  ;
                SourceExpr="Buy-from Address 2";
                Visible=FALSE }

    { 1000000007;2;Field  ;
                SourceExpr="Buy-from City" }

    { 1000000008;2;Field  ;
                SourceExpr="Buy-from Post Code" }

    { 1000000009;2;Field  ;
                SourceExpr="Buy-from Country/Region Code" }

    { 1000000015;2;Field  ;
                SourceExpr="Gen. Bus. Posting Group";
                Visible=FALSE }

    { 1000000013;2;Field  ;
                SourceExpr="VAT Bus. Posting Group";
                Visible=FALSE }

    { 1000000010;2;Field  ;
                SourceExpr=Amount }

    { 1000000016;2;Field  ;
                SourceExpr="Responsibility Center" }

    { 1000000014;2;Field  ;
                SourceExpr="Assigned User ID" }

    { 1000000017;2;Field  ;
                SourceExpr="IG Status Code" }

  }
  CODE
  {
    VAR
      CMMSGenMgt@1000000000 : Codeunit 70000;

    BEGIN
    END.
  }
}

OBJECT Page 70500 CMMS Administation RC
{
  OBJECT-PROPERTIES
  {
    Date=16.05.18;
    Time=12:39:09;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Role Center;
               DEA=Rollencenter];
    PageType=RoleCenter;
    PromotedActionCategoriesML=[ENU=,,,Setup,User;
                                DEA=Neu,Vorgang,Bericht,Einrichtung,Benutzer];
    ActionList=ACTIONS
    {
      { 1000000025;  ;ActionContainer;
                      ActionContainerType=HomeItems }
      { 1000000007;1 ;Action    ;
                      CaptionML=[ENU=Contacts;
                                 DEA=Kontakte];
                      RunObject=Page 5052;
                      Image=CustomerContact }
      { 1000000042;1 ;Action    ;
                      CaptionML=[ENU=Departments;
                                 DEA=Abteilungen];
                      RunObject=Page 70030 }
      { 1000000009;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000011;1 ;ActionGroup;
                      Name=Setup;
                      CaptionML=[ENU=Setup;
                                 DEA=Einrichtung];
                      ActionContainerType=NewDocumentItems }
      { 1000000010;2 ;Action    ;
                      CaptionML=[ENU=General Setup;
                                 DEA=Allgemeine Einrichtung];
                      RunObject=Page 70000;
                      Image=Setup }
      { 1000000026;2 ;Action    ;
                      CaptionML=[ENU=GPM Plant Mapping;
                                 DEA=GPM Plant Mapping];
                      RunObject=Page 70063;
                      Image=Setup }
      { 1000000028;2 ;Action    ;
                      CaptionML=[ENU=GPM Operator Mapping;
                                 DEA=GPM Operator Mapping];
                      RunObject=Page 70064;
                      Image=Setup }
      { 1000000043;2 ;Action    ;
                      CaptionML=ENU=Report Fieldset Setup;
                      RunObject=Page 70089;
                      Image=Setup }
      { 1000000032;1 ;ActionGroup;
                      Name=MiscSetup;
                      CaptionML=[ENU=Misc. Setup;
                                 DEA=Sonstige Einrichtungen];
                      ActionContainerType=NewDocumentItems }
      { 1000000020;2 ;Action    ;
                      CaptionML=[ENU=Activities (Workorder Types);
                                 DEA=Aktionen (Arbeitsauftragstypen)];
                      RunObject=Page 5103;
                      Image=InteractionTemplate }
      { 1000000018;2 ;Action    ;
                      CaptionML=[ENU=Interaction Groups;
                                 DEA=Aktivit„tengruppen];
                      RunObject=Page 5074;
                      Image=InteractionTemplate }
      { 1000000019;2 ;Action    ;
                      CaptionML=[ENU=Interaction Templates;
                                 DEA=Aktivit„tsvorlagen];
                      RunObject=Page 5075;
                      Image=InteractionTemplate }
      { 1000000015;2 ;Action    ;
                      CaptionML=[ENU=Business Relations;
                                 DEA=Gesch„ftsbeziehungen];
                      RunObject=Page 5060;
                      Image=Relationship }
      { 1000000031;1 ;ActionGroup;
                      Name=UserSetup;
                      CaptionML=[ENU=User Setup;
                                 DEA=Benutzer Einrichtung];
                      ActionContainerType=NewDocumentItems }
      { 1000000022;2 ;Action    ;
                      CaptionML=[ENU=User Report Selection Administration;
                                 DEA=Benutzer Berichtsauswahl Verwaltung];
                      RunObject=Page 70005;
                      Image=UserSetup }
      { 1000000013;2 ;Action    ;
                      CaptionML=[ENU=User Setup (CMMS Rights);
                                 DEA=Benutzereinrichtung (CMMS Rechte)];
                      RunObject=Page 119;
                      Image=UserSetup }
      { 1000000012;2 ;Action    ;
                      CaptionML=[ENU=User Personalization (Rolecenter);
                                 DEA=Benutzeranpassung (Rollencenter)];
                      RunObject=Page 9173;
                      Image=UserSetup }
      { 1000000017;2 ;Action    ;
                      CaptionML=[ENU=User Objects;
                                 DEA=Benutzer Objekte];
                      RunObject=Page 70005;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=UserSetup;
                      PromotedCategory=New }
      { 1000000021;2 ;Action    ;
                      CaptionML=[ENU=Users (Creation, Rights, Login);
                                 DEA=Benutzer (Anlage, Rechte, Login)];
                      RunObject=Page 9800;
                      Image=UserSetup }
      { 1000000016;2 ;Action    ;
                      CaptionML=[ENU=Correct Time Records;
                                 DEA=Zeiterfassung anpassen];
                      RunObject=Page 70140;
                      Image=Capacity }
      { 1000000030;1 ;Action    ;
                      CaptionML=[ENU=Navi&gate;
                                 DEA=Navi&gate];
                      RunObject=Page 344;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Navigate;
                      PromotedCategory=Process }
      { 1000000029;1 ;Action    ;
                      CaptionML=[ENU=Entry and Exit;
                                 DEA=Kommen-Gehen];
                      RunObject=Page 1024246;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Change;
                      PromotedCategory=Category5 }
      { 1000000027;1 ;Action    ;
                      CaptionML=[ENU=Change Password;
                                 DEA=Kennwort „ndern];
                      RunObject=Page 9809;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EncryptionKeys;
                      PromotedCategory=Category5 }
      { 1000000033;1 ;Action    ;
                      CaptionML=[ENU=Change Log Entries;
                                 DEA=Žnderungsprotokollposten];
                      RunObject=Page 595;
                      RunPageView=SORTING(Entry No.)
                                  ORDER(Descending);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=ChangeLog;
                      PromotedCategory=Category5 }
      { 1000000008;1 ;Action    ;
                      CaptionML=[ENU=Substitution;
                                 DEA=Vertretung];
                      RunObject=Page 70059;
                      RunPageView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                                  WHERE(Type=CONST(Substitue));
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CoupledUsers;
                      PromotedCategory=Category5 }
      { 1000000044;1 ;Action    ;
                      CaptionML=[ENU=Notification Copy;
                                 DEA=Benachrichtigungen Kopie];
                      RunObject=Page 70059;
                      RunPageView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                                  WHERE(Type=CONST(NotificationCopy));
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy;
                      PromotedCategory=Category5 }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=RoleCenterArea }

    { 1000000006;1;Group  ;
                GroupType=Group }

    { 1000000041;2;Part   ;
                PagePartID=Page50010;
                PartType=Page }

    { 1000000001;2;Part   ;
                PagePartID=Page70607;
                PartType=Page }

    { 1000000035;2;Part   ;
                PagePartID=Page70608;
                PartType=Page }

    { 1000000038;2;Part   ;
                PagePartID=Page70609;
                PartType=Page }

    { 1000000023;2;Part   ;
                PagePartID=Page70601;
                PartType=Page }

    { 1000000040;2;Part   ;
                SubPageView=WHERE(RC Allow New Workorder=CONST(Yes),
                                  RC Allow New Request=CONST(Yes));
                PagePartID=Page70606;
                PartType=Page }

    { 1000000039;2;Part   ;
                PagePartID=Page70605;
                PartType=Page }

    { 1000000036;2;Part   ;
                PagePartID=Page70604;
                PartType=Page }

    { 1000000014;2;Part   ;
                PagePartID=Page70602;
                PartType=Page }

    { 1000000005;1;Group  ;
                GroupType=Group }

    { 1000000024;2;Part   ;
                PagePartID=Page70006;
                PartType=Page }

    { 1000000034;2;Part   ;
                PagePartID=Page70126;
                PartType=Page }

    { 1000000004;2;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

    { 1000000003;2;Part   ;
                PagePartID=Page681;
                PartType=Page }

    { 1000000002;2;Part   ;
                PagePartID=Page675;
                Visible=false;
                PartType=Page }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70501 CMMS Standard RC (FS)
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=13:47:17;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Role Center;
               DEA=Rollencenter];
    PageType=RoleCenter;
    ActionList=ACTIONS
    {
      { 1000000025;  ;ActionContainer;
                      ActionContainerType=HomeItems }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=RoleCenterArea }

    { 1000000006;1;Group  ;
                GroupType=Group }

    { 1000000003;2;Part   ;
                PagePartID=Page70609;
                PartType=Page }

    { 1000000005;2;Part   ;
                PagePartID=Page70607;
                PartType=Page }

    { 1000000001;2;Part   ;
                PagePartID=Page70602;
                PartType=Page }

    { 1000000002;2;Part   ;
                PagePartID=Page70601;
                PartType=Page }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70502 CMMS Management RC
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=13:30:34;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Role Center;
               DEA=Rollencenter];
    PageType=RoleCenter;
    PromotedActionCategoriesML=[ENU=,,,Setup,User;
                                DEA=Neu,Vorgang,Bericht,Einrichtung,Benutzer];
    ActionList=ACTIONS
    {
      { 1000000025;  ;ActionContainer;
                      ActionContainerType=HomeItems }
      { 1000000009;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000030;1 ;Action    ;
                      CaptionML=[ENU=Navi&gate;
                                 DEA=Navi&gate];
                      RunObject=Page 344;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Navigate;
                      PromotedCategory=Process }
      { 1000000029;1 ;Action    ;
                      CaptionML=[ENU=Entry and Exit;
                                 DEA=Kommen-Gehen];
                      RunObject=Page 1024246;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Change;
                      PromotedCategory=Category5 }
      { 1000000027;1 ;Action    ;
                      CaptionML=[ENU=Change Password;
                                 DEA=Kennwort „ndern];
                      RunObject=Page 9809;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EncryptionKeys;
                      PromotedCategory=Category5 }
      { 1000000015;1 ;Action    ;
                      CaptionML=[ENU=Substitution;
                                 DEA=Vertretung];
                      RunObject=Page 70059;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CoupledUsers;
                      PromotedCategory=Category5 }
      { 1000000010;0 ;ActionContainer;
                      ActionContainerType=ActivityButtons }
      { 1000000012;1 ;ActionGroup;
                      CaptionML=[ENU=Accounting;
                                 DEA=Buchhaltung];
                      Image=Administration }
      { 1000000007;2 ;Action    ;
                      CaptionML=[ENU=Customers;
                                 DEA=Debitoren];
                      RunObject=Page 22 }
      { 1000000008;2 ;Action    ;
                      CaptionML=[ENU=Vendors;
                                 DEA=Kreditoren];
                      RunObject=Page 27 }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=RoleCenterArea }

    { 1000000006;1;Group  ;
                GroupType=Group }

    { 1000000018;2;Part   ;
                PagePartID=Page70607;
                PartType=Page }

    { 1000000017;2;Part   ;
                PagePartID=Page70608;
                PartType=Page }

    { 1000000001;2;Part   ;
                PagePartID=Page70609;
                PartType=Page }

    { 1000000019;2;Part   ;
                PagePartID=Page70601;
                PartType=Page }

    { 1000000016;2;Part   ;
                SubPageView=WHERE(RC Allow New Workorder=CONST(No),
                                  RC Allow New Request=CONST(Yes));
                PagePartID=Page70606;
                PartType=Page }

    { 1000000013;2;Part   ;
                PagePartID=Page70605;
                PartType=Page }

    { 1000000011;2;Part   ;
                PagePartID=Page70604;
                PartType=Page }

    { 1000000014;2;Part   ;
                PagePartID=Page70602;
                PartType=Page }

    { 1000000005;1;Group  ;
                GroupType=Group }

    { 1000000024;2;Part   ;
                PagePartID=Page70006;
                PartType=Page }

    { 1000000004;2;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

    { 1000000003;2;Part   ;
                PagePartID=Page681;
                PartType=Page }

    { 1000000002;2;Part   ;
                PagePartID=Page675;
                Visible=false;
                PartType=Page }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70504 CMMS Extended RC (PM)
{
  OBJECT-PROPERTIES
  {
    Date=28.08.17;
    Time=15:08:57;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Role Center;
               DEA=Rollencenter];
    PageType=RoleCenter;
    PromotedActionCategoriesML=[ENU=,,,Setup,User;
                                DEA=Neu,Vorgang,Bericht,Einrichtung,Benutzer];
    ActionList=ACTIONS
    {
      { 1000000025;  ;ActionContainer;
                      ActionContainerType=HomeItems }
      { 1000000009;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000030;1 ;Action    ;
                      CaptionML=[ENU=Navi&gate;
                                 DEA=Navi&gate];
                      RunObject=Page 344;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Navigate;
                      PromotedCategory=Process }
      { 1000000029;1 ;Action    ;
                      CaptionML=[ENU=Entry and Exit;
                                 DEA=Kommen-Gehen];
                      RunObject=Page 1024246;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Change;
                      PromotedCategory=Category5 }
      { 1000000027;1 ;Action    ;
                      CaptionML=[ENU=Change Password;
                                 DEA=Kennwort „ndern];
                      RunObject=Page 9809;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EncryptionKeys;
                      PromotedCategory=Category5 }
      { 1000000010;1 ;Action    ;
                      CaptionML=[ENU=Substitution;
                                 DEA=Vertretung];
                      RunObject=Page 70059;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CoupledUsers;
                      PromotedCategory=Category5 }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=RoleCenterArea }

    { 1000000006;1;Group  ;
                GroupType=Group }

    { 1000000013;2;Part   ;
                PagePartID=Page70607;
                PartType=Page }

    { 1000000012;2;Part   ;
                PagePartID=Page70608;
                PartType=Page }

    { 1000000007;2;Part   ;
                PagePartID=Page70609;
                PartType=Page }

    { 1000000014;2;Part   ;
                PagePartID=Page70601;
                PartType=Page }

    { 1000000011;2;Part   ;
                SubPageView=WHERE(RC Allow New Workorder=CONST(Yes),
                                  RC Allow New Request=CONST(Yes));
                PagePartID=Page70606;
                PartType=Page }

    { 1000000008;2;Part   ;
                PagePartID=Page70605;
                PartType=Page }

    { 1000000001;2;Part   ;
                PagePartID=Page70602;
                PartType=Page }

    { 1000000005;1;Group  ;
                GroupType=Group }

    { 1000000024;2;Part   ;
                PagePartID=Page70006;
                PartType=Page }

    { 1000000004;2;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

    { 1000000003;2;Part   ;
                PagePartID=Page681;
                PartType=Page }

    { 1000000002;2;Part   ;
                PagePartID=Page675;
                Visible=false;
                PartType=Page }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70506 CMMS Control Center RC
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=13:32:14;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Role Center;
               DEA=Rollencenter];
    PageType=RoleCenter;
    PromotedActionCategoriesML=[ENU=,,,Setup,User;
                                DEA=Neu,Vorgang,Bericht,Einrichtung,Benutzer];
    ActionList=ACTIONS
    {
      { 1000000025;  ;ActionContainer;
                      ActionContainerType=HomeItems }
      { 1000000009;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000030;1 ;Action    ;
                      CaptionML=[ENU=Navi&gate;
                                 DEA=Navi&gate];
                      RunObject=Page 344;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Navigate;
                      PromotedCategory=Process }
      { 1000000029;1 ;Action    ;
                      CaptionML=[ENU=Entry and Exit;
                                 DEA=Kommen-Gehen];
                      RunObject=Page 1024246;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Change;
                      PromotedCategory=Category5 }
      { 1000000027;1 ;Action    ;
                      CaptionML=[ENU=Change Password;
                                 DEA=Kennwort „ndern];
                      RunObject=Page 9809;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=EncryptionKeys;
                      PromotedCategory=Category5 }
      { 1000000014;1 ;Action    ;
                      CaptionML=[ENU=Substitution;
                                 DEA=Vertretung];
                      RunObject=Page 70059;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CoupledUsers;
                      PromotedCategory=Category5 }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=RoleCenterArea }

    { 1000000006;1;Group  ;
                GroupType=Group }

    { 1000000013;2;Part   ;
                PagePartID=Page70607;
                PartType=Page }

    { 1000000007;2;Part   ;
                PagePartID=Page70608;
                PartType=Page }

    { 1000000012;2;Part   ;
                PagePartID=Page70609;
                PartType=Page }

    { 1000000015;2;Part   ;
                PagePartID=Page70601;
                PartType=Page }

    { 1000000011;2;Part   ;
                SubPageView=WHERE(RC Allow New Workorder=CONST(Yes),
                                  RC Allow New Request=CONST(Yes));
                PagePartID=Page70606;
                PartType=Page }

    { 1000000008;2;Part   ;
                PagePartID=Page70605;
                PartType=Page }

    { 1000000001;2;Part   ;
                PagePartID=Page70602;
                PartType=Page }

    { 1000000005;1;Group  ;
                GroupType=Group }

    { 1000000024;2;Part   ;
                PagePartID=Page70006;
                PartType=Page }

    { 1000000004;2;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

    { 1000000003;2;Part   ;
                PagePartID=Page681;
                PartType=Page }

    { 1000000002;2;Part   ;
                PagePartID=Page675;
                Visible=false;
                PartType=Page }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70507 CMMS Bookkeeper Role Center
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=11:05:05;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Role Center;
               DEA=Rollencenter];
    PageType=RoleCenter;
    ActionList=ACTIONS
    {
      { 1900000006;0 ;ActionContainer;
                      ActionContainerType=Reports }
      { 34      ;1   ;Action    ;
                      CaptionML=[ENU=A&ccount Schedule;
                                 DEA=Ko&ntenschema];
                      RunObject=Report 25;
                      Image=Report }
      { 9       ;1   ;ActionGroup;
                      CaptionML=[ENU=&Trial Balance;
                                 DEA=&Rohbilanz];
                      Image=Balance }
      { 32      ;2   ;Action    ;
                      CaptionML=[ENU=&G/L Trial Balance;
                                 DEA=&Fiburohbilanz];
                      RunObject=Report 6;
                      Image=Report }
      { 33      ;2   ;Action    ;
                      CaptionML=[ENU=Bank &Detail Trial Balance;
                                 DEA=Bank - De&tailkontoblatt];
                      RunObject=Report 1404;
                      Image=Report }
      { 36      ;2   ;Action    ;
                      CaptionML=[ENU=T&rial Balance/Budget;
                                 DEA=R&ohbilanz/Budget];
                      RunObject=Report 9;
                      Image=Report }
      { 37      ;2   ;Action    ;
                      CaptionML=[ENU=Trial Balance by &Period;
                                 DEA=Rohbilanz nach &Periode];
                      RunObject=Report 38;
                      Image=Report }
      { 48      ;2   ;Action    ;
                      CaptionML=[ENU=Closing Tria&l Balance;
                                 DEA=Rohbilanz abschli&eáen];
                      RunObject=Report 10;
                      Image=Report }
      { 1140000 ;2   ;Action    ;
                      CaptionML=[ENU=G/L Total-Balance;
                                 DEA=Sachkonto - Summen Saldenliste];
                      RunObject=Report 11002;
                      Image=Report }
      { 46      ;1   ;Action    ;
                      CaptionML=[ENU=&Fiscal Year Balance;
                                 DEA=&Jahresbilanz];
                      RunObject=Report 36;
                      Image=Report }
      { 47      ;1   ;Action    ;
                      CaptionML=[ENU=Balance C&omp. . Prev. Year;
                                 DEA=Saldenvergl&eich - Vorjahr];
                      RunObject=Report 37;
                      Image=Report }
      { 49      ;1   ;Separator  }
      { 50      ;1   ;Action    ;
                      CaptionML=[ENU=&Aged Accounts Receivable;
                                 DEA=&Debitor - Saldenrckblick];
                      RunObject=Report 120;
                      Image=Report }
      { 51      ;1   ;Action    ;
                      CaptionML=[ENU=Aged Accou&nts Payable;
                                 DEA=Kreditor - S&aldenrckblick];
                      RunObject=Report 322;
                      Image=Report }
      { 52      ;1   ;Action    ;
                      CaptionML=[ENU=Reconcile Cust. and &Vend. Accs;
                                 DEA=Deb.- & Kred.-Konten abst&immen];
                      RunObject=Report 33;
                      Image=Report }
      { 1140001 ;1   ;Action    ;
                      CaptionML=[ENU=Customer Total-Balance;
                                 DEA=Debitor - Summen Saldenliste];
                      RunObject=Report 11003;
                      Image=Report }
      { 1140002 ;1   ;Action    ;
                      CaptionML=[ENU=Vendor Total-Balance;
                                 DEA=Kreditor - Summen Saldenliste];
                      RunObject=Report 11004;
                      Image=Report }
      { 53      ;1   ;Separator  }
      { 54      ;1   ;Action    ;
                      CaptionML=[ENU=VAT Reg&istration No. Check;
                                 DEA=USt-IdNr. &prfen];
                      RunObject=Report 32;
                      Image=Report }
      { 55      ;1   ;Action    ;
                      CaptionML=[ENU=VAT E&xceptions;
                                 DEA=MwSt.-Ausnahmef„&lle];
                      RunObject=Report 31;
                      Image=Report }
      { 56      ;1   ;Action    ;
                      CaptionML=[ENU=VAT State&ment;
                                 DEA=MwSt.-A&brechnung];
                      RunObject=Report 11110;
                      Image=Report }
      { 1140003 ;1   ;Action    ;
                      CaptionML=[ENU=Sales VAT Adv. Not. Acc;
                                 DEA=Konto fr USt.-Voranmeldung];
                      RunObject=Report 11009;
                      Image=Report }
      { 57      ;1   ;Action    ;
                      CaptionML=[ENU=VAT - VI&ES Declaration XML;
                                 DEA=Zusammenf&assende Meldung XML];
                      RunObject=Report 11108;
                      Image=Report }
      { 58      ;1   ;Action    ;
                      CaptionML=[ENU=VAT - VIES Declaration Dis&k;
                                 DEA=Zusammenfassende Meldung Dis&k];
                      RunObject=Report 88;
                      Image=Report }
      { 59      ;1   ;Action    ;
                      CaptionML=[ENU=EC &Sales List;
                                 DEA=EU-&Verkaufsbersicht];
                      RunObject=Report 130;
                      Image=Report }
      { 1900000011;0 ;ActionContainer;
                      ToolTipML=[ENU=Collect and make payments, prepare statements, and manage reminders.;
                                 DEA=Erfassen und verarbeiten Sie Zahlungen, bereiten Sie Auszge vor, und verwalten Sie Erinnerungen.];
                      ActionContainerType=HomeItems }
      { 2       ;1   ;Action    ;
                      CaptionML=[ENU=Chart of Accounts;
                                 DEA=Kontenplan];
                      RunObject=Page 16 }
      { 63      ;1   ;Action    ;
                      CaptionML=[ENU=Bank Accounts;
                                 DEA=Bankkonten];
                      RunObject=Page 371;
                      Image=BankAccount }
      { 12      ;1   ;Action    ;
                      Name=Customers;
                      CaptionML=[ENU=Customers;
                                 DEA=Debitoren];
                      RunObject=Page 22;
                      Image=Customer }
      { 20      ;1   ;Action    ;
                      Name=CustomersBalance;
                      CaptionML=[ENU=Balance;
                                 DEA=Saldo];
                      RunObject=Page 22;
                      RunPageView=WHERE(Balance (LCY)=FILTER(<>0));
                      Image=Balance }
      { 3       ;1   ;Action    ;
                      Name=Vendors;
                      CaptionML=[ENU=Vendors;
                                 DEA=Kreditoren];
                      RunObject=Page 27;
                      Image=Vendor }
      { 5       ;1   ;Action    ;
                      Name=VendorsBalance;
                      CaptionML=[ENU=Balance;
                                 DEA=Saldo];
                      RunObject=Page 27;
                      RunPageView=WHERE(Balance (LCY)=FILTER(<>0));
                      Image=Balance }
      { 10      ;1   ;Action    ;
                      CaptionML=[ENU=VAT Statements;
                                 DEA=MwSt.-Abrechnung];
                      RunObject=Page 320 }
      { 1000000022;1 ;Action    ;
                      CaptionML=[ENU=CMMS Purchase Orders;
                                 DEA=CMMS Bestellungen];
                      RunObject=Page 70142 }
      { 91      ;1   ;Action    ;
                      CaptionML=[ENU=Purchase Invoices;
                                 DEA=Einkaufsrechnungen];
                      RunObject=Page 9308 }
      { 1000000008;1 ;Action    ;
                      CaptionML=[ENU=Purchase Credit Memos;
                                 DEA=Einkaufsgutschriften];
                      RunObject=Page 9309 }
      { 92      ;1   ;Action    ;
                      CaptionML=[ENU=Sales Invoices;
                                 DEA=Verkaufsrechnungen];
                      RunObject=Page 9301;
                      Image=Invoice }
      { 1000000009;1 ;Action    ;
                      CaptionML=[ENU=Sales Credit Memos;
                                 DEA=Verkaufsgutschriften];
                      RunObject=Page 9302;
                      Image=Invoice }
      { 95      ;1   ;Action    ;
                      Name=CashReceiptJournals;
                      CaptionML=[ENU=Cash Receipt Journals;
                                 DEA=Zlg.-Eing. Buch.-Bl„tter];
                      RunObject=Page 251;
                      RunPageView=WHERE(Template Type=CONST(Cash Receipts),
                                        Recurring=CONST(No));
                      Image=Journals }
      { 96      ;1   ;Action    ;
                      Name=PaymentJournals;
                      CaptionML=[ENU=Payment Journals;
                                 DEA=Zlg.-Ausg. Buch.-Bl„tter];
                      RunObject=Page 251;
                      RunPageView=WHERE(Template Type=CONST(Payments),
                                        Recurring=CONST(No));
                      Image=Journals }
      { 97      ;1   ;Action    ;
                      Name=GeneralJournals;
                      CaptionML=[ENU=General Journals;
                                 DEA=Fibu Buch.-Bl„tter];
                      RunObject=Page 251;
                      RunPageView=WHERE(Template Type=CONST(General),
                                        Recurring=CONST(No));
                      Image=Journal }
      { 98      ;1   ;Action    ;
                      Name=RecurringGeneralJournals;
                      CaptionML=[ENU=Recurring General Journals;
                                 DEA=Wiederk. Fibu Buch.-Bl„tter];
                      RunObject=Page 251;
                      RunPageView=WHERE(Template Type=CONST(General),
                                        Recurring=CONST(Yes)) }
      { 99      ;1   ;Action    ;
                      CaptionML=[ENU=Intrastat Journals;
                                 DEA=Intrastat Buch.-Blatt];
                      RunObject=Page 327 }
      { 1900000012;0 ;ActionContainer;
                      ActionContainerType=ActivityButtons }
      { 1000000003;1 ;ActionGroup;
                      CaptionML=[ENU=Fixed Assets;
                                 DEA=Anlagen];
                      Image=FixedAssets }
      { 1000000004;2 ;Action    ;
                      Name=Fixed Assets;
                      CaptionML=[ENU=Fixed Assets;
                                 DEA=Anlagen];
                      RunObject=Page 5601 }
      { 1000000005;2 ;Action    ;
                      Name=FAGLJournals;
                      CaptionML=[ENU=FA G/L Journals;
                                 DEA=Anlagen Fibu Buch.-Bl„tter];
                      RunObject=Page 251;
                      RunPageView=WHERE(Template Type=CONST(Assets),
                                        Recurring=CONST(No));
                      Image=Journal }
      { 1000000006;2 ;Action    ;
                      Name=FAJournals;
                      CaptionML=[ENU=FA Journals;
                                 DEA=Anlagen Buch.-Bl„tter];
                      RunObject=Page 5633;
                      RunPageView=WHERE(Recurring=CONST(No));
                      Image=Journal }
      { 1000000007;2 ;Action    ;
                      Name=RecurringFAJournals;
                      CaptionML=[ENU=Recurring FA Journals;
                                 DEA=Wiederk. Anlagen Buch.-Bl„tter];
                      RunObject=Page 5633;
                      RunPageView=WHERE(Recurring=CONST(Yes));
                      Image=Journal }
      { 39      ;1   ;ActionGroup;
                      CaptionML=[ENU=Posted Documents;
                                 DEA=Gebuchte Belege];
                      ToolTipML=[ENU=View posted invoices and credit memos, and analyze G/L registers.;
                                 DEA=Zeigen Sie gebuchte Rechnungen und Verkaufsgutschriften an, und analysieren Sie Sachkontenregister.];
                      Image=FiledPosted }
      { 25      ;2   ;Action    ;
                      CaptionML=[ENU=Posted Sales Invoices;
                                 DEA=Geb. Verkaufsrechnungen];
                      RunObject=Page 143;
                      Image=PostedOrder }
      { 26      ;2   ;Action    ;
                      CaptionML=[ENU=Posted Sales Credit Memos;
                                 DEA=Geb. Verkaufsgutschriften];
                      RunObject=Page 144;
                      Image=PostedOrder }
      { 27      ;2   ;Action    ;
                      CaptionML=[ENU=Posted Purchase Invoices;
                                 DEA=Geb. Einkaufsrechnungen];
                      RunObject=Page 146 }
      { 28      ;2   ;Action    ;
                      CaptionML=[ENU=Posted Purchase Credit Memos;
                                 DEA=Geb. Einkaufsgutschriften];
                      RunObject=Page 147 }
      { 102     ;2   ;Action    ;
                      CaptionML=[ENU=G/L Registers;
                                 DEA=Fibujournale];
                      RunObject=Page 116;
                      Image=GLRegisters }
      { 31      ;1   ;ActionGroup;
                      CaptionML=[ENU=Administration;
                                 DEA=Verwaltung];
                      Image=Administration }
      { 38      ;2   ;Action    ;
                      CaptionML=[ENU=Currencies;
                                 DEA=W„hrungen];
                      RunObject=Page 5;
                      Image=Currency }
      { 40      ;2   ;Action    ;
                      CaptionML=[ENU=Accounting Periods;
                                 DEA=Buchhaltungsperioden];
                      RunObject=Page 100;
                      Image=AccountingPeriods }
      { 41      ;2   ;Action    ;
                      CaptionML=[ENU=Number Series;
                                 DEA=Nummernserie];
                      RunObject=Page 456 }
      { 16      ;0   ;ActionContainer;
                      ActionContainerType=NewDocumentItems }
      { 15      ;1   ;Action    ;
                      CaptionML=[ENU=C&ustomer;
                                 DEA=D&ebitor];
                      RunObject=Page 21;
                      Promoted=No;
                      Image=Customer;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 1000000020;1 ;Action    ;
                      CaptionML=[ENU=CMMS Purchase Order;
                                 DEA=CMMS Bestellung];
                      RunObject=Page 70141;
                      Image=Order;
                      RunPageMode=Create }
      { 104     ;1   ;Action    ;
                      CaptionML=[ENU=Sales &Invoice;
                                 DEA=Verkaufs&rechnung];
                      RunObject=Page 43;
                      Promoted=No;
                      Image=Invoice;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 7       ;1   ;Action    ;
                      CaptionML=[ENU=Sales Credit &Memo;
                                 DEA=Verkaufs&gutschrift];
                      RunObject=Page 44;
                      Promoted=No;
                      Image=CreditMemo;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 554     ;1   ;Separator  }
      { 555     ;1   ;Action    ;
                      CaptionML=[ENU=&Vendor;
                                 DEA=Kr&editor];
                      RunObject=Page 26;
                      Promoted=No;
                      Image=Vendor;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 66      ;1   ;Action    ;
                      CaptionML=[ENU=&Purchase Invoice;
                                 DEA=Einkau&fsrechnung];
                      RunObject=Page 51;
                      Promoted=No;
                      Image=Invoice;
                      PromotedCategory=Process;
                      RunPageMode=Create }
      { 1900000004;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000013;1 ;ActionGroup;
                      Name=UserReports;
                      CaptionML=[ENU=User Reports;
                                 DEA=Benutzer Berichte] }
      { 1000000012;2 ;Action    ;
                      CaptionML=[ENU=User Report Selection Administration;
                                 DEA=Benutzer Berichtsauswahl Verwaltung];
                      RunObject=Page 70005;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=UserSetup;
                      PromotedCategory=Process }
      { 67      ;1   ;Separator ;
                      CaptionML=[ENU=Tasks;
                                 DEA=Aufgaben];
                      IsHeader=Yes }
      { 74      ;1   ;Action    ;
                      CaptionML=[ENU=Cash Re&ceipt Journal;
                                 DEA=Zahlungse&ingangs Buch.-Blatt];
                      RunObject=Page 255;
                      Image=CashReceiptJournal }
      { 75      ;1   ;Action    ;
                      CaptionML=[ENU=Payment &Journal;
                                 DEA=Zahlungsausga&ngs Buch.-Blatt];
                      RunObject=Page 256;
                      Image=PaymentJournal }
      { 19      ;1   ;Action    ;
                      CaptionML=[ENU=Payment Registration;
                                 DEA=Zahlungsregistrierung];
                      RunObject=Page 981;
                      Image=Payment }
      { 77      ;1   ;Separator  }
      { 78      ;1   ;Action    ;
                      CaptionML=[ENU=B&ank Account Reconciliations;
                                 DEA=B&ankkontoabstimmung];
                      RunObject=Page 379;
                      Image=BankAccountRec }
      { 110     ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Adjust E&xchange Rates;
                                 DEA=&Wechselkurse regulieren];
                      RunObject=Report 595;
                      Image=AdjustExchangeRates }
      { 112     ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Post Inventor&y Cost to G/L;
                                 DEA=Lagerregulierung bu&chen];
                      RunObject=Report 1002;
                      Image=PostInventoryToGL }
      { 113     ;1   ;Action    ;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Calc. and Pos&t VAT Settlement;
                                 DEA=MwSt. a&brechnen und buchen];
                      RunObject=Report 20;
                      Image=SettleOpenTransactions }
      { 84      ;1   ;Separator ;
                      CaptionML=[ENU=Administration;
                                 DEA=Verwaltung];
                      IsHeader=Yes }
      { 86      ;1   ;Action    ;
                      CaptionML=[ENU=Sa&les && Receivables Setup;
                                 DEA=&Debitoren && Verkauf Einr.];
                      RunObject=Page 459;
                      Image=Setup }
      { 89      ;1   ;Separator ;
                      CaptionML=[ENU=History;
                                 DEA=Historie];
                      IsHeader=Yes }
      { 90      ;1   ;Action    ;
                      CaptionML=[ENU=Navi&gate;
                                 DEA=Navi&gate];
                      RunObject=Page 344;
                      Image=Navigate }
      { 1000000002;1 ;Separator  }
      { 1000000001;1 ;Action    ;
                      Name=ENC Page 1024246;
                      CaptionML=[ENU=Entry and Exit;
                                 DEA=Kommen-Gehen];
                      RunObject=Page 1024246;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Interaction;
                      PromotedCategory=Category4 }
      { 1000000000;1 ;Action    ;
                      Name=ENC Page 1024294;
                      CaptionML=[ENU=PIN Entry and Exit;
                                 DEA=PIN Kommen-Gehen];
                      RunObject=Page 1024294;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Interaction;
                      PromotedCategory=Category4 }
      { 1000000024;1 ;Action    ;
                      CaptionML=[ENU=Substitution;
                                 DEA=Vertretung];
                      RunObject=Page 70059;
                      RunPageView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                                  WHERE(Type=CONST(Substitue));
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CoupledUsers }
      { 1000000017;1 ;Action    ;
                      CaptionML=[ENU=Notification Copy;
                                 DEA=Benachrichtigungen Kopie];
                      RunObject=Page 70059;
                      RunPageView=SORTING(Objecttype,Type,Key1,Key2,Key3,Line No.)
                                  WHERE(Type=CONST(NotificationCopy));
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Copy }
      { 1000000023;1 ;Action    ;
                      Name=PowerShellDimCopy;
                      CaptionML=[ENU=Distribute Dimensions;
                                 DEA=Dimensionsverteilung];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Allocate;
                      PromotedCategory=Process }
    }
  }
  CONTROLS
  {
    { 1900000008;0;Container;
                ContainerType=RoleCenterArea }

    { 1900724808;1;Group   }

    { 1000000010;2;Part   ;
                PagePartID=Page50010;
                PartType=Page }

    { 1000000021;2;Part   ;
                PagePartID=Page70607;
                PartType=Page }

    { 1000000016;2;Part   ;
                PagePartID=Page70608;
                PartType=Page }

    { 1000000014;2;Part   ;
                PagePartID=Page70609;
                PartType=Page }

    { 1000000018;2;Part   ;
                PagePartID=Page70601;
                PartType=Page }

    { 1000000019;2;Part   ;
                SubPageView=WHERE(RC Allow New Workorder=CONST(Yes),
                                  RC Allow New Request=CONST(Yes));
                PagePartID=Page70606;
                PartType=Page }

    { 1000000015;2;Part   ;
                PagePartID=Page70602;
                PartType=Page }

    { 1907692008;2;Part   ;
                PagePartID=Page9150;
                PartType=Page }

    { 1900724708;1;Group   }

    { 1000000011;2;Part   ;
                PagePartID=Page70006;
                PartType=Page }

    { 17  ;2   ;Part      ;
                PagePartID=Page675;
                Visible=false;
                PartType=Page }

    { 1902476008;2;Part   ;
                PagePartID=Page9151;
                PartType=Page }

    { 18  ;2   ;Part      ;
                PagePartID=Page681;
                PartType=Page }

    { 1903012608;2;Part   ;
                PagePartID=Page9175;
                Visible=FALSE;
                PartType=Page }

    { 1901377608;2;Part   ;
                PartType=System;
                SystemPartID=MyNotes }

  }
  CODE
  {

    BEGIN
    {
      ENC 20160905  Added Action Items "Kommen-Gehen", "PIN Kommen-Gehen" - Omega PZE
    }
    END.
  }
}

OBJECT Page 70601 CMMS My Sub. WO Activities
{
  OBJECT-PROPERTIES
  {
    Date=08.05.18;
    Time=08:45:12;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=My Workorders (Substitution);
               DEA=Meine Arbeitsauftr„ge (Vertretung)];
    SourceTable=Table70011;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       CMMSGeneralMgmt.CalcCueFieldValues(Rec);
                       SubstitutionUserFilter := CMMSGeneralMgmt.GetSubstitutionUserFilter2(USERID);
                     END;

    ActionList=ACTIONS
    {
      { 1000000015;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000011;1 ;Action    ;
                      Name=Set Up Cues;
                      CaptionML=[ENU=Set Up Cues;
                                 DEA=Stapel einrichten];
                      Image=Setup;
                      OnAction=VAR
                                 CueRecordRef@1000 : RecordRef;
                               BEGIN
                                 CueRecordRef.GETTABLE(Rec);
                                 CueSetup.OpenCustomizePageForCurrentUser(CueRecordRef.NUMBER);
                               END;
                                }
      { 1000000004;1 ;Action    ;
                      Name=Search;
                      CaptionML=[ENU=Search;
                                 DEA=Suche];
                      Image=Find;
                      OnAction=VAR
                                 CMMSWoTaskSearchPage@1000000000 : Page 70018;
                               BEGIN
                                 CMMSWoTaskSearchPage.RUNMODAL();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000005;1;Group  ;
                Name=WorkOrdersGrp;
                CaptionML=[ENU=Work Orders;
                           DEA=Arbeitsauftr„ge];
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 1000000006;  ;Action    ;
                                  Name=Search_;
                                  CaptionML=[ENU=Search;
                                             DEA=Suche];
                                  Image=Find;
                                  OnAction=VAR
                                             CMMSWoTaskSearchPage@1000000000 : Page 70018;
                                           BEGIN
                                             CMMSWoTaskSearchPage.RUNMODAL();
                                           END;
                                            }
                }
                 }

    { 1000000003;2;Field  ;
                SourceExpr="My Sub. Work Orders";
                OnDrillDown=BEGIN
                              IF SubstitutionUserFilter <> '' THEN
                                CMMSWOMgmt.ShowWorkorders('','',SubstitutionUserFilter,'','0|1|2|3','','');
                            END;
                             }

    { 1000000002;2;Field  ;
                SourceExpr="My Planned Sub. WO (Due)";
                OnDrillDown=BEGIN
                              IF SubstitutionUserFilter <> '' THEN
                                CMMSWOMgmt.ShowWorkorders('','',SubstitutionUserFilter,'','0|1|2|3',Rec.GETFILTER("Due Date Filter (Planned)"),'');
                            END;
                             }

    { 1000000001;2;Field  ;
                SourceExpr="My Planned Sub. WO (Overdue)";
                Style=Unfavorable;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              IF SubstitutionUserFilter <> '' THEN
                                CMMSWOMgmt.ShowWorkorders('','',SubstitutionUserFilter,Rec.GETFILTER("Overdue Date Filter (Planned)"),'0|1|2|3','','');
                            END;
                             }

  }
  CODE
  {
    VAR
      CueSetup@1000000000 : Codeunit 9701;
      CMMSGeneralMgmt@1000000004 : Codeunit 70000;
      Text001@1000000008 : TextConst 'ENU="Function ""DoInit()"" need to be called before openening the Page (Page = %1).";DEA="Funktion ""DoInit()"" muss aufgerufen werden bevor die Seite ge”ffnet wird (Seite = %1)."';
      CMMSWOMgmt@1000000001 : Codeunit 70030;
      SubstitutionUserFilter@1000000002 : Text;

    BEGIN
    END.
  }
}

OBJECT Page 70602 CMMS Time Tracking Activities
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=13:31:26;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Time Tracking;
               DEA=Zeiterfassung];
    SourceTable=Table70011;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 _phone := (CURRENTCLIENTTYPE = CLIENTTYPE::Phone);

                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       CMGenMgt.CalcfieldsCue(Rec);
                     END;

    ActionList=ACTIONS
    {
      { 1000000005;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000004;1 ;Action    ;
                      Name=Set Up Cues;
                      CaptionML=[ENU=Set Up Cues;
                                 DEA=Stapel einrichten];
                      Image=Setup;
                      OnAction=VAR
                                 CueRecordRef@1000 : RecordRef;
                               BEGIN
                                 CueRecordRef.GETTABLE(Rec);
                                 CueSetup.OpenCustomizePageForCurrentUser(CueRecordRef.NUMBER);
                               END;
                                }
      { 1000000006;1 ;Action    ;
                      Name=AllTimes;
                      CaptionML=[ENU=All Times;
                                 DEA=Alle Zeiten];
                      Image=JobTimeSheet;
                      OnAction=BEGIN
                                 CMTTMgt.ShowPostedEntries(USERID,'',0);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000007;1;Group  ;
                Name=TimeTrackGroup;
                CaptionML=[ENU=Time Tracking;
                           DEA=Zeiterfassung];
                GroupType=CueGroup }

    { 1000000003;2;Field  ;
                Name=Recording;
                CaptionML=[ENU=Time Tracking;
                           DEA=Zeiten erfassen];
                SourceExpr='';
                Style=Favorable;
                StyleExpr=TRUE;
                OnDrillDown=VAR
                              TimeTrackingPageCard@1000000000 : Page 70092;
                            BEGIN
                              TimeTrackingPageCard.LOOKUPMODE(TRUE);
                              TimeTrackingPageCard.RUNMODAL();
                            END;

                Image=Time }

    { 1000000002;2;Field  ;
                SourceExpr="My Time Records (Today)";
                OnDrillDown=BEGIN
                              CMTTMgt.ShowPostedEntries(USERID,FORMAT(WORKDATE),0);
                            END;

                Image=Calendar }

    { 1000000001;2;Field  ;
                SourceExpr="My Time Records (Week)";
                OnDrillDown=BEGIN
                              CMTTMgt.ShowPostedEntries(USERID,CMTTMgt.GetThisWeekDatefilter(WORKDATE),0);
                            END;

                Image=Calendar }

    { 1000000008;2;Field  ;
                SourceExpr="My Time Records (Month)";
                OnDrillDown=BEGIN
                              CMTTMgt.ShowPostedEntries(USERID,CMTTMgt.GetThisMonthDatefilter(WORKDATE),0);
                            END;

                Image=Calendar }

  }
  CODE
  {
    VAR
      CueSetup@1000000000 : Codeunit 9701;
      OpenTimeTracking@1000000001 : Boolean;
      CMGenMgt@1000000002 : Codeunit 70000;
      CMTTMgt@1000000003 : Codeunit 70040;
      _phone@1000000004 : Boolean INDATASET;

    BEGIN
    END.
  }
}

OBJECT Page 70604 CMMS Posted Time Activities
{
  OBJECT-PROPERTIES
  {
    Date=30.08.17;
    Time=16:43:51;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Posted Time;
               DEA=Gebuchte Zeit];
    SourceTable=Table70011;
    PageType=CardPart;
    OnOpenPage=BEGIN

                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       CMMSGeneralMgmt.CalcfieldsCue(Rec);
                     END;

    ActionList=ACTIONS
    {
      { 1000000015;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000011;1 ;Action    ;
                      Name=Set Up Cues;
                      CaptionML=[ENU=Set Up Cues;
                                 DEA=Stapel einrichten];
                      Image=Setup;
                      OnAction=VAR
                                 CueRecordRef@1000 : RecordRef;
                               BEGIN
                                 CueRecordRef.GETTABLE(Rec);
                                 CueSetup.OpenCustomizePageForCurrentUser(CueRecordRef.NUMBER);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000012;1;Group  ;
                Name=TimeTrackGroup;
                CaptionML=[ENU=Posted Time;
                           DEA=Gebuchte Zeit];
                GroupType=CueGroup }

    { 1000000014;2;Field  ;
                SourceExpr="Time Records (Today)";
                OnDrillDown=BEGIN
                              CMTTMgt.ShowPostedEntries('',FORMAT(WORKDATE),0);
                            END;
                             }

    { 1000000013;2;Field  ;
                SourceExpr="Time Records (Week)";
                OnDrillDown=BEGIN
                              CMTTMgt.ShowPostedEntries('',CMTTMgt.GetThisWeekDatefilter(WORKDATE),0);
                            END;
                             }

    { 1000000001;2;Field  ;
                SourceExpr="Time Records";
                OnDrillDown=BEGIN
                              CMTTMgt.ShowPostedEntries('','',1);
                            END;
                             }

  }
  CODE
  {
    VAR
      CueSetup@1000000000 : Codeunit 9701;
      CMAssetMgmt@1000000001 : Codeunit 70020;
      CMTTMgt@1000000002 : Codeunit 70040;
      CMMSWOMgmt@1000000003 : Codeunit 70030;
      CMMSGeneralMgmt@1000000004 : Codeunit 70000;
      CMMSTaskMgt@1000000005 : Codeunit 70031;

    BEGIN
    END.
  }
}

OBJECT Page 70605 CMMS Request Activities
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=13:23:31;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Requests;
               DEA=Anfragen];
    SourceTable=Table70011;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 _AllowNewRequest := Rec."RC Allow New Request";

                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       CMMSGeneralMgmt.CalcfieldsCue(Rec);
                     END;

    ActionList=ACTIONS
    {
      { 1000000015;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000011;1 ;Action    ;
                      Name=Set Up Cues;
                      CaptionML=[ENU=Set Up Cues;
                                 DEA=Stapel einrichten];
                      Image=Setup;
                      OnAction=VAR
                                 CueRecordRef@1000 : RecordRef;
                               BEGIN
                                 CueRecordRef.GETTABLE(Rec);
                                 CueSetup.OpenCustomizePageForCurrentUser(CueRecordRef.NUMBER);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000009;1;Group  ;
                Name=RequestGrp;
                CaptionML=[ENU=Request;
                           DEA=Anfragen];
                GroupType=CueGroup }

    { 1000000008;2;Field  ;
                SourceExpr="My Requests";
                LookupPageID=CMMS Request List;
                DrillDownPageID=CMMS Request List }

    { 1000000001;2;Field  ;
                SourceExpr=Requests;
                LookupPageID=CMMS Request List;
                DrillDownPageID=CMMS Request List }

    { 1000000003;2;Field  ;
                Name=NewRequest;
                CaptionML=[ENU=Create New Request;
                           DEA=Neue Anfrage Erstellen];
                SourceExpr='';
                Visible=_AllowNewRequest;
                Enabled=_AllowNewRequest;
                Style=Favorable;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              CMMSTaskMgt.NewGenRequestUI();
                            END;

                Image=Message }

  }
  CODE
  {
    VAR
      CueSetup@1000000000 : Codeunit 9701;
      CMAssetMgmt@1000000001 : Codeunit 70020;
      CMTTMgt@1000000002 : Codeunit 70040;
      CMMSWOMgmt@1000000003 : Codeunit 70030;
      CMMSGeneralMgmt@1000000004 : Codeunit 70000;
      CMMSTaskMgt@1000000005 : Codeunit 70031;
      _AllowNewRequest@1000000006 : Boolean INDATASET;

    BEGIN
    END.
  }
}

OBJECT Page 70606 CMMS Functions Activities
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=13:44:15;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=CMMS Functions;
               DEA=CMMS Funktionen];
    SourceTable=Table70011;
    PopulateAllFields=Yes;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 _AllowNewRequest := Rec."RC Allow New Request";
                 _AllowNewWorkorder := Rec."RC Allow New Workorder";
                 _Phone := CURRENTCLIENTTYPE = CLIENTTYPE::Phone;

                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    ActionList=ACTIONS
    {
      { 1000000015;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000011;1 ;Action    ;
                      Name=Set Up Cues;
                      CaptionML=[ENU=Set Up Cues;
                                 DEA=Stapel einrichten];
                      Image=Setup;
                      OnAction=VAR
                                 CueRecordRef@1000 : RecordRef;
                               BEGIN
                                 CueRecordRef.GETTABLE(Rec);
                                 CueSetup.OpenCustomizePageForCurrentUser(CueRecordRef.NUMBER);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000003;1;Group  ;
                Name=CMMSFunctions;
                CaptionML=[ENU=CMMS Functions;
                           DEA=CMMS Funktionen];
                GroupType=CueGroup }

    { 1000000002;2;Field  ;
                Name=NewRequest;
                CaptionML=[ENU=Create New Request;
                           DEA=Neue Anfrage Erstellen];
                SourceExpr='';
                Visible=_AllowNewRequest;
                Enabled=_AllowNewRequest;
                Style=Favorable;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              CMMSTaskMgt.NewGenRequestUI();
                            END;

                Image=Message }

    { 1000000001;2;Field  ;
                Name=NewWorkorder;
                CaptionML=[ENU=Create New Workorder;
                           DEA=Neuen Arbeitsauftrag Erstellen];
                SourceExpr='';
                Visible=_AllowNewWorkorder;
                Enabled=_AllowNewWorkorder;
                Style=Favorable;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              CMMSWOMgmt.NewWorkorderUI();
                            END;

                Image=Settings }

    { 1000000005;2;Field  ;
                Name=Recording;
                CaptionML=[ENU=Time Tracking;
                           DEA=Zeiten erfassen];
                SourceExpr='';
                Style=Favorable;
                StyleExpr=TRUE;
                OnDrillDown=VAR
                              TimeTrackingPageCard@1000000000 : Page 70092;
                            BEGIN
                              TimeTrackingPageCard.LOOKUPMODE(TRUE);
                              TimeTrackingPageCard.RUNMODAL();
                            END;

                Image=Time }

    { 1000000004;2;Field  ;
                Name=NotificationSetup;
                CaptionML=[ENU=Select my Notifications;
                           DEA=Meine Benachr. Einstellen];
                SourceExpr=CMGenMgt.CountNotifications(USERID);
                OnDrillDown=VAR
                              CMMSNotificationSetupCard@1000000000 : Page 70010;
                            BEGIN
                              CMMSNotificationSetupCard.RUNMODAL();
                            END;

                Image=Settings }

  }
  CODE
  {
    VAR
      CueSetup@1000000000 : Codeunit 9701;
      CMAssetMgmt@1000000001 : Codeunit 70020;
      CMTTMgt@1000000002 : Codeunit 70040;
      CMMSWOMgmt@1000000003 : Codeunit 70030;
      CMGenMgt@1000000004 : Codeunit 70000;
      CMMSTaskMgt@1000000005 : Codeunit 70031;
      _AllowNewWorkorder@1000000006 : Boolean INDATASET;
      _AllowNewRequest@1000000007 : Boolean INDATASET;
      _AllowNewAsset@1000000009 : Boolean INDATASET;
      Text001@1000000010 : TextConst 'ENU="Function ""DoInit()"" need to be called before openening the Page (Page = %1).";DEA="Funktion ""DoInit()"" muss aufgerufen werden bevor die Seite ge”ffnet wird (Seite = %1)."';
      _AllowNewProject@1000000008 : Boolean INDATASET;
      _Phone@1000000011 : Boolean INDATASET;

    BEGIN
    END.
  }
}

OBJECT Page 70607 CMMS Master Data Activities
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=14:16:06;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Masterdata;
               DEA=Stammdaten];
    SourceTable=Table70011;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       CMMSGeneralMgmt.CalcCueFieldValues(Rec);
                     END;

    ActionList=ACTIONS
    {
      { 1000000015;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000011;1 ;Action    ;
                      Name=Set Up Cues;
                      CaptionML=[ENU=Set Up Cues;
                                 DEA=Stapel einrichten];
                      Image=Setup;
                      OnAction=VAR
                                 CueRecordRef@1000 : RecordRef;
                               BEGIN
                                 CueRecordRef.GETTABLE(Rec);
                                 CueSetup.OpenCustomizePageForCurrentUser(CueRecordRef.NUMBER);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000019;1;Group  ;
                Name=AssetsGrp;
                CaptionML=[ENU=Master Data;
                           DEA=Stammdaten];
                GroupType=CueGroup }

    { 1000000003;2;Field  ;
                SourceExpr=Assets;
                OnDrillDown=BEGIN
                              //CMAssetMgmt.ShowAssetList(FALSE,FALSE);
                              CMMSGeneralMgmt.SetEditable(TRUE);
                              CMMSGeneralMgmt.DoUniversalLookup(3,'','','','');
                            END;
                             }

    { 1000000020;2;Field  ;
                SourceExpr="Main Assets";
                OnDrillDown=BEGIN
                              CMMSGeneralMgmt.SetEditable(TRUE);
                              CMMSGeneralMgmt.DoUniversalLookup(2,'','','','');
                            END;
                             }

    { 1000000018;2;Field  ;
                SourceExpr=Projects;
                OnDrillDown=BEGIN
                              //CMAssetMgmt.ShowProjectList(FALSE,FALSE);
                              CMMSGeneralMgmt.SetEditable(TRUE);
                              CMMSGeneralMgmt.DoUniversalLookup(1,'','','','');
                            END;
                             }

    { 1000000007;2;Field  ;
                SourceExpr=Contracts;
                OnDrillDown=VAR
                              CMMSContractMgmt@1000000000 : Codeunit 70021;
                            BEGIN
                              CMMSContractMgmt.ShowContractList;
                            END;
                             }

  }
  CODE
  {
    VAR
      CueSetup@1000000000 : Codeunit 9701;
      CMAssetMgmt@1000000001 : Codeunit 70020;
      CMTTMgt@1000000002 : Codeunit 70040;
      CMMSWOMgmt@1000000003 : Codeunit 70030;
      CMMSGeneralMgmt@1000000004 : Codeunit 70000;
      CMMSTaskMgt@1000000005 : Codeunit 70031;
      Text001@1000000009 : TextConst 'ENU="Function ""DoInit()"" need to be called before openening the Page (Page = %1).";DEA="Funktion ""DoInit()"" muss aufgerufen werden bevor die Seite ge”ffnet wird (Seite = %1)."';

    BEGIN
    END.
  }
}

OBJECT Page 70608 CMMS Gen. Workorder Activities
{
  OBJECT-PROPERTIES
  {
    Date=31.08.17;
    Time=08:57:41;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=General Workorders;
               DEA=Generelle Arbeitsauftr„ge];
    SourceTable=Table70011;
    PopulateAllFields=Yes;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    OnAfterGetRecord=VAR
                       dt@1000000000 : DateTime;
                     BEGIN
                       //dt := CREATEDATETIME(TODAY,TIME);
                       CMMSGeneralMgmt.CalcCueFieldValues(Rec);
                       //MESSAGE(FORMAT(CREATEDATETIME(TODAY,TIME) - dt));
                     END;

    ActionList=ACTIONS
    {
      { 1000000015;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000011;1 ;Action    ;
                      Name=Set Up Cues;
                      CaptionML=[ENU=Set Up Cues;
                                 DEA=Stapel einrichten];
                      Image=Setup;
                      OnAction=VAR
                                 CueRecordRef@1000 : RecordRef;
                               BEGIN
                                 CueRecordRef.GETTABLE(Rec);
                                 CueSetup.OpenCustomizePageForCurrentUser(CueRecordRef.NUMBER);
                               END;
                                }
      { 1000000012;1 ;Action    ;
                      Name=Work Order Archive;
                      CaptionML=[ENU=Work Order Archive;
                                 DEA=Arbeitsauftr„ge Archiv];
                      Image=Archive;
                      OnAction=BEGIN
                                 CMMSWOMgmt.ShowWorkorderArchive();
                               END;
                                }
      { 1000000010;1 ;Action    ;
                      Name=Alarm Archive;
                      CaptionML=[ENU=Alarm Archive;
                                 DEA=Alarm Archiv];
                      Image=Archive;
                      OnAction=BEGIN
                                 CMIfMgt.ShowAlarmArchive();
                               END;
                                }
      { 1000000014;1 ;Action    ;
                      Name=Search;
                      CaptionML=[ENU=Search;
                                 DEA=Suche];
                      Image=Find;
                      OnAction=VAR
                                 CMMSWoTaskSearchPage@1000000000 : Page 70018;
                               BEGIN
                                 CMMSWoTaskSearchPage.RUNMODAL();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000006;1;Group  ;
                Name=WorkOrdersGrp;
                CaptionML=[ENU=Work Orders;
                           DEA=Arbeitsauftr„ge];
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 1000000009;  ;Action    ;
                                  Name=Work Order Archive_;
                                  CaptionML=[ENU=Work Order Archive;
                                             DEA=Arbeitsauftr„ge Archiv];
                                  OnAction=BEGIN
                                             CMMSWOMgmt.ShowWorkorderArchive();
                                           END;
                                            }
                  { 1000000008;  ;Action    ;
                                  Name=Alarm Archive_;
                                  CaptionML=[ENU=Alarm Archive;
                                             DEA=Alarm Archiv];
                                  OnAction=BEGIN
                                             CMIfMgt.ShowAlarmArchive();
                                           END;
                                            }
                  { 1000000013;  ;Action    ;
                                  Name=Search_;
                                  CaptionML=[ENU=Search;
                                             DEA=Suche];
                                  Image=Find;
                                  OnAction=VAR
                                             CMMSWoTaskSearchPage@1000000000 : Page 70018;
                                           BEGIN
                                             CMMSWoTaskSearchPage.RUNMODAL();
                                           END;
                                            }
                }
                 }

    { 1000000001;2;Field  ;
                SourceExpr="New Work Orders (Resp.)";
                OnDrillDown=BEGIN
                              CMMSWOMgmt.ShowWorkorders('',USERID,USERID,'','0','','<>1&<>4');
                            END;
                             }

    { 1000000002;2;Field  ;
                SourceExpr="Open Work Orders (Resp.)";
                OnDrillDown=BEGIN
                              CMMSWOMgmt.ShowWorkorders('',USERID,USERID,'','1','','');
                            END;
                             }

    { 1000000003;2;Field  ;
                SourceExpr="Work Orders In Process (Resp.)";
                OnDrillDown=BEGIN
                              CMMSWOMgmt.ShowWorkorders('',USERID,USERID,'','2','','');
                            END;
                             }

    { 1000000004;2;Field  ;
                SourceExpr="Completed Work Orders (Resp.)";
                OnDrillDown=BEGIN
                              CMMSWOMgmt.ShowWorkorders('',USERID,USERID,'','3','','');
                            END;
                             }

    { 1000000005;1;Group  ;
                Name=AlarmGrp;
                CaptionML=[ENU=Alarms;
                           DEA=Alarme];
                GroupType=CueGroup }

    { 1000000007;2;Field  ;
                SourceExpr="New Alarm Work Orders (Resp.)";
                OnDrillDown=BEGIN
                              CMMSWOMgmt.ShowWorkorders('',USERID,USERID,'','0','','1|4');
                            END;
                             }

  }
  CODE
  {
    VAR
      CueSetup@1000000000 : Codeunit 9701;
      CMMSWOMgmt@1000000003 : Codeunit 70030;
      CMIfMgt@1000000006 : Codeunit 70026;
      Text001@1000000010 : TextConst 'ENU="Function ""DoInit()"" need to be called before openening the Page (Page = %1).";DEA="Funktion ""DoInit()"" muss aufgerufen werden bevor die Seite ge”ffnet wird (Seite = %1)."';
      CMMSGeneralMgmt@1000000001 : Codeunit 70000;

    BEGIN
    END.
  }
}

OBJECT Page 70609 CMMS My Workorder Activities
{
  OBJECT-PROPERTIES
  {
    Date=07.05.18;
    Time=13:47:01;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=My Workorders;
               DEA=Meine Arbeitsauftr„ge];
    SourceTable=Table70011;
    PageType=CardPart;
    OnOpenPage=BEGIN
                 RESET;
                 IF NOT GET THEN BEGIN
                   INIT;
                   INSERT;
                 END;
               END;

    OnAfterGetRecord=BEGIN
                       CMGenMgt.CalcCueFieldValues(Rec);
                     END;

    ActionList=ACTIONS
    {
      { 1000000015;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000011;1 ;Action    ;
                      Name=Set Up Cues;
                      CaptionML=[ENU=Set Up Cues;
                                 DEA=Stapel einrichten];
                      Image=Setup;
                      OnAction=VAR
                                 CueRecordRef@1000 : RecordRef;
                               BEGIN
                                 CueRecordRef.GETTABLE(Rec);
                                 CueSetup.OpenCustomizePageForCurrentUser(CueRecordRef.NUMBER);
                               END;
                                }
      { 1000000006;1 ;Action    ;
                      Name=Search;
                      CaptionML=[ENU=Search;
                                 DEA=Suche];
                      Image=Find;
                      OnAction=VAR
                                 CMMSWoTaskSearchPage@1000000000 : Page 70018;
                               BEGIN
                                 CMMSWoTaskSearchPage.RUNMODAL();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000005;1;Group  ;
                Name=WorkOrdersGrp;
                CaptionML=[ENU=Work Orders;
                           DEA=Arbeitsauftr„ge];
                GroupType=CueGroup;
                ActionList=ACTIONS
                {
                  { 1000000007;  ;Action    ;
                                  Name=Search_;
                                  CaptionML=[ENU=Search;
                                             DEA=Suche];
                                  Image=Find;
                                  OnAction=VAR
                                             CMMSWoTaskSearchPage@1000000000 : Page 70018;
                                           BEGIN
                                             CMMSWoTaskSearchPage.RUNMODAL();
                                           END;
                                            }
                }
                 }

    { 1000000004;2;Field  ;
                SourceExpr="My Work Orders";
                OnDrillDown=BEGIN
                              CMMSWOMgmt.ShowWorkorders('','',USERID,'','0|1|2|3','','');
                            END;
                             }

    { 1000000003;2;Field  ;
                SourceExpr="My Planned Work. (Due)";
                OnDrillDown=BEGIN
                              CMMSWOMgmt.ShowWorkorders('','',USERID,'','0|1|2|3',Rec.GETFILTER("Due Date Filter (Planned)"),'');
                            END;
                             }

    { 1000000002;2;Field  ;
                SourceExpr="My Planned Work. (Overdue)";
                Style=Unfavorable;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              CMMSWOMgmt.ShowWorkorders('','',USERID,Rec.GETFILTER("Overdue Date Filter (Planned)"),'0|1|2|3','','');
                            END;
                             }

    { 1000000001;2;Field  ;
                Name=NewRequest;
                CaptionML=[ENU=Create New Request;
                           DEA=Neue Anfrage Erstellen];
                SourceExpr='';
                Style=Favorable;
                StyleExpr=TRUE;
                OnDrillDown=BEGIN
                              CMMSTaskMgt.NewGenRequestUI();
                            END;

                Image=Message }

    { 1000000008;2;Field  ;
                Name=NotificationSetup;
                CaptionML=[ENU=Select my Notifications;
                           DEA=Meine Benachr. Einstellen];
                SourceExpr=CMGenMgt.CountNotifications(USERID);
                OnDrillDown=VAR
                              CMMSNotificationSetupCard@1000000000 : Page 70010;
                            BEGIN
                              CMMSNotificationSetupCard.RUNMODAL();
                            END;

                Image=Settings }

  }
  CODE
  {
    VAR
      CueSetup@1000000000 : Codeunit 9701;
      CMAssetMgmt@1000000001 : Codeunit 70020;
      CMTTMgt@1000000002 : Codeunit 70040;
      CMMSWOMgmt@1000000003 : Codeunit 70030;
      CMGenMgt@1000000004 : Codeunit 70000;
      CMMSTaskMgt@1000000005 : Codeunit 70031;
      Text001@1000000008 : TextConst 'ENU="Function ""DoInit()"" need to be called before openening the Page (Page = %1).";DEA="Funktion ""DoInit()"" muss aufgerufen werden bevor die Seite ge”ffnet wird (Seite = %1)."';

    BEGIN
    END.
  }
}

OBJECT Page 70700 CMMS Object Workorders Infobox
{
  OBJECT-PROPERTIES
  {
    Date=20.03.17;
    Time=11:47:13;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Linked Workorders;
               DEA=Verbundene Arbeitsauftr„ge];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70020;
    SourceTableView=SORTING(No.);
    PageType=CardPart;
    OnAfterGetRecord=VAR
                       CMGenMgt@1000000000 : Codeunit 70000;
                     BEGIN
                       CALCFIELDS("New Workorders","Open Workorders","In Proc. Workorders","Completed Workorders","Done Workorders","Discarded Workorders");
                       CalculateCueFieldValues;
                     END;

  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                Name=WOs;
                CaptionML=[ENU=Workorders;
                           DEA=Arbeitsauftr„ge];
                SourceExpr="New Workorders";
                OnDrillDown=BEGIN
                              CMMSWOMgmt.ShowWorkorders("No.",'','','','0|1|2|3','','');
                            END;
                             }

    { 1000000005;1;Field  ;
                Name=FinishedWOs;
                CaptionML=[ENU=Finished Workorders;
                           DEA=Beendete Arbeitsauftr„ge];
                SourceExpr="Done Workorders";
                OnDrillDown=BEGIN
                              CMMSWOMgmt.ShowWorkorders("No.",'','','','4|5|6','','');
                            END;
                             }

  }
  CODE
  {
    VAR
      CMMSWOMgmt@1000000000 : Codeunit 70030;

    LOCAL PROCEDURE CalculateCueFieldValues@6();
    BEGIN
      IF FIELDACTIVE("New Workorders") THEN
        "New Workorders" := CMMSWOMgmt.CountWorkorders("No.",'','','','0|1|2|3','','');

      IF FIELDACTIVE("Done Workorders") THEN
        "Done Workorders" := CMMSWOMgmt.CountWorkorders("No.",'','','','4|5|6','','');
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70701 CMMS Rel. Asset Info. Infobox
{
  OBJECT-PROPERTIES
  {
    Date=17.10.17;
    Time=16:27:41;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Related Information;
               DEA=Verbundene Informationen];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70020;
    PageType=CardPart;
    RefreshOnActivate=Yes;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000004;1;Field  ;
                SourceExpr=Subassets;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedSubAssets(Rec);
                            END;
                             }

    { 1000000005;1;Field  ;
                SourceExpr=Projects;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedAssetsProjects(Rec);
                            END;
                             }

    { 1000000006;1;Field  ;
                SourceExpr=Contracts;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedContracts(Rec);
                            END;
                             }

    { 1000000002;1;Field  ;
                SourceExpr=Customers;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedCustomers(Rec);
                            END;
                             }

    { 1000000007;1;Field  ;
                CaptionML=[ENU=Relations / Contacts;
                           DEA=Verbindungen / Kontakte];
                SourceExpr=Relations;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedRelations(Rec);
                            END;
                             }

    { 1000000001;1;Field  ;
                SourceExpr=Users;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedUserroles(Rec);
                            END;
                             }

    { 1000000003;1;Field  ;
                SourceExpr=Activities;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedLogs(Rec,0);
                            END;
                             }

  }
  CODE
  {
    VAR
      CMAssetMgt@1000000000 : Codeunit 70020;

    BEGIN
    END.
  }
}

OBJECT Page 70702 CMMS WO - Activities Infobox
{
  OBJECT-PROPERTIES
  {
    Date=30.08.17;
    Time=15:45:05;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Aktivities;
               DEA=Aktivit„ten];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5092;
    SourceTableView=SORTING(CM Is Workorder,CM Object No.)
                    WHERE(CM Is Workorder=CONST(Yes));
    PageType=CardPart;
    OnAfterGetRecord=BEGIN
                       Activities := CMWoMgt.CountRelatedLogs(Rec, -1, 0);
                       StatusChangeActivities := CMWoMgt.CountRelatedLogs(Rec, LogEntry."CM Log Type"::"Status Change", 0);
                       AttachmentActivities := CMWoMgt.CountRelatedLogs(Rec, LogEntry."CM Log Type"::Attachment, 0);
                       PhotoActivities := CMWoMgt.CountRelatedLogs(Rec, LogEntry."CM Log Type"::Picture, 0);
                       ReadActivities := CMWoMgt.CountRelatedLogs(Rec, LogEntry."CM Log Type"::Read, 0);
                       TaskActivities := CMWoMgt.CountRelatedLogs(Rec, -1, 1);
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                Name=Activities;
                CaptionML=[ENU=Aktivities;
                           DEA=Aktivit„ten];
                SourceExpr=Activities;
                OnDrillDown=BEGIN
                              CMWoMgt.ShowRelatedLogs(Rec, -1, 0);
                            END;
                             }

    { 1000000002;1;Field  ;
                Name=StatusChangeActivities;
                CaptionML=[ENU=Status Change Activities;
                           DEA=Status„nderung Aktivit„ten];
                SourceExpr=StatusChangeActivities;
                OnDrillDown=BEGIN
                              CMWoMgt.ShowRelatedLogs(Rec, LogEntry."CM Log Type"::"Status Change", 0);
                            END;
                             }

    { 1000000003;1;Field  ;
                Name=AttachmentActivities;
                CaptionML=[ENU=Attachment Activities;
                           DEA=Anhang Aktivit„ten];
                SourceExpr=AttachmentActivities;
                Visible=FALSE;
                OnDrillDown=BEGIN
                              CMWoMgt.ShowRelatedLogs(Rec, LogEntry."CM Log Type"::Attachment, 0);
                            END;
                             }

    { 1000000004;1;Field  ;
                Name=PhotoActivities;
                CaptionML=[ENU=Photo Activities;
                           DEA=Foto Aktivit„ten];
                SourceExpr=PhotoActivities;
                Visible=FALSE;
                OnDrillDown=BEGIN
                              CMWoMgt.ShowRelatedLogs(Rec, LogEntry."CM Log Type"::Picture, 0);
                            END;
                             }

    { 1000000005;1;Field  ;
                Name=ReadActivities;
                CaptionML=[ENU=Read Activities;
                           DEA=Gelesen Aktivit„ten];
                SourceExpr=ReadActivities;
                OnDrillDown=BEGIN
                              CMWoMgt.ShowRelatedLogs(Rec, LogEntry."CM Log Type"::Read, 0);
                            END;
                             }

    { 1000000006;1;Field  ;
                Name=TaskActivities;
                CaptionML=[ENU=Task Activities;
                           DEA=Aufgaben Aktivit„ten];
                SourceExpr=TaskActivities;
                OnDrillDown=BEGIN
                              CMWoMgt.ShowRelatedLogs(Rec, -1, 1);
                            END;
                             }

  }
  CODE
  {
    VAR
      Activities@1000000000 : Integer;
      StatusChangeActivities@1000000001 : Integer;
      AttachmentActivities@1000000002 : Integer;
      PhotoActivities@1000000003 : Integer;
      ReadActivities@1000000004 : Integer;
      TaskActivities@1000000005 : Integer;
      CMWoMgt@1000000007 : Codeunit 70030;
      LogEntry@1000000008 : Record 5065;

    BEGIN
    END.
  }
}

OBJECT Page 70703 CMMS Log Comment - Infobox
{
  OBJECT-PROPERTIES
  {
    Date=27.06.17;
    Time=10:45:36;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Comment Text;
               DEA=Kommentar Text];
    MultipleNewLines=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5065;
    SourceTableView=SORTING(Entry No.);
    PageType=CardPart;
    ShowFilter=No;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                SourceExpr="CM Comment" }

  }
  CODE
  {
    VAR
      CMGMgt@1000000000 : Codeunit 70000;
      CommentText@1000000001 : Text;

    BEGIN
    END.
  }
}

OBJECT Page 70704 CMMS Contract Infobox
{
  OBJECT-PROPERTIES
  {
    Date=19.05.17;
    Time=13:49:03;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Contract Information;
               DEA=Vertragsinformation];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70050;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(Template)
                    WHERE(Template=CONST(No));
    PageType=CardPart;
    ShowFilter=No;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000010;1;Field  ;
                SourceExpr="No.";
                OnDrillDown=BEGIN
                              CMMSContractMgmt.ShowContractCard(Rec);
                            END;
                             }

    { 1000000011;1;Field  ;
                SourceExpr=Name }

    { 1000000001;1;Field  ;
                SourceExpr="Type of Service" }

    { 1000000002;1;Field  ;
                SourceExpr="Start Date" }

    { 1000000003;1;Field  ;
                SourceExpr="End Date" }

    { 1000000009;1;Field  ;
                SourceExpr="Reporting Requirements" }

    { 1000000006;1;Field  ;
                SourceExpr="Reporting Interval" }

    { 1000000007;1;Field  ;
                SourceExpr="Weekend Reaction" }

    { 1000000004;1;Field  ;
                SourceExpr="Min. Reaction Time" }

  }
  CODE
  {
    VAR
      Contr@1000000000 : Record 70050;
      AssetContr@1000000001 : Record 70021;
      CMMSContractMgmt@1000000002 : Codeunit 70021;

    PROCEDURE SetAssetNo@1000000008(AssetNo@1000000000 : Code[20]);
    BEGIN
      AssetContr.RESET;
      AssetContr.SETRANGE(Type, AssetContr.Type::Contract);
      AssetContr.SETRANGE(Key1, AssetNo);
      AssetContr.SETRANGE("Main Contract", TRUE);
      IF AssetContr.FINDFIRST() THEN BEGIN
        Rec.SETFILTER("No.", AssetContr.Key2);
        IF NOT Rec.FINDFIRST() THEN
          Rec.INIT;
      END
      ELSE BEGIN
        Rec.SETFILTER("No.",'=%1','');
      END;

      CurrPage.UPDATE(FALSE);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70705 CMMS Rel. Proj. Info.  Infobox
{
  OBJECT-PROPERTIES
  {
    Date=19.05.17;
    Time=11:44:59;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Related Information;
               DEA=Verbundene Informationen];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70020;
    PageType=CardPart;
    RefreshOnActivate=Yes;
    OnAfterGetRecord=BEGIN
                       //CALCFIELDS(Users,Customers,Activities,Subassets,Projects);
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000006;1;Field  ;
                SourceExpr=Assets;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedAssetsProjects(Rec);
                            END;
                             }

    { 1000000002;1;Field  ;
                SourceExpr=Customers;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedCustomers(Rec);
                            END;
                             }

    { 1000000004;1;Field  ;
                SourceExpr=Relations;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedRelations(Rec);
                            END;
                             }

    { 1000000001;1;Field  ;
                SourceExpr=Users;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedUserroles(Rec);
                            END;
                             }

    { 1000000003;1;Field  ;
                SourceExpr=Activities;
                OnDrillDown=BEGIN
                              CMAssetMgt.ShowRelatedLogs(Rec,0);
                            END;
                             }

  }
  CODE
  {
    VAR
      CMAssetMgt@1000000000 : Codeunit 70020;

    BEGIN
    END.
  }
}

OBJECT Page 70706 CMMS Equip. Hierar. - Infobox
{
  OBJECT-PROPERTIES
  {
    Date=18.11.16;
    Time=13:34:31;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Equipment Hierarchy;
               DEA=Equipment Hierarchie];
    SourceTable=Table70020;
    PageType=CardPart;
    OnAfterGetRecord=BEGIN
                       CalculateCueFieldValues;
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                CaptionML=[ENU=Modules;
                           DEA=Module];
                SourceExpr=EQPT[1];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",0);
                            END;
                             }

    { 1000000002;1;Field  ;
                CaptionML=[ENU=Inverter;
                           DEA=Inverter];
                SourceExpr=EQPT[2];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",1);
                            END;
                             }

    { 1000000003;1;Field  ;
                CaptionML=[ENU=Combiner Box;
                           DEA=Combiner Box];
                SourceExpr=EQPT[3];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",2);
                            END;
                             }

    { 1000000004;1;Field  ;
                CaptionML=[ENU=Sensor;
                           DEA=Sensor];
                SourceExpr=EQPT[4];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",3);
                            END;
                             }

    { 1000000005;1;Field  ;
                CaptionML=[ENU=Monitoring Hardware;
                           DEA=Monitoring Hardware];
                SourceExpr=EQPT[5];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",4);
                            END;
                             }

    { 1000000006;1;Field  ;
                CaptionML=[ENU=Internet Connection HW;
                           DEA=Internet Connection HW];
                SourceExpr=EQPT[6];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",5);
                            END;
                             }

    { 1000000007;1;Field  ;
                CaptionML=[ENU=Security System;
                           DEA=Security System];
                SourceExpr=EQPT[7];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",6);
                            END;
                             }

    { 1000000008;1;Field  ;
                CaptionML=[ENU=Meters;
                           DEA=Meters];
                SourceExpr=EQPT[8];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",7);
                            END;
                             }

    { 1000000009;1;Field  ;
                CaptionML=[ENU=Transformers;
                           DEA=Transformers];
                SourceExpr=EQPT[9];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",8);
                            END;
                             }

    { 1000000010;1;Field  ;
                CaptionML=[ENU=Switchgear;
                           DEA=Switchgear];
                SourceExpr=EQPT[10];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",9);
                            END;
                             }

    { 1000000011;1;Field  ;
                CaptionML=[ENU=Cables;
                           DEA=Cables];
                SourceExpr=EQPT[11];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",10);
                            END;
                             }

    { 1000000013;1;Field  ;
                CaptionML=[ENU=Remote Access Details;
                           DEA=Remote Access Details];
                SourceExpr=EQPT[12];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",11);
                            END;
                             }

    { 1000000012;1;Field  ;
                CaptionML=[ENU=Others;
                           DEA=Others];
                SourceExpr=EQPT[19];
                OnDrillDown=BEGIN
                              CMEQPTMgmt.ShowEQPTwithFilter(0,0,"No.",18);
                            END;
                             }

  }
  CODE
  {
    VAR
      CMEQPTMgmt@1000000000 : Codeunit 70025;
      EQPT@1000000001 : ARRAY [20] OF Integer;

    LOCAL PROCEDURE CalculateCueFieldValues@6();
    BEGIN
      //ObjectType : Integer;TypeFilter : 'Equipment,Spare Part';Key : Code[20];CompType : Integer
      EQPT[1] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",0);
      EQPT[2] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",1);
      EQPT[3] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",2);
      EQPT[4] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",3);
      EQPT[5] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",4);
      EQPT[6] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",5);
      EQPT[7] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",6);
      EQPT[8] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",7);
      EQPT[9] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",8);
      EQPT[10] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",9);
      EQPT[11] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",10);
      EQPT[12] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",11);
      EQPT[13] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",12);
      EQPT[19] := CMEQPTMgmt.CountEQPT(Objecttype,0,"No.",18);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 70707 CMMS Time Tracking Infobox
{
  OBJECT-PROPERTIES
  {
    Date=31.10.16;
    Time=10:55:39;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Related Information;
               DEA=Verbundene Informationen];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table952;
    PopulateAllFields=Yes;
    SourceTableView=SORTING(CM Is CMMS Timesheet,Time Sheet No.,Time Sheet Line No.);
    PageType=CardPart;
    ShowFilter=No;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000010;1;Field  ;
                SourceExpr="CM Asset No." }

    { 1000000011;1;Field  ;
                SourceExpr="CM Project No." }

  }
  CODE
  {

    BEGIN
    END.
  }
}

OBJECT Page 70708 CMMS Log Photo - Infobox
{
  OBJECT-PROPERTIES
  {
    Date=24.01.18;
    Time=09:42:57;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Photo;
               DEA=Foto];
    MultipleNewLines=Yes;
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table5065;
    SourceTableView=SORTING(Entry No.);
    PageType=CardPart;
    ShowFilter=No;
    OnAfterGetRecord=BEGIN
                       CLEAR(TempItem.Picture);
                       IF (Rec."CM Log Type" = Rec."CM Log Type"::Picture) AND (Rec."Attachment No." > 0) THEN BEGIN
                         IF Attachment.GET(Rec."Attachment No.") THEN BEGIN
                           Attachment.CALCFIELDS(Attachment);

                           IF Attachment.Attachment.HASVALUE THEN BEGIN
                             CLEAR(TempItem);
                             TempItem.RESET();
                             TempItem.DELETEALL();
                             TempItem.INIT();
                             TempItem.Picture := Attachment.Attachment;
                             TempItem.INSERT(FALSE);
                             TempItem.CALCFIELDS(Picture);

                             CurrPage.UPDATE(FALSE);
                           END;
                         END;
                       END;
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                Name=Photo;
                SourceExpr=TempItem.Picture;
                ShowCaption=No }

  }
  CODE
  {
    VAR
      TempItem@1000000000 : TEMPORARY Record 27;
      Attachment@1000000002 : Record 5062;

    BEGIN
    END.
  }
}

OBJECT Page 70709 CMMS Rel. Contr. Info. Infobox
{
  OBJECT-PROPERTIES
  {
    Date=19.05.17;
    Time=09:57:00;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Related Information;
               DEA=Verbundene Informationen];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    LinksAllowed=No;
    SourceTable=Table70050;
    PageType=CardPart;
    RefreshOnActivate=Yes;
  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000005;1;Field  ;
                SourceExpr="Contract Entities";
                OnDrillDown=BEGIN
                              CMContractMgmt.ShowRelatedContractEntites(Rec);
                            END;
                             }

    { 1000000001;1;Field  ;
                SourceExpr=Relations;
                OnDrillDown=BEGIN
                              CMContractMgmt.ShowRelatedRelations(Rec);
                            END;
                             }

    { 1000000002;1;Field  ;
                SourceExpr=Activities;
                OnDrillDown=BEGIN
                              CMContractMgmt.ShowRelatedLogs(Rec);
                            END;
                             }

  }
  CODE
  {
    VAR
      CMContractMgmt@1000000001 : Codeunit 70021;

    BEGIN
    END.
  }
}

OBJECT Page 70710 CMMS Task - Activities Infobox
{
  OBJECT-PROPERTIES
  {
    Date=12.02.18;
    Time=09:31:41;
    Modified=Yes;
    Version List=CMMS;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Task Activities;
               DEA=Aufgabe Aktivit„ten];
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    SourceTable=Table5080;
    SourceTableView=SORTING(No.)
                    WHERE(CM Type=CONST(Task));
    PageType=CardPart;
    OnAfterGetRecord=BEGIN
                       Activities := CMTaskMgt.CountRelatedLogs(Rec, '');
                       StatusChangeActivities := CMTaskMgt.CountRelatedLogs(Rec, STRSUBSTNO('%1', LogEntry."CM Log Type"::"Status Change"));
                       AttachmentActivities := CMTaskMgt.CountRelatedLogs(Rec, STRSUBSTNO('%1', LogEntry."CM Log Type"::Attachment));
                       PhotoActivities := CMTaskMgt.CountRelatedLogs(Rec, STRSUBSTNO('%1', LogEntry."CM Log Type"::Picture));
                       ReadActivities := CMTaskMgt.CountRelatedLogs(Rec, STRSUBSTNO('%1', LogEntry."CM Log Type"::Read));
                     END;

  }
  CONTROLS
  {
    { 1000000000;0;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Field  ;
                Name=Activities;
                CaptionML=[ENU=Activities;
                           DEA=Aktivit„ten];
                SourceExpr=Activities;
                OnDrillDown=BEGIN
                              CMTaskMgt.ShowRelatedLogs(Rec, '');
                            END;
                             }

    { 1000000002;1;Field  ;
                Name=StatusChangeActivities;
                CaptionML=[ENU=Status Change Activities;
                           DEA=Status„nderung Aktivit„ten];
                SourceExpr=StatusChangeActivities;
                OnDrillDown=BEGIN
                              CMTaskMgt.ShowRelatedLogs(Rec, STRSUBSTNO('%1', LogEntry."CM Log Type"::"Status Change"));
                            END;
                             }

    { 1000000003;1;Field  ;
                Name=AttachmentActivities;
                CaptionML=[ENU=Attachment Activities;
                           DEA=Anhang Aktivit„ten];
                SourceExpr=AttachmentActivities;
                OnDrillDown=BEGIN
                              CMTaskMgt.ShowRelatedLogs(Rec, STRSUBSTNO('%1', LogEntry."CM Log Type"::Attachment));
                            END;
                             }

    { 1000000004;1;Field  ;
                Name=PhotoActivities;
                CaptionML=[ENU=Photo Activities;
                           DEA=Foto Aktivit„ten];
                SourceExpr=PhotoActivities;
                OnDrillDown=BEGIN
                              CMTaskMgt.ShowRelatedLogs(Rec, STRSUBSTNO('%1', LogEntry."CM Log Type"::Picture));
                            END;
                             }

    { 1000000005;1;Field  ;
                Name=ReadActivities;
                CaptionML=[ENU=Read Activities;
                           DEA=Gelesen Aktivit„ten];
                SourceExpr=ReadActivities;
                OnDrillDown=BEGIN
                              CMTaskMgt.ShowRelatedLogs(Rec, STRSUBSTNO('%1', LogEntry."CM Log Type"::Read));
                            END;
                             }

  }
  CODE
  {
    VAR
      Activities@1000000000 : Integer;
      StatusChangeActivities@1000000001 : Integer;
      AttachmentActivities@1000000002 : Integer;
      PhotoActivities@1000000003 : Integer;
      ReadActivities@1000000004 : Integer;
      CMTaskMgt@1000000007 : Codeunit 70031;
      LogEntry@1000000008 : Record 5065;

    BEGIN
    END.
  }
}

